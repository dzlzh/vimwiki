{"created_by":"Tampermonkey","version":"1","scripts":[{"name":"Google: Bypass Result Page Redirect","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["/^https?://(?:www|encrypted|ipv[46])\\.google\\.[^/]+/(?:$|[#?]|search|webhp|imgres)/"],"orig_matches":["https://news.google.com/*","https://cse.google.com/cse/*"],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1487594258306},"enabled":false,"position":1,"file_url":"https://greasyfork.org/scripts/14150-google-%E7%BB%95%E8%BF%87%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C%E7%BD%91%E9%A1%B5%E9%93%BE%E6%8E%A5%E9%87%8D%E5%AE%9A%E5%90%91/code/Google%EF%BC%9A%E7%BB%95%E8%BF%87%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C%E7%BD%91%E9%A1%B5%E9%93%BE%E6%8E%A5%E9%87%8D%E5%AE%9A%E5%90%91.user.js","uuid":"c65f0816-cf1f-429d-a2a7-50681993d6f3","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWVzcGFjZSAgIFZBX2kKLy8gQHZlcnNpb24gICAgIDcuMi4xLjIwMTcwMjI3Ci8vIEBncmFudCAgICAgICB1bnNhZmVXaW5kb3cKLy8gQGdyYW50ICAgICAgIEdNX2FkZFN0eWxlCi8vIEBncmFudCAgICAgICBHTV9nZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgR01fc2V0VmFsdWUKLy8gQGluY2x1ZGUgICAgIC9eaHR0cHM/Oi8vKD86d3d3fGVuY3J5cHRlZHxpcHZbNDZdKVwuZ29vZ2xlXC5bXi9dKy8oPzokfFsjP118c2VhcmNofHdlYmhwfGltZ3JlcykvCi8vIEBtYXRjaCAgICAgICBodHRwczovL25ld3MuZ29vZ2xlLmNvbS8qCi8vIEBtYXRjaCAgICAgICBodHRwczovL2NzZS5nb29nbGUuY29tL2NzZS8qCi8vIEBydW4tYXQgICAgICBkb2N1bWVudC1zdGFydAovLyBAbmFtZSAgICAgICAgR29vZ2xlOiBCeXBhc3MgUmVzdWx0IFBhZ2UgUmVkaXJlY3QKLy8gQG5hbWU6emgtQ04gIEdvb2dsZe+8mue7lei/h+aQnOe0oue7k+aenOe9kemhtemTvuaOpemHjeWumuWQkQovLyBAbmFtZTp6aC1UVyAgR29vZ2xl77ya57me6YGO5pCc5bCL57WQ5p6c57ay6aCB6Y+I5o6l6YeN5a6a5ZCRCi8vIEBkZXNjcmlwdGlvbiBBdm9pZCBHb29nbGUgcmVkaXJlY3QgZm9yIHNlYXJjaCByZXN1bHQgcGFnZXMuCi8vIEBkZXNjcmlwdGlvbjp6aC1DTiDku6QgR29vZ2xlIOebtOaOpemTvuaOpeiHs+aQnOe0oue7k+aenOe9kemhte+8jOaXoOmhu+mHjeWumuWQkeOAggovLyBAZGVzY3JpcHRpb246emgtVFcg5LukIEdvb2dsZSDnm7TmjqXpj4jmjqXoh7PmkJzlsIvntZDmnpzntrLpoIHvvIznhKHpoIjph43lrprlkJHjgIIKLy8gPT0vVXNlclNjcmlwdD09CgovLyBGb3IgZXhhbXBsZTogb3BlbiBodHRwczovL2lwdjQuZ29vZ2xlLmNvbS8jeC1vcHRpb246b3Blbi1pbnBsYWNlCnN3aXRjaCAobG9jYXRpb24uaGFzaCkgewogIC8vIE9wZW4gbGlua3MgaW4gdGhlIGN1cnJlbnQgdGFiLgogIGNhc2UgJyN4LW9wdGlvbjpvcGVuLWlucGxhY2UnOiBHTV9zZXRWYWx1ZSgnb3B0X25vb3BlbicsIHRydWUpOyBicmVhazsKICAvLyBEbyBub3QgLi4uCiAgY2FzZSAnI3gtb3B0aW9uOm5vLW9wZW4taW5wbGFjZSc6IEdNX3NldFZhbHVlKCdvcHRfbm9vcGVuJywgZmFsc2UpOyBicmVhazsKfQoKdmFyIG9wdGlvbnMgPSB7CiAgb3B0X25vb3BlbjogR01fZ2V0VmFsdWUoJ29wdF9ub29wZW4nLCBmYWxzZSkKfTsKCnVuc2FmZVdpbmRvdy5GdW5jdGlvbigoZnVuY3Rpb24gKCkgewoKdmFyIGRlYnVnID0gZmFsc2U7CnZhciBjb3VudCA9IDA7Cgp2YXIgb3B0aW9ucyA9IEpTT04ucGFyc2UoYXJndW1lbnRzWzBdIHx8ICd7fScpOwpkZWJ1ZyAmJiBjb25zb2xlLmxvZygnT3B0aW9uczonLCBvcHRpb25zKTsKCi8vIHdlYiBwYWdlczogdXJsP3VybD0KLy8gY3VzdG9tIHNlYXJjaCBlbmdpbmU6IHVybD9xPQovLyBtYWx3YXJlOiBpbnRlcnN0aXRpYWw/dXJsPQp2YXIgcmUgPSAvXGJ1cmxcPy4qP1xiKD86dXJsfHEpPShodHRwcz9cYlteJiNdKykvaTsKdmFyIHJlc3RvcmUgPSBmdW5jdGlvbiAobGluaywgdXJsKSB7CiAgdmFyIG9sZFVybCA9IGxpbmsuZ2V0QXR0cmlidXRlKCdocmVmJykgfHwgJyc7CiAgdmFyIG5ld1VybCA9IHVybCB8fCBvbGRVcmw7CiAgdmFyIG1hdGNoZXMgPSBuZXdVcmwubWF0Y2gocmUpOwogIGlmIChtYXRjaGVzKSB7CiAgICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIGRlY29kZVVSSUNvbXBvbmVudChtYXRjaGVzWzFdKSk7CiAgICByZW1vdmVSZWZlcnJlcihsaW5rKTsKICB9IGVsc2UgaWYgKHVybCAhPSBudWxsKSB7CiAgICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHVybCk7CiAgfQp9OwoKdmFyIHJlbW92ZVJlZmVycmVyID0gZnVuY3Rpb24gKGEpIHsKICBhLnNldEF0dHJpYnV0ZSgncmVsJywgJ25vcmVmZXJyZXInKTsKICBhLnNldEF0dHJpYnV0ZSgncmVmZXJyZXJwb2xpY3knLCAnbm8tcmVmZXJyZXInKTsKICBpZiAob3B0aW9ucy5vcHRfbm9vcGVuKSB7CiAgICBhLnNldEF0dHJpYnV0ZSgndGFyZ2V0JywgJ19zZWxmJyk7CiAgICBhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgfSwgdHJ1ZSk7CiAgfQp9OwoKdmFyIGZha2VMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwp2YXIgbm9ybWFsaXplVXJsID0gZnVuY3Rpb24gKHVybCkgewogIGZha2VMaW5rLmhyZWYgPSB1cmw7CiAgcmV0dXJuIGZha2VMaW5rLmhyZWY7Cn07Cgp2YXIgc2V0dGVyID0gZnVuY3Rpb24gKHYpIHsKICB2ID0gU3RyaW5nKHYpOyAgLy8gaW4gY2FzZSBhbiBvYmplY3QgaXMgcGFzc2VkIGJ5IGNsZXZlciBHb29nbGUKICBkZWJ1ZyAmJiBjb25zb2xlLmxvZygnU3RhdGU6JywgZG9jdW1lbnQucmVhZHlTdGF0ZSk7CiAgZGVidWcgJiYgY29uc29sZS5sb2coJ3NldCcsIHRoaXMuX3hfaWQsIHRoaXMuZ2V0QXR0cmlidXRlKCdocmVmJyksIHYpOwogIHJlc3RvcmUodGhpcywgdik7Cn07CnZhciBnZXR0ZXIgPSBmdW5jdGlvbiAoKSB7CiAgZGVidWcgJiYgY29uc29sZS5sb2coJ2dldCcsIHRoaXMuX3hfaWQsIHRoaXMuZ2V0QXR0cmlidXRlKCdocmVmJykpOwogIHJldHVybiBub3JtYWxpemVVcmwodGhpcy5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSk7Cn07CnZhciBibG9ja2VyID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgcmVzdG9yZSh0aGlzKTsKICBkZWJ1ZyAmJiBjb25zb2xlLmxvZygnYmxvY2snLCB0aGlzLl94X2lkLCB0aGlzLmdldEF0dHJpYnV0ZSgnaHJlZicpKTsKfTsKCnZhciBoYW5kbGVyID0gZnVuY3Rpb24gKGEpIHsKICBpZiAoYS5feF9pZCkgewogICAgcmVzdG9yZShhKTsKICAgIHJldHVybjsKICB9CiAgYS5feF9pZCA9ICsrY291bnQ7CiAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgewogICAgZGVidWcgJiYgY29uc29sZS5sb2coJ2RlZmluZSBwcm9wZXJ0eScsIGEuX3hfaWQpOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGEsICdocmVmJywge2dldDogZ2V0dGVyLCBzZXQ6IHNldHRlcn0pOwogIH0gZWxzZSBpZiAoYS5fX2RlZmluZVNldHRlcl9fKSB7CiAgICBkZWJ1ZyAmJiBjb25zb2xlLmxvZygnZGVmaW5lIGdldHRlcicsIGEuX3hfaWQpOwogICAgYS5fX2RlZmluZVNldHRlcl9fKCdocmVmJywgc2V0dGVyKTsKICAgIGEuX19kZWZpbmVHZXR0ZXJfXygnaHJlZicsIGdldHRlcik7CiAgfSBlbHNlIHsKICAgIGRlYnVnICYmIGNvbnNvbGUubG9nKCdkZWZpbmUgbGlzdGVuZXInLCBhLl94X2lkKTsKICAgIGEub25tb3VzZWVudGVyID0gYS5vbm1vdXNlbW92ZSA9IGEub25tb3VzZXVwID0gYS5vbm1vdXNlZG93biA9CiAgICAgIGEub25kYmNsaWNrID0gYS5vbmNsaWNrID0gYS5vbmNvbnRleHRtZW51ID0gYmxvY2tlcjsKICB9CiAgZGVidWcgJiYgYS5zZXRBdHRyaWJ1dGUoJ3gtaWQnLCBhLl94X2lkKTsKICByZXN0b3JlKGEpOwp9OwoKdmFyIGNoZWNrTmV3Tm9kZXMgPSBmdW5jdGlvbiAobXV0YXRpb25zKSB7CiAgZGVidWcgJiYgY29uc29sZS5sb2coJ1N0YXRlOicsIGRvY3VtZW50LnJlYWR5U3RhdGUpOwogIGlmIChtdXRhdGlvbnMudGFyZ2V0KSB7CiAgICBjaGVja0F0dHJpYnV0ZShtdXRhdGlvbnMpOwogIH0gZWxzZSB7CiAgICBtdXRhdGlvbnMuZm9yRWFjaCAmJiBtdXRhdGlvbnMuZm9yRWFjaChjaGVja0F0dHJpYnV0ZSk7CiAgfQp9Owp2YXIgY2hlY2tBdHRyaWJ1dGUgPSBmdW5jdGlvbiAobXV0YXRpb24pIHsKICB2YXIgdGFyZ2V0ID0gbXV0YXRpb24udGFyZ2V0OwogIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVOYW1lLnRvVXBwZXJDYXNlKCkgPT09ICdBJykgewogICAgaWYgKChtdXRhdGlvbi5hdHRyaWJ1dGVOYW1lIHx8IG11dGF0aW9uLmF0dHJOYW1lKSA9PT0gJ2hyZWYnKSB7CiAgICAgIGRlYnVnICYmIGNvbnNvbGUubG9nKCdyZXN0b3JlIGF0dHJpYnV0ZScsIHRhcmdldC5feF9pZCwgdGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpKTsKICAgIH0KICAgIGhhbmRsZXIodGFyZ2V0KTsKICB9IGVsc2UgaWYgKHRhcmdldC5ub2RlVHlwZSA9PT0gRWxlbWVudC5FTEVNRU5UX05PREUpIHsKICAgIFtdLnNsaWNlLmNhbGwodGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKSkuZm9yRWFjaChoYW5kbGVyKTsKICB9Cn07Cgp2YXIgTXV0YXRpb25PYnNlcnZlciA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyOwoKaWYgKE11dGF0aW9uT2JzZXJ2ZXIpIHsKICBkZWJ1ZyAmJiBjb25zb2xlLmxvZygnTXV0YXRpb25PYnNlcnZlcjogdHJ1ZScpOwogIG5ldyBNdXRhdGlvbk9ic2VydmVyKGNoZWNrTmV3Tm9kZXMpLm9ic2VydmUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCB7CiAgICBjaGlsZExpc3Q6IHRydWUsCiAgICBhdHRyaWJ1dGVzOiB0cnVlLAogICAgYXR0cmlidXRlRmlsdGVyOiBbJ2hyZWYnXSwKICAgIHN1YnRyZWU6IHRydWUKICB9KTsKfSBlbHNlIHsKICBkZWJ1ZyAmJiBjb25zb2xlLmxvZygnTXV0YXRpb25FdmVudDogdHJ1ZScpOwogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUF0dHJNb2RpZmllZCcsIGNoZWNrQXR0cmlidXRlLCBmYWxzZSk7CiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NTm9kZUluc2VydGVkJywgY2hlY2tOZXdOb2RlcywgZmFsc2UpOwp9Cgp9KS50b1N0cmluZygpLm1hdGNoKC97KFtcc1xTXSopfS8pWzFdKS5jYWxsKHVuc2FmZVdpbmRvdywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeShvcHRpb25zKSk7"},{"name":"gwdang","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["http://*.jd.com/*","https://*.jd.com/*","http://*.jd.hk/*","https://*.jd.hk/*","http://*.taobao.com/*","https://*.taobao.com/*","http://*.tmall.com/*","https://*.tmall.com/*","https://*.tmall.hk/*","http://*.yixun.com/*","http://*.51buy.com/*","http://*.yhd.com/*","http://*.suning.com/*","https://*.suning.com/*","http://*.dangdang.com/*","http://*.gome.com.cn/*","http://*.newegg.cn/*","http://*.paipai.com/*","https://*.amazon.com/*","https://*.amazon.cn/*","https://*.amazon.*/*","http://www.kjt.com/*","http://www.kaola.com/*","http://www.tcl.com/*","http://shop.hisense.com/*","http://*.oppo.com/*","http://shop.vivo.com.cn/*","http://www.ebay.com/*","http://t.dianping.com/*","http://*.nuomi.com/*","http://*.meituan.com/*","https://yao.95095.com/*","http://*.feiniu.com/*","http://*.meilishuo.com/*","http://*.mogujie.com/*","http://shop.coolpad.cn/*","http://*.sephora.cn/*","http://*.yesmywine.com/*","http://*.yiguo.com/*","http://*.wanggou.com/*","http://mall.jia.com/*","http://weigou.baidu.com/*","http://*.mi.com/*","http://shop.letv.com/*","http://*.handu.com/*","http://*.taoshu.com/*","http://*.1688.com/*","http://*.muyingzhijia.com/*","http://*.vmall.com/*","http://*.xiji.com/*","http://*.xijie.com/*","http://www.yougou.com/*","http://www.okbuy.com/*","http://*.001town.com/*","http://*.01goo.com/*","http://*.03l.cn/*","http://*.133china.com/*","http://*.139shop.com/*","http://yxp.163.com/*","http://*.168dg.com/*","http://*.186mall.com/*","http://*.18to82.com/*","http://*.1j.cn/*","http://*.22shop.com/*","http://*.24dq.com/*","http://*.24quan.com/*","http://*.258sd.com/*","http://*.2688.com/*","http://*.360buy.com/*","http://*.360hqb.com/*","http://*.360kxr.com/*","http://*.360mart.com/*","http://*.365goba.com/*","http://*.38hzt.com/*","http://*.39ty.com/*","http://*.4inlook.com/*","http://*.5188bag.com/*","http://*.51buy.com/*","http://51buy.com/","http://*.51dg.com/*","http://*.51eng.com/*","http://*.51sheyuan.com/*","http://*.51youpin.com/*","http://*.520eye.com/*","http://*.52shehua.com/*","http://*.5366.com/*","http://t.58.com/*","http://*.58hua.com/*","http://*.5lux.com/*","http://*.5yth.com/*","http://*.6919.com/*","http://*.6sbuy.com/*","http://*.77toy.com/*","http://*.7caihua.com/*","http://*.7cv.com/*","http://*.7sev.com/*","http://*.80ebus.com/*","http://*.8801.net/*","http://*.919it.com/*","http://*.929.cn/*","http://*.942radio.com/*","http://b2c.958shop.com/*","http://*.96128.com/*","http://*.99pto.com/*","http://*.99read.com/*","http://*.9dadao.com/*","http://*.9you.com/*","http://*.afffff.com/*","http://*.ai356.com/*","http://*.aibang.com/*","http://*.aidai.com/*","http://*.aiju.com/*","http://*.aim36.com/*","http://*.aimer.com.cn/*","http://*.aiyingshi.com/*","http://*.aizhigu.com.cn/*","http://*.amazon.cn/*","http://*.anni.com/*","http://*.apabi.com/*","http://*.augshow.com/*","http://*.autosup.com/*","http://*.baiyjk.com/*","http://*.bbesports.com/*","http://*.bookuu.com/*","http://*.bearbuy.com.cn/*","http://*.beautyplus.cn/*","http://*.beifabook.com/*","http://*.benq.com.cn/*","http://*.best1.com/*","http://*.biaoshang.hk/*","http://*.binggo.com/*","http://*.bloves.com/*","http://*.bobomobi.com/*","http://*.bookschina.com/*","http://*.boqii.com/*","http://*.buding.com/*","http://*.buy007.com/*","http://*.buy361.cn/*","http://*.buyfine.net/*","http://*.buynow.com.cn/*","http://*.caistv.com/*","http://*.caomeipai.com/*","http://*.car339.com.cn/*","http://*.car6688.com/*","http://*.carrefour.com.cn/*","http://*.cdream.com/*","http://*.ceetop.com/*","http://*.chashu.cn/*","http://*.chedangjia.com/*","http://*.chengdecs.com/*","http://*.china-gift.com/*","http://*.china-pub.com/*","http://emall.chinapay.com/*","http://*.chinayrs.com/*","http://*.chris-tina.com/*","http://*.clady.com/*","http://*.clinique.com.cn/*","http://*.cncard.com/*","http://*.cnfse.com/*","http://*.colebuy.com/*","http://*.conslive.com/*","http://*.coo8.com/*","http://*.cosize.com/*","http://*.cosme-de.com/*","http://*.ctrip.com/*","http://*.cw100.com/*","http://*.d1.com.cn/*","http://*.daisonghua.com/*","http://*.dangdang.com/*","http://*.daoyao.com/*","http://*.woyo.com/*","http://*.dazhe.cn/*","http://*.dazhongdianqi.com.cn/*","http://*.dianpu.com/*","http://*.didatuan.com/*","http://*.disiqu.cn/*","http://*.dixintong.com/*","http://*.doulaimai.com/*","http://*.dsgoo.com/*","http://*.dtoto.com/*","http://*.duhub.com/*","http://*.duoding.com/*","http://*.e-giordano.com/*","http://*.e-lining.com/*","http://*.e-my.com.cn/*","http://*.easy361.com/*","http://*.ebaimi.com/*","http://*.eboxbuy.com/*","http://*.ebtea.com/*","http://*.ecosme.cn/*","http://*.efeihu.com/*","http://*.ehaier.com/*","http://*.ejia.com/*","http://*.enet.com.cn/*","http://*.enjoyeye.com/*","http://*.epetbar.com/*","http://*.et5155.com/*","http://*.f508.com/*","http://*.fclub.cn/*","http://*.flowerby.com/*","http://*.flowercn.com/*","http://*.gap.cn/*","http://*.godida.com/*","http://*.gome.com.cn/*","http://*.goocctv.cn/*","http://*.goodjd.com/*","http://*.goodnourish.cn/*","http://*.gou3618.com/*","http://*.gouduo.com/*","http://*.gouwulian.com/*","http://*.gouxie.com/*","http://*.goyahome.com/*","http://*.guobuy.com/*","http://*.guopi.com/*","http://*.guuoo.com/*","http://*.hany.cn/*","http://*.happigo.com/*","http://*.hit168.com.cn/*","http://*.hitao.com/*","http://*.homeold.cn/*","http://*.homevv.com/*","http://*.hongkouzi.com/*","http://*.hopebook.net/*","http://*.huachu.com.cn/*","http://*.huimeifang.cn/*","http://*.hw2008.cn/*","http://*.icaifeng.com/*","http://*.icson.com/*","http://*.ideemall.com/*","http://*.ihush.com/*","http://*.iloveyou.com.cn/*","http://*.ilovezuan.com/*","http://*.imeelee.com/*","http://*.inoble.com.cn/*","http://*.inshion.com/*","http://*.ishop.cn/*","http://*.it88.com.cn/*","http://*.itzm.com/*","http://*.iyuyou.com/*","http://*.jiajiajk.com/*","http://*.jiaju.com/*","http://*.jiatx.com/*","http://*.jiayougo.com/*","http://*.jinbaidu.com/*","http://*.jmeishop.com/*","http://*.joyran.com/*","http://*.jsbcmall.com/*","http://*.jtlhome.com/*","http://*.jumei.com/*","http://*.junph.com/*","http://*.justonline.cn/*","http://*.jxdyf.com/*","http://*.k121.com/*","http://*.kadang.com/*","http://*.keede.com.cn/*","http://*.kela.cn/*","http://*.kuaishubao.com/*","http://*.kxtkx.com/*","http://*.ladypk.com/*","http://*.laeibelle.com/*","http://*.lafaso.com/*","http://*.lamiu.com/*","http://*.lancome.com.cn/*","http://*.lashou.com/*","http://*.ledaojia.com/*","http://*.leftlady.com/*","http://*.lenovo.com.cn/*","http://*.lens2005.com/*","http://*.letao.com/*","http://*.leyou.com/*","http://*.leyou.com.cn/*","http://*.lijiababy.com.cn/*","http://*.lijigou.com/*","http://*.likebuy.com/*","http://*.likeface.com/*","http://*.lingshi.com/*","http://*.liqunshop.com/*","http://*.liyi99.com/*","http://*.locknlock.com.cn/*","http://*.lovo.cn/*","http://*.luckigo.com/*","http://*.lusen.com/*","http://*.lyceem.com/*","http://*.m18.com/*","http://*.maichawang.com/*","http://*.maimaike.cn/*","http://*.mamabb.com/*","http://*.mamahao.cn/*","http://*.mangocity.com/*","http://*.manzuo.com/*","http://*.masamaso.com/*","http://*.maxfunbuy.com/*","http://*.maywon.com/*","http://*.mbaobao.com/*","http://*.meici.com/*","http://*.meilele.com/*","http://*.meilieasy.com/*","http://*.meituan.com/*","http://*.menglu.com/*","http://*.mengmai.com/*","http://*.minibuy.com/*","http://*.mmgw.cn/*","http://*.mmuses.com/*","http://*.mobi001.com/*","http://*.mokamall.com/*","http://*.momoyoyo.com/*","http://*.montrosechina.com/*","http://*.mooiee.com/*","http://*.moonbasa.com/*","http://*.motostore.com.cn/*","http://*.mpshow.com.cn/*","http://*.naccoo.com/*","http://*.naguu.com/*","http://*.nayao.com/*","http://*.newegg.com.cn/*","http://*.newgo5.com/*","http://*.nmlch.com/*","http://*.no5.com.cn/*","http://*.nokia.com.cn/*","http://*.nonmin88.com/*","http://*.obuy.cn/*","http://*.ofcard.com/*","http://*.ogage.cn/*","http://*.okbig.com/*","http://*.okbuy.com/*","http://*.okddy.com/*","http://*.okgolf.cn/*","http://*.olomo.com/*","http://*.olympus.com.cn/*","http://*.olymsports.com/*","http://*.ono.com.cn/*","http://*.orange3c.com/*","http://*.ouku.com/*","http://*.ourtasty.com/*","http://*.outice.com/*","http://*.oyego.com/*","http://*.paixie.net/*","http://*.palcent.com/*","http://*.ocj.com.cn/*","http://*.pb89.com/*","http://*.pcarm.com/*","http://*.petyoo.com/*","http://*.pgbao.com/*","http://*.piaoliang100.com/*","http://*.pirateship.com.cn/*","http://*.popyj.com/*","http://*.pupai.cn/*","http://*.purcotton.com/*","http://*.qianxun.com/*","http://*.qingci.com/*","http://*.qinqinbaby.com/*","http://*.qmango.com/*","http://*.qumei.com/*","http://*.quwan.com/*","http://*.qxian.com/*","http://*.rayi.cn/*","http://*.redbaby.com.cn/*","http://*.robam.com/*","http://*.salala.com.cn/*","http://*.samsclub.cn/*","http://*.sanfo.com/*","http://*.sapo.com.hk/*","http://*.sasa.com/*","http://*.sasacity.com/*","http://*.sawbuy.com/*","http://*.shanghai-sports.com/*","http://*.shentop.com/*","http://*.shishangqiyi.com/*","http://*.shjdq.com/*","http://*.shnn.com/*","http://*.shopin.net/*","http://*.shoubiao.com.cn/*","http://*.sigo.cn/*","http://mall.sina.com.cn/*","http://*.sinobuy.cn/*","http://*.skcoo.com/*","http://*.skomart.com/*","http://*.snyun.com/*","http://*.sonmai.cn/*","http://*.sport2008.com.cn/*","http://*.strawberrynet.com/*","http://*.suning.com/*","http://*.sz-esun.com/*","http://*.tao3c.com/*","http://item.taobao.com/*","http://*.taoxie.cn/*","http://*.the365.com/*","http://*.thinkshop.cn/*","http://*.tian10.com/*","http://*.tiantian.com/*","http://*.junph.com/*","http://*.tieyou.com/*","http://detail.tmall.com/*","http://*.togj.com/*","http://*.tooogooo.com/*","http://*.toy90.com/*","http://*.toys365.com/*","http://*.tpy100.com/*","http://*.tuniu.com/*","http://*.tztart.com/*","http://*.ugou.cn/*","http://*.uipmall.com/*","http://*.uiyi.cn/*","http://*.ushan.cn/*","http://*.uushouji.com/*","http://*.uya100.com/*","http://*.vaakav.com/*","http://*.vafox.com/*","http://*.vancl.com/*","http://*.vcotton.com/*","http://*.veedl.com/*","http://*.vegoos.com/*","http://*.venusveil.com/*","http://*.veryok.cn/*","http://*.viccol.com/*","http://*.vipshop.com/*","http://*.vipstore.com/*","http://*.vivian.cn/*","http://*.vjia.com/*","http://*.vnasi.com/*","http://*.voipyeah.com/*","http://*.w1.cn/*","http://*.waipowang.com/*","http://*.wangshanghai.com/*","http://*.wg365.com/*","http://*.winenice.com/*","http://*.wl.cn/*","http://*.womai.com/*","http://*.woye.com/*","http://*.wtaotao.com/*","http://*.wumeiwang.com/*","http://*.x-playboy.com/*","http://*.xiaokang.com/*","http://*.xiaozhuren.com/*","http://*.xinbaigo.com/*","http://*.xindou.com/*","http://*.xing800.com/*","http://*.xinhuabookstore.com/*","http://*.xiu.com/*","http://*.xtpo.cn/*","http://*.xzuan.com/*","http://*.yaja.com.cn/*","http://*.yaofang.cn/*","http://*.yasai.cn/*","http://*.yeecare.com/*","http://buy.yesky.com/*","http://*.yesmytea.com/*","http://*.yesmywine.com/*","http://*.yide.com/*","http://*.yifu.com/*","http://*.yihaodian.com/*","http://*.yintai.com/*","http://*.yinyuehe.net/*","http://*.yjcs.cn/*","http://*.yobrand.com/*","http://*.yoger.com.cn/*","http://*.yoho.cn/*","http://*.yongle.com.cn/*","http://*.yougou.com/*","http://*.youjk.com/*","http://*.yoyo18.com/*","http://*.yumaoclub.com/*","http://*.yyosso.com/*","http://*.zbird.com/*","http://*.zgcbb.com/*","http://*.zm7.cn/*","http://*.zopo.com/*","http://*.ibuying.com/*","http://*.33go.com.cn/*","http://*.xijie.com/*","http://*.nop.cn/*","http://*.asyp.com/*","http://*.sparty.cn/*","http://*.yizhedian.com/*","http://*.lvhezi.com/*","http://*.aishangbaobao.com/*","http://*.sportica.cn/*","http://*.jstsilk.cn/*","http://*.camel.com.cn/*","http://*.cottonpop.net/*","http://*.hyj.com/*","http://*.myxiequ.com/*","http://*.mfplaza.com/*","http://*.do93.com/*","http://*.3guo.cn/*","http://*.yaqifushi.com/*","http://*.trura.com/*","http://*.lbaobao.cn/*","http://*.xiutuan.com/*","http://*.usashopcn.com/*","http://*.ihaveu.com/*","http://*.vipku.com/*","http://*.vipchina.com/*","http://*.fanrry.cn/*","http://*.lesunvip.com/*","http://*.nala.com.cn/*","http://*.miqi.cn/*","http://*.meiribuy.com/*","http://*.pufung.com/*","http://*.xiaoye.com/*","http://*.hmeili.com/*","http://*.oulybuy.com/*","http://*.meifenzi.com/*","http://*.caomeishop.com/*","http://*.meifu360.com/*","http://*.bapashop.com/*","http://*.bulangxiongdi.com/*","http://*.gusubuy.com/*","http://*.opearl.net/*","http://*.ruci.cn/*","http://*.rax.cn/*","http://*.jiuxian.com/*","http://*.maimaicha.com/*","http://*.pinwine.cn/*","http://*.meiweidao.com/*","http://*.okliang.com/*","http://*.365wine.com/*","http://*.jjlg.com.cn/*","http://*.bianlishe.com/*","http://*.epkmall.com/*","http://*.gdcct.com/*","http://*.500ccc.com/*","http://*.me361.com/*","http://*.malatamobile.com/*","http://*.trioo.com/*","http://*.oohdear.com/*","http://*.yaahe.cn/*","http://*.easeeyes.com/*","http://*.dbox.cn/*","http://*.haotehui.com/*","http://*.m6go.com/*","http://*.bianyigo.com/*","http://*.okjee.com/*","http://*.mygeek.cn/*","http://*.tbb.cn/*","http://*.ushare360.com/*","http://*.gqt168.com/*","http://*.konjoy.com/*","http://*.aoliz.com/*","http://*.jianianle.com/*","http://*.akajia.com/*","http://*.miqi.com.cn/*","http://*.lehuimai.com/*","http://*.lifevc.com/*","http://*www.ouku.com/","http://nuomi.com/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1487594258314},"enabled":true,"position":2,"file_url":"https://greasyfork.org/scripts/14466-%E8%B4%AD%E7%89%A9%E5%85%9A%E6%AF%94%E4%BB%B7%E5%B7%A5%E5%85%B7/code/%E8%B4%AD%E7%89%A9%E5%85%9A%E6%AF%94%E4%BB%B7%E5%B7%A5%E5%85%B7.user.js","uuid":"5798ff4f-8510-459c-ac62-e880469923c8","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIGd3ZGFuZwovLyBAbmFtZTp6aC1DTiAgIOi0reeJqeWFmuavlOS7t+W3peWFtwovLyBAbmFtZXNwYWNlICAgbm8KLy8gQGRlc2NyaXB0aW9uIOS6rOS4nC7mt5jlrp0u5aSp54yrLuaYk+i/hS7kuprpqazpgIrkuK3lm70u5LiA5Y+35bqXLuiLj+WugeaYk+i0rS7lvZPlvZPnvZEu5Zu9576O5Zyo57q/LuaWsOibi+e9keS4reWbvS7mi43mi43nvZHoh6rliqjmr5Tku7fjgILkuI3kvJrooqvliKDnmoTniYjmnKzvvIjlpKfmpoIKLy8gQGRlc2NyaXB0aW9uOnpoLUNOIOS6rOS4nC7mt5jlrp0u5aSp54yrLuaYk+i/hS7kuprpqazpgIrkuK3lm70u5LiA5Y+35bqXLuiLj+WugeaYk+i0rS7lvZPlvZPnvZEu5Zu9576O5Zyo57q/LuaWsOibi+e9keS4reWbvS7mi43mi43nvZHoh6rliqjmr5Tku7fjgILkuI3kvJrooqvliKDnmoTniYjmnKzvvIjlpKfmpoLlkKcKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmpkLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwczovLyouamQuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmpkLmhrLyoKLy8gQGluY2x1ZGUgICAgIGh0dHBzOi8vKi5qZC5oay8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50YW9iYW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHBzOi8vKi50YW9iYW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnRtYWxsLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwczovLyoudG1hbGwuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHBzOi8vKi50bWFsbC5oay8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi55aXh1bi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNTFidXkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnloZC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc3VuaW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwczovLyouc3VuaW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5kYW5nZGFuZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ29tZS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubmV3ZWdnLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnBhaXBhaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly8qLmFtYXpvbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly8qLmFtYXpvbi5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwczovLyouYW1hem9uLiovKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL3d3dy5ranQuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly93d3cua2FvbGEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly93d3cudGNsLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vc2hvcC5oaXNlbnNlLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5vcHBvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vc2hvcC52aXZvLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vd3d3LmViYXkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly90LmRpYW5waW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5udW9taS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWVpdHVhbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly95YW8uOTUwOTUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmZlaW5pdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWVpbGlzaHVvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tb2d1amllLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vc2hvcC5jb29scGFkLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNlcGhvcmEuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWVzbXl3aW5lLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi55aWd1by5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoud2FuZ2dvdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL21hbGwuamlhLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vd2VpZ291LmJhaWR1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5taS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL3Nob3AubGV0di5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaGFuZHUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnRhb3NodS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMTY4OC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubXV5aW5nemhpamlhLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52bWFsbC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGlqaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGlqaWUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly93d3cueW91Z291LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vd3d3Lm9rYnV5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4wMDF0b3duLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4wMWdvby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMDNsLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjEzM2NoaW5hLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4xMzlzaG9wLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8veXhwLjE2My5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMTY4ZGcuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjE4Nm1hbGwuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjE4dG84Mi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMWouY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMjJzaG9wLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4yNGRxLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4yNHF1YW4uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjI1OHNkLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4yNjg4LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4zNjBidXkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjM2MGhxYi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMzYwa3hyLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4zNjBtYXJ0LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4zNjVnb2JhLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4zOGh6dC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMzl0eS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNGlubG9vay5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNTE4OGJhZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNTFidXkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly81MWJ1eS5jb20vCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi41MWRnLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi41MWVuZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNTFzaGV5dWFuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi41MXlvdXBpbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNTIwZXllLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi41MnNoZWh1YS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNTM2Ni5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL3QuNTguY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjU4aHVhLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi41bHV4LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi41eXRoLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi42OTE5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi42c2J1eS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouNzd0b3kuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjdjYWlodWEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjdjdi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouN3Nldi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouODBlYnVzLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi44ODAxLm5ldC8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi45MTlpdC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouOTI5LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjk0MnJhZGlvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vYjJjLjk1OHNob3AuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjk2MTI4LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi45OXB0by5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouOTlyZWFkLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi45ZGFkYW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjl5b3UuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmFmZmZmZi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYWkzNTYuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmFpYmFuZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYWlkYWkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmFpanUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmFpbTM2LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5haW1lci5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYWl5aW5nc2hpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5haXpoaWd1LmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5hbWF6b24uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYW5uaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYXBhYmkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmF1Z3Nob3cuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmF1dG9zdXAuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmJhaXlqay5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYmJlc3BvcnRzLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5ib29rdXUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmJlYXJidXkuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmJlYXV0eXBsdXMuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYmVpZmFib29rLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5iZW5xLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5iZXN0MS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYmlhb3NoYW5nLmhrLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmJpbmdnby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYmxvdmVzLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5ib2JvbW9iaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYm9va3NjaGluYS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYm9xaWkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmJ1ZGluZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYnV5MDA3LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5idXkzNjEuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYnV5ZmluZS5uZXQvKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYnV5bm93LmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jYWlzdHYuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmNhb21laXBhaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY2FyMzM5LmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jYXI2Njg4LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jYXJyZWZvdXIuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmNkcmVhbS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY2VldG9wLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jaGFzaHUuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY2hlZGFuZ2ppYS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY2hlbmdkZWNzLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jaGluYS1naWZ0LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jaGluYS1wdWIuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly9lbWFsbC5jaGluYXBheS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY2hpbmF5cnMuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmNocmlzLXRpbmEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmNsYWR5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jbGluaXF1ZS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY25jYXJkLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jbmZzZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY29sZWJ1eS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY29uc2xpdmUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmNvbzguY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmNvc2l6ZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY29zbWUtZGUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmN0cmlwLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5jdzEwMC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZDEuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmRhaXNvbmdodWEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmRhbmdkYW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5kYW95YW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLndveW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmRhemhlLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmRhemhvbmdkaWFucWkuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmRpYW5wdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZGlkYXR1YW4uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmRpc2lxdS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5kaXhpbnRvbmcuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmRvdWxhaW1haS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZHNnb28uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmR0b3RvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5kdWh1Yi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZHVvZGluZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZS1naW9yZGFuby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZS1saW5pbmcuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmUtbXkuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmVhc3kzNjEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmViYWltaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZWJveGJ1eS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZWJ0ZWEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmVjb3NtZS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5lZmVpaHUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmVoYWllci5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZWppYS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZW5ldC5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZW5qb3lleWUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmVwZXRiYXIuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmV0NTE1NS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZjUwOC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZmNsdWIuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZmxvd2VyYnkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmZsb3dlcmNuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5nYXAuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ29kaWRhLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5nb21lLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5nb29jY3R2LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmdvb2RqZC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ29vZG5vdXJpc2guY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ291MzYxOC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ291ZHVvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5nb3V3dWxpYW4uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmdvdXhpZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ295YWhvbWUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmd1b2J1eS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ3VvcGkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmd1dW9vLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5oYW55LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmhhcHBpZ28uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmhpdDE2OC5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaGl0YW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmhvbWVvbGQuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaG9tZXZ2LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5ob25na291emkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmhvcGVib29rLm5ldC8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5odWFjaHUuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmh1aW1laWZhbmcuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaHcyMDA4LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmljYWlmZW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5pY3Nvbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaWRlZW1hbGwuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmlodXNoLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5pbG92ZXlvdS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaWxvdmV6dWFuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5pbWVlbGVlLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5pbm9ibGUuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmluc2hpb24uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmlzaG9wLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLml0ODguY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLml0em0uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLml5dXlvdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouamlhamlhamsuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmppYWp1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5qaWF0eC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouamlheW91Z28uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmppbmJhaWR1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5qbWVpc2hvcC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouam95cmFuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5qc2JjbWFsbC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouanRsaG9tZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouanVtZWkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmp1bnBoLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5qdXN0b25saW5lLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmp4ZHlmLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5rMTIxLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5rYWRhbmcuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmtlZWRlLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5rZWxhLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmt1YWlzaHViYW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmt4dGt4LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5sYWR5cGsuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxhZWliZWxsZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGFmYXNvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5sYW1pdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGFuY29tZS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGFzaG91LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5sZWRhb2ppYS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGVmdGxhZHkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxlbm92by5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGVuczIwMDUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxldGFvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5sZXlvdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGV5b3UuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxpamlhYmFieS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGlqaWdvdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGlrZWJ1eS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGlrZWZhY2UuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxpbmdzaGkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxpcXVuc2hvcC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGl5aTk5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5sb2NrbmxvY2suY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxvdm8uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubHVja2lnby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubHVzZW4uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmx5Y2VlbS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubTE4LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tYWljaGF3YW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tYWltYWlrZS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tYW1hYmIuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1hbWFoYW8uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWFuZ29jaXR5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tYW56dW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1hc2FtYXNvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tYXhmdW5idXkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1heXdvbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWJhb2Jhby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWVpY2kuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1laWxlbGUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1laWxpZWFzeS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWVpdHVhbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWVuZ2x1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tZW5nbWFpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5taW5pYnV5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tbWd3LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1tdXNlcy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubW9iaTAwMS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubW9rYW1hbGwuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1vbW95b3lvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tb250cm9zZWNoaW5hLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tb29pZWUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1vb25iYXNhLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tb3Rvc3RvcmUuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1wc2hvdy5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubmFjY29vLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5uYWd1dS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubmF5YW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm5ld2VnZy5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubmV3Z281LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5ubWxjaC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubm81LmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5ub2tpYS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubm9ubWluODguY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9idXkuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoub2ZjYXJkLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5vZ2FnZS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5va2JpZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoub2tidXkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9rZGR5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5va2dvbGYuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoub2xvbW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9seW1wdXMuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9seW1zcG9ydHMuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9uby5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoub3JhbmdlM2MuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm91a3UuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm91cnRhc3R5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5vdXRpY2UuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm95ZWdvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5wYWl4aWUubmV0LyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnBhbGNlbnQuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9jai5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucGI4OS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucGNhcm0uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnBldHlvby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucGdiYW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnBpYW9saWFuZzEwMC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucGlyYXRlc2hpcC5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucG9weWouY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnB1cGFpLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnB1cmNvdHRvbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucWlhbnh1bi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucWluZ2NpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5xaW5xaW5iYWJ5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5xbWFuZ28uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnF1bWVpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5xdXdhbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucXhpYW4uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnJheWkuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucmVkYmFieS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucm9iYW0uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNhbGFsYS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc2Ftc2NsdWIuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc2FuZm8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNhcG8uY29tLmhrLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNhc2EuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNhc2FjaXR5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5zYXdidXkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNoYW5naGFpLXNwb3J0cy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc2hlbnRvcC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc2hpc2hhbmdxaXlpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5zaGpkcS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc2hubi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc2hvcGluLm5ldC8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5zaG91Ymlhby5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc2lnby5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vbWFsbC5zaW5hLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5zaW5vYnV5LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNrY29vLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5za29tYXJ0LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5zbnl1bi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc29ubWFpLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNwb3J0MjAwOC5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc3RyYXdiZXJyeW5ldC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouc3VuaW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5zei1lc3VuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50YW8zYy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL2l0ZW0udGFvYmFvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50YW94aWUuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudGhlMzY1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50aGlua3Nob3AuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudGlhbjEwLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50aWFudGlhbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouanVucGguY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnRpZXlvdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL2RldGFpbC50bWFsbC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudG9nai5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudG9vb2dvb28uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnRveTkwLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50b3lzMzY1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50cHkxMDAuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnR1bml1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50enRhcnQuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnVnb3UuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudWlwbWFsbC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudWl5aS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi51c2hhbi5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi51dXNob3VqaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudXlhMTAwLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52YWFrYXYuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnZhZm94LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52YW5jbC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudmNvdHRvbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudmVlZGwuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnZlZ29vcy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudmVudXN2ZWlsLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52ZXJ5b2suY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudmljY29sLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52aXBzaG9wLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52aXBzdG9yZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudml2aWFuLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnZqaWEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnZuYXNpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52b2lweWVhaC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudzEuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoud2FpcG93YW5nLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi53YW5nc2hhbmdoYWkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLndnMzY1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi53aW5lbmljZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoud2wuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoud29tYWkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLndveWUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnd0YW90YW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnd1bWVpd2FuZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueC1wbGF5Ym95LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi54aWFva2FuZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGlhb3podXJlbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGluYmFpZ28uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnhpbmRvdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGluZzgwMC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGluaHVhYm9va3N0b3JlLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi54aXUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnh0cG8uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueHp1YW4uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlhamEuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlhb2ZhbmcuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWFzYWkuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWVlY2FyZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL2J1eS55ZXNreS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWVzbXl0ZWEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnllc215d2luZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWlkZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWlmdS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWloYW9kaWFuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi55aW50YWkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlpbnl1ZWhlLm5ldC8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi55amNzLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlvYnJhbmQuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlvZ2VyLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi55b2hvLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlvbmdsZS5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueW91Z291LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi55b3Vqay5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueW95bzE4LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi55dW1hb2NsdWIuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnl5b3Nzby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouemJpcmQuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnpnY2JiLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi56bTcuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouem9wby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaWJ1eWluZy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouMzNnby5jb20uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGlqaWUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm5vcC5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5hc3lwLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5zcGFydHkuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueWl6aGVkaWFuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5sdmhlemkuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmFpc2hhbmdiYW9iYW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnNwb3J0aWNhLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmpzdHNpbGsuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY2FtZWwuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmNvdHRvbnBvcC5uZXQvKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaHlqLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5teXhpZXF1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tZnBsYXphLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5kbzkzLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi4zZ3VvLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlhcWlmdXNoaS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudHJ1cmEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxiYW9iYW8uY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoueGl1dHVhbi5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudXNhc2hvcGNuLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5paGF2ZXUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnZpcGt1LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi52aXBjaGluYS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZmFucnJ5LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmxlc3VudmlwLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5uYWxhLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5taXFpLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1laXJpYnV5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5wdWZ1bmcuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnhpYW95ZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouaG1laWxpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5vdWx5YnV5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tZWlmZW56aS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouY2FvbWVpc2hvcC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWVpZnUzNjAuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmJhcGFzaG9wLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5idWxhbmd4aW9uZ2RpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5ndXN1YnV5LmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5vcGVhcmwubmV0LyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnJ1Y2kuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucmF4LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmppdXhpYW4uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1haW1haWNoYS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoucGlud2luZS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tZWl3ZWlkYW8uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9rbGlhbmcuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjM2NXdpbmUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmpqbGcuY29tLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmJpYW5saXNoZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZXBrbWFsbC5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouZ2RjY3QuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLjUwMGNjYy5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubWUzNjEuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm1hbGF0YW1vYmlsZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudHJpb28uY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm9vaGRlYXIuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLnlhYWhlLmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmVhc2VleWVzLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5kYm94LmNuLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmhhb3RlaHVpLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5tNmdvLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5iaWFueWlnby5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoub2tqZWUuY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLm15Z2Vlay5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi50YmIuY24vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoudXNoYXJlMzYwLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5ncXQxNjguY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmtvbmpveS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYW9saXouY29tLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly8qLmppYW5pYW5sZS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyouYWthamlhLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5taXFpLmNvbS5jbi8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKi5sZWh1aW1haS5jb20vKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLyoubGlmZXZjLmNvbS8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vKnd3dy5vdWt1LmNvbS8KLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly9udW9taS5jb20vKgovLyBAcmVxdWlyZSAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzE0NDY0LWd3ZC9jb2RlL2d3ZC5qcwovLyBAdmVyc2lvbiAgICAgMS4zLjgKLy8gQGdyYW50IAkJbm9uZQovLyA9PS9Vc2VyU2NyaXB0PT0KKGZ1bmN0aW9uKCl7CnZhciBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7cy5zZXRBdHRyaWJ1dGUoJ3NyYycsJ0ByZXF1aXJlJyk7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzKTsKfSkoKQ=="},{"name":"","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":["*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1487594258319},"enabled":true,"position":3,"file_url":"https://greasyfork.org/scripts/2185-%E7%82%BA%E4%BB%80%E9%BA%BC%E4%BD%A0%E5%80%91%E5%B0%B1%E6%98%AF%E4%B8%8D%E8%83%BD%E5%8A%A0%E5%80%8B%E7%A9%BA%E6%A0%BC%E5%91%A2/code/%E7%82%BA%E4%BB%80%E9%BA%BC%E4%BD%A0%E5%80%91%E5%B0%B1%E6%98%AF%E4%B8%8D%E8%83%BD%E5%8A%A0%E5%80%8B%E7%A9%BA%E6%A0%BC%E5%91%A2%EF%BC%9F.user.js","uuid":"1b09c190-b99f-4e0f-b1dd-7a459943f088","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICDngrrku4DpurzkvaDlgJHlsLHmmK/kuI3og73liqDlgIvnqbrmoLzlkaLvvJ8KLy8gQG5hbWVzcGFjZSAgICBodHRwOi8vdmludGEud3MvCi8vIEBkZXNjcmlwdGlvbiAg6Ieq5YuV5Zyo57ay6aCB5Lit5omA5pyJ55qE5Lit5paH5ZKM5Y2K5b2i55qE6Iux5paH44CB5pW45a2X44CB56ym6Jmf5LmL6ZaT5o+S5YWl56m655m944CC77yI5pSk5omL77yJ5rKS6L6m5rOV77yM6JmV5aWz5bqn6YO95pyJ5by36L+r55eH44CCCi8vIEB2ZXJzaW9uICAgICAgMi41LjYKLy8gQGluY2x1ZGUgICAgICAqCi8vCi8vIEBhdXRob3IgICAgICAgVmludGEKLy8gQGhvbWVwYWdlICAgICBodHRwczovL2dpdGh1Yi5jb20vdmludGEvcGFyYW5vaWQtYXV0by1zcGFjaW5nCi8vIEBjb250cmlidXRvciAgaHR0cHM6Ly9naXRodWIuY29tL3ZpbnRhL3BhcmFub2lkLWF1dG8tc3BhY2luZy9ncmFwaHMvY29udHJpYnV0b3JzCi8vIEBsaWNlbnNlICAgICAgVGhlIE1JVCBMaWNlbnNlIChNSVQpOyBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUCi8vID09L1VzZXJTY3JpcHQ9PQoKdmFyIGlzX3NwYWNpbmcgPSBmYWxzZTsKCiFmdW5jdGlvbihhKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gYihhKXtmb3IodmFyIGI9YS5wYXJlbnROb2RlO2ImJmIubm9kZU5hbWUmJi0xPT09Yi5ub2RlTmFtZS5zZWFyY2goL14oaHRtbHxoZWFkfGJvZHl8I2RvY3VtZW50KSQvaSk7KXtpZigidHJ1ZSI9PT1iLmdldEF0dHJpYnV0ZSgiY29udGVudGVkaXRhYmxlIil8fCJ0cnVlIj09PWIuZ2V0QXR0cmlidXRlKCJnX2VkaXRhYmxlIil8fGIubm9kZU5hbWUuc2VhcmNoKGcpPj0wKXJldHVybiEwO2I9Yi5wYXJlbnROb2RlfXJldHVybiExfWZ1bmN0aW9uIGMoYSxiKXtmb3IodmFyIGM9YS5jaGlsZE5vZGVzLGQ9MDtkPGMubGVuZ3RoO2QrKyl7dmFyIGU9Y1tkXTtpZig4IT09ZS5ub2RlVHlwZSYmZS50ZXh0Q29udGVudClyZXR1cm4gZT09PWJ9fWZ1bmN0aW9uIGQoYSxiKXtmb3IodmFyIGM9YS5jaGlsZE5vZGVzLGQ9Yy5sZW5ndGgtMTtkPi0xO2QtLSl7dmFyIGU9Y1tkXTtpZig4IT09ZS5ub2RlVHlwZSYmZS50ZXh0Q29udGVudClyZXR1cm4gZT09PWJ9fWZ1bmN0aW9uIGUoYSl7dmFyIGIsYz1hO3JldHVybiBhPWEucmVwbGFjZSgvKFtcdTJlODAtXHUyZWZmXHUyZjAwLVx1MmZkZlx1MzA0MC1cdTMwOWZcdTMwYTAtXHUzMGZmXHUzMTAwLVx1MzEyZlx1MzIwMC1cdTMyZmZcdTM0MDAtXHU0ZGJmXHU0ZTAwLVx1OWZmZlx1ZjkwMC1cdWZhZmZdKShbIl0pL2dpLCIkMSAkMiIpLGE9YS5yZXBsYWNlKC8oWyJdKShbXHUyZTgwLVx1MmVmZlx1MmYwMC1cdTJmZGZcdTMwNDAtXHUzMDlmXHUzMGEwLVx1MzBmZlx1MzEwMC1cdTMxMmZcdTMyMDAtXHUzMmZmXHUzNDAwLVx1NGRiZlx1NGUwMC1cdTlmZmZcdWY5MDAtXHVmYWZmXSkvZ2ksIiQxICQyIiksYT1hLnJlcGxhY2UoLyhbIidcKFxbXHs8XHUyMDFjXSspKFxzKikoLis/KShccyopKFsiJ1wpXF1cfT5cdTIwMWRdKykvZ2ksIiQxJDMkNSIpLGE9YS5yZXBsYWNlKC8oW1x1MmU4MC1cdTJlZmZcdTJmMDAtXHUyZmRmXHUzMDQwLVx1MzA5Zlx1MzBhMC1cdTMwZmZcdTMxMDAtXHUzMTJmXHUzMjAwLVx1MzJmZlx1MzQwMC1cdTRkYmZcdTRlMDAtXHU5ZmZmXHVmOTAwLVx1ZmFmZl0pKCApKCcpKFthLXpdKS9naSwiJDEkMyQ0IiksYT1hLnJlcGxhY2UoLyhbXHUyZTgwLVx1MmVmZlx1MmYwMC1cdTJmZGZcdTMwNDAtXHUzMDlmXHUzMGEwLVx1MzBmZlx1MzEwMC1cdTMxMmZcdTMyMDAtXHUzMmZmXHUzNDAwLVx1NGRiZlx1NGUwMC1cdTlmZmZcdWY5MDAtXHVmYWZmXSkoIyhcUyspKS9naSwiJDEgJDIiKSxhPWEucmVwbGFjZSgvKChcUyspIykoW1x1MmU4MC1cdTJlZmZcdTJmMDAtXHUyZmRmXHUzMDQwLVx1MzA5Zlx1MzBhMC1cdTMwZmZcdTMxMDAtXHUzMTJmXHUzMjAwLVx1MzJmZlx1MzQwMC1cdTRkYmZcdTRlMDAtXHU5ZmZmXHVmOTAwLVx1ZmFmZl0pL2dpLCIkMSAkMyIpLGE9YS5yZXBsYWNlKC8oW1x1MmU4MC1cdTJlZmZcdTJmMDAtXHUyZmRmXHUzMDQwLVx1MzA5Zlx1MzBhMC1cdTMwZmZcdTMxMDAtXHUzMTJmXHUzMjAwLVx1MzJmZlx1MzQwMC1cdTRkYmZcdTRlMDAtXHU5ZmZmXHVmOTAwLVx1ZmFmZl0pKFtcK1wtXCpcLz0mXFx8PD5dKShbYS16MC05XSkvZ2ksIiQxICQyICQzIiksYT1hLnJlcGxhY2UoLyhbYS16MC05XSkoW1wrXC1cKlwvPSZcXHw8Pl0pKFtcdTJlODAtXHUyZWZmXHUyZjAwLVx1MmZkZlx1MzA0MC1cdTMwOWZcdTMwYTAtXHUzMGZmXHUzMTAwLVx1MzEyZlx1MzIwMC1cdTMyZmZcdTM0MDAtXHU0ZGJmXHU0ZTAwLVx1OWZmZlx1ZjkwMC1cdWZhZmZdKS9naSwiJDEgJDIgJDMiKSxjPWEsYj1jLnJlcGxhY2UoLyhbXHUyZTgwLVx1MmVmZlx1MmYwMC1cdTJmZGZcdTMwNDAtXHUzMDlmXHUzMGEwLVx1MzBmZlx1MzEwMC1cdTMxMmZcdTMyMDAtXHUzMmZmXHUzNDAwLVx1NGRiZlx1NGUwMC1cdTlmZmZcdWY5MDAtXHVmYWZmXSkoW1woXFtcezxcdTIwMWNdKyguKj8pW1wpXF1cfT5cdTIwMWRdKykoW1x1MmU4MC1cdTJlZmZcdTJmMDAtXHUyZmRmXHUzMDQwLVx1MzA5Zlx1MzBhMC1cdTMwZmZcdTMxMDAtXHUzMTJmXHUzMjAwLVx1MzJmZlx1MzQwMC1cdTRkYmZcdTRlMDAtXHU5ZmZmXHVmOTAwLVx1ZmFmZl0pL2dpLCIkMSAkMiAkNCIpLGE9YixjPT09YiYmKGE9YS5yZXBsYWNlKC8oW1x1MmU4MC1cdTJlZmZcdTJmMDAtXHUyZmRmXHUzMDQwLVx1MzA5Zlx1MzBhMC1cdTMwZmZcdTMxMDAtXHUzMTJmXHUzMjAwLVx1MzJmZlx1MzQwMC1cdTRkYmZcdTRlMDAtXHU5ZmZmXHVmOTAwLVx1ZmFmZl0pKFtcKFxbXHs8XHUyMDFjPl0pL2dpLCIkMSAkMiIpLGE9YS5yZXBsYWNlKC8oW1wpXF1cfT5cdTIwMWQ8XSkoW1x1MmU4MC1cdTJlZmZcdTJmMDAtXHUyZmRmXHUzMDQwLVx1MzA5Zlx1MzBhMC1cdTMwZmZcdTMxMDAtXHUzMTJmXHUzMjAwLVx1MzJmZlx1MzQwMC1cdTRkYmZcdTRlMDAtXHU5ZmZmXHVmOTAwLVx1ZmFmZl0pL2dpLCIkMSAkMiIpKSxhPWEucmVwbGFjZSgvKFtcKFxbXHs8XHUyMDFjXSspKFxzKikoLis/KShccyopKFtcKVxdXH0+XHUyMDFkXSspL2dpLCIkMSQzJDUiKSxhPWEucmVwbGFjZSgvKFtcdTJlODAtXHUyZWZmXHUyZjAwLVx1MmZkZlx1MzA0MC1cdTMwOWZcdTMwYTAtXHUzMGZmXHUzMTAwLVx1MzEyZlx1MzIwMC1cdTMyZmZcdTM0MDAtXHU0ZGJmXHU0ZTAwLVx1OWZmZlx1ZjkwMC1cdWZhZmZdKShbfiE7OixcLlw/XHUyMDI2XSkoW2EtejAtOV0pL2dpLCIkMSQyICQzIiksYT1hLnJlcGxhY2UoLyhbXHUyZTgwLVx1MmVmZlx1MmYwMC1cdTJmZGZcdTMwNDAtXHUzMDlmXHUzMGEwLVx1MzBmZlx1MzEwMC1cdTMxMmZcdTMyMDAtXHUzMmZmXHUzNDAwLVx1NGRiZlx1NGUwMC1cdTlmZmZcdWY5MDAtXHVmYWZmXSkoW2EtejAtOWBcJCVcXiZcKlwtPVwrXFxcfC9AXHUwMGExLVx1MDBmZlx1MjAyMlx1MjAyN1x1MjE1MC1cdTIxOGZdKS9naSwiJDEgJDIiKSxhPWEucmVwbGFjZSgvKFthLXowLTlgflwkJVxeJlwqXC09XCtcXFx8LyE7OixcLlw/XHUwMGExLVx1MDBmZlx1MjAyMlx1MjAyNlx1MjAyN1x1MjE1MC1cdTIxOGZdKShbXHUyZTgwLVx1MmVmZlx1MmYwMC1cdTJmZGZcdTMwNDAtXHUzMDlmXHUzMGEwLVx1MzBmZlx1MzEwMC1cdTMxMmZcdTMyMDAtXHUzMmZmXHUzNDAwLVx1NGRiZlx1NGUwMC1cdTlmZmZcdWY5MDAtXHVmYWZmXSkvZ2ksIiQxICQyIil9ZnVuY3Rpb24gZihhLGYpe2Y9Znx8ZG9jdW1lbnQ7Zm9yKHZhciBrLGw9ITEsbT1kb2N1bWVudC5ldmFsdWF0ZShhLGYsbnVsbCxYUGF0aFJlc3VsdC5PUkRFUkVEX05PREVfU05BUFNIT1RfVFlQRSxudWxsKSxuPW0uc25hcHNob3RMZW5ndGgsbz1uLTE7bz4tMTstLW8pe3ZhciBwPW0uc25hcHNob3RJdGVtKG8pO2lmKGIocCkpaz1wO2Vsc2V7dmFyIHE9ZShwLmRhdGEpO2lmKHAuZGF0YSE9PXEmJihsPSEwLHAuZGF0YT1xKSxrKXtpZihwLm5leHRTaWJsaW5nJiZwLm5leHRTaWJsaW5nLm5vZGVOYW1lLnNlYXJjaChpKT49MCl7az1wO2NvbnRpbnVlfXZhciByPXAuZGF0YS50b1N0cmluZygpLnN1YnN0cigtMSkray5kYXRhLnRvU3RyaW5nKCkuc3Vic3RyKDAsMSkscz1lKHIpO2lmKHIhPT1zKXtsPSEwO2Zvcih2YXIgdD1rO3QucGFyZW50Tm9kZSYmLTE9PT10Lm5vZGVOYW1lLnNlYXJjaChoKSYmYyh0LnBhcmVudE5vZGUsdCk7KXQ9dC5wYXJlbnROb2RlO2Zvcih2YXIgdT1wO3UucGFyZW50Tm9kZSYmLTE9PT11Lm5vZGVOYW1lLnNlYXJjaChoKSYmZCh1LnBhcmVudE5vZGUsdSk7KXU9dS5wYXJlbnROb2RlO2lmKHUubmV4dFNpYmxpbmcmJnUubmV4dFNpYmxpbmcubm9kZU5hbWUuc2VhcmNoKGkpPj0wKXtrPXA7Y29udGludWV9aWYoLTE9PT11Lm5vZGVOYW1lLnNlYXJjaChqKSlpZigtMT09PXQubm9kZU5hbWUuc2VhcmNoKGgpKS0xPT09dC5ub2RlTmFtZS5zZWFyY2goZykmJi0xPT09dC5ub2RlTmFtZS5zZWFyY2goaikmJihrLnByZXZpb3VzU2libGluZz8tMT09PWsucHJldmlvdXNTaWJsaW5nLm5vZGVOYW1lLnNlYXJjaChpKSYmKGsuZGF0YT0iICIray5kYXRhKTpiKGspfHwoay5kYXRhPSIgIitrLmRhdGEpKTtlbHNlIGlmKC0xPT09dS5ub2RlTmFtZS5zZWFyY2goaCkpcC5kYXRhPXAuZGF0YSsiICI7ZWxzZXt2YXIgdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwYW5ndSIpO3YuaW5uZXJIVE1MPSIgIix0LnByZXZpb3VzU2libGluZz8tMT09PXQucHJldmlvdXNTaWJsaW5nLm5vZGVOYW1lLnNlYXJjaChpKSYmdC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh2LHQpOnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodix0KSx2LnByZXZpb3VzRWxlbWVudFNpYmxpbmd8fHYucGFyZW50Tm9kZSYmdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHYpfX19az1wfX1yZXR1cm4gbH12YXIgZz0vXihjb2RlfHByZXx0ZXh0YXJlYSkkL2ksaD0vXihhfGRlbHxwcmV8c3xzdHJpa2V8dSkkL2ksaT0vXihicnxocnxpfGltZ3xwYW5ndSkkL2ksaj0vXihkaXZ8aDF8aDJ8aDN8aDR8aDV8aDZ8cCkkL2k7YS50ZXh0X3NwYWNpbmc9ZnVuY3Rpb24oYSl7cmV0dXJuIGUoYSl9LGEucGFnZV90aXRsZV9zcGFjaW5nPWZ1bmN0aW9uKCl7dmFyIGE9Ii9odG1sL2hlYWQvdGl0bGUvdGV4dCgpIixiPWYoYSk7cmV0dXJuIGJ9LGEucGFnZV9zcGFjaW5nPWZ1bmN0aW9uKCl7dmFyIGI9YS5wYWdlX3RpdGxlX3NwYWNpbmcoKSxjPSIvaHRtbC9ib2R5Ly8qL3RleHQoKVtub3JtYWxpemUtc3BhY2UoLildIjtbInNjcmlwdCIsInN0eWxlIiwidGV4dGFyZWEiXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe2MrPSdbdHJhbnNsYXRlKG5hbWUoLi4pLCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiIsImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6IikhPSInK2ErJyJdJ30pO3ZhciBkPWYoYyk7cmV0dXJuIGJ8fGR9LGEubm9kZV9zcGFjaW5nPWZ1bmN0aW9uKGEpe3ZhciBiPSIuLy8qL3RleHQoKVtub3JtYWxpemUtc3BhY2UoLildIjtbInNjcmlwdCIsInN0eWxlIiwidGV4dGFyZWEiXS5mb3JFYWNoKGZ1bmN0aW9uKGEpe2IrPSdbdHJhbnNsYXRlKG5hbWUoLi4pLCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiIsImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6IikhPSInK2ErJyJdJ30pO3ZhciBjPWYoYixhKTtyZXR1cm4gY30sYS5lbGVtZW50X3NwYWNpbmc9ZnVuY3Rpb24oYSl7dmFyIGI7aWYoMD09PWEuaW5kZXhPZigiIyIpKXt2YXIgYz1hLnNsaWNlKDEpO2I9J2lkKCInK2MrJyIpLy90ZXh0KCknfWVsc2UgaWYoMD09PWEuaW5kZXhPZigiLiIpKXt2YXIgZD1hLnNsaWNlKDEpO2I9Jy8vKltjb250YWlucyhjb25jYXQoIiAiLCBub3JtYWxpemUtc3BhY2UoQGNsYXNzKSwgIiAiKSwgIicrZCsnIildLy90ZXh0KCknfWVsc2V7dmFyIGU9YTtiPSIvLyIrZSsiLy90ZXh0KCkifXZhciBnPWYoYik7cmV0dXJuIGd9fSh3aW5kb3cucGFuZ3U9d2luZG93LnBhbmd1fHx7fSk7CgpmdW5jdGlvbiBnb19zcGFjaW5nKCkgewogICAgaXNfc3BhY2luZyA9IHRydWU7CiAgICBwYW5ndS5wYWdlX3NwYWNpbmcoKTsKICAgIGlzX3NwYWNpbmcgPSBmYWxzZTsKfQoKZ29fc3BhY2luZygpOwoKZnVuY3Rpb24gaW5zZXJ0ZWRfZ29fc3BhY2luZyhub2RlKSB7CiAgICBpc19zcGFjaW5nID0gdHJ1ZTsKICAgIHBhbmd1Lm5vZGVfc3BhY2luZyhub2RlKTsKICAgIGlzX3NwYWNpbmcgPSBmYWxzZTsKfQoKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NTm9kZUluc2VydGVkJywgZnVuY3Rpb24oZSkgewogICAgaWYgKCFpc19zcGFjaW5nKSB7CiAgICAgICAgaW5zZXJ0ZWRfZ29fc3BhY2luZyhlLnRhcmdldCk7CiAgICB9Cn0sIGZhbHNlKTsK"},{"name":"Bypass Wait, Code & Login on Websites","options":{"awareOfChrome":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_prototypes":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["down.lepan.cc","music.baidu.com","yinyueyun.baidu.com","media.store.kugou.com","trackercdn.kugou.com","yinyuetai.com","itwusun.com","self"],"orig_excludes":[],"orig_includes":["http://localhost.cuwcl4c/*","http://jixunmoe.github.io/*","http://123564.com/*","http://m.123564.com/*","http://5xfile.com/*","http://www.5xfile.com/*","http://yun.baidu.com/*","http://pan.baidu.com/*","http://howfile.com/*","http://*.howfile.com/*","http://jkpan.cc/*","http://*.jkpan.cc/*","http://namipan.cc/*","http://*.namipan.cc/*","http://10pan.cc/*","http://*.10pan.cc/*","http://66yp.cc/*","http://*.66yp.cc/*","http://123wzwp.com/*","http://*.123wzwp.com/*","http://hiyp.cc/*","http://*.hiyp.cc/*","http://jkpan.cc/*","http://*.jkpan.cc/*","http://webhd.xuite.net/*","http://sync.hamicloud.net/*","http://www.yimuhe.com/*","http://douban.fm/*","https://douban.fm/*","http://moe.fm/*","http://music.163.com/*","https://music.163.com/*","http://www.1ting.com/*","http://www.23356.com/*","http://www.app-echo.com/*","http://web.kugou.com/*","https://jixunmoe.github.io/cuwcl4c/config/"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{"CUWCL4C":"s{\"version\":1,\"bDiaplayLog\":true,\"bUseCustomRules\":false,\"dAria_auth\":0,\"dAria_port\":6800,\"dUriType\":0,\"sAria_dir\":\"D:\\\\Download\\\\\",\"sAria_host\":\"127.0.0.1\",\"sAria_pass\":\"\",\"sAria_user\":\"\",\"sCustomRule\":\"\"}"},"ts":1487594258355},"enabled":true,"position":4,"file_url":"https://greasyfork.org/scripts/2600-%E8%B7%B3%E8%BF%87%E7%BD%91%E7%AB%99%E7%AD%89%E5%BE%85-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%8F%8A%E7%99%BB%E5%BD%95/code/%E8%B7%B3%E8%BF%87%E7%BD%91%E7%AB%99%E7%AD%89%E5%BE%85%E3%80%81%E9%AA%8C%E8%AF%81%E7%A0%81%E5%8F%8A%E7%99%BB%E5%BD%95.user.js","uuid":"b11f85fc-9f3f-43c3-b1b6-3671fe3d4695","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQGdyYW50ICAgICAgICAgIHVuc2FmZVdpbmRvdwovLyBAZ3JhbnQgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gQGdyYW50ICAgICAgICAgIEdNX29wZW5JblRhYgovLyBAZ3JhbnQgICAgICAgICAgR01fcmVnaXN0ZXJNZW51Q29tbWFuZAovLyBAZ3JhbnQgICAgICAgICAgR01fZ2V0VmFsdWUKLy8gQGdyYW50ICAgICAgICAgIEdNX3NldFZhbHVlCi8vIEBncmFudCAgICAgICAgICBHTV9nZXRSZXNvdXJjZVRleHQKLy8gQGdyYW50ICAgICAgICAgIEdNX2luZm8KCi8vIEBydW4tYXQgICAgICAgICBkb2N1bWVudC1zdGFydAovLyBAbmFtZTplbiAgICAgICAgQnlwYXNzIFdhaXQsIENvZGUgJiBMb2dpbiBvbiBXZWJzaXRlcwovLyBAbmFtZSAgICAgICAgICAg6Lez6L+H572R56uZ562J5b6F44CB6aqM6K+B56CB5Y+K55m75b2VCi8vIEBuYW1lOnpoLUNOICAgICDot7Pov4fnvZHnq5nnrYnlvoXjgIHpqozor4HnoIHlj4rnmbvlvZUKLy8gQG5hbWU6emgtVFcgICAgIOe5numBjuermem7nuetieW+heOAgeitmOWIpeeivOWPiueZu+mMhAoKLy8gQGRlc2NyaXB0aW9uICAgICAgIOenu+mZpOWQhOexu+e9keermemqjOivgeeggeOAgeeZu+W9leOAgeWAkuiuoeaXtuWPiuabtOWkmiEKLy8gQGRlc2NyaXB0aW9uOnpoLUNOIOenu+mZpOWQhOexu+e9keermemqjOivgeeggeOAgeeZu+W9leOAgeWAkuiuoeaXtuWPiuabtOWkmiEKLy8gQGRlc2NyaXB0aW9uOnpoLVRXIOenu+mZpOWQhOmhnuermem7nuitmOWIpeeivOOAgeeZu+mMhOOAgeWAkuioiOaZguWPiuabtOWkmiEKLy8gQGRlc2NyaXB0aW9uOmVuICAgIFJlbW92ZSB2ZXJpZnkgY29kZSwgbG9naW4gcmVxdWlyZW1lbnQsIGNvdW50aW5nIGRvd24uLi4gYW5kIG1vcmUhCgoKLy8gQGNvcHlyaWdodCAgICAgIDIwMTQrLCBZdWxlaSwgTW9kIGJ5IEppeHVuLgovLy8vICAgICAgICAgICAgICAgQmFzZWQgb24gW0NyYWNrIFVybCBXYWl0IENvZGUgTG9naW5dIEJ5IFl1bGVpCgovLyDpgb/lhY0gU291cmNlIE1hcCDmlofku7bmib7kuI3liLDnmoTplJnor68KLy8gQHJlcXVpcmUgICAgICAgIGh0dHBzOi8vY2RuLmJvb3Rjc3MuY29tL2pxdWVyeS8yLjEuNC9qcXVlcnkuanMKLy8gQHJlcXVpcmUgICAgICAgIGh0dHBzOi8vY2RuLmJvb3Rjc3MuY29tL3VuZGVyc2NvcmUuanMvMS44LjMvdW5kZXJzY29yZS5qcwoKLy8vIENyeXB0b0pTIOebuOWFs+W6kwovLyBAcmVxdWlyZSAgICAgICAgaHR0cHM6Ly9jZG4uYm9vdGNzcy5jb20vY3J5cHRvLWpzLzMuMS4yL2NvbXBvbmVudHMvY29yZS1taW4uanMKLy8gQHJlcXVpcmUgICAgICAgIGh0dHBzOi8vY2RuLmJvb3Rjc3MuY29tL2NyeXB0by1qcy8zLjEuMi9jb21wb25lbnRzL2VuYy1iYXNlNjQtbWluLmpzCi8vIEByZXF1aXJlICAgICAgICBodHRwczovL2Nkbi5ib290Y3NzLmNvbS9jcnlwdG8tanMvMy4xLjIvY29tcG9uZW50cy9tZDUtbWluLmpzCi8vIEByZXF1aXJlICAgICAgICBodHRwczovL2dyZWFzeWZvcmsub3JnL3NjcmlwdHMvNjY5Ni9jb2RlL0NyeXB0b0pTLUJ5dGVBcnJheS5qcwoKLy8vIOmdnuWQjOatpeaemuS4vgovLyBAcmVxdWlyZSAgICAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzM1ODgtaW50ZXJ2YWwtbG9vcGVyL2NvZGUvSW50ZXJ2YWwtTG9vcGVyLmpzCgovLy8g5YW85a65IEdNIDEueCwgMi54Ci8vIEByZXF1aXJlICAgICAgICBodHRwczovL2dyZWFzeWZvcmsub3JnL3NjcmlwdHMvMjU5OS9jb2RlL2dtMi1wb3J0LXYxMDQuanMKCi8vLyBBcmlhMiBSUEMKLy8gQHJlcXVpcmUgICAgICAgIGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy81NjcyL2NvZGUvQXJpYTItUlBDLWJ1aWxkLTEwLmpzCgovLyBWdWVKcywgbm90IGFsd2F5cyB1c2VkLgovLyBAcmVzb3VyY2UgICAgICAgVnVlSnMgaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvdnVlLzEuMC4yNi92dWUubWluLmpzCgovLyBAYXV0aG9yICAgICAgICAgSml4dW4uTW9lPFllbGxvdyBZb3NoaT4KLy8gQG5hbWVzcGFjZSAgICAgIGh0dHA6Ly9qaXh1bi5vcmcvCi8vIEB2ZXJzaW9uICAgICAgICA0LjAuNzIwCgovLyDlsJ3or5Xkvb/nlKjohJrmnKznlJ/miJDljLnphY3op4TliJkKLy8gLy8vLyAgICAgICAgICAgICAgIFtJbmNsdWRlIFJ1bGVzXQoKLy8gQGluY2x1ZGUgaHR0cDovL2xvY2FsaG9zdC5jdXdjbDRjLyoKLy8gQGluY2x1ZGUgaHR0cDovL2ppeHVubW9lLmdpdGh1Yi5pby8qCi8vIEBpbmNsdWRlIGh0dHA6Ly8xMjM1NjQuY29tLyoKLy8gQGluY2x1ZGUgaHR0cDovL20uMTIzNTY0LmNvbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly81eGZpbGUuY29tLyoKLy8gQGluY2x1ZGUgaHR0cDovL3d3dy41eGZpbGUuY29tLyoKLy8gQGluY2x1ZGUgaHR0cDovL3l1bi5iYWlkdS5jb20vKgovLyBAaW5jbHVkZSBodHRwOi8vcGFuLmJhaWR1LmNvbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly9ob3dmaWxlLmNvbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly8qLmhvd2ZpbGUuY29tLyoKLy8gQGluY2x1ZGUgaHR0cDovL2prcGFuLmNjLyoKLy8gQGluY2x1ZGUgaHR0cDovLyouamtwYW4uY2MvKgovLyBAaW5jbHVkZSBodHRwOi8vbmFtaXBhbi5jYy8qCi8vIEBpbmNsdWRlIGh0dHA6Ly8qLm5hbWlwYW4uY2MvKgovLyBAaW5jbHVkZSBodHRwOi8vMTBwYW4uY2MvKgovLyBAaW5jbHVkZSBodHRwOi8vKi4xMHBhbi5jYy8qCi8vIEBpbmNsdWRlIGh0dHA6Ly82NnlwLmNjLyoKLy8gQGluY2x1ZGUgaHR0cDovLyouNjZ5cC5jYy8qCi8vIEBpbmNsdWRlIGh0dHA6Ly8xMjN3endwLmNvbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly8qLjEyM3d6d3AuY29tLyoKLy8gQGluY2x1ZGUgaHR0cDovL2hpeXAuY2MvKgovLyBAaW5jbHVkZSBodHRwOi8vKi5oaXlwLmNjLyoKLy8gQGluY2x1ZGUgaHR0cDovL2prcGFuLmNjLyoKLy8gQGluY2x1ZGUgaHR0cDovLyouamtwYW4uY2MvKgovLyBAaW5jbHVkZSBodHRwOi8vd2ViaGQueHVpdGUubmV0LyoKLy8gQGluY2x1ZGUgaHR0cDovL3N5bmMuaGFtaWNsb3VkLm5ldC8qCi8vIEBpbmNsdWRlIGh0dHA6Ly93d3cueWltdWhlLmNvbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly9kb3ViYW4uZm0vKgovLyBAaW5jbHVkZSBodHRwczovL2RvdWJhbi5mbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly9tb2UuZm0vKgovLyBAaW5jbHVkZSBodHRwOi8vbXVzaWMuMTYzLmNvbS8qCi8vIEBpbmNsdWRlIGh0dHBzOi8vbXVzaWMuMTYzLmNvbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly93d3cuMXRpbmcuY29tLyoKLy8gQGluY2x1ZGUgaHR0cDovL3d3dy4yMzM1Ni5jb20vKgovLyBAaW5jbHVkZSBodHRwOi8vd3d3LmFwcC1lY2hvLmNvbS8qCi8vIEBpbmNsdWRlIGh0dHA6Ly93ZWIua3Vnb3UuY29tLyoKLy8gQGluY2x1ZGUgaHR0cHM6Ly9qaXh1bm1vZS5naXRodWIuaW8vY3V3Y2w0Yy9jb25maWcvCgovLyBHTV94bWxIdHRwUmVxdWVzdCDov5znq6/mnI3liqHlmajliJfooagKLy8gQGNvbm5lY3QgZG93bi5sZXBhbi5jYwovLyBAY29ubmVjdCBtdXNpYy5iYWlkdS5jb20KLy8gQGNvbm5lY3QgeWlueXVleXVuLmJhaWR1LmNvbQovLyBAY29ubmVjdCBtZWRpYS5zdG9yZS5rdWdvdS5jb20KLy8gQGNvbm5lY3QgdHJhY2tlcmNkbi5rdWdvdS5jb20KLy8gQGNvbm5lY3QgeWlueXVldGFpLmNvbQovLyBAY29ubmVjdCBpdHd1c3VuLmNvbQovLyBAY29ubmVjdCBzZWxmCgovLyDlkYror4kgVGFtcGVyTW9ua2V5IOi/meS4quiEmuacrOS4jemcgOimgei9rOaNogovLyBAbm9jb21wYXQgQ2hyb21lCgovLyA9PS9Vc2VyU2NyaXB0PT0KdmFyIGRlZmluZSA9IChmdW5jdGlvbiAoKSB7CiAgICB2YXIgX21vZHVsZXMgPSB7fTsKICAgIHJldHVybiBkZWZpbmU7CiAgICBmdW5jdGlvbiBkZWZpbmUobW9kdWxlLCByZXF1aXJlcywgY2FsbGJhY2spIHsKICAgICAgICB2YXIgX3RoaXNfbW9kdWxlID0gewogICAgICAgICAgICBleHBvcnRzOiB7fQogICAgICAgIH07CiAgICAgICAgdmFyIHBhcmFtcyA9IHJlcXVpcmVzLm1hcCgobW9kdWxlKSA9PiB7CiAgICAgICAgICAgIGlmIChtb2R1bGUgPT0gJ2V4cG9ydHMnKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXNfbW9kdWxlLmV4cG9ydHM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAobW9kdWxlID09ICdyZXF1aXJlJykgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVpcmU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlcXVpcmUobW9kdWxlKTsKICAgICAgICB9KTsKICAgICAgICBjYWxsYmFjay5hcHBseSh0aGlzLCBwYXJhbXMpOwogICAgICAgIF9tb2R1bGVzW21vZHVsZV0gPSBfdGhpc19tb2R1bGUuZXhwb3J0czsKICAgIH0KICAgIGZ1bmN0aW9uIHJlcXVpcmUobW9kdWxlKSB7CiAgICAgICAgcmV0dXJuIF9tb2R1bGVzW21vZHVsZV07CiAgICB9Cn0pKCk7CmRlZmluZSgiaGVscGVyL1NjcmlwdCIsIFsicmVxdWlyZSIsICJleHBvcnRzIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgdmFyIFNjcmlwdDsKICAgIChmdW5jdGlvbiAoU2NyaXB0KSB7CiAgICAgICAgU2NyaXB0Lk5hbWUgPSAiQ1VXQ0w0QyI7CiAgICAgICAgU2NyaXB0LkhvbWUgPSAiaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzI2MDAiOwogICAgICAgIFNjcmlwdC5Db25maWcgPSAiaHR0cHM6Ly9qaXh1bm1vZS5naXRodWIuaW8vY3V3Y2w0Yy9jb25maWcvIjsKICAgICAgICBTY3JpcHQuRmVlZGJhY2sgPSAiaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mb3J1bS9wb3N0L2Rpc2N1c3Npb24/RGlzY3Vzc2lvbi9TY3JpcHRJRD0yNjAwIjsKICAgICAgICBmdW5jdGlvbiBMaXN0ZW5FdmVudChsaXN0ZW5lcikgewogICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFNjcmlwdC5OYW1lLCAoZSkgPT4gewogICAgICAgICAgICAgICAgdmFyIGluZm87CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGUuZGV0YWlsID09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IEpTT04ucGFyc2UoZS5kZXRhaWwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IGUuZGV0YWlsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGlzdGVuZXIoaW5mbyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBTY3JpcHQuTGlzdGVuRXZlbnQgPSBMaXN0ZW5FdmVudDsKICAgICAgICBmdW5jdGlvbiBGaXJlRXZlbnQobmFtZSwgZGF0YSkgewogICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChuYW1lLCB7CiAgICAgICAgICAgICAgICBkZXRhaWw6IEpTT04uc3RyaW5naWZ5KGRhdGEpCiAgICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgICAgU2NyaXB0LkZpcmVFdmVudCA9IEZpcmVFdmVudDsKICAgICAgICBmdW5jdGlvbiBSZWdpc3RlclN0b3JhZ2VFdmVudChrZXksIGxpc3RlbmVyKSB7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLmtleSA9PSBrZXkpIHsKICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcihrZXkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgU2NyaXB0LlJlZ2lzdGVyU3RvcmFnZUV2ZW50ID0gUmVnaXN0ZXJTdG9yYWdlRXZlbnQ7CiAgICB9KShTY3JpcHQgPSBleHBvcnRzLlNjcmlwdCB8fCAoZXhwb3J0cy5TY3JpcHQgPSB7fSkpOwp9KTsKZGVmaW5lKCJoZWxwZXIvQ29uc3RhbnRzIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICAvLyDluLjmlbAKICAgIGV4cG9ydHMuaXNGcmFtZSA9IF9pc0ZyYW1lKCk7CiAgICBleHBvcnRzLnZlcnNpb24gPSBHTV9pbmZvLnNjcmlwdC52ZXJzaW9uOwogICAgZXhwb3J0cy5jdXJyZW50VXJsID0gbG9jYXRpb24uaHJlZi5zcGxpdCgnIycpWzBdOwogICAgZXhwb3J0cy5sb3dlckhvc3QgPSBsb2NhdGlvbi5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpOwogICAgZXhwb3J0cy50b3BIb3N0ID0gZXhwb3J0cy5sb3dlckhvc3QubWF0Y2goL1x3K1wuP1x3Kz8kLylbMF07CiAgICBleHBvcnRzLnRvcEhvc3RNYXNrID0gYC4ke2V4cG9ydHMudG9wSG9zdH1gOwogICAgZXhwb3J0cy5kb3dubG9hZEljb25DbGFzcyA9ICdqeF9kbCc7CiAgICBleHBvcnRzLmRvd25sb2FkSWNvblNlbGVjdG9yID0gJy5qeF9kbCc7CiAgICBmdW5jdGlvbiBfaXNGcmFtZSgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gdW5zYWZlV2luZG93LnRvcCAhPT0gdW5zYWZlV2luZG93LnNlbGY7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChlKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0KfSk7CmRlZmluZSgiaGVscGVyL0xvZ2dlciIsIFsicmVxdWlyZSIsICJleHBvcnRzIiwgImhlbHBlci9TY3JpcHQiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFNjcmlwdF8xKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgZnVuY3Rpb24gRG9Mb2cocHJlZml4LCBtZXRob2QsIGFyZ3MpIHsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPCAxKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYgKHR5cGVvZiBhcmdzWzBdID09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgIGFyZ3NbMF0gPSBgWyR7U2NyaXB0XzEuU2NyaXB0Lk5hbWV9XVske3ByZWZpeH1dICR7YXJnc1swXX1gOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYXJncy5zcGxpY2UoMCwgMCwgYFske1NjcmlwdF8xLlNjcmlwdC5OYW1lfV1bJHtwcmVmaXh9XSAke2FyZ3NbMF19YCk7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGVbbWV0aG9kXS5hcHBseShjb25zb2xlLCBhcmdzKTsKICAgIH0KICAgIGZ1bmN0aW9uIFdyYXBMb2cocHJlZml4LCBtZXRob2QpIHsKICAgICAgICByZXR1cm4gKC4uLmFyZ3MpID0+IHsKICAgICAgICAgICAgcmV0dXJuIERvTG9nKHByZWZpeCwgbWV0aG9kLCBhcmdzKTsKICAgICAgICB9OwogICAgfQogICAgZnVuY3Rpb24gRG9Ob3RoaW5nKCkgeyB9CiAgICBleHBvcnRzLmxvZyA9IERvTm90aGluZzsKICAgIGV4cG9ydHMuaW5mbyA9IERvTm90aGluZzsKICAgIGV4cG9ydHMuZXJyb3IgPSBEb05vdGhpbmc7CiAgICBleHBvcnRzLndhcm4gPSBEb05vdGhpbmc7CiAgICBmdW5jdGlvbiBFbmFibGVMb2dzKCkgewogICAgICAgIGV4cG9ydHMubG9nID0gV3JhcExvZygn5pel5b+XJywgJ2xvZycpOwogICAgICAgIGV4cG9ydHMuaW5mbyA9IFdyYXBMb2coJ+S/oeaBrycsICdpbmZvJyk7CiAgICAgICAgZXhwb3J0cy5lcnJvciA9IFdyYXBMb2coJ+mUmeivrycsICdlcnJvcicpOwogICAgICAgIGV4cG9ydHMud2FybiA9IFdyYXBMb2coJ+itpuWRiicsICd3YXJuJyk7CiAgICB9CiAgICBleHBvcnRzLkVuYWJsZUxvZ3MgPSBFbmFibGVMb2dzOwp9KTsKZGVmaW5lKCJoZWxwZXIvU2NyaXB0Q29uZmlnIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL1NjcmlwdCIsICJoZWxwZXIvTG9nZ2VyIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBTY3JpcHRfMiwgTG9nZ2VyXzEpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICB2YXIgVXJpVHlwZTsKICAgIChmdW5jdGlvbiAoVXJpVHlwZSkgewogICAgICAgIFVyaVR5cGVbVXJpVHlwZVsiTm9ybWFsVXJsIl0gPSAwXSA9ICJOb3JtYWxVcmwiOwogICAgICAgIC8qKiBAZGVwcmVjYXRlZCB1c2Ugb3RoZXJzIGluc3RlYWQuICovCiAgICAgICAgVXJpVHlwZVtVcmlUeXBlWyJDdXN0b20iXSA9IDFdID0gIkN1c3RvbSI7CiAgICAgICAgVXJpVHlwZVtVcmlUeXBlWyJBcmlhIl0gPSAyXSA9ICJBcmlhIjsKICAgIH0pKFVyaVR5cGUgPSBleHBvcnRzLlVyaVR5cGUgfHwgKGV4cG9ydHMuVXJpVHlwZSA9IHt9KSk7CiAgICBmdW5jdGlvbiBSZWFkQ29uZmlnKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKEdNX2dldFZhbHVlKFNjcmlwdF8yLlNjcmlwdC5OYW1lLCAiIikpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgcmV0dXJuIHsgdmVyc2lvbjogMCB9OwogICAgICAgIH0KICAgIH0KICAgIGV4cG9ydHMuQ29uZmlnID0gJC5leHRlbmQoewogICAgICAgIHZlcnNpb246IDEsCiAgICAgICAgYkRpYXBsYXlMb2c6IHRydWUsCiAgICAgICAgYlllbGxvd0Vhc2VJbnRlcm5hdGlvbmFsOiBmYWxzZSwKICAgICAgICBiWWVsbG93RWFzZVVzZU9sZEFwaTogZmFsc2UsCiAgICAgICAgYlllbGxvd0Vhc2VVc2VUaHJpZE9uRmFpbDogZmFsc2UsCiAgICAgICAgYlVzZUN1c3RvbVJ1bGVzOiBmYWxzZSwKICAgICAgICBkQXJpYV9hdXRoOiBBcmlhMi5BVVRILm5vQXV0aCwKICAgICAgICBkQXJpYV9wb3J0OiA2ODAwLAogICAgICAgIGRVcmlUeXBlOiBVcmlUeXBlLk5vcm1hbFVybCwKICAgICAgICBzQXJpYV9kaXI6ICJEOlxcRG93bmxvYWRcXCIsCiAgICAgICAgc0FyaWFfaG9zdDogIjEyNy4wLjAuMSIsCiAgICAgICAgc0FyaWFfcGFzczogIiIsCiAgICAgICAgc0FyaWFfdXNlcjogIiIsCiAgICAgICAgc0N1c3RvbVJ1bGU6ICIiCiAgICB9LCBSZWFkQ29uZmlnKCkpOwogICAgLy8g5Y2H57qnCiAgICBjb25zdCBfX2xhdGVzdF92ZXJzaW9uID0gMTsKICAgIGlmIChleHBvcnRzLkNvbmZpZy52ZXJzaW9uICE9IF9fbGF0ZXN0X3ZlcnNpb24pIHsKICAgICAgICBzd2l0Y2ggKGV4cG9ydHMuQ29uZmlnLnZlcnNpb24pIHsKICAgICAgICAgICAgY2FzZSB1bmRlZmluZWQ6CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIExvZ2dlcl8xLmluZm8oJ+WNh+e6pyB2MCDphY3nva7mlofku7YuLi4nKTsKICAgICAgICAgICAgICAgIGV4cG9ydHMuQ29uZmlnLnZlcnNpb24gPSAxOwogICAgICAgICAgICAgICAgZXhwb3J0cy5Db25maWcuYlllbGxvd0Vhc2VJbnRlcm5hdGlvbmFsID0gZXhwb3J0cy5Db25maWcuYkludGVybmF0aW9uYWw7CiAgICAgICAgICAgICAgICBleHBvcnRzLkNvbmZpZy5iWWVsbG93RWFzZVVzZU9sZEFwaSA9IGV4cG9ydHMuQ29uZmlnLmJQcm94eUluc3RhbGxlZDsKICAgICAgICAgICAgICAgIGV4cG9ydHMuQ29uZmlnLmJZZWxsb3dFYXNlVXNlVGhyaWRPbkZhaWwgPSBleHBvcnRzLkNvbmZpZy5iVXNlVGhyaWRPbkZhaWw7CiAgICAgICAgICAgICAgICBkZWxldGUgZXhwb3J0cy5Db25maWcuYkludGVybmF0aW9uYWw7CiAgICAgICAgICAgICAgICBkZWxldGUgZXhwb3J0cy5Db25maWcuYlVzZVRocmlkT25GYWlsOwogICAgICAgICAgICAgICAgZGVsZXRlIGV4cG9ydHMuQ29uZmlnLmJQcm94eUluc3RhbGxlZDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgR01fc2V0VmFsdWUoU2NyaXB0XzIuU2NyaXB0Lk5hbWUsIEpTT04uc3RyaW5naWZ5KGV4cG9ydHMuQ29uZmlnKSk7CiAgICB9CiAgICBpZiAoZXhwb3J0cy5Db25maWcuYkRpYXBsYXlMb2cpCiAgICAgICAgTG9nZ2VyXzEuRW5hYmxlTG9ncygpOwp9KTsKZGVmaW5lKCJoZWxwZXIvRXh0ZW5zaW9uIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICBmdW5jdGlvbiBCZWdpbldpdGgoc3RyLCB3aGF0KSB7CiAgICAgICAgcmV0dXJuIHN0ci5pbmRleE9mKHdoYXQpID09PSAwOwogICAgfQogICAgZXhwb3J0cy5CZWdpbldpdGggPSBCZWdpbldpdGg7CiAgICBmdW5jdGlvbiBFbmRXaXRoKHN0ciwgd2hhdCkgewogICAgICAgIHJldHVybiBzdHIuc2xpY2UoLXdoYXQubGVuZ3RoKSA9PSB3aGF0OwogICAgfQogICAgZXhwb3J0cy5FbmRXaXRoID0gRW5kV2l0aDsKICAgIGZ1bmN0aW9uIENvbnRhaW5zKHN0ciwgd2hhdCkgewogICAgICAgIHJldHVybiBzdHIuaW5kZXhPZih3aGF0KSAhPSAtMTsKICAgIH0KICAgIGV4cG9ydHMuQ29udGFpbnMgPSBDb250YWluczsKICAgIGZ1bmN0aW9uIEdldEZpcnN0S2V5KG9iaikgewogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhvYmopWzBdOwogICAgfQogICAgZXhwb3J0cy5HZXRGaXJzdEtleSA9IEdldEZpcnN0S2V5OwogICAgZnVuY3Rpb24gR2V0Rmlyc3RWYWx1ZShvYmopIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gb2JqW0dldEZpcnN0S2V5KG9iaildOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgfQogICAgZXhwb3J0cy5HZXRGaXJzdFZhbHVlID0gR2V0Rmlyc3RWYWx1ZTsKICAgIC8qKgogICAgICog5LuO6ZO+5o6l6I635Y+W5paH5Lu25ZCO57yA5ZCN44CCCiAgICAgKiDljIXmi6wgYC5gIOWtl+espu+8jOWmgiBgLnRzYAogICAgICovCiAgICBmdW5jdGlvbiBHZXRFeHRlbnNpb25Gcm9tVXJsKHVybCkgewogICAgICAgIHZhciBtID0gdXJsLm1hdGNoKC8uK1wvKD86W14uXSsoXC4uKz8pKSg/Olw/fCQpLyk7CiAgICAgICAgcmV0dXJuIG0gPyBtWzFdIDogbnVsbDsKICAgIH0KICAgIGV4cG9ydHMuR2V0RXh0ZW5zaW9uRnJvbVVybCA9IEdldEV4dGVuc2lvbkZyb21Vcmw7CiAgICAvLyBGaXNoZXItWWF0ZXMgU2h1ZmZsZSBieSBjb21tdW5pdHkgd2lraSg/KQogICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNjI3NDM5OAogICAgZnVuY3Rpb24gU2h1ZmZsZShhcnJheSkgewogICAgICAgIHZhciBjb3VudGVyID0gYXJyYXkubGVuZ3RoOwogICAgICAgIHZhciB0ZW1wLCBpbmRleDsKICAgICAgICAvLyBXaGlsZSB0aGVyZSBhcmUgZWxlbWVudHMgaW4gdGhlIGFycmF5CiAgICAgICAgd2hpbGUgKGNvdW50ZXIgPiAwKSB7CiAgICAgICAgICAgIC8vIFBpY2sgYSByYW5kb20gaW5kZXgKICAgICAgICAgICAgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb3VudGVyKTsKICAgICAgICAgICAgLy8gRGVjcmVhc2UgY291bnRlciBieSAxCiAgICAgICAgICAgIGNvdW50ZXItLTsKICAgICAgICAgICAgLy8gQW5kIHN3YXAgdGhlIGxhc3QgZWxlbWVudCB3aXRoIGl0CiAgICAgICAgICAgIHRlbXAgPSBhcnJheVtjb3VudGVyXTsKICAgICAgICAgICAgYXJyYXlbY291bnRlcl0gPSBhcnJheVtpbmRleF07CiAgICAgICAgICAgIGFycmF5W2luZGV4XSA9IHRlbXA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBhcnJheTsKICAgIH0KICAgIGV4cG9ydHMuU2h1ZmZsZSA9IFNodWZmbGU7Cn0pOwovLy8gPHJlZmVyZW5jZSBwYXRoPSIuLi90eXBpbmdzL2dsb2JhbHMvanF1ZXJ5L2luZGV4LmQudHMiIC8+CmRlZmluZSgiaGVscGVyL1F1ZXJ5U3RyaW5nIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL0V4dGVuc2lvbiJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgRXh0ZW5zaW9uXzEpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICBmdW5jdGlvbiBHZXRGbGFzaFZhcnMoZWwpIHsKICAgICAgICBpZiAoIWVsKQogICAgICAgICAgICByZXR1cm4ge307CiAgICAgICAgdmFyIGVsZSA9ICgnanF1ZXJ5JyBpbiBlbCA/IGVsWzBdIDogZWwpOwogICAgICAgIGlmIChlbGUuZ2V0QXR0cmlidXRlKCd0eXBlJykgIT0gJ2ZsYXNoJykKICAgICAgICAgICAgcmV0dXJuIHt9OwogICAgICAgIHZhciBmbGFzaFZhcnMgPSB7fTsKICAgICAgICB2YXIgc2l6ZSA9IGVsZS5jaGlsZE5vZGVzLmxlbmd0aDsKICAgICAgICB2YXIgZmxhc2hPYmplY3Q7CiAgICAgICAgZm9yIChsZXQgaSA9IHNpemU7IGktLTspIHsKICAgICAgICAgICAgaWYgKGVsZS5jaGlsZE5vZGVzW2ldLm5hbWUgPT0gJ2ZsYXNodmFycycpIHsKICAgICAgICAgICAgICAgIGZsYXNoT2JqZWN0ID0gZWxlLmNoaWxkTm9kZXNbaV07CiAgICAgICAgICAgICAgICBmbGFzaE9iamVjdC52YWx1ZS5yZXBsYWNlKC8mYW1wOy9nLCAnJicpCiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyhbXHNcU10rPyk9KFtcc1xTXSs/KSgmfCQpL2csIChuLCBrZXksIHZhbHVlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgLy8g5Yip55So5q2j5YiZ55qE5om56YeP5pu/5o2i5Yqf6IO95oqT5Y+W5pWw5o2uCiAgICAgICAgICAgICAgICAgICAgZmxhc2hWYXJzW2tleV0gPSBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGZsYXNoVmFyczsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4ge307CiAgICB9CiAgICBleHBvcnRzLkdldEZsYXNoVmFycyA9IEdldEZsYXNoVmFyczsKICAgIGZ1bmN0aW9uIFBhcnNlKHF1ZXJ5KSB7CiAgICAgICAgdmFyIHVybFBhcmFtczsKICAgICAgICBpZiAoRXh0ZW5zaW9uXzEuQ29udGFpbnMocXVlcnksICc/JykpIHsKICAgICAgICAgICAgdXJsUGFyYW1zID0gcXVlcnkuc2xpY2UocXVlcnkuaW5kZXhPZignPycpICsgMSkuc3BsaXQoJyYnKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHVybFBhcmFtcyA9IHF1ZXJ5LnNwbGl0KCcmJyk7CiAgICAgICAgfQogICAgICAgIHZhciByZXQgPSB7fTsKICAgICAgICB2YXIgcXVlcnlTdHI7CiAgICAgICAgdmFyIHBvc0VxdWFsOwogICAgICAgIGZvciAodmFyIGkgPSB1cmxQYXJhbXMubGVuZ3RoOyBpLS07KSB7CiAgICAgICAgICAgIHF1ZXJ5U3RyID0gdXJsUGFyYW1zW2ldLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIHBvc0VxdWFsID0gcXVlcnlTdHIuaW5kZXhPZignPScpOwogICAgICAgICAgICBpZiAocG9zRXF1YWwgPT0gLTEpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgcmV0W2RlY29kZVVSSUNvbXBvbmVudChxdWVyeVN0ci5zbGljZSgwLCBwb3NFcXVhbCkpXSA9CiAgICAgICAgICAgICAgICBkZWNvZGVVUklDb21wb25lbnQocXVlcnlTdHIuc2xpY2UocG9zRXF1YWwgKyAxKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXQ7CiAgICB9CiAgICBleHBvcnRzLlBhcnNlID0gUGFyc2U7Cn0pOwpkZWZpbmUoImhlbHBlci9TdHlsZVNoZWV0IiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICBjbGFzcyBTdHlsZVNoZWV0IHsKICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgdGhpcy5zdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CiAgICAgICAgICAgIHRoaXMuQXBwbHkoKTsKICAgICAgICB9CiAgICAgICAgQWRkKC4uLnN0eWxlVGV4dCkgewogICAgICAgICAgICB0aGlzLnN0eWxlLnRleHRDb250ZW50ICs9ICdcbicgKyBzdHlsZVRleHQuam9pbignXG4nKTsKICAgICAgICB9CiAgICAgICAgSGlkZShzZWxlY3RvciwgLi4uc2VsZWN0b3JzKSB7CiAgICAgICAgICAgIGlmICgnc3RyaW5nJyA9PSB0eXBlb2Ygc2VsZWN0b3IpIHsKICAgICAgICAgICAgICAgIHNlbGVjdG9ycy5zcGxpY2UoMCwgMCwgc2VsZWN0b3IpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgc2VsZWN0b3JzID0gc2VsZWN0b3I7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHN0eWxlVGV4dCA9IGAke3NlbGVjdG9ycy5qb2luKCcsICcpfSB7IGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudCB9YDsKICAgICAgICAgICAgdGhpcy5BZGQoc3R5bGVUZXh0KTsKICAgICAgICB9CiAgICAgICAgU2hvdyhzZWxlY3RvciwgLi4uc2VsZWN0b3JzKSB7CiAgICAgICAgICAgIGlmICgnc3RyaW5nJyA9PSB0eXBlb2Ygc2VsZWN0b3IpIHsKICAgICAgICAgICAgICAgIHNlbGVjdG9ycy5zcGxpY2UoMCwgMCwgc2VsZWN0b3IpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgc2VsZWN0b3JzID0gc2VsZWN0b3I7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHN0eWxlVGV4dCA9IGAke3NlbGVjdG9ycy5qb2luKCcsICcpfSB7IGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQgfWA7CiAgICAgICAgICAgIHRoaXMuQWRkKHN0eWxlVGV4dCk7CiAgICAgICAgfQogICAgICAgIEhpZGVGcmFtZXMoKSB7CiAgICAgICAgICAgIHRoaXMuSGlkZSgnZnJhbWUsIGlmcmFtZSwgZnJhbWVzZXQnKTsKICAgICAgICB9CiAgICAgICAgQXBwbHkoYm9keSA9IHRydWUpIHsKICAgICAgICAgICAgaWYgKGJvZHkgJiYgZG9jdW1lbnQuYm9keSkgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnN0eWxlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQodGhpcy5zdHlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBleHBvcnRzLlN0eWxlU2hlZXQgPSBTdHlsZVNoZWV0Owp9KTsKZGVmaW5lKCJoZWxwZXIvRG93bmxvYWRlciIsIFsicmVxdWlyZSIsICJleHBvcnRzIiwgImhlbHBlci9TY3JpcHQiLCAiaGVscGVyL1NjcmlwdENvbmZpZyIsICJoZWxwZXIvRXh0ZW5zaW9uIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBTY3JpcHRfMywgU2NyaXB0Q29uZmlnXzEsIEV4dGVuc2lvbl8yKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgLy8vIDxyZWZlcmVuY2UgcGF0aD0iLi4vdHlwaW5ncy9Vc2Vyc2NyaXB0LmQudHMiIC8+CiAgICAvLy8gPHJlZmVyZW5jZSBwYXRoPSIuLi90eXBpbmdzL0dNX0FyaWEyUlBDLmQudHMiIC8+CiAgICAvLy8gPHJlZmVyZW5jZSBwYXRoPSIuLi90eXBpbmdzL2dsb2JhbHMvanF1ZXJ5L2luZGV4LmQudHMiIC8+CiAgICB2YXIgY29uZmlnID0gU2NyaXB0Q29uZmlnXzEuQ29uZmlnOwogICAgY2xhc3MgRG93bmxvYWRlciB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMuX2NhcHR1cmVkID0gZmFsc2U7CiAgICAgICAgICAgIC8vIFRPRE86ID8/CiAgICAgICAgfQogICAgICAgIEdlbmVyYXRlVXJsUGFydCh1cmwsIGZpbGVuYW1lLCByZWYpIHsKICAgICAgICAgICAgcmV0dXJuIGAke3VybH18JHt0aGlzLkdldFJlZmVycmVyVXJsKGZpbGVuYW1lKX18JHt0aGlzLkdldFJlZmVycmVyVXJsKHJlZil9YDsKICAgICAgICB9CiAgICAgICAgR2V0UmVmZXJyZXJVcmwodXJsKSB7CiAgICAgICAgICAgIHJldHVybiBTdHJpbmcodXJsIHx8IGxvY2F0aW9uLmhyZWYpLnJlcGxhY2UoLyMuKi8sICcnKTsKICAgICAgICB9CiAgICAgICAgTm9ybWFsaXNlRmlsZW5hbWUoZmlsZW5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhmaWxlbmFtZSkucmVwbGFjZSgvWyciXC9cXDp8XS9nLCAnXycpOwogICAgICAgIH0KICAgICAgICBHZW5lcmF0ZVVyaSh1cmwsIGZpbGVuYW1lLCByZWYpIHsKICAgICAgICAgICAgc3dpdGNoIChjb25maWcuZFVyaVR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgU2NyaXB0Q29uZmlnXzEuVXJpVHlwZS5DdXN0b206CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBjdXdjbDRjOi8vfDF8JHt0aGlzLkdlbmVyYXRlVXJsUGFydCh1cmwsIGZpbGVuYW1lLCByZWYpfWA7CiAgICAgICAgICAgICAgICBjYXNlIFNjcmlwdENvbmZpZ18xLlVyaVR5cGUuQXJpYToKICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NhcHR1cmVkKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLkNhcHR1cmVBcmlhKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBhcmlhMjovL3wke3RoaXMuR2VuZXJhdGVVcmxQYXJ0KHVybCwgZmlsZW5hbWUsIHJlZil9YDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdXJsOwogICAgICAgIH0KICAgICAgICBDYXB0dXJlQXJpYShlbCkgewogICAgICAgICAgICB0aGlzLl9jYXB0dXJlZCA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuU2V0dXBBcmlhKGZhbHNlKTsKICAgICAgICAgICAgaWYgKCFlbCkKICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuYm9keTsKICAgICAgICAgICAgJChlbCkuY2xpY2soKGUpID0+IHsKICAgICAgICAgICAgICAgIHZhciBlbCA9IGUudGFyZ2V0OwogICAgICAgICAgICAgICAgdmFyICRlbCA9ICQoZWwpOwogICAgICAgICAgICAgICAgdmFyIGxpbmtFbCA9ICgkZWwuaXMoJ2EnKSA/IGVsIDogJGVsLnBhcmVudHMoJ2EnKVswXSk7CiAgICAgICAgICAgICAgICBpZiAobGlua0VsICYmIGxpbmtFbC50YWdOYW1lID09ICdBJyAmJiBFeHRlbnNpb25fMi5CZWdpbldpdGgobGlua0VsLmhyZWYsICdhcmlhMjovL3wnKSkgewogICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gbGlua0VsLmhyZWYuc3BsaXQoJ3wnKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLkFkZFRvQXJpYShsaW5rWzFdLCBkZWNvZGVVUklDb21wb25lbnQobGlua1syXSksIGxpbmtbM10sIGxpbmtFbC5jbGFzc0xpc3QuY29udGFpbnMoJ2FyaWEtY29va2llJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgQWRkVG9BcmlhKHVybCwgZmlsZW5hbWUsIHJlZmVyZXIsIGNvb2tpZSwgaGVhZGVycykgewogICAgICAgICAgICB2YXIgYXJpYVBhcmFtID0gewogICAgICAgICAgICAgICAgb3V0OiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgIHJlZmVyZXI6IHJlZmVyZXIgfHwgbG9jYXRpb24uaHJlZiwKICAgICAgICAgICAgICAgIGRpcjogY29uZmlnLnNBcmlhX2RpciwKICAgICAgICAgICAgICAgICd1c2VyLWFnZW50JzogbmF2aWdhdG9yLnVzZXJBZ2VudCwKICAgICAgICAgICAgICAgIGhlYWRlcjogaGVhZGVycyB8fCBbXQogICAgICAgICAgICB9OwogICAgICAgICAgICBpZiAoY29va2llID09PSB0cnVlKQogICAgICAgICAgICAgICAgY29va2llID0gZG9jdW1lbnQuY29va2llOwogICAgICAgICAgICBpZiAoY29va2llKQogICAgICAgICAgICAgICAgYXJpYVBhcmFtLmhlYWRlci5wdXNoKCdDb29raWU6ICcgKyBjb29raWUpOwogICAgICAgICAgICB0aGlzLmFyaWEuYWRkVXJpKFt1cmxdLCBhcmlhUGFyYW0sIChyKSA9PiB7IH0sIChiLCByKSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgc0Vycm9yTXNnOwogICAgICAgICAgICAgICAgaWYgKHIuZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICBzRXJyb3JNc2cgPSBg6ZSZ6K+v5Luj56CBICR7ci5lcnJvci5jb2RlfTogJHtyLmVycm9yLm1lc3NhZ2V9YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNFcnJvck1zZyA9ICLkuI4gQXJpYTIg5ZCO5Y+w6YCa5L+h5aSx6LSlLCDmnI3liqHmnKrlvIDlkK8/IjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGFsZXJ0KGBbJHtTY3JpcHRfMy5TY3JpcHQuTmFtZX1dIOaPkOS6pOS7u+WKoeWPkeeUn+mUmeivryEKCiR7c0Vycm9yTXNnfWApOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgU2V0dXBBcmlhKGZvcmNlU2V0dXApIHsKICAgICAgICAgICAgaWYgKGZvcmNlU2V0dXAgfHwgIXRoaXMuYXJpYSkgewogICAgICAgICAgICAgICAgdGhpcy5hcmlhID0gbmV3IEFyaWEyKHsKICAgICAgICAgICAgICAgICAgICBhdXRoOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGNvbmZpZy5kQXJpYV9hdXRoLAogICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiBjb25maWcuc0FyaWFfdXNlciwKICAgICAgICAgICAgICAgICAgICAgICAgcGFzczogY29uZmlnLnNBcmlhX3Bhc3MKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGhvc3Q6IGNvbmZpZy5zQXJpYV9ob3N0LAogICAgICAgICAgICAgICAgICAgIHBvcnQ6IGNvbmZpZy5kQXJpYV9wb3J0CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBBZGREb3dubG9hZCh1cmwsIGZpbGUpIHsKICAgICAgICAgICAgaWYgKGNvbmZpZy5kVXJpVHlwZSA9PSBTY3JpcHRDb25maWdfMS5VcmlUeXBlLkFyaWEpIHsKICAgICAgICAgICAgICAgIHRoaXMuQWRkVG9BcmlhKHVybCwgZmlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBHTV9vcGVuSW5UYWIodGhpcy5HZW5lcmF0ZVVyaSh1cmwsIGZpbGUpLCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGV4cG9ydHMuRG93bmxvYWRlciA9IERvd25sb2FkZXI7Cn0pOwpkZWZpbmUoIlNpdGVSdWxlIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL0NvbnN0YW50cyIsICJoZWxwZXIvRXh0ZW5zaW9uIiwgImhlbHBlci9TdHlsZVNoZWV0IiwgImhlbHBlci9Mb2dnZXIiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIENvbnN0YW50c18xLCBFeHRlbnNpb25fMywgU3R5bGVTaGVldF8xLCBMb2dnZXJfMikgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIC8vLyA8cmVmZXJlbmNlIHBhdGg9Ii4uL3R5cGluZ3MvZ2xvYmFscy9qcXVlcnkvaW5kZXguZC50cyIgLz4KICAgIGV4cG9ydHMuU2l0ZXMgPSBbXTsKICAgIGZ1bmN0aW9uIEFkZChzaXRlUnVsZSkgewogICAgICAgIHNpdGVSdWxlLl9zdHlsZUFwcGxpZWQgPSBmYWxzZTsKICAgICAgICBleHBvcnRzLlNpdGVzLnB1c2goc2l0ZVJ1bGUpOwogICAgfQogICAgZXhwb3J0cy5BZGQgPSBBZGQ7CiAgICBmdW5jdGlvbiBDaGVja1BhdGgocGF0aCwgcnVsZSkgewogICAgICAgIGlmICgkLmlzQXJyYXkocnVsZSkpIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IHJ1bGUubGVuZ3RoOyBpLS07KSB7CiAgICAgICAgICAgICAgICBpZiAoQ2hlY2tQYXRoKHBhdGgsIHJ1bGVbaV0pKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKHJ1bGUpKSB7CiAgICAgICAgICAgIHJldHVybiBydWxlKHBhdGgpOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIHJ1bGUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgIHJldHVybiBFeHRlbnNpb25fMy5CZWdpbldpdGgocGF0aCwgcnVsZSk7CiAgICAgICAgfQogICAgICAgIGlmIChydWxlIGluc3RhbmNlb2YgUmVnRXhwKSB7CiAgICAgICAgICAgIHJldHVybiBydWxlLnRlc3QocGF0aCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGV4cG9ydHMuQ2hlY2tQYXRoID0gQ2hlY2tQYXRoOwogICAgZnVuY3Rpb24gQ2hlY2soc2l0ZSwgZXZlbnQpIHsKICAgICAgICBpZiAoc2l0ZS5zdWJNb2R1bGUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIHNpdGUuaG9zdCA9PSAnc3RyaW5nJykgewogICAgICAgICAgICBzaXRlLmhvc3QgPSBbc2l0ZS5ob3N0XTsKICAgICAgICB9CiAgICAgICAgdmFyIGhvc3RzID0gc2l0ZS5ob3N0Lm1hcCgoaG9zdCkgPT4gewogICAgICAgICAgICByZXR1cm4gaG9zdC50b0xvd2VyQ2FzZSgpOwogICAgICAgIH0pOwogICAgICAgIGlmICghRXh0ZW5zaW9uXzMuQ29udGFpbnMoaG9zdHMsIENvbnN0YW50c18xLmxvd2VySG9zdCkpIHsKICAgICAgICAgICAgaWYgKHNpdGUubm9TdWJIb3N0KQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB2YXIgbWF0Y2hlZCA9IGZhbHNlOwogICAgICAgICAgICBmb3IgKHZhciBpID0gaG9zdHMubGVuZ3RoOyBpLS07KSB7CiAgICAgICAgICAgICAgICBpZiAoRXh0ZW5zaW9uXzMuRW5kV2l0aChgLiR7aG9zdHNbaV19YCwgQ29uc3RhbnRzXzEudG9wSG9zdE1hc2spKSB7CiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFtYXRjaGVkKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoc2l0ZS5wYXRoKSB7CiAgICAgICAgICAgIHJldHVybiBDaGVja1BhdGgobG9jYXRpb24ucGF0aG5hbWUsIHNpdGUucGF0aCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgZXhwb3J0cy5DaGVjayA9IENoZWNrOwogICAgZnVuY3Rpb24gR2V0KGlkKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IGV4cG9ydHMuU2l0ZXMubGVuZ3RoOyBpLS07KSB7CiAgICAgICAgICAgIGlmIChleHBvcnRzLlNpdGVzW2ldLmlkID09IGlkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5TaXRlc1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIGV4cG9ydHMuR2V0ID0gR2V0OwogICAgZnVuY3Rpb24gRXhlY3V0ZShpZCwgZXZlbnQpIHsKICAgICAgICBzd2l0Y2ggKGV2ZW50LnRvTG93ZXJDYXNlKCkpIHsKICAgICAgICAgICAgY2FzZSAnc3RhcnQnOgogICAgICAgICAgICAgICAgR2V0KGlkKS5vblN0YXJ0KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYm9keSc6CiAgICAgICAgICAgICAgICBHZXQoaWQpLm9uQm9keSgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogICAgZXhwb3J0cy5FeGVjdXRlID0gRXhlY3V0ZTsKICAgIGZ1bmN0aW9uIEZpcmVFdmVudChldmVudCkgewogICAgICAgIGZvciAodmFyIGkgPSBleHBvcnRzLlNpdGVzLmxlbmd0aDsgaS0tOykgewogICAgICAgICAgICB2YXIgcnVsZSA9IGV4cG9ydHMuU2l0ZXNbaV07CiAgICAgICAgICAgIGlmIChDb25zdGFudHNfMS5pc0ZyYW1lICYmICFydWxlLnJ1bkluRnJhbWUpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYgKENoZWNrKHJ1bGUsIGV2ZW50KSkgewogICAgICAgICAgICAgICAgUnVuKHJ1bGUsIGV2ZW50KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGV4cG9ydHMuRmlyZUV2ZW50ID0gRmlyZUV2ZW50OwogICAgZnVuY3Rpb24gUnVuKHNpdGUsIGV2ZW50TmFtZSkgewogICAgICAgIHZhciBldmVudDsKICAgICAgICBzd2l0Y2ggKGV2ZW50TmFtZS50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgIGNhc2UgJ3N0YXJ0JzoKICAgICAgICAgICAgICAgIGV2ZW50ID0gc2l0ZS5vblN0YXJ0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2JvZHknOgogICAgICAgICAgICAgICAgZXZlbnQgPSBzaXRlLm9uQm9keTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgTG9nZ2VyXzIuZXJyb3IoYOaXoOaViOeahOS6i+S7tiAke2V2ZW50TmFtZX1gKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCFzaXRlLl9zdHlsZUFwcGxpZWQpIHsKICAgICAgICAgICAgc2l0ZS5fc3R5bGVBcHBsaWVkID0gdHJ1ZTsKICAgICAgICAgICAgc2l0ZS5zdHlsZSA9IG5ldyBTdHlsZVNoZWV0XzEuU3R5bGVTaGVldCgpOwogICAgICAgICAgICBpZiAoc2l0ZS5oaWRlKSB7CiAgICAgICAgICAgICAgICBzaXRlLnN0eWxlLkhpZGUoc2l0ZS5oaWRlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2l0ZS5zaG93KSB7CiAgICAgICAgICAgICAgICBzaXRlLnN0eWxlLlNob3coc2l0ZS5zaG93KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2l0ZS5jc3MpIHsKICAgICAgICAgICAgICAgIHNpdGUuc3R5bGUuQWRkKHNpdGUuY3NzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2l0ZS5kbF9pY29uKSB7CiAgICAgICAgICAgICAgICBzaXRlLnN0eWxlLkFkZChgCiAgICAgICAgICAgIApAZm9udC1mYWNlIHsKCWZvbnQtZmFtaWx5OiBjY2M7CglzcmM6IHVybChodHRwczovL2Nkbi5ib290Y3NzLmNvbS9mb250LWF3ZXNvbWUvNC4yLjAvZm9udHMvZm9udGF3ZXNvbWUtd2ViZm9udC53b2ZmKSBmb3JtYXQoJ3dvZmYnKTsKCWZvbnQtd2VpZ2h0OiBub3JtYWw7Cglmb250LXN0eWxlOiBub3JtYWw7Cn0KCiR7Q29uc3RhbnRzXzEuZG93bmxvYWRJY29uU2VsZWN0b3J9OjpiZWZvcmUgewoJZm9udC1mYW1pbHk6IGNjYzsKCWNvbnRlbnQ6ICJcXGYwMTkiOwoJcGFkZGluZy1yaWdodDogLjVlbTsKfQoKLmp4X2hpZGUgewoJZGlzcGxheTogbm9uZTsKfQoKICAgICAgICAgICAgYCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2l0ZS5zdHlsZS5BcHBseSh0cnVlKTsKICAgICAgICBpZiAoIWV2ZW50KQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgTG9nZ2VyXzIuaW5mbyhg5omn6KGM6KeE5YiZOiAke3NpdGUuaWR9IOS6jiAke3NpdGUubmFtZX0gW+S6i+S7tjogJHtldmVudE5hbWV9XWApOwogICAgICAgIGV2ZW50LmNhbGwodGhpcyk7CiAgICB9CiAgICBleHBvcnRzLlJ1biA9IFJ1bjsKfSk7CmRlZmluZSgic2l0ZS9BQS5Db25maWciLCBbInJlcXVpcmUiLCAiZXhwb3J0cyIsICJoZWxwZXIvQ29uc3RhbnRzIiwgImhlbHBlci9TY3JpcHRDb25maWciLCAiaGVscGVyL1NjcmlwdCIsICJoZWxwZXIvRG93bmxvYWRlciJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgQ29uc3RhbnRzXzIsIFNjcmlwdENvbmZpZ18yLCBTY3JpcHRfNCwgRG93bmxvYWRlcl8xKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgdmFyIHJ1bGUgPSB7CiAgICAgICAgYmQ6IG51bGwsCiAgICAgICAgaWQ6ICdpbnRlcm5hbC5jb25maWcnLAogICAgICAgIG5hbWU6ICfohJrmnKzphY3nva7pobXpnaInLAogICAgICAgIHN1Yk1vZHVsZTogZmFsc2UsCiAgICAgICAgaW5jbHVkZVN1Ykhvc3Q6IGZhbHNlLAogICAgICAgIGhvc3Q6IFsnbG9jYWxob3N0LmN1d2NsNGMnLCAnaml4dW5tb2UuZ2l0aHViLmlvJ10sCiAgICAgICAgcGF0aDogWycvY29uZmlnLycsICcvY3V3Y2w0Yy9jb25maWcnXSwKICAgICAgICBvblN0YXJ0OiAoKSA9PiB7CiAgICAgICAgICAgIHVuc2FmZVdpbmRvdy5yU2NyaXB0VmVyc2lvbiA9IENvbnN0YW50c18yLnZlcnNpb247CiAgICAgICAgICAgIHVuc2FmZVdpbmRvdy5yU2NyaXB0Q29uZmlnID0gSlNPTi5zdHJpbmdpZnkoU2NyaXB0Q29uZmlnXzIuQ29uZmlnKTsKICAgICAgICAgICAgdmFyIF9jID0gY29uZmlybTsKICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignU2F2ZUNvbmZpZycsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSBKU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKGUuZGV0YWlsKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfop6PmnpDorr7lrprlgLzlh7rplJkhJyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKF9jKGDnoa7lrprlgqjlrZjorr7lrproh7MgJHtTY3JpcHRfNC5TY3JpcHQuTmFtZX0/YCkpCiAgICAgICAgICAgICAgICAgICAgR01fc2V0VmFsdWUoU2NyaXB0XzQuU2NyaXB0Lk5hbWUsIGNvbmZpZyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgb25Cb2R5OiAoKSA9PiB7CiAgICAgICAgICAgIHJ1bGUuYmQgPSBuZXcgRG93bmxvYWRlcl8xLkRvd25sb2FkZXIoKTsKICAgICAgICAgICAgcnVsZS5iZC5DYXB0dXJlQXJpYSgpOwogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW3J1bGVdOwp9KTsKZGVmaW5lKCJoZWxwZXIvV2FpdCIsIFsicmVxdWlyZSIsICJleHBvcnRzIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgLy8vIDxyZWZlcmVuY2UgcGF0aD0iLi4vdHlwaW5ncy9nbG9iYWxzL2pxdWVyeS9pbmRleC5kLnRzIiAvPgogICAgZnVuY3Rpb24gV2FpdFVudGlsKGNoZWNrLCBjYiwgblRpbWVvdXQgPSAxMDAwMCwgbkludGVydmFsID0gMTUwKSB7CiAgICAgICAgaWYgKCdzdHJpbmcnID09IHR5cGVvZiBjaGVjaykgewogICAgICAgICAgICBjaGVjayA9IGNoZWNrLnNwbGl0KCcuJyk7CiAgICAgICAgfQogICAgICAgIHZhciBpc1JlYWR5OwogICAgICAgIGlmICgkLmlzQXJyYXkoY2hlY2spKSB7CiAgICAgICAgICAgIGlzUmVhZHkgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgciA9IHVuc2FmZVdpbmRvdzsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hlY2subGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICByID0gcltjaGVja1tpXV07CiAgICAgICAgICAgICAgICAgICAgaWYgKCFyKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlzUmVhZHkgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGVjaygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgIGlmICghaXNSZWFkeSgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAgICAgICAgIGNiLmNhbGwodGhpcyk7CiAgICAgICAgfSwgbkludGVydmFsKTsKICAgICAgICBpZiAoblRpbWVvdXQgIT09IHRydWUpIHsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTsKICAgICAgICAgICAgfSwgblRpbWVvdXQpOwogICAgICAgIH0KICAgIH0KICAgIGV4cG9ydHMuV2FpdFVudGlsID0gV2FpdFVudGlsOwp9KTsKZGVmaW5lKCJoZWxwZXIvUmVkaXJlY3QiLCBbInJlcXVpcmUiLCAiZXhwb3J0cyIsICJoZWxwZXIvV2FpdCIsICJoZWxwZXIvRXh0ZW5zaW9uIiwgImhlbHBlci9Mb2dnZXIiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFdhaXRfMSwgRXh0ZW5zaW9uXzQsIExvZ2dlcl8zKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgLy8vIDxyZWZlcmVuY2UgcGF0aD0iLi4vdHlwaW5ncy9nbG9iYWxzL2pxdWVyeS9pbmRleC5kLnRzIiAvPgogICAgLyoqCiAgICAgKiDot7PovazlkI7kv53nlZnlvZPliY3pobXpnaLkvZzkuLogcmVmZXJyZXIuCiAgICAgKi8KICAgIGZ1bmN0aW9uIFJlZGlyZWN0VG8odXJsKSB7CiAgICAgICAgTG9nZ2VyXzMuaW5mbyhg5YeG5aSH6Lez6L2sICR7dXJsfS4uLmApOwogICAgICAgIHZhciBsaW5rID0gJCgnPGE+JykKICAgICAgICAgICAgLmF0dHIoJ2hyZWYnLCB1cmwpCiAgICAgICAgICAgIC50ZXh0KGDmraPlnKjot7PovawgWyR7dXJsfV0sIOivt+eojeWQji4uIGApCiAgICAgICAgICAgIC5wcmVwZW5kVG8oZG9jdW1lbnQuYm9keSkKICAgICAgICAgICAgLmNzcyh7IGZvbnRTaXplOiAxMiwgY29sb3I6ICdpbmhlcml0JyB9KTsKICAgICAgICBsaW5rWzBdLmNsaWNrKCk7CiAgICB9CiAgICBleHBvcnRzLlJlZGlyZWN0VG8gPSBSZWRpcmVjdFRvOwogICAgLyoqCiAgICAgKiBwaHBEaXNrIOmAmueUqOi3s+i9rOaWh+S7tuS4i+i9vemhtemdouWHveaVsAogICAgICoKICAgICAqIOi/lOWbniB0cnVlIOS7o+ihqOaIkOWKnwogICAgICog5ZCm5YiZ5Luj6KGo5om+5LiN5Yiw6KeE5YiZ44CCCiAgICAgKi8KICAgIGZ1bmN0aW9uIHBocGRpc2tBdXRvUmVkaXJlY3QoY2FsbGJhY2spIHsKICAgICAgICBpZiAoIWNhbGxiYWNrKSB7CiAgICAgICAgICAgIGNhbGxiYWNrID0gZG9jdW1lbnQuYm9keSA/IFJlZGlyZWN0VG8gOiAodXJsKSA9PiB7CiAgICAgICAgICAgICAgICBXYWl0XzEuV2FpdFVudGlsKCdkb2N1bWVudC5ib2R5JywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgIFJlZGlyZWN0VG8odXJsKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICB2YXIgckNoZWNrUGF0aCA9IC9cLyhmaWxlKT8oZmlsZXx2aWV3KShbXC8uXC1fXS4qKS87CiAgICAgICAgaWYgKHJDaGVja1BhdGgudGVzdChsb2NhdGlvbi5wYXRobmFtZSkpIHsKICAgICAgICAgICAgY2FsbGJhY2sobG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZShyQ2hlY2tQYXRoLCAnLyQxZG93biQzJykpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChFeHRlbnNpb25fNC5CZWdpbldpdGgobG9jYXRpb24ucGF0aG5hbWUsICcvdmlld2ZpbGUnKSkgewogICAgICAgICAgICBjYWxsYmFjayhsb2NhdGlvbi5wYXRobmFtZS5yZXBsYWNlKCcvdmlld2ZpbGUnLCAnL2Rvd25sb2FkJykpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGV4cG9ydHMucGhwZGlza0F1dG9SZWRpcmVjdCA9IHBocGRpc2tBdXRvUmVkaXJlY3Q7Cn0pOwpkZWZpbmUoInNpdGUvZGwuMTIzNTY0IiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL0V4dGVuc2lvbiIsICJoZWxwZXIvUmVkaXJlY3QiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIEV4dGVuc2lvbl81LCBSZWRpcmVjdF8xKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgLy8vIDxyZWZlcmVuY2UgcGF0aD0iLi4vdHlwaW5ncy9nbG9iYWxzL2pxdWVyeS9pbmRleC5kLnRzIiAvPgogICAgdmFyIHJ1bGUgPSB7CiAgICAgICAgaWQ6ICdkbC4xMjM1NjQnLAogICAgICAgIG5hbWU6ICcxMjM1NjQg572R55uYJywKICAgICAgICBob3N0OiBbJzEyMzU2NC5jb20nLCAnbS4xMjM1NjQuY29tJ10sCiAgICAgICAgaW5jbHVkZVN1Ykhvc3Q6IGZhbHNlLAogICAgICAgIHN1Yk1vZHVsZTogZmFsc2UsCiAgICAgICAgaGlkZTogJyN5em0nLAogICAgICAgIHNob3c6ICcjZG93bmxvYWQnLAogICAgICAgIGNzczogYAouYWQxLCAuYWQ0ewogICAgaGVpZ2h0OiA5OTlweCAhaW1wb3J0YW50OwogICAgd2lkdGg6ICAwcHggICAhaW1wb3J0YW50Owp9CiAgICBgLAogICAgICAgIG9uU3RhcnQ6ICgpID0+IHsKICAgICAgICAgICAgdW5zYWZlV2luZG93LmtpbGxwYW5hZHMgPSAxOwogICAgICAgIH0sCiAgICAgICAgb25Cb2R5OiAoKSA9PiB7CiAgICAgICAgICAgIC8vIOaWh+S7tuesrOS4gOmhtQogICAgICAgICAgICB2YXIgdXJsID0gJCgnLmNhb2N1byAuanViYW8nKS5uZXh0KCkuZmluZCgnYScpLmF0dHIoJ2hyZWYnKTsKICAgICAgICAgICAgaWYgKHVybCkgewogICAgICAgICAgICAgICAgUmVkaXJlY3RfMS5SZWRpcmVjdFRvKHVybCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoRXh0ZW5zaW9uXzUuQ29udGFpbnMobG9jYXRpb24ucGF0aG5hbWUsICcvZG93bnBhbmVsLmFzcCcpKSB7CiAgICAgICAgICAgICAgICAvLyDnrKzkuInpobUgLSDmnIDnu4jkuIvovb3lnLDlnYDlsZXnpLoKICAgICAgICAgICAgICAgIHVybCA9ICQoImRpdiA+IGFbaHJlZio9Jy9kb3duLmFzcCddIikuYXR0cignaHJlZicpOwogICAgICAgICAgICAgICAgUmVkaXJlY3RfMS5SZWRpcmVjdFRvKHVybCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAvLyDnrKzkuozpobU6IOWhq+WGmemqjOivgeeggQogICAgICAgICAgICAgICAgJCgnI2Rvd25sb2FkID4gYScpLmNsaWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgZXhwb3J0cy5SdWxlcyA9IFtydWxlXTsKfSk7CmRlZmluZSgic2l0ZS9kbC41eGZpbGUiLCBbInJlcXVpcmUiLCAiZXhwb3J0cyJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cykgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIHZhciBydWxlID0gewogICAgICAgIGlkOiAnZGwuNXhmaWxlJywKICAgICAgICBuYW1lOiAn5LqU5pif572R55uYJywKICAgICAgICBob3N0OiBbJzV4ZmlsZS5jb20nLCAnd3d3LjV4ZmlsZS5jb20nXSwKICAgICAgICBpbmNsdWRlU3ViSG9zdDogZmFsc2UsCiAgICAgICAgc3ViTW9kdWxlOiBmYWxzZSwKICAgICAgICBvblN0YXJ0OiAoKSA9PiB7CiAgICAgICAgICAgIC8vIFRPRE86IOWQr+WKqOS6i+S7tgogICAgICAgIH0sCiAgICAgICAgb25Cb2R5OiAoKSA9PiB7CiAgICAgICAgICAgIC8vIFRPRE86IOmhtemdouS6i+S7tgogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW3J1bGVdOwp9KTsKZGVmaW5lKCJzaXRlL2RsLmJhaWR1IiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL1dhaXQiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFdhaXRfMikgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIHZhciBydWxlID0gewogICAgICAgIGlkOiAnZGwuYmFpZHUnLAogICAgICAgIG5hbWU6ICfnmb7luqbnm5jlhY3kuIvovb3nrqHlrrYnLAogICAgICAgIGhvc3Q6IFsneXVuLmJhaWR1LmNvbScsICdwYW4uYmFpZHUuY29tJ10sCiAgICAgICAgaW5jbHVkZVN1Ykhvc3Q6IGZhbHNlLAogICAgICAgIHN1Yk1vZHVsZTogZmFsc2UsCiAgICAgICAgb25TdGFydDogKCkgPT4gewogICAgICAgIH0sCiAgICAgICAgb25Cb2R5OiAoKSA9PiB7CiAgICAgICAgICAgIFdhaXRfMi5XYWl0VW50aWwoJ3JlcXVpcmUnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB1bnNhZmVFeGVjKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVxdWlyZSA9IHdpbmRvdy5yZXF1aXJlOwogICAgICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gcmVxdWlyZSgnZGlzay1zeXN0ZW06d2lkZ2V0L3BsdWdpbi9kb3dubG9hZC91dGlsL2Rvd25sb2FkQ29tbW9uVXRpbC5qcycpOwogICAgICAgICAgICAgICAgICAgIHNlcnZpY2UuaXNQbGF0Zm9ybVdpbmRvd3MgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBmYWxzZTsgfTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9OwogICAgZXhwb3J0cy5SdWxlcyA9IFtydWxlXTsKfSk7CmRlZmluZSgic2l0ZS9kbC5ob3dmaWxlIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICAvLy8gPHJlZmVyZW5jZSBwYXRoPSIuLi90eXBpbmdzL2dsb2JhbHMvanF1ZXJ5L2luZGV4LmQudHMiIC8+CiAgICB2YXIgcnVsZSA9IHsKICAgICAgICBpZDogJ2RsLmhvd2ZpbGUnLAogICAgICAgIG5hbWU6ICflpb3nm5ggW2hvd2ZpbGUuY29tXScsCiAgICAgICAgaG9zdDogJ2hvd2ZpbGUuY29tJywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogdHJ1ZSwKICAgICAgICBzdWJNb2R1bGU6IGZhbHNlLAogICAgICAgIGNzczogYAojZmxvYXRkaXYgewogICAgdG9wOiAxNTBweDsKICAgIHotaW5kZXg6IDk5OTk5OwogICAgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDsKfQogICAgYCwKICAgICAgICBvblN0YXJ0OiAoKSA9PiB7CiAgICAgICAgfSwKICAgICAgICBvbkJvZHk6ICgpID0+IHsKICAgICAgICB9CiAgICB9OwogICAgZXhwb3J0cy5SdWxlcyA9IFtydWxlXTsKfSk7CmRlZmluZSgic2l0ZS9kbC5qa3BhbiIsIFsicmVxdWlyZSIsICJleHBvcnRzIiwgImhlbHBlci9FeHRlbnNpb24iLCAiaGVscGVyL1JlZGlyZWN0Il0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBFeHRlbnNpb25fNiwgUmVkaXJlY3RfMikgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIC8vLyA8cmVmZXJlbmNlIHBhdGg9Ii4uL3R5cGluZ3MvZ2xvYmFscy9qcXVlcnkvaW5kZXguZC50cyIgLz4KICAgIC8vIOmtlOaUuSBwaHBkaXNrCiAgICB2YXIgamtwYW5SdWxlID0gewogICAgICAgIGlkOiAnZGwucGhwZGlzay5qa3BhbicsCiAgICAgICAgbmFtZTogJ0pLUEFOIOinhOWImSBbcGhwRGlza10nLAogICAgICAgIGhvc3Q6IFsnamtwYW4uY2MnXSwKICAgICAgICBpbmNsdWRlU3ViSG9zdDogdHJ1ZSwKICAgICAgICBzdWJNb2R1bGU6IGZhbHNlLAogICAgICAgIG9uU3RhcnQ6ICgpID0+IHsKICAgICAgICAgICAgdmFyIGN0eCA9IHVuc2FmZVdpbmRvdzsKICAgICAgICAgICAgY3R4LmtpbGxhZHMgPSAxOwogICAgICAgICAgICB2YXIgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogICAgICAgICAgICBzLmlkID0gJ2FkYmxvY2tUZXN0ZXInOwogICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHMpOwogICAgICAgIH0sCiAgICAgICAgb25Cb2R5OiAoKSA9PiB7CiAgICAgICAgICAgIHZhciBjdHggPSB1bnNhZmVXaW5kb3c7CiAgICAgICAgICAgIHZhciBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHMuaWQgPSAnYjEnOwogICAgICAgICAgICBzLnN0eWxlLmNzc1RleHQgPSAnaGVpZ2h0OjUwMHB4O3Bvc2l0aW9uOmZpeGVkO2xlZnQ6LTUwMHB4JzsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzKTsKICAgICAgICAgICAgaWYgKEV4dGVuc2lvbl82LkJlZ2luV2l0aChsb2NhdGlvbi5wYXRobmFtZSwgJy9kb3duMi0nKSkgewogICAgICAgICAgICAgICAgbGV0IGhhbmRsZXIgPSBjdHguaGFuZGxlclBvcHVwOwogICAgICAgICAgICAgICAgY3R4LmhhbmRsZXJQb3B1cCA9IHVuc2FmZURlZmluZUZ1bmN0aW9uKCdoYW5kbGVyUG9wdXAnLCBmdW5jdGlvbiAoY2FwdGNoYU9iaikgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGNoYU9iai5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgfSwgNzUwKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKEV4dGVuc2lvbl82LkJlZ2luV2l0aChsb2NhdGlvbi5wYXRobmFtZSwgJy9maWxlLScpKSB7CiAgICAgICAgICAgICAgICBSZWRpcmVjdF8yLlJlZGlyZWN0VG8obG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgnZmlsZScsICdkb3duMicpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW2prcGFuUnVsZV07Cn0pOwpkZWZpbmUoInNpdGUvZGwubmFtaXBhbi5jYyIsIFsicmVxdWlyZSIsICJleHBvcnRzIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgdmFyIHJ1bGUgPSB7CiAgICAgICAgaWQ6ICdkbC5uYW1pcGFuJywKICAgICAgICBuYW1lOiAn57qz57Gz55uYLmNjIFvljp8gODfnm5gg5bqU6K+lXScsCiAgICAgICAgaG9zdDogJ25hbWlwYW4uY2MnLAogICAgICAgIHBhdGg6IFsnL2ZpbGUvJywgJy9kb3duLnBocCddLAogICAgICAgIGluY2x1ZGVTdWJIb3N0OiB0cnVlLAogICAgICAgIHN1Yk1vZHVsZTogZmFsc2UsCiAgICAgICAgaGlkZTogJyNib3gnLAogICAgICAgIGNzczogYApib2R5LCBib2R5ID4gLmdnYW8gewogICAgaGVpZ2h0OiBpbml0aWFsOwp9CiAgICBgLAogICAgICAgIG9uU3RhcnQ6ICgpID0+IHsKICAgICAgICB9LAogICAgICAgIG9uQm9keTogKCkgPT4gewogICAgICAgICAgICAvLyDkuIvovb3mjInpkq46ICNkb3duZ28KICAgICAgICAgICAgdmFyIG0gPSBsb2NhdGlvbi5wYXRobmFtZS5tYXRjaCgvXGQrLyk7CiAgICAgICAgICAgIHZhciBkbEJ0biA9ICQoJyNkb3duZ28nKTsKICAgICAgICAgICAgaWYgKGRsQnRuLmxlbmd0aCA+IDAgJiYgbSkgewogICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gJCgnPGlmcmFtZT4nKTsKICAgICAgICAgICAgICAgIHZhciBub3RlID0gJCgnPHA+Jyk7CiAgICAgICAgICAgICAgICBub3RlLnRleHQoJ+azqOaEjzog6ZyA6KaB55m75b2V5omN6IO95LiL6L2944CCJykuY3NzKCdjb2xvcicsICdyZWQnKTsKICAgICAgICAgICAgICAgIGZyYW1lLmF0dHIoewogICAgICAgICAgICAgICAgICAgIHNyYzogYC9kb3duLnBocD9maWxlX2lkPSR7bVswXX1gLAogICAgICAgICAgICAgICAgfSkuY3NzKHsKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAndGFibGUnLAogICAgICAgICAgICAgICAgICAgIGJvcmRlcjogMCwKICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3R0b206ICcxcHggc29saWQgI2NjYycsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICcxMDAlJywKICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDcwCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGRsQnRuLmJlZm9yZShmcmFtZSk7CiAgICAgICAgICAgICAgICBmcmFtZS5hZnRlcihub3RlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW3J1bGVdOwp9KTsKZGVmaW5lKCJzaXRlL2RsLnBocGRpc2siLCBbInJlcXVpcmUiLCAiZXhwb3J0cyIsICJoZWxwZXIvRXh0ZW5zaW9uIiwgImhlbHBlci9XYWl0IiwgImhlbHBlci9SZWRpcmVjdCIsICJoZWxwZXIvU2NyaXB0Il0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBFeHRlbnNpb25fNywgV2FpdF8zLCBSZWRpcmVjdF8zLCBTY3JpcHRfNSkgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIC8vLyA8cmVmZXJlbmNlIHBhdGg9Ii4uL3R5cGluZ3MvZ2xvYmFscy9qcXVlcnkvaW5kZXguZC50cyIgLz4KICAgIHZhciBwaHBkaXNrQSA9IHsKICAgICAgICBpZDogJ3BocGRpc2suYScsCiAgICAgICAgbmFtZTogJ1BIUERpc2sgQSDnsbvnvZHotZrnvZHnm5gnLAogICAgICAgIGhvc3Q6IFtdLAogICAgICAgIGhpZGU6ICcjY29kZV9ib3gsICNkb3duX2JveDIsICNjb2RlZnJtLCAuYWQsIFtjbGFzc149ImJhbm5lciJdJywKICAgICAgICBzaG93OiAnI2Rvd25fYm94JywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogdHJ1ZSwKICAgICAgICBzdWJNb2R1bGU6IGZhbHNlLAogICAgICAgIG9uU3RhcnQ6ICgpID0+IHsKICAgICAgICAgICAgbGV0IGYgPSAoKSA9PiB7IH07CiAgICAgICAgICAgIHVuc2FmZURlZmluZUZ1bmN0aW9uKCdvcGVuJywgZik7CiAgICAgICAgfSwKICAgICAgICBvbkJvZHk6ICgpID0+IHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICBXYWl0XzMuV2FpdFVudGlsKCdkb3duX2ZpbGVfbGluaycsICgpID0+IHsKICAgICAgICAgICAgICAgIHZhciBjdHggPSB1bnNhZmVXaW5kb3c7CiAgICAgICAgICAgICAgICAvLyDpgb/lhY3lnLDlnYDooqvopobnm5YKICAgICAgICAgICAgICAgIGN0eC51cGRhdGVfc2VjID0gbnVsbDsKICAgICAgICAgICAgICAgIC8vIOW8uuWItuaYvuekuuWcsOWdgAogICAgICAgICAgICAgICAgY3R4LmRvd25fZmlsZV9saW5rKCk7CiAgICAgICAgICAgICAgICAvLyDlvLrliLbmmL7npLrkuIvovb3lnLDlnYAKICAgICAgICAgICAgICAgIGlmIChjdHguc2hvd19kb3duX3VybCkKICAgICAgICAgICAgICAgICAgICBjdHguc2hvd19kb3duX3VybCgnZG93bl9hMScpOwogICAgICAgICAgICAgICAgdmFyIGp1bXBVcmwgPSAkKCcjZG93bl9saW5rJykuZmluZCgnYScpLmF0dHIoJ2hyZWYnKTsKICAgICAgICAgICAgICAgIC8vIOeEtuWQjui3s+i/h+WOuwogICAgICAgICAgICAgICAgaWYgKGp1bXBVcmwpIHsKICAgICAgICAgICAgICAgICAgICBSZWRpcmVjdF8zLlJlZGlyZWN0VG8oanVtcFVybCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChgWyR7U2NyaXB0XzUuU2NyaXB0Lk5hbWV9XTog5bqU55SoICR7c2VsZi5uYW1lfSDlpLHotKU6XG7mib7kuI3liLDot7PovazlnLDlnYAuYCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CiAgICB2YXIgcGhwZGlza1ogPSB7CiAgICAgICAgaWQ6ICdwaHBkaXNrLnonLAogICAgICAgIG5hbWU6ICfpgJrnlKggcGhwRGlzay56IOe9keebmOinhOWImScsCiAgICAgICAgLy8g6KeE5YiZOiDnm7TmjqXot7PovawgL2ZpbGUteHh4IC0+IC9kb3duLXh4eAogICAgICAgIC8vICAgICAgIOW5tumakOiXjyBkb3duX2JveDIsIOaYvuekuiBkb3duX2JveAogICAgICAgIGhvc3Q6IFsKICAgICAgICAgICAgJzEwcGFuLmNjJywgJzY2eXAuY2MnLCAnMTIzd3p3cC5jb20nLCAnaGl5cC5jYycKICAgICAgICBdLAogICAgICAgIGhpZGU6IGAuRG93bnBhZ2Vib3gsIC50YWxrX3Nob3csIC5iYW5uZXJfMiwgLndfMzA1LCAuYWQsCgkJICAgI3Zjb2RlLCAjdHVpLCAuZGNvZGUsICNkb3duX2JveDIsICNkbF90aXBzLCAubmFsLAoJCSAgIC5zY2Jhcl9ob3RfdGQsICNpbmNvZGVgLAogICAgICAgIHNob3c6ICcjZG93bl9ib3gsICNkbF9hZGRyJywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogdHJ1ZSwKICAgICAgICBzdWJNb2R1bGU6IGZhbHNlLAogICAgICAgIG9uU3RhcnQ6ICgpID0+IHsKICAgICAgICAgICAgbGV0IGYgPSAoKSA9PiB7IH07CiAgICAgICAgICAgIHVuc2FmZURlZmluZUZ1bmN0aW9uKCdhbGVydCcsIGYpOwogICAgICAgICAgICB1bnNhZmVEZWZpbmVGdW5jdGlvbignZG93bl9wcm9jZXNzJywgZik7CiAgICAgICAgICAgIFJlZGlyZWN0XzMucGhwZGlza0F1dG9SZWRpcmVjdChudWxsKTsKICAgICAgICB9LAogICAgICAgIG9uQm9keTogKCkgPT4gewogICAgICAgICAgICAvKiBmaXggZm9yIDEyM3d6d3AuY29tICovCiAgICAgICAgICAgIGxldCBmID0gKCkgPT4geyB9OwogICAgICAgICAgICB1bnNhZmVEZWZpbmVGdW5jdGlvbignZG93bl9wcm9jZXNzMicsIGYpOwogICAgICAgICAgICAkKGRvY3VtZW50LmJvZHkpLm9uKCdjbGljaycsICdhJywgZSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgJGRsID0gJChlLmN1cnJlbnRUYXJnZXQpOwogICAgICAgICAgICAgICAgbGV0IHVybCA9ICRkbC5kYXRhKCd1cmwnKTsKICAgICAgICAgICAgICAgIGlmICh1cmwubGVuZ3RoID4gJGRsLmF0dHIoJ2hyZWYnKS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAkZGwuYXR0cignaHJlZicsIHVybCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CiAgICB2YXIgamtwYW5SdWxlID0gewogICAgICAgIGlkOiAnamtwYW4ucGhwZGlzaycsCiAgICAgICAgbmFtZTogJ0pLUEFOIOinhOWImSBbcGhwRGlza10nLAogICAgICAgIGhvc3Q6IFsnamtwYW4uY2MnXSwKICAgICAgICBpbmNsdWRlU3ViSG9zdDogdHJ1ZSwKICAgICAgICBzdWJNb2R1bGU6IGZhbHNlLAogICAgICAgIG9uU3RhcnQ6ICgpID0+IHsKICAgICAgICAgICAgdmFyIGN0eCA9IHVuc2FmZVdpbmRvdzsKICAgICAgICAgICAgY3R4LmtpbGxhZHMgPSAxOwogICAgICAgICAgICB2YXIgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogICAgICAgICAgICBzLmlkID0gJ2FkYmxvY2tUZXN0ZXInOwogICAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHMpOwogICAgICAgIH0sCiAgICAgICAgb25Cb2R5OiAoKSA9PiB7CiAgICAgICAgICAgIHZhciBjdHggPSB1bnNhZmVXaW5kb3c7CiAgICAgICAgICAgIHZhciBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIHMuaWQgPSAnYjEnOwogICAgICAgICAgICBzLnN0eWxlLmNzc1RleHQgPSAnaGVpZ2h0OjUwMHB4O3Bvc2l0aW9uOmZpeGVkO2xlZnQ6LTUwMHB4JzsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzKTsKICAgICAgICAgICAgaWYgKEV4dGVuc2lvbl83LkJlZ2luV2l0aChsb2NhdGlvbi5wYXRobmFtZSwgJy9kb3duMi0nKSkgewogICAgICAgICAgICAgICAgbGV0IGhhbmRsZXIgPSBjdHguaGFuZGxlclBvcHVwOwogICAgICAgICAgICAgICAgY3R4LmhhbmRsZXJQb3B1cCA9IHVuc2FmZURlZmluZUZ1bmN0aW9uKCdoYW5kbGVyUG9wdXAnLCBmdW5jdGlvbiAoY2FwdGNoYU9iaikgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FwdGNoYU9iai5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKEV4dGVuc2lvbl83LkJlZ2luV2l0aChsb2NhdGlvbi5wYXRobmFtZSwgJy9maWxlLScpKSB7CiAgICAgICAgICAgICAgICBSZWRpcmVjdF8zLlJlZGlyZWN0VG8obG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgnZmlsZScsICdkb3duMicpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW3BocGRpc2tBLCBwaHBkaXNrWiwgamtwYW5SdWxlXTsKfSk7CmRlZmluZSgic2l0ZS9kbC54dWl0ZSIsIFsicmVxdWlyZSIsICJleHBvcnRzIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgLy8vIDxyZWZlcmVuY2UgcGF0aD0iLi4vdHlwaW5ncy9nbG9iYWxzL2pxdWVyeS9pbmRleC5kLnRzIiAvPgogICAgdmFyIHJ1bGUgPSB7CiAgICAgICAgaWQ6ICdkbC5oYW1pLWNsb3VkJywKICAgICAgICBuYW1lOiAnSGFtaSsg5YCL5Lq66ZuyJywKICAgICAgICBob3N0OiBbJ3dlYmhkLnh1aXRlLm5ldCcsICdzeW5jLmhhbWljbG91ZC5uZXQnXSwKICAgICAgICBwYXRoOiAnL19vb3BzLycsCiAgICAgICAgaW5jbHVkZVN1Ykhvc3Q6IGZhbHNlLAogICAgICAgIHN1Yk1vZHVsZTogZmFsc2UsCiAgICAgICAgb25TdGFydDogKCkgPT4gewogICAgICAgIH0sCiAgICAgICAgb25Cb2R5OiAoKSA9PiB7CiAgICAgICAgICAgICQoJyNzaGFyZS1kb3dubG9hZC1mdW5jLXN1Ym1pdCcpLmNsaWNrKCk7CiAgICAgICAgICAgIHVuc2FmZUV4ZWMoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgJChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI2dsb2JhbCcpLmRhdGEoJ3RpbWUnLCA5KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9OwogICAgZXhwb3J0cy5SdWxlcyA9IFtydWxlXTsKfSk7CmRlZmluZSgic2l0ZS9kbC55aW11aGUiLCBbInJlcXVpcmUiLCAiZXhwb3J0cyIsICJoZWxwZXIvRXh0ZW5zaW9uIiwgImhlbHBlci9SZWRpcmVjdCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgRXh0ZW5zaW9uXzgsIFJlZGlyZWN0XzQpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICAvLy8gPHJlZmVyZW5jZSBwYXRoPSIuLi90eXBpbmdzL2dsb2JhbHMvanF1ZXJ5L2luZGV4LmQudHMiIC8+CiAgICB2YXIgcnVsZSA9IHsKICAgICAgICBpZDogJ2RsLnlpbXVoZScsCiAgICAgICAgbmFtZTogJ+S4gOacqOemvicsCiAgICAgICAgaG9zdDogJ3d3dy55aW11aGUuY29tJywKICAgICAgICBoaWRlOiAnI2xvYWRpbmcsIC5nZ2FvLCAua3VhbicsCiAgICAgICAgc2hvdzogJyN5em0nLAogICAgICAgIGluY2x1ZGVTdWJIb3N0OiBmYWxzZSwKICAgICAgICBzdWJNb2R1bGU6IGZhbHNlLAogICAgICAgIHJ1bkluRnJhbWU6IHRydWUsCiAgICAgICAgb25TdGFydDogKCkgPT4gewogICAgICAgICAgICBSZWRpcmVjdF80LnBocGRpc2tBdXRvUmVkaXJlY3QobnVsbCk7CiAgICAgICAgfSwKICAgICAgICBvbkJvZHk6ICgpID0+IHsKICAgICAgICAgICAgaWYgKEV4dGVuc2lvbl84LkJlZ2luV2l0aChsb2NhdGlvbi5wYXRobmFtZSwgJy9uX2RkLnBocCcpKSB7CiAgICAgICAgICAgICAgICBSZWRpcmVjdF80LlJlZGlyZWN0VG8oJCgnI2Rvd25zJykuYXR0cignaHJlZicpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgZGxDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG93bmxvYWQnKTsKICAgICAgICAgICAgaWYgKCFkbENvbnRhaW5lcikKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgLy8g5b2T5LiL6L295qGG55qEIHN0eWxlIOWxnuaAp+iiq+abtOaUueWQjiwg5qih5ouf5LiL6L295oyJ6ZKu5Y2V5Ye7LgogICAgICAgICAgICB2YXIgbW8gPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAkKCdhJywgZGxDb250YWluZXIpWzFdLmNsaWNrKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBtby5vYnNlcnZlKGRsQ29udGFpbmVyLCB7IGF0dHJpYnV0ZXM6IHRydWUgfSk7CiAgICAgICAgfQogICAgfTsKICAgIGV4cG9ydHMuUnVsZXMgPSBbcnVsZV07Cn0pOwpkZWZpbmUoInNpdGUvZm0uZG91YmFuIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL0xvZ2dlciIsICJoZWxwZXIvV2FpdCIsICJoZWxwZXIvRG93bmxvYWRlciJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgTG9nZ2VyXzQsIFdhaXRfNCwgRG93bmxvYWRlcl8yKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgdmFyIHJ1bGUgPSB7CiAgICAgICAgaWQ6ICdmbS5kb3ViYW4nLAogICAgICAgIHNzbDogdHJ1ZSwKICAgICAgICBuYW1lOiAn6LGG55Oj55S15Y+w5LiL6L296Kej5p6QJywKICAgICAgICBob3N0OiAnZG91YmFuLmZtJywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogZmFsc2UsCiAgICAgICAgc3ViTW9kdWxlOiBmYWxzZSwKICAgICAgICBjc3M6IGAKYSNqeF9kb3ViYW5fZGwgewoJYmFja2dyb3VuZDogIzlERDZDNTsKCXBhZGRpbmc6IDNweCA1cHg7Cgljb2xvcjogI2ZmZgp9CgphI2p4X2RvdWJhbl9kbDpob3ZlciB7CgltYXJnaW4tbGVmdDogNXB4OwoJcGFkZGluZy1sZWZ0OiAxMHB4OwoJYmFja2dyb3VuZDogI0JBRTJENjsKfQoKZGl2I2p4X2RvdWJhbl9kbF93cmFwIHsKCWZsb2F0OiByaWdodDsKCW1hcmdpbi10b3A6IC0yMzBweDsKCW1hcmdpbi1yaWdodDogLTMycHg7Cglmb250LXdlaWdodDogYm9sZDsKCWZvbnQtZmFtaWx5OiAnTWljcm9zb2Z0IEpIZW5nSGVpIFVJJywgJ+W+rui9r+mbhem7kScsIHNlcmlmLXNhbnM7Cn0KICAgIGAsCiAgICAgICAgYmQ6IG51bGwsCiAgICAgICAgb25TdGFydDogKCkgPT4gewogICAgICAgICAgICBydWxlLmJkID0gbmV3IERvd25sb2FkZXJfMi5Eb3dubG9hZGVyKCk7CiAgICAgICAgICAgIHJ1bGUuYmQuQ2FwdHVyZUFyaWEoKTsKICAgICAgICB9LAogICAgICAgIG9uQm9keTogKCkgPT4gewogICAgICAgICAgICB2YXIgbGlua0Rvd25sb2FkID0gJCgnPGE+Jyk7CiAgICAgICAgICAgIGxpbmtEb3dubG9hZC5jc3MoJ3RyYW5zaXRpb24nLCAnYWxsIC4ycycpCiAgICAgICAgICAgICAgICAuYXR0cigndGFyZ2V0JywgJ19ibGFuaycpCiAgICAgICAgICAgICAgICAuYXR0cignaWQnLCAnanhfZG91YmFuX2RsJykKICAgICAgICAgICAgICAgIC50ZXh0KCfkuIvovb0nKTsKICAgICAgICAgICAgJCgnPGRpdj4nKQogICAgICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ2p4X2RvdWJhbl9kbF93cmFwJykKICAgICAgICAgICAgICAgIC5hcHBlbmQobGlua0Rvd25sb2FkKQogICAgICAgICAgICAgICAgLmluc2VydEFmdGVyKCcucGxheWVyLXdyYXAnKTsKICAgICAgICAgICAgTG9nZ2VyXzQuaW5mbygn562J5b6F6LGG55Oj55S15Y+w5Yqg6L29IC4uJyk7CiAgICAgICAgICAgIFdhaXRfNC5XYWl0VW50aWwoJ2V4dFN0YXR1c0hhbmRsZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBMb2dnZXJfNC5pbmZvKCfnu5HlrprosYbnk6PnlLXlj7Dlh73mlbAgLi4nKTsKICAgICAgICAgICAgICAgIHVuc2FmZU92ZXJ3cml0ZUZ1bmN0aW9uU2FmZVByb3h5KHsKICAgICAgICAgICAgICAgICAgICBleHRTdGF0dXNIYW5kbGVyOiBmdW5jdGlvbiAoanNvblNvbmdPYmopIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gSlNPTi5wYXJzZShqc29uU29uZ09iaik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnc3RhcnQnID09IGV2ZW50LnR5cGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzb25nID0gZXZlbnQuc29uZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0gc29uZy50aXRsZSArIHNvbmcudXJsLnNsaWNlKC00KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtEb3dubG9hZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgcnVsZS5iZC5HZW5lcmF0ZVVyaShzb25nLnVybCwgZmlsZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RpdGxlJywgYOS4i+i9vTogJHtzb25nLnRpdGxlfWApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2VyXzQuaW5mbyhgJHtzb25nLnRpdGxlfSA9PiAke3NvbmcudXJsfWApOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvclVuc2FmZVN1Y2Nlc3MoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIExvZ2dlcl80LmluZm8oJ+WHveaVsOe7keWumuWujOavlSwgRW5qb3l+Jyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW3J1bGVdOwp9KTsKZGVmaW5lKCJzaXRlL2ZtLm1vZSIsIFsicmVxdWlyZSIsICJleHBvcnRzIiwgImhlbHBlci9Eb3dubG9hZGVyIiwgImhlbHBlci9TY3JpcHQiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIERvd25sb2FkZXJfMywgU2NyaXB0XzYpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICB2YXIgcnVsZSA9IHsKICAgICAgICBpZDogJ2ZtLm1vZScsCiAgICAgICAgc3NsOiBmYWxzZSwKICAgICAgICBuYW1lOiAn6JCM5ZCm55S15Y+wJywKICAgICAgICBob3N0OiAnbW9lLmZtJywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogZmFsc2UsCiAgICAgICAgc3ViTW9kdWxlOiBmYWxzZSwKICAgICAgICBjc3M6IGAKCmEuaml4dW4tZGwgewogICAgd2lkdGg6IDI2cHggIWltcG9ydGFudDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IC0xOXB4IC05NnB4ICFpbXBvcnRhbnQ7CiAgICB0cmFuc2Zvcm06IHJvdGF0ZSg5MGRlZyk7Cn0KCiAgICBgLAogICAgICAgIGJkOiBudWxsLAogICAgICAgIG9uU3RhcnQ6ICgpID0+IHsKICAgICAgICAgICAgcnVsZS5iZCA9IG5ldyBEb3dubG9hZGVyXzMuRG93bmxvYWRlcigpOwogICAgICAgICAgICBydWxlLmJkLkNhcHR1cmVBcmlhKCk7CiAgICAgICAgfSwKICAgICAgICBvbkJvZHk6ICgpID0+IHsKICAgICAgICAgICAgdW5zYWZlV2luZG93LmlzX2xvZ2luID0gdHJ1ZTsKICAgICAgICAgICAgdmFyIGRsTGluayA9ICQoJzxhPicpOwogICAgICAgICAgICBkbExpbmsKICAgICAgICAgICAgICAgIC5hZGRDbGFzcygncGxheWVyLWJ1dHRvbiBsZWZ0IGppeHVuLWRsJykKICAgICAgICAgICAgICAgIC5pbnNlcnRBZnRlcignZGl2LnBsYXllci1idXR0b24uYnV0dG9uLXZvbHVtZScpOwogICAgICAgICAgICBTY3JpcHRfNi5TY3JpcHQuTGlzdGVuRXZlbnQoKGNsaXApID0+IHsKICAgICAgICAgICAgICAgIGRsTGluawogICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgcnVsZS5iZC5HZW5lcmF0ZVVyaShjbGlwLnVybCwgYCR7Y2xpcC5zdWJfdGl0bGV9Lm1wM2ApKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsIGDkuIvovb06ICR7Y2xpcC5zdWJfdGl0bGV9YCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB1bnNhZmVFeGVjKChzY3JpcHROYW1lKSA9PiB7CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBub3RpZnlVcGRhdGUoY2xpcCkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KHNjcmlwdE5hbWUsIHsgZGV0YWlsOiBKU09OLnN0cmluZ2lmeShjbGlwKSB9KSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkZWZpbmUoJ3BsdWdpbi9qaXh1bicsIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKCdbQ1VXQ0w0Q10g5byA5aeL5rOo5YWlIC4uLicpOwogICAgICAgICAgICAgICAgICAgIHZhciBsaXN0ZW4gPSByZXF1aXJlKCcvcHVibGljL2pzL2ZtL3BhZ2UvbGlzdGVuLmpzJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBsYXllciA9IHJlcXVpcmUoJ3BsYXllci9wbGF5ZXInKTsKICAgICAgICAgICAgICAgICAgICB2YXIgX2luaXRQbGF5ZXIgPSBwbGF5ZXIuaW5pdFBsYXllcjsKICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuaW5pdFBsYXllciA9IGZ1bmN0aW9uIChjbGlwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmeVVwZGF0ZShjbGlwKTsKICAgICAgICAgICAgICAgICAgICAgICAgX2luaXRQbGF5ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnW0NVV0NMNENdIOazqOWFpee7k+adnyAuLi4nKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8g6KaB5rGC6L295YWl5aSW5oyC5qih57uECiAgICAgICAgICAgICAgICBzZWFqcy51c2UoJ3BsdWdpbi9qaXh1bicpOwogICAgICAgICAgICB9LCBTY3JpcHRfNi5TY3JpcHQuTmFtZSk7CiAgICAgICAgfQogICAgfTsKICAgIGV4cG9ydHMuUnVsZXMgPSBbcnVsZV07Cn0pOwpkZWZpbmUoInNpdGUvbXVzaWMuMTYzIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL0xvZ2dlciIsICJoZWxwZXIvQ29uc3RhbnRzIiwgImhlbHBlci9XYWl0IiwgImhlbHBlci9Eb3dubG9hZGVyIiwgImhlbHBlci9TY3JpcHQiLCAiaGVscGVyL1NjcmlwdENvbmZpZyIsICJoZWxwZXIvUXVlcnlTdHJpbmciLCAiaGVscGVyL0V4dGVuc2lvbiJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgTG9nZ2VyXzUsIENvbnN0YW50c18zLCBXYWl0XzUsIERvd25sb2FkZXJfNCwgU2NyaXB0XzcsIFNjcmlwdENvbmZpZ18zLCBxcywgRXh0ZW5zaW9uXzkpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICBjb25zdCBfX01QM19CTEFOSyA9ICdodHRwczovL2ppeHVubW9lLmdpdGh1Yi5pby9jdXdjbDRjL2JsYW5rLm1wMyc7CiAgICB2YXIgcnVsZSA9IHsKICAgICAgICBpZDogJ211c2ljLjE2MycsCiAgICAgICAgc3NsOiB0cnVlLAogICAgICAgIG5hbWU6ICfpu4TmmJPkupHpn7PkuZAnLAogICAgICAgIGhvc3Q6ICdtdXNpYy4xNjMuY29tJywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogZmFsc2UsCiAgICAgICAgc3ViTW9kdWxlOiBmYWxzZSwKICAgICAgICBydW5JbkZyYW1lOiB0cnVlLAogICAgICAgIGRsX2ljb246IHRydWUsCiAgICAgICAgY3NzOiBgCgoubS1wYmFyLCAubS1wYmFyIC5iYXJiZyB7CiAgICB3aWR0aDogY2FsYyggNDU1cHggLSAyLjVlbSApOwp9CgoubS1wbGF5YmFyIC5wbGF5IHsKICAgIHdpZHRoOiBjYWxjKCA1NzBweCAtIDIuNWVtICk7Cn0KCi5tLXBsYXliYXIgLm9wZXIgewogICAgd2lkdGg6IGluaXRpYWw7Cn0KCi5qeF9kbDpob3ZlciB7CiAgICBjb2xvcjogd2hpdGU7Cn0KCi8qIOW6lemDqOWNleabsuS4i+i9vSAqLwoubS1wbGF5YmFyIC5vcGVyIC5qeF9idG4gewogICAgdGV4dC1pbmRlbnQ6IDA7CiAgICBmb250LXNpemU6IDEuNWVtOwogICAgbWFyZ2luOiAxM3B4IDJweCAwIDA7CiAgICBmbG9hdDogbGVmdDsKICAgIGNvbG9yOiAjY2NjOwogICAgdGV4dC1zaGFkb3c6IDFweCAxcHggMnB4IGJsYWNrLCAwIDAgMWVtIGJsYWNrLCAwIDAgMC4yZW0gI2FhYTsKICAgIGxpbmUtaGVpZ2h0OiAxLjZlbTsKICAgIGZvbnQtc2l6ZTogMS4yZW07Cn0KCi5tLXBsYXliYXIgLm9wZXIgLmp4X2RsOjpiZWZvcmUgewogICAgcGFkZGluZy1yaWdodDogLjI1ZW07Cn0KCi5qeF9idG46aG92ZXIgewogICAgY29sb3I6IHdoaXRlOwp9CgovKiDmkq3mlL7liJfooajkuIvovb0gKi8KLm0tcGxheWJhciAubGlzdGhkYyAuanhfZGwuYWRkYWxsIHsKICAgIGxlZnQ6IDMwNnB4OwogICAgbGluZS1oZWlnaHQ6IDFlbTsKICAgIC8qIOWkmuS4gOS4qiBweCwg5a+56b2Q5paH5a2XICovCiAgICB0b3A6IDEzcHg7Cn0KCi5tLXBsYXliYXIgLmxpc3RoZGMgLmxpbmUuanhfZGxfbGluZSB7CiAgICBsZWZ0OiAzODVweDsKfQoKICAgIGAsCiAgICAgICAgaW5zdGFuY2U6IG51bGwsCiAgICAgICAgb25TdGFydDogKCkgPT4gewogICAgICAgICAgICBydWxlLmluc3RhbmNlID0gbmV3IFllbGxvd0Vhc2UoKTsKICAgICAgICB9LAogICAgICAgIG9uQm9keTogKCkgPT4gewogICAgICAgICAgICBydWxlLmluc3RhbmNlLkJvZHlFdmVudCgpOwogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW3J1bGVdOwogICAgY2xhc3MgWWVsbG93RWFzZSB7CiAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgIHRoaXMuX3JlbG9hZENhY2hlID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5fX0hJREVfQkFOTkVSKSB7CiAgICAgICAgICAgICAgICBydWxlLnN0eWxlLkhpZGUoJyNpbmRleC1iYW5uZXInKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoU2NyaXB0Q29uZmlnXzMuQ29uZmlnLmJZZWxsb3dFYXNlSW50ZXJuYXRpb25hbCkKICAgICAgICAgICAgICAgIEdlbmVyYXRlQ2RuTGlzdCh0aGlzKTsKICAgICAgICAgICAgdGhpcy5fZG93bmxvYWRlciA9IG5ldyBEb3dubG9hZGVyXzQuRG93bmxvYWRlcigpOwogICAgICAgICAgICB1bnNhZmVFeGVjKCgpID0+IHsKICAgICAgICAgICAgICAgIHZhciBmYWtlUGxhdEZvcm0gPSBuYXZpZ2F0b3IucGxhdGZvcm0gKyAiLS1GYWtlLW1hYyI7CiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmF2aWdhdG9yLCAicGxhdGZvcm0iLCB7CiAgICAgICAgICAgICAgICAgICAgZ2V0OiAoKSA9PiB7IHJldHVybiBmYWtlUGxhdEZvcm07IH0sCiAgICAgICAgICAgICAgICAgICAgc2V0OiAoKSA9PiB7IH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgQm9keUV2ZW50KCkgewogICAgICAgICAgICBXYWl0XzUuV2FpdFVudGlsKCdubS54JywgKCkgPT4gewogICAgICAgICAgICAgICAgLy8g5Lik5Liq54mI5p2D5o+Q56S6LCDkuIDkuKrmnYPpmZDmj5DnpLouCiAgICAgICAgICAgICAgICB2YXIgZm5CeXBhc3NDcjEgPSB0aGlzLlNlYXJjaCh1bnNhZmVXaW5kb3cubmVqLmUsICduZWouZScsICcuZGF0YXNldDtpZicpOwogICAgICAgICAgICAgICAgdmFyIGZuQnlwYXNzQ3IyID0gdGhpcy5TZWFyY2godW5zYWZlV2luZG93Lm5tLngsICdubS54JywgJy5jb3B5cmlnaHRJZD09Jyk7CiAgICAgICAgICAgICAgICB2YXIgZm5CeXBhc3NDcjMgPSB0aGlzLlNlYXJjaCh1bnNhZmVXaW5kb3cubm0ueCwgJ25tLngnLCAnLnByaXZpbGVnZTtpZicpOwogICAgICAgICAgICAgICAgdW5zYWZlRXhlYygoZm5CeXBhc3NDcjEsIGZuQnlwYXNzQ3IyLCBmbkJ5cGFzc0NyMykgPT4gewogICAgICAgICAgICAgICAgICAgIHZhciBfZm5CeXBhc3NDcjEgPSB3aW5kb3cubmVqLmVbZm5CeXBhc3NDcjFdOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5uZWouZVtmbkJ5cGFzc0NyMV0gPSBmdW5jdGlvbiAoeiwgbmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PSAnY29weXJpZ2h0JyB8fCBuYW1lID09ICdyZXNDb3B5cmlnaHQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2ZuQnlwYXNzQ3IxLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cubm0ueFtmbkJ5cGFzc0NyMl0gPSAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5ubS54W2ZuQnlwYXNzQ3IzXSA9IChzb25nKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNvbmcuc3RhdHVzID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvbmcucHJpdmlsZWdlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb25nLnByaXZpbGVnZS5wbCA9IDMyMDAwMDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSwgZm5CeXBhc3NDcjEsIGZuQnlwYXNzQ3IyLCBmbkJ5cGFzc0NyMyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAoQ29uc3RhbnRzXzMuaXNGcmFtZSkgewogICAgICAgICAgICAgICAgdGhpcy5GcmFtZVBhZ2UoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuUGxheWVyUGFnZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIFNlYXJjaChiYXNlLCBkaXNwbGF5QmFzZSwga2V5d29yZCwgc3VwcHJlc3NMb2cgPSBmYWxzZSkgewogICAgICAgICAgICBmb3IgKGxldCBpdGVtTmFtZSBpbiBiYXNlKSB7CiAgICAgICAgICAgICAgICBpZiAoYmFzZS5oYXNPd25Qcm9wZXJ0eShpdGVtTmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZm4gPSBiYXNlW2l0ZW1OYW1lXTsKICAgICAgICAgICAgICAgICAgICBpZiAoZm4gJiYgdHlwZW9mIGZuID09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZuU3RyID0gU3RyaW5nKGZuKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFRlc3RTdHJpbmcoZm5TdHIsIGtleXdvcmQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXN1cHByZXNzTG9nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOWumuS9jeafpeaJviAlYyR7a2V5d29yZH0lYyDmiJDlip86ICVjJHtkaXNwbGF5QmFzZX0uJHtpdGVtTmFtZX1gLCAnY29sb3I6IGRhcmt2aW9sZXQnLCAncmVzZXQnLCAnY29sb3I6IGdyZWVuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbU5hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFzdXBwcmVzc0xvZykKICAgICAgICAgICAgICAgIExvZ2dlcl81LmVycm9yKGDlrprkvY3mn6Xmib7lrZDlh73mlbAgJHtrZXl3b3JkfSDkuo4gJHtkaXNwbGF5QmFzZX0g5aSx6LSlLCDor7fogZTns7vkvZzogIXkv67lpI0hYCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBTZWFyY2hTdWJQcm90b3R5cGUoYmFzZSwgZGlzcGxheUJhc2UsIGtleXdvcmQsIHN1cHByZXNzTG9nID0gZmFsc2UpIHsKICAgICAgICAgICAgZm9yIChsZXQgaXRlbU5hbWUgaW4gYmFzZSkgewogICAgICAgICAgICAgICAgaWYgKGJhc2UuaGFzT3duUHJvcGVydHkoaXRlbU5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IG5ld0Jhc2UgPSBiYXNlW2l0ZW1OYW1lXTsKICAgICAgICAgICAgICAgICAgICAvLyDmo4Dmn6XnjrDlnKjnmoTov5nkuKrmmK/kuI3mmK/lrZDnsbsKICAgICAgICAgICAgICAgICAgICBpZiAobmV3QmFzZSAmJiBuZXdCYXNlLnByb3RvdHlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmZvKGDmn6Xmib4gJWMke2Rpc3BsYXlCYXNlfS4ke2l0ZW1OYW1lfS5wcm90b3R5cGUlYyAuLi5gLCAnY29sb3I6bGlnaHRncmF5JywgJ3Jlc2V0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByID0gdGhpcy5TZWFyY2gobmV3QmFzZS5wcm90b3R5cGUsIGRpc3BsYXlCYXNlLCBrZXl3b3JkLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdXBwcmVzc0xvZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2dnZXJfNS5pbmZvKGDlrprkvY3mn6Xmib4gJWMke2tleXdvcmR9JWMg5oiQ5YqfOiAlYyR7ZGlzcGxheUJhc2V9LiR7aXRlbU5hbWV9Ojoke3J9YCwgJ2NvbG9yOiBkYXJrdmlvbGV0JywgJ3Jlc2V0JywgJ2NvbG9yOiBncmVlbicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtpdGVtTmFtZSwgJ3Byb3RvdHlwZScsIHJdOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghc3VwcHJlc3NMb2cpCiAgICAgICAgICAgICAgICBMb2dnZXJfNS5lcnJvcihg5a6a5L2N5p+l5om+5a2Q57G75Ye95pWwICR7a2V5d29yZH0g5LqOICR7ZGlzcGxheUJhc2V9IOWksei0pSwg6K+36IGU57O75L2c6ICF5L+u5aSNIWApOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgUGxheWVyUGFnZSgpIHsKICAgICAgICAgICAgdGhpcy5fYnRuRG93bmxvYWQgPSAkKCc8YT4nKTsKICAgICAgICAgICAgdGhpcy5fYnRuRG93bmxvYWQKICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsICfmkq3mlL7pn7PkuZDvvIzljbPliLvop6PmnpDjgIInKQogICAgICAgICAgICAgICAgLmNsaWNrKChlKSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKQogICAgICAgICAgICAgICAgLmFkZENsYXNzKENvbnN0YW50c18zLmRvd25sb2FkSWNvbkNsYXNzKQogICAgICAgICAgICAgICAgLmFkZENsYXNzKCdqeF9idG4nKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKCcubS1wbGF5YmFyIC5vcGVyJyk7CiAgICAgICAgICAgIC8vIFRPRE86IOWKoOWFpeatjOWNleS4i+i9veaMiemSrgogICAgICAgICAgICB0aGlzLl9idG5Eb3dubG9hZEFsbCA9ICQoJzxhPicpOwogICAgICAgICAgICB0aGlzLl9idG5Eb3dubG9hZEFsbAogICAgICAgICAgICAgICAgLmFkZENsYXNzKCdhZGRhbGwnKQogICAgICAgICAgICAgICAgLnRleHQoJ+WFqOmDqOS4i+i9vScpCiAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoQ29uc3RhbnRzXzMuZG93bmxvYWRJY29uQ2xhc3MpCiAgICAgICAgICAgICAgICAuY2xpY2soKCkgPT4gdGhpcy5Eb3dubG9hZEFsbCgpKTsKICAgICAgICAgICAgaWYgKFNjcmlwdENvbmZpZ18zLkNvbmZpZy5kVXJpVHlwZSA9PSBTY3JpcHRDb25maWdfMy5VcmlUeXBlLkFyaWEpIHsKICAgICAgICAgICAgICAgIHRoaXMuX2Rvd25sb2FkZXIuQ2FwdHVyZUFyaWEodGhpcy5fYnRuRG93bmxvYWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgLy8gVE9ETzog6ZqQ6JeP5q2M5Y2V5LiL6L295oyJ6ZKuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvY2F0aW9uLnBhdGhuYW1lID09ICcvZGVtby9mbScpIHsKICAgICAgICAgICAgICAgIHRoaXMuSG9va1JhZGlvUGxheWVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLkhvb2tOb3JtYWxQbGF5ZXIoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBEb3dubG9hZEFsbCgpIHsKICAgICAgICAgICAgLy8gVE9ETzog5LiL6L295omA5pyJ5puy55uuCiAgICAgICAgfQogICAgICAgIEhvb2tOb3JtYWxQbGF5ZXIoKSB7CiAgICAgICAgICAgIFdhaXRfNS5XYWl0VW50aWwoKCkgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0aGRjID4gLmFkZGFsbCcpICE9IG51bGw7CiAgICAgICAgICAgIH0sICgpID0+IHsKICAgICAgICAgICAgICAgIHZhciBkbExpbmUgPSAkKCc8YT4nKTsKICAgICAgICAgICAgICAgIGRsTGluZQogICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcygnbGluZSBqeF9kbF9saW5lJykKICAgICAgICAgICAgICAgICAgICAuaGlkZSgpOwogICAgICAgICAgICAgICAgdGhpcy5fYnRuRG93bmxvYWRBbGwKICAgICAgICAgICAgICAgICAgICAuaW5zZXJ0QmVmb3JlKCcubS1wbGF5YmFyIC5saXN0aGRjIC5hZGRhbGwnKQogICAgICAgICAgICAgICAgICAgIC5hZnRlcihkbExpbmUpCiAgICAgICAgICAgICAgICAgICAgLmhpZGUoKTsKICAgICAgICAgICAgfSwgdHJ1ZSwgNTAwKTsKICAgICAgICAgICAgZnVuY3Rpb24gbmV4dFNvbmcoKSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubnh0JykuY2xpY2soKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBXYWl0XzUuV2FpdFVudGlsKCduZWouaicsICgpID0+IHsKICAgICAgICAgICAgICAgIHZhciBmbkFqYXggPSB0aGlzLlNlYXJjaCh1bnNhZmVXaW5kb3cubmVqLmosICJuZWouaiIsICcucmVwbGFjZSgiYXBpIiwid2VhcGknKTsKICAgICAgICAgICAgICAgIHZhciBmbkdldFNvbmdSYXcgPSB0aGlzLlNlYXJjaFN1YlByb3RvdHlwZSh1bnNhZmVXaW5kb3cubm0udywgJ25tLncnLCAvcmV0dXJuIHRoaXNcLlx3K1xbdGhpc1wuXHcrXF0vKTsKICAgICAgICAgICAgICAgIHZhciBjbHNQbGF5ZXIgPSBmbkdldFNvbmdSYXdbMF07CiAgICAgICAgICAgICAgICB2YXIgZm5HZXRTb25nID0gZm5HZXRTb25nUmF3WzJdOwogICAgICAgICAgICAgICAgaWYgKFNjcmlwdENvbmZpZ18zLkNvbmZpZy5iWWVsbG93RWFzZUludGVybmF0aW9uYWwpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9idG5DaGFuZ2VDZG4gPSAkKCc8YT4nKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9idG5DaGFuZ2VDZG4KICAgICAgICAgICAgICAgICAgICAgICAgLmFkZENsYXNzKCdqeF9idG4ganhfY2RuJykKICAgICAgICAgICAgICAgICAgICAgICAgLmNsaWNrKCgpID0+IHRoaXMuTmV4dENkbigpKQogICAgICAgICAgICAgICAgICAgICAgICAuaW5zZXJ0QWZ0ZXIodGhpcy5fYnRuRG93bmxvYWQpCiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KCfmjaInKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY2RuID0gR01fZ2V0VmFsdWUoJ193c19jZG5fbWVkaWEnLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWNkbikgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLk5leHRDZG4oKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NkbiA9IGNkbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLy8vLy8g5a6J6KOF5L+u5pS55ZCO55qEIOWPluW+l+absuebruS/oeaBryDlh73mlbDlvIDlp4sKICAgICAgICAgICAgICAgIHZhciBjYWxsRXZlbnRGbiA9IEdlbmVyYXRlVmFsaWROYW1lKCk7CiAgICAgICAgICAgICAgICBleHBvcnRGdW5jdGlvbigoc29uZykgPT4gewogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShzb25nKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9zb25nID0gewogICAgICAgICAgICAgICAgICAgICAgICBhcnRpc3RzOiBkYXRhLmFydGlzdHMubWFwKChhcnRpc3QpID0+IGFydGlzdC5uYW1lKS5qb2luKCfjgIEnKSwKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICB1cmw6IG51bGwKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOaNleaNieWIsOmfs+S5kOWIh+aNojogJHt0aGlzLl9zb25nLm5hbWV9YCk7CiAgICAgICAgICAgICAgICB9LCB1bnNhZmVXaW5kb3csIHsKICAgICAgICAgICAgICAgICAgICBkZWZpbmVBczogY2FsbEV2ZW50Rm4KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdW5zYWZlRXhlYygoY2FsbEV2ZW50Rm4sIGNsc1BsYXllciwgZm5HZXRTb25nKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdmFyIF9nZXRTb25nQmFja3VwID0gd2luZG93Lm5tLndbY2xzUGxheWVyXS5wcm90b3R5cGVbZm5HZXRTb25nXTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cubm0ud1tjbHNQbGF5ZXJdLnByb3RvdHlwZVtmbkdldFNvbmddID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IF9nZXRTb25nQmFja3VwLmNhbGwodGhpcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvd1tjYWxsRXZlbnRGbl0oSlNPTi5zdHJpbmdpZnkocikpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9LCBjYWxsRXZlbnRGbiwgY2xzUGxheWVyLCBmbkdldFNvbmcpOwogICAgICAgICAgICAgICAgLy8vLy8vIOWuieijheS/ruaUueWQjueahCDlj5blvpfmm7Lnm67kv6Hmga8g5Ye95pWw57uT5p2fCiAgICAgICAgICAgICAgICAvLy8vLy8g5a6J6KOF5L+u5pS55ZCO55qEIEFqYXgg5Ye95pWw5byA5aeLCiAgICAgICAgICAgICAgICB2YXIgYWpheFBhdGNoRm4gPSBHZW5lcmF0ZVZhbGlkTmFtZSgpOwogICAgICAgICAgICAgICAgdGhpcy5fYWpheEJhY2t1cCA9IHVuc2FmZVdpbmRvdy5uZWoualtmbkFqYXhdOwogICAgICAgICAgICAgICAgaWYgKFNjcmlwdENvbmZpZ18zLkNvbmZpZy5iWWVsbG93RWFzZVVzZU9sZEFwaSB8fCBTY3JpcHRDb25maWdfMy5Db25maWcuYlllbGxvd0Vhc2VJbnRlcm5hdGlvbmFsKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGhvb2tlZEFqYXggPSAoU2NyaXB0Q29uZmlnXzMuQ29uZmlnLmJZZWxsb3dFYXNlVXNlT2xkQXBpID8gdGhpcy5BamF4UGF0Y2hlZE9sZEFwaSA6IHRoaXMuQWpheFBhdGNoZWRJbnRlcm5hdGlvbmFsKTsKICAgICAgICAgICAgICAgICAgICBleHBvcnRGdW5jdGlvbihob29rZWRBamF4LmJpbmQodGhpcyksIHVuc2FmZVdpbmRvdywgewogICAgICAgICAgICAgICAgICAgICAgICBkZWZpbmVBczogYWpheFBhdGNoRm4KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB1bnNhZmVFeGVjKChhamF4UGF0Y2hGbiwgZm5BamF4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhamF4UGF0Y2hlZCA9IHdpbmRvd1thamF4UGF0Y2hGbl07CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhamF4T3JpZ2luYWwgPSB3aW5kb3cubmVqLmpbZm5BamF4XTsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm5lai5qW2ZuQWpheF0gPSBDdXN0b21BamF4OwogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBDdXN0b21BamF4KHVybCwgcGFyYW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmluZm8oYHVybDogJHt1cmx9YCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXJsLmluZGV4T2YoJ2xvZy8nKSAhPSAtMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMub25sb2FkKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IDIwMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGFyYW1zLmhlYWRlcnMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmhlYWRlcnMgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfb25sb2FkID0gcGFyYW1zLm9ubG9hZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhcmFtcy5fb25sb2FkID0gcGFyYW1zLm9ubG9hZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5vbmxvYWQgPSAoZGF0YSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5vbmxvYWQgPSBfb25sb2FkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuX29ubG9hZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMuX29ubG9hZChkYXRhLCBfb25sb2FkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5vbmxvYWQoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFqYXhQYXRjaGVkKHVybCwgcGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sIGFqYXhQYXRjaEZuLCBmbkFqYXgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8vLy8vIOWuieijheS/ruaUueWQjueahCBBamF4IOWHveaVsOe7k+adnwogICAgICAgICAgICAgICAgLy8vIOaMgumSqeS4i+S4gOmmluWIh+aNouS6i+S7tiwg5by65Yi26YeN5paw6K+75Y+W5b2T5YmN5puy55uu5Zyw5Z2A44CCCiAgICAgICAgICAgICAgICB2YXIgZm5OZXh0U29uZyA9IHRoaXMuU2VhcmNoKHVuc2FmZVdpbmRvdy5ubS53W2Nsc1BsYXllcl0ucHJvdG90eXBlLCBgbm0udy4ke2Nsc1BsYXllcn0ucHJvdG90eXBlYCwgJygrMSksInVpIiknKTsKICAgICAgICAgICAgICAgIHVuc2FmZUV4ZWMoKGNsc1BsYXllciwgZm5OZXh0U29uZykgPT4gewogICAgICAgICAgICAgICAgICAgIHZhciBvbGROZXh0U29uZyA9IHdpbmRvdy5ubS53W2Nsc1BsYXllcl0ucHJvdG90eXBlW2ZuTmV4dFNvbmddOwogICAgICAgICAgICAgICAgICAgIHZhciByZWxvYWRTb25nID0gZXZhbCgnKCcgKyBvbGROZXh0U29uZy50b1N0cmluZygpLnJlcGxhY2UoJzEnLCAnMCcpICsgJyknKTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cubm0ud1tjbHNQbGF5ZXJdLnByb3RvdHlwZVtmbk5leHRTb25nXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm5tLndbY2xzUGxheWVyXS5wcm90b3R5cGVbZm5OZXh0U29uZ10gPSBvbGROZXh0U29uZzsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbG9hZFNvbmcuY2FsbCh0aGlzKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ueHQnKS5jbGljaygpOwogICAgICAgICAgICAgICAgfSwgY2xzUGxheWVyLCBmbk5leHRTb25nKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIEFqYXhQYXRjaGVkT2xkQXBpKHVybCwgcGFyYW1zKSB7CiAgICAgICAgICAgIGlmICh1cmwgIT0gJy9hcGkvc29uZy9lbmhhbmNlL3BsYXllci91cmwnKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9hamF4QmFja3VwKHVybCwgcGFyYW1zKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmwgPSAnL2FwaS92My9zb25nL2RldGFpbCc7CiAgICAgICAgICAgIGxldCBxdWVyeSA9IHBhcmFtcy5xdWVyeTsKICAgICAgICAgICAgaWYgKHF1ZXJ5LmJyKQogICAgICAgICAgICAgICAgZGVsZXRlIHF1ZXJ5LmJyOwogICAgICAgICAgICB2YXIgX2lkcyA9IEpTT04ucGFyc2UocXVlcnkuaWRzKTsKICAgICAgICAgICAgdmFyIHJlcXVlc3RJZHMgPSBbXTsKICAgICAgICAgICAgdGhpcy5Mb2FkQ2FjaGUoKTsKICAgICAgICAgICAgdmFyIHNvbmdzID0gX2lkcy5tYXAoKGlkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoaWQgaW4gdGhpcy5fc29uZ0NhY2hlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NvbmdDYWNoZVtpZF07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXF1ZXN0SWRzLnB1c2goaWQpOwogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0pLmZpbHRlcigoc29uZykgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIHNvbmc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAocmVxdWVzdElkcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOS7jue8k+WtmOivu+WPluabsuebruS/oeaBr+OAgmApOwogICAgICAgICAgICAgICAgbGV0IHJlcGx5ID0gU29uZ3NUb1VybFJlcGx5KHNvbmdzKTsKICAgICAgICAgICAgICAgIHRoaXMuTm90aWZ5VXJsQ2hhbmdlKHJlcGx5LmRhdGFbMF0udXJsKTsKICAgICAgICAgICAgICAgIHBhcmFtcy5vbmxvYWQocmVwbHkpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIExvZ2dlcl81LmluZm8oJ+ivt+axguacjeWKoeWZqOiOt+WPluS/oeaBrzogJW8nLCByZXF1ZXN0SWRzKTsKICAgICAgICAgICAgcGFyYW1zLnF1ZXJ5ID0gewogICAgICAgICAgICAgICAgaWRzOiByZXF1ZXN0SWRzCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHBhcmFtcy5fb25sb2FkID0gZXhwb3J0RnVuY3Rpb24oKGRhdGEsIF9vbmxvYWQpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuTG9hZENhY2hlKGZhbHNlKTsKICAgICAgICAgICAgICAgIGRhdGEuc29uZ3MuZm9yRWFjaCgoc29uZykgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuX3NvbmdDYWNoZVtzb25nLmlkXSA9IHNvbmc7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMuU2F2ZUNhY2hlKCk7CiAgICAgICAgICAgICAgICBsZXQgcmVwbHkgPSBTb25nc1RvVXJsUmVwbHkoX2lkcy5tYXAoKGlkKSA9PiB0aGlzLl9zb25nQ2FjaGVbaWRdKSk7CiAgICAgICAgICAgICAgICB0aGlzLk5vdGlmeVVybENoYW5nZShyZXBseS5kYXRhWzBdLnVybCk7CiAgICAgICAgICAgICAgICBfb25sb2FkKHJlcGx5KTsKICAgICAgICAgICAgfSwgdW5zYWZlV2luZG93KTsKICAgICAgICAgICAgdGhpcy5fYWpheEJhY2t1cCh1cmwsIHBhcmFtcyk7CiAgICAgICAgfQogICAgICAgIExvYWRDYWNoZShmb3JjZSA9IGZhbHNlKSB7CiAgICAgICAgICAgIGlmIChmb3JjZSB8fCB0aGlzLl9yZWxvYWRDYWNoZSkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9zb25nQ2FjaGUgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5fX3RyYWNrX3F1ZXVlX2NhY2hlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9zb25nQ2FjaGUgPSB7fTsKICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuX190cmFja19xdWV1ZV9jYWNoZSA9ICd7fSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5fcmVsb2FkQ2FjaGUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgU2F2ZUNhY2hlKCkgewogICAgICAgICAgICBsb2NhbFN0b3JhZ2UuX190cmFja19xdWV1ZV9jYWNoZSA9IEpTT04uc3RyaW5naWZ5KHRoaXMuX3NvbmdDYWNoZSk7CiAgICAgICAgfQogICAgICAgIEFqYXhQYXRjaGVkSW50ZXJuYXRpb25hbCh1cmwsIHBhcmFtcywgdHJ5X2JyKSB7CiAgICAgICAgICAgIGlmICh1cmwgIT0gJy9hcGkvc29uZy9lbmhhbmNlL3BsYXllci91cmwnKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9hamF4QmFja3VwKHVybCwgcGFyYW1zKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBkb2N1bWVudC5jb29raWUgPSAnb3M9dXdwJzsKICAgICAgICAgICAgbGV0IGlwID0gdGhpcy5faXBzLnNoaWZ0KCk7CiAgICAgICAgICAgIHRoaXMuX2lwcy5wdXNoKGlwKTsKICAgICAgICAgICAgcGFyYW1zLmhlYWRlcnNbJ1gtUmVhbC1JUCddID0gaXA7CiAgICAgICAgICAgIHZhciBpZCA9IEpTT04ucGFyc2UocGFyYW1zLnF1ZXJ5LmlkcylbMF07CiAgICAgICAgICAgIHBhcmFtcy5fb25sb2FkID0gZXhwb3J0RnVuY3Rpb24oKGRhdGEsIF9vbmxvYWQpID0+IHsKICAgICAgICAgICAgICAgIGlmIChkYXRhLmRhdGFbMF0udXJsKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9IHRoaXMuSW5qZWN0Q2RuKGRhdGEuZGF0YVswXS51cmwpOwogICAgICAgICAgICAgICAgICAgIF9vbmxvYWQoVXJsVG9Tb25nVXJsUmVwbHkoaWQsIHVybCkpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuTm90aWZ5VXJsQ2hhbmdlKHVybCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChTY3JpcHRDb25maWdfMy5Db25maWcuYlllbGxvd0Vhc2VVc2VUaHJpZE9uRmFpbCAmJiAhdHJ5X2JyKSB7CiAgICAgICAgICAgICAgICAgICAgTXVzaWNTcHkuR2V0KGlkLCAoZXJyLCB1cmwpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2VyXzUuZXJyb3IoZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2RuX3VybCA9IHRoaXMuSW5qZWN0Q2RuKHVybCk7CiAgICAgICAgICAgICAgICAgICAgICAgIF9vbmxvYWQoVXJsVG9Tb25nVXJsUmVwbHkoaWQsIGNkbl91cmwpKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5Ob3RpZnlVcmxDaGFuZ2UoY2RuX3VybCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgIH0sIHVuc2FmZVdpbmRvdyk7CiAgICAgICAgICAgIHRoaXMuX2FqYXhCYWNrdXAodXJsLCBwYXJhbXMpOwogICAgICAgIH0KICAgICAgICBOb3RpZnlVcmxDaGFuZ2UodXJsKSB7CiAgICAgICAgICAgIHRoaXMuX3NvbmcudXJsID0gdXJsOwogICAgICAgICAgICB0aGlzLk9uU29uZ0NoYW5nZSgpOwogICAgICAgIH0KICAgICAgICBPblNvbmdDaGFuZ2UoKSB7CiAgICAgICAgICAgIHRoaXMuX2J0bkRvd25sb2FkLmF0dHIoewogICAgICAgICAgICAgICAgaHJlZjogdGhpcy5fZG93bmxvYWRlci5HZW5lcmF0ZVVyaSh0aGlzLl9zb25nLnVybCwgYCR7dGhpcy5fc29uZy5uYW1lfSBbJHt0aGlzLl9zb25nLmFydGlzdHN9XS5tcDNgKSwKICAgICAgICAgICAgICAgIHRpdGxlOiBg5LiL6L29OiAke3RoaXMuX3NvbmcubmFtZX1gCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBJbmplY3RDZG4odXJsKSB7CiAgICAgICAgICAgIHZhciByID0gdXJsLnJlcGxhY2UoLyhtMTBcLm11c2ljXC4xMjZcLm5ldCkvLCBgJHt0aGlzLl9jZG59LyQxYCk7CiAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOaSreaUvumfs+S5kCAoJHtyfSlgKTsKICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgfQogICAgICAgIE5leHRDZG4oKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5fY2RucykKICAgICAgICAgICAgICAgIEdlbmVyYXRlQ2RuTGlzdCh0aGlzKTsKICAgICAgICAgICAgdmFyIGlwID0gdGhpcy5fY2Rucy5zaGlmdCgpOwogICAgICAgICAgICB0aGlzLl9jZG5zLnB1c2goaXApOwogICAgICAgICAgICB0aGlzLk5vdGlmeUNkbihpcCk7CiAgICAgICAgfQogICAgICAgIE5vdGlmeUNkbihpcCkgewogICAgICAgICAgICBpZiAodGhpcy5fYnRuQ2hhbmdlQ2RuKQogICAgICAgICAgICAgICAgdGhpcy5fYnRuQ2hhbmdlQ2RuLmF0dHIoJ3RpdGxlJywgYOabtOaNoiBDRE4gW+W9k+WJjTogJHtpcH1dYCk7CiAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOS9v+eUqCBDRE46ICR7aXB9YCk7CiAgICAgICAgICAgIHRoaXMuX2NkbiA9IGlwOwogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uud3NfY2RuX21lZGlhID0gaXA7CiAgICAgICAgICAgIEdNX3NldFZhbHVlKCJfd3NfY2RuX21lZGlhIiwgaXApOwogICAgICAgICAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChTY3JpcHRfNy5TY3JpcHQuTmFtZSArICctY2RuJywgewogICAgICAgICAgICAgICAgZGV0YWlsOiBpcAogICAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICAgIEhvb2tSYWRpb1BsYXllcigpIHsKICAgICAgICB9CiAgICAgICAgRnJhbWVQYWdlKCkgewogICAgICAgICAgICBzd2l0Y2ggKGxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJylbMV0pIHsKICAgICAgICAgICAgICAgIGNhc2UgJ212JzoKICAgICAgICAgICAgICAgICAgICB0aGlzLk1vdmllUGFnZSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnb3V0Y2hhaW4nOgogICAgICAgICAgICAgICAgICAgIHRoaXMuT3V0Y2hhaW5QYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdzb25nJzoKICAgICAgICAgICAgICAgICAgICB0aGlzLlNpbmdsZVBhZ2UoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2FsYnVtJzogLy8g5LiT6L6RCiAgICAgICAgICAgICAgICBjYXNlICdhcnRpc3QnOiAvLyDoibrmnK/lrrYKICAgICAgICAgICAgICAgIGNhc2UgJ3BsYXlsaXN0JzogLy8g5pKt5pS+5YiX6KGoCiAgICAgICAgICAgICAgICBjYXNlICdkaXNjb3Zlcic6CiAgICAgICAgICAgICAgICAgICAgdGhpcy5FbmFibGVJdGVtcygpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIE1vdmllUGFnZSgpIHsKICAgICAgICAgICAgdmFyICRmbGFzaEJveCA9ICQoJyNmbGFzaF9ib3gnKTsKICAgICAgICAgICAgaWYgKCRmbGFzaEJveC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB2YXIgaHRtbCA9ICRmbGFzaEJveC5odG1sKCk7CiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gcXMuUGFyc2UoaHRtbC5tYXRjaCgvZmxhc2h2YXJzPSIoW1xzXFNdKz8pIi8pWzFdLnJlcGxhY2UoLyZhbXA7L2csICcmJykpOwogICAgICAgICAgICAgICAgdmFyIHF1YWxpdGllcyA9IHsKICAgICAgICAgICAgICAgICAgICBodXJsOiAn6auY5riFJywKICAgICAgICAgICAgICAgICAgICBtdXJsOiAn5qCH5riFJywKICAgICAgICAgICAgICAgICAgICBsdXJsOiAn5rij55S76LSoJwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHZhciAkZGxIb2xkZXIgPSAkKCc8cD4nKS5jc3MoewogICAgICAgICAgICAgICAgICAgIHRleHRBbGlnbjogJ3JpZ2h0JwogICAgICAgICAgICAgICAgfSkudGV4dCgnTVYg5LiL6L29OiAnKS5pbnNlcnRBZnRlcigkZmxhc2hCb3gpOwogICAgICAgICAgICAgICAgT2JqZWN0LmtleXMocXVhbGl0aWVzKS5mb3JFYWNoKChxdWFsaXR5SWQpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zW3F1YWxpdHlJZF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRkbCA9ICQoJzxhPicpLmF0dHIoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZjogdGhpcy5fZG93bmxvYWRlci5HZW5lcmF0ZVVyaShwYXJhbXNbcXVhbGl0eUlkXSwgYCR7cGFyYW1zLnRyYWNrTmFtZX1bJHtxdWFsaXRpZXNbcXVhbGl0eUlkXX1dLm1wNGApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGDkuIvovb0gJHtwYXJhbXMudHJhY2tOYW1lfSDnmoQgJHtxdWFsaXRpZXNbcXVhbGl0eUlkXX0gTXZgCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnByb3AoJ2Rvd25sb2FkJywgdHJ1ZSkudGV4dChxdWFsaXRpZXNbcXVhbGl0eUlkXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS/ruatoyAxNjMg6Ieq5bex55qE6Lez6L2sLgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb3dubG9hZGVyLkNhcHR1cmVBcmlhKCRkbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRkbEhvbGRlci5hcHBlbmQoJGRsKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGRsSG9sZGVyLmFwcGVuZCgnIHwgJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAkZGxIb2xkZXIuYXBwZW5kKGDmj5Dkvps6ICR7U2NyaXB0XzcuU2NyaXB0Lk5hbWV9ICR7Q29uc3RhbnRzXzMudmVyc2lvbn1gKTsKICAgICAgICAgICAgICAgIGlmIChTY3JpcHRDb25maWdfMy5Db25maWcuYlllbGxvd0Vhc2VJbnRlcm5hdGlvbmFsKSB7CiAgICAgICAgICAgICAgICAgICAgJGZsYXNoQm94Lmh0bWwoaHRtbC5yZXBsYWNlKC9yZXN0cmljdD10cnVlL2csICdyZXN0cmljdD0nKSk7CiAgICAgICAgICAgICAgICAgICAgLy8g6Ieq5Yqo5YWz6Zet5by55Ye655qE5o+Q56S65qGGCiAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd6Y2xzJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbFswXS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnbW91c2Vkb3duJykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCAxMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIE91dGNoYWluUGFnZSgpIHsKICAgICAgICAgICAgLy8gVE9ETzog5aSW6ZO+6aG16Z2iCiAgICAgICAgfQogICAgICAgIFNpbmdsZVBhZ2UoKSB7CiAgICAgICAgICAgIHZhciB0aW1lciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgcGxheUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3UtYnRuaS1hZGRwbHknKTsKICAgICAgICAgICAgICAgIGlmIChwbGF5QnV0dG9uLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGltZXIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBpdCBzaG91bGQgYmUgYSBkaXNhYmxlZCBidXR0b24uCiAgICAgICAgICAgICAgICB2YXIgcGxheUJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd1LWJ0bmktcGxheS1kaXMnKTsKICAgICAgICAgICAgICAgIGlmIChwbGF5QnV0dG9ucy5sZW5ndGggPT0gMSkgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRpbWVyKTsKICAgICAgICAgICAgICAgICAgICB2YXIgc29uZ0lkID0gJCgnI2NvbnRlbnQtb3BlcmF0aW9uJykuZGF0YSgncmlkJyk7CiAgICAgICAgICAgICAgICAgICAgcGxheUJ1dHRvbnNbMF0ub3V0ZXJIVE1MID0gYAo8YSBkYXRhLXJlcy1hY3Rpb249InBsYXkiIGRhdGEtcmVzLWlkPSIke3NvbmdJZH0iIGRhdGEtcmVzLXR5cGU9IjE4IiBocmVmPSJqYXZhc2NyaXB0OjsiCiAgY2xhc3M9InUtYnRuMiB1LWJ0bjItMiB1LWJ0bmktYWRkcGx5IGYtZmwiIGhpZGVmb2N1cz0idHJ1ZSIgdGl0bGU9IuaSreaUviI+CiAgICA8aT48ZW0gY2xhc3M9InBseSI+PC9lbT7mkq3mlL48L2k+CjwvYT4KCjxhIGRhdGEtcmVzLWFjdGlvbj0iYWRkdG8iIGRhdGEtcmVzLWlkPSIke3NvbmdJZH0iIGRhdGEtcmVzLXR5cGU9IjE4IiBocmVmPSJqYXZhc2NyaXB0OjsiCiAgY2xhc3M9InUtYnRuaSB1LWJ0bmktYWRkIiBoaWRlZm9jdXM9InRydWUiIHRpdGxlPSLmt7vliqDliLDmkq3mlL7liJfooagiPgo8L2E+CiAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICB9CiAgICAgICAgRW5hYmxlSXRlbXMoKSB7CiAgICAgICAgICAgIHZhciB0aW1lciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgICB2YXIgZGlzYmxlZEl0ZW1zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnanMtZGlzJyk7CiAgICAgICAgICAgICAgICBpZiAoZGlzYmxlZEl0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRpbWVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGlzYmxlZEl0ZW1zLmxlbmd0aDspIHsKICAgICAgICAgICAgICAgICAgICBkaXNibGVkSXRlbXNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnanMtZGlzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIFRlc3RTdHJpbmcoc3JjLCBuZWVkbGUpIHsKICAgICAgICBpZiAodHlwZW9mIG5lZWRsZSA9PSAnc3RyaW5nJykgewogICAgICAgICAgICByZXR1cm4gRXh0ZW5zaW9uXzkuQ29udGFpbnMoc3JjLCBuZWVkbGUpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG5lZWRsZS50ZXN0KHNyYyk7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gR2VuZXJhdGVDZG5MaXN0KGN0eCkgewogICAgICAgIHZhciBjZG5zID0gWwogICAgICAgICAgICAvLyDnlLXkv6EKICAgICAgICAgICAgIjEyNS45MC4yMDYuMzIiLAogICAgICAgICAgICAiMjIyLjE4Ni4xMzIuMTAzIiwKICAgICAgICAgICAgIjExNy4yMy42Ljg5IiwKICAgICAgICAgICAgIjExOS4xNDUuMjA3LjE3IiwKICAgICAgICAgICAgIjE4MC45Ny4xODAuNzEiLAogICAgICAgICAgICAiMTE2LjU1LjIzNi45MyIsCiAgICAgICAgICAgICIyMTguNzYuMTA1LjQyIiwKICAgICAgICAgICAgIjEyNS42NC4yMzIuMTUiLAogICAgICAgICAgICAiMTE1LjIzMS44Ny4zNyIsCiAgICAgICAgICAgICI1OC4yMjEuNzguNjgiLAogICAgICAgICAgICAiMjIwLjExMi4xOTUuMTQ4IiwKICAgICAgICAgICAgIjIxOC42NC45NC42NyIsCiAgICAgICAgICAgICIzNi40Mi4zMi43NiIsCiAgICAgICAgICAgICI2MS4xMzYuMjExLjE2IiwKICAgICAgICAgICAgIjIxOC42NC45NC42OCIsCiAgICAgICAgICAgICIyMTkuMTM4LjIxLjcxIiwKICAgICAgICAgICAgIjQ5Ljc5LjIzMi41OCIsCiAgICAgICAgICAgICIxMjIuMjI4LjI0LjMwIiwKICAgICAgICAgICAgIjE4Mi4xMDYuMTk0Ljg1IiwKICAgICAgICAgICAgIjIxOC41OS4xODYuOTgiLAogICAgICAgICAgICAiNjEuMTU4LjEzMy4yMSIsCiAgICAgICAgICAgICIxMTcuMjcuMjQxLjIwIiwKICAgICAgICAgICAgIjU4LjUxLjE1MC4xMzMiLAogICAgICAgICAgICAiMjE4LjI5LjQ5LjEzMiIsCiAgICAgICAgICAgICI2MC4yMTUuMTI1Ljc2IiwKICAgICAgICAgICAgIjE4My42MS4yMi4xNyIsCiAgICAgICAgICAgICIxODMuMTM0LjE0LjI2IiwKICAgICAgICAgICAgIjU4LjIyMC42LjE0MiIsCiAgICAgICAgICAgICIxMTUuMjMxLjE1OC40NCIsCiAgICAgICAgICAgICI2MS4xNjQuMjQxLjEwNSIsCiAgICAgICAgICAgICIxMjUuNDYuMjIuMTI0IiwKICAgICAgICAgICAgIjIyMi4yOC4xNTIuMTM5IiwKICAgICAgICAgICAgIjEyNC4xNjUuMjE2LjI0NCIsCiAgICAgICAgICAgICIyMTguNjAuMTA2LjExNSIsCiAgICAgICAgICAgICIyMDIuMTA3Ljg1LjgxIiwKICAgICAgICAgICAgIjYxLjE3OS4xMDcuMTE2IiwKICAgICAgICAgICAgIjE3NS40My4yMC42OSIsCiAgICAgICAgICAgICIyMjAuMTk0LjIwMy44NiIsCiAgICAgICAgICAgICI2MS4xNjAuMjA5LjI3IiwKICAgICAgICAgICAgIjEyMC4yMDkuMTQxLjc5IiwKICAgICAgICAgICAgIjEyMC4yMDkuMTQyLjEzOCIsCiAgICAgICAgICAgICIyMTkuMTM4LjIxLjcyIiwKICAgICAgICAgICAgIjU4LjIxNi4yMS4xMzIiLAogICAgICAgICAgICAnMTQuMjE1LjIyOC4xMCcsCiAgICAgICAgICAgICcyMTguODcuMTExLjgzJywKICAgICAgICAgICAgLy8g5YyX5Lqs55S15L+hCiAgICAgICAgICAgICcyMDMuMTMwLjU5LjgnLAogICAgICAgICAgICAnMjAzLjEzMC41OS4xMCcsCiAgICAgICAgICAgICcyMDMuMTMwLjU5LjExJywKICAgICAgICAgICAgJzIwMy4xMzAuNTkuMTInCiAgICAgICAgXTsKICAgICAgICBjdHguX2NkbnMgPSBFeHRlbnNpb25fOS5TaHVmZmxlKGNkbnMpOwogICAgICAgIHZhciBpcHMgPSBbCiAgICAgICAgICAgICcxMDYuMTIwLjE2Ny42NycsICcxMTEuMjA2LjYxLjEzMScsICcxMTEuMjA2LjYxLjEzMScsICcxMTEuMTMuNjYuMjI2JywKICAgICAgICAgICAgJzEwNi4xMjAuMTY3LjY3JywgJzEyNS44OC4xOTAuNTYnLCAnMjIyLjczLjE0NC4xOTUnLCAnMjIwLjE4MS41Ny4yMzInLAogICAgICAgICAgICAnMTgwLjE0OS4xMzEuMjQ3JywgJzE4MC4xNDkuMTMzLjE2NycsICcxMTIuMzQuMTExLjEyMScsICc2MS4xMzUuMTg1LjI0JwogICAgICAgIF07CiAgICAgICAgY3R4Ll9pcHMgPSBFeHRlbnNpb25fOS5TaHVmZmxlKGlwcyk7CiAgICB9CiAgICBmdW5jdGlvbiBHZW5lcmF0ZVZhbGlkTmFtZSgpIHsKICAgICAgICByZXR1cm4gYCR7U2NyaXB0XzcuU2NyaXB0Lk5hbWV9X18ke0RhdGUubm93KCl9JHtNYXRoLnJhbmRvbSgpfWA7CiAgICB9CiAgICBmdW5jdGlvbiBHZXRFbmhhbmNlZERhdGEoaWQsIHVybCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgIGJyOiAxOTIwMDAsCiAgICAgICAgICAgIHNpemU6IDEyMDAwMCwKICAgICAgICAgICAgbWQ1OiAnMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAnLAogICAgICAgICAgICBjb2RlOiAyMDAsCiAgICAgICAgICAgIGV4cGk6IDEyMDAsCiAgICAgICAgICAgIHR5cGU6ICdtcDMnLAogICAgICAgICAgICBnYWluOiAwLAogICAgICAgICAgICBmZWU6IDAsCiAgICAgICAgICAgIHVmOiBudWxsLAogICAgICAgICAgICBwYXllZDogMCwKICAgICAgICAgICAgY2FuRXh0ZW5kOiBmYWxzZQogICAgICAgIH07CiAgICB9CiAgICBmdW5jdGlvbiBTb25nc1RvVXJsUmVwbHkoc29uZ3MpIHsKICAgICAgICB2YXIgcmVwbHkgPSB7CiAgICAgICAgICAgIGNvZGU6IDIwMCwKICAgICAgICAgICAgZGF0YTogc29uZ3MubWFwKChzb25nKSA9PiB7CiAgICAgICAgICAgICAgICByZXR1cm4gR2V0RW5oYW5jZWREYXRhKHNvbmcuaWQsIEdlbmVyYXRlVXJsRnJvbVNvbmcoc29uZykpOwogICAgICAgICAgICB9KQogICAgICAgIH07CiAgICAgICAgcmV0dXJuIGNsb25lSW50byhyZXBseSwgdW5zYWZlV2luZG93LCB7CiAgICAgICAgICAgIGNsb25lRnVuY3Rpb25zOiBmYWxzZSwKICAgICAgICAgICAgd3JhcFJlZmxlY3RvcnM6IHRydWUKICAgICAgICB9KTsKICAgIH0KICAgIGZ1bmN0aW9uIFVybFRvU29uZ1VybFJlcGx5KGlkLCB1cmwpIHsKICAgICAgICB2YXIgcmVwbHkgPSB7CiAgICAgICAgICAgIGNvZGU6IDIwMCwKICAgICAgICAgICAgZGF0YTogW0dldEVuaGFuY2VkRGF0YShpZCwgdXJsKV0KICAgICAgICB9OwogICAgICAgIHJldHVybiBjbG9uZUludG8ocmVwbHksIHVuc2FmZVdpbmRvdywgewogICAgICAgICAgICBjbG9uZUZ1bmN0aW9uczogZmFsc2UsCiAgICAgICAgICAgIHdyYXBSZWZsZWN0b3JzOiB0cnVlCiAgICAgICAgfSk7CiAgICB9CiAgICBmdW5jdGlvbiBHZW5lcmF0ZVVybEZyb21Tb25nKHNvbmcpIHsKICAgICAgICB2YXIgZGZzSWQ7CiAgICAgICAgdmFyIHEgPSAoc29uZy5oIHx8IHNvbmcubSB8fCBzb25nLmwgfHwgc29uZy5hKTsKICAgICAgICBpZiAoIXEpIHsKICAgICAgICAgICAgTG9nZ2VyXzUuZXJyb3IoYOatjOabsiAke3NvbmcubmFtZX0g5bey57uP5LiL5p6277yM6I635Y+W5Zyw5Z2A5aSx6LSlIWApOwogICAgICAgICAgICByZXR1cm4gX19NUDNfQkxBTks7CiAgICAgICAgfQogICAgICAgIGRmc0lkID0gcS5maWQ7CiAgICAgICAgdmFyIHJhbmRTZXJ2ZXIgPSB+fihNYXRoLnJhbmRvbSgpICogMikgKyAxOwogICAgICAgIHZhciBpcFByZWZpeCA9ICcnOwogICAgICAgIGlmIChTY3JpcHRDb25maWdfMy5Db25maWcuYlllbGxvd0Vhc2VJbnRlcm5hdGlvbmFsKSB7CiAgICAgICAgICAgIGlmIChTY3JpcHRDb25maWdfMy5Db25maWcuYlllbGxvd0Vhc2VVc2VPbGRBcGkpIHsKICAgICAgICAgICAgICAgIGlwUHJlZml4ID0gJzEyNy4wLjAuMTo0MDAzLyc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBUT0RPOiDov5nkupsgSXAg5pyJ55So5ZibPwogICAgICAgICAgICAgICAgaXBQcmVmaXggPSBydWxlLmluc3RhbmNlLl9jZG47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdmFyIGRmc0hhc2ggPSBEb0Rmc0hhc2goZGZzSWQpOwogICAgICAgIHJldHVybiBgaHR0cDovLyR7aXBQcmVmaXh9bSR7cmFuZFNlcnZlcn0ubXVzaWMuMTI2Lm5ldC8ke2Rmc0hhc2h9LyR7ZGZzSWR9Lm1wM2A7CiAgICB9CiAgICBmdW5jdGlvbiBzdHJUb0tleUNvZGVzKHN0cikgewogICAgICAgIHJldHVybiBTdHJpbmcoc3RyKS5zcGxpdCgnJykubWFwKChjaCkgPT4gY2guY2hhckNvZGVBdCgwKSk7CiAgICB9CiAgICBjb25zdCBrZXlzID0gWwogICAgICAgIDUxLCAxMDMsIDExMSwgNTYsIDM4LCAzNiwKICAgICAgICA1NiwgNDIsIDUxLCA0MiwgNTEsIDEwNCwKICAgICAgICA0OCwgMTA3LCA0MCwgNTAsIDQxLCA1MAogICAgXTsKICAgIGZ1bmN0aW9uIERvRGZzSGFzaChkZnNpZCkgewogICAgICAgIHZhciBmaWRzID0gc3RyVG9LZXlDb2RlcyhkZnNpZCkubWFwKGZ1bmN0aW9uIChmaWQsIGkpIHsKICAgICAgICAgICAgcmV0dXJuIChmaWQgXiBrZXlzW2kgJSBrZXlzLmxlbmd0aF0pICYgMHhGRjsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gQ3J5cHRvSlMuTUQ1KENyeXB0b0pTLmxpYi5CeXRlQXJyYXkoZmlkcykpCiAgICAgICAgICAgIC50b1N0cmluZyhDcnlwdG9KUy5lbmMuQmFzZTY0KQogICAgICAgICAgICAucmVwbGFjZSgvXC8vZywgIl8iKQogICAgICAgICAgICAucmVwbGFjZSgvXCsvZywgIi0iKTsKICAgIH0KICAgIHZhciBNdXNpY1NweTsKICAgIChmdW5jdGlvbiAoTXVzaWNTcHkpIHsKICAgICAgICB2YXIgX3JlYWR5ID0gZmFsc2U7CiAgICAgICAgdmFyIF9yZWxvYWRDYWNoZSA9IHRydWU7CiAgICAgICAgdmFyIF9jYWNoZSA9IHt9OwogICAgICAgIGZ1bmN0aW9uIEluaXQoKSB7CiAgICAgICAgICAgIF9yZWFkeSA9IHRydWU7CiAgICAgICAgICAgIFNjcmlwdF83LlNjcmlwdC5SZWdpc3RlclN0b3JhZ2VFdmVudCgnX01VU0lDX1NQWScsICgpID0+IHsKICAgICAgICAgICAgICAgIF9yZWxvYWRDYWNoZSA9IHRydWU7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBSZWxvYWRDYWNoZSgpOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBSZWxvYWRDYWNoZShmb3JjZSA9IGZhbHNlKSB7CiAgICAgICAgICAgIGlmIChmb3JjZSB8fCBfcmVsb2FkQ2FjaGUpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgX2NhY2hlID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuX01VU0lDX1NQWSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgICAgICAgICBfY2FjaGUgPSB7fTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBfcmVsb2FkQ2FjaGUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gUmVhZENhY2hlKGlkKSB7CiAgICAgICAgICAgIGlmIChfcmVsb2FkQ2FjaGUpCiAgICAgICAgICAgICAgICBSZWxvYWRDYWNoZSgpOwogICAgICAgICAgICByZXR1cm4gX2NhY2hlW2lkXTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gU2F2ZUNhY2hlKCkgewogICAgICAgICAgICBsb2NhbFN0b3JhZ2UuX01VU0lDX1NQWSA9IEpTT04uc3RyaW5naWZ5KF9jYWNoZSk7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIEdldChpZCwgY2FsbGJhY2spIHsKICAgICAgICAgICAgaWYgKCFfcmVhZHkpCiAgICAgICAgICAgICAgICBJbml0KCk7CiAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOesrOS4gOatpTog5pCc57Si5puy55uuICgke2lkfSlgKTsKICAgICAgICAgICAgdmFyIGNhY2hlU29uZyA9IFJlYWRDYWNoZShpZCk7CiAgICAgICAgICAgIGlmIChjYWNoZVNvbmcpIHsKICAgICAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOivu+iHque8k+WtmCwg6K+35rGC6Kej5p6Q55yf5a6e5Zyw5Z2A44CCYCk7CiAgICAgICAgICAgICAgICBQYXJzZVJlYWxBZGRyZXNzKGNhY2hlU29uZywgY2FsbGJhY2spOwogICAgICAgICAgICAgICAgLy8gY2FsbGJhY2sobnVsbCwgY2FjaGVTb25nLnVybCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QoewogICAgICAgICAgICAgICAgbWV0aG9kOiAiR0VUIiwKICAgICAgICAgICAgICAgIHVybDogYGh0dHA6Ly9hcGkuaXR3dXN1bi5jb20vbXVzaWMvc2VhcmNoL3d5LzE/Zm9ybWF0PWpzb24mc2lnbj1hNWNjMGE4Nzk3NTM5ZDNhMWE0ZjdhZWNhNWI2OTViOSZrZXl3b3JkPSR7aWR9YCwKICAgICAgICAgICAgICAgIG9ubG9hZDogKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGE7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2UucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+aXoOaViOeahOabsuebruaQnOe0oue7k+aenOOAgicpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgc29uZyA9IGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigoc29uZykgPT4gc29uZy5UeXBlID09ICd3eScgJiYgc29uZy5Tb25nSWQgPT0gaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3AoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIXNvbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCfmib7kuI3liLDmm7Lnm67kv6Hmga/jgIInKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHNvbmcuU3FVcmwgfHwgc29uZy5IcVVybCB8fCBzb25nLkxxVXJsOwogICAgICAgICAgICAgICAgICAgIHZhciBzb25nT2JqID0gewogICAgICAgICAgICAgICAgICAgICAgICB0aW1lOiBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgICAgICAgICAgICAgcmVhbF90aW1lOiAwLAogICAgICAgICAgICAgICAgICAgICAgICByZWFsX3VybDogbnVsbAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgX2NhY2hlW2lkXSA9IHNvbmdPYmo7CiAgICAgICAgICAgICAgICAgICAgU2F2ZUNhY2hlKCk7CiAgICAgICAgICAgICAgICAgICAgTG9nZ2VyXzUuaW5mbyhg5oiQ5Yqf5Y+W5b6X5Zyw5Z2ALCDor7fmsYLop6PmnpDnnJ/lrp7lnLDlnYDjgIJgKTsKICAgICAgICAgICAgICAgICAgICBQYXJzZVJlYWxBZGRyZXNzKHNvbmdPYmosIGNhbGxiYWNrKTsKICAgICAgICAgICAgICAgICAgICAvLyBjYWxsYmFjayhudWxsLCB1cmwpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9uZXJyb3I6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+e9kee7nOmUmeivryAo5pCc57Si5puy55uuKScpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIE11c2ljU3B5LkdldCA9IEdldDsKICAgICAgICAvLyDlm5vlsI/ml7blkI7ov4fmnJ8KICAgICAgICAvLyAxMDAwICogNjAgKiA2MCAqNCA9PSAxNDQwMDAwMAogICAgICAgIGZ1bmN0aW9uIFBhcnNlUmVhbEFkZHJlc3MoY2FjaGVTb25nLCBjYWxsYmFjaykgewogICAgICAgICAgICBMb2dnZXJfNS5pbmZvKGDnrKzkuozmraU6IOino+aekOecn+WunuWcsOWdgCAoJHtjYWNoZVNvbmcudXJsfSlgKTsKICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBjYWNoZVNvbmcucmVhbF90aW1lIDwgMTQ0MDAwMDApIHsKICAgICAgICAgICAgICAgIExvZ2dlcl81LmluZm8oYOivu+iHque8k+WtmO+8jOe7k+adn+ivu+WPluOAgmApOwogICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgY2FjaGVTb25nLnJlYWxfdXJsKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBHTV94bWxodHRwUmVxdWVzdCh7CiAgICAgICAgICAgICAgICBtZXRob2Q6ICJHRVQiLAogICAgICAgICAgICAgICAgdXJsOiBjYWNoZVNvbmcudXJsLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIFJhbmdlOiAnYnl0ZXM9MC0yJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9ubG9hZDogKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY2FjaGVTb25nLnJlYWxfdXJsID0gcmVzcG9uc2UuZmluYWxVcmw7CiAgICAgICAgICAgICAgICAgICAgY2FjaGVTb25nLnJlYWxfdGltZSA9IERhdGUubm93KCk7CiAgICAgICAgICAgICAgICAgICAgU2F2ZUNhY2hlKCk7CiAgICAgICAgICAgICAgICAgICAgTG9nZ2VyXzUuaW5mbyhg6Kej5p6Q57uT5p2fOiAke2NhY2hlU29uZy5yZWFsX3VybH1gKTsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXNwb25zZS5maW5hbFVybCk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgb25lcnJvcjogKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign572R57uc6ZSZ6K+vICjop6PmnpDnnJ/lrp7lnLDlnYDml7YpJyksIG51bGwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9KShNdXNpY1NweSB8fCAoTXVzaWNTcHkgPSB7fSkpOwp9KTsKZGVmaW5lKCJzaXRlL211c2ljLjF0aW5nIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL1dhaXQiLCAiaGVscGVyL0Rvd25sb2FkZXIiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFdhaXRfNiwgRG93bmxvYWRlcl81KSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgdmFyIHJ1bGUgPSB7CiAgICAgICAgaWQ6ICdtdXNpYy4xdGluZycsCiAgICAgICAgc3NsOiBmYWxzZSwKICAgICAgICBuYW1lOiAn5LiA5ZCs6Z+z5LmQJywKICAgICAgICBob3N0OiAnd3d3LjF0aW5nLmNvbScsCiAgICAgICAgaW5jbHVkZVN1Ykhvc3Q6IGZhbHNlLAogICAgICAgIHN1Yk1vZHVsZTogZmFsc2UsCiAgICAgICAgY3NzOiBgYCwKICAgICAgICBiZDogbnVsbCwKICAgICAgICBfZGw6IG51bGwsCiAgICAgICAgb25TdGFydDogKCkgPT4gewogICAgICAgICAgICBydWxlLmJkID0gbmV3IERvd25sb2FkZXJfNS5Eb3dubG9hZGVyKCk7CiAgICAgICAgfSwKICAgICAgICBvbkJvZHk6ICgpID0+IHsKICAgICAgICAgICAgcnVsZS5fZGwgPSAkKCcuc29uZ2FjdCA+IC5kb3duJyk7CiAgICAgICAgICAgIHJ1bGUuX2RsCiAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cignb25jbGljaycpCiAgICAgICAgICAgICAgICAuYXR0cigndGFyZ2V0JywgJ19ibGFuaycpOwogICAgICAgICAgICBydWxlLmJkLkNhcHR1cmVBcmlhKHJ1bGUuX2RsKTsKICAgICAgICAgICAgV2FpdF82LldhaXRVbnRpbCgneWl0aW5nLnBsYXllci5ob29rJywgKCkgPT4gewogICAgICAgICAgICAgICAgdW5zYWZlV2luZG93LnlpdGluZy5wbGF5ZXIuaG9vaygncGxheScsIGV4cG9ydEZ1bmN0aW9uKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBydWxlLlVwZGF0ZVNvbmcoKTsKICAgICAgICAgICAgICAgIH0sIHVuc2FmZVdpbmRvdykpOwogICAgICAgICAgICAgICAgcnVsZS5VcGRhdGVTb25nKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgVXBkYXRlU29uZzogKCkgPT4gewogICAgICAgICAgICB2YXIgbmFtZSA9IHVuc2FmZVdpbmRvdy55aXRpbmcucGxheWVyLmdldCgnc29uZy1uYW1lJyk7CiAgICAgICAgICAgIHZhciBzaW5nZXIgPSB1bnNhZmVXaW5kb3cueWl0aW5nLnBsYXllci5nZXQoJ3Npbmdlci1uYW1lJyk7CiAgICAgICAgICAgIHZhciBsaW5rID0gdW5zYWZlV2luZG93LnlpdGluZy5wbGF5ZXIuaG9zdCArIHVuc2FmZVdpbmRvdy55aXRpbmcucGxheWVyLmdldCgnc29uZy1tZWRpYScpOwogICAgICAgICAgICBydWxlLl9kbC5hdHRyKHsKICAgICAgICAgICAgICAgIGhyZWY6IHJ1bGUuYmQuR2VuZXJhdGVVcmkobGluaywgYCR7bmFtZX0gWyR7c2luZ2VyfV0ubXAzYCksCiAgICAgICAgICAgICAgICB0aXRsZTogYOeCueaIkeS4i+i9vTogJHtuYW1lfWAKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfTsKICAgIGV4cG9ydHMuUnVsZXMgPSBbcnVsZV07Cn0pOwpkZWZpbmUoImhvb2tlci9qUGxheWVyIiwgWyJyZXF1aXJlIiwgImV4cG9ydHMiLCAiaGVscGVyL0xvZ2dlciIsICJoZWxwZXIvV2FpdCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgTG9nZ2VyXzYsIFdhaXRfNykgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIC8vLyA8cmVmZXJlbmNlIHBhdGg9Ii4uL3R5cGluZ3MvZ2xvYmFscy9qcXVlcnkvaW5kZXguZC50cyIgLz4KICAgIGZ1bmN0aW9uIFBhdGNoKGNhbGxiYWNrLCBuYW1lc3BhY2UgPSAialBsYXllciIpIHsKICAgICAgICBMb2dnZXJfNi5pbmZvKCfnrYnlvoUgalBsYXllciDlsLHnu6ogLi4nKTsKICAgICAgICBXYWl0XzcuV2FpdFVudGlsKGAkLiR7bmFtZXNwYWNlfS5wcm90b3R5cGUuc2V0TWVkaWFgLCAoKSA9PiB7CiAgICAgICAgICAgIExvZ2dlcl82LmluZm8oJ+W8gOWni+e7keWumuWHveaVsCAuLicpOwogICAgICAgICAgICB1bnNhZmVPdmVyd3JpdGVGdW5jdGlvblNhZmVQcm94eSh7CiAgICAgICAgICAgICAgICBzZXRNZWRpYTogKG5ld01lZGlhKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgTG9nZ2VyXzYuaW5mbygn5q2M5puy5pWw5o2uOiAnLCBuZXdNZWRpYSk7CiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobmV3TWVkaWEpOwogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvclVuc2FmZVN1Y2Nlc3MoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdW5zYWZlV2luZG93LiRbbmFtZXNwYWNlXS5wcm90b3R5cGUsIGAuJC4ke25hbWVzcGFjZX0ucHJvdG90eXBlYCk7CiAgICAgICAgfSk7CiAgICB9CiAgICBleHBvcnRzLlBhdGNoID0gUGF0Y2g7Cn0pOwpkZWZpbmUoInNpdGUvbXVzaWMuNTYiLCBbInJlcXVpcmUiLCAiZXhwb3J0cyIsICJoZWxwZXIvRG93bmxvYWRlciIsICJoZWxwZXIvU2NyaXB0IiwgImhlbHBlci9FeHRlbnNpb24iLCAiaG9va2VyL2pQbGF5ZXIiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIERvd25sb2FkZXJfNiwgU2NyaXB0XzgsIEV4dGVuc2lvbl8xMCwgalBsYXllcikgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIHZhciBydWxlID0gewogICAgICAgIGlkOiAnbXVzaWMuNTYnLAogICAgICAgIHNzbDogZmFsc2UsCiAgICAgICAgbmFtZTogJzU2IOmfs+S5kOe9kScsCiAgICAgICAgaG9zdDogJ3d3dy4yMzM1Ni5jb20nLAogICAgICAgIHBhdGg6IFsnL3BsdXMvcGxheWVyLmFzaHgnLCAnL3RpbmcvJywgJy9tdXNpYy8nXSwKICAgICAgICBpbmNsdWRlU3ViSG9zdDogZmFsc2UsCiAgICAgICAgc3ViTW9kdWxlOiBmYWxzZSwKICAgICAgICBoaWRlOiAnLnBsYXllci1ib3R0b20tZ2csIC5ub2NvcHlyaWdodCcsCiAgICAgICAgYmQ6IG51bGwsCiAgICAgICAgb25TdGFydDogKCkgPT4gewogICAgICAgICAgICBydWxlLmJkID0gbmV3IERvd25sb2FkZXJfNi5Eb3dubG9hZGVyKCk7CiAgICAgICAgfSwKICAgICAgICBvbkJvZHk6ICgpID0+IHsKICAgICAgICAgICAgalBsYXllci5QYXRjaCgobWVkaWEpID0+IHsKICAgICAgICAgICAgICAgIHZhciBhZGRyID0gbWVkaWEubXAzIHx8IG1lZGlhLm00YTsKICAgICAgICAgICAgICAgICQoJy5wbGF5LWluZm8tb3RoZXJvcHQgPiBhOmxhc3QnKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgcnVsZS5iZC5HZW5lcmF0ZVVyaShhZGRyLCBtZWRpYS5zb25nbmFtZSArIGFkZHIuc2xpY2UoLTQpKSkKICAgICAgICAgICAgICAgICAgICAuYXR0cigndGl0bGUnLCBg5LiL6L29OiAke21lZGlhLnNvbmduYW1lfSAo5q2M5omLOiAke21lZGlhLnNpbmdlcm5hbWV9KWApCiAgICAgICAgICAgICAgICAgICAgLmZpbmQoJ3NwYW4nKS50ZXh0KGDkuIvovb0gKCR7U2NyaXB0XzguU2NyaXB0Lk5hbWV9KWApOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdmFyIG5lZWRfcGxheSA9IGZhbHNlOwogICAgICAgICAgICB1bnNhZmVXaW5kb3cuc3BsYXllci5zb25nX2RhdGFbMF0uZm9yRWFjaCgoc29uZykgPT4gewogICAgICAgICAgICAgICAgaWYgKHNvbmcuZGVsZmxhZyB8fCBzb25nLmRlbGZsYWcgIT0gMCkgewogICAgICAgICAgICAgICAgICAgIG5lZWRfcGxheSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgc29uZy5kZWxmbGFnID0gMDsKICAgICAgICAgICAgICAgICAgICBpZiAoRXh0ZW5zaW9uXzEwLkJlZ2luV2l0aChzb25nLnVybCwgJy9kZWwnKSkgewogICAgICAgICAgICAgICAgICAgICAgICBzb25nLnVybCA9IHNvbmcudXJsLnJlcGxhY2UoJy9kZWwnLCAnJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKG5lZWRfcGxheSkgewogICAgICAgICAgICAgICAgdW5zYWZlV2luZG93LiQoJyNwbGF5JykuY2xpY2soKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CiAgICBleHBvcnRzLlJ1bGVzID0gW3J1bGVdOwp9KTsKZGVmaW5lKCJzaXRlL211c2ljLmVjaG8iLCBbInJlcXVpcmUiLCAiZXhwb3J0cyIsICJoZWxwZXIvTG9nZ2VyIiwgImhlbHBlci9XYWl0IiwgImhlbHBlci9Eb3dubG9hZGVyIiwgImhlbHBlci9FeHRlbnNpb24iXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIExvZ2dlcl83LCBXYWl0XzgsIERvd25sb2FkZXJfNywgRXh0ZW5zaW9uXzExKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgdmFyIHJ1bGUgPSB7CiAgICAgICAgaWQ6ICdtdXNpYy5lY2hvJywKICAgICAgICBzc2w6IGZhbHNlLAogICAgICAgIG5hbWU6ICdFY2hvIOWbnuWjsOmfs+S5kCcsCiAgICAgICAgaG9zdDogJ3d3dy5hcHAtZWNoby5jb20nLAogICAgICAgIHBhdGg6ICcvc291bmQvJywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogZmFsc2UsCiAgICAgICAgc3ViTW9kdWxlOiBmYWxzZSwKICAgICAgICBoaWRlOiAnJywKICAgICAgICBiZDogbnVsbCwKICAgICAgICBkbExpbms6IG51bGwsCiAgICAgICAgb25TdGFydCgpIHsKICAgICAgICAgICAgcnVsZS5iZCA9IG5ldyBEb3dubG9hZGVyXzcuRG93bmxvYWRlcigpOwogICAgICAgIH0sCiAgICAgICAgb25Cb2R5KCkgewogICAgICAgICAgICBpZiAoRXh0ZW5zaW9uXzExLkJlZ2luV2l0aChsb2NhdGlvbi5wYXRobmFtZSwgJy9zb3VuZC8nKSkgewogICAgICAgICAgICAgICAgcnVsZS5TaW5nbGVQYWdlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFNpbmdsZVBhZ2UoKSB7CiAgICAgICAgICAgIC8vIOWNleabsumhtemdogogICAgICAgICAgICAvLyBodHRwOi8vd3d3LmFwcC1lY2hvLmNvbS9zb3VuZC9pbmZvLW1vYmlsZT9zb3VuZF9pZD0ke2lkfQogICAgICAgICAgICB2YXIgaWQgPSBsb2NhdGlvbi5wYXRobmFtZS5tYXRjaCgvXGQrLyk7CiAgICAgICAgICAgIGlmICghaWQpIHsKICAgICAgICAgICAgICAgIExvZ2dlcl83LmVycm9yKCfojrflj5bmm7Lnm64gSUQg5aSx6LSlIScpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIOaPkuWFpeS4i+i9vei/nuaOpXgKICAgICAgICAgICAgdmFyIHNtYWxsVGV4dCA9ICQoJzxzbWFsbD4nKTsKICAgICAgICAgICAgdmFyIHVybERsID0gJCgnPGE+Jyk7CiAgICAgICAgICAgICQoJy5zaW5nbGUtdGl0bGUgPiBoMScpLmFwcGVuZChzbWFsbFRleHQpOwogICAgICAgICAgICBzbWFsbFRleHQuYXBwZW5kKHVybERsKTsKICAgICAgICAgICAgcnVsZS5kbExpbmsgPSB1cmxEbDsKICAgICAgICAgICAgdXJsRGwudGV4dCgn5LiL6L29JykKICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsICfmraPlnKjop6PmnpAuLi4nKQogICAgICAgICAgICAgICAgLmNzcygnbWFyZ2luLWxlZnQnLCAnMWVtJyk7CiAgICAgICAgICAgIHZhciBmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOwogICAgICAgICAgICBmcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZyYW1lKTsKICAgICAgICAgICAgdW5zYWZlV2luZG93Lm9uZXJyb3IgPSBudWxsOwogICAgICAgICAgICB2YXIgcmVxID0gewogICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJywKICAgICAgICAgICAgICAgIHVybDogYC9zb3VuZC9pbmZvLW1vYmlsZT9zb3VuZF9pZD0ke2lkfWAsCiAgICAgICAgICAgICAgICBvbmxvYWQ6IChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSAkKHJlc3BvbnNlLnJlc3BvbnNlVGV4dCkKICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcignc2NyaXB0JykKICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigoaSwgZWwpID0+IEV4dGVuc2lvbl8xMS5Db250YWlucyhlbC50ZXh0Q29udGVudCwgJ3BsYXlfc291cmNlKCcpKTsKICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBMb2dnZXJfNy5lcnJvcign5pCc57Si5LiN5Yiw5pyJ5pWI55qE5puy55uu5Luj56CB44CCJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8g5a+85Ye65oiR5Lus55qE5Ye95pWwCiAgICAgICAgICAgICAgICAgICAgdmFyIHduZCA9IGZyYW1lLmNvbnRlbnRXaW5kb3c7CiAgICAgICAgICAgICAgICAgICAgZXhwb3J0RnVuY3Rpb24oKGlkLCB0eXBlLCB1cmwsIHVuaykgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBXYWl0XzguV2FpdFVudGlsKCdwYWdlX3NvdW5kX29iaicsICgpID0+IHJ1bGUuVXBkYXRlVXJsKHVybCwgdW5zYWZlV2luZG93LnBhZ2Vfc291bmRfb2JqLm5hbWUpKTsKICAgICAgICAgICAgICAgICAgICB9LCB3bmQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmaW5lQXM6ICdwbGF5X3NvdXJjZScKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAvLyDmiafooYzmjZXmjYnliLDnmoTlhYPntKAKICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IHduZC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKICAgICAgICAgICAgICAgICAgICBzLnRleHRDb250ZW50ID0gdGFyZ2V0LnRleHQoKTsKICAgICAgICAgICAgICAgICAgICB3bmQuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDUuMS4xOyBOZXh1cyA2IEJ1aWxkL0xZWjI4RSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzQ4LjAuMjU2NC4yMyBNb2JpbGUgU2FmYXJpLzUzNy4zNicKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QocmVxKTsKICAgICAgICB9LAogICAgICAgIFVwZGF0ZVVybCh1cmwsIG5hbWUpIHsKICAgICAgICAgICAgbGV0IHMgPSBFeHRlbnNpb25fMTEuQ29udGFpbnModXJsLCAnPycpID8gJyYnIDogJz8nOwogICAgICAgICAgICBsZXQgX3VybCA9IGAke3VybH0ke3N9YXR0bmFtZT0ke2VuY29kZVVSSUNvbXBvbmVudChuYW1lKX0ke0V4dGVuc2lvbl8xMS5HZXRFeHRlbnNpb25Gcm9tVXJsKHVybCl9YDsKICAgICAgICAgICAgcnVsZS5kbExpbmsKICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgcnVsZS5iZC5HZW5lcmF0ZVVyaSh1cmwsIG5hbWUgKyBFeHRlbnNpb25fMTEuR2V0RXh0ZW5zaW9uRnJvbVVybCh1cmwpKSkKICAgICAgICAgICAgICAgIC5hdHRyKCd0aXRsZScsIGDkuIvovb06ICR7bmFtZX1gKTsKICAgICAgICAgICAgLy8gaW5mbyhg5o2V5o2J5Yiw5LiL6L295Zyw5Z2AOiAke3VybH1gKTsKICAgICAgICB9CiAgICB9OwogICAgZXhwb3J0cy5SdWxlcyA9IFtydWxlXTsKfSk7CmRlZmluZSgic2l0ZS9tdXNpYy5rdWdvdSIsIFsicmVxdWlyZSIsICJleHBvcnRzIiwgImhlbHBlci9Mb2dnZXIiLCAiaGVscGVyL0Rvd25sb2FkZXIiLCAiaGVscGVyL1NjcmlwdENvbmZpZyIsICJoZWxwZXIvRXh0ZW5zaW9uIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBMb2dnZXJfOCwgRG93bmxvYWRlcl84LCBTY3JpcHRDb25maWdfNCwgRXh0ZW5zaW9uXzEyKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwogICAgY29uc3QgS3Vnb3VEb3dubG9hZEZyb250ID0gJ2h0dHBzOi8vaml4dW5tb2UuZ2l0aHViLmlvL2N1d2NsNGMva3Vnb3UtZGwnOwogICAgdmFyIGFwcCA9IG51bGw7CiAgICB2YXIgcnVsZSA9IHsKICAgICAgICBpZDogJ211c2ljLmt1Z291JywKICAgICAgICBzc2w6IGZhbHNlLAogICAgICAgIG5hbWU6ICfphbfni5fpn7PkuZAnLAogICAgICAgIGhvc3Q6ICd3ZWIua3Vnb3UuY29tJywKICAgICAgICBpbmNsdWRlU3ViSG9zdDogZmFsc2UsCiAgICAgICAgc3ViTW9kdWxlOiBmYWxzZSwKICAgICAgICBoaWRlOiAnI2FkdiwgLmp4LWhpZGUnLAogICAgICAgIGNzczogYAouZGlhbG9nLXNoYWRvdyB7CglkaXNwbGF5OiBmbGV4OwoJanVzdGlmeS1jb250ZW50OiBjZW50ZXI7CglhbGlnbi1pdGVtczogY2VudGVyOwoJcG9zaXRpb246IGZpeGVkOwoJbGVmdDogMDsKCXRvcDogMDsKCWhlaWdodDogMTAwJTsKCXdpZHRoOiAxMDAlOwoJYmFja2dyb3VuZDogcmdiYSgwLDAsMCwuMyk7Cgl6LWluZGV4OiAxMDA7Cn0KCi5kaWFsb2ctY29udGFpbmVyIHsKCW1pbi13aWR0aDogY2FsYyg3NjhweCArIDJlbSk7CgltaW4taGVpZ2h0OiAyMGVtOwoJcGFkZGluZzogMWVtOwoJYmFja2dyb3VuZDogI2ZmZjsKCWJveC1zaGFkb3c6IDJweCAycHggMnB4ICM2NjY7Cglib3JkZXI6IDFweCBzb2xpZCByZ2JhKDYsNiw2LC4zKTsKCXBvc2l0aW9uOiByZWxhdGl2ZTsKCXBhZGRpbmctdG9wOiAyLjVlbTsKfQoKLmRpYWxvZy10aXRsZS1iYXIgewoJcG9zaXRpb246IGFic29sdXRlOwoJbGVmdDogMDsKCXRvcDogMDsKCXBhZGRpbmc6IC40ZW07Cgl3aWR0aDogY2FsYygxMDAlIC0gLjhlbSk7Cglib3JkZXItYm90dG9tOiAxcHggc29saWQgd2hpdGU7CgliYWNrZ3JvdW5kOiAjMDBBN0YyOwoJY29sb3I6IHdoaXRlOwp9CgouZGlhbG9nLXRpdGxlLWJ0bnMgewoJZmxvYXQ6IHJpZ2h0Owp9CgouZGlhbG9nLXRpdGxlLWJ0bnMgPiAuZGlhbG9nLWJhci1idG4gewoJd2lkdGg6IDFlbTsKCWhlaWdodDogMWVtOwoJYm9yZGVyOiAxcHggc29saWQgd2hpdGU7Cgl0ZXh0LWFsaWduOiBjZW50ZXI7CglsaW5lLWhlaWdodDogMS4yOwoJcGFkZGluZzogMCAuNWVtOwoJbWFyZ2luLWxlZnQ6IC41ZW07CgljdXJzb3I6IHBvaW50ZXI7Cn0KCi5kaWFsb2ctY29udGVudCBpZnJhbWUgewoJaGVpZ2h0OiAzMGVtOwoJd2lkdGg6IDEwMCU7Cn0KYCwKICAgICAgICBiZDogbnVsbCwKICAgICAgICBvblN0YXJ0KCkgewogICAgICAgICAgICBydWxlLmJkID0gbmV3IERvd25sb2FkZXJfOC5Eb3dubG9hZGVyKCk7CiAgICAgICAgfSwKICAgICAgICBvbkJvZHkoKSB7CiAgICAgICAgICAgIC8vIOeBq+eLkOeLuOacieWFvOWuuemXrumimCwg5b6F5L+uCiAgICAgICAgICAgIGlmICghRXh0ZW5zaW9uXzEyLkNvbnRhaW5zKG5hdmlnYXRvci51c2VyQWdlbnQsICdGaXJlZm94JykpCiAgICAgICAgICAgICAgICBydWxlLkJ1aWxkRGlhbG9nKCk7CiAgICAgICAgfSwKICAgICAgICBCdWlsZERpYWxvZygpIHsKICAgICAgICAgICAgbGV0IGRvd25sb2FkZXIgPSAkKGA8ZGl2IGlkPSJqaXh1bi1kbCI+Cgk8ZGl2IGNsYXNzPSJkaWFsb2ctc2hhZG93IiB2LWJpbmQ6Y2xhc3M9InsgJ2p4LWhpZGUnOiBoaWRlV2luZG93IH0iPgoJCTxkaXYgY2xhc3M9ImRpYWxvZy1jb250YWluZXIiPgoJCQk8ZGl2IGNsYXNzPSJkaWFsb2ctdGl0bGUtYmFyIj4KCQkJCeS4i+i9veeql+WPowoKCQkJCTxkaXYgY2xhc3M9ImRpYWxvZy10aXRsZS1idG5zIj4KCQkJCQk8c3BhbiBjbGFzcz0iZGlhbG9nLWJhci1idG4iIHYtb246Y2xpY2s9InRvZ2dsZUZyYW1lIj7nrqE8L3NwYW4+CgkJCQkJPHNwYW4gY2xhc3M9ImRpYWxvZy1iYXItYnRuIiB2LW9uOmNsaWNrPSJoaWRlIj7lhbM8L3NwYW4+CgkJCQk8L2Rpdj4KCQkJPC9kaXY+CgoJCQk8ZGl2IGNsYXNzPSJkaWFsb2ctY29udGVudCI+CgkJCQk8ZGl2IHYtYmluZDpjbGFzcz0ieyAnangtaGlkZSc6IGhpZGVNc2cgfSI+e3sgbXNnIH19PC9kaXY+CgkJCQk8aWZyYW1lIHYtZWw6ZnJhbWUtZGwtZGlhbG9nIHYtYmluZDpjbGFzcz0ieyAnangtaGlkZSc6IG1vZGUgIT0gMSB9IiBzcmM9IiR7S3Vnb3VEb3dubG9hZEZyb250fSI+PC9pZnJhbWU+CgkJCQk8aWZyYW1lIHYtZWw6ZnJhbWUtZGwtbWFuYWdlciB2LWJpbmQ6Y2xhc3M9InsgJ2p4LWhpZGUnOiBtb2RlICE9IDIgfSIgIHNyYz0iJHtLdWdvdURvd25sb2FkRnJvbnR9L2RsLmh0bWwiPjwvaWZyYW1lPgoJCQk8L2Rpdj4KCQk8L2Rpdj4KCTwvZGl2Pgo8L2Rpdj5gKTsKICAgICAgICAgICAgZG93bmxvYWRlci5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KTsKICAgICAgICAgICAgLy8gUmVxdWlyZSBWdWVKUyBmcm9tIHJlc291cmNlLgogICAgICAgICAgICBsZXQgdnVlTG9hZGVyID0gbmV3IEZ1bmN0aW9uKCd3aW5kb3cnLCBHTV9nZXRSZXNvdXJjZVRleHQoJ1Z1ZUpzJykgKyAnXG47IHJldHVybiB3aW5kb3cuVnVlOycpOwogICAgICAgICAgICBsZXQgVnVlID0gdnVlTG9hZGVyKHVuc2FmZVdpbmRvdyk7CiAgICAgICAgICAgIGFwcCA9IG5ldyBWdWUoewogICAgICAgICAgICAgICAgZWw6IGRvd25sb2FkZXJbMF0sCiAgICAgICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICAgICAgbXNnOiAn5q2j5Zyo6I635Y+W55u45YWz5pWw5o2uLi4uJywKICAgICAgICAgICAgICAgICAgICBoaWRlTXNnOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBtb2RlOiAwLAogICAgICAgICAgICAgICAgICAgIGhpZGVXaW5kb3c6IGZhbHNlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbWV0aG9kczogewogICAgICAgICAgICAgICAgICAgIGluaXQoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5oaWRlV2luZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHRvZ2dsZUZyYW1lKCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXBwLm1vZGUgPT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwLm1vZGUgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwLm1vZGUgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBoaWRlKCkgewogICAgICAgICAgICAgICAgICAgICAgICBhcHAuaGlkZVdpbmRvdyA9ICFhcHAuaGlkZVdpbmRvdzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhcHAuaW5pdCgpOwogICAgICAgICAgICB2YXIgYWN0aW9uRGxEaWFsb2cgPSBbJ3NldCcsICdjbGVhciddOwogICAgICAgICAgICB2YXIgYWN0aW9uRGxNYW5hZ2VyID0gWydhZGQnXTsKICAgICAgICAgICAgZnVuY3Rpb24gcG9zdChhY3Rpb24sIGRhdGEpIHsKICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IGFjdGlvbkRsRGlhbG9nLmluZGV4T2YoYWN0aW9uKSAhPSAtMSA/IGFwcC4kZWxzLmZyYW1lRGxEaWFsb2cgOiBhcHAuJGVscy5mcmFtZURsTWFuYWdlcjsKICAgICAgICAgICAgICAgIHZhciBtc2cgPSB7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sCiAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGZyYW1lLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkobXNnKSwgJyonKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyDojrflj5bpn7PotKjkv6Hmga8KICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRG93bmxvYWQoc29uZ3MpIHsKICAgICAgICAgICAgICAgIHBvc3QoJ2NsZWFyJyk7CiAgICAgICAgICAgICAgICBhcHAuaGlkZU1zZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgYXBwLm1vZGUgPSAwOyAvLyBoaWRlVGhlbQogICAgICAgICAgICAgICAgYXBwLmhpZGVXaW5kb3cgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHZhciByZXNvdXJjZSA9IEpTT04ucGFyc2Uoc29uZ3MpLm1hcCgoc29uZykgPT4gKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYXVkaW8nLAogICAgICAgICAgICAgICAgICAgIGlkOiAwLAogICAgICAgICAgICAgICAgICAgIGhhc2g6IHNvbmcuSGFzaAogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgdmFyIHBheWxvYWQgPSB7CiAgICAgICAgICAgICAgICAgICAgInVzZXJpZCI6IDAsCiAgICAgICAgICAgICAgICAgICAgInRva2VuIjogIiIsCiAgICAgICAgICAgICAgICAgICAgInZpcCI6IDEsCiAgICAgICAgICAgICAgICAgICAgImJlaGF2aW9yIjogImRvd25sb2FkIiwKICAgICAgICAgICAgICAgICAgICAicmVsYXRlIjogMSwKICAgICAgICAgICAgICAgICAgICAicmVzb3VyY2UiOiByZXNvdXJjZSwKICAgICAgICAgICAgICAgICAgICAiYXBwaWQiOiAxMDAxLAogICAgICAgICAgICAgICAgICAgICJjbGllbnR2ZXIiOiAiODAzMSIsCiAgICAgICAgICAgICAgICAgICAgInNvdXJjZSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgIm1vZHVsZSI6ICIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgICAgICJpZCI6IDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QoewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgICAgIHVybDogImh0dHA6Ly9tZWRpYS5zdG9yZS5rdWdvdS5jb20vdjEvZ2V0X3Jlc19wcml2aWxlZ2UiLAogICAgICAgICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbmxvYWQ6IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgICBwb3N0KCdzZXQnLCBKU09OLnBhcnNlKHJlc3BvbnNlLnJlc3BvbnNlVGV4dCkpOwogICAgICAgICAgICAgICAgICAgICAgICBhcHAuaGlkZU1zZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5tb2RlID0gMTsgLy8g5bGV546w5LiL6L29566h55CG55WM6Z2iCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbmVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfmjqXlj6Pojrflj5blpLHotKUsIOivt+eojeWQjumHjeivlSEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgYXBwLmhpZGVXaW5kb3cgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBsb29wZXIgPSBuZXcgSW50ZXJ2YWxMb29wKFtdLCBwcm9jX2hhc2gsIDUwMCk7CiAgICAgICAgICAgIGxvb3Blci5sb29wKCk7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgb25NZXNzYWdlLCBmYWxzZSk7CiAgICAgICAgICAgIGZ1bmN0aW9uIG9uTWVzc2FnZShlKSB7CiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoZS5kYXRhKTsKICAgICAgICAgICAgICAgIGlmIChkYXRhLmFjdGlvbiA9PSAnY2FuY2VsJykgewogICAgICAgICAgICAgICAgICAgIGFwcC5oaWRlV2luZG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEuYWN0aW9uID09ICdkb3dubG9hZCcpIHsKICAgICAgICAgICAgICAgICAgICBhcHAubW9kZSA9IDI7CiAgICAgICAgICAgICAgICAgICAgbG9vcGVyLmFkZC5hcHBseShsb29wZXIsIGRhdGEuZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBMb2dnZXJfOC5lcnJvcignVW5kZWZpbmVkIGFjdGlvbjogJyArIGRhdGEuYWN0aW9uKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVfZGwoc29uZykgewogICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBzb25nLmZpbGVOYW1lICsgJy4nICsgc29uZy5leHROYW1lOwogICAgICAgICAgICAgICAgdmFyIHVybCA9IHNvbmcudXJsOwogICAgICAgICAgICAgICAgcG9zdCgnYWRkJywgc29uZyk7CiAgICAgICAgICAgICAgICBpZiAoU2NyaXB0Q29uZmlnXzQuQ29uZmlnLmRVcmlUeXBlID09IFNjcmlwdENvbmZpZ180LlVyaVR5cGUuQXJpYSkgewogICAgICAgICAgICAgICAgICAgIHJ1bGUuYmQuQWRkRG93bmxvYWQodXJsLCBmaWxlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBwcm9jX2hhc2gobmV4dCwgaGFzaCkgewogICAgICAgICAgICAgICAgaGFzaCA9IGhhc2gudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgIHZhciBrZXkgPSBDcnlwdG9KUy5NRDUoaGFzaCArICdrZ2Nsb3VkJykudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLAogICAgICAgICAgICAgICAgICAgIHVybDogJ2h0dHA6Ly90cmFja2VyY2RuLmt1Z291LmNvbS9pLz9jbWQ9NCZoYXNoPScgKyBoYXNoICsgJyZrZXk9JyArIGtleSArICcmcGlkPTEmZm9yY2VEb3duPTAmdmlwPTEnLAogICAgICAgICAgICAgICAgICAgIG9ubG9hZDogZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzb25nID0gSlNPTi5wYXJzZShyZXNwb25zZS5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVfZGwoc29uZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9uZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2VyXzguZXJyb3IoJ0Vycm9yIHdoaWxlIGZldGNoaW5nIGRhdGEgZm9yICVzJywgaGFzaCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvKiDlr7zlh7rlh73mlbAgKi8KICAgICAgICAgICAgZXhwb3J0RnVuY3Rpb24oaGFuZGxlRG93bmxvYWQsIHVuc2FmZVdpbmRvdywgewogICAgICAgICAgICAgICAgZGVmaW5lQXM6ICJkbF9qaXh1biIKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHVuc2FmZUV4ZWMoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgd2luZG93LmRvd25Mb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kbF9qaXh1bi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9OwogICAgZXhwb3J0cy5SdWxlcyA9IFtydWxlXTsKfSk7CmRlZmluZSgiUnVsZXMiLCBbInJlcXVpcmUiLCAiZXhwb3J0cyIsICJTaXRlUnVsZSIsICJzaXRlL0FBLkNvbmZpZyIsICJzaXRlL2RsLjEyMzU2NCIsICJzaXRlL2RsLjV4ZmlsZSIsICJzaXRlL2RsLmJhaWR1IiwgInNpdGUvZGwuaG93ZmlsZSIsICJzaXRlL2RsLmprcGFuIiwgInNpdGUvZGwubmFtaXBhbi5jYyIsICJzaXRlL2RsLnBocGRpc2siLCAic2l0ZS9kbC54dWl0ZSIsICJzaXRlL2RsLnlpbXVoZSIsICJzaXRlL2ZtLmRvdWJhbiIsICJzaXRlL2ZtLm1vZSIsICJzaXRlL211c2ljLjE2MyIsICJzaXRlL211c2ljLjF0aW5nIiwgInNpdGUvbXVzaWMuNTYiLCAic2l0ZS9tdXNpYy5lY2hvIiwgInNpdGUvbXVzaWMua3Vnb3UiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFNpdGVSdWxlXzEsIGEsIGIsIGMsIGQsIGUsIGYsIGcsIGgsIGksIGosIGssIGwsIG0sIG4sIG8sIHAsIHEpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CiAgICBhLlJ1bGVzLmZvckVhY2goU2l0ZVJ1bGVfMS5BZGQpOwogICAgYi5SdWxlcy5mb3JFYWNoKFNpdGVSdWxlXzEuQWRkKTsKICAgIGMuUnVsZXMuZm9yRWFjaChTaXRlUnVsZV8xLkFkZCk7CiAgICBkLlJ1bGVzLmZvckVhY2goU2l0ZVJ1bGVfMS5BZGQpOwogICAgZS5SdWxlcy5mb3JFYWNoKFNpdGVSdWxlXzEuQWRkKTsKICAgIGYuUnVsZXMuZm9yRWFjaChTaXRlUnVsZV8xLkFkZCk7CiAgICBnLlJ1bGVzLmZvckVhY2goU2l0ZVJ1bGVfMS5BZGQpOwogICAgaC5SdWxlcy5mb3JFYWNoKFNpdGVSdWxlXzEuQWRkKTsKICAgIGkuUnVsZXMuZm9yRWFjaChTaXRlUnVsZV8xLkFkZCk7CiAgICBqLlJ1bGVzLmZvckVhY2goU2l0ZVJ1bGVfMS5BZGQpOwogICAgay5SdWxlcy5mb3JFYWNoKFNpdGVSdWxlXzEuQWRkKTsKICAgIGwuUnVsZXMuZm9yRWFjaChTaXRlUnVsZV8xLkFkZCk7CiAgICBtLlJ1bGVzLmZvckVhY2goU2l0ZVJ1bGVfMS5BZGQpOwogICAgbi5SdWxlcy5mb3JFYWNoKFNpdGVSdWxlXzEuQWRkKTsKICAgIG8uUnVsZXMuZm9yRWFjaChTaXRlUnVsZV8xLkFkZCk7CiAgICBwLlJ1bGVzLmZvckVhY2goU2l0ZVJ1bGVfMS5BZGQpOwogICAgcS5SdWxlcy5mb3JFYWNoKFNpdGVSdWxlXzEuQWRkKTsKfSk7CmRlZmluZSgiRW50cnlQb2ludCIsIFsicmVxdWlyZSIsICJleHBvcnRzIiwgImhlbHBlci9TY3JpcHQiLCAiaGVscGVyL0NvbnN0YW50cyIsICJoZWxwZXIvU2NyaXB0Q29uZmlnIiwgImhlbHBlci9RdWVyeVN0cmluZyIsICJoZWxwZXIvTG9nZ2VyIiwgIlNpdGVSdWxlIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBTY3JpcHRfOSwgQ29uc3RhbnRzXzQsIFNjcmlwdENvbmZpZ181LCBRdWVyeVN0cmluZ18xLCBMb2dnZXJfOSwgU2l0ZVJ1bGVfMikgewogICAgInVzZSBzdHJpY3QiOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKICAgIHZhciAkX0dFVCA9IFF1ZXJ5U3RyaW5nXzEuUGFyc2UoQ29uc3RhbnRzXzQuY3VycmVudFVybCk7CiAgICBpZiAoU2NyaXB0Q29uZmlnXzUuQ29uZmlnLmJVc2VDdXN0b21SdWxlcykgewogICAgICAgIHZhciBjdXN0b21SdWxlcyA9IFtdOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGN1c3RvbVJ1bGVzID0gZXZhbChgWyR7U2NyaXB0Q29uZmlnXzUuQ29uZmlnLnNDdXN0b21SdWxlfV1gKTsKICAgICAgICAgICAgY3VzdG9tUnVsZXMuZm9yRWFjaCgocnVsZSkgPT4gewogICAgICAgICAgICAgICAgU2l0ZVJ1bGVfMi5TaXRlcy5wdXNoKHJ1bGUpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGV4KSB7CiAgICAgICAgICAgIExvZ2dlcl85LmVycm9yKGDop6PmnpDoh6rlrprkuYnop4TliJnlj5HnlJ/plJnor686ICR7ZXgubWVzc2FnZX1gKTsKICAgICAgICB9CiAgICB9CiAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kKGDphY3nva4gJHtTY3JpcHRfOS5TY3JpcHQuTmFtZX1gLCAoKSA9PiB7CiAgICAgICAgR01fb3BlbkluVGFiKFNjcmlwdF85LlNjcmlwdC5Db25maWcsIGZhbHNlKTsKICAgIH0pOwogICAgU2l0ZVJ1bGVfMi5GaXJlRXZlbnQoJ3N0YXJ0Jyk7CiAgICAkKCgpID0+IHsKICAgICAgICBTaXRlUnVsZV8yLkZpcmVFdmVudCgnYm9keScpOwogICAgfSk7Cn0pOwo="},{"name":"Download YouTube Videos as MP4","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":["http://www.youtube.com/embed/*","https://www.youtube.com/embed/*"],"orig_includes":["http://www.youtube.com/*","https://www.youtube.com/*"],"orig_matches":["http://www.youtube.com/*","https://www.youtube.com/*","http://s.ytimg.com/yts/jsbin/html5player*","https://s.ytimg.com/yts/jsbin/html5player*","http://manifest.googlevideo.com/*","https://manifest.googlevideo.com/*","http://*.googlevideo.com/videoplayback*","https://*.googlevideo.com/videoplayback*","http://*.youtube.com/videoplayback*","https://*.youtube.com/videoplayback*"],"orig_noframes":null,"orig_run_at":"document-end","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{"download-youtube-dash-enabled":"s0","download-youtube-script-url":"shttps://s.ytimg.com/yts/jsbin/player-zh_CN-vflvVmQ0z/base.js","download-youtube-signature-code":"s-3,13,41,-1,51,0,53,0,57"},"ts":1487594258365},"enabled":false,"position":5,"file_url":"https://greasyfork.org/scripts/1317-download-youtube-videos-as-mp4/code/Download%20YouTube%20Videos%20as%20MP4.user.js","uuid":"a850a58d-2f71-4114-b763-127ec25c90be","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgRG93bmxvYWQgWW91VHViZSBWaWRlb3MgYXMgTVA0Ci8vIEBkZXNjcmlwdGlvbiBBZGRzIGEgYnV0dG9uIHRoYXQgbGV0cyB5b3UgZG93bmxvYWQgWW91VHViZSB2aWRlb3MuCi8vIEBob21lcGFnZVVSTCBodHRwczovL2dpdGh1Yi5jb20vZ2FudHQvZG93bmxvYWR5b3V0dWJlCi8vIEBhdXRob3IgR2FudHQKLy8gQHZlcnNpb24gMS44LjgKLy8gQGRhdGUgMjAxNi0wOS0wMgovLyBAbmFtZXNwYWNlIGh0dHA6Ly9nb29nbGVzeXN0ZW0uYmxvZ3Nwb3QuY29tCi8vIEBpbmNsdWRlIGh0dHA6Ly93d3cueW91dHViZS5jb20vKgovLyBAaW5jbHVkZSBodHRwczovL3d3dy55b3V0dWJlLmNvbS8qCi8vIEBleGNsdWRlIGh0dHA6Ly93d3cueW91dHViZS5jb20vZW1iZWQvKgovLyBAZXhjbHVkZSBodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8qCi8vIEBtYXRjaCBodHRwOi8vd3d3LnlvdXR1YmUuY29tLyoKLy8gQG1hdGNoIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tLyoKLy8gQG1hdGNoIGh0dHA6Ly9zLnl0aW1nLmNvbS95dHMvanNiaW4vaHRtbDVwbGF5ZXIqCi8vIEBtYXRjaCBodHRwczovL3MueXRpbWcuY29tL3l0cy9qc2Jpbi9odG1sNXBsYXllcioKLy8gQG1hdGNoIGh0dHA6Ly9tYW5pZmVzdC5nb29nbGV2aWRlby5jb20vKgovLyBAbWF0Y2ggaHR0cHM6Ly9tYW5pZmVzdC5nb29nbGV2aWRlby5jb20vKgovLyBAbWF0Y2ggaHR0cDovLyouZ29vZ2xldmlkZW8uY29tL3ZpZGVvcGxheWJhY2sqCi8vIEBtYXRjaCBodHRwczovLyouZ29vZ2xldmlkZW8uY29tL3ZpZGVvcGxheWJhY2sqCi8vIEBtYXRjaCBodHRwOi8vKi55b3V0dWJlLmNvbS92aWRlb3BsYXliYWNrKgovLyBAbWF0Y2ggaHR0cHM6Ly8qLnlvdXR1YmUuY29tL3ZpZGVvcGxheWJhY2sqCi8vIEBjb25uZWN0IGdvb2dsZXZpZGVvLmNvbQovLyBAY29ubmVjdCB5dGltZy5jb20KLy8gQGdyYW50IEdNX3htbGh0dHBSZXF1ZXN0Ci8vIEBncmFudCBHTV9nZXRWYWx1ZQovLyBAZ3JhbnQgR01fc2V0VmFsdWUKLy8gQHJ1bi1hdCBkb2N1bWVudC1lbmQKLy8gQGxpY2Vuc2UgTUlUIExpY2Vuc2UKLy8gQGljb24gZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFFQUFBQUJBQ0FNQUFBQ2R0NEhzQUFBQUIzUkpUVVVIMndNT0NnSW9HVVlFQVFBQUFBbHdTRmx6QUFBTEVnQUFDeElCMHQxKy9BQUFBQVJuUVUxQkFBQ3hqd3Y4WVFVQUFBR1NVRXhVUmZpL0pPL3Y3OTdlM3NiR3hxMnRyYVdscFpTVWxKeWNuTmJXMW95RWhJUmFXb3c1T1pRaElad1lHS1VRRUtVSUNLMElDSlF4TVl4S1NveHpjNHg3ZTRSQ1FwUVlHS1VBQUswQUFMVUFBTDBBQUswUUVJeHJhNVFwS2EwWUdJeFNVc1lBQUtVaElaUjdlODdPenIwSUNKUlNVcjI5dll4alk2VTVPYVVwS2EwaEliMjF0WndBQUxVSUNPL096dS9HeHFVeE1aU0VoTFVZR08vVzFyMFlHS1ZDUXBRUUVMMHBLZmZlM3ZmVzFweHJhNVE1T2NaQ1F2Zm41ODVDUXIydHJaeDdlOFpTVXM1U1VxMDVPYzVqWTlaalk4NEFBS1dNak01emM5NTdlNjBwS2RhTWpPZWxwYldjbkxXVWxMVkNRc1lZR01ZSUNOYk96cFFJQ01ZaEliVjdlNXhhV3Q2Y25QZnY3OWJHeHQ2bHBlKzl2YzVLU3M2bHBiMHhNYzZFaE02OXZiVXhNYlVoSWIxYVdzNjF0Y1phV3VlY25NWXhNYjFLU3Naalk5NlVsTmExdGQ3VzFyMTdlOWE5dlp3UUVONnRyYjFqWThZUUVOWnJhK2ZPenIxemM4NWFXdWZlM3Q2TWpNWTVPZFphV3Q2MXRkWjdlKy9uNStlOXZjNk1qTVpyYSsvZTN1ZTF0ZGFscGQ3R3hyVXBLYWxMNGFBQUFBQUJkRkpPVXdCQTV0aG1BQUFDeGtsRVFWUjQydVhYLzEvU1FCZ0g4TnVBb0VRMmlqZ2JCaXZKTHpuQkFpVVVLaXlKU2dPVkFrMHRLWkt3NzVtUlJ0Lzd2NE1CWThlempXMzlWczh2OHJxSHovdTFqYnZiaWRDL1hMOEttY3BPcVZUNm5Talhqb29HdzhXZkZkK1FXR2ZFNG9MYnRicisrUGRNT3kwQkRZTGpFai8weGV2ZldJeVZBSTdiL2FJai85V0hzUnJBOFlmOWJxU2V4VmdENExpYzlrV0UvTGdQd1BHZk5mSkhETzRQOEl1cStTMk05UUQ4b1VwK254RUFjRkN0ZmdJQS8xNHgvOUVsQUtEUWJOUUF3TjlWQWlZRUFCeTBPZ3NBV0FuQi9BY0JBdFZXYXdrQWZKNENEMEJRQURaYXZZY1FnSTloM0NDUWpwRDVQY0Vnd0crU3dMUmhJTDB2ejc4U2pBUEVVM2hySE9EZnlYNEk2clVKSVAwRzNvRXhvTndGWHBvQitId1htREVGcEY5SXdLQTVZSytUcDlmTUFkVU9zQzZZQTU1M2dLY21nZFRmQWhWMW9NUXFBRG5kUURtSjBBWkxBc0ZuQ0lWM1ZZREhKTEFqRGtaS2NpQWFGei9sQ2VCSkIxZ2xnWEJyTkxuZEJXTEo5dVpHQUkra2VUQkxBTkw4U25XQXpXUm5pQUMycEcrNmxRRjBoZmpUcUNJQnJFdmpEd2lnZ0ZTTHVJVW9MWTB2RXdBYlVjc25jL0xsbk8wMkhHdkV6K2hYRWVKNVlqKzRMMnZOa3hPSkRTbmxRemxpSXEyc3lucjNlbWJpVUJqbXcwRnlVODNLWDA0T2IrOWFBSy9QcGQ1ZGVabG96NEhGbENIenQzc1gweDJhNkxjdlFiNGFiOHI3aStEVmRxdm5DcS9ENVp6cWRoZkFjcjVCOXdEMFBOd1BFdTBabkx3SzlvUGdOZkNRSjJmaGhoSVRKM0U4QmplVU9YQStRTlFsQmg1eExqZW1WQ2dLanpnek5JSkZqV0Y0eUpvS2hhZmdJV3Q2VkhHbWpnUjBIdk11VGlwUGRXUUo2QUltYkJSU0U4YVkvc0M0ZXI1eEZ4NXZIeUI0WVJScEZXVWYwQUw0YytkSGtIWlJGbzlURGVCOUFhM0xsd2pyOEZsRndCK3dPL3JIbTBWYlBhZTltUGluaS9PNWgvWEd4YXR3Mkk2ZkdIQU91aGlHWlZ4Tzk4bFRkZ3V0UDk0eWFJdlZkcXhaZHB2RllUVDlYOVVmcVFRbFRYbG04d2tBQUFBQVNVVk9SSzVDWUlJPQovLyA9PS9Vc2VyU2NyaXB0PT0KCgooZnVuY3Rpb24gKCkgewogIHZhciBGT1JNQVRfTEFCRUw9eycxOCc6J01QNCAzNjBwJywnMjInOidNUDQgNzIwcCcsJzQzJzonV2ViTSAzNjBwJywnNDQnOidXZWJNIDQ4MHAnLCc0NSc6J1dlYk0gNzIwcCcsJzQ2JzonV2ViTSAxMDgwcCcsJzEzNSc6J01QNCA0ODBwIC0gbm8gYXVkaW8nLCcxMzcnOidNUDQgMTA4MHAgLSBubyBhdWRpbycsJzEzOCc6J01QNCAyMTYwcCAtIG5vIGF1ZGlvJywnMTQwJzonTTRBIDEyOGticHMgLSBhdWRpbycsJzI2NCc6J01QNCAxNDQwcCAtIG5vIGF1ZGlvJywnMjY2JzonTVA0IDIxNjBwIC0gbm8gYXVkaW8nLCcyOTgnOidNUDQgNzIwcDYwIC0gbm8gYXVkaW8nLCcyOTknOidNUDQgMTA4MHA2MCAtIG5vIGF1ZGlvJ307CiAgdmFyIEZPUk1BVF9UWVBFPXsnMTgnOidtcDQnLCcyMic6J21wNCcsJzQzJzond2VibScsJzQ0Jzond2VibScsJzQ1Jzond2VibScsJzQ2Jzond2VibScsJzEzNSc6J21wNCcsJzEzNyc6J21wNCcsJzEzOCc6J21wNCcsJzE0MCc6J200YScsJzI2NCc6J21wNCcsJzI2Nic6J21wNCcsJzI5OCc6J21wNCcsJzI5OSc6J21wNCd9OwogIHZhciBGT1JNQVRfT1JERVI9WycxOCcsJzQzJywnMTM1JywnNDQnLCcyMicsJzI5OCcsJzQ1JywnMTM3JywnMjk5JywnNDYnLCcyNjQnLCcxMzgnLCcyNjYnLCcxNDAnXTsKICB2YXIgRk9STUFUX1JVTEU9eydtcDQnOidhbGwnLCd3ZWJtJzonbm9uZScsJ200YSc6J2FsbCd9OwogIC8vIGFsbD1kaXNwbGF5IGFsbCB2ZXJzaW9ucywgbWF4PW9ubHkgaGlnaGVzdCBxdWFsaXR5IHZlcnNpb24sIG5vbmU9bm8gdmVyc2lvbiAgCiAgLy8gdGhlIGRlZmF1bHQgc2V0dGluZ3Mgc2hvdyBhbGwgTVA0IHZpZGVvcwogIHZhciBTSE9XX0RBU0hfRk9STUFUUz1mYWxzZTsKICB2YXIgQlVUVE9OX1RFWFQ9eydhcic6J9iq2YbYstmK2YQnLCdjcyc6J1N0w6Fobm91dCcsJ2RlJzonSGVydW50ZXJsYWRlbicsJ2VuJzonRG93bmxvYWQnLCdlcyc6J0Rlc2NhcmdhcicsJ2ZyJzonVMOpbMOpY2hhcmdlcicsJ2hpJzon4KSh4KS+4KSJ4KSo4KSy4KWL4KShJywnaHUnOidMZXTDtmx0w6lzJywnaWQnOidVbmR1aCcsJ2l0JzonU2NhcmljYScsJ2phJzon44OA44Km44Oz44Ot44O844OJJywna28nOifrgrTroKTrsJvquLAnLCdwbCc6J1BvYmllcnonLCdwdCc6J0JhaXhhcicsJ3JvJzonRGVzY8SDcmNhyJtpJywncnUnOifQodC60LDRh9Cw0YLRjCcsJ3RyJzonxLBuZGlyJywnemgnOifkuIvovb0nLCd6aC1UVyc6J+S4i+i8iSd9OwogIHZhciBCVVRUT05fVE9PTFRJUD17J2FyJzon2KrZhtiy2YrZhCDZh9iw2Kcg2KfZhNmB2YrYr9mK2YgnLCdjcyc6J1N0w6Fobm91dCB0b3RvIHZpZGVvJywnZGUnOidEaWVzZXMgVmlkZW8gaGVydW50ZXJsYWRlbicsJ2VuJzonRG93bmxvYWQgdGhpcyB2aWRlbycsJ2VzJzonRGVzY2FyZ2FyIGVzdGUgdsOtZGVvJywnZnInOidUw6lsw6ljaGFyZ2VyIGNldHRlIHZpZMOpbycsJ2hpJzon4KS14KWA4KSh4KS/4KSv4KWLIOCkoeCkvuCkieCkqOCksuCli+CkoSDgpJXgpLDgpYfgpIInLCdodSc6J1ZpZGXDsyBsZXTDtmx0w6lzZScsJ2lkJzonVW5kdWggdmlkZW8gaW5pJywnaXQnOidTY2FyaWNhIHF1ZXN0byB2aWRlbycsJ2phJzon44GT44Gu44OT44OH44Kq44KS44OA44Km44Oz44Ot44O844OJ44GZ44KLJywna28nOifsnbQg67mE65SU7Jik66W8IOuCtOugpOuwm+q4sCcsJ3BsJzonUG9iaWVyeiBwbGlrIHdpZGVvJywncHQnOidCYWl4YXIgZXN0ZSB2w61kZW8nLCdybyc6J0Rlc2PEg3JjYcibaSBhY2VzdCB2aWRlb2NsaXAnLCdydSc6J9Ch0LrQsNGH0LDRgtGMINGN0YLQviDQstC40LTQtdC+JywndHInOiAnQnUgdmlkZW95dSBpbmRpcicsJ3poJzon5LiL6L295q2k6KeG6aKRJywnemgtVFcnOifkuIvovInmraTlvbHniYcnfTsKICB2YXIgREVDT0RFX1JVTEU9W107CiAgdmFyIFJBTkRPTT03NDg5MjM1MTc5OyAvLyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMTIzNDU2Nzg5MCk7CiAgdmFyIENPTlRBSU5FUl9JRD0nZG93bmxvYWQteW91dHViZS12aWRlbycrUkFORE9NOwogIHZhciBMSVNUSVRFTV9JRD0nZG93bmxvYWQteW91dHViZS12aWRlby1mbXQnK1JBTkRPTTsKICB2YXIgQlVUVE9OX0lEPSdkb3dubG9hZC15b3V0dWJlLXZpZGVvLWJ1dHRvbicrUkFORE9NOwogIHZhciBERUJVR19JRD0nZG93bmxvYWQteW91dHViZS12aWRlby1kZWJ1Zy1pbmZvJzsKICB2YXIgU1RPUkFHRV9VUkw9J2Rvd25sb2FkLXlvdXR1YmUtc2NyaXB0LXVybCc7CiAgdmFyIFNUT1JBR0VfQ09ERT0nZG93bmxvYWQteW91dHViZS1zaWduYXR1cmUtY29kZSc7CiAgdmFyIFNUT1JBR0VfREFTSD0nZG93bmxvYWQteW91dHViZS1kYXNoLWVuYWJsZWQnOwogIHZhciBpc0RlY29kZVJ1bGVVcGRhdGVkPWZhbHNlOyAgCiAgICAKICBzdGFydCgpOwogICAgICAgICAgCmZ1bmN0aW9uIHN0YXJ0KCkgewogIHZhciBwYWdlY29udGFpbmVyPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlLWNvbnRhaW5lcicpOwogIGlmICghcGFnZWNvbnRhaW5lcikgcmV0dXJuOwogIGlmICgvXmh0dHBzPzpcL1wvd3d3XC55b3V0dWJlLmNvbVwvd2F0Y2hcPy8udGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZikpIHJ1bigpOyAgICAgICAKICB2YXIgaXNBamF4PS9jbGFzc1tcd1xzIictPV0rc3BmXC1saW5rLy50ZXN0KHBhZ2Vjb250YWluZXIuaW5uZXJIVE1MKTsKICB2YXIgbG9nb2NvbnRhaW5lcj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nby1jb250YWluZXInKTsgIAogIGlmIChsb2dvY29udGFpbmVyICYmICFpc0FqYXgpIHsgLy8gZml4IGZvciBibG9ja2VkIHZpZGVvcwogICAgaXNBamF4PSgnICcrbG9nb2NvbnRhaW5lci5jbGFzc05hbWUrJyAnKS5pbmRleE9mKCcgc3BmLWxpbmsgJyk+PTA7CiAgfQogIHZhciBjb250ZW50PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250ZW50Jyk7CiAgaWYgKGlzQWpheCAmJiBjb250ZW50KSB7IC8vIEFqYXggVUkKICAgICAgdmFyIG1vPXdpbmRvdy5NdXRhdGlvbk9ic2VydmVyfHx3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjsKICAgICAgaWYodHlwZW9mIG1vIT09J3VuZGVmaW5lZCcpIHsKICAgICAgICB2YXIgb2JzZXJ2ZXI9bmV3IG1vKGZ1bmN0aW9uKG11dGF0aW9ucykgewogICAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24obXV0YXRpb24pIHsKICAgICAgICAgICAgICBpZihtdXRhdGlvbi5hZGRlZE5vZGVzIT09bnVsbCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgaT0wOyBpPG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24uYWRkZWROb2Rlc1tpXS5pZD09J3dhdGNoNy1jb250YWluZXInIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXNbaV0uaWQ9PSd3YXRjaDctbWFpbi1jb250YWluZXInKSB7IC8vIG9sZCB2YWx1ZTogbW92aWVfcGxheWVyCiAgICAgICAgICAgICAgICAgICAgICBydW4oKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGNvbnRlbnQsIHtjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWV9KTsgLy8gb2xkIHZhbHVlOiBwYWdlY29udGFpbmVyCiAgICAgIH0gZWxzZSB7IC8vIE11dGF0aW9uT2JzZXJ2ZXIgZmFsbGJhY2sgZm9yIG9sZCBicm93c2VycwogICAgICAgIHBhZ2Vjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignRE9NTm9kZUluc2VydGVkJywgb25Ob2RlSW5zZXJ0ZWQsIGZhbHNlKTsKICAgICAgfQogIH0gCn0KCmZ1bmN0aW9uIG9uTm9kZUluc2VydGVkKGUpIHsgCiAgICBpZiAoZSAmJiBlLnRhcmdldCAmJiAoZS50YXJnZXQuaWQ9PSd3YXRjaDctY29udGFpbmVyJyB8fCAKICAgICAgICBlLnRhcmdldC5pZD09J3dhdGNoNy1tYWluLWNvbnRhaW5lcicpKSB7IC8vIG9sZCB2YWx1ZTogbW92aWVfcGxheWVyCiAgICAgIHJ1bigpOwogIH0KfQogIApmdW5jdGlvbiBydW4oKSB7CiAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKENPTlRBSU5FUl9JRCkpIHJldHVybjsgLy8gY2hlY2sgZG93bmxvYWQgY29udGFpbmVyCiAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwJykgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZvJykpIHJldHVybjsgLy8gRmVhdGhlciBub3Qgc3VwcG9ydGVkCgogIHZhciB2aWRlb0lELCB2aWRlb0Zvcm1hdHMsIHZpZGVvQWRhcHRGb3JtYXRzLCB2aWRlb01hbmlmZXN0VVJMLCBzY3JpcHRVUkw9bnVsbDsKICB2YXIgaXNTaWduYXR1cmVVcGRhdGluZ1N0YXJ0ZWQ9ZmFsc2U7CiAgdmFyIG9wZXJhVGFibGU9bmV3IEFycmF5KCk7CiAgdmFyIGxhbmd1YWdlPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2xhbmcnKTsKICB2YXIgdGV4dERpcmVjdGlvbj0nbGVmdCc7CiAgaWYgKGRvY3VtZW50LmJvZHkuZ2V0QXR0cmlidXRlKCdkaXInKT09J3J0bCcpIHsKICAgIHRleHREaXJlY3Rpb249J3JpZ2h0JzsKICB9CiAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YXRjaDctYWN0aW9uLWJ1dHRvbnMnKSkgeyAgLy8gb2xkIFVJCiAgICBmaXhUcmFuc2xhdGlvbnMobGFuZ3VhZ2UsIHRleHREaXJlY3Rpb24pOwogIH0KICAgICAgICAKICAvLyBvYnRhaW4gdmlkZW8gSUQsIGZvcm1hdHMgbWFwICAgCiAgCiAgdmFyIGFyZ3M9bnVsbDsKICB2YXIgdXN3PSh0eXBlb2YgdGhpcy51bnNhZmVXaW5kb3cgIT09ICd1bmRlZmluZWQnKT90aGlzLnVuc2FmZVdpbmRvdzp3aW5kb3c7IC8vIEZpcmVmb3gsIE9wZXJhPDE1CiAgaWYgKHVzdy55dHBsYXllciAmJiB1c3cueXRwbGF5ZXIuY29uZmlnICYmIHVzdy55dHBsYXllci5jb25maWcuYXJncykgewogICAgYXJncz11c3cueXRwbGF5ZXIuY29uZmlnLmFyZ3M7CiAgfQogIGlmIChhcmdzKSB7CiAgICB2aWRlb0lEPWFyZ3NbJ3ZpZGVvX2lkJ107CiAgICB2aWRlb0Zvcm1hdHM9YXJnc1sndXJsX2VuY29kZWRfZm10X3N0cmVhbV9tYXAnXTsKICAgIHZpZGVvQWRhcHRGb3JtYXRzPWFyZ3NbJ2FkYXB0aXZlX2ZtdHMnXTsKICAgIHZpZGVvTWFuaWZlc3RVUkw9YXJnc1snZGFzaG1wZCddOwogICAgZGVidWcoJ0RZVkFNIC0gSW5mbzogU3RhbmRhcmQgbW9kZS4gdmlkZW9JRCAnKyh2aWRlb0lEP3ZpZGVvSUQ6J25vbmUnKSsnOyAnKTsKICB9CiAgaWYgKHVzdy55dHBsYXllciAmJiB1c3cueXRwbGF5ZXIuY29uZmlnICYmIHVzdy55dHBsYXllci5jb25maWcuYXNzZXRzKSB7CiAgICBzY3JpcHRVUkw9dXN3Lnl0cGxheWVyLmNvbmZpZy5hc3NldHMuanM7CiAgfSAgCiAgCiAgaWYgKHZpZGVvSUQ9PW51bGwpIHsgLy8gdW5zYWZlV2luZG93IHdvcmthcm91bmQgKENocm9tZSwgT3BlcmEgMTUrKQogICAgdmFyIGJ1ZmZlcj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChERUJVR19JRCsnMicpOwogICAgaWYgKGJ1ZmZlcikgewogICAgICB3aGlsZSAoYnVmZmVyLmZpcnN0Q2hpbGQpIHsKICAgICAgICBidWZmZXIucmVtb3ZlQ2hpbGQoYnVmZmVyLmZpcnN0Q2hpbGQpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBidWZmZXI9Y3JlYXRlSGlkZGVuRWxlbSgncHJlJywgREVCVUdfSUQrJzInKTsKICAgIH0gICAgCiAgICBpbmplY3RTY3JpcHQgKCdpZih5dHBsYXllciYmeXRwbGF5ZXIuY29uZmlnJiZ5dHBsYXllci5jb25maWcuYXJncyl7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIicrREVCVUdfSUQrJzIiKS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcJyJ2aWRlb19pZCI6IlwnK3l0cGxheWVyLmNvbmZpZy5hcmdzLnZpZGVvX2lkK1wnIiwgImpzIjoiXCcreXRwbGF5ZXIuY29uZmlnLmFzc2V0cy5qcytcJyIsICJkYXNobXBkIjoiXCcreXRwbGF5ZXIuY29uZmlnLmFyZ3MuZGFzaG1wZCtcJyIsICJ1cmxfZW5jb2RlZF9mbXRfc3RyZWFtX21hcCI6IlwnK3l0cGxheWVyLmNvbmZpZy5hcmdzLnVybF9lbmNvZGVkX2ZtdF9zdHJlYW1fbWFwK1wnIiwgImFkYXB0aXZlX2ZtdHMiOiJcJyt5dHBsYXllci5jb25maWcuYXJncy5hZGFwdGl2ZV9mbXRzK1wnIlwnKSk7fScpOwogICAgdmFyIGNvZGU9YnVmZmVyLmlubmVySFRNTDsKICAgIGlmIChjb2RlKSB7CiAgICAgIHZpZGVvSUQ9ZmluZE1hdGNoKGNvZGUsIC9cInZpZGVvX2lkXCI6XHMqXCIoW15cIl0rKVwiLyk7CiAgICAgIHZpZGVvRm9ybWF0cz1maW5kTWF0Y2goY29kZSwgL1widXJsX2VuY29kZWRfZm10X3N0cmVhbV9tYXBcIjpccypcIihbXlwiXSspXCIvKTsKICAgICAgdmlkZW9Gb3JtYXRzPXZpZGVvRm9ybWF0cy5yZXBsYWNlKC8mYW1wOy9nLCdcXHUwMDI2Jyk7CiAgICAgIHZpZGVvQWRhcHRGb3JtYXRzPWZpbmRNYXRjaChjb2RlLCAvXCJhZGFwdGl2ZV9mbXRzXCI6XHMqXCIoW15cIl0rKVwiLyk7CiAgICAgIHZpZGVvQWRhcHRGb3JtYXRzPXZpZGVvQWRhcHRGb3JtYXRzLnJlcGxhY2UoLyZhbXA7L2csJ1xcdTAwMjYnKTsKICAgICAgdmlkZW9NYW5pZmVzdFVSTD1maW5kTWF0Y2goY29kZSwgL1wiZGFzaG1wZFwiOlxzKlwiKFteXCJdKylcIi8pOwogICAgICBzY3JpcHRVUkw9ZmluZE1hdGNoKGNvZGUsIC9cImpzXCI6XHMqXCIoW15cIl0rKVwiLyk7CiAgICB9CiAgICBkZWJ1ZygnRFlWQU0gLSBJbmZvOiBJbmplY3Rpb24gbW9kZS4gdmlkZW9JRCAnKyh2aWRlb0lEP3ZpZGVvSUQ6J25vbmUnKSsnOyAnKTsKICB9CiAgICAgCiAgaWYgKHZpZGVvSUQ9PW51bGwpIHsgLy8gaWYgYWxsIGVsc2UgZmFpbHMKICAgIHZhciBib2R5Q29udGVudD1kb2N1bWVudC5ib2R5LmlubmVySFRNTDsgIAogICAgaWYgKGJvZHlDb250ZW50IT1udWxsKSB7CiAgICAgIHZpZGVvSUQ9ZmluZE1hdGNoKGJvZHlDb250ZW50LCAvXCJ2aWRlb19pZFwiOlxzKlwiKFteXCJdKylcIi8pOwogICAgICB2aWRlb0Zvcm1hdHM9ZmluZE1hdGNoKGJvZHlDb250ZW50LCAvXCJ1cmxfZW5jb2RlZF9mbXRfc3RyZWFtX21hcFwiOlxzKlwiKFteXCJdKylcIi8pOwogICAgICB2aWRlb0FkYXB0Rm9ybWF0cz1maW5kTWF0Y2goYm9keUNvbnRlbnQsIC9cImFkYXB0aXZlX2ZtdHNcIjpccypcIihbXlwiXSspXCIvKTsKICAgICAgdmlkZW9NYW5pZmVzdFVSTD1maW5kTWF0Y2goYm9keUNvbnRlbnQsIC9cImRhc2htcGRcIjpccypcIihbXlwiXSspXCIvKTsKICAgICAgaWYgKHNjcmlwdFVSTD09bnVsbCkgewogICAgICAgIHNjcmlwdFVSTD1maW5kTWF0Y2goYm9keUNvbnRlbnQsIC9cImpzXCI6XHMqXCIoW15cIl0rKVwiLyk7CiAgICAgICAgaWYgKHNjcmlwdFVSTCkgewogICAgICAgICAgc2NyaXB0VVJMPXNjcmlwdFVSTC5yZXBsYWNlKC9cXC9nLCcnKTsKICAgICAgICB9CiAgICAgIH0gICAgICAKICAgIH0KICAgIGRlYnVnKCdEWVZBTSAtIEluZm86IEJydXRlIG1vZGUuIHZpZGVvSUQgJysodmlkZW9JRD92aWRlb0lEOidub25lJykrJzsgJyk7CiAgfQogIAogIGRlYnVnKCdEWVZBTSAtIEluZm86IHVybCAnK3dpbmRvdy5sb2NhdGlvbi5ocmVmKyc7IHVzZXJhZ2VudCAnK3dpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTsgIAogIAogIGlmICh2aWRlb0lEPT1udWxsIHx8IHZpZGVvRm9ybWF0cz09bnVsbCB8fCB2aWRlb0lELmxlbmd0aD09MCB8fCB2aWRlb0Zvcm1hdHMubGVuZ3RoPT0wKSB7CiAgIGRlYnVnKCdEWVZBTSAtIEVycm9yOiBObyBjb25maWcgaW5mb3JtYXRpb24gZm91bmQuIFlvdVR1YmUgbXVzdCBoYXZlIGNoYW5nZWQgdGhlIGNvZGUuJyk7CiAgIHJldHVybjsKICB9CiAgCiAgLy8gT3BlcmEgMTIgZXh0ZW5zaW9uIG1lc3NhZ2UgaGFuZGxlcgogIGlmICh0eXBlb2Ygd2luZG93Lm9wZXJhICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cub3BlcmEgJiYgdHlwZW9mIG9wZXJhLmV4dGVuc2lvbiAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgIG9wZXJhLmV4dGVuc2lvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkgewogICAgICB2YXIgaW5kZXg9ZmluZE1hdGNoKGV2ZW50LmRhdGEuYWN0aW9uLCAveGhyXC0oWzAtOV0rKVwtcmVzcG9uc2UvKTsKICAgICAgaWYgKGluZGV4ICYmIG9wZXJhVGFibGVbcGFyc2VJbnQoaW5kZXgsMTApXSkgewogICAgICAgIGluZGV4PXBhcnNlSW50KGluZGV4LDEwKTsKICAgICAgICB2YXIgdHJpZ2dlcj0ob3BlcmFUYWJsZVtpbmRleF0pWydvbmxvYWQnXTsKICAgICAgICBpZiAodHlwZW9mIHRyaWdnZXIgPT09ICdmdW5jdGlvbicgJiYgZXZlbnQuZGF0YS5yZWFkeVN0YXRlID09IDQpIHsKICAgICAgICAgIGlmICh0cmlnZ2VyKSB7CiAgICAgICAgICAgICAgdHJpZ2dlcihldmVudC5kYXRhKTsgICAgICAgICAKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgICAKICBpZiAoIWlzRGVjb2RlUnVsZVVwZGF0ZWQpIHsKICAgIERFQ09ERV9SVUxFPWdldERlY29kZVJ1bGVzKERFQ09ERV9SVUxFKTsKICAgIGlzRGVjb2RlUnVsZVVwZGF0ZWQ9dHJ1ZTsKICB9CiAgaWYgKHNjcmlwdFVSTCkgewogICAgaWYgKHNjcmlwdFVSTC5pbmRleE9mKCcvLycpPT0wKSB7CiAgICAgIHZhciBwcm90b2NvbD0oZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2w9PSdodHRwOicpPydodHRwOic6J2h0dHBzOic7CiAgICAgIHNjcmlwdFVSTD1wcm90b2NvbCtzY3JpcHRVUkw7CiAgICB9CiAgICBmZXRjaFNpZ25hdHVyZVNjcmlwdChzY3JpcHRVUkwpOwogIH0KICAKICAgLy8gdmlkZW8gdGl0bGUKICAgdmFyIHZpZGVvVGl0bGU9ZG9jdW1lbnQudGl0bGUgfHwgJ3ZpZGVvJzsKICAgdmlkZW9UaXRsZT12aWRlb1RpdGxlLnJlcGxhY2UoL1xzKlwtXHMqWW91VHViZSQvaSwgJycpLnJlcGxhY2UoLycvZywgJ1wnJykucmVwbGFjZSgvXlxzK3xccyskL2csICcnKS5yZXBsYWNlKC9cLiskL2csICcnKTsKICAgdmlkZW9UaXRsZT12aWRlb1RpdGxlLnJlcGxhY2UoL1s6Ilw/XCpdL2csICcnKS5yZXBsYWNlKC9bXHxcXFwvXS9nLCAnXycpOyAvLyBNYWMsIExpbnV4LCBXaW5kb3dzCiAgIGlmICgoKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50IHx8ICcnKS50b0xvd2VyQ2FzZSgpKS5pbmRleE9mKCd3aW5kb3dzJykgPj0gMCkgewogICAgICB2aWRlb1RpdGxlPXZpZGVvVGl0bGUucmVwbGFjZSgvIy9nLCAnJykucmVwbGFjZSgvJi9nLCAnXycpOyAvLyBXaW5kb3dzCiAgIH0gZWxzZSB7CiAgICAgIHZpZGVvVGl0bGU9dmlkZW9UaXRsZS5yZXBsYWNlKC8jL2csICclMjMnKS5yZXBsYWNlKC8mL2csICclMjYnKTsgLy8gIE1hYywgTGludXgKICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAvLyBwYXJzZSB0aGUgZm9ybWF0cyBtYXAKICB2YXIgc2VwMT0nJTJDJywgc2VwMj0nJTI2Jywgc2VwMz0nJTNEJzsKICBpZiAodmlkZW9Gb3JtYXRzLmluZGV4T2YoJywnKT4tMSkgeyAKICAgIHNlcDE9JywnOyAKICAgIHNlcDI9KHZpZGVvRm9ybWF0cy5pbmRleE9mKCcmJyk+LTEpPycmJzonXFx1MDAyNic7IAogICAgc2VwMz0nPSc7CiAgfQogIHZhciB2aWRlb1VSTD1uZXcgQXJyYXkoKTsKICB2YXIgdmlkZW9TaWduYXR1cmU9bmV3IEFycmF5KCk7CiAgaWYgKHZpZGVvQWRhcHRGb3JtYXRzKSB7CiAgICB2aWRlb0Zvcm1hdHM9dmlkZW9Gb3JtYXRzK3NlcDErdmlkZW9BZGFwdEZvcm1hdHM7CiAgfQogIHZhciB2aWRlb0Zvcm1hdHNHcm91cD12aWRlb0Zvcm1hdHMuc3BsaXQoc2VwMSk7CiAgZm9yICh2YXIgaT0wO2k8dmlkZW9Gb3JtYXRzR3JvdXAubGVuZ3RoO2krKykgewogICAgdmFyIHZpZGVvRm9ybWF0c0VsZW09dmlkZW9Gb3JtYXRzR3JvdXBbaV0uc3BsaXQoc2VwMik7CiAgICB2YXIgdmlkZW9Gb3JtYXRzUGFpcj1uZXcgQXJyYXkoKTsKICAgIGZvciAodmFyIGo9MDtqPHZpZGVvRm9ybWF0c0VsZW0ubGVuZ3RoO2orKykgewogICAgICB2YXIgcGFpcj12aWRlb0Zvcm1hdHNFbGVtW2pdLnNwbGl0KHNlcDMpOwogICAgICBpZiAocGFpci5sZW5ndGg9PTIpIHsKICAgICAgICB2aWRlb0Zvcm1hdHNQYWlyW3BhaXJbMF1dPXBhaXJbMV07CiAgICAgIH0KICAgIH0KICAgIGlmICh2aWRlb0Zvcm1hdHNQYWlyWyd1cmwnXT09bnVsbCkgY29udGludWU7CiAgICB2YXIgdXJsPXVuZXNjYXBlKHVuZXNjYXBlKHZpZGVvRm9ybWF0c1BhaXJbJ3VybCddKSkucmVwbGFjZSgvXFxcLy9nLCcvJykucmVwbGFjZSgvXFx1MDAyNi9nLCcmJyk7CiAgICBpZiAodmlkZW9Gb3JtYXRzUGFpclsnaXRhZyddPT1udWxsKSBjb250aW51ZTsKICAgIHZhciBpdGFnPXZpZGVvRm9ybWF0c1BhaXJbJ2l0YWcnXTsKICAgIHZhciBzaWc9dmlkZW9Gb3JtYXRzUGFpclsnc2lnJ118fHZpZGVvRm9ybWF0c1BhaXJbJ3NpZ25hdHVyZSddOwogICAgaWYgKHNpZykgewogICAgICB1cmw9dXJsKycmc2lnbmF0dXJlPScrc2lnOwogICAgICB2aWRlb1NpZ25hdHVyZVtpdGFnXT1udWxsOwogICAgfSBlbHNlIGlmICh2aWRlb0Zvcm1hdHNQYWlyWydzJ10pIHsKICAgICAgdXJsPXVybCsnJnNpZ25hdHVyZT0nK2RlY3J5cHRTaWduYXR1cmUodmlkZW9Gb3JtYXRzUGFpclsncyddKTsKICAgICAgdmlkZW9TaWduYXR1cmVbaXRhZ109dmlkZW9Gb3JtYXRzUGFpclsncyddOwogICAgfQogICAgaWYgKHVybC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ3JhdGVieXBhc3MnKT09LTEpIHsgLy8gc3BlZWQgdXAgZG93bmxvYWQgZm9yIGRhc2gKICAgICAgdXJsPXVybCsnJnJhdGVieXBhc3M9eWVzJzsKICAgIH0KICAgIGlmICh1cmwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdodHRwJyk9PTApIHsgLy8gdmFsaWRhdGUgVVJMCiAgICAgIHZpZGVvVVJMW2l0YWddPXVybCsnJnRpdGxlPScrdmlkZW9UaXRsZTsKICAgIH0KICB9CiAgICAKICB2YXIgc2hvd0Zvcm1hdD1uZXcgQXJyYXkoKTsKICBmb3IgKHZhciBjYXRlZ29yeSBpbiBGT1JNQVRfUlVMRSkgewogICAgdmFyIHJ1bGU9Rk9STUFUX1JVTEVbY2F0ZWdvcnldOwogICAgZm9yICh2YXIgaW5kZXggaW4gRk9STUFUX1RZUEUpewogICAgICBpZiAoRk9STUFUX1RZUEVbaW5kZXhdPT1jYXRlZ29yeSkgewogICAgICAgIHNob3dGb3JtYXRbaW5kZXhdPShydWxlPT0nYWxsJyk7CiAgICAgIH0KICAgIH0KICAgIGlmIChydWxlPT0nbWF4JykgewogICAgICBmb3IgKHZhciBpPUZPUk1BVF9PUkRFUi5sZW5ndGgtMTtpPj0wO2ktLSkgewogICAgICAgIHZhciBmb3JtYXQ9Rk9STUFUX09SREVSW2ldOwogICAgICAgIGlmIChGT1JNQVRfVFlQRVtmb3JtYXRdPT1jYXRlZ29yeSAmJiB2aWRlb1VSTFtmb3JtYXRdIT11bmRlZmluZWQpIHsKICAgICAgICAgIHNob3dGb3JtYXRbZm9ybWF0XT10cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIAogIHZhciBkYXNoUHJlZj1nZXRQcmVmKFNUT1JBR0VfREFTSCk7CiAgaWYgKGRhc2hQcmVmPT0nMScpIHsKICAgIFNIT1dfREFTSF9GT1JNQVRTPXRydWU7CiAgfSBlbHNlIGlmIChkYXNoUHJlZiE9JzAnKSB7CiAgICBzZXRQcmVmKFNUT1JBR0VfREFTSCwnMCcpOwogIH0KICAKICB2YXIgZG93bmxvYWRDb2RlTGlzdD1bXTsKICBmb3IgKHZhciBpPTA7aTxGT1JNQVRfT1JERVIubGVuZ3RoO2krKykgewogICAgdmFyIGZvcm1hdD1GT1JNQVRfT1JERVJbaV07CiAgICBpZiAoZm9ybWF0PT0nMzcnICYmIHZpZGVvVVJMW2Zvcm1hdF09PXVuZGVmaW5lZCkgeyAvLyBoYWNrIGZvciBkYXNoIDEwODBwCiAgICAgIGlmICh2aWRlb1VSTFsnMTM3J10pIHsKICAgICAgIGZvcm1hdD0nMTM3JzsKICAgICAgfQogICAgICBzaG93Rm9ybWF0W2Zvcm1hdF09c2hvd0Zvcm1hdFsnMzcnXTsKICAgIH0gZWxzZSBpZiAoZm9ybWF0PT0nMzgnICYmIHZpZGVvVVJMW2Zvcm1hdF09PXVuZGVmaW5lZCkgeyAvLyBoYWNrIGZvciBkYXNoIDRLCiAgICAgIGlmICh2aWRlb1VSTFsnMTM4J10gJiYgIXZpZGVvVVJMWycyNjYnXSkgewogICAgICAgZm9ybWF0PScxMzgnOwogICAgICB9CiAgICAgIHNob3dGb3JtYXRbZm9ybWF0XT1zaG93Rm9ybWF0WyczOCddOwogICAgfSAgICAKICAgIGlmICghU0hPV19EQVNIX0ZPUk1BVFMgJiYgZm9ybWF0Lmxlbmd0aD4yKSBjb250aW51ZTsKICAgIGlmICh2aWRlb1VSTFtmb3JtYXRdIT11bmRlZmluZWQgJiYgRk9STUFUX0xBQkVMW2Zvcm1hdF0hPXVuZGVmaW5lZCAmJiBzaG93Rm9ybWF0W2Zvcm1hdF0pIHsKICAgICAgZG93bmxvYWRDb2RlTGlzdC5wdXNoKHt1cmw6dmlkZW9VUkxbZm9ybWF0XSxzaWc6dmlkZW9TaWduYXR1cmVbZm9ybWF0XSxmb3JtYXQ6Zm9ybWF0LGxhYmVsOkZPUk1BVF9MQUJFTFtmb3JtYXRdfSk7CiAgICAgIGRlYnVnKCdEWVZBTSAtIEluZm86IGl0YWcnK2Zvcm1hdCsnIHVybDonK3ZpZGVvVVJMW2Zvcm1hdF0pOwogICAgfQogIH0gIAogIAogIGlmIChkb3dubG9hZENvZGVMaXN0Lmxlbmd0aD09MCkgewogICAgZGVidWcoJ0RZVkFNIC0gRXJyb3I6IE5vIGRvd25sb2FkIFVSTCBmb3VuZC4gUHJvYmFibHkgWW91VHViZSB1c2VzIGVuY3J5cHRlZCBzdHJlYW1zLicpOwogICAgcmV0dXJuOyAvLyBubyBmb3JtYXQKICB9IAogICAgCiAgLy8gZmluZCBwYXJlbnQgY29udGFpbmVyCiAgdmFyIG5ld1dhdGNoUGFnZT1mYWxzZTsKICB2YXIgcGFyZW50RWxlbWVudD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2F0Y2g3LWFjdGlvbi1idXR0b25zJyk7CiAgaWYgKHBhcmVudEVsZW1lbnQ9PW51bGwpIHsKICAgIHBhcmVudEVsZW1lbnQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dhdGNoOC1zZWNvbmRhcnktYWN0aW9ucycpOwogICAgaWYgKHBhcmVudEVsZW1lbnQ9PW51bGwpIHsKICAgICAgZGVidWcoJ0RZVkFNIEVycm9yIC0gTm8gY29udGFpbmVyIGZvciBhZGRpbmcgdGhlIGRvd25sb2FkIGJ1dHRvbi4gWW91VHViZSBtdXN0IGhhdmUgY2hhbmdlZCB0aGUgY29kZS4nKTsKICAgICAgcmV0dXJuOwogICAgfSBlbHNlIHsKICAgICAgbmV3V2F0Y2hQYWdlPXRydWU7CiAgICB9CiAgfQogIAogIC8vIGdldCBidXR0b24gbGFiZWxzCiAgdmFyIGJ1dHRvblRleHQ9KEJVVFRPTl9URVhUW2xhbmd1YWdlXSk/QlVUVE9OX1RFWFRbbGFuZ3VhZ2VdOkJVVFRPTl9URVhUWydlbiddOwogIHZhciBidXR0b25MYWJlbD0oQlVUVE9OX1RPT0xUSVBbbGFuZ3VhZ2VdKT9CVVRUT05fVE9PTFRJUFtsYW5ndWFnZV06QlVUVE9OX1RPT0xUSVBbJ2VuJ107CiAgICAKICAvLyBnZW5lcmF0ZSBkb3dubG9hZCBjb2RlIGZvciByZWd1bGFyIGludGVyZmFjZQogIHZhciBtYWluU3Bhbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CgogIGlmIChuZXdXYXRjaFBhZ2UpIHsKICAgIHZhciBzcGFuSWNvbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICBzcGFuSWNvbi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3l0LXVpeC1idXR0b24taWNvbi13cmFwcGVyJyk7CiAgICB2YXIgaW1hZ2VJY29uPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOwogICAgaW1hZ2VJY29uLnNldEF0dHJpYnV0ZSgnc3JjJywgJy8vcy55dGltZy5jb20veXQvaW1nL3BpeGVsLXZmbDN6NVdmVy5naWYnKTsKICAgIGltYWdlSWNvbi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3l0LXVpeC1idXR0b24taWNvbicpOwogICAgaW1hZ2VJY29uLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnd2lkdGg6MjBweDtoZWlnaHQ6MjBweDtiYWNrZ3JvdW5kLXNpemU6MjBweCAyMHB4O2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtiYWNrZ3JvdW5kLWltYWdlOiB1cmwoZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDQUFBQUFnQ0FZQUFBQnplbnIwQUFBQkcwbEVRVlJZUisyVzBRM0NNQXhFMndrWUFkaUVFV0FEbUl4dUFDTXdDbXpBQnBDVEVtUlNPN1lUUVgrQ2hFQ1Y0M3QybkY3R1llSFB1TEQrMEFLd0MvRG5XTUFwL041cWlta0J1QWZCZFJURi8rMi9BVjZaWUZVeFZZdWljQWZvSGVnZDZCM29IZmhaQitCeUYrSnlWOEZrckFCNzRwcUgzRFU1TDNpR29CVVJoZFZPRElRRjRFakVrV0xtbWhZQUxPUWdOSUJjSEhrZTRidWh4WEFBYUZuYUFocWJRNVFBT0hIa3doWjhiYWxreDFJQ0NpRUJXTlorQ2l2ZEI3UkVISUMyWmpaSzJvV2tsRERkQjFOU2RDZC9KczJQcVFNcFNJS1lWY004a0U2UUN3REJOUkNxT0JKclcwQ0w4a0NZeEwwQTFrNll4V3NBTkFpWGVDMkFCT0VXYndIQVdyd3hwemdrbUEvSnRJcW54VE9FbG1Qbmpsa2M0QTNGeWtBaEE0MkF4d0FBQUFCSlJVNUVya0pnZ2c9PSk7Jyk7CiAgICBzcGFuSWNvbi5hcHBlbmRDaGlsZChpbWFnZUljb24pOwogICAgbWFpblNwYW4uYXBwZW5kQ2hpbGQoc3Bhbkljb24pOwogIH0KCiAgdmFyIHNwYW5CdXR0b249ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogIHNwYW5CdXR0b24uc2V0QXR0cmlidXRlKCdjbGFzcycsICd5dC11aXgtYnV0dG9uLWNvbnRlbnQnKTsKICBzcGFuQnV0dG9uLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGJ1dHRvblRleHQrJyAnKSk7CiAgbWFpblNwYW4uYXBwZW5kQ2hpbGQoc3BhbkJ1dHRvbik7CiAgCiAgaWYgKCFuZXdXYXRjaFBhZ2UpIHsgLy8gb2xkIFVJCiAgICB2YXIgaW1nQnV0dG9uPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOwogICAgaW1nQnV0dG9uLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAneXQtdWl4LWJ1dHRvbi1hcnJvdycpOwogICAgaW1nQnV0dG9uLnNldEF0dHJpYnV0ZSgnc3JjJywgJy8vcy55dGltZy5jb20veXQvaW1nL3BpeGVsLXZmbDN6NVdmVy5naWYnKTsKICAgIG1haW5TcGFuLmFwcGVuZENoaWxkKGltZ0J1dHRvbik7CiAgfQoKICB2YXIgbGlzdEl0ZW1zPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29sJyk7CiAgbGlzdEl0ZW1zLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTpub25lOycpOwogIGxpc3RJdGVtcy5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3l0LXVpeC1idXR0b24tbWVudScpOwogIGZvciAodmFyIGk9MDtpPGRvd25sb2FkQ29kZUxpc3QubGVuZ3RoO2krKykgewogICAgdmFyIGxpc3RJdGVtPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CiAgICB2YXIgbGlzdExpbms9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgbGlzdExpbmsuc2V0QXR0cmlidXRlKCdzdHlsZScsICd0ZXh0LWRlY29yYXRpb246bm9uZTsnKTsKICAgIGxpc3RMaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIGRvd25sb2FkQ29kZUxpc3RbaV0udXJsKTsKICAgIGxpc3RMaW5rLnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCB2aWRlb1RpdGxlKycuJytGT1JNQVRfVFlQRVtkb3dubG9hZENvZGVMaXN0W2ldLmZvcm1hdF0pOwogICAgdmFyIGxpc3RCdXR0b249ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgbGlzdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3l0LXVpeC1idXR0b24tbWVudS1pdGVtJyk7CiAgICBsaXN0QnV0dG9uLnNldEF0dHJpYnV0ZSgnbG9vcCcsIGkrJycpOwogICAgbGlzdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2lkJywgTElTVElURU1fSUQrZG93bmxvYWRDb2RlTGlzdFtpXS5mb3JtYXQpOwogICAgbGlzdEJ1dHRvbi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkb3dubG9hZENvZGVMaXN0W2ldLmxhYmVsKSk7CiAgICBsaXN0TGluay5hcHBlbmRDaGlsZChsaXN0QnV0dG9uKTsKICAgIGxpc3RJdGVtLmFwcGVuZENoaWxkKGxpc3RMaW5rKTsKICAgIGxpc3RJdGVtcy5hcHBlbmRDaGlsZChsaXN0SXRlbSk7CiAgfQogIG1haW5TcGFuLmFwcGVuZENoaWxkKGxpc3RJdGVtcyk7CiAgdmFyIGJ1dHRvbkVsZW1lbnQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lkJywgQlVUVE9OX0lEKTsKICBpZiAobmV3V2F0Y2hQYWdlKSB7CiAgICBidXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAneXQtdWl4LWJ1dHRvbiAgeXQtdWl4LWJ1dHRvbi1zaXplLWRlZmF1bHQgeXQtdWl4LWJ1dHRvbi1vcGFjaXR5IHl0LXVpeC10b29sdGlwJyk7CiAgfSBlbHNlIHsgLy8gb2xkIFVJCiAgICBidXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAneXQtdWl4LWJ1dHRvbiB5dC11aXgtdG9vbHRpcCB5dC11aXgtYnV0dG9uLWVtcHR5IHl0LXVpeC1idXR0b24tdGV4dCcpOwogICAgYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ21hcmdpbi10b3A6NHB4OyBtYXJnaW4tbGVmdDonKygodGV4dERpcmVjdGlvbj09J2xlZnQnKT81OjEwKSsncHg7Jyk7CiAgfQogIGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXRvb2x0aXAtdGV4dCcsIGJ1dHRvbkxhYmVsKTsgIAogIGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2J1dHRvbicpOwogIGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpOwogIGJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe3JldHVybiBmYWxzZTt9LCBmYWxzZSk7CiAgYnV0dG9uRWxlbWVudC5hcHBlbmRDaGlsZChtYWluU3Bhbik7CiAgdmFyIGNvbnRhaW5lclNwYW49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogIGNvbnRhaW5lclNwYW4uc2V0QXR0cmlidXRlKCdpZCcsIENPTlRBSU5FUl9JRCk7CiAgY29udGFpbmVyU3Bhbi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnICcpKTsKICBjb250YWluZXJTcGFuLmFwcGVuZENoaWxkKGJ1dHRvbkVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogIC8vIGFkZCB0aGUgYnV0dG9uCiAgaWYgKCFuZXdXYXRjaFBhZ2UpIHsgLy8gd2F0Y2g3CiAgICBwYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGNvbnRhaW5lclNwYW4pOwogIH0gZWxzZSB7IC8vIHdhdGNoOAogICAgcGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUoY29udGFpbmVyU3BhbiwgcGFyZW50RWxlbWVudC5maXJzdENoaWxkKTsKICB9CiAgICAKICAvLyBSRVBMQUNFV0lUSCBpZiAoIWlzU2lnbmF0dXJlVXBkYXRpbmdTdGFydGVkKSB7CiAgICBmb3IgKHZhciBpPTA7aTxkb3dubG9hZENvZGVMaXN0Lmxlbmd0aDtpKyspIHsgCiAgICAgIGFkZEZpbGVTaXplKGRvd25sb2FkQ29kZUxpc3RbaV0udXJsLCBkb3dubG9hZENvZGVMaXN0W2ldLmZvcm1hdCk7CiAgICB9CiAgLy8gfSAKICAKICBpZiAodHlwZW9mIEdNX2Rvd25sb2FkICE9PSAndW5kZWZpbmVkJykgewogICAgZm9yICh2YXIgaT0wO2k8ZG93bmxvYWRDb2RlTGlzdC5sZW5ndGg7aSsrKSB7CiAgICAgIHZhciBkb3dubG9hZEZNVD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChMSVNUSVRFTV9JRCtkb3dubG9hZENvZGVMaXN0W2ldLmZvcm1hdCk7CiAgICAgIHZhciB1cmw9KGRvd25sb2FkQ29kZUxpc3RbaV0udXJsKS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAodXJsLmluZGV4T2YoJ2NsZW49Jyk+MCAmJiB1cmwuaW5kZXhPZignZHVyPScpPjAgJiYgdXJsLmluZGV4T2YoJ2dpcj0nKT4wCiAgICAgICAgICAmJiB1cmwuaW5kZXhPZignbG10PScpPjApIHsKICAgICAgICBkb3dubG9hZEZNVC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRvd25sb2FkVmlkZW9OYXRpdmVseSwgZmFsc2UpOwogICAgICB9CiAgICB9CiAgfQogIAogIGFkZEZyb21NYW5pZmVzdCgpOwogIAogIGZ1bmN0aW9uIGRvd25sb2FkVmlkZW9OYXRpdmVseShlKSB7CiAgICB2YXIgZWxlbT1lLmN1cnJlbnRUYXJnZXQ7CiAgICBlLnJldHVyblZhbHVlPWZhbHNlOyAgICAKICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH0KICAgIHZhciBsb29wPWVsZW0uZ2V0QXR0cmlidXRlKCdsb29wJyk7CiAgICBpZiAobG9vcCkgewogICAgICBHTV9kb3dubG9hZChkb3dubG9hZENvZGVMaXN0W2xvb3BdLnVybCwgdmlkZW9UaXRsZSsnLicrRk9STUFUX1RZUEVbZG93bmxvYWRDb2RlTGlzdFtsb29wXS5mb3JtYXRdKTsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CiAgCiAgZnVuY3Rpb24gYWRkRnJvbU1hbmlmZXN0KCkgeyAvLyBhZGQgRGFzaCBVUkxzIGZyb20gbWFuaWZlc3QgZmlsZQogICAgdmFyIGZvcm1hdHM9WycxMzcnLCAnMTM4JywgJzE0MCddOyAvLyAxMzc9MTA4MHAsIDEzOD00aywgMTQwPW00YQogICAgdmFyIGlzTmVjZXNzYXJ5PXRydWU7CiAgICBmb3IgKHZhciBpPTA7aTxmb3JtYXRzLmxlbmd0aDtpKyspIHsKICAgICAgaWYgKHZpZGVvVVJMW2Zvcm1hdHNbaV1dKSB7CiAgICAgICAgaXNOZWNlc3Nhcnk9ZmFsc2U7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGlmICh2aWRlb01hbmlmZXN0VVJMICYmIFNIT1dfREFTSF9GT1JNQVRTICYmIGlzTmVjZXNzYXJ5KSB7CiAgICAgIHZhciBtYXRjaFNpZz1maW5kTWF0Y2godmlkZW9NYW5pZmVzdFVSTCwgL1wvc1wvKFthLXpBLVowLTlcLl0rKVwvL2kpOwogICAgICBpZiAobWF0Y2hTaWcpIHsKICAgICAgICB2YXIgZGVjcnlwdGVkU2lnPWRlY3J5cHRTaWduYXR1cmUobWF0Y2hTaWcpOwogICAgICAgIGlmIChkZWNyeXB0ZWRTaWcpIHsKICAgICAgICAgIHZpZGVvTWFuaWZlc3RVUkw9dmlkZW9NYW5pZmVzdFVSTC5yZXBsYWNlKCcvcy8nK21hdGNoU2lnKycvJywnL3NpZ25hdHVyZS8nK2RlY3J5cHRlZFNpZysnLycpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodmlkZW9NYW5pZmVzdFVSTC5pbmRleE9mKCcvLycpPT0wKSB7CiAgICAgICAgdmFyIHByb3RvY29sPShkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbD09J2h0dHA6Jyk/J2h0dHA6JzonaHR0cHM6JzsKICAgICAgICB2aWRlb01hbmlmZXN0VVJMPXByb3RvY29sK3ZpZGVvTWFuaWZlc3RVUkw7CiAgICAgIH0KICAgICAgZGVidWcoJ0RZVkFNIC0gSW5mbzogbWFuaWZlc3RVUkwgJyt2aWRlb01hbmlmZXN0VVJMKTsKICAgICAgY3Jvc3NYbWxIdHRwUmVxdWVzdCh7CiAgICAgICAgICBtZXRob2Q6J0dFVCcsCiAgICAgICAgICB1cmw6dmlkZW9NYW5pZmVzdFVSTCwgLy8gY2hlY2sgaWYgVVJMIGV4aXN0cwogICAgICAgICAgb25sb2FkOmZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZWFkeVN0YXRlID09PSA0ICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwICYmIHJlc3BvbnNlLnJlc3BvbnNlVGV4dCkgewogICAgICAgICAgICAgIGRlYnVnKCdEWVZBTSAtIEluZm86IG1hbmllc3RGaWxlQ29udGVudHMgJytyZXNwb25zZS5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgIHZhciBsYXN0Rm9ybWF0RnJvbUxpc3Q9ZG93bmxvYWRDb2RlTGlzdFtkb3dubG9hZENvZGVMaXN0Lmxlbmd0aC0xXS5mb3JtYXQ7CiAgICAgICAgICAgICAgZGVidWcoJ0RZVkFNIC0gSW5mbzogbGFzdGZvcm1hdDogJytsYXN0Rm9ybWF0RnJvbUxpc3QpOwogICAgICAgICAgICAgIGZvciAodmFyIGk9MDtpPGZvcm1hdHMubGVuZ3RoO2krKykgewogICAgICAgICAgICAgICAgaz1mb3JtYXRzW2ldOwogICAgICAgICAgICAgICAgaWYgKHZpZGVvVVJMW2tdIHx8IHNob3dGb3JtYXRba109PWZhbHNlKSBjb250aW51ZTsKICAgICAgICAgICAgICAgIHZhciByZWdleHAgPSBuZXcgUmVnRXhwKCc8QmFzZVVSTD4oaHR0cFtePF0raXRhZ1xcLycraysnW148XSspPFxcL0Jhc2VVUkw+JywnaScpOwogICAgICAgICAgICAgICAgdmFyIG1hdGNoVVJMPWZpbmRNYXRjaChyZXNwb25zZS5yZXNwb25zZVRleHQsIHJlZ2V4cCk7CiAgICAgICAgICAgICAgICBkZWJ1ZygnRFlWQU0gLSBJbmZvOiBtYXRjaFVSTCBpdGFnPSAnK2srJyB1cmw9ICcrbWF0Y2hVUkwpOwogICAgICAgICAgICAgICAgaWYgKCFtYXRjaFVSTCkgY29udGludWU7CiAgICAgICAgICAgICAgICBtYXRjaFVSTD1tYXRjaFVSTC5yZXBsYWNlKC8mYW1wXDsvZywnJicpOwogICAgICAgICAgICAgICAgLy8gLi4uCiAgICAgICAgICAgICAgICBkb3dubG9hZENvZGVMaXN0LnB1c2goCiAgICAgICAgICAgICAgICAgIHt1cmw6bWF0Y2hVUkwsc2lnOnZpZGVvU2lnbmF0dXJlW2tdLGZvcm1hdDprLGxhYmVsOkZPUk1BVF9MQUJFTFtrXX0pOwogICAgICAgICAgICAgICAgdmFyIGRvd25sb2FkRk1UPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKExJU1RJVEVNX0lEK2xhc3RGb3JtYXRGcm9tTGlzdCk7CiAgICAgICAgICAgICAgICB2YXIgY2xvbmU9ZG93bmxvYWRGTVQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsb25lTm9kZSh0cnVlKTsKICAgICAgICAgICAgICAgIGNsb25lLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoJ2lkJywgTElTVElURU1fSUQrayk7CiAgICAgICAgICAgICAgICBjbG9uZS5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSgnaHJlZicsIG1hdGNoVVJMKTsKICAgICAgICAgICAgICAgIGRvd25sb2FkRk1ULnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGNsb25lKTsKICAgICAgICAgICAgICAgIGRvd25sb2FkRk1UPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKExJU1RJVEVNX0lEK2spOwogICAgICAgICAgICAgICAgZG93bmxvYWRGTVQuZmlyc3RDaGlsZC5ub2RlVmFsdWU9Rk9STUFUX0xBQkVMW2tdOwogICAgICAgICAgICAgICAgYWRkRmlsZVNpemUobWF0Y2hVUkwsIGspOwogICAgICAgICAgICAgICAgbGFzdEZvcm1hdEZyb21MaXN0PWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IAogICAgICAgIH0pOwogICAgfSAgCiAgfQogIAogIGZ1bmN0aW9uIGluamVjdFN0eWxlKGNvZGUpIHsKICAgIHZhciBzdHlsZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogICAgc3R5bGUudHlwZT0ndGV4dC9jc3MnOwogICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY29kZSkpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZChzdHlsZSk7CiAgfQogIAogIGZ1bmN0aW9uIGluamVjdFNjcmlwdChjb2RlKSB7CiAgICB2YXIgc2NyaXB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogICAgc2NyaXB0LnR5cGU9J2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnOwogICAgc2NyaXB0LnRleHRDb250ZW50PWNvZGU7CiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNjcmlwdCk7CiAgfSAgICAKICAKICBmdW5jdGlvbiBkZWJ1ZyhzdHIpIHsKICAgIHZhciBkZWJ1Z0VsZW09ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoREVCVUdfSUQpOwogICAgaWYgKCFkZWJ1Z0VsZW0pIHsKICAgICAgZGVidWdFbGVtPWNyZWF0ZUhpZGRlbkVsZW0oJ2RpdicsIERFQlVHX0lEKTsKICAgIH0KICAgIGRlYnVnRWxlbS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzdHIrJyAnKSk7CiAgfQogIAogIGZ1bmN0aW9uIGNyZWF0ZUhpZGRlbkVsZW0odGFnLCBpZCkgewogICAgdmFyIGVsZW09ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpOwogICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2lkJywgaWQpOwogICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6bm9uZTsnKTsKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbSk7CiAgICByZXR1cm4gZWxlbTsKICB9CiAgCiAgZnVuY3Rpb24gZml4VHJhbnNsYXRpb25zKGxhbmd1YWdlLCB0ZXh0RGlyZWN0aW9uKSB7ICAKICAgIGlmICgvXmFmfGJnfGJufGNhfGNzfGRlfGVsfGVzfGV0fGV1fGZhfGZpfGZpbHxmcnxnbHxoaXxocnxodXxpZHxpdHxpd3xrbnxsdnxsdHxtbHxtcnxtc3xubHxwbHxyb3xydXxzbHxza3xzcnxzd3x0YXx0ZXx0aHx1a3x1cnx2aXx6dSQvLnRlc3QobGFuZ3VhZ2UpKSB7IC8vIGZpeCBpbnRlcm5hdGlvbmFsIFVJCiAgICAgIHZhciBsaWtlQnV0dG9uPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3YXRjaC1saWtlJyk7CiAgICAgIGlmIChsaWtlQnV0dG9uKSB7CiAgICAgICAgdmFyIHNwYW5FbGVtZW50cz1saWtlQnV0dG9uLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3l0LXVpeC1idXR0b24tY29udGVudCcpOwogICAgICAgIGlmIChzcGFuRWxlbWVudHMpIHsKICAgICAgICAgIHNwYW5FbGVtZW50c1swXS5zdHlsZS5kaXNwbGF5PSdub25lJzsgLy8gaGlkZSBsaWtlIHRleHQKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIG1hcmdpblBpeGVscz0xMDsKICAgICAgaWYgKC9eYmd8Y2F8Y3N8ZWx8ZXV8aHJ8aXR8bWx8bXN8cGx8c2x8c3d8dGUkLy50ZXN0KGxhbmd1YWdlKSkgewogICAgICAgIG1hcmdpblBpeGVscz0xOwogICAgICB9CiAgICAgIGluamVjdFN0eWxlKCcjd2F0Y2g3LXNlY29uZGFyeS1hY3Rpb25zIC55dC11aXgtYnV0dG9ue21hcmdpbi0nK3RleHREaXJlY3Rpb24rJzonK21hcmdpblBpeGVscysncHghaW1wb3J0YW50fScpOwogICAgfQogIH0KICAKICBmdW5jdGlvbiBmaW5kTWF0Y2godGV4dCwgcmVnZXhwKSB7CiAgICB2YXIgbWF0Y2hlcz10ZXh0Lm1hdGNoKHJlZ2V4cCk7CiAgICByZXR1cm4gKG1hdGNoZXMpP21hdGNoZXNbMV06bnVsbDsKICB9CiAgCiAgZnVuY3Rpb24gaXNTdHJpbmcocykgewogICAgcmV0dXJuICh0eXBlb2Ygcz09PSdzdHJpbmcnIHx8IHMgaW5zdGFuY2VvZiBTdHJpbmcpOwogIH0KICAgIAogIGZ1bmN0aW9uIGlzSW50ZWdlcihuKSB7CiAgICByZXR1cm4gKHR5cGVvZiBuPT09J251bWJlcicgJiYgbiUxPT0wKTsKICB9CiAgCiAgZnVuY3Rpb24gZ2V0UHJlZihuYW1lKSB7IC8vIGNyb3NzLWJyb3dzZXIgR01fZ2V0VmFsdWUKICAgIHZhciBhPScnLCBiPScnOwogICAgdHJ5IHthPXR5cGVvZiBHTV9nZXRWYWx1ZS50b1N0cmluZzsgYj1HTV9nZXRWYWx1ZS50b1N0cmluZygpfSBjYXRjaChlKXt9ICAgIAogICAgaWYgKHR5cGVvZiBHTV9nZXRWYWx1ZSA9PT0gJ2Z1bmN0aW9uJyAmJiAKICAgIChhID09PSAndW5kZWZpbmVkJyB8fCBiLmluZGV4T2YoJ25vdCBzdXBwb3J0ZWQnKSA9PT0gLTEpKSB7CiAgICAgIHJldHVybiBHTV9nZXRWYWx1ZShuYW1lLCBudWxsKTsgLy8gR3JlYXNlbW9ua2V5LCBUYW1wZXJtb25rZXksIEZpcmVmb3ggZXh0ZW5zaW9uCiAgICB9IGVsc2UgewogICAgICAgIHZhciBscz1udWxsOwogICAgICAgIHRyeSB7bHM9d2luZG93LmxvY2FsU3RvcmFnZXx8bnVsbH0gY2F0Y2goZSl7fQogICAgICAgIGlmIChscykgewogICAgICAgICAgcmV0dXJuIGxzLmdldEl0ZW0obmFtZSk7IC8vIENocm9tZSBzY3JpcHQsIE9wZXJhIGV4dGVuc2lvbnMKICAgICAgICB9CiAgICB9CiAgICByZXR1cm47CiAgfQogIAogIGZ1bmN0aW9uIHNldFByZWYobmFtZSwgdmFsdWUpIHsgLy8gIGNyb3NzLWJyb3dzZXIgR01fc2V0VmFsdWUKICAgIHZhciBhPScnLCBiPScnOwogICAgdHJ5IHthPXR5cGVvZiBHTV9zZXRWYWx1ZS50b1N0cmluZzsgYj1HTV9zZXRWYWx1ZS50b1N0cmluZygpfSBjYXRjaChlKXt9ICAgIAogICAgaWYgKHR5cGVvZiBHTV9zZXRWYWx1ZSA9PT0gJ2Z1bmN0aW9uJyAmJiAKICAgIChhID09PSAndW5kZWZpbmVkJyB8fCBiLmluZGV4T2YoJ25vdCBzdXBwb3J0ZWQnKSA9PT0gLTEpKSB7CiAgICAgIEdNX3NldFZhbHVlKG5hbWUsIHZhbHVlKTsgLy8gR3JlYXNlbW9ua2V5LCBUYW1wZXJtb25rZXksIEZpcmVmb3ggZXh0ZW5zaW9uCiAgICB9IGVsc2UgewogICAgICAgIHZhciBscz1udWxsOwogICAgICAgIHRyeSB7bHM9d2luZG93LmxvY2FsU3RvcmFnZXx8bnVsbH0gY2F0Y2goZSl7fQogICAgICAgIGlmIChscykgewogICAgICAgICAgcmV0dXJuIGxzLnNldEl0ZW0obmFtZSwgdmFsdWUpOyAvLyBDaHJvbWUgc2NyaXB0LCBPcGVyYSBleHRlbnNpb25zCiAgICAgICAgfQogICAgfQogIH0KICAKICBmdW5jdGlvbiBjcm9zc1htbEh0dHBSZXF1ZXN0KGRldGFpbHMpIHsgLy8gY3Jvc3MtYnJvd3NlciBHTV94bWxodHRwUmVxdWVzdAogICAgaWYgKHR5cGVvZiBHTV94bWxodHRwUmVxdWVzdCA9PT0gJ2Z1bmN0aW9uJykgeyAvLyBHcmVhc2Vtb25rZXksIFRhbXBlcm1vbmtleSwgRmlyZWZveCBleHRlbnNpb24sIENocm9tZSBzY3JpcHQKICAgICAgR01feG1saHR0cFJlcXVlc3QoZGV0YWlscyk7CiAgICB9IGVsc2UgaWYgKHR5cGVvZiB3aW5kb3cub3BlcmEgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5vcGVyYSAmJiB0eXBlb2Ygb3BlcmEuZXh0ZW5zaW9uICE9PSAndW5kZWZpbmVkJyAmJiAKICAgICAgICAgICAgICAgdHlwZW9mIG9wZXJhLmV4dGVuc2lvbi5wb3N0TWVzc2FnZSAhPT0gJ3VuZGVmaW5lZCcpIHsgLy8gT3BlcmEgMTIgZXh0ZW5zaW9uCiAgICAgICAgdmFyIGluZGV4PW9wZXJhVGFibGUubGVuZ3RoOwogICAgICAgIG9wZXJhLmV4dGVuc2lvbi5wb3N0TWVzc2FnZSh7J2FjdGlvbic6J3hoci0nK2luZGV4LCAndXJsJzpkZXRhaWxzLnVybCwgJ21ldGhvZCc6ZGV0YWlscy5tZXRob2R9KTsKICAgICAgICBvcGVyYVRhYmxlW2luZGV4XT1kZXRhaWxzOwogICAgfSBlbHNlIGlmICh0eXBlb2Ygd2luZG93Lm9wZXJhID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgWE1MSHR0cFJlcXVlc3QgPT09ICdmdW5jdGlvbicpIHsgLy8gT3BlcmEgMTUrIGV4dGVuc2lvbgogICAgICAgIHZhciB4aHI9bmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09IDQpIHsKICAgICAgICAgICAgaWYgKGRldGFpbHNbJ29ubG9hZCddKSB7CiAgICAgICAgICAgICAgZGV0YWlsc1snb25sb2FkJ10oeGhyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB4aHIub3BlbihkZXRhaWxzLm1ldGhvZCwgZGV0YWlscy51cmwsIHRydWUpOwogICAgICAgIHhoci5zZW5kKCk7CiAgICB9CiAgfQogICAKICBmdW5jdGlvbiBhZGRGaWxlU2l6ZSh1cmwsIGZvcm1hdCkgewogIAogICAgZnVuY3Rpb24gdXBkYXRlVmlkZW9MYWJlbChzaXplLCBmb3JtYXQpIHsKICAgICAgdmFyIGVsZW09ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoTElTVElURU1fSUQrZm9ybWF0KTsKICAgICAgaWYgKGVsZW0pIHsKICAgICAgICBzaXplPXBhcnNlSW50KHNpemUsMTApOwogICAgICAgIGlmIChzaXplPj0xMDczNzQxODI0KSB7CiAgICAgICAgICBzaXplPXBhcnNlRmxvYXQoKHNpemUvMTA3Mzc0MTgyNCkudG9GaXhlZCgxKSkrJyBHQic7CiAgICAgICAgfSBlbHNlIGlmIChzaXplPj0xMDQ4NTc2KSB7CiAgICAgICAgICBzaXplPXBhcnNlRmxvYXQoKHNpemUvMTA0ODU3NikudG9GaXhlZCgxKSkrJyBNQic7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNpemU9cGFyc2VGbG9hdCgoc2l6ZS8xMDI0KS50b0ZpeGVkKDEpKSsnIEtCJzsKICAgICAgICB9CiAgICAgICAgaWYgKGVsZW0uY2hpbGROb2Rlcy5sZW5ndGg+MSkgewogICAgICAgICAgICBlbGVtLmxhc3RDaGlsZC5ub2RlVmFsdWU9JyAoJytzaXplKycpJzsKICAgICAgICB9IGVsc2UgaWYgKGVsZW0uY2hpbGROb2Rlcy5sZW5ndGg9PTEpIHsKICAgICAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnICgnK3NpemUrJyknKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAgICAgCiAgICB2YXIgbWF0Y2hTaXplPWZpbmRNYXRjaCh1cmwsIC9bJlw/XWNsZW49KFswLTldKykmL2kpOwogICAgaWYgKG1hdGNoU2l6ZSkgewogICAgICB1cGRhdGVWaWRlb0xhYmVsKG1hdGNoU2l6ZSwgZm9ybWF0KTsKICAgIH0gZWxzZSB7CiAgICAgIHRyeSB7CiAgICAgICAgY3Jvc3NYbWxIdHRwUmVxdWVzdCh7CiAgICAgICAgICBtZXRob2Q6J0hFQUQnLAogICAgICAgICAgdXJsOnVybCwKICAgICAgICAgIG9ubG9hZDpmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICBpZiAocmVzcG9uc2UucmVhZHlTdGF0ZSA9PSA0ICYmIHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHsgLy8gYWRkIHNpemUKICAgICAgICAgICAgICB2YXIgc2l6ZT0wOwogICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UuZ2V0UmVzcG9uc2VIZWFkZXIgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgIHNpemU9cmVzcG9uc2UuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtbGVuZ3RoJyk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5yZXNwb25zZUhlYWRlcnMpIHsKICAgICAgICAgICAgICAgICAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoJ15Db250ZW50XC1sZW5ndGg6ICguKikkJywnaW0nKTsKICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoID0gcmVnZXhwLmV4ZWMocmVzcG9uc2UucmVzcG9uc2VIZWFkZXJzKTsKICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgICAgICAgICAgICAgc2l6ZT1tYXRjaFsxXTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoc2l6ZSkgewogICAgICAgICAgICAgICAgdXBkYXRlVmlkZW9MYWJlbChzaXplLCBmb3JtYXQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGNhdGNoKGUpIHsgfQogICAgfQogIH0KICAKICBmdW5jdGlvbiBmaW5kU2lnbmF0dXJlQ29kZShzb3VyY2VDb2RlKSB7CiAgICBkZWJ1ZygnRFlWQU0gLSBJbmZvOiBzaWduYXR1cmUgc3RhcnQgJytnZXRQcmVmKFNUT1JBR0VfQ09ERSkpOwogICAgdmFyIHNpZ25hdHVyZUZ1bmN0aW9uTmFtZSA9IAogICAgZmluZE1hdGNoKHNvdXJjZUNvZGUsIAogICAgL1wuc2V0XHMqXCgic2lnbmF0dXJlIlxzKixccyooW2EtekEtWjAtOV8kXVtcdyRdKilcKC8pCiAgICB8fCBmaW5kTWF0Y2goc291cmNlQ29kZSwgCiAgICAvXC5zaWdccypcfFx8XHMqKFthLXpBLVowLTlfJF1bXHckXSopXCgvKQogICAgfHwgZmluZE1hdGNoKHNvdXJjZUNvZGUsIAogICAgL1wuc2lnbmF0dXJlXHMqPVxzKihbYS16QS1aXyRdW1x3JF0qKVwoW2EtekEtWl8kXVtcdyRdKlwpLyk7IC8vb2xkCiAgICBpZiAoc2lnbmF0dXJlRnVuY3Rpb25OYW1lID09IG51bGwpIHJldHVybiBzZXRQcmVmKFNUT1JBR0VfQ09ERSwgJ2Vycm9yJyk7CiAgICBzaWduYXR1cmVGdW5jdGlvbk5hbWU9c2lnbmF0dXJlRnVuY3Rpb25OYW1lLnJlcGxhY2UoJyQnLCdcXCQnKTsgICAgCiAgICB2YXIgcmVnQ29kZSA9IG5ldyBSZWdFeHAoc2lnbmF0dXJlRnVuY3Rpb25OYW1lICsgJ1xccyo9XFxzKmZ1bmN0aW9uJyArCiAgICAnXFxzKlxcKFtcXHckXSpcXClcXHMqe1tcXHckXSo9W1xcdyRdKlxcLnNwbGl0XFwoIiJcXCk7XG4qKC4rKTtyZXR1cm4gW1xcdyRdKlxcLmpvaW4nKTsKICAgIHZhciByZWdDb2RlMiA9IG5ldyBSZWdFeHAoJ2Z1bmN0aW9uIFxccyonICsgc2lnbmF0dXJlRnVuY3Rpb25OYW1lICsKICAgICdcXHMqXFwoW1xcdyRdKlxcKVxccyp7W1xcdyRdKj1bXFx3JF0qXFwuc3BsaXRcXCgiIlxcKTtcbiooLispO3JldHVybiBbXFx3JF0qXFwuam9pbicpOyAgICAKICAgIHZhciBmdW5jdGlvbkNvZGUgPSBmaW5kTWF0Y2goc291cmNlQ29kZSwgcmVnQ29kZSkgfHwgZmluZE1hdGNoKHNvdXJjZUNvZGUsIHJlZ0NvZGUyKTsKICAgIGRlYnVnKCdEWVZBTSAtIEluZm86IHNpZ25hdHVyZWZ1bmN0aW9uICcgKyBzaWduYXR1cmVGdW5jdGlvbk5hbWUgKyAnIC0tICcgKyBmdW5jdGlvbkNvZGUpOyAgICAgICAgICAgIAogICAgaWYgKGZ1bmN0aW9uQ29kZSA9PSBudWxsKSByZXR1cm4gc2V0UHJlZihTVE9SQUdFX0NPREUsICdlcnJvcicpOwogICAgCiAgICB2YXIgcmV2ZXJzZUZ1bmN0aW9uTmFtZSA9IGZpbmRNYXRjaChzb3VyY2VDb2RlLCAKICAgIC8oW1x3JF0qKVxzKjpccypmdW5jdGlvblxzKlwoXHMqW1x3JF0qXHMqXClccyp7XHMqKD86cmV0dXJuXHMqKT9bXHckXSpcLnJldmVyc2VccypcKFxzKlwpXHMqfS8pOwogICAgZGVidWcoJ0RZVkFNIC0gSW5mbzogcmV2ZXJzZWZ1bmN0aW9uICcgKyByZXZlcnNlRnVuY3Rpb25OYW1lKTsKICAgIGlmIChyZXZlcnNlRnVuY3Rpb25OYW1lKSByZXZlcnNlRnVuY3Rpb25OYW1lPXJldmVyc2VGdW5jdGlvbk5hbWUucmVwbGFjZSgnJCcsJ1xcJCcpOyAgICAgICAgCiAgICB2YXIgc2xpY2VGdW5jdGlvbk5hbWUgPSBmaW5kTWF0Y2goc291cmNlQ29kZSwgCiAgICAvKFtcdyRdKilccyo6XHMqZnVuY3Rpb25ccypcKFxzKltcdyRdKlxzKixccypbXHckXSpccypcKVxzKntccyooPzpyZXR1cm5ccyopP1tcdyRdKlwuKD86c2xpY2V8c3BsaWNlKVwoLitcKVxzKn0vKTsKICAgIGRlYnVnKCdEWVZBTSAtIEluZm86IHNsaWNlZnVuY3Rpb24gJyArIHNsaWNlRnVuY3Rpb25OYW1lKTsKICAgIGlmIChzbGljZUZ1bmN0aW9uTmFtZSkgc2xpY2VGdW5jdGlvbk5hbWU9c2xpY2VGdW5jdGlvbk5hbWUucmVwbGFjZSgnJCcsJ1xcJCcpOyAgICAKICAgIAogICAgdmFyIHJlZ1NsaWNlID0gbmV3IFJlZ0V4cCgnXFwuKD86Jysnc2xpY2UnKyhzbGljZUZ1bmN0aW9uTmFtZT8nfCcrc2xpY2VGdW5jdGlvbk5hbWU6JycpKwogICAgJylcXHMqXFwoXFxzKig/OlthLXpBLVpfJF1bXFx3JF0qXFxzKiwpP1xccyooWzAtOV0rKVxccypcXCknKTsgLy8gLnNsaWNlKDUpIHNhdSAuSGYoYSw1KQogICAgdmFyIHJlZ1JldmVyc2UgPSBuZXcgUmVnRXhwKCdcXC4oPzonKydyZXZlcnNlJysocmV2ZXJzZUZ1bmN0aW9uTmFtZT8nfCcrcmV2ZXJzZUZ1bmN0aW9uTmFtZTonJykrCiAgICAnKVxccypcXChbXlxcKV0qXFwpJyk7ICAvLyAucmV2ZXJzZSgpIHNhdSAuR2YoYSw0NSkKICAgIHZhciByZWdTd2FwID0gbmV3IFJlZ0V4cCgnW1xcdyRdK1xccypcXChcXHMqW1xcdyRdK1xccyosXFxzKihbMC05XSspXFxzKlxcKScpOwogICAgdmFyIHJlZ0lubGluZSA9IG5ldyBSZWdFeHAoJ1tcXHckXStcXFswXFxdXFxzKj1cXHMqW1xcdyRdK1xcWyhbMC05XSspXFxzKiVcXHMqW1xcdyRdK1xcLmxlbmd0aFxcXScpOwogICAgdmFyIGZ1bmN0aW9uQ29kZVBpZWNlcz1mdW5jdGlvbkNvZGUuc3BsaXQoJzsnKTsKICAgIHZhciBkZWNvZGVBcnJheT1bXTsKICAgIGZvciAodmFyIGk9MDsgaTxmdW5jdGlvbkNvZGVQaWVjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgZnVuY3Rpb25Db2RlUGllY2VzW2ldPWZ1bmN0aW9uQ29kZVBpZWNlc1tpXS50cmltKCk7CiAgICAgIHZhciBjb2RlTGluZT1mdW5jdGlvbkNvZGVQaWVjZXNbaV07CiAgICAgIGlmIChjb2RlTGluZS5sZW5ndGg+MCkgewogICAgICAgIHZhciBhcnJTbGljZT1jb2RlTGluZS5tYXRjaChyZWdTbGljZSk7CiAgICAgICAgdmFyIGFyclJldmVyc2U9Y29kZUxpbmUubWF0Y2gocmVnUmV2ZXJzZSk7CiAgICAgICAgZGVidWcoaSsnOiAnK2NvZGVMaW5lKycgLS0nKyhhcnJTbGljZT8nIHNsaWNlIGxlbmd0aCAnK2FyclNsaWNlLmxlbmd0aDonJykgKycgJysoYXJyUmV2ZXJzZT8ncmV2ZXJzZSc6JycpKTsKICAgICAgICBpZiAoYXJyU2xpY2UgJiYgYXJyU2xpY2UubGVuZ3RoID49IDIpIHsgLy8gc2xpY2UKICAgICAgICB2YXIgc2xpY2U9cGFyc2VJbnQoYXJyU2xpY2VbMV0sIDEwKTsKICAgICAgICBpZiAoaXNJbnRlZ2VyKHNsaWNlKSl7IAogICAgICAgICAgZGVjb2RlQXJyYXkucHVzaCgtc2xpY2UpOwogICAgICAgIH0gZWxzZSByZXR1cm4gc2V0UHJlZihTVE9SQUdFX0NPREUsICdlcnJvcicpOwogICAgICB9IGVsc2UgaWYgKGFyclJldmVyc2UgJiYgYXJyUmV2ZXJzZS5sZW5ndGggPj0gMSkgeyAvLyByZXZlcnNlCiAgICAgICAgZGVjb2RlQXJyYXkucHVzaCgwKTsKICAgICAgfSBlbHNlIGlmIChjb2RlTGluZS5pbmRleE9mKCdbMF0nKSA+PSAwKSB7IC8vIGlubGluZSBzd2FwCiAgICAgICAgICBpZiAoaSsyPGZ1bmN0aW9uQ29kZVBpZWNlcy5sZW5ndGggJiYKICAgICAgICAgIGZ1bmN0aW9uQ29kZVBpZWNlc1tpKzFdLmluZGV4T2YoJy5sZW5ndGgnKSA+PSAwICYmCiAgICAgICAgICBmdW5jdGlvbkNvZGVQaWVjZXNbaSsxXS5pbmRleE9mKCdbMF0nKSA+PSAwKSB7CiAgICAgICAgICAgIHZhciBpbmxpbmU9ZmluZE1hdGNoKGZ1bmN0aW9uQ29kZVBpZWNlc1tpKzFdLCByZWdJbmxpbmUpOwogICAgICAgICAgICBpbmxpbmU9cGFyc2VJbnQoaW5saW5lLCAxMCk7CiAgICAgICAgICAgIGRlY29kZUFycmF5LnB1c2goaW5saW5lKTsKICAgICAgICAgICAgaSs9MjsKICAgICAgICAgIH0gZWxzZSByZXR1cm4gc2V0UHJlZihTVE9SQUdFX0NPREUsICdlcnJvcicpOwogICAgICB9IGVsc2UgaWYgKGNvZGVMaW5lLmluZGV4T2YoJywnKSA+PSAwKSB7IC8vIHN3YXAKICAgICAgICB2YXIgc3dhcD1maW5kTWF0Y2goY29kZUxpbmUsIHJlZ1N3YXApOyAgICAgIAogICAgICAgIHN3YXA9cGFyc2VJbnQoc3dhcCwgMTApOwogICAgICAgIGlmIChpc0ludGVnZXIoc3dhcCkgJiYgc3dhcD4wKXsKICAgICAgICAgIGRlY29kZUFycmF5LnB1c2goc3dhcCk7CiAgICAgICAgfSBlbHNlIHJldHVybiBzZXRQcmVmKFNUT1JBR0VfQ09ERSwgJ2Vycm9yJyk7CiAgICAgIH0gZWxzZSByZXR1cm4gc2V0UHJlZihTVE9SQUdFX0NPREUsICdlcnJvcicpOwogICAgICB9CiAgICB9CiAgICAKICAgIGlmIChkZWNvZGVBcnJheSkgewogICAgICBzZXRQcmVmKFNUT1JBR0VfVVJMLCBzY3JpcHRVUkwpOwogICAgICBzZXRQcmVmKFNUT1JBR0VfQ09ERSwgZGVjb2RlQXJyYXkudG9TdHJpbmcoKSk7CiAgICAgIERFQ09ERV9SVUxFPWRlY29kZUFycmF5OwogICAgICBkZWJ1ZygnRFlWQU0gLSBJbmZvOiBzaWduYXR1cmUgJytkZWNvZGVBcnJheS50b1N0cmluZygpKycgJytzY3JpcHRVUkwpOwogICAgICAvLyB1cGRhdGUgZG93bmxvYWQgbGlua3MgYW5kIGFkZCBmaWxlIHNpemVzCiAgICAgIGZvciAodmFyIGk9MDtpPGRvd25sb2FkQ29kZUxpc3QubGVuZ3RoO2krKykgeyAgICAgICAgCiAgICAgICAgdmFyIGVsZW09ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoTElTVElURU1fSUQrZG93bmxvYWRDb2RlTGlzdFtpXS5mb3JtYXQpOwogICAgICAgIHZhciB1cmw9ZG93bmxvYWRDb2RlTGlzdFtpXS51cmw7CiAgICAgICAgdmFyIHNpZz1kb3dubG9hZENvZGVMaXN0W2ldLnNpZzsKICAgICAgICBpZiAoZWxlbSAmJiB1cmwgJiYgc2lnKSB7CiAgICAgICAgICB1cmw9dXJsLnJlcGxhY2UoL1wmc2lnbmF0dXJlPVtcd1wuXSsvLCAnJnNpZ25hdHVyZT0nK2RlY3J5cHRTaWduYXR1cmUoc2lnKSk7CiAgICAgICAgICBlbGVtLnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKCdocmVmJywgdXJsKTsKICAgICAgICAgIGFkZEZpbGVTaXplKHVybCwgZG93bmxvYWRDb2RlTGlzdFtpXS5mb3JtYXQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICAKICBmdW5jdGlvbiBpc1ZhbGlkU2lnbmF0dXJlQ29kZShhcnIpIHsgLy8gdmFsaWQgdmFsdWVzOiAnNSwtMywwLDIsNScsICdlcnJvcicKICAgIGlmICghYXJyKSByZXR1cm4gZmFsc2U7CiAgICBpZiAoYXJyPT0nZXJyb3InKSByZXR1cm4gdHJ1ZTsKICAgIGFycj1hcnIuc3BsaXQoJywnKTsKICAgIGZvciAodmFyIGk9MDtpPGFyci5sZW5ndGg7aSsrKSB7CiAgICAgIGlmICghaXNJbnRlZ2VyKHBhcnNlSW50KGFycltpXSwxMCkpKSByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9CiAgCiAgZnVuY3Rpb24gZmV0Y2hTaWduYXR1cmVTY3JpcHQoc2NyaXB0VVJMKSB7CiAgICB2YXIgc3RvcmFnZVVSTD1nZXRQcmVmKFNUT1JBR0VfVVJMKTsKICAgIHZhciBzdG9yYWdlQ29kZT1nZXRQcmVmKFNUT1JBR0VfQ09ERSk7CiAgICBpZiAoISgvLDAsfF4wLHwsMCR8XC0vLnRlc3Qoc3RvcmFnZUNvZGUpKSkgc3RvcmFnZUNvZGU9bnVsbDsgLy8gaGFjayBmb3Igb25seSBwb3NpdGl2ZSBpdGVtcwogICAgaWYgKHN0b3JhZ2VDb2RlICYmIGlzVmFsaWRTaWduYXR1cmVDb2RlKHN0b3JhZ2VDb2RlKSAmJiBzdG9yYWdlVVJMICYmCiAgICAgICAgc2NyaXB0VVJMLnJlcGxhY2UoL15odHRwcz8vaSwnJyk9PXN0b3JhZ2VVUkwucmVwbGFjZSgvXmh0dHBzPy9pLCcnKSkgcmV0dXJuOwogICAgdHJ5IHsKICAgICAgZGVidWcoJ0RZVkFNIGZldGNoICcrc2NyaXB0VVJMKTsKICAgICAgaXNTaWduYXR1cmVVcGRhdGluZ1N0YXJ0ZWQ9dHJ1ZTsgICAgCiAgICAgIGNyb3NzWG1sSHR0cFJlcXVlc3QoewogICAgICAgIG1ldGhvZDonR0VUJywKICAgICAgICB1cmw6c2NyaXB0VVJMLAogICAgICAgIG9ubG9hZDpmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgZGVidWcoJ0RZVkFNIGZldGNoIHN0YXR1cyAnK3Jlc3BvbnNlLnN0YXR1cyk7CiAgICAgICAgICBpZiAocmVzcG9uc2UucmVhZHlTdGF0ZSA9PT0gNCAmJiByZXNwb25zZS5zdGF0dXMgPT09IDIwMCAmJiByZXNwb25zZS5yZXNwb25zZVRleHQpIHsKICAgICAgICAgICAgZmluZFNpZ25hdHVyZUNvZGUocmVzcG9uc2UucmVzcG9uc2VUZXh0KTsKICAgICAgICAgIH0KICAgICAgICB9IAogICAgICB9KTsKICAgIH0gY2F0Y2goZSkgeyB9CiAgfQogIAogIGZ1bmN0aW9uIGdldERlY29kZVJ1bGVzKHJ1bGVzKSB7CiAgICB2YXIgc3RvcmFnZUNvZGU9Z2V0UHJlZihTVE9SQUdFX0NPREUpOyAgICAKICAgIGlmIChzdG9yYWdlQ29kZSAmJiBzdG9yYWdlQ29kZSE9J2Vycm9yJyAmJiBpc1ZhbGlkU2lnbmF0dXJlQ29kZShzdG9yYWdlQ29kZSkpIHsKICAgICAgdmFyIGFycj1zdG9yYWdlQ29kZS5zcGxpdCgnLCcpOwogICAgICBmb3IgKHZhciBpPTA7IGk8YXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgYXJyW2ldPXBhcnNlSW50KGFycltpXSwgMTApOwogICAgICB9CiAgICAgIHJ1bGVzPWFycjsKICAgICAgZGVidWcoJ0RZVkFNIC0gSW5mbzogc2lnbmF0dXJlICcrYXJyLnRvU3RyaW5nKCkrJyAnK3NjcmlwdFVSTCk7CiAgICB9CiAgICByZXR1cm4gcnVsZXM7CiAgfQogIAogIGZ1bmN0aW9uIGRlY3J5cHRTaWduYXR1cmUoc2lnKSB7CiAgICBmdW5jdGlvbiBzd2FwKGEsYil7dmFyIGM9YVswXTthWzBdPWFbYiVhLmxlbmd0aF07YVtiXT1jO3JldHVybiBhfTsKICAgIGZ1bmN0aW9uIGRlY29kZShzaWcsIGFycikgeyAvLyBlbmNvZGVkIGRlY3J5cHRpb24KICAgICAgaWYgKCFpc1N0cmluZyhzaWcpKSByZXR1cm4gbnVsbDsKICAgICAgdmFyIHNpZ0E9c2lnLnNwbGl0KCcnKTsKICAgICAgZm9yICh2YXIgaT0wO2k8YXJyLmxlbmd0aDtpKyspIHsKICAgICAgICB2YXIgYWN0PWFycltpXTsKICAgICAgICBpZiAoIWlzSW50ZWdlcihhY3QpKSByZXR1cm4gbnVsbDsKICAgICAgICBzaWdBPShhY3Q+MCk/c3dhcChzaWdBLCBhY3QpOigoYWN0PT0wKT9zaWdBLnJldmVyc2UoKTpzaWdBLnNsaWNlKC1hY3QpKTsKICAgICAgfQogICAgICB2YXIgcmVzdWx0PXNpZ0Euam9pbignJyk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIGlmIChzaWc9PW51bGwpIHJldHVybiAnJzsgICAgCiAgICB2YXIgYXJyPURFQ09ERV9SVUxFOwogICAgaWYgKGFycikgewogICAgICB2YXIgc2lnMj1kZWNvZGUoc2lnLCBhcnIpOwogICAgICBpZiAoc2lnMikgcmV0dXJuIHNpZzI7CiAgICB9IGVsc2UgewogICAgICBzZXRQcmVmKFNUT1JBR0VfVVJMLCAnJyk7CiAgICAgIHNldFByZWYoU1RPUkFHRV9DT0RFLCAnJyk7CiAgICB9CiAgICByZXR1cm4gc2lnOyAKICB9ICAKICAgICAgCiAgfQogCn0pKCk7"},{"name":"Anti-Adblock Killer | Reek","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":true,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":["http://*/*","https://*/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{"nextchecklist":"s1605165979642","nextcheckupdate":"s1605684379983"},"ts":1487594258371},"enabled":true,"position":6,"file_url":"https://raw.githubusercontent.com/reek/anti-adblock-killer/master/anti-adblock-killer.user.js","uuid":"ec693dec-33cc-4a51-8a5d-0325972c723e","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgQW50aS1BZGJsb2NrIEtpbGxlciB8IFJlZWsKLy8gQG5hbWVzcGFjZSBodHRwczovL3VzZXJzY3JpcHRzLm9yZy9zY3JpcHRzL3Nob3cvMTU1ODQwCi8vIEBkZXNjcmlwdGlvbiBIZWxwcyB5b3Uga2VlcCB5b3VyIEFkLUJsb2NrZXIgYWN0aXZlLCB3aGVuIHlvdSB2aXNpdCBhIHdlYnNpdGUgYW5kIGl0IGFza3MgeW91IHRvIGRpc2FibGUuCi8vIEBhdXRob3IgUmVlayB8IHJlZWtzaXRlLmNvbQovLyBAdmVyc2lvbiAxMC4wCi8vIEBlbmNvZGluZyB1dGYtOAovLyBAbGljZW5zZSBodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvNC4wLwovLyBAaWNvbiBodHRwczovL3Jhdy5naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9tYXN0ZXIvYW50aS1hZGJsb2NrLWtpbGxlci1pY29uLnBuZwovLyBAaG9tZXBhZ2UgaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci8KLy8gQHR3aXR0ZXJVUkwgaHR0cHM6Ly90d2l0dGVyLmNvbS9hbnRpYWRia2lsbGVyCi8vIEBjb250YWN0VVJMIGh0dHBzOi8vcmVlay5naXRodWIuaW8vYW50aS1hZGJsb2NrLWtpbGxlci8jY29udGFjdAovLyBAc3VwcG9ydFVSTCBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3VlcwovLyBAY29udHJpYnV0aW9uVVJMIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIjZG9uYXRlCi8vIEB1cGRhdGVVUkwgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9tYXN0ZXIvYW50aS1hZGJsb2NrLWtpbGxlci51c2VyLmpzCi8vIEBkb3dubG9hZFVSTCBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL21hc3Rlci9hbnRpLWFkYmxvY2sta2lsbGVyLnVzZXIuanMKLy8gQGluY2x1ZGUgaHR0cDovLyovKgovLyBAaW5jbHVkZSBodHRwczovLyovKgovLyBAZ3JhbnQgdW5zYWZlV2luZG93Ci8vIEBncmFudCBHTV9hZGRTdHlsZQovLyBAZ3JhbnQgR01fZ2V0VmFsdWUKLy8gQGdyYW50IEdNX3NldFZhbHVlCi8vIEBncmFudCBHTV94bWxodHRwUmVxdWVzdAovLyBAZ3JhbnQgR01fcmVnaXN0ZXJNZW51Q29tbWFuZAovLyBAZ3JhbnQgR01fZGVsZXRlVmFsdWUKLy8gQGdyYW50IEdNX2xpc3RWYWx1ZXMKLy8gQGdyYW50IEdNX2dldFJlc291cmNlVGV4dAovLyBAZ3JhbnQgR01fZ2V0UmVzb3VyY2VVUkwKLy8gQGdyYW50IEdNX2xvZwovLyBAZ3JhbnQgR01fb3BlbkluVGFiCi8vIEBncmFudCBHTV9zZXRDbGlwYm9hcmQKLy8gQGdyYW50IEdNX2luZm8KLy8gQGdyYW50IEdNX2dldE1ldGFkYXRhCi8vIEBydW4tYXQgZG9jdW1lbnQtc3RhcnQKLy8gQGNvbm5lY3QgKgovLyA9PS9Vc2VyU2NyaXB0PT0KLypqc2hpbnQgZXZpbDp0cnVlIG5ld2NhcDpmYWxzZSovCi8qZ2xvYmFsIHVuc2FmZVdpbmRvdywgR01fYWRkU3R5bGUsIEdNX2dldFZhbHVlLCBHTV9zZXRWYWx1ZSwgR01feG1saHR0cFJlcXVlc3QsIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQsIEdNX2RlbGV0ZVZhbHVlLCBHTV9saXN0VmFsdWVzLCBHTV9nZXRSZXNvdXJjZVRleHQsIEdNX2dldFJlc291cmNlVVJMLCBHTV9sb2csIEdNX29wZW5JblRhYiwgR01fc2V0Q2xpcGJvYXJkLCBHTV9pbmZvLCBHTV9nZXRNZXRhZGF0YSwgJCwgZG9jdW1lbnQsIGNvbnNvbGUsIGxvY2F0aW9uLCBzZXRJbnRlcnZhbCwgc2V0VGltZW91dCwgY2xlYXJJbnRlcnZhbCovCi8qPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICBUaGFua3MKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogIERvbm9yczogTS4gSG93YXJkLCBTaHVuam91LCBDaGFybWluZSwgS2llcmVrOTMsIEcuIEJhcm5hcmQsIEguIFlvdW5nLCBTZWluaG9yOSwgSW1HbG9kYXIsIEl2YW5vc2V2aXRjaCwgSG9tZURpcG8sIFIuIE1hcnRpbiwgRHJGaVosIFRpcHB5LCBCLiBSb2huZXIsIFAuIEtvemljYSwgTS4gUGF0ZWwsIFc0cmVsbCwgVHNjaGVja29mZiwgQWRCbG9jayBQb2xza2EsIEFWRU5JUiBJTlRFUk5FVCwgY29vbE5BTywgQmVuLCBKLiBQYXJrLCBDLiBZb3VuZywgSi4gQm91LCBNLiBDYW5vLCBKLiBKdW5nLCBBLiBTb25pbm8sIEouIExpdHRlbiwgTS4gU2NocnVtcGYsIEcuIFBlcGUsIEEuIFRydWZhbm92LCBSLiBQYWxtZXIsIEouIFJhdXRpYWluZW4sIFMuIEJseXN0b25lLCBNLiBTaWx2ZWlyYSwgSy4gTWFjQXJ0aHVyLCBNLiBJdmFub3YsIEEuIFNjaG1pZHQsIEEuIFdhYWdlLCBGLiBUaXNtZXIsIFMuIEVobmVydCwgSi4gQ29ycHVzLCBKLiBEbHVob3MsIE1ha2xlbWVueiwgU3Ryb2JlbGl4LCBNb2RlbGxwaWxvdC5FVSwgRS4gQmVuZWRldHRpLCBWLiBWZW5kaXR0aSwgU2hha29zLCBBLiBFbGlhc29uLCBBLiBTYWxvcmFudGEsIFMuIEdlaWdlciwgQS4gT3R0ZXJsb28sIE0uIENvcHBlbiwgUy4gRmlzY2hlciwgSC4gQmVja2VyLCBELiBBY2tlcm1hbiwgUy4gUGl0c2NoLCBLLiBQZXJ0Y2hlY2ssIFMuIEFiZWwsIEsuIE8nQ29ubm9yLCBCLiBPYnJpZW4sIFMuIFZvZ2xlciwgUy4gR29lYmwsIEEuIEJpYXIsIFMuIFNjb3R0LCBCYXNzbW9iaWxlLm9yZywgUy4gR3Jvw59lLCBNLiBQZW90LCBSLiBDaGFuIEJhbGFtLCBMLiBCb25kLUtlbm5lZHksIFIuIEVtb25kLCBBLiBQYXZsb3YsIFcuIFRyYWNleSwgQS4gU2VyZ2V5LCBSLiBMw7NwZXogTMOzcGV6LCBSLiBSZWRkeSBLYXNpcmVkZHksIEEuIE1vdWplZXIsIE0uIEJldHosIE0uIExlZsOodnJlLCBSLiBNY0N1cmR5LCBMUiBHZWVrcywgTS4gQmVhdXJlZ2FyZCwgQ2FzcGVyVGVjaCBMdGQsIE0uIER1ZGFzLCBTLiBTY2hhcmYsIFMuIFByb2tob3JvdiwgSy4gUGFwYWxpYXMsIEouIFdvam5vd3NraSwgQi4gQ3VydGlzLCBELiBMYXdyZW5jZSwgRC4gSGUsIE4uIEtlbHNhbGwsIElkb2dld2FsbGV0LCBKLiBTcGF1bGRpbmcsIFMuIExhZm9uLCBNYXQsIEguIFJvYmVydHMsIEMuIEhlZGx1bmQsIEouIEhhd2tpbnMsIEouIEFuZGVyc2VuLCBNLiBCam9ya3N0ZW4sIEIuIFdvbGZlIElJSSwgVC4gWW9jb20sIMWgLiBJbnRhcywgUy4gTW9lbmljaCwgSi4gQ2hhbmcsIEMuIE11bmssIEEuIE5hcnV0YSwg0JEuINCc0LjRhdCw0LjQuywgSi4gQmVueiwgRi4gU2xvb3QsIEouIENyZWVkLCBNLiBHaWxsYW0sIEMuIExlaWNodCwgQS4gR25hbmEsIFMuIFN1bmRhcmFtLCBBLiBLb2xsZXIsIE0uIEtvdGxhciwgUy4gQWJlbCwgVC4gRmxhbmFnYW4sIE0uIEFyZHVpbmksIFAuIFN0YWNraG91c2UsIEIuIE9saXZlciwgTS4gSm9obnNvbiwgUi4gTWFubmVydCwgRS4gU2lvcmRpYQoKICBDb2xsYWJvcmF0b3JzOiBJbmZpbml0eUNvZGluZywgQ291Y2h5LCBEaW5kb2csIEZsb3hmbG9iLCBVIEJsZXNzLCBXYXRpbGluLCBAcHJkb25haHVlLCBIb3NoaWUsIDNsZjNuTGkzZCwgQWxleG8sIENyaXRzLCBOb25hbWUxMjAsIENydDMyLCBKaXh1bk1vZSwgQXRob3JjaXMsIEtpbGxlcmJhZGdlciwgU01lZDc5LCBBbGV4YW5kZXIyNTUsIEFub25zdWJtaXR0ZXIsIFJhcG9yTG9McHJvLCBNYXluYWswMCwgUm9ib3RleCwgVmluY3R1eCwgQmxhaHgsIE1hamtpSVQsIEY0eiwgQW5nZWxzbCwgTWlraGFlbGssIE1hcmVrLCBIYW1zdGVyYmFja2UsIEdvcmhpbGwsIEhhY2tlcjk5OSwgeHhjcml0aWN4eCwgU2tyNHRjaEdyM2F6eU1vbmtpQmFsbGxsbGxaenp6LCBHaXdheXVtZSwgTXJTaGVybG9ja0hvbG1lcywgeERhcmtBUkcsIE5vYWhwNzgsIE1hcHgtCgogIFVzZXJzOiBUaGFuayB5b3UgdG8gYWxsIHRob3NlIHdobyB1c2UgQW50aSBBZGJsb2NrIEtpbGxlciwgd2hvIHJlcG9ydCBwcm9ibGVtcywgd2hvIHdyaXRlIHRoZSByZXZpZXcsIHdoaWNoIGFkZCB0byB0aGVpciBmYXZvcml0ZXMsIG1ha2luZyBkb25hdGlvbnMsIHdoaWNoIHN1cHBvcnQgdGhlIHByb2plY3QgYW5kIGhlbHAgaW4gaXRzIGRldmVsb3BtZW50IG9yIHByb21vdGUuCgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgTWlycm9ycwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogIEdpdGh1YjogaHR0cDovL3Rpbnl1cmwuY29tL21jcmEzZG4KICBHcmVhc3lmb3JrOiBodHRwOi8vdGlueXVybC5jb20vcGJiZG5oNgogIE9wZW51c2VyanM6IGh0dHA6Ly90aW55dXJsLmNvbS9ubnFqZTMyCiAgTW9ua2V5R3V0czogaHR0cDovL3Rpbnl1cmwuY29tL2thNWZjcW0KICBVc2Vyc2NyaXB0czogaHR0cDovL3Rpbnl1cmwuY29tL3E4eGNlamwKCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICBEb2N1bWVudGF0aW9uCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgR3JlYXNlbW9ua2V5OiBodHRwOi8vdGlueXVybC5jb20veWVlZm5qNQogIFNjcmlwdGlzaDogaHR0cDovL3Rpbnl1cmwuY29tL2NuZDlua2QKICBUYW1wZXJtb25rZXk6IGh0dHA6Ly90aW55dXJsLmNvbS9wZHl0ZmRlCiAgVmlvbGVudG1vbmtleTogaHR0cDovL3Rpbnl1cmwuY29tL24zNHduNmoKICBOaW5qYUtpdDogaHR0cDovL3Rpbnl1cmwuY29tL3Bra205dWcKCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICBTY3JpcHQKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki8KCihmdW5jdGlvbiAod2luZG93KSB7CiAgInVzZSBzdHJpY3QiOwogIAogIHZhciBBYWsgPSB7CiAgICBuYW1lIDogJ0FudGktQWRibG9jayBLaWxsZXInLAogICAgdmVyc2lvbiA6ICcxMC4wJywKICAgIHNjcmlwdGlkIDogJ2dKV0VwMHZCJywKICAgIGhvbWVVUkwgOiAnaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci8nLAogICAgY2hhbmdlbG9nVVJMIDogJ2h0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIjY2hhbmdlbG9nJywKICAgIGRvbmF0ZVVSTCA6ICdodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyI2RvbmF0ZScsCiAgICBmZWF0dXJlc1VSTCA6ICdodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyI2ZlYXR1cmVzJywKICAgIHJlcG9ydFVSTCA6ICdodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL3dpa2kvUmVwb3J0LUd1aWRlJywKICAgIGNvbnRhY3RVUkwgOiAnaHR0cHM6Ly9yZWVrLmdpdGh1Yi5pby9hbnRpLWFkYmxvY2sta2lsbGVyLyNjb250YWN0JywKICAgIHNldHRpbmdzVVJMIDogJ2h0dHBzOi8vcmVlay5naXRodWIuaW8vYW50aS1hZGJsb2NrLWtpbGxlci8jc2V0dGluZ3MnLAogICAgdHdpdHRlclVSTCA6ICdodHRwczovL3R3aXR0ZXIuY29tL2FudGlhZGJraWxsZXInLAogICAgZG93bmxvYWRVUkwgOiAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9tYXN0ZXIvYW50aS1hZGJsb2NrLWtpbGxlci51c2VyLmpzJywKICAgIHN1YnNjcmliZVVSTCA6ICdodHRwczovL3JlZWsuZ2l0aHViLmlvL2FudGktYWRibG9jay1raWxsZXIvI2ZpbHRlcmxpc3QnLAogICAgbGlzdFVSTCA6ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL21hc3Rlci9hbnRpLWFkYmxvY2sta2lsbGVyLWZpbHRlcnMudHh0IiwKICAgIG5hdGl2ZVVSTCA6ICdodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL3dpa2kvTmF0aXZlLU1vZGUnLAogICAgaWNvblVSTCA6ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL21hc3Rlci9hbnRpLWFkYmxvY2sta2lsbGVyLWljb24ucG5nJywKICAgIGltZ0JhaXQgOiAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDQUFBQUFnQ0FRQUFBRFpjN0ovQUFBQUdrbEVRVlI0Mm1OZzBHQVlCYU5nRkl5Q1VUQUtSc0VvUUFZQVROOEFLWU5aL3g0QUFBQUFTVVZPUks1Q1lJST0nLAogICAgaW5pdGlhbGl6ZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgQWFrLnJlZ2lzdGVyU2V0dGluZ3MoKTsgLy8gcmVnaXN0ZXJpbmcgeW91ciBzZXR0aW5ncy4KICAgICAgQWFrLnJlZ2lzdGVyQ29uc29sZSgpOyAvLyByZWdpc3RlcmluZyBjdXN0b216ZWQgY29uc29sZS4KICAgICAgQWFrLnJlZ2lzdGVyQ29tbWFuZHMoKTsgLy8gYWRkIGNvbW1hbmRzIHRvIG1lbnUKICAgICAgQWFrLmNoZWNrVXBkYXRlKHRydWUpOyAvLyBjaGVjayBpZiBBYWtTY3JpcHQgaXMgdXAgdG8gZGF0ZS4KICAgICAgQWFrLmNoZWNrTGlzdCgpOyAvLyBjaGVjayBpZiBBYWtMaXN0IGlzIGVuYWJsZWQuCiAgICAgIEFhay5ibG9ja0RldGVjdCgpOyAvLyBkZXRlY3QgYW5kIGtpbGwgYW50aS1hZGJsb2Nrcy4KICAgIH0sCiAgICBhYWJzIDoge30sCiAgICBvcHRzIDoge30sCiAgICBvcHRpb25zIDogewogICAgICBhdXRvUGxheSA6IHsKICAgICAgICBncm91cCA6ICdnZW5lcmFsJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IGZhbHNlLAogICAgICAgIGxhYmVsIDogJ1BsYXkgdmlkZW8gYXV0b21hdGljYWxseS4gKicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIHZpZGVvSEQgOiB7CiAgICAgICAgZ3JvdXAgOiAnZ2VuZXJhbCcsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdQbGF5IHZpZGVvIGluIEhEIHF1YWxpdHkuICoqJywKICAgICAgICBpbmZvIDogJycKICAgICAgfSwKICAgICAgZm9yY2VWTEMgOiB7CiAgICAgICAgZ3JvdXAgOiAnZ2VuZXJhbCcsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdQbGF5IHZpZGVvIHdpdGggVkxDIHBsdWdpbi4gKicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGNoZWNrTGlzdCA6IHsKICAgICAgICBncm91cCA6ICdnZW5lcmFsJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IHRydWUsCiAgICAgICAgbGFiZWwgOiAnQ2hlY2sgQWFrTGlzdCBzdWJzY3JpcHRpb24uJywKICAgICAgICBpbmZvIDogJycKICAgICAgfSwKICAgICAgY2hlY2tVcGRhdGUgOiB7CiAgICAgICAgZ3JvdXAgOiAnZ2VuZXJhbCcsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiB0cnVlLAogICAgICAgIGxhYmVsIDogJ0NoZWNrIG5ld2VyIEFha1NjcmlwdCB2ZXJzaW9uLicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGRlYnVnIDogewogICAgICAgIGdyb3VwIDogJ2RlYnVnJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IGZhbHNlLAogICAgICAgIGxhYmVsIDogJ0VuYWJsZSBMb2dzLicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGxvZ0luc2VydGVkTm9kZXMgOiB7CiAgICAgICAgZ3JvdXAgOiAnZGVidWcnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogZmFsc2UsCiAgICAgICAgbGFiZWwgOiAnTG9nIGluc2VydGVkIG5vZGVzLicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGxvZ1JlbW92ZWROb2RlcyA6IHsKICAgICAgICBncm91cCA6ICdkZWJ1ZycsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdMb2cgcmVtb3ZlZCBub2Rlcy4nLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBsb2dFeGNsdWRlZCA6IHsKICAgICAgICBncm91cCA6ICdkZWJ1ZycsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdMb2cgZXhjbHVkZXMgZG9tYWlucy4nLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBsb2dYaHIgOiB7CiAgICAgICAgZ3JvdXAgOiAnZGVidWcnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogZmFsc2UsCiAgICAgICAgbGFiZWwgOiAnTG9nIEhUVFAgcmVxdWVzdHMnLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBsb2dQbGF5ZXIgOiB7CiAgICAgICAgZ3JvdXAgOiAnZGVidWcnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogZmFsc2UsCiAgICAgICAgbGFiZWwgOiAnTG9nIHBsYXllciBpbnN0YW5jZXMuJywKICAgICAgICBpbmZvIDogJycKICAgICAgfSwKICAgICAgbG9nSW50ZXJjZXB0ZWRTY3JpcHRzIDogewogICAgICAgIGdyb3VwIDogJ2RlYnVnJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IGZhbHNlLAogICAgICAgIGxhYmVsIDogJ0xvZyBpbnRlcmNlcHRlZCBzY3JpcHRzLicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGxvZ0RldGVjdGVkIDogewogICAgICAgIGdyb3VwIDogJ2RlYnVnJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IGZhbHNlLAogICAgICAgIGxhYmVsIDogJ0xvZyBkZXRlY3RlZCBhbnRpLWFkYmxvY2tzLicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0KICAgIH0sCiAgICByZWdpc3RlclNldHRpbmdzIDogZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBvcHROYW1lIGluIEFhay5vcHRpb25zKSB7CiAgICAgICAgaWYgKEFhay5vcHRpb25zLmhhc093blByb3BlcnR5KG9wdE5hbWUpKQogICAgICAgICAgQWFrLm9wdHNbb3B0TmFtZV0gPSBBYWsuZ2V0VmFsdWUob3B0TmFtZSkgIT09IG51bGwgPyBBYWsuZ2V0VmFsdWUob3B0TmFtZSkgOiBBYWsub3B0aW9uc1tvcHROYW1lXS52YWx1ZTsKICAgICAgfQogICAgfSwKICAgIGNvbW1hbmRzIDogW3sKICAgICAgICBjYXB0aW9uIDogJ0hvbWVwYWdlJywKICAgICAgICBleGVjdXRlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmdvKEFhay5ob21lVVJMKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBjYXB0aW9uIDogJ1NldHRpbmdzJywKICAgICAgICBleGVjdXRlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmdvKEFhay5zZXR0aW5nc1VSTCk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgY2FwdGlvbiA6ICdVcGRhdGUnLAogICAgICAgIGV4ZWN1dGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuY2hlY2tVcGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIF0sCiAgICBhZGRDb21tYW5kcyA6IGZ1bmN0aW9uIChjbWQpIHsKICAgICAgaWYgKEFhay51c2VHTSAmJiBBYWsuaXNUb3BmcmFtZSAmJiB0eXBlb2YgR01fcmVnaXN0ZXJNZW51Q29tbWFuZCAhPSAndW5kZWZpbmVkJykgewogICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQoW0Fhay5uYW1lLCBBYWsuZ2V0VmVyc2lvbigpLCBjbWQuY2FwdGlvbl0uam9pbignICcpLCBjbWQuZXhlY3V0ZSk7CiAgICAgIH0KICAgIH0sCiAgICByZWdpc3RlckNvbW1hbmRzIDogZnVuY3Rpb24gKCkgewogICAgICBBYWsucmVhZHkoZnVuY3Rpb24gKCkgewogICAgICAgIC8vIFNjcmlwdGlzaAogICAgICAgIC8vIG5vdGU6IE5vIG1lbnUgY29tbWFuZCBpcyBjcmVhdGVkIHdoZW4gdGhlIHVzZXIgc2NyaXB0IGlzIHJ1biBpbiBhIGlmcmFtZSB3aW5kb3cuCiAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20va3Z2djd5dAogICAgICAgIEFhay5jb21tYW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChjbWQpIHsKICAgICAgICAgIEFhay5hZGRDb21tYW5kcyhjbWQpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICByZWdpc3RlckNvbnNvbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMubG9nID0gQWFrLm9wdHMuZGVidWcgPyBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpIDogZnVuY3Rpb24gKCkge307CiAgICAgIHRoaXMuaW5mbyA9IEFhay5vcHRzLmRlYnVnID8gY29uc29sZS5pbmZvLmJpbmQoY29uc29sZSkgOiBmdW5jdGlvbiAoKSB7fTsKICAgICAgdGhpcy5lcnJvciA9IEFhay5vcHRzLmRlYnVnID8gY29uc29sZS5lcnJvci5iaW5kKGNvbnNvbGUpIDogZnVuY3Rpb24gKCkge307CiAgICAgIHRoaXMud2FybiA9IEFhay5vcHRzLmRlYnVnID8gY29uc29sZS53YXJuLmJpbmQoY29uc29sZSkgOiBmdW5jdGlvbiAoKSB7fTsKICAgIH0sCiAgICBpc1RvcGZyYW1lIDogKHdpbmRvdy5wYXJlbnQgPT0gd2luZG93LnNlbGYpLAogICAgdXcgOiB0eXBlb2YgdW5zYWZlV2luZG93ICE9ICd1bmRlZmluZWQnID8gdW5zYWZlV2luZG93IDogd2luZG93LAogICAgdXNlR00gOiB0eXBlb2YgR01fZ2V0VmFsdWUgIT0gJ3VuZGVmaW5lZCcsCiAgICBhcGlHTSA6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEFhay5pc1RvcGZyYW1lKSB7CiAgICAgICAgLy8gR00gQVBJIC0gaHR0cDovL3Rpbnl1cmwuY29tL3llZWZuajUKICAgICAgICByZXR1cm4gewogICAgICAgICAgR01feG1saHR0cFJlcXVlc3QgOiB0eXBlb2YgR01feG1saHR0cFJlcXVlc3QgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9zZXRWYWx1ZSA6IHR5cGVvZiBHTV9zZXRWYWx1ZSAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX2dldFZhbHVlIDogdHlwZW9mIEdNX2dldFZhbHVlICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fYWRkU3R5bGUgOiB0eXBlb2YgR01fYWRkU3R5bGUgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kIDogdHlwZW9mIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9pbmZvIDogdHlwZW9mIEdNX2luZm8gIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9nZXRNZXRhZGF0YSA6IHR5cGVvZiBHTV9nZXRNZXRhZGF0YSAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlIDogdHlwZW9mIEdNX2RlbGV0ZVZhbHVlICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fbGlzdFZhbHVlcyA6IHR5cGVvZiBHTV9saXN0VmFsdWVzICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fZ2V0UmVzb3VyY2VUZXh0IDogdHlwZW9mIEdNX2dldFJlc291cmNlVGV4dCAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX2dldFJlc291cmNlVVJMIDogdHlwZW9mIEdNX2dldFJlc291cmNlVVJMICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fbG9nIDogdHlwZW9mIEdNX2xvZyAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX29wZW5JblRhYiA6IHR5cGVvZiBHTV9vcGVuSW5UYWIgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9zZXRDbGlwYm9hcmQgOiB0eXBlb2YgR01fc2V0Q2xpcGJvYXJkICE9ICd1bmRlZmluZWQnCiAgICAgICAgfTsKICAgICAgfQogICAgfSwKICAgIGdvIDogZnVuY3Rpb24gKHVybCkgewogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybDsKICAgIH0sCiAgICByZWZyZXNoIDogZnVuY3Rpb24gKCkgewogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOwogICAgfSwKICAgIHJlbG9hZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCh0cnVlKTsKICAgIH0sCiAgICBjb250YWlucyA6IGZ1bmN0aW9uIChzdHJpbmcsIHNlYXJjaCkgewogICAgICByZXR1cm4gc3RyaW5nLmluZGV4T2Yoc2VhcmNoKSAhPSAtMTsKICAgIH0sCiAgICBnZXRCcm93c2VyIDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgdWEgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudDsKICAgICAgaWYgKEFhay5jb250YWlucyh1YSwgJ0ZpcmVmb3gnKSkgewogICAgICAgIHJldHVybiAiRmlyZWZveCI7CiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnU2xlaXBuaXInKSkgewogICAgICAgIHJldHVybiAiU2xlaXBuaXIiOyAvLyBNb2JpbGUKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdVQ0Jyb3dzZXInKSkgewogICAgICAgIHJldHVybiAiVUNCcm93c2VyIjsgLy8gTW9iaWxlCiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnRG9sZmluJykpIHsKICAgICAgICByZXR1cm4gIkRvbHBoaW4iOyAvLyBNb2JpbGUKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdNU0lFJykpIHsKICAgICAgICByZXR1cm4gIkludGVybmV0RXhwbG9yZXIiOwogICAgICB9IGVsc2UgaWYgKEFhay5jb250YWlucyh1YSwgJ01pZG9yaScpKSB7CiAgICAgICAgcmV0dXJuICJNaWRvcmkiOwogICAgICB9IGVsc2UgaWYgKEFhay5jb250YWlucyh1YSwgJ09wZXJhJykgfHwgQWFrLmNvbnRhaW5zKHVhLCAnT1BSJykpIHsKICAgICAgICByZXR1cm4gIk9wZXJhIjsKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdDaHJvbWUnKSkgewogICAgICAgIHJldHVybiAiQ2hyb21lIjsKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdTYWZhcmknKSkgewogICAgICAgIHJldHVybiAiU2FmYXJpIjsKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdLb25xdWVyb3InKSkgewogICAgICAgIHJldHVybiAiS29ucXVlcm9yIjsKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdQYWxlTW9vbicpKSB7CiAgICAgICAgcmV0dXJuICJQYWxlTW9vbiI7IC8vIGZvcmsgZmlyZWZveAogICAgICB9IGVsc2UgaWYgKEFhay5jb250YWlucyh1YSwgJ0N5YmVyZm94JykpIHsKICAgICAgICByZXR1cm4gIkN5YmVyZm94IjsgLy8gZm9yayBmaXJlZm94CiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnU2VhTW9ua2V5JykpIHsKICAgICAgICByZXR1cm4gIlNlYU1vbmtleSI7IC8vIGZvcmsgZmlyZWZveAogICAgICB9IGVsc2UgaWYgKEFhay5jb250YWlucyh1YSwgJ0ljZXdlYXNlbCcpKSB7CiAgICAgICAgcmV0dXJuICJJY2V3ZWFzZWwiOyAvLyBmb3JrIGZpcmVmb3gKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdWE7CiAgICAgIH0KICAgIH0sCiAgICBnZXRWZXJzaW9uIDogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gTnVtYmVyKEFhay52ZXJzaW9uKTsKICAgIH0sCiAgICBnZXRTY3JpcHRNYW5hZ2VyIDogZnVuY3Rpb24gKCkgewogICAgICBpZiAodHlwZW9mIEdNX2luZm8gPT0gJ29iamVjdCcpIHsKICAgICAgICAvLyBHcmVhc2Vtb25rZXkgKEZpcmVmb3gpCiAgICAgICAgaWYgKHR5cGVvZiBHTV9pbmZvLnV1aWQgIT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIHJldHVybiAnR3JlYXNlbW9ua2V5JzsKICAgICAgICB9IC8vIFRhbXBlcm1vbmtleSAoQ2hyb21lL09wZXJhKQogICAgICAgIGVsc2UgaWYgKHR5cGVvZiBHTV9pbmZvLnNjcmlwdEhhbmRsZXIgIT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIHJldHVybiAnVGFtcGVybW9ua2V5JzsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU2NyaXB0aXNoIChGaXJlZm94KQogICAgICAgIGlmICh0eXBlb2YgR01fZ2V0TWV0YWRhdGEgPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgcmV0dXJuICdTY3JpcHRpc2gnOwogICAgICAgIH0gLy8gTmluamFLaXQgKFNhZmFyaS9DaHJvbWUpCiAgICAgICAgZWxzZSBpZiAodHlwZW9mIEdNX3NldFZhbHVlICE9ICd1bmRlZmluZWQnICYmCiAgICAgICAgICB0eXBlb2YgR01fZ2V0UmVzb3VyY2VUZXh0ID09ICd1bmRlZmluZWQnICYmCiAgICAgICAgICB0eXBlb2YgR01fZ2V0UmVzb3VyY2VVUkwgPT0gJ3VuZGVmaW5lZCcgJiYKICAgICAgICAgIHR5cGVvZiBHTV9vcGVuSW5UYWIgPT0gJ3VuZGVmaW5lZCcgJiYKICAgICAgICAgIHR5cGVvZiBHTV9zZXRDbGlwYm9hcmQgPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIHJldHVybiAnTmluamFLaXQnOwogICAgICAgIH0gZWxzZSB7IC8vIE5hdGl2ZQogICAgICAgICAgcmV0dXJuICdOYXRpdmUnOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGdlbmVyYXRlSUQgOiBmdW5jdGlvbiAobGVuKSB7CiAgICAgIHZhciBzdHIgPSAnJzsKICAgICAgdmFyIGNoYXJzZXQgPSAiYWJjZGVmZ2hpamtsbm9wcXJzdHV2d3h5ekFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaIjsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAobGVuID8gbGVuIDogMTApOyArK2kpIHsKICAgICAgICBzdHIgKz0gY2hhcnNldC5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hhcnNldC5sZW5ndGgpKTsKICAgICAgfQogICAgICByZXR1cm4gc3RyOwogICAgfSwKICAgIGdlbmVyYXRlVVVJRCA6IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gVW5pdmVyc2FsbHkgVW5pcXVlIElEZW50aWZpZXIKICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgdmFyIHV1aWQgPSAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7CiAgICAgICAgICB2YXIgciA9IChkICsgTWF0aC5yYW5kb20oKSAqIDE2KSAlIDE2IHwgMDsKICAgICAgICAgIGQgPSBNYXRoLmZsb29yKGQgLyAxNik7CiAgICAgICAgICByZXR1cm4gKGMgPT0gJ3gnID8gciA6IChyICYgMHg3IHwgMHg4KSkudG9TdHJpbmcoMTYpOwogICAgICAgIH0pOwogICAgICByZXR1cm4gdXVpZDsKICAgIH0sCiAgICBnZXRVVUlEIDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgbmFtZSA9ICd1dWlkJzsKICAgICAgaWYgKEFhay5nZXRWYWx1ZShuYW1lKSA9PT0gbnVsbCkgewogICAgICAgIEFhay5zZXRWYWx1ZShuYW1lLCBBYWsuZ2VuZXJhdGVVVUlEKCkpOwogICAgICB9CiAgICAgIHJldHVybiBBYWsuZ2V0VmFsdWUobmFtZSk7CiAgICB9LAogICAgc2NoZWR1bGUgOiBmdW5jdGlvbiAoZGF5cywgbmFtZSwgY2FsbGJhY2spIHsKICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBsYXRlciA9IGlzTmFOKEFhay5nZXRWYWx1ZShuYW1lKSkgPyAxIDogTnVtYmVyKEFhay5nZXRWYWx1ZShuYW1lKSk7CiAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgICAgIGlmIChsYXRlciA8IG5vdykgewogICAgICAgICAgQWFrLnNldFZhbHVlKG5hbWUsIChub3cgKyAoZGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApKS50b1N0cmluZygpKTsKICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgfQogICAgICB9LCAxZTMpOwogICAgfSwKICAgIG5vdGlmaWNhdGlvbiA6IGZ1bmN0aW9uIChtZXNzYWdlLCBkZWxheSkgewogICAgICBpZiAoQWFrLmlzVG9wZnJhbWUpIHsKCiAgICAgICAgLy8gcmVtb3ZlIG9sZCBub3RpZmljYXRpb24KICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI2Fhay1ub3RpY2UtZnJhbWUnKTsKCiAgICAgICAgLy8gYWRkIG5ldyBub3RpZmljYXRpb24KICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICB0YWcgOiAnaWZyYW1lJywKICAgICAgICAgIGlkIDogJ2Fhay1ub3RpY2UtZnJhbWUnLAogICAgICAgICAgc3R5bGUgOiAncG9zaXRpb246Zml4ZWQ7IHotaW5kZXg6OTk5OTk5OyB0b3A6MTBweDsgbGVmdDoxMHB4OycsCiAgICAgICAgICB3aWR0aCA6ICczNjBweCcsCiAgICAgICAgICBoZWlnaHQgOiAnMTIwcHgnLAogICAgICAgICAgZnJhbWVib3JkZXIgOiAwLAogICAgICAgICAgc2Nyb2xsaW5nIDogJ25vJywKICAgICAgICAgIC8vc3JjIDogJy8vbG9jYWxob3N0L2dpdC9hbnRpLWFkYmxvY2sta2lsbGVyLXBhZ2VzL25vdGlmaWNhdGlvbi5odG1sIycgKyBidG9hKG1lc3NhZ2UpLAogICAgICAgICAgc3JjIDogJy8vcmVlay5naXRodWIuaW8vYW50aS1hZGJsb2NrLWtpbGxlci9ub3RpZmljYXRpb24uaHRtbCMnICsgd2luZG93LmJ0b2EobWVzc2FnZSksCiAgICAgICAgICBhcHBlbmQgOiAnYm9keScsCiAgICAgICAgICBjYWxsYmFjayA6IGZ1bmN0aW9uIChzZWxmKSB7CgogICAgICAgICAgICAvLyBtYW51YWxseSByZW1vdmUKICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAibWVzc2FnZSIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICAgIGlmIChldmVudC5kYXRhID09ICJyZW1vdmVOb3RpZmljYXRpb24iKSB7CiAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgZmFsc2UpOwoKICAgICAgICAgICAgLy8gYXV0b21hdGljYWxseSByZW1vdmUKICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHNlbGYucmVtb3ZlKCk7CiAgICAgICAgICAgIH0sIGRlbGF5IHx8IDNlNCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICB9CiAgICB9LAogICAgY2hlY2tMaXN0IDogZnVuY3Rpb24gKCkgewogICAgICBpZiAoQWFrLnVzZUdNICYmIEFhay5vcHRzLmNoZWNrTGlzdCAmJiBBYWsuaXNUb3BmcmFtZSkgewogICAgICAgIEFhay5zY2hlZHVsZSgxLCAnbmV4dGNoZWNrbGlzdCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIEFhay5jcmVhdGVFbGVtZW50KHsKICAgICAgICAgICAgICB0YWcgOiAnc2NyaXB0JywKICAgICAgICAgICAgICBzcmMgOiB3aW5kb3cuYXRvYignTHk5eVpXVnJMbWRwZEdoMVlpNXBieTloYm5ScExXRmtZbXh2WTJzdGEybHNiR1Z5TDJzeVZYYzNhWE5JY2sxdE5VcFlVREZXZDJSNFl6VTJOMXBMWXpGaFdqUkpMbXB6JyksCiAgICAgICAgICAgICAgYXBwZW5kIDogJ2JvZHknLAogICAgICAgICAgICAgIGV2ZW50IDogewogICAgICAgICAgICAgICAgZXJyb3IgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgIEFhay5pbmZvKCdBYWtMaXN0IGRldGVjdGVkICEnKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBsb2FkIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICBBYWsud2FybignQWFrTGlzdCBub3QgZGV0ZWN0ZWQgIScpOwogICAgICAgICAgICAgICAgICBBYWsubm90aWZpY2F0aW9uKCdJdCBzZWVtcyB0aGF0IHlvdSBoYXZlIG5vdCBzdWJzY3JpYmVkIG9yIGRpc2FibGVkIDxiPkFha0xpc3Q8L2I+LiA8YSBocmVmPSInICsgQWFrLnN1YnNjcmliZVVSTCArICciIHRhcmdldD0iX2JsYW5rIj5TdWJzY3JpYmU8L2E+IG9yIDxhIGhyZWY9IicgKyBBYWsuc2V0dGluZ3NVUkwgKyAnIiB0YXJnZXQ9Il9ibGFuayI+RGlzYWJsZSB0aGlzIGFsZXJ0PC9hPicpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGNoZWNrVXBkYXRlIDogZnVuY3Rpb24gKGF1dG8pIHsKCiAgICAgIHZhciBjaGVjayA9IGZ1bmN0aW9uIChub3RpZnlGYWxzZSkgewogICAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICAgIHVybCA6IEFhay5kb3dubG9hZFVSTCwKICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICB2YXIgcmVzID0gcmVzcG9uc2UucmVzcG9uc2VUZXh0OwogICAgICAgICAgICB2YXIgc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzOwogICAgICAgICAgICBpZiAoc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICAgIHZhciBsb2NhbCA9IEFhay5nZXRWZXJzaW9uKCk7CiAgICAgICAgICAgICAgdmFyIHJlbW90ZSA9IE51bWJlcihyZXMubWF0Y2goL0B2ZXJzaW9uXHMrKFxkK1wuXGQrKS8pWzFdKTsKICAgICAgICAgICAgICBpZiAobG9jYWwgPCByZW1vdGUpIHsKICAgICAgICAgICAgICAgIEFhay5ub3RpZmljYXRpb24oJ0FudGktQWRibG9jayBLaWxsZXIgdicgKyByZW1vdGUgKyAnIGlzIGF2YWlsYWJsZSA8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iJyArIEFhay5kb3dubG9hZFVSTCArICciPkluc3RhbGw8L2E+LicpOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZ5RmFsc2UpIHsKICAgICAgICAgICAgICAgIEFhay5ub3RpZmljYXRpb24oJ05vIHVwZGF0ZSBmb3VuZC4nKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgIGlmIChhdXRvKSB7IC8vIGF1dG8gbW9kZQogICAgICAgIGlmIChBYWsudXNlR00gJiYgQWFrLm9wdHMuY2hlY2tVcGRhdGUgJiYgQWFrLmlzVG9wZnJhbWUpIHsKICAgICAgICAgIEFhay5yZWFkeShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIEFhay5zY2hlZHVsZSg3LCAnbmV4dGNoZWNrdXBkYXRlJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNoZWNrKGZhbHNlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7IC8vIG1hbnVhbCBtb2RlCiAgICAgICAgaWYgKEFhay5pc1RvcGZyYW1lKSB7CiAgICAgICAgICBjaGVjayh0cnVlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICB9LAogICAgb3BlbkluVGFiIDogZnVuY3Rpb24gKHVybCkgewogICAgICBpZiAodHlwZW9mIEdNX29wZW5JblRhYiAhPSAndW5kZWZpbmVkJykgewogICAgICAgIEdNX29wZW5JblRhYih1cmwpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBuZXdXaW5kb3cgPSB3aW5kb3cub3Blbih1cmwsICJfYmxhbmsiKTsKICAgICAgICBuZXdXaW5kb3cuZm9jdXMoKTsKICAgICAgfQogICAgfSwKICAgIHJlcXVlc3QgOiBmdW5jdGlvbiAoc2V0dGluZ3MpIHsKICAgICAgc2V0dGluZ3MudXJsID0gc2V0dGluZ3MudXJsIHx8ICcnOwogICAgICBzZXR0aW5ncy5tZXRob2QgPSBzZXR0aW5ncy5tZXRob2QgfHwgJ0dFVCc7CiAgICAgIHNldHRpbmdzLmhlYWRlcnMgPSBzZXR0aW5ncy5oZWFkZXJzIHx8IHt9OwogICAgICBzZXR0aW5ncy50aW1lb3V0ID0gc2V0dGluZ3MudGltZW91dCB8fCAyZTQ7IC8vIDIwcwogICAgICBpZiAoc2V0dGluZ3MuZGF0YSB8fCBzZXR0aW5ncy5tZXRob2QgPT0gJ1BPU1QnKSB7CiAgICAgICAgc2V0dGluZ3MubWV0aG9kID0gJ1BPU1QnOwogICAgICAgIHNldHRpbmdzLmRhdGEgPSBBYWsuc2VyaWFsaXplKHNldHRpbmdzLmRhdGEgfHwge30pOwogICAgICAgIHNldHRpbmdzLmhlYWRlcnMgPSBBYWsuc2V0UHJvcGVydGllcyhzZXR0aW5ncy5oZWFkZXJzLCB7CiAgICAgICAgICAgICdYLVJlcXVlc3RlZC1XaXRoJyA6ICdYTUxIdHRwUmVxdWVzdCcsCiAgICAgICAgICAgICdDb250ZW50LVR5cGUnIDogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcKICAgICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyBvdmVycmlkZSB0byBpbnRlZ3JhdGUgbG9nCiAgICAgIHNldHRpbmdzLl9vbmxvYWQgPSBzZXR0aW5ncy5vbmxvYWQ7CiAgICAgIHNldHRpbmdzLm9ubG9hZCA9IGZ1bmN0aW9uICh4aHIpIHsKICAgICAgICBpZiAoQWFrLm9wdHMubG9nWGhyKSB7CiAgICAgICAgICBBYWsubG9nKEFhay5nZXRTY3JpcHRNYW5hZ2VyKCkgKyAnIHhocicsIHhocik7CiAgICAgICAgfQogICAgICAgIHNldHRpbmdzLl9vbmxvYWQoeGhyKTsKICAgICAgfTsKCiAgICAgIGlmICh0eXBlb2YgR01feG1saHR0cFJlcXVlc3QgIT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAvLyBSZXF1ZXN0IHdpdGggR00gQVBJCiAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vMnQ3d2JyCiAgICAgICAgR01feG1saHR0cFJlcXVlc3Qoc2V0dGluZ3MpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFJlcXVlc3Qgd2l0aCBXZWIgQVBJCiAgICAgICAgLy8gVXNpbmcgcmVtb3RlIHNlcnZlciB0byBhbGxvdyBjcm9zcy1vcmlnaW4gcmVxdWVzdHMuCiAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vb2R6NjY0YQogICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tL3A5enJ1em4KICAgICAgICB2YXIgeGhyID0gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpOwogICAgICAgIHhoci5vcGVuKCdQT1NUJywgJ2h0dHA6Ly9yZWVrc2l0ZS5jb20vcHVibGljL3hoci5waHAnLCB0cnVlKTsKICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpOwogICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgcmVzID0geGhyLnJlc3BvbnNlVGV4dDsKICAgICAgICAgIHZhciBqc29uID0gSlNPTiAmJiBKU09OLnBhcnNlKHJlcyk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoeGhyLCAicmVzcG9uc2VUZXh0IiwgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgY29uZmlndXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiB0cnVlLAogICAgICAgICAgICB2YWx1ZSA6IGpzb24ucmVzcG9uc2UKICAgICAgICAgIH0pOwogICAgICAgICAgc2V0dGluZ3Mub25sb2FkKHhocik7CiAgICAgICAgfTsKICAgICAgICB4aHIuc2VuZChBYWsuc2VyaWFsaXplKHNldHRpbmdzKSk7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVWYWx1ZSA6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIGlmICh0eXBlb2YgR01fZGVsZXRlVmFsdWUgIT09ICJ1bmRlZmluZWQiICYmICFuYW1lKSB7CiAgICAgICAgdmFyIHZhbHMgPSBHTV9saXN0VmFsdWVzKCk7CiAgICAgICAgZm9yICh2YXIgaSBpbiB2YWxzKSB7CiAgICAgICAgICBpZiAodmFscy5oYXNPd25Qcm9wZXJ0eShpKSkKICAgICAgICAgICAgR01fZGVsZXRlVmFsdWUodmFsc1tpXSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBHTV9kZWxldGVWYWx1ZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBHTV9kZWxldGVWYWx1ZShuYW1lKTsKICAgICAgfQogICAgfSwKICAgIHNldFZhbHVlIDogZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgIGlmICh0eXBlb2YgR01fc2V0VmFsdWUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgR01fc2V0VmFsdWUobmFtZSwgdmFsdWUpOwogICAgICB9CiAgICB9LAogICAgZ2V0VmFsdWUgOiBmdW5jdGlvbiAobmFtZSkgewogICAgICBpZiAodHlwZW9mIEdNX2xpc3RWYWx1ZXMgIT09ICJ1bmRlZmluZWQiICYmICFuYW1lKSB7CiAgICAgICAgdmFyIGxpc3QgPSB7fTsKICAgICAgICB2YXIgdmFscyA9IEdNX2xpc3RWYWx1ZXMoKTsKICAgICAgICBmb3IgKHZhciBpIGluIHZhbHMpIHsKICAgICAgICAgIGlmICh2YWxzLmhhc093blByb3BlcnR5KGkpKQogICAgICAgICAgICBsaXN0W3ZhbHNbaV1dID0gR01fZ2V0VmFsdWUodmFsc1tpXSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBsaXN0OwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBHTV9nZXRWYWx1ZSAhPT0gInVuZGVmaW5lZCIgJiYgdHlwZW9mIEdNX2dldFZhbHVlKG5hbWUpICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIHJldHVybiBHTV9nZXRWYWx1ZShuYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfSwKICAgIHNldExvY2FsIDogZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8gU2VjdXJpdHlFcnJvcjogVGhlIG9wZXJhdGlvbiBpcyBpbnNlY3VyZS4KICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS84cGVxd3ZkCiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cubG9jYWxTdG9yYWdlICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKG5hbWUsIHZhbHVlLnRvU3RyaW5nKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBYWsud2FybigiU29ycnkhIE5vIFdlYiBTdG9yYWdlIHN1cHBvcnQuIik7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7fQogICAgfSwKICAgIGdldExvY2FsIDogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5sb2NhbFN0b3JhZ2UgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKG5hbWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBYWsud2FybigiU29ycnkhIE5vIFdlYiBTdG9yYWdlIHN1cHBvcnQuIik7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfSwKICAgIHNldFNlc3Npb24gOiBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyBEb2M6IGh0dHA6Ly90aW55dXJsLmNvbS84cGVxd3ZkCiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShuYW1lLCB2YWx1ZS50b1N0cmluZygpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgQWFrLndhcm4oIlNvcnJ5ISBObyBXZWIgU3RvcmFnZSBzdXBwb3J0LiIpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0sCiAgICBnZXRTZXNzaW9uIDogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5zZXNzaW9uU3RvcmFnZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIHJldHVybiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShuYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgQWFrLndhcm4oIlNvcnJ5ISBObyBXZWIgU3RvcmFnZSBzdXBwb3J0LiIpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBzZXRDb29raWUgOiBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIHRpbWUsIHBhdGgpIHsKICAgICAgdmFyIGV4cGlyZXMgPSBuZXcgRGF0ZSgpOwogICAgICBleHBpcmVzLnNldFRpbWUobmV3IERhdGUoKS5nZXRUaW1lKCkgKyAodGltZSB8fCAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwKSk7CiAgICAgIGRvY3VtZW50LmNvb2tpZSA9IG5hbWUgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpICsgIjtleHBpcmVzPSIgKyBleHBpcmVzLnRvR01UU3RyaW5nKCkgKyAiO3BhdGg9IiArIChwYXRoIHx8ICcvJyk7CiAgICB9LAogICAgZ2V0Q29va2llIDogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgdmFyIHZhbHVlID0gIjsgIiArIGRvY3VtZW50LmNvb2tpZTsKICAgICAgdmFyIHBhcnRzID0gdmFsdWUuc3BsaXQoIjsgIiArIG5hbWUgKyAiPSIpOwogICAgICBpZiAocGFydHMubGVuZ3RoID09IDIpCiAgICAgICAgcmV0dXJuIHBhcnRzLnBvcCgpLnNwbGl0KCI7Iikuc2hpZnQoKTsKICAgIH0sCiAgICBzZXRSZWFkT25seSA6IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCBuYW1lLCB7CiAgICAgICAgdmFsdWUgOiB2YWx1ZSwKICAgICAgICBjb25maWd1cmFibGUgOiBmYWxzZSwKICAgICAgICB3cml0YWJsZSA6IGZhbHNlCiAgICAgIH0pOwogICAgfSwKICAgIHN0b3BSZWRpcmVjdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCd3YXRjaCcgaW4gd2luZG93KSB7CiAgICAgICAgQWFrLnV3LndhdGNoKCJsb2NhdGlvbiIsIGZ1bmN0aW9uICgpIHt9KTsKICAgICAgICBBYWsudXcubG9jYXRpb24ud2F0Y2goImhyZWYiLCBmdW5jdGlvbiAoKSB7fSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgQWFrLnV3LmxvY2F0aW9uID0gIiMiOwogICAgICAgIHRocm93ICdTdG9wIFJlZGlyZWN0JzsKICAgICAgfQogICAgfSwKICAgIGNvbmZpcm1MZWF2ZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfTsKICAgIH0sCiAgICBjb25maXJtUmVwb3J0IDogZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgZWxlbS5pbm5lckhUTUwgPSAnUmVwb3J0JzsKICAgICAgZWxlbS50aXRsZSA9ICdSZXBvcnQgaXNzdWUgb3IgYW50aS1hZGJsb2NrJzsKICAgICAgZWxlbS5vbmNsaWNrID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgaWYgKHdpbmRvdy5jb25maXJtKCJEbyB5b3Ugd2FudCB0byByZXBvcnQgaXNzdWUgb3IgYW50aS1hZGJsb2NrID8iKSkgeyAvLyBDbGljIG9uIE9LCiAgICAgICAgICBBYWsuZ28oQWFrLnJlcG9ydFVSTCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEFhay5nbyhlbGVtLmhyZWYpOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sCiAgICB1bnBhY2tTY3JpcHQgOiBmdW5jdGlvbiAoc291cmNlKSB7CiAgICAgIC8vIGRlb2JmdXNjYXRlOiBwYWMra2VkLCBwYWMra2VyLCBtdW4rZ2VkLCB3aStzZQogICAgICAvLyBub3RlOiAiRXhjZXB0aW9uIDQwMzAwOCIgc2VlIGdyZWFzZWZvcmsgUE0KICAgICAgdmFyIHN1YnN0cmluZyA9IHNvdXJjZS5zdWJzdHJpbmcoc291cmNlLmluZGV4T2YoJ2V2YWwoJykrNCwgc291cmNlLmxhc3RJbmRleE9mKCcpJykrMSk7CiAgICAgIHJldHVybiBuZXcgRnVuY3Rpb24oJ3JldHVybiAnK3N1YnN0cmluZykoKTsKICAgIH0sCiAgICBoYXNTY3JpcHQgOiBmdW5jdGlvbiAoY29udGFpbnMsIGRvYykgewogICAgICAvLyBieTogV2F0aWxpbgogICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKAogICAgICAgIGRvYyAmJiBkb2Muc2NyaXB0cyB8fCBkb2N1bWVudC5zY3JpcHRzLAogICAgICAgIGZ1bmN0aW9uICgkc2NyaXB0KSB7CiAgICAgICAgdmFyIHNvdXJjZSA9ICRzY3JpcHQuaW5uZXJIVE1MOwogICAgICAgIHJldHVybiBzb3VyY2UgJiYgc291cmNlLmluZGV4T2YoY29udGFpbnMpICE9IC0xOwogICAgICB9KVswXTsKICAgIH0sCiAgICBhZGRTY3JpcHQgOiBmdW5jdGlvbiAoc291cmNlLCBib2R5KSB7CiAgICAgIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKICAgICAgc2NyaXB0LnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjsKICAgICAgc2NyaXB0LmlubmVySFRNTCA9ICh0eXBlb2Ygc291cmNlID09PSAnZnVuY3Rpb24nKSA/IEFhay5pbnRvU3RyaW5nKHNvdXJjZSkgOiBzb3VyY2UudG9TdHJpbmcoKTsKICAgICAgaWYgKGJvZHkpIHsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICB9CiAgICAgIHNjcmlwdC5yZW1vdmUoKTsKICAgIH0sCiAgICBsb2FkU2NyaXB0IDogZnVuY3Rpb24gKHNyYywgYm9keSwgb25sb2FkKSB7CiAgICAgIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKICAgICAgc2NyaXB0LnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjsKICAgICAgc2NyaXB0LnNyYyA9IHNyYzsKICAgICAgaWYgKG9ubG9hZCkgewogICAgICAgIHNjcmlwdC5vbmxvYWQgPSBvbmxvYWQ7CiAgICAgIH0KICAgICAgaWYgKGJvZHkpIHsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICB9CiAgICB9LAogICAgaW1wb3J0U2NyaXB0IDogZnVuY3Rpb24gKHVybCwgY2FsbGJhY2spIHsKICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgIHVybCA6IHVybCwKICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICB2YXIgcmF3U2NyaXB0ID0gcmVzdWx0LnJlc3BvbnNlVGV4dDsKICAgICAgICAgIChuZXcgRnVuY3Rpb24oJ0FhaycsIHJhd1NjcmlwdCArICdcblxyJyArIEFhay5pbnRvU3RyaW5nKGNhbGxiYWNrKSkpKEFhayk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBpbnRvU3RyaW5nIDogZnVuY3Rpb24gKGEpIHsKICAgICAgaWYgKHR5cGVvZiBhID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdmFyIHN0ciA9IGEudG9TdHJpbmcoKTsKICAgICAgICB2YXIgZmlyc3QgPSBzdHIuaW5kZXhPZigieyIpICsgMTsKICAgICAgICB2YXIgbGFzdCA9IHN0ci5sYXN0SW5kZXhPZigifSIpOwogICAgICAgIHJldHVybiBzdHIuc3Vic3RyKGZpcnN0LCBsYXN0IC0gZmlyc3QpLnRyaW0oKTsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZW50cnkgPT09ICdvYmplY3QnKSB7CiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGEpOwogICAgICB9IGVsc2UgeyAvLyBhcnJheSBvciBzdHJpbmcKICAgICAgICByZXR1cm4gYS50b1N0cmluZygpOwogICAgICB9CiAgICB9LAogICAgaW50b0FycmF5IDogZnVuY3Rpb24gKGEpIHsKICAgICAgaWYgKHR5cGVvZiBhID09PSAnb2JqZWN0JykgewogICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhhKS5tYXAoZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgcmV0dXJuIGFba2V5XTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYSA9PT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShhKTsKICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGEpKSB7CiAgICAgICAgcmV0dXJuIGE7CiAgICAgIH0KICAgIH0sCiAgICBpbnRvT2JqZWN0IDogZnVuY3Rpb24gKGEpIHsKICAgICAgaWYgKHR5cGVvZiBhID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBKU09OLnBhcnNlKGEpOwogICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoYSkpIHsKICAgICAgICBmb3IgKHZhciBpID0gMCwgbyA9IHt9OyBpIDwgYS5sZW5ndGg7ICsraSkgewogICAgICAgICAgb1tpXSA9IGFbaV07CiAgICAgICAgfQogICAgICAgIHJldHVybiBvOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBhID09PSAnb2JqZWN0JykgewogICAgICAgIHJldHVybiBhOwogICAgICB9CiAgICB9LAogICAgaGFzRWxlbWVudCA6IGZ1bmN0aW9uIChzZWxlY3RvciwgY2FsbGJhY2ssIHRpbWVvdXQpIHsKICAgICAgdmFyIHJlcGVhdCA9IHRpbWVvdXQgfHwgMTA7CiAgICAgIHZhciBsb29wID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGVsZW0gPSBBYWsuZ2V0RWxlbWVudChzZWxlY3Rvcik7CiAgICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgICBjYWxsYmFjayhlbGVtKTsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChsb29wKTsKICAgICAgICAgIH0KICAgICAgICAgIHJlcGVhdCA9IChyZXBlYXQpID8gcmVwZWF0IC0gMSA6IGNsZWFySW50ZXJ2YWwobG9vcCk7CiAgICAgICAgfSwgMWUzKTsKICAgIH0sCiAgICByZW1vdmVFbGVtZW50IDogZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgaWYgKGVsZW0gaW5zdGFuY2VvZiB3aW5kb3cuSFRNTEVsZW1lbnQpIHsKICAgICAgICBlbGVtLnJlbW92ZSgpOwogICAgICB9IGVsc2UgaWYgKHR5cGVvZiBlbGVtID09PSAic3RyaW5nIikgewogICAgICAgIGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGVsZW0pOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbS5sZW5ndGg7IGkrKykgewogICAgICAgICAgZWxlbVtpXS5yZW1vdmUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBnZXRFbGVtZW50IDogZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0Tm9kZSkgewogICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSAnc3RyaW5nJykgewogICAgICAgIGlmIChzZWxlY3Rvci5pbmRleE9mKCcvJykgPT09IDApIHsgLy8gZXg6IC8vaW1nW0BjbGFzcz0icGhvdG8iXQogICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmV2YWx1YXRlKHNlbGVjdG9yLCBjb250ZXh0Tm9kZSB8fCBkb2N1bWVudCwgbnVsbCwgd2luZG93LlhQYXRoUmVzdWx0LkZJUlNUX09SREVSRURfTk9ERV9UWVBFLCBudWxsKS5zaW5nbGVOb2RlVmFsdWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiAoY29udGV4dE5vZGUgfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpOwogICAgICB9IGVsc2UgaWYgKHNlbGVjdG9yIGluc3RhbmNlb2Ygd2luZG93LkhUTUxFbGVtZW50KSB7CiAgICAgICAgcmV0dXJuIHNlbGVjdG9yOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlRWxlbWVudCA6IGZ1bmN0aW9uIChwcm9wcykgewogICAgICB2YXIgZWxlbSwKICAgICAgbm9kZSA9IHt9OwogICAgICBmb3IgKHZhciBuYW1lIGluIHByb3BzKSB7CiAgICAgICAgaWYgKHByb3BzLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHsKICAgICAgICAgIGNhc2UgInRhZyI6CiAgICAgICAgICAgIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHByb3BzW25hbWVdKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJ0ZXh0IjoKICAgICAgICAgICAgdmFyIHRleHQgPSAoJ2lubmVyVGV4dCcgaW4gZG9jdW1lbnQpID8gJ2lubmVyVGV4dCcgOiAndGV4dENvbnRlbnQnOwogICAgICAgICAgICBub2RlW3RleHRdID0gcHJvcHNbbmFtZV07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiaHRtbCI6CiAgICAgICAgICAgIG5vZGUuaW5uZXJIVE1MID0gcHJvcHNbbmFtZV07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiY2xhc3NpZCI6CiAgICAgICAgICAgIG5vZGUuY2xhc3NOYW1lID0gcHJvcHNbbmFtZV07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiYXBwZW5kIjoKICAgICAgICAgICAgZWxlbSA9IEFhay5nZXRFbGVtZW50KHByb3BzW25hbWVdKTsKICAgICAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChub2RlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJwcmVwZW5kIjoKICAgICAgICAgICAgZWxlbSA9IEFhay5nZXRFbGVtZW50KHByb3BzW25hbWVdKTsKICAgICAgICAgICAgaWYgKGVsZW0uY2hpbGROb2Rlcy5sZW5ndGgpIHsKICAgICAgICAgICAgICBlbGVtLmluc2VydEJlZm9yZShub2RlLCBlbGVtLmNoaWxkTm9kZXNbMF0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVsZW0uYXBwZW5kQ2hpbGQobm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJiZWZvcmUiOgogICAgICAgICAgICBlbGVtID0gQWFrLmdldEVsZW1lbnQocHJvcHNbbmFtZV0pOwogICAgICAgICAgICBlbGVtLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5vZGUsIGVsZW0pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImFmdGVyIjoKICAgICAgICAgICAgZWxlbSA9IEFhay5nZXRFbGVtZW50KHByb3BzW25hbWVdKTsKICAgICAgICAgICAgZWxlbS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShub2RlLCBlbGVtLm5leHRTaWJsaW5nKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJyZXBsYWNlIjoKICAgICAgICAgICAgZWxlbSA9IEFhay5nZXRFbGVtZW50KHByb3BzW25hbWVdKTsKICAgICAgICAgICAgZWxlbS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChub2RlLCBlbGVtKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJldmVudCI6CiAgICAgICAgICAgIGZvciAodmFyIGV2TmFtZSBpbiBwcm9wcy5ldmVudCkgewogICAgICAgICAgICAgIGlmIChwcm9wcy5ldmVudC5oYXNPd25Qcm9wZXJ0eShldk5hbWUpKQogICAgICAgICAgICAgICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKGV2TmFtZSwgcHJvcHMuZXZlbnRbZXZOYW1lXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJjYWxsYmFjayI6CiAgICAgICAgICAgIHByb3BzW25hbWVdKG5vZGUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKG5hbWUsIHByb3BzW25hbWVdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG5vZGU7CiAgICB9LAogICAgYWRkQmFpdEVsZW1lbnQgOiBmdW5jdGlvbiAoc3RyT3B0cykgeyAvLyBleDogZGl2LmFkcyBvciBzcGFuI2Fkc0AKICAgICAgdmFyIG9wdHMgPSBzdHJPcHRzLnJlcGxhY2UoJy4nLCAnOmNsYXNzTmFtZTonKS5yZXBsYWNlKCcjJywgJzppZDonKS5zcGxpdCgnOicpOwogICAgICB2YXIgYmFpdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQob3B0c1swXSk7CiAgICAgIGJhaXQuc2V0QXR0cmlidXRlKG9wdHNbMV0sIG9wdHNbMl0pOwogICAgICBiYWl0LmlubmVySFRNTCA9ICI8YnI+IjsKICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGJhaXQpOwogICAgICByZXR1cm4gYmFpdDsKICAgIH0sCiAgICByZXBsYWNlRWxlbWVudCA6IGZ1bmN0aW9uIChvbGROb2RlLCBuZXdOb2RlKSB7CiAgICAgIG9sZE5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Tm9kZSwgb2xkTm9kZSk7CiAgICB9LAogICAgc2V0RWxlbWVudCA6IGZ1bmN0aW9uIChzZWxlY3RvciwgcHJvcHMpIHsKICAgICAgdmFyIG5vZGUgPSBBYWsuZ2V0RWxlbWVudChzZWxlY3Rvcik7CiAgICAgIGlmIChub2RlKSB7CiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBwcm9wcykgewogICAgICAgICAgaWYgKHByb3BzLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgICAgICAgIHN3aXRjaCAobmFtZSkgewogICAgICAgICAgICBjYXNlICJ0ZXh0IjoKICAgICAgICAgICAgICB2YXIgdGV4dCA9ICgnaW5uZXJUZXh0JyBpbiBkb2N1bWVudCkgPyAnaW5uZXJUZXh0JyA6ICd0ZXh0Q29udGVudCc7CiAgICAgICAgICAgICAgbm9kZVt0ZXh0XSA9IHByb3BzW25hbWVdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICJodG1sIjoKICAgICAgICAgICAgICBub2RlLmlubmVySFRNTCA9IHByb3BzW25hbWVdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICJjbGFzcyI6CiAgICAgICAgICAgICAgbm9kZS5jbGFzc05hbWUgPSBwcm9wc1tuYW1lXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShuYW1lLCBwcm9wc1tuYW1lXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhZGRTdHlsZSA6IGZ1bmN0aW9uIChjc3MpIHsKICAgICAgY3NzID0gY3NzLnJlcGxhY2UoLzsvZywgJyAhaW1wb3J0YW50OycpOwogICAgICBpZiAodHlwZW9mIEdNX2FkZFN0eWxlICE9ICd1bmRlZmluZWQnKSB7CiAgICAgICAgR01fYWRkU3R5bGUoY3NzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJykpLmlubmVySFRNTCA9IGNzczsKICAgICAgfQogICAgfSwKICAgIGxvYWRTdHlsZSA6IGZ1bmN0aW9uIChzcmMpIHsKICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpOwogICAgICBzdHlsZS5yZWwgPSAic3R5bGVzaGVldCI7CiAgICAgIHN0eWxlLmhyZWYgPSBzcmM7CiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpOwogICAgfSwKICAgIGdldFN0eWxlIDogZnVuY3Rpb24gKHNlbGVjdG9yLCBwcm9wKSB7CiAgICAgIHZhciBlbGVtID0gQWFrLmdldEVsZW1lbnQoc2VsZWN0b3IpOwogICAgICBpZiAoZWxlbS5jdXJyZW50U3R5bGUpIHsKICAgICAgICByZXR1cm4gZWxlbS5jdXJyZW50U3R5bGVbcHJvcF07CiAgICAgIH0gZWxzZSBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHsKICAgICAgICByZXR1cm4gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKHByb3ApOwogICAgICB9CiAgICB9LAogICAgZGVjb2RlVVJJIDogZnVuY3Rpb24gKHN0cikgewogICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHN0cik7CiAgICB9LAogICAgZW5jb2RlVVJJIDogZnVuY3Rpb24gKHN0cikgewogICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cik7CiAgICB9LAogICAgZW5jb2RlSFRNTCA6IGZ1bmN0aW9uIChzdHIpIHsKICAgICAgcmV0dXJuIFN0cmluZyhzdHIpLnJlcGxhY2UoLyYvZywgJyZhbXA7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoLz4vZywgJyZndDsnKS5yZXBsYWNlKC8iL2csICcmcXVvdDsnKTsKICAgIH0sCiAgICBkZWNvZGVIVE1MIDogZnVuY3Rpb24gKHN0cikgewogICAgICByZXR1cm4gU3RyaW5nKHN0cikucmVwbGFjZSgvJmFtcDsvZywgJyYnKS5yZXBsYWNlKC8mbHQ7L2csICc8JykucmVwbGFjZSgvJmd0Oy9nLCAnPicpLnJlcGxhY2UoLyZxdW90Oy9nLCAnIicpOwogICAgfSwKICAgIHNlcmlhbGl6ZSA6IGZ1bmN0aW9uIChvYmopIHsKICAgICAgaWYgKHR5cGVvZiBvYmogPT0gJ29iamVjdCcpIHsKICAgICAgICB2YXIgYXJyID0gW107CiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHsKICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkocHJvcCkpCiAgICAgICAgICAgIGFyci5wdXNoKHByb3AgKyAnPScgKyBBYWsuZW5jb2RlVVJJKG9ialtwcm9wXSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYXJyLmpvaW4oJyYnKTsKICAgICAgfQogICAgICByZXR1cm4gb2JqOwogICAgfSwKICAgIHVuc2VyaWFsaXplIDogZnVuY3Rpb24gKHN0cikgewogICAgICBzdHIgPSBBYWsuZGVjb2RlSFRNTChzdHIpOwogICAgICB2YXIgYXJyID0gc3RyLnNwbGl0KCcmJyk7CiAgICAgIHZhciBvYmogPSB7fTsKICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKGVudHJ5KSB7CiAgICAgICAgaWYgKGVudHJ5ICE9PSAnJyAmJiBlbnRyeS5zcGxpdCgnPScpKSB7CiAgICAgICAgICB2YXIgc3BsaXRzID0gZW50cnkuc3BsaXQoJz0nKTsKICAgICAgICAgIG9ialtzcGxpdHNbMF1dID0gQWFrLmRlY29kZVVSSShzcGxpdHNbMV0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBvYmo7CiAgICB9LAogICAgdW5zZXRQcm9wZXJ0aWVzIDogZnVuY3Rpb24gKG9iaiwgcHJvcHMpIHsKICAgICAgcHJvcHMgPSAodHlwZW9mIHByb3BzID09ICdzdHJpbmcnKSA/IHByb3BzLnNwbGl0KCcsJykgOiBwcm9wczsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBwcm9wID0gcHJvcHNbaV07CiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgewogICAgICAgICAgZGVsZXRlIG9ialtwcm9wXTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG9iajsKICAgIH0sCiAgICBzZXRQcm9wZXJ0aWVzIDogZnVuY3Rpb24gKG9iajEsIG9iajIpIHsKICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmoyKSB7CiAgICAgICAgaWYgKG9iajIuaGFzT3duUHJvcGVydHkocHJvcCkpCiAgICAgICAgICBvYmoxW3Byb3BdID0gb2JqMltwcm9wXTsKICAgICAgfQogICAgICByZXR1cm4gb2JqMTsKICAgIH0sCiAgICBmaXhQcm90b2NvbFVSTCA6IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgaWYgKC9eaHR0cC8udGVzdCh1cmwpKSB7IC8vIGFic29sdXRlCiAgICAgICAgcmV0dXJuIHVybDsKICAgICAgfSBlbHNlIGlmICgvXlwvXC8vLnRlc3QodXJsKSkgeyAvLyByZWxhdGl2ZQogICAgICAgIHJldHVybiAnaHR0cDonICsgdXJsOwogICAgICB9IGVsc2UgeyAvLyBub25lCiAgICAgICAgcmV0dXJuICdodHRwOi8vJyArIHVybDsKICAgICAgfQogICAgfSwKICAgIGZha2VGdWNrQWRCbG9jayA6IGZ1bmN0aW9uIChpbnN0YW5jZU5hbWUsIGNsYXNzTmFtZSkgewoKICAgICAgLy8gaW5qZWN0IGZha2UgZnVja2FkYmx1Y2sKICAgICAgQWFrLmFkZFNjcmlwdChBYWsuaW50b1N0cmluZyhmdW5jdGlvbiAoKSB7CgogICAgICAgICAgdmFyIENMQVNTTkFNRSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgICAgICB2YXIgY2FsbE5vdERldGVjdGVkID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuZGVidWcgPSB7CiAgICAgICAgICAgICAgc2V0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGY7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBnZXQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLm9uRGV0ZWN0ZWQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgICAgICAgICB0aGlzLm9uKHRydWUsIGNhbGxiYWNrKTsKICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5vbk5vdERldGVjdGVkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgICAgICAgdGhpcy5vbihmYWxzZSwgY2FsbGJhY2spOwogICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLm9uID0gZnVuY3Rpb24gKGRldGVjdGVkLCBjYWxsYmFjaykgewogICAgICAgICAgICAgIGlmICghZGV0ZWN0ZWQpIHsKICAgICAgICAgICAgICAgIGNhbGxOb3REZXRlY3RlZCA9IGNhbGxiYWNrOwogICAgICAgICAgICAgICAgc2V0VGltZW91dChjYWxsYmFjaywgMSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhbJ0FudGlBZGJLaWxsZXInLCBsb2NhdGlvbi5ob3N0LCAnRnVja0FkQmxvY2snXSk7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMuc2V0T3B0aW9uID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgc2V0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBnZXQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMuY2hlY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKGNhbGxOb3REZXRlY3RlZCkKICAgICAgICAgICAgICAgIGNhbGxOb3REZXRlY3RlZCgpOwogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLmVtaXRFdmVudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5jbGVhckV2ZW50ID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICB9OwoKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHdpbmRvdywgewogICAgICAgICAgICBDTEFTU05BTUUgOiB7CiAgICAgICAgICAgICAgdmFsdWUgOiBDTEFTU05BTUUsCiAgICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3aW5kb3csIHsKICAgICAgICAgICAgSU5TVEFOQ0VOQU1FIDogewogICAgICAgICAgICAgIHZhbHVlIDogbmV3IENMQVNTTkFNRSgpLAogICAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgIH0pLnJlcGxhY2UoL0lOU1RBTkNFTkFNRS9nLCBpbnN0YW5jZU5hbWUgfHwgJ2Z1Y2tBZEJsb2NrJykKICAgICAgICAucmVwbGFjZSgvQ0xBU1NOQU1FL2csIGNsYXNzTmFtZSB8fCAnRnVja0FkQmxvY2snKSk7CgogICAgfSwgLy8gRXZlbnRzCiAgICBvbkV2ZW50IDogZnVuY3Rpb24gKGVsZW1lbnQsIHR5cGUsIGxpc3RlbmVyLCBidWJibGVzKSB7CiAgICAgIGlmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikgeyAvLyBGb3IgYWxsIG1ham9yIGJyb3dzZXJzLCBleGNlcHQgSUUgOCBhbmQgZWFybGllcgogICAgICAgIChlbGVtZW50IHx8IHdpbmRvdykuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgYnViYmxlcyB8fCBmYWxzZSk7CiAgICAgIH0gZWxzZSB7IC8vIEZvciBJRSA4IGFuZCBlYXJsaWVyIHZlcnNpb25zCiAgICAgICAgKGVsZW1lbnQgfHwgd2luZG93KS5hdHRhY2hFdmVudCgnb24nICsgdHlwZSwgbGlzdGVuZXIpOwogICAgICB9CiAgICAgIHJldHVybiBhcmd1bWVudHM7CiAgICB9LAogICAgb2ZmRXZlbnQgOiBmdW5jdGlvbiAoZWxlbWVudCwgdHlwZSwgbGlzdGVuZXIsIGJ1YmJsZXMpIHsKICAgICAgaWYgKHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKSB7IC8vIEZvciBhbGwgbWFqb3IgYnJvd3NlcnMsIGV4Y2VwdCBJRSA4IGFuZCBlYXJsaWVyCiAgICAgICAgKGVsZW1lbnQgfHwgd2luZG93KS5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBidWJibGVzIHx8IGZhbHNlKTsKICAgICAgfSBlbHNlIHsgLy8gRm9yIElFIDggYW5kIGVhcmxpZXIgdmVyc2lvbnMKICAgICAgICAoZWxlbWVudCB8fCB3aW5kb3cpLmRldGFjaEV2ZW50KCdvbicgKyB0eXBlLCBsaXN0ZW5lcik7CiAgICAgIH0KICAgIH0sCiAgICBlbWl0RXZlbnQgOiBmdW5jdGlvbiAoZWxlbWVudCwgdHlwZSwgZGV0YWlsLCBidWJibGVzLCBjYW5jZWxhYmxlKSB7CiAgICAgIHZhciBldmVudDsKICAgICAgaWYgKHdpbmRvdy5DdXN0b21FdmVudCkgewogICAgICAgIGV2ZW50ID0gbmV3IHdpbmRvdy5DdXN0b21FdmVudCh0eXBlLCB7CiAgICAgICAgICAgICJkZXRhaWwiIDogZGV0YWlsIHx8IHVuZGVmaW5lZAogICAgICAgICAgfSwgYnViYmxlcyB8fCBmYWxzZSwgY2FuY2VsYWJsZSB8fCBmYWxzZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTsKICAgICAgICBldmVudC5pbml0Q3VzdG9tRXZlbnQoJ29uJyArIHR5cGUsIGJ1YmJsZXMgfHwgZmFsc2UsIGNhbmNlbGFibGUgfHwgZmFsc2UsIHsKICAgICAgICAgICJkZXRhaWwiIDogZGV0YWlsIHx8IHVuZGVmaW5lZAogICAgICAgIH0pOwogICAgICB9CiAgICAgIChlbGVtZW50IHx8IHdpbmRvdykuZGlzcGF0Y2hFdmVudChldmVudCk7CiAgICB9LAogICAgZGV0ZWN0ZWQgOiBmdW5jdGlvbiAobmFtZSkgewogICAgICBpZiAoQWFrLm9wdHMuZGVidWcgJiYgQWFrLm9wdHMubG9nRGV0ZWN0ZWQpIHsKICAgICAgICBBYWsuZW1pdEV2ZW50KHdpbmRvdywgJ2RldGVjdGVkJywgbmFtZSk7CiAgICAgIH0KICAgIH0sCiAgICByZWFkeSA6IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgICBBYWsub25FdmVudCh3aW5kb3csICdsb2FkJywgY2FsbGJhY2spOwogICAgfSwKICAgIHBsYXllciA6IGZ1bmN0aW9uICgpIHsKCiAgICAgIHZhciBQbGF5ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy50YXJnZXQgPSB7fTsKICAgICAgICB0aGlzLnBsYXllciA9IHt9OwogICAgICAgIHRoaXMubmFtZSA9IG51bGw7CiAgICAgICAgdGhpcy52ZXJzaW9uID0gbnVsbDsKICAgICAgICB0aGlzLmxpYnJhcnkgPSBudWxsOwogICAgICAgIHRoaXMuZmFsbGJhY2sgPSAndmxjJzsKICAgICAgICB0aGlzLmF1dG9wbGF5ID0gQWFrLm9wdHMuYXV0b1BsYXk7CiAgICAgICAgdGhpcy5hcmdzID0gbnVsbDsKICAgICAgICB0aGlzLnNldHVwID0ge307CiAgICAgICAgdGhpcy5vcHRpb25zID0gewogICAgICAgICAgYnVpbGQgOiAnZW1iZWQnLAogICAgICAgICAgaW5zZXJ0IDogJ3JlcGxhY2UnLAogICAgICAgICAgY3Jvc3NTZXR1cCA6IHRydWUKICAgICAgICB9OwogICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IHsgLy8gZmxhc2gKICAgICAgICAgIHdtb2RlIDogJ29wYXF1ZScsCiAgICAgICAgICBxdWFsaXR5IDogJ2hpZ2gnLAogICAgICAgICAgYmdjb2xvciA6ICcjMDAwMDAwJywKICAgICAgICAgIHR5cGUgOiAnYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2gnLAogICAgICAgICAgcGx1Z2luc3BhZ2UgOiAnaHR0cDovL3d3dy5hZG9iZS5jb20vZ28vZ2V0Zmxhc2gnLAogICAgICAgICAgYWxsb3dzY3JpcHRhY2Nlc3MgOiAnYWx3YXlzJywgLy8gbmV2ZXIgLyBhbHdheXMKICAgICAgICAgIGFsbG93ZnVsbHNjcmVlbiA6IHRydWUKICAgICAgICB9OwogICAgICB9OwoKICAgICAgUGxheWVyLnByb3RvdHlwZSA9IHsgLy8gaHR0cDovL3Rpbnl1cmwuY29tL3BiNmZ0aGoKICAgICAgICBnZXRUYXJnZXROb2RlIDogZnVuY3Rpb24gKGVsZW1lbnQpIHsKCiAgICAgICAgICB0aGlzLnRhcmdldC5ub2RlID0gQWFrLmdldEVsZW1lbnQoZWxlbWVudCk7CiAgICAgICAgICB0aGlzLnRhcmdldC5odG1sID0gdGhpcy50YXJnZXQubm9kZS5vdXRlckhUTUw7CiAgICAgICAgICB0aGlzLnRhcmdldC5wYXJlbnQgPSB0aGlzLnRhcmdldC5ub2RlLnBhcmVudE5vZGU7CiAgICAgICAgICB0aGlzLnRhcmdldC50YWcgPSB0aGlzLnRhcmdldC5ub2RlLnRhZ05hbWU7CgogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmlkID0gdGhpcy5hdHRyaWJ1dGVzLm5hbWUgPSBBYWsuZ2VuZXJhdGVJRCgpOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCA9IHRoaXMudGFyZ2V0Lm5vZGUuaGVpZ2h0IHx8IHRoaXMudGFyZ2V0Lm5vZGUuY2xpZW50SGVpZ2h0IHx8ICc0ODBweCc7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMud2lkdGggPSB0aGlzLnRhcmdldC5ub2RlLndpZHRoIHx8IHRoaXMudGFyZ2V0Lm5vZGUuY2xpZW50V2lkdGggfHwgJzY0MHB4JzsKICAgICAgICB9LAogICAgICAgIGdldE1pbWVUeXBlIDogZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tL2pyczhmZ3oKICAgICAgICAgIHN3aXRjaCAodHlwZS50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICBjYXNlICdtcDQnOgogICAgICAgICAgICByZXR1cm4gJ3ZpZGVvL21wNCc7CiAgICAgICAgICBjYXNlICd3ZWJtJzoKICAgICAgICAgICAgcmV0dXJuICd2aWRlby93ZWJtJzsKICAgICAgICAgIGNhc2UgJ29nZyc6CiAgICAgICAgICBjYXNlICdvZ3YnOgogICAgICAgICAgICByZXR1cm4gJ3ZpZGVvL29nZyc7CiAgICAgICAgICBjYXNlICdmbHYnOgogICAgICAgICAgICByZXR1cm4gJ3ZpZGVvL3gtZmx2JzsKICAgICAgICAgIGNhc2UgJ2hscyc6CiAgICAgICAgICAgIHJldHVybiAnYXBwbGljYXRpb24veC1tcGVnVVJMJzsKICAgICAgICAgIGNhc2UgJ2hkcyc6CiAgICAgICAgICAgIHJldHVybiAnYXBwbGljYXRpb24vZjRtK3htbCc7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGJ1aWxkaW5nIDogZnVuY3Rpb24gKHRhZ05hbWUpIHsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgICAgICBpZiAoQWFrLm9wdHMuZm9yY2VWTEMgJiYgdGhpcy5uYW1lICE9PSAndmxjJykgewogICAgICAgICAgICBBYWsuaW5mbygnZm9yY2UgcGxheWluZyB3aXRoIFZMQycpOwogICAgICAgICAgICByZXR1cm4gdGhpcy52bGMuYXBwbHkodGhpcywgdGhpcy5hcmdzKTsKICAgICAgICAgIH0KCiAgICAgICAgICBzd2l0Y2ggKHRhZ05hbWUpIHsKICAgICAgICAgIGNhc2UgJ2lmcmFtZSc6CiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRoaXMuYXR0cmlidXRlcy5zcmMgfHwgbG9jYXRpb24ucHJvdG9jb2wgKyAnLy8nICsgbG9jYXRpb24uaG9zdCArICcvJyk7CiAgICAgICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMuc3JjZG9jKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMucGxheWVyLm5vZGUuaGFzQXR0cmlidXRlKCJzcmNkb2MiKSB8fCAnc3JjZG9jJyBpbiB0aGlzLnBsYXllci5ub2RlKSB7CiAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlLnNldEF0dHJpYnV0ZSgnc3JjZG9jJywgdGhpcy5hdHRyaWJ1dGVzLnNyY2RvYyk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGRvZXMgbm90IHdvcmsgY29ycmVjdGx5IHdpdGggZmxvd3BsYXllcgogICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ3NyYycsICJkYXRhOnRleHQvaHRtbDtjaGFyc2V0PXV0Zi04LCIgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5hdHRyaWJ1dGVzLnNyY2RvYykpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB0aGlzLnNldHVwLndpZHRoKTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIHRoaXMuc2V0dXAuaGVpZ2h0KTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2hlaWdodDonICsgdGhpcy5zZXR1cC5oZWlnaHQgKyAncHg7IHdpZHRoOicgKyB0aGlzLnNldHVwLndpZHRoICsgJ3B4OycpOwogICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlLnNldEF0dHJpYnV0ZSgnZnJhbWVib3JkZXInLCAwKTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ3Njcm9sbGluZycsICdubycpOwogICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlLnNldEF0dHJpYnV0ZSgnYWxsb3dmdWxsc2NyZWVuJywgdHJ1ZSk7IC8vIGh0dHA6Ly90aW55dXJsLmNvbS9veXllaGFiCiAgICAgICAgICAgIC8vIGFsbG93ZnVsbHNjcmVlbiB3ZWJraXRhbGxvd2Z1bGxzY3JlZW4gbW96YWxsb3dmdWxsc2NyZWVuIG9hbGxvd2Z1bGxzY3JlZW4gbXNhbGxvd2Z1bGxzY3JlZW4KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICd2aWRlbyc6CiAgICAgICAgICAgIHZhciBhdHRyTmFtZTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyk7CiAgICAgICAgICAgIGZvciAoYXR0ck5hbWUgaW4gdGhpcy5hdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShhdHRyTmFtZSkpCiAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlLnNldEF0dHJpYnV0ZShhdHRyTmFtZSwgdGhpcy5hdHRyaWJ1dGVzW2F0dHJOYW1lXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMuYXV0b3BsYXkpIHsgLy8gZml4IGJ1ZyBkdXBsaWNhdGUgcGxheWluZyBvbiBmaXJlZm94L2Nocm9tZQogICAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUub25sb2Fkc3RhcnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvL3RoaXMucGxheSgpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUub25lcnJvciA9IGZ1bmN0aW9uICgpIHsgLy8gc3dpdGNoIHRvIHBsdWdpbiBwbGF5ZXIKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHNlbGYuYXJnc1swXSA9IHNlbGYucGxheWVyLm5vZGU7CiAgICAgICAgICAgICAgICBzZWxmLnZsY3BsYXllci5hcHBseShzZWxmLCBzZWxmLmFyZ3MpOwogICAgICAgICAgICAgIH0sIDUwMDApOwogICAgICAgICAgICB9OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6IC8vIGVtYmVkCiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdlbWJlZCcpOwogICAgICAgICAgICBmb3IgKGF0dHJOYW1lIGluIHRoaXMuYXR0cmlidXRlcykgewogICAgICAgICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoYXR0ck5hbWUpKQogICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoYXR0ck5hbWUsIHRoaXMuYXR0cmlidXRlc1thdHRyTmFtZV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLnBsYXllci5odG1sID0gdGhpcy5wbGF5ZXIubm9kZS5vdXRlckhUTUw7CiAgICAgICAgICB0aGlzLnBsYXllci50YWcgPSB0aGlzLnBsYXllci5ub2RlLnRhZ05hbWU7CiAgICAgICAgICB0aGlzLmluc2VydGluZygpOwogICAgICAgIH0sCiAgICAgICAgaW5zZXJ0aW5nIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgc3dpdGNoICh0aGlzLm9wdGlvbnMuaW5zZXJ0KSB7CiAgICAgICAgICBjYXNlICdpbm5lcic6CiAgICAgICAgICAgIHRoaXMudGFyZ2V0Lm5vZGUuaW5uZXJIVE1MID0gdGhpcy5wbGF5ZXIuaHRtbDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdhcHBlbmQnOgogICAgICAgICAgICB0aGlzLnRhcmdldC5wYXJlbnQucmVwbGFjZUNoaWxkKHRoaXMucGxheWVyLm5vZGUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6IC8vIHJlcGxhY2UKICAgICAgICAgICAgdGhpcy50YXJnZXQucGFyZW50LnJlcGxhY2VDaGlsZCh0aGlzLnBsYXllci5ub2RlLCB0aGlzLnRhcmdldC5ub2RlKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChBYWsub3B0cy5sb2dQbGF5ZXIpIHsKICAgICAgICAgICAgQWFrLmxvZygncGxheWVyJywgdGhpcyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9LAogICAgICAgIGVkaXRpbmcgOiBmdW5jdGlvbiAoZWxlbSwgb3B0cykgeyAvLyByZXZpZXcKICAgICAgICAgIEFhay5oYXNFbGVtZW50KGVsZW0sIGZ1bmN0aW9uICh0aGlzRWxlbWVudCkgewogICAgICAgICAgICB2YXIgb2JqLAogICAgICAgICAgICBzd2YsCiAgICAgICAgICAgIHZhbHVlLAogICAgICAgICAgICBwYXJ0cywKICAgICAgICAgICAgcGFyYW0sCiAgICAgICAgICAgIGF0dHJpYnV0ZXMsCiAgICAgICAgICAgIGF0dHJOYW1lOwogICAgICAgICAgICB2YXIgc28gPSB0aGlzRWxlbWVudDsKICAgICAgICAgICAgdmFyIGNsb25lID0gc28uY2xvbmVOb2RlKHRydWUpOwoKICAgICAgICAgICAgLy8gc2V0IGF0dHJpaWJ1dGVzCiAgICAgICAgICAgIGlmIChvcHRzLnNldEF0dHJpYnV0ZSkgewogICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBvcHRzLnNldEF0dHJpYnV0ZTsKICAgICAgICAgICAgICBmb3IgKGF0dHJOYW1lIGluIGF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGlmIChjbG9uZS5xdWVyeVNlbGVjdG9yKCdwYXJhbVtuYW1lPSInICsgYXR0ck5hbWUgKyAnIl0nKSkgewogICAgICAgICAgICAgICAgICBjbG9uZS5xdWVyeVNlbGVjdG9yKCdwYXJhbVtuYW1lPSInICsgYXR0ck5hbWUgKyAnIl0nKS52YWx1ZSA9IGF0dHJpYnV0ZXNbYXR0ck5hbWVdOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjbG9uZS5nZXRBdHRyaWJ1dGUoYXR0ck5hbWUpKSB7CiAgICAgICAgICAgICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZShhdHRyTmFtZSwgYXR0cmlidXRlc1thdHRyTmFtZV0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdW5zZXQgYXR0cmlidXRlcwogICAgICAgICAgICBpZiAob3B0cy51bnNldEF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICBhdHRyaWJ1dGVzID0gb3B0cy5kZWxBdHRyaWJ1dGVzOwogICAgICAgICAgICAgIGZvciAoYXR0ck5hbWUgaW4gYXR0cmlidXRlcykgewogICAgICAgICAgICAgICAgaWYgKGNsb25lLnF1ZXJ5U2VsZWN0b3IoJ3BhcmFtW25hbWU9IicgKyBhdHRyTmFtZSArICciXScpKSB7CiAgICAgICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGNsb25lLnF1ZXJ5U2VsZWN0b3IoJ3BhcmFtW25hbWU9IicgKyBhdHRyTmFtZSArICciXScpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2xvbmUuZ2V0QXR0cmlidXRlKGF0dHJOYW1lKSkgewogICAgICAgICAgICAgICAgICBkZWxldGUgYXR0cmlidXRlc1thdHRyTmFtZV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAob3B0cy5zZXRGbGFzaHZhcnMgfHwgb3B0cy51bnNldEZsYXNodmFycykgewogICAgICAgICAgICAgIGlmIChjbG9uZS5xdWVyeVNlbGVjdG9yKCdwYXJhbVtuYW1lPSJmbGFzaHZhcnMiXScpKSB7CiAgICAgICAgICAgICAgICBwYXJhbSA9IGNsb25lLnF1ZXJ5U2VsZWN0b3IoJ3BhcmFtW25hbWU9ImZsYXNodmFycyJdJyk7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcmFtLnZhbHVlOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2xvbmUuZ2V0QXR0cmlidXRlKCdmbGFzaHZhcnMnKSkgewogICAgICAgICAgICAgICAgdmFsdWUgPSBjbG9uZS5nZXRBdHRyaWJ1dGUoJ2ZsYXNodmFycycpOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2xvbmUuZ2V0QXR0cmlidXRlKCdkYXRhJykgJiYgY2xvbmUuZ2V0QXR0cmlidXRlKCdkYXRhJykuaW5kZXhPZignPycpID49IDApIHsKICAgICAgICAgICAgICAgIHBhcnRzID0gY2xvbmUuZ2V0QXR0cmlidXRlKCdkYXRhJykuc3BsaXQoJz8nLCAyKTsKICAgICAgICAgICAgICAgIHN3ZiA9IHBhcnRzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcnRzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBvYmogPSBBYWsudW5zZXJpYWxpemUodmFsdWUpOwogICAgICAgICAgICAgIGlmIChvcHRzLnNldEZsYXNodmFycykgewogICAgICAgICAgICAgICAgb2JqID0gQWFrLnNldFByb3BlcnRpZXMob2JqLCBvcHRzLnNldEZsYXNodmFycyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChvcHRzLnVuc2V0Rmxhc2h2YXJzKSB7CiAgICAgICAgICAgICAgICBvYmogPSBBYWsudW5zZXRQcm9wZXJ0aWVzKG9iaiwgb3B0cy51bnNldEZsYXNodmFycyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhbHVlID0gQWFrLnNlcmlhbGl6ZShvYmopOwoKICAgICAgICAgICAgICBpZiAocGFyYW0pIHsKICAgICAgICAgICAgICAgIHBhcmFtLnZhbHVlID0gdmFsdWU7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChzd2YpIHsKICAgICAgICAgICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZSgnZGF0YScsIHN3ZiArICc/JyArIHZhbHVlKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2xvbmUuc2V0QXR0cmlidXRlKCdmbGFzaHZhcnMnLCB2YWx1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIHJlcGxhY2UKICAgICAgICAgICAgQWFrLmxvZyhzbywgY2xvbmUsIG9iaik7CiAgICAgICAgICAgIEFhay5yZXBsYWNlRWxlbWVudChzbywgY2xvbmUpOwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBlbWJlZGRpbmcgOiBmdW5jdGlvbiAoaWQsIHNldHVwLCBhdHRyaWJ1dGVzLCBvcHRpb25zKSB7IAogICAgICAgIAogICAgICAgICAgdGhpcy5nZXRUYXJnZXROb2RlKGlkKTsKICAgICAgICAgIHRoaXMuYXJncyA9IGFyZ3VtZW50czsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFhay5zZXRQcm9wZXJ0aWVzKHRoaXMuYXR0cmlidXRlcywgYXR0cmlidXRlcyB8fCB7fSk7CiAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLm9wdGlvbnMsIG9wdGlvbnMgfHwge30pOwoKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zcmMgPSBzZXR1cC5zd2Y7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuaWQgPSB0aGlzLmF0dHJpYnV0ZXMubmFtZSA9IEFhay5nZW5lcmF0ZUlEKCk7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuaGVpZ2h0ID0gc2V0dXAuaGVpZ2h0IHx8IHRoaXMuYXR0cmlidXRlcy5oZWlnaHQ7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMud2lkdGggPSBzZXR1cC53aWR0aCB8fCB0aGlzLmF0dHJpYnV0ZXMud2lkdGg7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuZmxhc2h2YXJzID0gQWFrLnNlcmlhbGl6ZShzZXR1cCk7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsudW5zZXRQcm9wZXJ0aWVzKHRoaXMuYXR0cmlidXRlcywgJ3N3ZicpOwoKICAgICAgICAgIHRoaXMuYnVpbGRpbmcoJ2VtYmVkJyk7CiAgICAgICAgfSwKICAgICAgICBqd3BsYXllciA6IGZ1bmN0aW9uIChpZCwgc2V0dXAsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHsKICAgICAgICAgIC8vIEp3UGxheWVyIDcgKGZsYXNoL2h0bWw1KQogICAgICAgICAgLy8gbm90ZTogcHJvYmxlbSB3aXRoIHNzbAogICAgICAgICAgLy8gc2V0dXA6IGh0dHA6Ly90aW55dXJsLmNvbS9oaHJnamFwLCBodHRwOi8vdGlueXVybC5jb20vZ3FzNDZ0bQogICAgICAgICAgLy8gYXBpOiBodHRwczovL2RldmVsb3Blci5qd3BsYXllci5jb20vanctcGxheWVyL2RvY3MvZGV2ZWxvcGVyLWd1aWRlL2FwaS9qYXZhc2NyaXB0X2FwaV9yZWZlcmVuY2UvCiAgICAgICAgICAvLyBobHM6IGh0dHA6Ly90aW55dXJsLmNvbS9weGw5c2NxCiAgICAgICAgICAvLyBobHMtdGVzdGVyOiBodHRwOi8vZGVtby5qd3BsYXllci5jb20vc3RyZWFtLXRlc3Rlci8KICAgICAgICAgIC8vIHJ0bXAtZGVtbzogaHR0cHM6Ly93d3cuc2NhbGVlbmdpbmUuY29tL2p3NgogICAgICAgICAgLy8gaWZyYW1lOiBodHRwOi8vdGlueXVybC5jb20vODZhZ2c2OAoKICAgICAgICAgIHRoaXMuZ2V0VGFyZ2V0Tm9kZShpZCk7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMgfHwge30pOwogICAgICAgICAgdGhpcy5vcHRpb25zID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5vcHRpb25zLCBvcHRpb25zIHx8IHt9KTsKCiAgICAgICAgICB0aGlzLnNldHVwID0gc2V0dXA7CiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNyb3NzU2V0dXAgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy5zZXR1cCA9IHsKICAgICAgICAgICAgICBjb250cm9scyA6IHRydWUsCiAgICAgICAgICAgICAgZmlsZSA6IHNldHVwLnNvdXJjZSwKICAgICAgICAgICAgICBhYm91dHRleHQgOiBBYWsubmFtZSwKICAgICAgICAgICAgICBhYm91dGxpbmsgOiBBYWsuaG9tZVVSTCwKICAgICAgICAgICAgICB3aWR0aCA6IHNldHVwLndpZHRoIHx8IHRoaXMuYXR0cmlidXRlcy53aWR0aCwKICAgICAgICAgICAgICBoZWlnaHQgOiBzZXR1cC5oZWlnaHQgfHwgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCwKICAgICAgICAgICAgICBhdXRvc3RhcnQgOiBzZXR1cC5hdXRvcGxheSB8fCB0aGlzLmF1dG9wbGF5LAogICAgICAgICAgICAgIHByaW1hcnkgOiAnaHRtbDUnLAogICAgICAgICAgICAgIHByZWxvYWQgOiAnYXV0bycsCiAgICAgICAgICAgICAgc2tpbiA6IHsgLy8gU2V2ZW4gfCBTaXggfCBGaXZlIHwgR2xvdyB8IEJlZWxkZW4gfCBWYXBvciB8IEJla2xlIHwgUm91bmRzdGVyIHwgU3Rvcm10cm9vcGVyCiAgICAgICAgICAgICAgICBuYW1lIDogc2V0dXAuc2tpbiB8fCAic2l4IiAvLyBkZWZhdWx0IHNraW4gSldQNgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYgKFsnbXA0JywgJ3dlYm0nLCAnb2dnJywgJ29ndiddLmluZGV4T2Yoc2V0dXAudHlwZSkgPT09IC0xKSB7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5wcmltYXJ5ID0gJ2ZsYXNoJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2V0dXAudHlwZSA9PT0gJ2hscycpIHsKICAgICAgICAgICAgICB0aGlzLnNldHVwLmhsc2h0bWwgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnNyY2RvYyA9ICc8aHRtbD48aGVhZD48c3R5bGUgdHlwZT0idGV4dC9jc3MiPkBmb250LWZhY2V7Zm9udC1mYW1pbHk6anctaWNvbnM7c3JjOnVybCgnICsgbG9jYXRpb24ucHJvdG9jb2wgKyAnc3NsLnAuandwY2RuLmNvbS9wbGF5ZXIvdi83LjQuMy9qdy1pY29ucy53b2ZmKSBmb3JtYXQoIndvZmYiKSx1cmwoJyArIGxvY2F0aW9uLnByb3RvY29sICsgJy8vc3NsLnAuandwY2RuLmNvbS9wbGF5ZXIvdi83LjQuMy9qdy1pY29ucy50dGYpIGZvcm1hdCgidHJ1ZXR5cGUiKTtmb250LXdlaWdodDo0MDA7Zm9udC1zdHlsZTpub3JtYWx9PC9zdHlsZT48c2NyaXB0IHNyYz0iJyArIGxvY2F0aW9uLnByb3RvY29sICsgJy8vY29udGVudC5qd3BsYXRmb3JtLmNvbS9saWJyYXJpZXMvVjZOZkV6VDcuanMiPjwvc2NyaXB0PjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+aHRtbCwgYm9keXtwYWRkaW5nOjA7IG1hcmdpbjowO308L3N0eWxlPjwvaGVhZD48Ym9keT48ZGl2IGlkPSJqdy1tb3ZpZSI+PC9kaXY+PHNjcmlwdD5qd3BsYXllcigianctbW92aWUiKS5zZXR1cCgnICsgSlNPTi5zdHJpbmdpZnkodGhpcy5zZXR1cCkgKyAnKTs8L3NjcmlwdD48L2JvZHk+PC9odG1sPic7CgogICAgICAgICAgdGhpcy5idWlsZGluZygnaWZyYW1lJyk7CiAgICAgICAgfSwKICAgICAgICB2aWRlb2pzIDogZnVuY3Rpb24gKGlkLCBzZXR1cCwgYXR0cmlidXRlcywgb3B0aW9ucykgeyAKICAgICAgICAgIC8vIFZpZGVvSnMgNSAoZmxhc2gvaHRtbDUpCiAgICAgICAgICAvLyBzZXR1cDogaHR0cDovL3Rpbnl1cmwuY29tL3BjZ3gyb2IKICAgICAgICAgIC8vIHBsYXliYWNrOiBodHRwOi8vdGlueXVybC5jb20vbnNjenRtbQogICAgICAgICAgLy8gZGVtbzogaHR0cDovL2pzZmlkZGxlLm5ldC9OOFpzNS8xOC8KICAgICAgICAgIC8vIHBsdWdpbnM6IGh0dHBzOi8vZ2l0aHViLmNvbS92aWRlb2pzL3ZpZGVvLmpzL3dpa2kvUGx1Z2lucwoKICAgICAgICAgIHRoaXMuZ2V0VGFyZ2V0Tm9kZShpZCk7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMgfHwge30pOwogICAgICAgICAgdGhpcy5vcHRpb25zID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5vcHRpb25zLCBvcHRpb25zIHx8IHt9KTsKCiAgICAgICAgICB0aGlzLnNldHVwID0gc2V0dXA7CiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNyb3NzU2V0dXAgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy5zZXR1cCA9IHsKICAgICAgICAgICAgICBjb250cm9scyA6IHRydWUsCiAgICAgICAgICAgICAgcHJlbG9hZCA6ICdhdXRvJywKICAgICAgICAgICAgICB3aWR0aCA6IHNldHVwLndpZHRoIHx8IHRoaXMuYXR0cmlidXRlcy53aWR0aCwKICAgICAgICAgICAgICBoZWlnaHQgOiBzZXR1cC5oZWlnaHQgfHwgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCwKICAgICAgICAgICAgICB0ZWNoT3JkZXIgOiBbImh0bWw1IiwgImZsYXNoIl0sCiAgICAgICAgICAgICAgYXV0b3BsYXkgOiBzZXR1cC5hdXRvcGxheSB8fCB0aGlzLmF1dG9wbGF5LAogICAgICAgICAgICAgIHNvdXJjZXMgOiBbewogICAgICAgICAgICAgICAgICB0eXBlIDogdGhpcy5nZXRNaW1lVHlwZShzZXR1cC50eXBlKSwKICAgICAgICAgICAgICAgICAgc3JjIDogc2V0dXAuc291cmNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgXQogICAgICAgICAgICB9OwogICAgICAgICAgICAvKiBkb24ndCB3b3JrIAogICAgICAgICAgICBpZiAoc2V0dXAudHlwZSA9PT0gJ2hscycpIHsKICAgICAgICAgICAgICB0ZWNoT3JkZXIgOiBbImZsYXNoIiwgImh0bWw1Il0sCiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5mbGFzaCA9IHsKICAgICAgICAgICAgICAgIC8vc3dmIDogIi8vcmVla3NpdGUuY29tL3B1YmxpYy9zd2YvdmlkZW9qcy1mbGFzaGxzLnN3ZiIKICAgICAgICAgICAgICAgIHN3ZiA6ICdodHRwOi8vd3d3LmZsYXNobHMub3JnL3ZpZGVvanMvdmlkZW8tanMuc3dmJwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgKi8KICAgICAgICAgIH0KCiAgICAgICAgICAvLyAKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zcmNkb2MgPSAnPGh0bWw+PGhlYWQ+PGxpbmsgaHJlZj0iJyArIGxvY2F0aW9uLnByb3RvY29sICsgJy8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ZpZGVvLmpzLzUuMTAuNS9hbHQvdmlkZW8tanMtY2RuLm1pbi5jc3MiIHJlbD0ic3R5bGVzaGVldCI+PHNjcmlwdCBzcmM9IicgKyBsb2NhdGlvbi5wcm90b2NvbCArICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy92aWRlby5qcy81LjEwLjUvdmlkZW8ubWluLmpzIj48L3NjcmlwdD48c2NyaXB0IHNyYz0iJyArIGxvY2F0aW9uLnByb3RvY29sICsgJy8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3ZpZGVvanMtY29udHJpYi1obHMvMy4xLjAvdmlkZW9qcy1jb250cmliLWhscy5taW4uanMiPjwvc2NyaXB0PjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+aHRtbCwgYm9keXtwYWRkaW5nOjA7IG1hcmdpbjowO30udmpzLWRlZmF1bHQtc2tpbntjb2xvcjojZWVlfS52anMtZGVmYXVsdC1za2luIC52anMtcGxheS1wcm9ncmVzcywudmpzLWRlZmF1bHQtc2tpbiAudmpzLXZvbHVtZS1sZXZlbHtiYWNrZ3JvdW5kLWNvbG9yOiNlZWV9LnZqcy1kZWZhdWx0LXNraW4gLnZqcy1iaWctcGxheS1idXR0b24sLnZqcy1kZWZhdWx0LXNraW4gLnZqcy1jb250cm9sLWJhcntiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjIpfS52anMtZGVmYXVsdC1za2luIC52anMtc2xpZGVye2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMyl9PC9zdHlsZT48L2hlYWQ+PGJvZHk+PHZpZGVvIGlkPSJ2anMtbW92aWUiIGNsYXNzPSJ2aWRlby1qcyB2anMtZGVmYXVsdC1za2luIHZqcy1iaWctcGxheS1jZW50ZXJlZCI+PC92aWRlbz48c2NyaXB0PnZpZGVvanMoInZqcy1tb3ZpZSIsICcgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnNldHVwKSArICcpPC9zY3JpcHQ+PC9ib2R5PjwvaHRtbD4nOwoKICAgICAgICAgIHRoaXMuYnVpbGRpbmcoJ2lmcmFtZScpOwogICAgICAgIH0sCiAgICAgICAgZmxvd3BsYXllciA6IGZ1bmN0aW9uIChpZCwgc2V0dXAsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHsKICAgICAgICAgIC8vIEZsb3dQbGF5ZXIgNiAoZmxhc2gpCiAgICAgICAgICAvLyBub3RlOiBwcm9ibGVtIHdpdGggZmxhc2hwbGF5ZXIKICAgICAgICAgIC8vIHN1cHBvcnQ6IG1wNCwgZmx2LCBmNHYsIG00diwgbW92CiAgICAgICAgICAvLyBzZXR1cDogaHR0cHM6Ly9mbG93cGxheWVyLm9yZy9kb2NzL3NldHVwLmh0bWwKICAgICAgICAgIC8vIGFwaTogaHR0cHM6Ly9mbG93cGxheWVyLm9yZy9kb2NzL2FwaS5odG1sCiAgICAgICAgICAvLyBkZW1vOiBodHRwOi8vZGVtb3MuZmxvd3BsYXllci5vcmcvYmFzaWNzL2pzLXNldHVwLWF1dG9wbGF5Lmh0bWwKICAgICAgICAgIC8vIGhkczogaHR0cHM6Ly9mbG93cGxheWVyLmVsZWN0cm90ZXF1ZS5vcmcvaHR0cHN0cmVhbWluZy1oZHMvZnA2CiAgICAgICAgICAvLyBobHM6IGh0dHA6Ly9kZW1vcy5mbG93cGxheWVyLm9yZy9hcGkvaGxzanMuaHRtbAogICAgICAgICAgLy8gZmx2OiBodHRwOi8vZGVtb3MuZmxvd3BsYXllci5vcmcvYmFzaWNzL2Zsdi5odG1sCgogICAgICAgICAgdGhpcy5nZXRUYXJnZXROb2RlKGlkKTsKICAgICAgICAgIHRoaXMuYXJncyA9IGFyZ3VtZW50czsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFhay5zZXRQcm9wZXJ0aWVzKHRoaXMuYXR0cmlidXRlcywgYXR0cmlidXRlcyB8fCB7fSk7CiAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLm9wdGlvbnMsIG9wdGlvbnMgfHwge30pOwoKICAgICAgICAgIHRoaXMuc2V0dXAgPSBzZXR1cDsKICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuY3Jvc3NTZXR1cCA9PT0gdHJ1ZSkgewogICAgICAgICAgICB0aGlzLnNldHVwID0gewogICAgICAgICAgICAgIHdpZHRoIDogc2V0dXAud2lkdGggfHwgdGhpcy5hdHRyaWJ1dGVzLndpZHRoLAogICAgICAgICAgICAgIGhlaWdodCA6IHNldHVwLmhlaWdodCB8fCB0aGlzLmF0dHJpYnV0ZXMuaGVpZ2h0LAogICAgICAgICAgICAgIGF1dG9wbGF5IDogc2V0dXAuYXV0b3BsYXkgfHwgdGhpcy5hdXRvcGxheSwKICAgICAgICAgICAgICBwcmVsb2FkIDogJ2F1dG8nCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlmIChzZXR1cC50eXBlID09PSAnaGxzJykgewogICAgICAgICAgICAgIHRoaXMuc2V0dXAuc3dmID0gbG9jYXRpb24ucHJvdG9jb2wgKyAnLy9yZWxlYXNlcy5mbG93cGxheWVyLm9yZy82LjAuNS9mbG93cGxheWVyaGxzLnN3Zic7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5lbmdpbmUgPSAnaGxzanMnOwogICAgICAgICAgICB9IGVsc2UgaWYgKFsnbXA0JywgJ3dlYm0nLCAnb2dnJywgJ29ndiddLmluZGV4T2Yoc2V0dXAudHlwZSkgPT09IC0xKSB7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5zd2YgPSBsb2NhdGlvbi5wcm90b2NvbCArICcvL3JlbGVhc2VzLmZsb3dwbGF5ZXIub3JnLzYuMC41L2Zsb3dwbGF5ZXIuc3dmJzsKICAgICAgICAgICAgICB0aGlzLnNldHVwLmVuZ2luZSA9ICdmbGFzaCc7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC50eXBlID0gJ3ZpZGVvL2ZsYXNoJzsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnNldHVwLmNsaXAgPSB7CiAgICAgICAgICAgICAgc291cmNlcyA6IFt7CiAgICAgICAgICAgICAgICAgIHR5cGUgOiB0aGlzLmdldE1pbWVUeXBlKHRoaXMuc2V0dXAudHlwZSB8fCBzZXR1cC50eXBlKSwKICAgICAgICAgICAgICAgICAgc3JjIDogc2V0dXAuc291cmNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgXQogICAgICAgICAgICB9OwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zcmNkb2MgPSAnPGh0bWw+PGhlYWQ+PGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSInICsgbG9jYXRpb24ucHJvdG9jb2wgKyAnLy9yZWxlYXNlcy5mbG93cGxheWVyLm9yZy82LjAuNS9za2luL2Z1bmN0aW9uYWwuY3NzIj48L3NjcmlwdD48c2NyaXB0IHNyYz0iJyArIGxvY2F0aW9uLnByb3RvY29sICsgJy8vY29kZS5qcXVlcnkuY29tL2pxdWVyeS0xLjExLjIubWluLmpzIj48L3NjcmlwdD48c2NyaXB0IHNyYz0iJyArIGxvY2F0aW9uLnByb3RvY29sICsgJy8vcmVsZWFzZXMuZmxvd3BsYXllci5vcmcvNi4wLjUvZmxvd3BsYXllci5taW4uanMiPjwvc2NyaXB0PjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+aHRtbCwgYm9keXtwYWRkaW5nOjA7IG1hcmdpbjowO308L3N0eWxlPjwvaGVhZD48Ym9keT48ZGl2IGlkPSJmcC1tb3ZpZSI+PC9kaXY+PHNjcmlwdD5mbG93cGxheWVyKCIjZnAtbW92aWUiLCAnICsgSlNPTi5zdHJpbmdpZnkodGhpcy5zZXR1cCkgKyAnKTs8L3NjcmlwdD48L2JvZHk+PC9odG1sPic7CgogICAgICAgICAgdGhpcy5idWlsZGluZygnaWZyYW1lJyk7CiAgICAgICAgfSwKICAgICAgICBncmluZHBsYXllciA6IGZ1bmN0aW9uIChpZCwgc2V0dXAsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHsKICAgICAgICAgIC8vIEdyaW5kUGxheWVyIDEgKGZsYXNoKQogICAgICAgICAgLy8gc2V0dXA6IGh0dHA6Ly9vc21maGxzLmt1dHUucnUvZG9jcy9ncmluZC8KICAgICAgICAgIC8vIHN1cHBvcnQ6IGhscywgcnRtcAoKICAgICAgICAgIHRoaXMuZ2V0VGFyZ2V0Tm9kZShpZCk7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMgfHwge30pOwogICAgICAgICAgdGhpcy5vcHRpb25zID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5vcHRpb25zLCBvcHRpb25zIHx8IHt9KTsKCiAgICAgICAgICB0aGlzLnNldHVwID0gc2V0dXA7CiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNyb3NzU2V0dXAgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy5zZXR1cCA9IHsKICAgICAgICAgICAgICBzcmMgOiBzZXR1cC5zb3VyY2UsCiAgICAgICAgICAgICAgc3RyZWFtVHlwZSA6ICJsaXZlIiwKICAgICAgICAgICAgICBzY2FsZU1vZGUgOiAibGV0dGVyYm94IiwKICAgICAgICAgICAgICBhdXRvUGxheSA6IHNldHVwLmF1dG9wbGF5IHx8IHRoaXMuYXV0b3BsYXkKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYgKHNldHVwLnR5cGUgPT09ICdobHMnKSB7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5wbHVnaW5faGxzID0gIi8vcmVla3NpdGUuY29tL3B1YmxpYy9zd2YvZmxhc2hsc09TTUYuc3dmIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2V0dXAucHJveHkgPT09IHRydWUpIHsKICAgICAgICAgICAgICB0aGlzLnNldHVwLnNyYyA9ICcvL3d3dy5kaWFuc2hpYm8uY29tL2ZldGNoLnBocC8nICsgc2V0dXAuc291cmNlLnN1YnN0cmluZyhzZXR1cC5zb3VyY2UuaW5kZXhPZignLy8nKSArIDIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnNyYyA9IHNldHVwLnN3ZiB8fCB0aGlzLmF0dHJpYnV0ZXMuc3JjIHx8ICIvL3JlZWtzaXRlLmNvbS9wdWJsaWMvc3dmL0dyaW5kUGxheWVyLnN3ZiI7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuaGVpZ2h0ID0gc2V0dXAuaGVpZ2h0IHx8IHRoaXMuYXR0cmlidXRlcy5oZWlnaHQ7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMud2lkdGggPSBzZXR1cC53aWR0aCB8fCB0aGlzLmF0dHJpYnV0ZXMud2lkdGg7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuZmxhc2h2YXJzID0gQWFrLnNlcmlhbGl6ZSh0aGlzLnNldHVwKTsKCiAgICAgICAgICB0aGlzLmJ1aWxkaW5nKCdlbWJlZCcpOwogICAgICAgIH0sCiAgICAgICAgdmxjIDogZnVuY3Rpb24gKGlkLCBzZXR1cCwgYXR0cmlidXRlcywgb3B0aW9ucykgewogICAgICAgICAgLy8gVkxDIFdlYiBQbHVnaW4gKHBsdWdpbikKICAgICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tL29tbHpwMzkKICAgICAgICAgIC8vIHBsdWdpbnM6IGFib3V0OnBsdWdpbnMKICAgICAgICAgIC8vIGNocm9tZTovL2ZsYWdzLyNlbmFibGUtbnBhcGkKICAgICAgICAgIC8vIGh0dHBzOi8vd3d3LmNocm9taXVtLm9yZy9kZXZlbG9wZXJzL25wYXBpLWRlcHJlY2F0aW9uCiAgICAgICAgICAvLyBJbiBTZXB0ZW1iZXIgMjAxNSAoQ2hyb21lIDQ1KSB3ZSB3aWxsIHJlbW92ZSB0aGUgb3ZlcnJpZGUgYW5kIE5QQVBJIHN1cHBvcnQgd2lsbCBiZSBwZXJtYW5lbnRseSByZW1vdmVkIGZyb20gQ2hyb21lLiBJbnN0YWxsZWQgZXh0ZW5zaW9ucyB0aGF0IHJlcXVpcmUgTlBBUEkgcGx1Z2lucyB3aWxsIG5vIGxvbmdlciBiZSBhYmxlIHRvIGxvYWQgdGhvc2UgcGx1Z2lucy4KCiAgICAgICAgICB0aGlzLm5hbWUgPSAndmxjJzsKICAgICAgICAgIHRoaXMuZ2V0VGFyZ2V0Tm9kZShpZCk7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMgfHwge30pOwogICAgICAgICAgdGhpcy5vcHRpb25zID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5vcHRpb25zLCBvcHRpb25zIHx8IHt9KTsKCiAgICAgICAgICB0aGlzLnNldHVwID0gc2V0dXA7CiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNyb3NzU2V0dXAgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnNyYyA9IHNldHVwLnNvdXJjZTsKICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCA9IHNldHVwLmhlaWdodCB8fCB0aGlzLmF0dHJpYnV0ZXMuaGVpZ2h0OwogICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMud2lkdGggPSBzZXR1cC53aWR0aCB8fCB0aGlzLmF0dHJpYnV0ZXMud2lkdGg7CiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5jb250cm9scyA9IHRydWU7CiAgICAgICAgICAgIGlmIChzZXR1cC5hdXRvcGxheSB8fCB0aGlzLmF1dG9wbGF5KSB7CiAgICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmF1dG9wbGF5ID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy50eXBlID0gImFwcGxpY2F0aW9uL3gtdmxjLXBsdWdpbiI7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMucGx1Z2luc3BhZ2UgPSAiaHR0cDovL3d3dy52aWRlb2xhbi5vcmciOwogICAgICAgICAgdGhpcy5idWlsZGluZygnZW1iZWQnKTsKICAgICAgICB9LAogICAgICAgIGh0bWw1IDogZnVuY3Rpb24gKGlkLCBzZXR1cCwgYXR0cmlidXRlcywgb3B0aW9ucykgeyAKICAgICAgICAgIC8vIFZpZGVvIFRhZyAoaHRtbDUpCiAgICAgICAgICAvLyBiYXNpY3M6IGh0dHBzOi8vaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL3ZpZGVvL2Jhc2ljcy8KICAgICAgICAgIC8vIHRhZzogaHR0cDovL3d3dy53M3NjaG9vbHMuY29tL3RhZ3MvdGFnX3ZpZGVvLmFzcAogICAgICAgICAgLy8gc3VwcG9ydDogbXA0LCB3ZWJtLCBvZ2cKICAgICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly93d3cucXVpcmtzbW9kZS5vcmcvaHRtbDUvdGVzdHMvdmlkZW8uaHRtbAoKICAgICAgICAgIHRoaXMub3B0aW9ucyA9IEFhay5zZXRQcm9wZXJ0aWVzKHRoaXMub3B0aW9ucywgb3B0aW9ucyB8fCB7fSk7CgogICAgICAgICAgdGhpcy5nZXRUYXJnZXROb2RlKGlkKTsKICAgICAgICAgIHRoaXMuYXJncyA9IGFyZ3VtZW50czsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IEFhay5zZXRQcm9wZXJ0aWVzKHt9LCBzZXR1cCB8fCB7fSk7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuc3JjID0gc2V0dXAuc291cmNlOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmlkID0gdGhpcy5hdHRyaWJ1dGVzLm5hbWUgPSBBYWsuZ2VuZXJhdGVJRCgpOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCA9IHRoaXMuYXR0cmlidXRlcy5oZWlnaHQgfHwgdGhpcy50YXJnZXQubm9kZS5jbGllbnRIZWlnaHQgfHwgIjEwMCUiOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLndpZHRoID0gdGhpcy5hdHRyaWJ1dGVzLndpZHRoIHx8IHRoaXMudGFyZ2V0Lm5vZGUuY2xpZW50V2lkdGggfHwgIjEwMCUiOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnR5cGUgPSB0aGlzLmdldE1pbWVUeXBlKHRoaXMuYXR0cmlidXRlcy50eXBlKTsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5jb250cm9scyA9ICdjb250cm9scyc7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMucHJlbG9hZCA9ICdub25lJzsKICAgICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMuYXV0b3BsYXkgfHwgdGhpcy5hdXRvcGxheSkgewogICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuYXV0b3BsYXkgPSAnYXV0b3BsYXknOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnN0eWxlID0gJ2Rpc3BsYXk6IGJsb2NrOyBtYXJnaW46MCBhdXRvOyc7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsudW5zZXRQcm9wZXJ0aWVzKHRoaXMuYXR0cmlidXRlcywgJ3NvdXJjZScpOwoKICAgICAgICAgIHRoaXMuYnVpbGRpbmcoJ3ZpZGVvJyk7CiAgICAgICAgfQogICAgICB9OwogICAgICAKICAgICAgcmV0dXJuIG5ldyBQbGF5ZXIoKTsKICAgIH0sCiAgICBydWxlcyA6IHsKICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgLy8gQW50aS1BZGJsb2NrIEtpbGxlcgogICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICBzZXR0aW5ncyA6IHsKICAgICAgICBob3N0IDogWydsb2NhbGhvc3QnLCAncmVlay5naXRodWIuaW8nLCAncmVla3NpdGUuY29tJ10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgaWYgKC9cL2FudGktYWRibG9jay1raWxsZXIoLXBhZ2VzKT9cLyQvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpKSB7CiAgICAgICAgICAgIHZhciBzZXR0aW5nc0JveCA9IEFhay5nZXRFbGVtZW50KCcjYWFrLXNldHRpbmdzLWJveCcpOwogICAgICAgICAgICB2YXIgc2V0dGluZ3NOb3RpY2UgPSBBYWsuZ2V0RWxlbWVudCgnI2Fhay1zZXR0aW5ncy1ub3RpY2UnKTsKCiAgICAgICAgICAgIGlmICghQWFrLnVzZUdNKSB7CiAgICAgICAgICAgICAgc2V0dGluZ3NOb3RpY2UucXVlcnlTZWxlY3RvcignZGl2JykuaW5uZXJIVE1MID0gJ0luIG5hdGl2ZSBtb2RlLCB5b3UgbXVzdCBlZGl0IHRoZSBvcHRpb25zIG1hbnVhbGx5OiA8YSBocmVmPSInICsgQWFrLm5hdGl2ZVVSTCArICciPlNlZTwvYT4nOwogICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzQm94ICYmIHNldHRpbmdzTm90aWNlKSB7CiAgICAgICAgICAgICAgc2V0dGluZ3NOb3RpY2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICBzZXR0aW5nc0JveC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgICBBYWsuaW5mbygnR00gc3RvcmFnZTonLCBBYWsuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAgQWFrLmluZm8oJ0dNIG9wdGlvbnM6JywgQWFrLm9wdHMpOwogICAgICAgICAgICAgIEFhay5pbmZvKCdHTSBhcGk6JywgQWFrLnVzZUdNICYmIEFhay5hcGlHTSgpKTsKCiAgICAgICAgICAgICAgLy8gdXNlciBjb25maWcKICAgICAgICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICAgICAgICB0YWcgOiAnZGl2JywKICAgICAgICAgICAgICAgIGh0bWwgOiAnVmVyc2lvbjogJyArIEFhay5nZXRWZXJzaW9uKCkgKyAnIDxicj5BYWtTY3JpcHQ6IHRydWUgPGJyPkFha0xpc3Q6ICcgKyAoIUFhay5nZXRFbGVtZW50KCcjazJVdzdpc0hyTW01SlhQMVZ3ZHhjNTY3WktjMWFaNEknKSkgKyAnIDxicj5Ccm93c2VyOiAnICsgQWFrLmdldEJyb3dzZXIoKSArICcgPGJyPlNjcmlwdE1hbmFnZXI6ICcgKyBBYWsuZ2V0U2NyaXB0TWFuYWdlcigpLAogICAgICAgICAgICAgICAgYXBwZW5kIDogJyNhYWstc2V0dGluZ3MtY29uZmlnJwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAvLyBjcmVhdGUgb3B0aW9ucyAKICAgICAgICAgICAgICBmb3IgKHZhciBvcHROYW1lIGluIEFhay5vcHRpb25zKSB7CiAgICAgICAgICAgICAgICBpZiAoQWFrLm9wdGlvbnMuaGFzT3duUHJvcGVydHkob3B0TmFtZSkpIHsKICAgICAgICAgICAgICAgICAgdmFyIG9wdCA9IEFhay5vcHRpb25zW29wdE5hbWVdOwogICAgICAgICAgICAgICAgICB2YXIgY2hlY2tlZCA9IEFhay5vcHRzW29wdE5hbWVdID09PSB0cnVlID8gImNoZWNrZWQiIDogJyc7CiAgICAgICAgICAgICAgICAgIEFhay5jcmVhdGVFbGVtZW50KHsKICAgICAgICAgICAgICAgICAgICB0YWcgOiAnZGl2JywKICAgICAgICAgICAgICAgICAgICBodG1sIDogJzxpbnB1dCBpZD0iJyArIG9wdE5hbWUgKyAnIiBjbGFzcz0iY3NzLWNoZWNrYm94IiAnICsgY2hlY2tlZCArICcgdHlwZT0iJyArIG9wdC50eXBlICsgJyIvPjxsYWJlbCBmb3I9IicgKyBvcHROYW1lICsgJyIgdGl0bGU9IicgKyBvcHQuaW5mbyArICciIGNsYXNzPSJjc3MtbGFiZWwiPicgKyBvcHQubGFiZWwgKyAnPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgIGFwcGVuZCA6ICcjYWFrLXNldHRpbmdzLScgKyBvcHQuZ3JvdXAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAvLyBzYXZlIG9wdGlvbnMgCiAgICAgICAgICAgICAgQWFrLm9uRXZlbnQoQWFrLmdldEVsZW1lbnQoIiNhYWstc2V0dGluZ3Mtc2F2ZSIpLCAiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgZWxlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY3NzLWNoZWNrYm94Jyk7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gZWxlbXNbaV07CiAgICAgICAgICAgICAgICAgIGlmIChlbGVtLmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgICAgICBBYWsuc2V0VmFsdWUoZWxlbS5pZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgQWFrLnNldFZhbHVlKGVsZW0uaWQsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KCdTYXZlZCAhJyk7CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIC8vIENsZWFyIEdNIHN0b3JhZ2UKICAgICAgICAgICAgICBBYWsuYWRkQ29tbWFuZHMoewogICAgICAgICAgICAgICAgY2FwdGlvbiA6ICdDbGVhciBHTSBzdG9yYWdlJywKICAgICAgICAgICAgICAgIGV4ZWN1dGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIEFhay5kZWxldGVWYWx1ZSgpOwogICAgICAgICAgICAgICAgICB3aW5kb3cuYWxlcnQoJ0NsZWFyZWQgIScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB1c2Vyc2NyaXB0c19kb21haW5zIDogeyAvLyBSZWRpcmVjdCB0byBHaXRodWIKICAgICAgICBob3N0IDogWyd1c2Vyc2NyaXB0cy5vcmcnLCAndXNlcnNjcmlwdHMub3JnOjgwODAnLCAndXNlcnNjcmlwdHMtbWlycm9yLm9yZyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoLzE1NTg0MCQvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpKSB7CiAgICAgICAgICAgIEFhay5nbyhBYWsuaG9tZVVSTCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBvcGVudXNlcmpzX29yZyA6IHsKICAgICAgICBob3N0IDogWydvcGVudXNlcmpzLm9yZyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbGVtZW50ID0gQWFrLmdldEVsZW1lbnQoJ2FbaHJlZiQ9Ii9pc3N1ZXMiXScpOwogICAgICAgICAgaWYgKC9BbnRpLUFkYmxvY2tfS2lsbGVyX1JlZWsvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpICYmIGVsZW1lbnQpIHsKICAgICAgICAgICAgQWFrLmNvbmZpcm1SZXBvcnQoZWxlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBncmVhc3lmb3JrX29yZyA6IHsKICAgICAgICBob3N0IDogWydncmVhc3lmb3JrLm9yZyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbGVtZW50ID0gQWFrLmdldEVsZW1lbnQoJ2FbaHJlZiQ9Ii9mZWVkYmFjayJdJyk7CiAgICAgICAgICBpZiAoLy1hbnRpLWFkYmxvY2sta2lsbGVyLXJlZWsvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpICYmIGVsZW1lbnQpIHsKICAgICAgICAgICAgQWFrLmNvbmZpcm1SZXBvcnQoZWxlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBtb25rZXlndXRzX2NvbSA6IHsKICAgICAgICBob3N0IDogWydtb25rZXlndXRzLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbGVtZW50ID0gQWFrLmdldEVsZW1lbnQoJ2FbaHJlZio9ImNvZGUucGhwP25hdj1mb3J1bSJdJyk7CiAgICAgICAgICBpZiAoL21vbmtleWd1dHMuY29tXC9jb2RlLnBocFw/aWQ9MzUxLy50ZXN0KGxvY2F0aW9uLmhyZWYpICYmIGVsZW1lbnQpIHsKICAgICAgICAgICAgQWFrLmNvbmZpcm1SZXBvcnQoZWxlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAvLyBTcGVjaWZpYwogICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICBibG9nc3BvdCA6IHsKICAgICAgICAvLyBObyBDb3VudHJ5IFJlZGlyZWN0IChOQ1IpCiAgICAgICAgLy8gUHJldmVudCBCbG9nZ2VyIGZyb20gUmVkaXJlY3RpbmcgdG8gQ291bnRyeS1TcGVjaWZpYyBEb21haW5zCiAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vN3JtMzRqbwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZyL2ZvcnVtL2Rpc2N1c3Npb24vNTk1MwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80OTAKICAgICAgICAvLyB0ZXN0OiBodHRwOi8vdGlueXVybC5jb20vbm9tY3hrYwogICAgICAgIGhvc3QgOiBbJy5ibG9nc3BvdC4nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKEFhay5pc1RvcGZyYW1lKSB7IC8vIGZpeCByZWRpcmV0aW9uIGxvb3AKICAgICAgICAgICAgdmFyIGJsb2cgPSBsb2NhdGlvbi5ob3N0LnJlcGxhY2UoJ3d3dy4nLCAnJykuc3BsaXQoIi4iKTsKICAgICAgICAgICAgaWYgKGJsb2dbYmxvZy5sZW5ndGggLSAxXSAhPSAiY29tIikgewogICAgICAgICAgICAgIHZhciBwYXRoID0gbG9jYXRpb24uaHJlZi5zcGxpdCgiLyIpLnNsaWNlKDMpLmpvaW4oJy8nKTsKICAgICAgICAgICAgICBBYWsuZ28oImh0dHA6Ly8iICsgYmxvZ1swXSArICIuYmxvZ3Nwb3QuY29tL25jci8iICsgcGF0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJsb2dzcG90X2tub3dsZXQzMzg5IDogewogICAgICAgIC8vIG5vdGU6IGFsc28gYWRkZWQgYWJwIHJ1bGUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODMKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vQTNtQ1hRNWkKICAgICAgICBob3N0IDogWydrbm93bGV0MzM4OS5ibG9nc3BvdC4nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldExvY2FsKCdub2FkJywgZmFsc2UpOwogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjZ0FkcyB7IGhlaWdodDogMTdweDsgfSAjZ0FkMiB7IGhlaWdodDogMTdweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXB0b2JveF91cHRvc3RyZWFtIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zNTEKICAgICAgICBob3N0IDogWyd1cHRvYm94LmNvbScsICd1cHRvc3RyZWFtLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBPbGQgc29sdXRpb24gW2RlcHJlY2F0ZWRdCiAgICAgICAgICB2YXIgaWQgPSBsb2NhdGlvbi5wYXRobmFtZS5tYXRjaCgvWzAtOWEtel17MTJ9Lyk7CiAgICAgICAgICBpZiAoaWQgIT09IG51bGwpIHsKICAgICAgICAgICAgQWFrLmFkZFN0eWxlKCIjIiArIGlkWzBdICsgIiB7IGhlaWdodDogMTJweDsgfSIpOwogICAgICAgICAgfQogICAgICAgICAgLy8gTmV3IDEyLjA1LjIwMTQKICAgICAgICAgIC8vICsgYWJwIHJ1bGUgKGFsdGVybmF0aXZlIHNvbHV0aW9uKQogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYWRibG9ja3RyYXAgeyBoZWlnaHQ6IDEycHg7IH0iKTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHJlbW92ZSBhZHMKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcqW3NyY149Imh0dHA6Ly9hZHMudXB0b2JveC5jb20vIl0sKltocmVmXj0iaHR0cDovL2Fkcy51cHRvYm94LmNvbS8iXScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYW5pc3Vic2lhX2NvbSA6IHsKICAgICAgICBob3N0IDogWydhbmlzdWJzaWEuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vICsgYWJwIHJ1bGUgI0AjLmFkc2FudGlsb2sKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFkc2FudGlsb2sgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmpBbnRpQmxvY2sgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgIEFhay51dy5DZWtCbG9rID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBmcmVlZ2FtZXNlcnZlcmhvc3RfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTEyCiAgICAgICAgaG9zdCA6IFsnZnJlZWdhbWVzZXJ2ZXJob3N0LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNmYWIxMyB7IGhlaWdodDogMTFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZWxhaG1hZF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnZWxhaG1hZC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYWRibG9jayB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtcnR6Y21wM19uZXQgOiB7CiAgICAgICAgaG9zdCA6IFsnbXJ0emNtcDMubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLnJ0bV9hZCB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBoZWlnaHRfbXlUZXN0QWQgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyNDEKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTgzCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI5MQogICAgICAgIGhvc3QgOiBbJ2JrbmltZS5jb20nLCAnZ280dXAuY29tJywgJ2RlYnJpZG8uY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLm15VGVzdEFkIHsgaGVpZ2h0OiAxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlYnJpZGZhc3RfbmV0d29yayA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9lbi9mb3J1bS9kaXNjdXNzaW9uLzk0MDYKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9lbi9mb3J1bS9kaXNjdXNzaW9uLzcwMTMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI3MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy83NjkKICAgICAgICBob3N0IDogWydkZWJyaWRmYXN0LmNvbScsICdnZXRkZWJyaWQuY29tJywgJ2RlYnJpZC51cycsICdsZWVjaGVyLnVzJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLm15VGVzdEFkLCAubXkyNEFkLCAubmFiaWwgeyBoZWlnaHQ6IDFweDsgfSIpOwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NpbXBsZUFkJykuaW5uZXJIVE1MID0gJzxwIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij5kZWJyaWRmYXN0LmNvbTwvcD4nOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmdfZ2xlZGFpX3R2IDogewogICAgICAgIGhvc3QgOiBbJ2JnLWdsZWRhaS50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5teUFkIHsgaGVpZ2h0OiAxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRoZXBjc3B5X2NvbSA6IHsgLy8gaHR0cDovL3RoZXBjc3B5LmNvbS9yZWFkL2hvd190b19ibG9ja19hZGJsb2NrLwogICAgICAgIGhvc3QgOiBbJ3RoZXBjc3B5LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5teVRlc3RBZCB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5ibG9ja2VkIHsgZGlzcGxheTogbm9uZTsgfSIpOwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJy5ibG9ja2VkJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICB2Z19lMjRfbm8gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI5MgogICAgICAgIGhvc3QgOiBbJ3ZnLm5vJywgJ2UyNC5ubyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBBZGQgdGhpcyBydWxlLCBiZWNhdXNlIEVhc3lMaXN0IGFsbG93IGFsbCBoaWRkZW4gZWxlbWVudHMuCiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5hZCB7IGRpc3BsYXk6IG5vbmU7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGF1dG9tb2JpbGVfc3BvcnRpdmVfY29tIDogewogICAgICAgIGhvc3QgOiBbJ2F1dG9tb2JpbGUtc3BvcnRpdmUuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLm15VGVzdEFkIHsgaGVpZ2h0OiA1MXB4OyBkaXNwbGF5OiBub25lOyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBzbnN3X3VzIDogewogICAgICAgIGhvc3QgOiBbJ3Nuc3cudXMnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYWRfMSB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICB1cmxjaGVja2VyX25ldCA6IHsKICAgICAgICBob3N0IDogWyd1cmxjaGVja2VyLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNhZGNoZWNrZXIgeyBoZWlnaHQ6IDIwcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNraXBsaW1pdGVfdHYgOiB7CiAgICAgICAgaG9zdCA6IFsnc2tpcGxpbWl0ZS50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoImRpdi5hZGR0aGlzX25hdGl2ZV90b29sYm94ICsgZGl2W2lkXSB7IGhlaWdodDogMTJweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmlsZWNvcmVfY29fbnogOiB7CiAgICAgICAgaG9zdCA6IFsnZmlsZWNvcmUuY28ubnonXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuYWRzZW5zZSB7IGhlaWdodDogNXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICB0aG9tYXNfbl9ydXRoX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTExMQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9mdTd2a1VBMQogICAgICAgIGhvc3QgOiBbJ3Rob21hcy1uLXJ1dGguY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLkdvb2dsZSB7IGhlaWdodDogNXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBpbnRlcmZhbnNfb3JnIDogewogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly93d3cuaW50ZXJmYW5zLm9yZy9mb3J1bS8KICAgICAgICBob3N0IDogWydpbnRlcmZhbnMub3JnJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFkX2dsb2JhbF9oZWFkZXIgeyBoZWlnaHQ6IDFweDsgZGlzcGxheTogbm9uZTsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWF4ZGVicmlkZXVyX2NvbSA6IHsKICAgICAgICBob3N0IDogWydtYXhkZWJyaWRldXIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmNsZWFyICsgZGl2W2lkXSB7IGhlaWdodDogMTJweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdG9wem9uZV9pdCA6IHsKICAgICAgICBob3N0IDogWyd0b3B6b25lLmx0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmZvcnVtQWQgeyBoZWlnaHQ6IDFweDsgZGlzcGxheTogbm9uZTsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbmFuYTEwX2NvX2lsIDogewogICAgICAgIGhvc3QgOiBbJy5uYW5hMTAuJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2FkdmVydC10cmFja2VyIHsgaGVpZ2h0OiAxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBsZWpfdHYgOiB7CiAgICAgICAgaG9zdCA6IFsncGxlai50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5hZHZlcnRfYm94IHsgaGVpZ2h0OiAxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1hbmdhbWludF9jb20gOiB7CiAgICAgICAgLy8gbm90ZTogYWRkZWQgcnVsZSB0byBhbGxvdyAiLmFkNzI4IgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2lkL2ZvcnVtL2Rpc2N1c3Npb24vODUyNAogICAgICAgIGhvc3QgOiBbJ21hbmdhbWludC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuYWQ3MjggeyBoZWlnaHQ6IDMxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlYnJpZGV1cnN0cmVhbV9mciA6IHsKICAgICAgICBob3N0IDogWydkZWJyaWRldXJzdHJlYW0uZnInXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjY29udGVudCBkaXZbaWRdW2FsaWduPWNlbnRlcl0geyBoZWlnaHQ6IDEycHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHByZWVtbGlua3NfY29tIDogewogICAgICAgIGhvc3QgOiBbJ3ByZWVtbGlua3MuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2RpdmFkcyB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBoZW50YWlfdG8gOiB7CiAgICAgICAgaG9zdCA6IFsnaGVudGFpLnRvJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2hlbnRhaXRvMTIzIHsgaGVpZ2h0OiAxMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBwcm90b3R1cmtfY29tIDogewogICAgICAgIGhvc3QgOiBbJ3Byb3RvdHVyay5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjcmVrbGFtIHsgaGVpZ2h0OiAxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11ZmFfZGUgOiB7CiAgICAgICAgaG9zdCA6IFsnbXVmYS5kZSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNsZWFkZXJib2FyZCB7IGhlaWdodDogNXB4OyB9Iik7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNsYXJnZS1yZWN0YW5nbGUgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYWQtaGVhZGVyLTQ2OHg2MCB7IGhlaWdodDogNXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICB3YXRjaGFyYWJfY29tIDogewogICAgICAgIGhvc3QgOiBbJ3dhdGNoYXJhYi5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gKyBhZHAgcnVsZSB3YXRjaGFyYWIuY29tI0AjI2FkYmxvY2sKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2FkYmxvY2sgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZnJlZWRvbWlwX2NvbSA6IHsKICAgICAgICBob3N0IDogWydmcmVlZG9tLWlwLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5wdWJfdmVydGljYWwgaW5zLCAucHViX3ZlcnRpY2FsIGRpdiB7IGhlaWdodDogMTFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgd2FrYW5pbV90diA6IHsKICAgICAgICBob3N0IDogWyd3YWthbmltLnR2J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2RldGVjdG9yIHsgZGlzcGxheTogbm9uZTsgfSIpOwogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjbm9wdWIgeyBkaXNwbGF5OiBibG9jazsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2ltcGx5X2RlYnJpZF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzMzMgogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9iN01BWVhzNAogICAgICAgIGhvc3QgOiBbJ3NpbXBseS1kZWJyaWQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZHNieWdvb2dsZSA9IHt9OwogICAgICAgICAgQWFrLnV3LmFkc2J5Z29vZ2xlLmxvYWRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICBtYW5nYTlfY29tIDogewogICAgICAgIGhvc3QgOiBbJ21hbmdhOS5jb20nLCAnbWFuZ2FiZWUuY28nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuYWRibG9jayB7IGhlaWdodDogMzFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgb25lbWFuZ2EyX2NvbSA6IHsKICAgICAgICBob3N0IDogWydvbmVtYW5nYTIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFmc19hZHMgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWFuZ2FiaXJkX2NvbSA6IHsKICAgICAgICBob3N0IDogWydtYW5nYWJpcmQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFmc19hZHMgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAga29kaWxpdmVfZXUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE1MjgKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vWnh2WEtxdGMKICAgICAgICBob3N0IDogWydrb2RpbGl2ZS5ldSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5BZCB7IGhlaWdodDogNXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBiYWNraW5fbmV0IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWJhY2tpbi5uZXQKICAgICAgICBob3N0IDogWydiYWNraW4ubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2RpdmFkIHsgaGVpZ2h0OiAzMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtb2JpbGVfdHJhY2tlcl9mcmVlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTA4MgogICAgICAgIGhvc3QgOiBbJ21vYmlsZS10cmFja2VyLWZyZWUuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI215QWRzIHsgaGVpZ2h0OiAxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHdvcmt1cGxvYWRfY29tIDogewogICAgICAgIC8vIG5vdGU6IG9iZnVzY2F0ZWQKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTMzNAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjkwCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0NQemQyU3d4CiAgICAgICAgaG9zdCA6IFsnd29ya3VwbG9hZC5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFkQmxvY2ssIC5hZHNieWdvb2dsZSwgI3NhZCB7IGhlaWdodDogMTFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdG9kYXlfaW4gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9aW50b2RheS5pbgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWJ1c2luZXNzdG9kYXkuaW4KICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vZ3o1MzlHN20KICAgICAgICBob3N0IDogWyJpbnRvZGF5LmluIiwgImJ1c2luZXNzdG9kYXkuaW4iXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24oKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoJyNhZGJvY2tlcl9hbHQgeyBkaXNwbGF5OiBub25lOyB9Jyk7CiAgICAgICAgICBBYWsudXcub3BlblBvcHVwID0gZnVuY3Rpb24oKXt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgamNfbXBfY29tIDogewogICAgICAgIC8vIGJ5OiBHaXdheXVtZQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTk3CiAgICAgICAgaG9zdCA6IFsiamMtbXAuY29tIl0sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCcuYWRzZW5zZSB7d2lkdGg6IDFweDsgaGVpZ2h0OiAxcHg7IHZpc2liaWxpdHk6IGhpZGRlbjsgZGlzcGxheTogYmxvY2s7IHBvc2l0aW9uOiBhYnNvbHV0ZTt9Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtYXJpYWdlX2ZyYW5jb19tYXJvY2Fpbl9uZXQgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bWFyaWFnZS1mcmFuY28tbWFyb2NhaW4ubmV0CiAgICAgICAgaG9zdCA6IFsibWFyaWFnZS1mcmFuY28tbWFyb2NhaW4ubmV0Il0sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCcjbXlfYWRfZGl2IHtoZWlnaHQ6IDFweDt9Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBoYXBweV9oYWNrX3J1IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWhhcHB5LWhhY2sucnUKICAgICAgICBob3N0IDogWydoYXBweS1oYWNrLnJ1J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2Jsb2NrYmxvY2tGNCB7dmlzaWJpbGl0eTppbnZpc2libGU7ZGlzcGxheTpub25lO30gI2Jsb2NrYmxvY2tGNCB0ZCB7dmlzaWJpbGl0eTppbnZpc2libGU7ZGlzcGxheTpub25lO30gI2Jsb2NrYmxvY2tGNCB0ZCBwIHt2aXNpYmlsaXR5OmludmlzaWJsZTtkaXNwbGF5Om5vbmU7fSAjYmxvY2tibG9ja0QzIHt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTpibG9jazt9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBmb3JiZXNfY29tIDogewogICAgICAgIC8vIGJ5OiBHaXdheXVtZQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84NjUKICAgICAgICBob3N0IDogWydmb3JiZXMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZignL3dlbGNvbWUnKSA+IC0xKSB7CiAgICAgICAgICAgIEFhay5zZXRDb29raWUoJ3dlbGNvbWVBZCcsICd0cnVlJywgODY0MDAwMDAsICcvJyk7CiAgICAgICAgICAgIEFhay5zZXRDb29raWUoJ2RhaWx5V2VsY29tZUNvb2tpZScsICd0cnVlJywgODY0MDAwMDAsICcvJyk7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IEFhay5nZXRDb29raWUoJ3RvVXJsJykgfHwgJ2h0dHA6Ly93d3cuZm9yYmVzLmNvbS8nOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgYmFpdF9hZHNieWdvb2dsZSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTQ3CiAgICAgICAgaG9zdCA6IFsnYml0Y29pbmFsaWVucy5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdpbnMuYWRzYnlnb29nbGUnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJhaXRfdGVzdGVyIDogewogICAgICAgIGhvc3QgOiBbJ29zb2FyY2FkZS5jb20nLCAnZDNicmlkNHkwdS5pbmZvJywgJ2ZpbGVpY2UubmV0JywgJ25vc3RlYW0ucm8nLCAnb3BlbnJ1bm5lci5jb20nLCAnZWFzeWJpbGxldHMuY29tJywgJ3Nwb3guZnInLCAneW92b3lhZ2VzLmNvbScsICd0djMuY28ubnonLCAnZnJlZWFsbG11c2ljLmluZm8nLCAncHV0bG9ja2VyLmNvbScsICdzb2Nrc2hhcmUuY29tJywgJ2RyYW1hcGFzc2lvbi5jb20nLCAneW9vY2xpY2suY29tJywgJ29ubGluZS51YSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiN0ZXN0ZXInKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJhaXRfYWRkIDogewogICAgICAgIGhvc3QgOiBbJ2ZpbGVjb20ubmV0JywgJ3Vwc2hhcmUub3JnJywgJ3NraXBweWZpbGUuY29tJywgJ213ZmlsZXMubmV0JywgJ3VwLWZsb3cub3JnJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkZCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmFpdF9hZHBidGVzdCA6IHsKICAgICAgICBob3N0IDogWydsZWFndWVzZWNyZXRhcnkuY29tJywgJ3Rla25vZ29kcy5jb20nLCAnaGVsbHNtZWRpYS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWRwYnRlc3QnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJhaXRfYWR0ZXN0ZXIgOiB7CiAgICAgICAgaG9zdCA6IFsnZnJlZXNwb3J0c2JldC5jb20nLCAnc3BvcnRzcGxheXMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkLXRlc3RlcicpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdGdvX3R2X2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzAzCiAgICAgICAgaG9zdCA6IFsndGdvLXR2LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNhZGIsICNiYW5uZXJhZDEsIC5sb2FkX3N0cmVhbSB7IGRpc3BsYXk6IG5vbmU7IH0iKTsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I3Rlc3RlcicpOwogICAgICAgIH0sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcudGhyZXNob2xkID0gMTAwMDsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcuY2hhdF9mcmFtZScpOyAvLyBidWcgcmVsb2FkIGlmcmFtZQogICAgICAgIH0KICAgICAgfSwKICAgICAgZnJlZWdhbWVob3N0aW5nX25sIDogewogICAgICAgIGhvc3QgOiBbJ2ZyZWVnYW1laG9zdGluZy5ubCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZHRlc3QnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRoZXdlYXRoZXJzcGFjZV9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsndGhld2VhdGhlcnNwYWNlLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhYi1ibC1hZHZlcnRpc2VtZW50Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBjbGVvZGVza3RvcF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzcxMQogICAgICAgIGhvc3QgOiBbJ2NsZW9kZXNrdG9wLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNteVRlc3RBZCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaW1hZ2VyYWlkZXJfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84MjYKICAgICAgICBob3N0IDogWydpbWFnZXJhaWRlci5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjbXlHQ29udGFpbmVyJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICB2b2ljaV9mciA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mci9mb3J1bS9kaXNjdXNzaW9uLzEwMDkzCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzgyNgogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS96RVZRSFRpRAogICAgICAgIGhvc3QgOiBbJ3ZvaWNpLmZyJywgJ3Byb2dyYW1tZS10di5uZXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjc2FzX3NjcmlwdDInKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1pbF9pbmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE2NTIKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vNDc0Tlp6UEoKICAgICAgICBob3N0IDogWydtaWwuaW5rJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2Fkc19kaXYnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGN1YmV1cGxvYWRfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL2ZvcnVtL2Rpc2N1c3Npb24vNTkxOQogICAgICAgIGhvc3QgOiBbJ2N1YmV1cGxvYWQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5jcmVhdGVFbGVtZW50KHsKICAgICAgICAgICAgdGFnIDogJ2lmcmFtZScsCiAgICAgICAgICAgIG5hbWUgOiAnaWZyYW1lJywKICAgICAgICAgICAgc3JjIDogJ2Fib3V0OmJsYW5rJywKICAgICAgICAgICAgc3R5bGUgOiAnZGlzcGxheTpub25lOycsCiAgICAgICAgICAgIGFwcGVuZCA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzdHJlYW00ZnJlZV9ldSA6IHsKICAgICAgICBob3N0IDogWydzdHJlYW00ZnJlZS5ldSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyArYWJwIGFsdCBzb2x1dGlvbgogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjanBheWRheScpOwogICAgICAgICAgQWFrLnV3LmpwYXlkYXlfYWxlcnQgPSAxOwogICAgICAgIH0KICAgICAgfSwKICAgICAgXzNkbmV3c19ydSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9ydS9mb3J1bS9kaXNjdXNzaW9uLzU3NTAKICAgICAgICBob3N0IDogWyczZG5ld3MucnUnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnYWRibG9ja3dhcm4nLCAxKTsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2VhckFkcyB7IHdpZHRoOiA0MDFweDsgfSIpOwogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjZWFyQWRzJyk7CiAgICAgICAgICBBYWsudXcuX19BVF9kZXRlY3RlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICBfM2RzdGhlbV9lcyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT0zZHN0aGVtCiAgICAgICAgaG9zdCA6IFsnM2RzdGhlbS5lcyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvL0Fhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkge30pOwogICAgICAgIH0sCiAgICAgICAgb25CZWZvcmVTY3JpcHQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgLyoKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ21haW4uanMnLAogICAgICAgICAgICAgIGV4dGVybmFsIDogdHJ1ZSwKICAgICAgICAgICAgICBvdmVycmlkZSA6ICcvL3Bhc3RlYmluLmNvbS9yYXcvMnlHUlBoUlonCiAgICAgICAgICAgIH0KICAgICAgICAgIF07CiAgICAgICAgKi8KICAgICAgICB9CiAgICAgIH0sCiAgICAgIF84bXVzZXNfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPThtdXNlcwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZvcnVtL2Rpc2N1c3Npb24vODUxNQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL2ZvcnVtL2Rpc2N1c3Npb24vNjQwNwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9iTU5EeGVjcwogICAgICAgIGhvc3QgOiBbJzhtdXNlcy5jb20nXSwKICAgICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGNvbnRhaW5zIDogInR5cGVvZiBleG8iLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVtb3ZlIDogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaGFwcHl0cmlwc19jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9aGFwcHl0cmlwcwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9FV1NFYm52dgogICAgICAgIGhvc3QgOiBbJ2hhcHB5dHJpcHMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgnY2FuUnVuJywgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBsZ19maXJtd2FyZV9yb21fY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWxnLWZpcm13YXJlLXJvbS5jb20KICAgICAgICBob3N0IDogWydsZy1maXJtd2FyZS1yb20uY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgna2lsbGFkcycsIHRydWUpOwogICAgICAgIH0KICAgICAgfSwgICAgICAKICAgICAgbWlkX2RheV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bWlkLWRheS5jb20KICAgICAgICBob3N0IDogWydtaWQtZGF5LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ2NhblJ1bicsIHRydWUpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmFkdHZfbmV0d29yayA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1iYWR0di5pdAogICAgICAgIGhvc3QgOiBbJ2JhZHR2Lml0JywgJ2JhZHRhc3RlLml0JywgJ2JhZGdhbWVzLml0JywgJ2JhZGNvbWljcy5pdCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdhZEJsb2NrQ2hlY2tlZCcsICdkaXNhdHRpdm8nKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGluZGVwZW5kZW50X2NvX3VrIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWluZGVwZW5kZW50LmNvLnVrCiAgICAgICAgaG9zdCA6IFsnaW5kZXBlbmRlbnQuY28udWsnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnYWRibG9ja19kZXRlY3RlZCcsICdpZ25vcmVkJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBlc21hc19jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9ZXNtYXMuY29tCiAgICAgICAgaG9zdCA6IFsnZXNtYXMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgnb3BlbmVkX2FkYmJsb2NrJywgZmFsc2UpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcGlub3kxdHZfbmV0d29yayA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1waW5veTF0dgogICAgICAgIGhvc3QgOiBbJ3Bpbm95MXR2LiddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ2FsbG93YWRzJywgMSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBld2FsbHN0cmVldGVyX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1ld2FsbHN0cmVldGVyLmNvbQogICAgICAgIGhvc3QgOiBbJ2V3YWxsc3RyZWV0ZXIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgnT0FTX3JkbCcsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYnVzaW5lc3Nfc3RhbmRhcmRfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWJ1c2luZXNzLXN0YW5kYXJkLmNvbQogICAgICAgIGhvc3QgOiBbJ2J1c2luZXNzLXN0YW5kYXJkLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ2Fkc0xvYWRlZCcsIDEpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgnX3B3JywgJ3QnKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICB9LAogICAgICBleHByZXNzX25ldHdvcmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9ZmluYW5jaWFsZXhwcmVzcy5jb20KICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1pbmRpYW5leHByZXNzLmNvbQogICAgICAgIGhvc3QgOiBbJ2ZpbmFuY2lhbGV4cHJlc3MuY29tJywgJ2luZGlhbmV4cHJlc3MuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgnUnVuQWRzJywgMSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBpbmRpYXRpbWVzX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1pbmRpYXRpbWVzCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bWFsYXlhbGFtLnNhbWF5YW0uY29tCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL3p4dXN2eWYsIAogICAgICAgIGhvc3QgOiBbJ2luZGlhdGltZXMuY29tJywgJ3NhbWF5YW0uY29tJywgJ2JhbmdhbG9yZW1pcnJvci5jb20nXSwKICAgICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ1xcXFx4NjFcXFxceDY0XFxcXHg2MicsCiAgICAgICAgICAgICAgZXh0ZXJuYWwgOiBmYWxzZSwKICAgICAgICAgICAgICByZW1vdmUgOiB0cnVlCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICBjb250YWlucyA6ICdmdW5jdGlvbiBpbml0QmxvY2snLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVtb3ZlIDogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdGhlY2hpdmVfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNDUzCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1RkcFB5cmJiCiAgICAgICAgaG9zdCA6IFsndGhlY2hpdmUuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3aW5kb3csIHsKICAgICAgICAgICAgICBzdGVwaGFuZURldGVjdG9yIDogewogICAgICAgICAgICAgICAgdmFsdWUgOiB7CiAgICAgICAgICAgICAgICAgIGhvb2sgOiBmdW5jdGlvbiAoY2IpIHsKICAgICAgICAgICAgICAgICAgICBjYihmYWxzZSk7CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIGluaXQgOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICAgICAgICAgICAgYnJvYWRjYXN0UmVzdWx0IDogZnVuY3Rpb24gKCkge30KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcmljaG9ucmFpbHNfY29tIDogewogICAgICAgIC8vIGJ5OiBHaXdheXVtZQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNDQ3CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0V3ZndnOEJHCiAgICAgICAgaG9zdCA6IFsncmljaG9ucmFpbHMuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBhZHNCeUdvb2dsZUh0bWwgPSAnIjxpbnMraWQ9ImFzd2lmdF8wX2V4cGFuZCIrc3R5bGU9ImRpc3BsYXk6aW5saW5lLXRhYmxlO2JvcmRlcjpub25lO2hlaWdodDo5MHB4O21hcmdpbjowO3BhZGRpbmc6MDtwb3NpdGlvbjpyZWxhdGl2ZTt2aXNpYmlsaXR5OnZpc2libGU7d2lkdGg6NzUwcHg7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudCI+PGlucytpZD0iYXN3aWZ0XzBfYW5jaG9yIitzdHlsZT0iZGlzcGxheTpibG9jaztib3JkZXI6bm9uZTtoZWlnaHQ6OTBweDttYXJnaW46MDtwYWRkaW5nOjA7cG9zaXRpb246cmVsYXRpdmU7dmlzaWJpbGl0eTp2aXNpYmxlO3dpZHRoOjc1MHB4O2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQiPjxpZnJhbWUrbWFyZ2lud2lkdGg9IjAiK21hcmdpbmhlaWdodD0iMCIrdnNwYWNlPSIwIitoc3BhY2U9IjAiK2FsbG93dHJhbnNwYXJlbmN5PSJ0cnVlIitzY3JvbGxpbmc9Im5vIithbGxvd2Z1bGxzY3JlZW49InRydWUiK29ubG9hZD0idmFyK2k9dGhpcy5pZCxzPXdpbmRvdy5nb29nbGVfaWZyYW1lX29uY29weSxIPXMmYW1wOyZhbXA7cy5oYW5kbGVycyxoPUgmYW1wOyZhbXA7SFtpXSx3PXRoaXMuY29udGVudFdpbmRvdyxkO3RyeXtkPXcuZG9jdW1lbnR9Y2F0Y2goZSl7fWlmKGgmYW1wOyZhbXA7ZCZhbXA7JmFtcDsoIWQuYm9keXx8IWQuYm9keS5maXJzdENoaWxkKSl7aWYoaC5jYWxsKXtzZXRUaW1lb3V0KGgsMCl9ZWxzZStpZihoLm1hdGNoKXt0cnl7aD1zLnVwZChoLGkpfWNhdGNoKGUpe313LmxvY2F0aW9uLnJlcGxhY2UoaCl9fSIraWQ9ImFzd2lmdF8wIituYW1lPSJhc3dpZnRfMCIrc3R5bGU9ImxlZnQ6MDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDsiK3dpZHRoPSI3NTAiK2ZyYW1lYm9yZGVyPSIwIitoZWlnaHQ9IjkwIj48L2lmcmFtZT48L2lucz48L2lucz4iJzsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICB1cmwgOiAkKCIuYXJ0aWNsZS1jb250ZW50IikuZGF0YSgidXJsIiksCiAgICAgICAgICAgICAgZGF0YVR5cGUgOiAic2NyaXB0IiwKICAgICAgICAgICAgICBtZXRob2QgOiAicG9zdCIsCiAgICAgICAgICAgICAgZGF0YSA6IHsKICAgICAgICAgICAgICAgIGh0bWwgOiBhZHNCeUdvb2dsZUh0bWwKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICB2YXIgZXhlYyA9IHJlc3VsdC5yZXBsYWNlKCIkKCcuYXJ0aWNsZS1jb250ZW50JykiLCAiJCgnLmFydGljbGUtY29udGVudC0yJykiKTsKICAgICAgICAgICAgICAgIG5ldyBGdW5jdGlvbihleGVjKSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICQoIi5hcnRpY2xlLWNvbnRlbnQiKS5hZnRlcignPGRpdiBjbGFzcz0iYXJ0aWNsZS1jb250ZW50LTIiPjwvZGl2PicpLnJlbW92ZSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBybXByZXB1c2JfY29tIDogewogICAgICAgIGhvc3QgOiBbJ3JtcHJlcHVzYi5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnam90X3ZpZXdlcicsIDMpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbmVvZHJpdmVfY28gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEwMDEKICAgICAgICBob3N0IDogWyduZW9kcml2ZS5jbyddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gUHJldmVudCBwb3B1bmRlcgogICAgICAgICAgQWFrLnNldENvb2tpZSgnS2lmUG9wQ250JywgMSwgbnVsbCwgJy9lbWJlZC8nKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGhlbnRhaWhhdmVuX29yZyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL2dvcmhpbGwvdUJsb2NrL2lzc3Vlcy8xMzQwCiAgICAgICAgaG9zdCA6IFsnaGVudGFpaGF2ZW4ub3JnJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBQcmV2ZW50IHBvcHVuZGVyCiAgICAgICAgICBBYWsuc2V0Q29va2llKCdoaF9wcG5kcjEnLCAxKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2hoX3BwbmRyMicsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJpbWVzaGFyZV90diA6IHsKICAgICAgICBob3N0IDogWydwcmltZXNoYXJlLnR2J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkYmxvY2snKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlYnJpZG5ldF9hbmRfbGl2ZWRlYnJpZCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1kZWJyaWRuZXQKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1saXZlZGVicmlkCiAgICAgICAgaG9zdCA6IFsnZGVicmlkbmV0LmNvbScsICdsaXZlZGVicmlkLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5teVRlc3RBZDIgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYubXlUZXN0QWQyJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBibHVlc2F0b3NoaV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg3MwogICAgICAgIGhvc3QgOiBbJ2JsdWVzYXRvc2hpLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiN0ZXN0IHsgaGVpZ2h0OiAyODBweDsgfSIpOwogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjdGVzdCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcmF6ZXJjcnlwdF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg3MAogICAgICAgIGhvc3QgOiBbJ3JhemVyY3J5cHQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI3Rlc3QgeyBoZWlnaHQ6IDI1MHB4OyB9Iik7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiN0ZXN0Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzYXRvc2hpZW1waXJlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODcyCiAgICAgICAgaG9zdCA6IFsnc2F0b3NoaWVtcGlyZS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjdGVzdCB7IGhlaWdodDogMjUwcHg7IH0iKTsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I3Rlc3QnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG9uZWFkZmF1Y2V0X2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODcxCiAgICAgICAgaG9zdCA6IFsnb25lYWRmYXVjZXQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI3Rlc3QgeyBoZWlnaHQ6IDI1MHB4OyB9Iik7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiN0ZXN0Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBqa2FuaW1lX25ldCA6IHsKICAgICAgICBob3N0IDogWydqa2FuaW1lLm5ldCddLAogICAgICAgIC8vIEBAfHxqa2FuaW1lLm5ldC9hc3NldHMvanMvYWR2ZXJ0aXNlbWVudDIuanMKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjcmVjbycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgXzcyMHBta3ZfY29tIDogewogICAgICAgIGhvc3QgOiBbJzcyMHBta3YuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkdmVydCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcGFpZHZlcnRzX2NvbSA6IHsKICAgICAgICBob3N0IDogWydwYWlkdmVydHMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2LmFmc19hZHMnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGl0YWxpYXR2X29yZyA6IHsKICAgICAgICBob3N0IDogWydpdGFsaWF0di5vcmcnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjZmFiMTMnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNocmlzc21vb3ZlX2NvbSA6IHsKICAgICAgICBob3N0IDogWydjaHJpc3Ntb292ZS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy9BYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZHNlcnZlcicpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZXZlbnRodWJzX2NvbSA6IHsKICAgICAgICBob3N0IDogWydldmVudGh1YnMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2JsYWh5YmxhY2kxJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzdXBlcmFuaW1lc19jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyOTUKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vRkRQQUtqVFEKICAgICAgICBob3N0IDogWydzdXBlcmFuaW1lcy5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYmFubmVyTG9qYScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZm9ydW1fcGFjX3JvbV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI0MwogICAgICAgIGhvc3QgOiBbJ2ZvcnVtLnBhYy1yb20uY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2LmJhbm5lcl9hZHMnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxpdHZfdHYgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyOTkKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vemNkZHZUdUMKICAgICAgICBob3N0IDogWydsaXR2LnR2J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2LnBsYXllcl9tYXNrJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBsZXZlbGRvd25fZnIgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU5NQogICAgICAgIGhvc3QgOiBbJ2xldmVsZG93bi5mciddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZGJsb2NrJyk7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZGJsb2NrdGVzdCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2xvYmVzbG90X2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTI0CiAgICAgICAgaG9zdCA6IFsnZ2xvYmVzbG90LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZGQnKTsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkZDEnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFudGVubmVzcG9ydF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnYW50ZW5uZXNwb3J0LmNvbScsICdzZXJ2ZXJoZC5ldSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsgLy8gZm9yIGFudGVubmVzcG9ydAogICAgICAgICAgLy8gUmVtb3ZlIFB1YgogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoIiNwdWIgLnB1YmNsb3NlIik7CiAgICAgICAgICAvLyBSZWRpcmVjdCB0byBQbGF5ZXIKICAgICAgICAgIEFhay5zZXRFbGVtZW50KCcjcHViIC5lbWJlZCBpZnJhbWUnLCB7CiAgICAgICAgICAgIHNyYyA6ICcvZW1iZWQvZW1iZWQucGhwJwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkaXNhYmxlQWxlcnRib3ggOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZW4vZm9ydW0vZGlzY3Vzc2lvbi84NjExCiAgICAgICAgaG9zdCA6IFsnZHJpdmVhcmFiaWEuY29tJywgJ3B1dGxvY2tlci5jb20nLCAnZG9hdG9vbHNpdGEuYWx0ZXJ2aXN0YS5vcmcnLCAnc29ja3NoYXJlLmNvbScsICdmcmVlLW1vdmllLWhvbWUuY29tJywgJ3BjLm9ubGluZTE0My5jb20nLCAna29vb3JhLmNvbScsICdzdHIzYW10di5jby5ucicsICdzdHIzYW10di5hbHRlcnZpc3RhLm9yZycsICdzdHIzYW0uYWx0ZXJ2aXN0YS5vcmcnLCAnZmlsZWNvbS5uZXQnLCAncGlwb2Nhcy50dicsICdnZW5lcmF0dXByZW1pdW0uYml6JywgJ21lZ2EtZGVicmlkLmV1JywgJ3ByZW1pdW1zdDByZS5ibG9nc3BvdC5jb20nLCAnZGwtcHJvdGVjdC5jb20nLCAnbmV3c2lubGV2ZWxzLmNvbScsICd2aXByYWNpbmcuYml6JywgJ2J1c2luZXNzdG9kYXkuaW4nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hbGVydCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2VuZXJhdHVwcmVtaXVtX2JpeiA6IHsKICAgICAgICBob3N0IDogWydnZW5lcmF0dXByZW1pdW0uYml6J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIERpc2FibGUgQ29uZmlybSBCb3gKICAgICAgICAgIC8vQWFrLnV3LmNvbmZpcm0gPSBmdW5jdGlvbiAoKXt9OwogICAgICAgICAgQWFrLnNldENvb2tpZSgnZ2VuZXJhJywgZmFsc2UpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbmV3c3RhdGVzbWFuX2NvbSA6IHsKICAgICAgICBob3N0IDogWyduZXdzdGF0ZXNtYW4uY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2RvbmF0aW9uUG9wdXAnLCAnaGlkZScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYWRzd2l6el9jb20gOiB7CiAgICAgICAgLy8gYnk6IFNrcjR0Y2hHcjNhenlNb25raUJhbGxsbGxsWnp6egogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84MDkKICAgICAgICBob3N0IDogWyd5ZXMuZm0nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHdpbmRvdy5jb21fYWRzd2l6el9zeW5jaHJvX2luaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVyc3RhbmRhcmRfYXQgOiB7CiAgICAgICAgLy8gYnk6IEFsZXhhbmRlcjI1NQogICAgICAgIC8vIHBhdGNoOiBodHRwOi8vcGFzdGViaW4uY29tL3Jhdy5waHA/aT1yN1E0RHJmQgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWRlcnN0YW5kYXJkCiAgICAgICAgaG9zdCA6IFsnZGVyc3RhbmRhcmQuYXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewoKICAgICAgICAgIHZhciBtYWtlSVNPVGltZXN0YW1wVVRDID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcGFkID0gZnVuY3Rpb24gKGFtb3VudCwgd2lkdGgpIHsKICAgICAgICAgICAgICB2YXIgcGFkZGluZyA9ICIiOwogICAgICAgICAgICAgIHdoaWxlIChwYWRkaW5nLmxlbmd0aCA8IHdpZHRoIC0gMSAmJiBhbW91bnQgPCBNYXRoLnBvdygxMCwgd2lkdGggLSBwYWRkaW5nLmxlbmd0aCAtIDEpKSB7CiAgICAgICAgICAgICAgICBwYWRkaW5nICs9ICIwIjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHBhZGRpbmcgKyBhbW91bnQudG9TdHJpbmcoKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgcmV0dXJuIFtwYWQoZGF0ZS5nZXRVVENGdWxsWWVhcigpLCA0KSwgIi0iLAogICAgICAgICAgICAgIHBhZChkYXRlLmdldFVUQ01vbnRoKCkgKyAxLCAyKSwgIi0iLAogICAgICAgICAgICAgIHBhZChkYXRlLmdldFVUQ0RhdGUoKSwgMiksICJUIiwKICAgICAgICAgICAgICBwYWQoZGF0ZS5nZXRVVENIb3VycygpLCAyKSwgIjoiLAogICAgICAgICAgICAgIHBhZChkYXRlLmdldFVUQ01pbnV0ZXMoKSwgMiksICI6IiwKICAgICAgICAgICAgICBwYWQoZGF0ZS5nZXRVVENTZWNvbmRzKCksIDIpXS5qb2luKCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOyAnKS5mb3JFYWNoKGZ1bmN0aW9uIChjb29raWUpIHsKICAgICAgICAgICAgLy8gRmluZCBtYWluIHN0b3JhZ2UgY29va2llCiAgICAgICAgICAgIGlmIChjb29raWUuc3Vic3RyKDAsIDYpID09ICJNR1VJRD0iKSB7CiAgICAgICAgICAgICAgLy8gRGVjb21wb3NlIGluZm9ybWF0aW9uIGZyb20gbWFpbiBzdG9yYWdlIGNvb2tpZQogICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB7fTsKICAgICAgICAgICAgICBjb29raWUuc3Vic3RyKDYpLnNwbGl0KCImIikuZm9yRWFjaChmdW5jdGlvbiAoYXNzaWdubWVudCkgewogICAgICAgICAgICAgICAgdmFyIHBvcyA9IGFzc2lnbm1lbnQuaW5kZXhPZignPScpOwogICAgICAgICAgICAgICAgaWYgKHBvcyA+IC0xKSB7CiAgICAgICAgICAgICAgICAgIHZhbHVlc1thc3NpZ25tZW50LnN1YnN0cigwLCBwb3MpXSA9IGFzc2lnbm1lbnQuc3Vic3RyKHBvcyArIDEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAvLyBVcGRhdGUgImZpcnN0IHZpZXdlZCIgdGltZXN0YW1wCiAgICAgICAgICAgICAgdmFsdWVzLlRpbWVzdGFtcCA9IG1ha2VJU09UaW1lc3RhbXBVVEMoKTsKCiAgICAgICAgICAgICAgLy8gUmVjb21wb3NlIGluZm9ybWF0aW9uIGluIG1haW4gc3RvcmFnZSBjb29raWUKICAgICAgICAgICAgICBjb29raWUgPSAiTUdVSUQ9IjsKICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWVzKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgICAgY29va2llICs9IGtleSArICI9IiArIHZhbHVlc1trZXldICsgIiYiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb29raWUgPSBjb29raWUuc3Vic3RyKDAsIChjb29raWUubGVuZ3RoIC0gMSkpOwoKICAgICAgICAgICAgICAvLyBVcGRhdGUgY29va2llCiAgICAgICAgICAgICAgZG9jdW1lbnQuY29va2llID0gY29va2llOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRla19kb21haW5zIDogewogICAgICAgIC8vIGJ5OiBSZWVrLCBBbGV4YW5kZXIyNTUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNzg4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzUxMgogICAgICAgIGhvc3QgOiBbJ3Rlay5ubycsICdnYW1lci5ubycsICd0ZWtub2ZpbC5ubycsICdpbnNpZGV0ZWxlY29tLm5vJywgJ3ByaXNndWlkZS5ubycsICdkaXNrdXNqb24ubm8nLCAndGVrbm9qb2JiLm5vJywgJ2FrYW0ubm8nLCAnaGFyZHdhcmUubm8nLCAnYW1vYmlsLm5vJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewoKICAgICAgICAgIC8qCiAgICAgICAgICB2YXIgYWRfZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTsKICAgICAgICAgIGFkX2ZyYW1lLm5hbWUgPSAiX2ZyYW1lIjsKICAgICAgICAgIGFkX2ZyYW1lLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFkX2ZyYW1lKTsKICAgICAgICAgIGFkX2ZyYW1lLmNvbnRlbnRXaW5kb3cud3JhcHBlZEpTT2JqZWN0LmluRklGID0gdHJ1ZTsKICAgICAgICAgICAqLwoKICAgICAgICAgIC8vIGZpeCAyNy4xMS4yMDE1CiAgICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICAgIHRhZyA6ICdkaXYnLAogICAgICAgICAgICBpZCA6ICdnb29nbGVfYWRzX2lmcmFtZV8nLAogICAgICAgICAgICBodG1sIDogJzxwPjwvcD4nLAogICAgICAgICAgICBhcHBlbmQgOiAnYm9keScKICAgICAgICAgIH0pOwoKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBsYW5ldGF0dm9ubGluZWhkX25ldHdvcmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE0NjcKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTU5CiAgICAgICAgaG9zdCA6IFsncGxhbmV0YXR2b25saW5laGQuYmxvZ3Nwb3QuJywgJ3BsYW5ldGF0dm9ubGluZWhkLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoJy5hZHNhbnRpbG9rIHsgaGVpZ2h0OiAxcHg7IH0nKTsKICAgICAgICAgIC8vQWFrLnV3LmpRQW50aUFkc0Jsb2NrID0gZnVuY3Rpb24gKCl7fTsgLy8gZG9uJ3Qgd29yawogICAgICAgIH0KICAgICAgfSwKICAgICAgYmV0YV9zcGVlZHRlc3RfbmV0IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy82MjgKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTYyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzQ4NAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlMi5vcmcvNTN5bWdoWDEKICAgICAgICBob3N0IDogWydiZXRhLnNwZWVkdGVzdC5uZXQnXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZHNPb2tsYUNvbVJlYWNoYWJsZSA9IHRydWU7CiAgICAgICAgICBBYWsudXcuc2NyaXB0c0xvYWRlZCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmluYnVja3NfY29tIDogewogICAgICAgIC8vIGJ5OiBBbGV4YW5kZXIyNTUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTQ1CiAgICAgICAgaG9zdCA6IFsnYmluYnVja3MuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LnRlc3RKdWljeVBheSA9IHRydWU7CiAgICAgICAgICBBYWsudXcudGVzdFNlbnNlUGF5ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHdoaXNreXByaWNlc19kb21haW5zIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjg0CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0VwcjV0UkVMCiAgICAgICAgaG9zdCA6IFsnd2hpc2t5cHJpanplbi5jb20nLCAnd2hpc2t5cHJpY2VzLmNvLnVrJywgJ3doaXNreXByZWlzZS5jb20nLCAnd2hpc2t5cHJpeC5mciddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3Lk9BX3Nob3cgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbmljb2Jsb2dfb3JnIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMTg0CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL01OSHBMczJWCiAgICAgICAgaG9zdCA6IFsnbmljb2Jsb2cub3JnJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNyYycpOwogICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGlfc2UgOiB7CiAgICAgICAgLy8gbm90ZTogYWRkIHRoaXMgcnVsZSBmb3IgY2hyb21lIHVzZXIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTMxOQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS85YkRQUXpNWAogICAgICAgIGhvc3QgOiBbJ2RpLnNlJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNoZWFkZXJfb3ZlcmxheScpOwogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNtZXNzYWdlX21vZGFsJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtZWdvZ29fbmV0IDogewogICAgICAgIC8vIGlzc3VlOiBQTQogICAgICAgIC8vIHNvdXJjZTE6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vY2NIUWczaG4KICAgICAgICAvLyBzb3VyY2UyOiBodHRwOi8vcGFzdGViaW4uY29tL2drMHZFUUhOCiAgICAgICAgLy8gbm90ZTogdHdvIGFkYmxvY2sgY2hlY2sKICAgICAgICBob3N0IDogWydtZWdvZ28ubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICJhZEJsb2NrIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAic2hvd0FkQmxvY2tNZXNzYWdlIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiBmdW5jdGlvbiAoKSB7fQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBsaWJlcnRhZGRpZ2l0YWxfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNjQyCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tLzZGenAwdnJFCiAgICAgICAgaG9zdCA6IFsnbGliZXJ0YWRkaWdpdGFsLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAiYWRfYWxyZWFkeV9wbGF5ZWQiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgInB1ZWRlTW9zdHJhckFkcyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCAgICAgCiAgICAgIGZvbGhhX3VvbF9jb21fYnIgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzOTYKICAgICAgICAvLyBzb3VyY2U6IGYoICggdHlwZW9mIHBheXdhbGxfYWNjZXNzID09ICJ1bmRlZmluZWQiIHx8IHBheXdhbGxfYWNjZXNzICE9IHRydWUgKSAmJiAoIHR5cGVvZiBmb2xoYV9hZHMgPT0gInVuZGVmaW5lZCIgfHwgZm9saGFfYWRzICE9IHRydWUgKSApIHsKICAgICAgICBob3N0IDogWydmb2xoYS51b2wuY29tLmJyJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICJwYXl3YWxsX2FjY2VzcyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAiZm9saGFfYWRzIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdhbWVyX2NvbV90dyA6IHsKICAgICAgICAvLyBieTogbW1pczEwMDAKICAgICAgICAvLyB1c2Vyc2NyaXB0OiBodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL3NjcmlwdHMvMTY1MjUKICAgICAgICAvLyBpc3N1ZTogOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy85NzUKICAgICAgICBob3N0IDogWydnYW1lci5jb20udHcnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgJ0FudGlBZCcsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBhcm1vcmdhbWVzX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODQ1CiAgICAgICAgaG9zdCA6IFsnYXJtb3JnYW1lcy5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgJ2dhX2RldGVjdCcsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogbnVsbAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtYW5nYWhvc3RfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy85NTcKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTU4CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0dycGJKRU5BCiAgICAgICAgaG9zdCA6IFsnbWFuZ2Fob3N0LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAidGVzdERpc3BsYXkiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZpZGVvd29vZF90diA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTMzOQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3ZpZGVvd29vZC50di9idWlsZC9hc3NldHMvanMvcGVtYmVkLTk3YTY0MGY2MjUuanMKICAgICAgICBob3N0IDogWyd2aWRlb3dvb2QudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3Lm9wZW4gPSBmdW5jdGlvbiAoKSB7fTsgLy8gcHJldmVudCBwb3B1cAogICAgICAgICAgQWFrLnV3LmNvbmZpZyA9IHt9OwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dy5jb25maWcsICJhZGJfcmVtaW5kIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBpbmZvam9ic19jb21fYnIgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzMzkKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vTFBnNjA5M1UKICAgICAgICAvLyByZWRpcmVjdDogaHR0cDovL3d3dy5pbmZvam9icy5jb20uYnIvbm9wdWJsaWNpdHkuYXNweAogICAgICAgIGhvc3QgOiBbJ2luZm9qb2JzLmNvbS5iciddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHdlYlVJID0gd2ViVUkgfHwge307CiAgICAgICAgICAgIHdlYlVJLlV0aWxzID0gd2ViVUkuVXRpbHMgfHwge307CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3ZWJVSS5VdGlscywgIlN0b3BBZEJsb2NrIiwgewogICAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgICAgdmFsdWUgOiBmdW5jdGlvbiAoKSB7fQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNsb3Vkd2ViY29weV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzcxNAogICAgICAgIGhvc3QgOiBbJ2Nsb3Vkd2ViY29weS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHNldFRpbWVvdXRDbG9uZSA9IEFhay51dy5zZXRUaW1lb3V0OwogICAgICAgICAgQWFrLnV3LnNldFRpbWVvdXQgPSBudWxsOwogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIEFhay51dy5zZXRUaW1lb3V0ID0gc2V0VGltZW91dENsb25lOwogICAgICAgICAgfSwgNTAwMCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBuYXJraXZlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTY5CiAgICAgICAgaG9zdCA6IFsnbmFya2l2ZS5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZGJsb2NrX3N0YXR1cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHByZWdlbl9uZXQgOiB7CiAgICAgICAgaG9zdCA6IFsncHJlZ2VuLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBza2lwIHBhZ2UgaW5mbwogICAgICAgICAgQWFrLnNldENvb2tpZSgncGduJywgMSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBwaHlzX29yZyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNzY4CiAgICAgICAgaG9zdCA6IFsncGh5cy5vcmcnXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5jaGtBQiA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgb252YXNvcnRpcl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9b252YXNvcnRpci5jb20KICAgICAgICBob3N0IDogWydvbnZhc29ydGlyLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gK2FicCBydWxlIGFsdCBzb2x1dGlvbgogICAgICAgICAgQWFrLnV3LkplQmxvcXVlID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBmdWxsaGR6ZXZraV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9ZnVsbGhkemV2a2kuY29tCiAgICAgICAgaG9zdCA6IFsnZnVsbGhkemV2a2kuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyArYWJwIHJ1bGUgYWx0IHNvbHV0aW9uCiAgICAgICAgICBBYWsudXcuY2hlY2sgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZpbGxlX2lkZWFsZV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI1OAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS8xNm1ubWVNYwogICAgICAgIGhvc3QgOiBbJ3ZpbGxlLWlkZWFsZS5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vICthYnAgcnVsZSBhbHQgc29sdXRpb24KICAgICAgICAgIEFhay51dy5leGVjc3AgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5vdHJlX3BsYW5ldGVfaW5mbyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjU4CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL3FyUzZRR0dFCiAgICAgICAgaG9zdCA6IFsnbm90cmUtcGxhbmV0ZS5pbmZvJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyArYWJwIHJ1bGUgYWx0IHNvbHV0aW9uCiAgICAgICAgICBBYWsudXcucHVicG9wID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBhcGttaXJyb3JfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zNzgKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjI0CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzc4CiAgICAgICAgaG9zdCA6IFsnYXBrbWlycm9yLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmRvQ2hlY2sgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG10bGJsb2dfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy85NDgKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mb3J1bS9kaXNjdXNzaW9uLzc3NTMKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vQkZyRFBNNmIKICAgICAgICBob3N0IDogWydtdGxibG9nLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAncHVhYnMnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB2YWx1ZSA6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFuaXptX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydhbml6bS5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5zdG9wQWRCbG9jayA9IHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGlhcmlvaW5mb3JtYWNpb25fY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTUwCiAgICAgICAgaG9zdCA6IFsnZGlhcmlvaW5mb3JtYWNpb24uY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICdwcl9va3ZhbGlkYScsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHZhbHVlIDogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBjbmJldGFfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMzAxCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL3ZYTkN6dHd4CiAgICAgICAgaG9zdCA6IFsnY25iZXRhLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAnSkInLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB2YWx1ZSA6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRoZW1hcmtlcl9oYWFyZXR6IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjkyCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL20wOGRrRFQ0CiAgICAgICAgaG9zdCA6IFsndGhlbWFya2VyLmNvbScsICdoYWFyZXR6LmNvLmlsJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICdBZEJsb2NrVXRpbCcsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHZhbHVlIDoge30KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcGlwb2Nhc190diA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydwaXBvY2FzLnR2J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIEFsc28gYWRkZWQgaW4gZGlzYWJsZUFsZXJ0Ym94CiAgICAgICAgICAvLyBObyBwb3B1cAogICAgICAgICAgQWFrLnNldENvb2tpZSgncG9wdXBfdXNlcl9sb2dpbicsICd5ZXMnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIF8xNW1pbl9sdCA6IHsKICAgICAgICAvLyBub3RlOiByZWd1bGFyeSB1cGRhdGUgc2NyaXB0CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9MTVtaW4uaXQKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vWVdmM0hUcXIKICAgICAgICAvLyB0ZXN0OiBodHRwOi8vdGlueXVybC5jb20vaDZjNDMzNgogICAgICAgIGhvc3QgOiBbJzE1bWluLmx0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICdST1VURScsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogJ19iZV9yZWtsYW1vcycKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2MyY2FzdHNfY29tIDogewogICAgICAgIC8vIGJ5OiBHaXdheXVtZQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTk5CiAgICAgICAgaG9zdCA6IFsnc2MyY2FzdHMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbigpIHsKICAgICAgICAgICAgd2luZG93Ll9nYXEgPSB7IHB1c2g6ZnVuY3Rpb24oKSB7fSB9OwogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAic2hvd2RpYWxvZyIsIHsKICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24oKSB7fSwKICAgICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgInNob3dQb3B1cDIiLCB7CiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKCkge30sCiAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZndW5ldHdvcmtfY29tIDogewogICAgICAgIC8vIGlzc3VlOgogICAgICAgIGhvc3QgOiBbJ3ZndW5ldHdvcmsuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnc3RvcEl0JywgMSk7CiAgICAgICAgICB2YXIgY2xvc2UgPSBBYWsuZ2V0RWxlbWVudCgnI3NvbWVfYWRfYmxvY2tfa2V5X2Nsb3NlJyk7CiAgICAgICAgICBpZiAoY2xvc2UpIHsKICAgICAgICAgICAgY2xvc2UuY2xpY2soKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxpbmtjcnlwdF93cyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjg2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvcHVsbC82NwogICAgICAgIGhvc3QgOiBbJ2xpbmtjcnlwdC53cyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRFbGVtZW50KCcjYWRfY29udCcsIHsKICAgICAgICAgICAgaWQgOiAnJywKICAgICAgICAgICAgc3R5bGUgOiAnZGlzcGxheTpibG9jazsnCiAgICAgICAgICB9KTsKICAgICAgICAgIEFhay5zZXRFbGVtZW50KCcjY29udGFpbmVyX2NoZWNrJywgewogICAgICAgICAgICBzdHlsZSA6ICdkaXNwbGF5Om5vbmU7JwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBldmVudG9zcHB2X21lIDogewogICAgICAgIC8vIGlzc3VlOiAKICAgICAgICBob3N0IDogWydldmVudG9zcHB2Lm1lJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNuZjM3Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBib2xvcl90b2xpX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTUyCiAgICAgICAgaG9zdCA6IFsnYm9sb3ItdG9saS5jb20nXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBhZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdiYW5uZXInKTsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBhZCA9IGFkc1tpXTsKICAgICAgICAgICAgYWQuaW5uZXJIVE1MID0gJzxicj4nOwogICAgICAgICAgICBhZC5zdHlsZS5oZWlnaHQgPSAnMXB4JzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZpdm9fc3ggOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI4MAogICAgICAgIGhvc3QgOiBbJ3Zpdm8uc3gnXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBhbGVydCA9IEFhay5nZXRFbGVtZW50KCcjYWxlcnQtdGhyb3R0bGUnKTsKICAgICAgICAgIGlmIChhbGVydCkgewogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChhbGVydCk7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgYnV0dG9uID0gQWFrLmdldEVsZW1lbnQoJ2J1dHRvbiNhY2Nlc3MnKTsKICAgICAgICAgIGlmIChidXR0b24pIHsKICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTsKICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTsKICAgICAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9ICdDb250aW51ZSB0byB2aWRlbyc7CiAgICAgICAgICB9CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGlucHV0ID0gQWFrLmdldEVsZW1lbnQoJ2lucHV0W25hbWU9InRocm90dGxlIl0nKTsKICAgICAgICAgICAgaWYgKGlucHV0KSB7CiAgICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoaW5wdXQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGx1eHlhZF9jb20gOiB7IC8vIHNraXAgcmVkaXJlY3QgbXlhbmltZXMubGkKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydsdXh5YWQuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKCcvSW5mb3JtYXRpb24ucGhwJyA9PSBsb2NhdGlvbi5wYXRobmFtZSkgewogICAgICAgICAgICB2YXIgaHJlZiA9IGxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBocmVmLnN1YnN0cihocmVmLmluZGV4T2YoJ3VybD0nKSArIDQsIGhyZWYubGVuZ3RoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1ycGlyYWN5X2RvbWFpbnMgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE0MDUKICAgICAgICBob3N0IDogWydtcnBpcmFjeS54eXonLCAnbXJwaXJhY3kuY2x1YiddLAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICAgICAgY29udGFpbnMgOiAnRGVzYXRpdmEgbyBBZEJsb2NrIHBhcmEgY29udGludWFyJywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRicGxhbmV0X25ldCA6IHsKICAgICAgICAvLyBpc3N1ZTogUE0KICAgICAgICBob3N0IDogWydkYnBsYW5ldC5uZXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnbmV3bm9Nb3JlQWRzTm93JywgMSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBhaWRlbXVfZnIgOiB7CiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsnYWlkZW11LmZyJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2FkYmxvY2tQb3B1cCcsIHRydWUpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZWFtaV9pbiA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydlYW1pLmluJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdhZF9sb2NrZWQnLCAxKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJpZ2Rvd25sb2FkZXJfY29tIDogewogICAgICAgIC8vIGlzc3VlOgogICAgICAgIGhvc3QgOiBbJ2JpZ2Rvd25sb2FkZXIuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNhbnRpX2FkYmxvY2snKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZyZWVza2llcl9jb20gOiB7CiAgICAgICAgLy8gYnk6IEdvcmhpbGwKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNjM5CiAgICAgICAgLy8gbm90ZTogYWxzbyBhZGRlZCBsaXN0IHJ1bGUKICAgICAgICBob3N0IDogWydmcmVlc2tpZXIuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFkYi1ub3QtZW5hYmxlZCIpOwogICAgICAgICAgaWYgKGVsICE9PSBudWxsKSB7CiAgICAgICAgICAgIGVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KCJkaXNwbGF5Iik7CiAgICAgICAgICB9CiAgICAgICAgICBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ2aWRlb0NvbnRhaW5lciIpOwogICAgICAgICAgaWYgKGVsICE9PSBudWxsKSB7CiAgICAgICAgICAgIGVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KCJkaXNwbGF5Iik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBnYW1ldHJhaWxlcnNfY29tIDogewogICAgICAgIC8vIGlzc3VlOgogICAgICAgIGhvc3QgOiBbJ2dhbWV0cmFpbGVycy5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI2FkX2Jsb2NraW5nJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzY2FuX29uZXBpZWNlX25hcnV0b19teCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTgyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI3OQogICAgICAgIGhvc3QgOiBbJ3NjYW4tbXguY29tJywgJ29uZXBpZWNlLW14Lm5ldCcsICduYXJ1dG8tbXgubmV0J10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRfYmxvY2tfdGVzdCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldEVsZW1lbnQoJyN5b3AnLCB7CiAgICAgICAgICAgIGlkIDogJycKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gQml0Y29pbnMKICAgICAgYml0Y29pbmtlcl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzIzMAogICAgICAgIGhvc3QgOiBbJ2JpdGNvaW5rZXIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5jbGFpbSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNFMzNGQ0NjWDJmVycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbW9vbmRvZ2VfY29faW4gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzM4NAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yMzIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjMzCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzIzNgogICAgICAgIGhvc3QgOiBbJ21vb25kb2dlLmNvLmluJywgJ21vb25saXRlY28uaW4nLCAnbW9vbmJpdC5jby5pbicsICdiaXRjb2luemVicmEuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNBQiwgI0U0NDJEdiwgI2VDQzVoJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBiaXRjb2luZXJfbmV0IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zNDkKICAgICAgICBob3N0IDogWydiaXRjb2luZXIubmV0JywgJ2xpdGVjb2luZXIubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I3Rlc3RlcicpOwogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWQtdG9wJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBiaXRjb2luc19ueF90YyA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydmcmVlYml0Y29pbnMubngudGMnLCAnZ2V0Yml0Y29pbnMubngudGMnXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZF9ibG9ja190ZXN0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZnJlZWNvaW5zNF9tZSA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydmcmVlY29pbnM0Lm1lJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuY2hlY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICB0b3JyZW50X3R2X3J1IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81MzcKICAgICAgICBob3N0IDogWyd0b3JyZW50LXR2LnJ1J10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuY19Pb19BZHZlcnRfU2hvd24gPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgY3d0dl9jb20gOiB7CiAgICAgICAgLy8gYnk6IEthbGJhc2l0CiAgICAgICAgLy8gcHVsbDogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9wdWxsLzc2MwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zNDAKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNzYyCiAgICAgICAgaG9zdCA6IFsnY3d0di5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5DV1RWSXNBZEJsb2NraW5nID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmlsZF9kZSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1iaWxkCiAgICAgICAgaG9zdCA6IFsnYmlsZC5kZSddLAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICAgICAgY29udGFpbnMgOiAnaHR0cDovL3d3dy5iaWxkLmRlL3dhL2xsL2JpbGQtZGUvdW5hbmdlbWVsZGV0LTQyOTI1NTE2LmJpbGQuaHRtbCcsCiAgICAgICAgICAgICAgZXh0ZXJuYWwgOiBmYWxzZSwKICAgICAgICAgICAgICByZXBsYWNlIDogWydqYXZhc2NyaXB0JywgJ3ZvaWQoMCk7J10uam9pbignOicpCiAgICAgICAgICAgIH0KICAgICAgICAgIF07CiAgICAgICAgfQogICAgICB9LAogICAgICBpbm5fY29faWwgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzUzMgogICAgICAgIGhvc3QgOiBbJ2lubi5jby5pbCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIFRSQyA9IHt9OwogICAgICAgICAgICBUUkMuYmxvY2tlciA9IHsKICAgICAgICAgICAgICBzdGF0ZXMgOiB7CiAgICAgICAgICAgICAgICBBQlBfREVURUNUSU9OX0RJU0FCTEVEIDogLTIsCiAgICAgICAgICAgICAgICBBQlBfTk9UX0RFVEVDVEVEIDogMCwKICAgICAgICAgICAgICAgIEFCUF9ERVRFQ1RFRCA6IDEKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGNyZWF0ZUJsb2NrRGV0ZWN0aW9uRGl2IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgaXNCbG9ja0RldGVjdGVkT25EaXYgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGlzQmxvY2tEZXRlY3RlZE9uQ2xhc3NOYW1lcyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZ2V0QmxvY2tlZFN0YXRlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBiaGFza2FyX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1iaGFza2FyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9ZGl2eWFiaGFza2FyLmNvLmluCiAgICAgICAgaG9zdCA6IFsnYmhhc2thci5jb20nLCAnZGl2eWFiaGFza2FyLmNvLmluJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcub3BlblBvcFVwRm9yQnJlYWtQYWdlID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsudXcuY2FuQUJQID0gdHJ1ZTsKICAgICAgICAgIEFhay51dy5jYW5SdW5BZHMgPSB0cnVlOwogICAgICAgICAgQWFrLnV3LmNhbkNoZWNrQWRzID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHR1cmthbmltZV90diA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNDQ2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzOQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL3RyL2ZvcnVtL2Rpc2N1c3Npb24vNDI4Mi8KICAgICAgICBob3N0IDogWyd0dXJrYW5pbWUudHYnXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZGJsb2NrYmxvY2sgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgIEFhay51dy5CbG9rS29udHJvbCA9IHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgd3RmYml0X2NoIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80MDcKICAgICAgICBob3N0IDogWyd3dGZiaXQuY2gnXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy53cml0ZUhUTUxhc0pTID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBhcmFuenVsbGFfaXQgOiB7CiAgICAgICAgLy8gYnk6IFJvYm90ZXgKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1hcmFuenVsbGEuaXQKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20veU1NNllneFcKICAgICAgICBob3N0IDogWydhcmFuenVsbGEuaXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24oKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoJyNhYnQxICsgU1RZTEUgKyBkaXZbaWRdW2NsYXNzXSB7ZGlzcGxheTpub25lO30nKTsKICAgICAgICB9LAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICAgICAgY29udGFpbnMgOiAnbmF2aWdhdG9yLnVzZXJBZ2VudHx8bmF2aWdhdG9yLnZlbmRvcnx8d2luZG93Lm9wZXJhJywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5kdHZfY29tIDogewogICAgICAgIC8vIG5vdGU6IGNhblJ1bkFkcyBpbnZlcnRlZCB2YWx1ZQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPW5kdHYuY29tCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL2hjZm5jZHYKICAgICAgICBob3N0IDogWyduZHR2LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ19fX3BfX3AnLCAxKTsKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgnZ2V0Tm9Ub3BMYXRlc3ROZXdzJywgZnVuY3Rpb24gKCkge30pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbGVzZWNob3NfZnIgOiB7CiAgICAgICAgLy8gUmVlaywgR2l3YXl1bWUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1sZXNlY2hvcy5mcgogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9DTU04V0dMagogICAgICAgIGhvc3QgOiBbJ2xlc2VjaG9zLmZyJywgJ2xlc2VjaG9zLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbigpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICJjaGVja0FkQmxvY2siLCB7CiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKCkge30sCiAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmNhbGxfQWQgPSAxOwogICAgICAgICAgQWFrLnV3LnBheXdhbGxfYWRibG9ja19hcnRpY2xlID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBiaXR2aXNpdHNfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNjYKICAgICAgICBob3N0IDogWydiaXR2aXNpdHMuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYmxvY2tBZGJsb2NrVXNlciA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZXhyYXBpZGxlZWNoX2luZm8gOiB7CiAgICAgICAgLy8gYnk6IEFsZXhhbmRlcjI1NSwgUmVlaywgR2l3YXl1bWUKICAgICAgICAvLyBwYXRjaDogaHR0cDovL3Bhc3RlYmluLmNvbS9RNjY0ZGlRMgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWV4cmFwaWRsZWVjaAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS81ZTI3c3lqQQogICAgICAgIGhvc3QgOiBbJ2V4cmFwaWRsZWVjaC5pbmZvJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICB2YXIgdG9tb3Jyb3cgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgdG9tb3Jyb3cuc2V0RGF0ZSh0b21vcnJvdy5nZXREYXRlKCkgKyAxKTsKCiAgICAgICAgICAvLyBwcmV2ZW50IHBvcHVwCiAgICAgICAgICBBYWsuc2V0Q29va2llKCdwb3BjYXNocHVDYXAnLCAxKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ3BvcGNhc2hwdScsIDEpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgnbm9wb3BhdGFsbCcsIHRvbW9ycm93LmdldFRpbWUoKS50b1N0cmluZygpKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ25vYWR2dGRheScsIDApOwogICAgICAgICAgLy9BYWsuc2V0Q29va2llKCdidl9EU0tza2Rja19zMWQnLCAnYnZEU0tza2Rja3MxZCcpOwoKICAgICAgICAgIC8vIGhpZGUgbm90aWNlCiAgICAgICAgICBBYWsuYWRkU3R5bGUoJ2Rpdi5hbGVydC5hbGVydC1kYW5nZXIubGVhZCB7b3BhY2l0eTowO30nKTsKICAgICAgICAgIAogICAgICAgICAgLy8gcHJldmVudCByZWRpcmVjdCB0byB2ZXJpZnkgcGFnZQogICAgICAgICAgQWFrLnNldFJlYWRPbmx5KCdiZHZibnJfcGlkJywgW10pOwogICAgICAgICAgQWFrLnNldFJlYWRPbmx5KCdQb3BBZHMnLCAxKTsKCiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAvLyBwcmV2ZW50IHBvcHVwCiAgICAgICAgICAgICAgd2luZG93Lm9wZW4gPSBmdW5jdGlvbiAoKSB7fTsKCiAgICAgICAgICAgICAgLy8gcHJldmVudCByZWRpcmVjdCB0byB2ZXJpZnkgcGFnZQogICAgICAgICAgICAgIHZhciBmcmFtZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTsKICAgICAgICAgICAgICBmcmFtZTEuc3JjID0gJ2h0dHA6Ly9iZGZybS5iaWR2ZXJ0aXNlci5jb20vQmlkVmVydGlzZXIuZGJtP3BpZD0zODM4NjUmYmlkPTE3Mzc0MTgmUkQ9JzsKICAgICAgICAgICAgICBmcmFtZTEuaWQgPSAnYmR2aSc7CiAgICAgICAgICAgICAgZnJhbWUxLnN0eWxlID0gJ2Rpc3BsYXk6bm9uZSc7CiAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGZyYW1lMSk7CiAgICAgICAgICAgIH0pKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZpcGxlYWd1ZV9kb21haW5zIDogewogICAgICAgIC8vIG5vdGU6IGFsc28ga2lsbGVkIGJ5IEFha0xpc3QKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT12aXBib3gKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT12aXBsZWFndWUKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vTkVSVnpIelMKICAgICAgICBob3N0IDogWyJ2aXBsZWFndWUuaXMiLCAidmlwbGVhZ3VlLndzIiwgInZpcGxlYWd1ZS50diIsICJ2aXBsZWFndWUuc2UiLCAidmlwbGVhZ3VlLnR2IiwgInZpcGxlYWd1ZS5tZSIsICJ2aXBsZWFndWUubW9iaSIsICJ2aXBsZWFndWUuY28iLCAidmlwbGVhZ3VlLnN4IiwgInZpcGxlYWd1ZS5jaCIsICJ2aXBib3gudHYiLCAidmlwYm94LmNvIiwgInZpcGJveC5iaXoiLCAidmlwYm94LnN4IiwgInZpcGJveC5ldSIsICJ2aXBib3guc28iLCAidmlwYm94Lm51IiwgInZpcGJveHNhLmNvIiwgInN0cmlrZW91dC5jbyIsICJzdHJpa2VvdXQubWUiLCAiaG9tZXJ1bi5yZSIsICJ2aXBib3h0di5jbyIsICJ2aXBhcHAubWUiXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmlFeGlzdCA9IHRydWU7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCd4Y2xzdmlwJywgMSk7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi52aXBfMDUyeDAwMyB7IGhlaWdodDogMjUwcHg7IH0iKTsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLnZpcF8wOXg4MjcgeyBoZWlnaHQ6IDI2cHg7IH0iKTsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI292ZXJsYXkgeyBkaXNwbGF5OiBub25lOyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICB6b29tdHZfbWUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9em9vbXR2Lm1lCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL200ekFYR2N3CiAgICAgICAgaG9zdCA6IFsnem9vbXR2Lm1lJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuaWF4cEVuYWJsZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdmdfbm8gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI5MgogICAgICAgIC8vICthYnAgcnVsZQogICAgICAgIGhvc3QgOiBbJ3ZnLm5vJywgJ2UyNC5ubyddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3Ll9fQUJfXyA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgcG9ybnZlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTQ3CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tLzdUUFBrcTEyCiAgICAgICAgaG9zdCA6IFsncG9ybnZlLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkeGp3dXBkYXRlID0gMTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxvbF9tb2FfdHcgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzExMTQKICAgICAgICBob3N0IDogWydsb2wubW9hLnR3J10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBNb2FPYmogPSBNb2FPYmogfHwge307CiAgICAgICAgICAgIE1vYU9iai5hZCA9IE1vYU9iai5hZCB8fCB7fTsJCQkKICAgICAgICAgICAgTW9hT2JqLmFkLmhhc0FkYmxvY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNb2FPYmouYWQuY2hlY2tBQlAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtdWx0aXVwX29yZyA6IHsKICAgICAgICAvLyBieTogV2F0aWxpbgogICAgICAgIC8vIG5vdGU6IGFsdGVybmF0aXZlIHNvbHV0aW9uCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bXVsdGl1cC5vcmcKICAgICAgICBob3N0IDogWydtdWx0aXVwLm9yZyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aXNpdCcsIDEpOyAvLyBwcmV2ZW50IHBvcHVwCiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ2hpJywgZnVuY3Rpb24gKCkge30pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGFpbHliaXRjb2luc19vcmcgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEwNwogICAgICAgIGhvc3QgOiBbJ2RhaWx5Yml0Y29pbnMub3JnJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJy5hZC1pbWcnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGtvemFjemVrX3plYmVya2EgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzQxNAogICAgICAgIGhvc3QgOiBbJ2tvemFjemVrLnBsJywgJ3plYmVya2EucGwnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnYWJsYycsIDEpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgnY29va2llX3BvbGljeScsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc3Bhbmt3aXJlX3NpdGVzIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84ODcKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vVEZCMWR0Z2IKICAgICAgICBob3N0IDogWydzcGFua3dpcmUuY29tJywgJ2tlZXptb3ZpZXMuY29tJywgJ2V4dHJlbWV0dWJlLmNvbScsICdtb2Zvc2V4LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCJhYkNsb3NlZCIsICJ0cnVlIik7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCJoaWRlX2FkX21zZyIsICIxIik7CiAgICAgICAgfQogICAgICB9LAogICAgICB5b3Vwb3JuX25ldHdvcmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg4NwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9URkIxZHRnYgogICAgICAgIGhvc3QgOiBbJ3lvdXBvcm4uY29tJywgJ3lvdXBvcm5nYXkuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoImFkYmxvY2tfbWVzc2FnZSIsICJjbG9zZWQiKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNpdGF0aW9ubWFjaGluZV9uZXQgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9Y2l0YXRpb25tYWNoaW5lLm5ldAogICAgICAgIGhvc3QgOiBbJ2NpdGF0aW9ubWFjaGluZS5uZXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgic2JtX2NtX2NpdGF0aW9ucyIsIDApOwogICAgICAgIH0KICAgICAgfSwgICAgICAKICAgICAgcHNhcmlwc19jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE1MwogICAgICAgIGhvc3QgOiBbJ3BzYXJpcHMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkdmVydCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZXh0cmF0b3JyZW50X2RvbWFpbnMgOiB7CiAgICAgICAgaG9zdCA6IFsnZXh0cmF0b3JyZW50LmNjJywgJ2V4dHJhdG9ycmVudC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gcHJldmVudCBwb3B1cAogICAgICAgICAgLy8gc291cmNlIGFyZSBvYmZ1c2NhdGVkIGluIGV4dGVybmFsIGpzCiAgICAgICAgICBBYWsuc2V0Q29va2llKCdwcHVfZGVsYXknLCAxKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ3BwdV9tYWluJywgMSk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdwcHVfc3ViJywgMSk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdwcHVfc2hvd19vbicsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdG55X2N6IDogewogICAgICAgIGhvc3QgOiBbJ3RueS5jeicsICdwYXN0ZWQuY28nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gcHJldmVudCBwb3B1cAogICAgICAgICAgQWFrLnNldENvb2tpZSgnX18ucG9wdW5kZXJDYXAnLCAxKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ19fLnBvcHVuZGVyJywgMSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBjbHViZWRvaGFyZHdhcmVfY29tX2JyIDogeyAvLyB0d28gYW50aWFkYmxvY2sKICAgICAgICBob3N0IDogWydjbHViZWRvaGFyZHdhcmUuY29tLmJyJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChBYWsuY29udGFpbnMobG9jYXRpb24uaG9zdCwgJ2ZvcnVtJykpIHsKICAgICAgICAgICAgLy8gU29sdXRpb24gMQogICAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNiYW5uZXIsIHNjcmlwdCB7IGhlaWdodDogNTFweDsgfSIpOwogICAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNiYW5uZXInKTsKICAgICAgICAgIH0gZWxzZSB7IC8vIFdlYnNpdGUKICAgICAgICAgICAgLy8gU29sdXRpb24gMQogICAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2Rpdi5iYW5uZXJfdG9wbycpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKEFhay5jb250YWlucyhsb2NhdGlvbi5ob3N0LCAnZm9ydW0nKSkgewogICAgICAgICAgICAvLyBTb2x1dGlvbiAyCiAgICAgICAgICAgIEFhay51dy5hZGRCbG9ja2luZy5oaWRlKCk7CiAgICAgICAgICAgIEFhay51dy5hZGRCbG9ja2luZy5raWxsKCk7CiAgICAgICAgICB9IGVsc2UgeyAvLyBXZWJzaXRlCiAgICAgICAgICAgIC8vIFNvbHV0aW9uIDIKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5pZCA9ICcnOwogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnLmFkYmxvY2snKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlYnJhc3RhZ2lfY29tIDogewogICAgICAgIGhvc3QgOiBbJ2RlYnJhc3RhZ2kuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNzdHAtbWFpbicpOwogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNzdHAtYmcnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRkbGZyZW5jaF9vcmcgOiB7CiAgICAgICAgaG9zdCA6IFsnZGRsZnJlbmNoLm9yZyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIEZpeCBidWcgZGlzcGxheSBjb250ZW50CiAgICAgICAgICBBYWsuc2V0RWxlbWVudCgnI2RsZS1jb250ZW50IC5kLWNvbnRlbnQnLCB7CiAgICAgICAgICAgICdjbGFzcycgOiAnJwogICAgICAgICAgfSk7CiAgICAgICAgICBBYWsuc2V0RWxlbWVudCgnI2NvbnRlbnQnLCB7CiAgICAgICAgICAgICdpZCcgOiAnJwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtZWdhZGVicmlkX2V1IDogewogICAgICAgIGhvc3QgOiBbJ21lZ2EtZGVicmlkLmV1J10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBBY3RpdmF0ZSBidXR0b24gZGVicmlkCiAgICAgICAgICBBYWsuc2V0RWxlbWVudCgnLnJlYWxidXR0b24nLCB7CiAgICAgICAgICAgICdvbmNsaWNrJyA6ICcnLAogICAgICAgICAgICAndHlwZScgOiAnc3VibWl0JwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzbGlkZXBsYXllcl9kb21haW5zIDogewogICAgICAgIC8vIGJ5OiBBbGV4YW5kZXIyNTUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTMzMwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81MTUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjk2CiAgICAgICAgLy8gZGVtbzogaHR0cDovL3NsaWRlcGxheWVyLmZyL3NsaWRlLzEzMDQwMjYvIwogICAgICAgIGhvc3QgOiBbJ3NsaWRlcGxheWVyLionXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAvLyBEaXNhYmxlIGFudGktYWRibG9ja2VyCiAgICAgICAgICBBYWsudXcuZm9yY2VfcmVtb3ZlX2FkcyA9IHRydWU7CgogICAgICAgICAgLy8gQ2lyY3VtdmVudCAic2hhcmUgdG8gZG93bmxvYWQiIHJ1bGUKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgc2xpZGVfaWQgPSB3aW5kb3cuZ2V0X2N1cnJlbnRfc2xpZGVfaWQoKTsKICAgICAgICAgICAgdmFyIHNsaWRlX3NydiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwbGF5ZXJfZnJhbWUiKS5zcmMuc3BsaXQoIi8iKVszXTsKICAgICAgICAgICAgdmFyIHRpbWUgPSA4NjQwMCArIE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApOwogICAgICAgICAgICB2YXIgc2VjcmV0ID0gZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5zdHJ0cih3aW5kb3cuTUQ1LmJhc2U2NCgic2VjcmV0X3ByZXZlZCBzbGlkZXBsYXllciBuZXZlciBzb2x2ZWQgIiArIHRpbWUgKyBzbGlkZV9pZCArICIucHB0IiksICIrLyIsICItICIpKTsKCiAgICAgICAgICAgIHZhciB1cmwgPSAiaHR0cDovL3BsYXllci5zbGlkZXBsYXllci5vcmcvZG93bmxvYWQvIiArIHNsaWRlX3NydiArICIvIiArIHNsaWRlX2lkICsgIi8iICsgc2VjcmV0ICsgIi8iICsgdGltZSArICIvIiArIHNsaWRlX2lkICsgIi5wcHQiOwogICAgICAgICAgICB2YXIgbGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJhLmRvd25sb2FkX2xpbmsiKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5rcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIC8qIFJlbW92ZSBvcmlnaW5hbCAic2hhcmUgdG8gZG93bmxvYWQiIHBvcHVwIGV2ZW50IGxpc3RlbmVyICovCiAgICAgICAgICAgICAgdmFyIGV2ZW50cyA9ICQuX2RhdGEobGlua3NbaV0pLmV2ZW50cy5jbGljazsKICAgICAgICAgICAgICBldmVudHMuc3BsaWNlKDAsIGV2ZW50cy5sZW5ndGgpOwoKICAgICAgICAgICAgICAvKiBTZXQgbm9ybWFsIGxpbmsgaHJlZiBpbnN0ZWFkICovCiAgICAgICAgICAgICAgbGlua3NbaV0uaHJlZiA9IHVybDsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgIH0KICAgICAgfSwKICAgICAgYm9rZXBzcG90X2NvbSA6IHsKICAgICAgICBob3N0IDogWydib2tlcHNwb3QuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIEhpZGUgRGlzY2xhaW1lcgogICAgICAgICAgQWFrLnNldENvb2tpZSgnaGlkZURpYWxvZycsICdoaWRlJyk7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBSZW1vdmUgRGlzYWJsZSBBZEJsb2NrCiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI3R1cGlrbGFuJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBwaWNsb2FkX2NvbSA6IHsKICAgICAgICBob3N0IDogWydwaWNsb2FkLm9yZyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdwbF9hZGJsb2NrZXInLCBmYWxzZSk7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRzX2xvYWRlZCA9IHRydWU7CiAgICAgICAgICBBYWsudXcuaW1hZ2VBZHMgPSBmYWxzZTsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCdkaXZbb25jb250ZXh0bWVudT0icmV0dXJuIGZhbHNlOyJdJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmcmVlemVkb3dubG9hZF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnZnJlZXplZG93bmxvYWQuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC9mcmVlemVkb3dubG9hZC5jb21cL2Rvd25sb2FkXC8vLnRlc3QobG9jYXRpb24uaHJlZikpIHsKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJ2JvZHkgPiBkaXZbaWRdJyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBtb25uc3V0b2dhdHlhX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogUE0KICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMUx3NjBoNmsKICAgICAgICBob3N0IDogWydtb25uc3V0b2dhdHlhLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI3NpdGUtYm94IHtkaXNwbGF5OmJsb2NrO30iKTsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjZm9yLWFkLWJsb2NrZXInKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHJhcGlkOF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsncmFwaWQ4LmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCdkaXYuYmFja2sgKyAjYmxjb2tNemcnKTsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCdkaXYuYmFja2snKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHR1cmtkb3duX2NvbSA6IHsKICAgICAgICBob3N0IDogWyd0dXJrZG93bi5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyByZW1vdmUgZmFjZWJvb2sgYm94CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI2R1eXVydScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmlsbW92aXppamFfZG9tYWlucyA6IHsKICAgICAgICBob3N0IDogWydmaWxtb3ZpemlqYS5tZScsICdmaWxtb3ZpemlqYS5jb20nLCAnZmlsbW92aXppamEuaW4nLCAnZmlsbW92aXppamEubmV0J10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLyoKICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKTsKICAgICAgICAgIHZhciB3ZWVrZGF5ID0gWyJTdW5kYXkiLCAiTW9uZGF5IiwgIlR1ZXNkYXkiLCAiV2VkbmVzZGF5IiwgIlRodXJzZGF5IiwgIkZyaWRheSIsICJTYXR1cmRheSJdOwogICAgICAgICAgdmFyIG4gPSB3ZWVrZGF5W2QuZ2V0RGF5KCldOwogICAgICAgICAgQWFrLnNldEVsZW1lbnQoJyMnICsgbiwgewogICAgICAgICAgaHRtbCA6ICcnCiAgICAgICAgICB9KTsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjJyArIG4pOwogICAgICAgICAgICovCiAgICAgICAgfQogICAgICB9LAogICAgICBoYWNraW50b3NoX3pvbmUgOiB7CiAgICAgICAgLy8gYnk6IEFsZXhhbmRlcjI1NQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWhhY2tpbnRvc2guem9uZQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlMi5vcmcvRG5COU9qNGYKICAgICAgICBob3N0IDogWydoYWNraW50b3NoLnpvbmUnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgdmFyIGhlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdOwogICAgICAgICAgLy8gRmFrZSBHb29nbGUgYWQgZnJhbWUgY29udGVudAogICAgICAgICAgdmFyIGFkMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucyIpOwogICAgICAgICAgYWQxLmNsYXNzTmFtZSA9ICJhZHNieWdvb2dsZSI7CiAgICAgICAgICBhZDEuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIkFBSyIpKTsKICAgICAgICAgIGhlYWQuaW5zZXJ0QmVmb3JlKGFkMSwgaGVhZC5jaGlsZE5vZGVzWzBdKTsKCiAgICAgICAgICAvKgogICAgICAgICAgLy8gRmFrZSBDbGVhbk15TWFjIGFkIGZyYW1lIHNpemUKICAgICAgICAgIHZhciBhZDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIGFkMi5pZCAgPSAibnljdWhldmdxaSI7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoYWQyLndyYXBwZWRKU09iamVjdCwgJ2NsaWVudEhlaWdodCcsIHt2YWx1ZTogMX0pOwogICAgICAgICAgaGVhZC5pbnNlcnRCZWZvcmUoYWQyLCBoZWFkLmNoaWxkTm9kZXNbMF0pOwogICAgICAgICAgICovCgogICAgICAgICAgdmFyIGVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmFkc2Vuc2VncmV5Jyk7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW1nIik7CiAgICAgICAgICAgIG5vZGUuc3JjID0gQWFrLmltZ0JhaXQ7CiAgICAgICAgICAgIGVsZW1zW2ldLmFwcGVuZENoaWxkKG5vZGUpOwogICAgICAgICAgfQoKICAgICAgICB9LAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICAgICAgY29udGFpbnMgOiAnZGlzYWJsZSBBREJsb2NrIGNvbXBsZXRlbHknLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVtb3ZlIDogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJpdmF0ZWluc3RhX2NvbSA6IHsKICAgICAgICBob3N0IDogWydwcml2YXRlaW5zdGEuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gKyBhYnAgcnVsZQogICAgICAgICAgQWFrLnV3LmRvbnRfc2Nyb2xsID0gZmFsc2U7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgiI292ZXJsYXlfZGl2Iik7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgiI292ZXJsYXlfbWFpbl9kaXYiKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHJpc2lrb2dlc3VuZGhlaXRfZGUgOiB7CiAgICAgICAgaG9zdCA6IFsncmlzaWtvLWdlc3VuZGhlaXQuZGUnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgd2luZG93LnN0b3AoKTsKICAgICAgICAgIH0sIDUwMDApOwogICAgICAgIH0KICAgICAgfSwKICAgICAgb25lcGxheWxpc3RfZXVfcG4gOiB7CiAgICAgICAgaG9zdCA6IFsnb25lcGxheWxpc3QuZXUucG4nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBraWxsIHBvcHVuZGVyCiAgICAgICAgICBBYWsudXcubWFrZVBvcHVuZGVyID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9LAogICAgICBvbm1lZGFfZGUgOiB7CiAgICAgICAgLy8gbm90ZTogc2NyaXB0IG9iZnVzY2F0ZWQgbGluZSAxMTEwCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZm9ydW0vZGlzY3Vzc2lvbi84NTc2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEwNjcKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vcWY0NmJOM3oKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vUndIeUYwTkwKICAgICAgICBob3N0IDogWydvbm1lZGEuZGUnXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy4kQURQID0gdHJ1ZTsKICAgICAgICAgIEFhay51dy5zYXNfY2FsbEFkID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsudXcuc2FzX2NhbGxBZHMgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHR1cmJvZGVicmlkZXVyX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTk5CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU2MwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81MjYKICAgICAgICBob3N0IDogWyd0dXJib2RlYnJpZGV1ci5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICAgIHRhZyA6ICdkaXYnLAogICAgICAgICAgICBpZCA6ICdwdWJkaXJlY3RlJywKICAgICAgICAgICAgaHRtbCA6ICc8aW1nICBzcmM9IicgKyBBYWsuaW1nQmFpdCArICciLz48YSAgaHJlZj0iIyI+Jm5ic3A7PC9hPicsCiAgICAgICAgICAgIGFwcGVuZCA6ICdib2R5JwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICByb2NrZmlsZV9ldSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI1NgogICAgICAgIGhvc3QgOiBbJ3JvY2tmaWxlLmV1J10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmNyZWF0ZUVsZW1lbnQoewogICAgICAgICAgICB0YWcgOiAnaWZyYW1lJywKICAgICAgICAgICAgc3JjIDogJ2Fib3V0OmJsYW5rJywKICAgICAgICAgICAgc3R5bGUgOiAndmlzaWJpbGl0eTpoaWRkZW47JywKICAgICAgICAgICAgYXBwZW5kIDogJ2JvZHknCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxpbmtidWNrc19hbnRpYWRibG9jayA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTMyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzQ2OQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNzcKICAgICAgICAvLyB2MzogaHR0cDovL3Bhc3RlYmluLmNvbS8wZ2g4TE1HSAogICAgICAgIC8vIG5vdGU6IG5vIHNvbHV0aW9uLCBhbnRpLWFkYmxvY2sgZGlmZmljdWx0IHRvIGJ5cGFzcyAtLT4gaHR0cDovL3Bhc3RlYmluLmNvbS8xTlJxN1d2WgogICAgICAgIGhvc3QgOiBbJ2xpbmtidWNrcy5jb20nLCAnbWluaXVybHMuY28nLCAncGljYnVja3MuY29tJywgJ3BpY3R1cmVzZXRjLm5ldCcsICdwbGFjZXBpY3R1cmVzLmNvbScsICdwb29udG93bi5uZXQnLCAncXFjLmNvJywgJ3F2dm8uY29tJywgJ3JlYWxmaWxlcy5uZXQnLCAncnFxLmNvJywgJ3NlcmlvdXNkZWFscy5uZXQnLCAnc2VyaW91c2ZpbGVzLmNvbScsICdzZXJpb3VzdXJscy5jb20nLCAnc2V4cGFsYWNlLmdzJywgJ3RoZXNlYmxvZ3MuY29tJywgJ3RoZXNlZmlsZXMuY29tJywgJ3RoZXNlZm9ydW1zLmNvbScsICd0aG9zZWdhbGxlcmllcy5jb20nLCAndGlueWJ1Y2tzLm5ldCcsICd0aW55bGlua3MuY28nLCAndG5hYnVja3MuY29tJywgJ3R1YmV2aXJhbC5jb20nLCAndWJlcnBpY3ouY29tJywgJ3ViZXJ2aWR6LmNvbScsICd1YnVja3MubmV0JywgJ3VnYWxsZXJpZXMubmV0JywgJ3VsdHJhZmlsZXMubmV0JywgJ3VybGJlYXQubmV0JywgJ3VybHB1bHNlLm5ldCcsICd3aGFja3l2aWR6LmNvbScsICd5b3VmYXAubWUnLCAneXl2LmNvJywgJ3p4eG8ubmV0JywgJ3pmZi5jbycsICdsaW5rYnVja3NkbnMuY28nLCAnbWluaXVybHMuY29tJywgJ2R5by5ncycsICdnb25ldmlyYWwuY29tJywgJ2VhZnlmc3VoLm5ldCcsICdzYXNvbnRud2MubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIGRvIG5vdGhpbmcuLi4KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxpbmtidWNrc192aXNpdHNjcmlwdCA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydyZWZlcmVuY2VtZWdhLmNvbScsICdmcGFiZC5jb20nLCAnY3JhY2thY2MuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIFNraXAgdmlzaXRTY3JpcHQgd2hlbiBzaXRlIHVzZSBDbG91ZEZsYXJlIFJvY2tldCBTY3JpcHQKICAgICAgICAgIEFhay5zZXRDb29raWUoJ19sYkdhdGVQYXNzZWQnLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxpbmtfdGwgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bGluay50bAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZyL2ZvcnVtL2Rpc2N1c3Npb24vODQzNwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS8xTWtDbm1MNwogICAgICAgIGhvc3QgOiBbJ2xpbmsudGwnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCcuYWRibG9jayB7IGhlaWdodDoxcHg7IH0nKTsKICAgICAgICAgIEFhay51dy5hZGJsb2NrZXIgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHdzdHJlYW1fdmlkZW8gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzODIKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vRWlBUlZRWHQKICAgICAgICBob3N0IDogWyd3c3RyZWFtLnZpZGVvJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgnI2FkaXYgeyBoZWlnaHQ6NHB4OyB9Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBfNHNoYXJlZF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnNHNoYXJlZC5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBIaWRlICJEaXNhYmxlIEFkQmxvZGsiIG1lc3NhZ2VzCiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LnJlbW92ZSgianNCbG9ja0RldGVjdCIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJvX2RvbWFpbnMgOiB7CiAgICAgICAgaG9zdCA6IFsncHJvLXppay53cycsICdwcm8tdGVjdC53cycsICdwcm8tZGRsLndzJywgJ3Byby1zcG9ydC53cyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aXNpdGVkZicsIHRydWUpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgndmlzaXRlZGgnLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGNvbXB0b2lyaGFyZHdhcmVfY29tIDogewogICAgICAgIGhvc3QgOiBbJ2NvbXB0b2lyLWhhcmR3YXJlLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkYmxvY2sgPSAnbm9uJzsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJha2Vyc2ZpZWxkX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNjU3CiAgICAgICAgLy8gbm90ZTogYWxzbyBzb2x1dGlvbiB0byBBYWtMaXN0CiAgICAgICAgaG9zdCA6IFsnYmFrZXJzZmllbGQuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuQURfU0xPVF9SRU5ERVJFRCA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICBla3N0cmFibGFkZXRfZGsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9ZWtzdHJhYmxhZGV0CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1IwMjlYcENyCiAgICAgICAgaG9zdCA6IFsnZWtzdHJhYmxhZGV0LmRrJywgJ2ViLmRrJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuQURURUNIID0ge307CiAgICAgICAgfQogICAgICB9LAogICAgICBwY2dhbWVzX2Rvd25sb2FkX25ldCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTQ1MQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZvcnVtL2Rpc2N1c3Npb24vOTMyOAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9FQlZaZzNWQgogICAgICAgIGhvc3QgOiBbJ3BjZ2FtZXMtZG93bmxvYWQubmV0J10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdub0FkYmxvY2tOaWNlTWVzc2FnZScsIDEpOwogICAgICAgICAgQWFrLnV3Lm1nQ2FuTG9hZDMwNTQ3ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxhY2hhaW5lbWV0ZW9fY29tIDogewogICAgICAgIC8vIG5vdGU6IGFsc28ga2lsbGVkIGJ5IEFha0xpc3QKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTkwCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI0NQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yMTUKICAgICAgICBob3N0IDogWydsYWNoYWluZW1ldGVvLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmpzX2xvYWRlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICBtYWM0ZXZlcl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzk5NwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9SUW5DRVlLNgogICAgICAgIGhvc3QgOiBbJ21hYzRldmVyLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmNvcXVpbm91ID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBfNTI3OGJic19jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9NTI3OGJicy5jb20KICAgICAgICBob3N0IDogWyc1Mjc4YmJzLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3Lm15YWFicGZ1bjEyID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICB0aGVzaW1zcmVzb3VyY2VfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPXRoZXNpbXNyZXNvdXJjZS5jb20KICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vREU5cmJqeFkKICAgICAgICBob3N0IDogWyd0aGVzaW1zcmVzb3VyY2UuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuZ2Fkc2l6ZSA9IHRydWU7CiAgICAgICAgICBBYWsudXcuaUhhdmVMb2FkZWRBZHMgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgeWVsbG93YnJpZGdlX2NvbSA6IHsKICAgICAgICBob3N0IDogWyd5ZWxsb3dicmlkZ2UuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuZmluYWxpemVQYWdlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2FtZV9kZWJhdGVfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMzY2CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1V6c2lYMEZLCiAgICAgICAgaG9zdCA6IFsnZ2FtZS1kZWJhdGUuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRfYmxvY2tfdGVzdCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgYWRzY2VuZG1lZGlhIDogewogICAgICAgIGhvc3QgOiBbJ2Fkc2NlbmRtZWRpYS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gYWRzY2VuZG1lZGlhIC0gaHR0cHM6Ly93d3cuYWRzY2VuZG1lZGlhLmNvbS8KICAgICAgICAgIHZhciByZWYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykuaHJlZiA9IGRvY3VtZW50LnJlZmVycmVyOwogICAgICAgICAgdmFyIGhvc3QgPSBsb2NhdGlvbi5ob3N0OwogICAgICAgICAgdmFyIHBhdGggPSBsb2NhdGlvbi5wYXRobmFtZTsKICAgICAgICAgIGlmIChBYWsuY29udGFpbnMocGF0aCwgJy93aWRnZXRfYWRibG9jay5waHAnKSAmJiAhQWFrLmNvbnRhaW5zKHJlZi5ob3N0LCBob3N0KSkgewogICAgICAgICAgICAvLyBBdXRvIHJlcG9ydAogICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0Fkc2NlbmRtZWRpYScsIHJlZi5ob3N0LCBob3N0KTsKICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uCiAgICAgICAgICAgIEFhay5ub3RpZmljYXRpb24oJ1lvdSBtdXN0IHN1YnNjcmliZSB0byA8Yj5BYWtMaXN0IChBbnRpLUFkYmxvY2sgS2lsbGVyICk8L2I+IDxhIGhyZWY9IicgKyBBYWsuc3Vic2NyaWJlVVJMICsgJyIgdGFyZ2V0PSJfYmxhbmsiPlN1YnNjcmliZTwvYT4nKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFkd29ya21lZGlhIDogewogICAgICAgIGhvc3QgOiBbJ2Fkd29ya21lZGlhLmNvbScsICdsb3h0ay5jb20nLCAnY29udGVudGxvY2tpbmduZXR3b3Jrcy5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gQWRXb3JrTWVkaWEgLSBodHRwczovL3d3dy5hZHdvcmttZWRpYS5jb20vCiAgICAgICAgICB2YXIgcmVmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpLmhyZWYgPSBkb2N1bWVudC5yZWZlcnJlcjsKICAgICAgICAgIHZhciBob3N0ID0gbG9jYXRpb24uaG9zdDsKICAgICAgICAgIHZhciBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICAgICAgICBpZiAoQWFrLmNvbnRhaW5zKHBhdGgsICcvaGVscC9yZW1vdmVBQi5waHAnKSAmJiAhQWFrLmNvbnRhaW5zKHJlZi5ob3N0LCBob3N0KSkgewogICAgICAgICAgICAvLyBBdXRvIHJlcG9ydAogICAgICAgICAgICBBYWsuaW5mbygnQWR3b3JrbWVkaWEnLCByZWYuaG9zdCwgaG9zdCk7CiAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbgogICAgICAgICAgICBBYWsubm90aWZpY2F0aW9uKCdZb3UgbXVzdCBzdWJzY3JpYmUgdG8gPGI+QWFrTGlzdCAoQW50aS1BZGJsb2NrIEtpbGxlciApPC9iPiA8YSBocmVmPSInICsgQWFrLnN1YnNjcmliZVVSTCArICciIHRhcmdldD0iX2JsYW5rIj5TdWJzY3JpYmU8L2E+Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAvLyBQbGF5ZXJzCiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgIGtpc3NhbmltZV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzQ1MQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zODEKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzAyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI1NwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNzgKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTk2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU2CiAgICAgICAgaG9zdCA6IFsna2lzc2FuaW1lLmNvbScsICdraXNzYW5pbWUudG8nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gTWFza2luZyBhZHMKICAgICAgICAgIEFhay5hZGRTdHlsZSgnaWZyYW1lW2lkXj0iYWRzSWZybWUiXSwgLmRpdkNsb3NlQnV0IHsgZGlzcGxheTpub25lOyB9Jyk7CiAgICAgICAgICAvLyBTb2x1dGlvbiAxCiAgICAgICAgICBBYWsudXcuRG9EZXRlY3QyID0gbnVsbDsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAvLyBTb2x1dGlvbiAxIGFicCBydWxlCiAgICAgICAgICAvLyBAQHx8a2lzc2FuaW1lLmNvbV4kZWxlbWhpZGUKCiAgICAgICAgICB2YXIgZGl2Q29udGVudFZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RpdkNvbnRlbnRWaWRlbycpOwoKICAgICAgICAgIC8vIFNvbHV0aW9uIDIKICAgICAgICAgIGlmIChBYWsudXcuRG9EZXRlY3QyKSB7CiAgICAgICAgICAgIEFhay51dy5Eb0RldGVjdDIgPSBudWxsOwogICAgICAgICAgICBBYWsudXcuQ2hlY2tBZEltYWdlID0gbnVsbDsKICAgICAgICAgICAgQWFrLmluZm8oJ1NvbHV0aW9uIDInKTsKICAgICAgICAgIH0gLy9Tb2x1dGlvbiAzCiAgICAgICAgICBlbHNlIGlmIChkaXZDb250ZW50VmlkZW8pIHsKCiAgICAgICAgICAgIHZhciBkaXZEb3dubG9hZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkaXZEb3dubG9hZCcpLmNsb25lTm9kZSh0cnVlKTsKCiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGRpdkNvbnRlbnRWaWRlby5pbm5lckhUTUwgPSAnJzsKICAgICAgICAgICAgICBBYWsudXcuRG9IaWRlRmFrZSgpOwogICAgICAgICAgICAgIGRpdkNvbnRlbnRWaWRlby5hcHBlbmRDaGlsZChkaXZEb3dubG9hZCk7CiAgICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJ2lmcmFtZVtpZF49ImFkc0lmcm1lIl0sIC5kaXZDbG9zZUJ1dCcpOwogICAgICAgICAgICAgIEFhay5pbmZvKCdTb2x1dGlvbiAzJyk7CiAgICAgICAgICAgIH0sIDU1MDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgS2lzc2NhcnRvb25fbWUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzQ4OAogICAgICAgIGhvc3QgOiBbJ2tpc3NjYXJ0b29uLm1lJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcueGFabEUgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCdpZnJhbWVbaWRePSJhZHNJZnJtZSJdJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBvcGVubG9hZF9kb21haW5zIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPW9wZW5sb2FkCiAgICAgICAgaG9zdCA6IFsnb3BlbmxvYWQuY28nLCAnb3BlbmxvYWQuaW8nLCAnb3BlbmxvYWQudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkYmxvY2sgPSBmYWxzZTsKICAgICAgICAgIEFhay51dy5hZGJsb2NrMiA9IGZhbHNlOwogICAgICAgICAgQWFrLnV3LnBvcEFkc0xvYWRlZCA9IHRydWU7CiAgICAgICAgICAvLyBoaWRlIGZha2UgcGxheSBidXR0b24gdXNlZCB0byBvcGVuIHBvcHVuZGVyCiAgICAgICAgICAvL0Fhay5hZGRTdHlsZSgnI3ZpZGVvb3ZlcmxheSB7IGRpc3BsYXk6bm9uZTsgfScpCiAgICAgICAgfQogICAgICB9LAogICAgICB5b3V3YXRjaF9vcmcgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9eW91d2F0Y2gKICAgICAgICAvLyB0ZXN0OiBodHRwOi8veW91d2F0Y2gub3JnL2VtYmVkLTU5cDdpM2Nka3NlMC00NTN4MzIwLmh0bWwKICAgICAgICAvLyB0ZXN0OiBodHRwOi8veW91d2F0Y2gub3JnLzU5cDdpM2Nka3NlMAogICAgICAgIGhvc3QgOiBbJ3lvdXdhdGNoLm9yZycsICdjaG91aGFhLmluZm8nLCAnYWh6YWhnNm9oYi5jb20nLCAnYWh6YWhnNm9oYi5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gc2tpcCBhbnRpLWFkYmxvY2sKICAgICAgICAgIEFhay51dy5hZHNTaG93UG9wdXAxID0gMTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHJlbm92ZSBhZHMgKyBmYWtlIHBsYXkgYnV0dG9uCiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI3BsYXllcl9pbWosICNwbGF5ZXJfaW1qICsgZGl2W2lkXScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZXhhc2hhcmVfY29tIDogewogICAgICAgIC8vIGJ5OiBXYXRpbGluCiAgICAgICAgLy8gcHVsbDogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9wdWxsLzUxOQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWV4YXNoYXJlLmNvbQogICAgICAgIC8vIHRlc3Q6ICBodHRwOi8vZXhhc2hhcmUuY29tL2dhbHcyZ2Uya3pzdgogICAgICAgIGhvc3QgOiBbJ2V4YXNoYXJlLmNvbScsICdjaGVmdGkuaW5mbycsICdib2plbTNhLmluZm8nLCAnYWppaGV6by5pbmZvJywgJ3lhaG1haWIzYWkuY29tJywgJ3lhaG1haWIzYWkuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHNraXAgYW50aS1hZGJsb2NrCiAgICAgICAgICBBYWsudXcuYWRzU2hvd1BvcHVwMSA9IDE7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyByZW5vdmUgYWRzICsgZmFrZSBwbGF5IGJ1dHRvbgogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNwbGF5ZXJfZ2F6LCAjcGxheWVyX2dheiArIGRpdltpZF0nKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFuMW1lX3NlIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xOTAKICAgICAgICBob3N0IDogWydhbjFtZS5zZSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBBYWsudXcuaXNCbG9ja0FkczIgPSBmYWxzZTsKICAgICAgICAgIH0sIDEwMDAwKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGhxcV90diA6IHsgLy8gcHV0bG9ja2VyLmlzCiAgICAgICAgaG9zdCA6IFsnaHFxLnR2J10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gKyBhYnAgcnVsZQogICAgICAgICAgLy8gaHR0cDovL2hxcS50di9wbGF5ZXIvZW1iZWRfcGxheWVyLnBocD92aWQ9UjNER0hHM0dLWFg3JmF1dG9wbGF5PW5vCiAgICAgICAgICBpZiAoJy9wbGF5ZXIvZW1iZWRfcGxheWVyLnBocCcgPT0gbG9jYXRpb24ucGF0aG5hbWUpIHsKICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVtpZF49ImZvcm0tIl0nKS5zdWJtaXQoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIFBvbGFuZAogICAgICB3cF9kb21haW5zIDogewogICAgICAgIC8vIE5vdGU6IGRpc2FibGUgRWFzeVByaXZhY3kKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTU2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzkwNQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zMDAKICAgICAgICBob3N0IDogWydiaXp0b2sucGwnLCAnd3AudHYnLCAnd3AucGwnLCAnc3BvcnRvd2VmYWt0eS5wbCcsICdrYWZldGVyaWEudHYnLCAna2FmZXRlcmlhLnBsJywgJy53cnp1dGEucGwnLCAncHVkZWxlay50dicsICdrb21lZGlvd28ucGwnLCAnc2ZvcmEucGwnLCAnYXV0b2tyYXRhLnBsJywgJ3Nwb3J0ZmFuLnBsJywgJ3dhd2Fsb3ZlLnBsJywgJ2hvdG1vbmV5LnBsJywgJ2FsZXNlcmlhbGUucGwnLCAnYmFib2wucGwnLCAnc25vYmthLnBsJywgJ25vY290eS5wbCcsICdtb25leS5wbCcsICdhYmN6ZHJvd2llLnBsJywgJ2dhZHpldG9tYW5pYS5wbCcsICdhdXRva3VsdC5wbCcsICdrb21vcmtvbWFuaWEucGwnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gcHJldmVudCBwb3B1cCBhbnRpLWFkYmxvY2sgZnJvbSBhYmN6ZHJvd2llLnBsCiAgICAgICAgICBBYWsuc2V0Q29va2llKCdBQkNBQkMnLCB0cnVlKTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIAogICAgICAgICAgQWFrLmhhc0VsZW1lbnQoJy53cC1wbGF5ZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAKICAgICAgICAgICAgdmFyIHJlcGxhY2VQbGF5ZXJXUCA9IGZ1bmN0aW9uIChtaWQsIHBsYXllcikgewogICAgICAgICAgICAgIC8qIFJlcXVlc3QKICAgICAgICAgICAgICBodHRwOi8vZ2V0LndwLnR2Lz9taWQ9MTY2MTA1NgogICAgICAgICAgICAgIGh0dHA6Ly93cC50di9wbGF5ZXIvbWlkLDE2NjEwNTYsZW1iZWQuanNvbgogICAgICAgICAgICAgIGh0dHA6Ly9nZXQud3AudHYvP2Y9Mjg5NjQ2Mi4xNDI2MzI5MDU2OTA0Lmwud2VibSZybmQ9MQogICAgICAgICAgICAgIGh0dHBzOi8vd3AudHYvcGxheWVyL21pZCwxNzQ3MTE3LGVtYmVkLmpzb24KICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICBBYWsucmVxdWVzdCh7CiAgICAgICAgICAgICAgICB1cmwgOiAnaHR0cDovL3dwLnR2L3BsYXllci9taWQsJyArIG1pZCArICcsZW1iZWQuanNvbicsCiAgICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXN1bHQucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShyZXMpOwogICAgICAgICAgICAgICAgICBBYWsubG9nKG9iaik7CgogICAgICAgICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgICAgICAgUGxheWVyLnZpZGVvanMocGxheWVyLCB7CiAgICAgICAgICAgICAgICAgICAgc291cmNlIDogQWFrLmZpeFByb3RvY29sVVJMKG9iai5jbGlwLnVybFsxXS51cmwpLCAvLyBIRAogICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnbXA0JywKICAgICAgICAgICAgICAgICAgICBhdXRvcGxheSA6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIHJlcGxhY2VQbGF5ZXJXcnp1dGEgPSBmdW5jdGlvbiAoa2V5LCBjaGFubmVsLCBlbGVtKSB7CiAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICAgICAgLy8gaHR0cDovL3d3dy53cnp1dGEucGwvbnBwL2VtYmVkL3dvbG5hcG9sc2thMi8wSTBIUTJtdXRKYwogICAgICAgICAgICAgICAgdXJsIDogJ2h0dHA6Ly93d3cud3J6dXRhLnBsL25wcC9lbWJlZC8nICsgY2hhbm5lbCArICcvJyArIGtleSwKICAgICAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3VsdC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKHJlcyk7CiAgICAgICAgICAgICAgICAgIEFhay5sb2cob2JqKTsKCiAgICAgICAgICAgICAgICAgIHZhciBQbGF5ZXIgPSBuZXcgQWFrLnBsYXllcigpOwogICAgICAgICAgICAgICAgICBQbGF5ZXIudmlkZW9qcyhlbGVtLCB7CiAgICAgICAgICAgICAgICAgICAgc291cmNlIDogQWFrLmZpeFByb3RvY29sVVJMKG9iai51cmxbMF0udXJsKSwgLy9IRAogICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnbXA0JywKICAgICAgICAgICAgICAgICAgICBhdXRvcGxheSA6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgLy8gVXNpbmcgYW4gZXh0ZXJuYWwgZmxhc2ggcGxheWVyIGlzIGltcG9zc2libGUgYmVjYXVzZSBwcm90ZWN0ZWQgYnkgY3Jvc3Nkb21haW4ueG1sCiAgICAgICAgICAgIHZhciBwbGF5ZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLndwLXBsYXllcicpOyAvLyAgI1BsYXllcjAsICNQbGF5ZXIxLCAjbWFpblBsYXllcgogICAgICAgICAgICBpZiAocGxheWVycy5sZW5ndGgpIHsKICAgICAgICAgICAgICAvLyBmaXhidWcgZ21feGhyIGxvb3AgcmVxdWVzdCAtIGh0dHA6Ly90aW55dXJsLmNvbS9wcWE5aHRxCiAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwbGF5ZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICB2YXIgbWlkID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBwbGF5ZXIgPSBwbGF5ZXJzW2ldOwogICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHBsYXllci5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgdmFyIHNjcmlwdCA9IHBsYXllci5wcmV2aW91c1NpYmxpbmc7CiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBwbGF5ZXIucXVlcnlTZWxlY3RvcignLnRpdGxlQ29udCBhLnRpdGxlJyk7CiAgICAgICAgICAgICAgICB2YXIgZW1iZWR2aWRlb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHRbc3JjKj0iL2VtYmVkX3ZpZGVvLmpzIl0nKTsKICAgICAgICAgICAgICAgIEFhay5sb2cocGxheWVyLCBwYXJlbnQsIHNjcmlwdCwgdGl0bGUpOwoKICAgICAgICAgICAgICAgIGlmIChlbWJlZHZpZGVvcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgLy8gcHVkZWxlay53cnp1dGEucGw6IGh0dHA6Ly90aW55dXJsLmNvbS9sOGpvNXYyCiAgICAgICAgICAgICAgICAgIC8vIHB1ZGVsZWsudHY6IGh0dHA6Ly90aW55dXJsLmNvbS9rbHl6aDZyLCBodHRwOi8vdGlueXVybC5jb20vejdmcjg5dgogICAgICAgICAgICAgICAgICAvLyBwdWRlbGVrLnR2ICh0cmlwbGUpOiBodHRwOi8vdGlueXVybC5jb20vbjliMjdvMgogICAgICAgICAgICAgICAgICAvLyBmaWxtLndwLnBsOiBodHRwOi8vdGlueXVybC5jb20vcTdrNWJ4cAogICAgICAgICAgICAgICAgICB2YXIgZW1iZWR2aWRlbyA9IGVtYmVkdmlkZW9zW2ldOwogICAgICAgICAgICAgICAgICB2YXIga2V5ID0gL2tleT0oXHcrKS8uZXhlYyhlbWJlZHZpZGVvLnNyYylbMV07CiAgICAgICAgICAgICAgICAgIHZhciBjaGFubmVsID0gL2xvZ2luPShcdyspLy5leGVjKGVtYmVkdmlkZW8uc3JjKVsxXTsKICAgICAgICAgICAgICAgICAgdmFyIGF1dG9zdGFydCA9IC9hdXRvcGxheS8udGVzdChlbWJlZHZpZGVvLnNyYyk7CiAgICAgICAgICAgICAgICAgIHJlcGxhY2VQbGF5ZXJXcnp1dGEoa2V5LCBjaGFubmVsLCBwbGF5ZXIsIGF1dG9zdGFydCk7CiAgICAgICAgICAgICAgICAgIEFhay5sb2coJ2VtYmVkX3ZpZGVvLmpzJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRpdGxlICYmIC9taWQvLnRlc3QodGl0bGUuaHJlZikpIHsKICAgICAgICAgICAgICAgICAgLy8gc3BvcnRvd2VmYWt0eS5wbDogaHR0cDovL3Rpbnl1cmwuY29tL2w2emFiY3gKICAgICAgICAgICAgICAgICAgbWlkID0gdGl0bGUuaHJlZi5tYXRjaCgvbWlkWz0sXShbMC05XSspLyk7CiAgICAgICAgICAgICAgICAgIEFhay5sb2coJ3RpdGxlLmhyZWYnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFyZW50LmlkKSB7CiAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuZGF0YXNldC51cmwpIHsKICAgICAgICAgICAgICAgICAgICAvLyB3cC50djogaHR0cDovL3Rpbnl1cmwuY29tL3B6ZGUyOXQKICAgICAgICAgICAgICAgICAgICBtaWQgPSBwYXJlbnQuZGF0YXNldC51cmwubWF0Y2goL21pZFs9LF0oWzAtOV0rKS8pOwogICAgICAgICAgICAgICAgICAgIEFhay5sb2coJ3BhcmVudC5kYXRhc2V0LnVybCcpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQucHJldmlvdXNTaWJsaW5nLmlubmVySFRNTCkgewogICAgICAgICAgICAgICAgICAgICAgLy8gd2lhZG9tb3NjaS53cC5wbDogaHR0cDovL3Rpbnl1cmwuY29tL2dxdHQ5Y2EKICAgICAgICAgICAgICAgICAgICAgIG1pZCA9IHBhcmVudC5wcmV2aW91c1NpYmxpbmcuaW5uZXJIVE1MLm1hdGNoKC9taWRbPSxdKFswLTldKykvKTsKICAgICAgICAgICAgICAgICAgICAgIEFhay5sb2coJ3NjcmlwdC5pbmxpbmUuaW5uZXJIVE1MJyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIGthZmV0ZXJpYS50djogaHR0cDovL3Rpbnl1cmwuY29tL25vZnA1OGEKICAgICAgICAgICAgICAgICAgICAgIC8vIGFiY3pkcm93aWUucGw6IGh0dHA6Ly90aW55dXJsLmNvbS9oeDZzNWV0CiAgICAgICAgICAgICAgICAgICAgICBtaWQgPSBwYXJlbnQuaW5uZXJIVE1MLm1hdGNoKC9taWRbPSxdKFswLTldKykvKTsKICAgICAgICAgICAgICAgICAgICAgIEFhay5sb2coJ3BhcmVudC5pbm5lckhUTUwnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2NyaXB0ICYmIHNjcmlwdC50YWdOYW1lID09ICdTQ1JJUFQnKSB7CiAgICAgICAgICAgICAgICAgIC8vIGZpbG0ud3AucGw6IGh0dHA6Ly90aW55dXJsLmNvbS9taDlvbmZ3CiAgICAgICAgICAgICAgICAgIC8vIHB1ZGVsZWsudHYgKGRvdWJsZSk6IGh0dHA6Ly90aW55dXJsLmNvbS9sZWZ2d3R4CiAgICAgICAgICAgICAgICAgIG1pZCA9IHNjcmlwdC5pbm5lckhUTUwubWF0Y2goL21pZFs9LF0oWzAtOV0rKS8pOwogICAgICAgICAgICAgICAgICBBYWsubG9nKCdzY3JpcHQuc3JjLmlubmVySFRNTCcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1pZCAhPT0gbnVsbCAmJiBtaWQubGVuZ3RoID09IDIpIHsKICAgICAgICAgICAgICAgICAgcmVwbGFjZVBsYXllcldQKG1pZFsxXSwgcGxheWVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbW9qZV9maWxteV9uZXR3b3JrOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEwMTAKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vN0cyUkJucXEKICAgICAgICBob3N0IDogWydtb2plLWZpbG15LnRrJywgJ21vamUtZmlsbXkubGl2ZSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBzZWFyY2h2YWx1ZSA9IFsndmFyIHBsYXllckluc3RhbmNlJywgJ30pOyddOwogICAgICAgICAgdmFyIHNjcmlwdCA9IEFhay5oYXNTY3JpcHQoc2VhcmNodmFsdWVbMF0pOwoKICAgICAgICAgIGlmIChzY3JpcHQpIHsKICAgICAgICAgICAgdmFyIHNvdXJjZSA9IHNjcmlwdC5pbm5lckhUTUw7CiAgICAgICAgICAgIHZhciBzdHIgPSBzb3VyY2Uuc3Vic3RyaW5nKHNvdXJjZS5sYXN0SW5kZXhPZihzZWFyY2h2YWx1ZVswXSksIHNvdXJjZS5sYXN0SW5kZXhPZihzZWFyY2h2YWx1ZVsxXSkgKyBzZWFyY2h2YWx1ZVsxXS5sZW5ndGgpOwogICAgICAgICAgICBBYWsuYWRkU2NyaXB0KHN0cik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB0dm5fcGwgOiB7CiAgICAgICAgLy8gYnk6IFJlZWssIE1hcmVrCiAgICAgICAgLy8gc29sdXRpb246IGh0dHA6Ly90aW55dXJsLmNvbS9vaGJ2ejRyLCBodHRwOi8vdGlueXVybC5jb20vanE4czQ2MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPXR2bi5wbAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPXR2bjI0LnBsCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9cGxheWVyLnBsCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL282ZDloNjYsIGh0dHA6Ly90aW55dXJsLmNvbS96NzdtNHpoCiAgICAgICAgaG9zdCA6IFsndHZuLnBsJywgJ3R2bjI0LnBsJywgJ3BsYXllci5wbCddLAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmhhc0VsZW1lbnQoJ2hlYWRlci5kZXRhaWxJbWFnZScsIGZ1bmN0aW9uICh0aGlzRWxlbWVudCkgewogICAgICAgICAgICBpZiAoQWFrLmdldENvb2tpZSgnY291bnRyeV9jb2RlJykgJiYgQWFrLmdldFNlc3Npb24oJ2dlbmVyYXRlVG9rZW4nKSkgewogICAgICAgICAgICAgICAgdmFyIHBhcnRzID0gZG9jdW1lbnQubG9jYXRpb24uaHJlZi5zcGxpdCgvWy4sXS8pOwogICAgICAgICAgICAgICAgdmFyIGlkID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMl07CiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICBwbGF0Zm9ybSA6ICJNb2JpbGUiLAogICAgICAgICAgICAgICAgICB0ZXJtaW5hbCA6ICJBbmRyb2lkIiwKICAgICAgICAgICAgICAgICAgZm9ybWF0IDogImpzb24iLAogICAgICAgICAgICAgICAgICB2IDogIjIuMCIsCiAgICAgICAgICAgICAgICAgIGF1dGhLZXkgOiAiYjRiYzk3MTg0MGRlNjNkMTA1YjMxNjY0MDNhYTFiZWEiLAogICAgICAgICAgICAgICAgICB0eXBlIDogImVwaXNvZGUiLAogICAgICAgICAgICAgICAgICBpZCA6IGlkLAogICAgICAgICAgICAgICAgICBzb3J0IDogIm5ld2VzdCIsCiAgICAgICAgICAgICAgICAgIG0gOiAiZ2V0SXRlbSIsCiAgICAgICAgICAgICAgICAgIGRldmljZVNjcmVlbkhlaWdodCA6IDE2MDAsCiAgICAgICAgICAgICAgICAgIGRldmljZVNjcmVlbldpZHRoIDogMjU2MAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHZhciBhcGkgPSAnaHR0cHM6Ly9hcGkudHZucGxheWVyLnBsL2FwaS8/JyArIEFhay5zZXJpYWxpemUocGFyYW1zKTsKICAgICAgICAgICAgICAgIHZhciBwcm94eSA9ICdodHRwOi8vd3d3LnByb3h5LnhtYy5wbC9pbmRleC5waHA/aGw9M2U1JnE9JzsJCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIEdldCB2aWRlb1VybAogICAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICAgICAgICB1cmwgOiBBYWsuZ2V0Q29va2llKCdjb3VudHJ5X2NvZGUnKSAhPSAnUEwnID8gcHJveHkgKyBBYWsuZW5jb2RlVVJJKGFwaSkgOiBhcGksCiAgICAgICAgICAgICAgICAgIGhlYWRlcnMgOiB7CiAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiIDogIk1vemlsbGEvNS4wIChMaW51eDsgVTsgQW5kcm9pZCA0LjI7IGVuLXVzOyBOZXh1cyAxMCBCdWlsZC9KVlAxNUkpIEFwcGxlV2ViS2l0LzUzNC4zMCAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIFNhZmFyaS81MzQuMzAiCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gcmVzdWx0LnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgICBBYWsubG9nKHJlcyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBKU09OLnBhcnNlKHJlcyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHZpZGVvVXJsID0gby5pdGVtLnZpZGVvcy5tYWluLnZpZGVvX2NvbnRlbnRbTnVtYmVyKEFhay5vcHRzLnZpZGVvSEQpXS51cmw7CiAgICAgICAgICAgICAgICAgICAgdmFyIGdlbmVyYXRlVG9rZW4gPSBuZXcgRnVuY3Rpb24oJ3ZpZGVvVXJsJywgQWFrLmdldFNlc3Npb24oJ2dlbmVyYXRlVG9rZW4nKSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHZpZGVvVXJsV2l0aFNlZWQgPSBnZW5lcmF0ZVRva2VuKHZpZGVvVXJsKTsKICAgICAgICAgICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgICAgICAgICBQbGF5ZXIudmlkZW9qcyh0aGlzRWxlbWVudCwgewogICAgICAgICAgICAgICAgICAgICAgc291cmNlIDogdmlkZW9VcmxXaXRoU2VlZCwKICAgICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnbXA0JywKICAgICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5OiBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0sIHt9LCB7aW5zZXJ0Oidpbm5lcid9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoeyAvLyBnZXQgYW5kIHN0b3JlIGdlbmVyYXRlVG9rZW4gZnVuY3Rpb24KICAgICAgICAgICAgICAgIHVybCA6ICdodHRwOi8vcGFzdGViaW4uY29tL3Jhdy9EOXFNNERSMycsCiAgICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3BvbnNlLnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgQWFrLnNldFNlc3Npb24oJ2dlbmVyYXRlVG9rZW4nLCByZXMpOwogICAgICAgICAgICAgICAgICBBYWsucmVxdWVzdCh7IC8vIGdldCB1c2VyIGlwCiAgICAgICAgICAgICAgICAgICAgdXJsIDogJ2h0dHA6Ly9pcC1hcGkuY29tL2pzb24nLAogICAgICAgICAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3BvbnNlLnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgICAgIHZhciBqc29uID0gSlNPTi5wYXJzZShyZXMpOwogICAgICAgICAgICAgICAgICAgICAgQWFrLnNldENvb2tpZSgnY291bnRyeV9jb2RlJywganNvbi5jb3VudHJ5Q29kZSk7CiAgICAgICAgICAgICAgICAgICAgICBBYWsucmVmcmVzaCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaXBsYV90diA6IHsKICAgICAgICAvLyBieTogTWFyZWsKICAgICAgICAvLyBzb2x1dGlvbjogaHR0cDovL3Rpbnl1cmwuY29tL3B0YjR5YmcKICAgICAgICAvLyBpc3N1ZS4gaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTIyCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL2h6N2dweHgKICAgICAgICBob3N0IDogWydpcGxhLnR2J10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCcuaHRtbDUtcGxheWVyLXdyYXBwZXIgeyBkaXNwbGF5Om5vbmU7IH0nKTsgLy8gY2hyb21lL29wZXJhCiAgICAgICAgICB2YXIgb2xkUGxheWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmh0bWw1LXBsYXllci13cmFwcGVyLCAjdm9kLXBsYXllcicpOwogICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICB1cmwgOiAnL1ZPRC9wbGF5LWluLWlwbGEvJyArIGxvY2F0aW9uLmhyZWYubWF0Y2goL1wvdm9kLShcZCspLylbMV0sCiAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICB2YXIgdmlkZW9VUkw7CiAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3VsdC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgdmFyIGlkbiA9IHJlcy5tYXRjaCgvaXBsYTpcL1wvcGxheXZvZC0xXHwoW2EtejAtOV0rKS8pWzFdOwogICAgICAgICAgICAgIEFhay5sb2coaWRuKTsKICAgICAgICAgICAgICBBYWsucmVxdWVzdCh7CiAgICAgICAgICAgICAgICB1cmwgOiAnaHR0cDovL2dldG1lZGlhLnJlZGVmaW5lLnBsL3ZvZHMvZ2V0X3ZvZC8/Y3BpZD0xJnVhPW1pcGxhLzIzJm1lZGlhX2lkPScgKyBpZG4sCiAgICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXN1bHQucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICB2YXIgbyA9IEpTT04ucGFyc2UocmVzKTsKICAgICAgICAgICAgICAgICAgQWFrLmxvZyhvKTsKICAgICAgICAgICAgICAgICAgaWYgKG8udm9kLnZpZGVvX2hkKSB7CiAgICAgICAgICAgICAgICAgICAgdmlkZW9VUkwgPSBvLnZvZC52aWRlb19oZDsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvLnZvZC52aWRlbykgewogICAgICAgICAgICAgICAgICAgIHZpZGVvVVJMID0gby52b2QudmlkZW87CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdmlkZW9VUkwgPSBvLnZvZC5jb3BpZXNbMF0udXJsOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgICAgICAgUGxheWVyLnZpZGVvanMob2xkUGxheWVyLCB7CiAgICAgICAgICAgICAgICAgICAgc291cmNlIDogdmlkZW9VUkwsCiAgICAgICAgICAgICAgICAgICAgdHlwZSA6ICdtcDQnLAogICAgICAgICAgICAgICAgICAgIHdpZHRoIDogODIwLAogICAgICAgICAgICAgICAgICAgIGhlaWdodCA6IDQ1MCwKICAgICAgICAgICAgICAgICAgICBhdXRvcGxheSA6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGtvc2NpYW5fbmV0IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy85MTQKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20veUdTUEJScWUKICAgICAgICBob3N0IDogWydrb3NjaWFuLm5ldCddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5iYW4nKTsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZWxlbXNbaV0ucmVtb3ZlKCk7CiAgICAgICAgICAgIC8vZWxlbXNbaV0uaW5uZXJIVE1MID0gJzxicj4nOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gRnJhbmNlCiAgICAgIHBsYXl0dl9mciA6IHsgLy8gcmVzZWFyY2ggc29sdXRpb24KICAgICAgICBob3N0IDogWydwbGF5LnR2JywgJ3BsYXl0di5mciddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkge30sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7fQogICAgICB9LAogICAgICBybWNzcG9ydGJmbXR2X2NvbSA6IHsgLy8gd2VicmFkaW8KICAgICAgICBob3N0IDogWydybWNzcG9ydC5iZm10di5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgdmFyIGZsYXNodmFycyA9IHsKICAgICAgICAgICAgdXJsUmFkaW8gOiAiaHR0cDovL21wM2xnNC50ZGYtY2RuLmNvbS8xMDE2MC9ybWMubXAzIiwKICAgICAgICAgICAgbm9tIDogImxpdmUiLAogICAgICAgICAgICBjYXRlZ29yaWUgOiAibGl2ZSIsCiAgICAgICAgICAgIHVybFNtYXJ0IDogIiIgLy8gc2V0IGVtcHR5IHRvIHJlbW92ZSBhdWRpbyBhZAogICAgICAgICAgfTsKICAgICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICAgIHdtb2RlIDogInRyYW5zcGFyZW50IgogICAgICAgICAgfTsKCiAgICAgICAgICBBYWsudXcuc3dmb2JqZWN0LmVtYmVkU1dGKCIvc3dmL1JNQ0xJVkUuc3dmIiwgImxpdmVwbGF5ZXIiLCAiNzAiLCAiOTAiLCAiMTAuMC4wIiwgIiIsIGZsYXNodmFycywgcGFyYW1zKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGVjbHlwc2lhX2NvbSA6IHsKICAgICAgICBob3N0IDogWydlY2x5cHNpYS5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIFNvbHV0aW9uIDEKICAgICAgICAgIC8vIGFicCBydWxlcwoKICAgICAgICAgIC8vIFNvbHV0aW9uIDIKICAgICAgICAgIEFhay51dy5pc0FCQWN0aXZhdGVkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9OyAvLyBLaWxsIGFudGlhZGJsb2NrCiAgICAgICAgICBBYWsudXcucmVmcmVzaF9pZnJhbWUgPSBmdW5jdGlvbiAoKSB7fTsgLy8gU3RvcCBhZHMgdG8gYmUgbG9hZGVkCiAgICAgICAgfSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIFNvbHV0aW9uIDMKICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2lkXj0id2VidHZfaWZyYW1lXyJdJyk7CiAgICAgICAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCkgewogICAgICAgICAgICB2YXIgdmlkZW9JZCA9IGVsZW1lbnQuaWQuc3BsaXQoJ18nKVsyXTsKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSAnPGlmcmFtZSBmcmFtZWJvcmRlcj0iMCIgd2lkdGg9IjgxMiIgaGVpZ2h0PSI1MDAiIHNyYz0iaHR0cDovL3d3dy5kYWlseW1vdGlvbi5jb20vZW1iZWQvdmlkZW8vJyArIHZpZGVvSWQgKyAnP2xvZ289MCZhdXRvUGxheT0xJmF1dG9NdXRlPTAiPjwvaWZyYW1lPic7CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgbTZ3ZWJfZnIgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzQ2MQogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9wdG4ydnJsCiAgICAgICAgaG9zdCA6IFsnbTZ3ZWIuZnInXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBwbGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdvYmplY3RbaWQkPSJfZmxhc2hfYXBpIl0nKTsKICAgICAgICAgIHZhciBzY3JpcHQgPSBBYWsuaGFzU2NyaXB0KCdNNi5QbGF5ZXIuY29uZmlnJyk7CgogICAgICAgICAgaWYgKHBsYXllciAhPT0gbnVsbCAmJiBzY3JpcHQgIT09IG51bGwpIHsKICAgICAgICAgICAgdmFyIGZvdW5kID0gc2NyaXB0LmlubmVySFRNTC5tYXRjaCgvTTYuUGxheWVyLmNvbmZpZyA9IChcey4rXH0pOy8pOwogICAgICAgICAgICB2YXIgY29uZmlnID0gSlNPTi5wYXJzZShmb3VuZC5wb3AoKSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBSZXBsYWNlIHBsYXllcgogICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgUGxheWVyLnZpZGVvanMocGxheWVyLnBhcmVudE5vZGUsIHsKICAgICAgICAgICAgICBzb3VyY2UgOiBjb25maWcuc291cmNlc1sxXS5zcmMsCiAgICAgICAgICAgICAgdHlwZSA6ICdtcDQnLAogICAgICAgICAgICAgIGF1dG9wbGF5IDogZmFsc2UKICAgICAgICAgICAgfSk7CgogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2FtaW5ncm9vbV90diA6IHsKICAgICAgICBob3N0IDogWydnYW1pbmdyb29tLnR2J10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRibG9ja19kZXRlY3QgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgIEFhay51dy5HUl9hZGJsb2NrX2hpZGVfdmlkZW8gPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgIEFhay51dy5hZGJsb2NrX3ZpZGVvX21zZ19zdGFydCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgICAgQWFrLnV3LmFkYmxvY2tfdmlkZW9fbXNnX3N0b3AgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgIEFhay51dy5kaXNhYmxlX2NoYXQgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIEdlcm1hbnkKICAgICAgbm93X2RvbWFpbnMgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzMzNgogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9wZWVvYm91CiAgICAgICAgLy8gdGVzdDogaHR0cDovL2pzYmluLmNvbS92dWNvYmVqb2ZvCiAgICAgICAgaG9zdCA6IFsndm94bm93LmRlJywgJ3J0bC1ub3cucnRsLmRlJywgJ3J0bDJub3cucnRsMi5kZScsICduLXR2bm93LmRlJywgJ3N1cGVycnRsbm93LmRlJywgJ3J0bG5pdHJvbm93LmRlJywgJ25vd3R2LmRlJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLyoKICAgICAgICAgIHZhciBQbGF5ZXIgPSBuZXcgQWFrLnBsYXllcigpOwogICAgICAgICAgUGxheWVyLmVkaXRpbmcoJyN2aWRlb3BsYXllcicsIHsKICAgICAgICAgIHVuc2V0Rmxhc2h2YXJzIDogJ2FiY2hlY2tfZW5hYmxlZCxhZGNhbGwsYWRjbGFzc2VzLGFkY29uZmlnLGFkbWV0YSxhZHNsb2csYWdvZixhbWEsYW5nZWJvdCxhcyxhc3BhcnRzLGJyZWFrYWQsY29ubmVjdGlvbmNoZWNrLGNzbG9nLGRldixkaW1tZXIsZXJyb3Jsb2csZmVlZGJhY2ssZm1zaWRlbnQsZ3R2LGhpZ2hsaWdodHMsaXZ3LGl2d19wbGF5LGpzLGpzX2V2ZW50X2Z1bmN0aW9uLGxvZ28sbG9nb19iYXNld2lkdGgsbG9nb3BvcyxuaWVsc2VuLG9yZCxvc21mLHN2bSx0aWxlLHZpZGVvcGxhemEsdmlkZW9wbGF6YV9iYXNlX3VybCx2aWRlb3BsYXphX3NoYXJlLHZpZGVvcGxhemFfdGFnLHZwRW52aXJvbm1lbnRVUkwseGwnCiAgICAgICAgICB9KTsKICAgICAgICAgICAqLwogICAgICAgIH0KICAgICAgfSwKICAgICAgcnRsX2RlIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTQxCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL2g3Y2N2cXEKICAgICAgICBob3N0IDogWydydGwuZGUnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdkaXZbZGF0YS13aWRnZXQ9InZpZGVvIl0nKSkubWFwKGZ1bmN0aW9uICh2aWRlbykgewogICAgICAgICAgICB2YXIgY2ZnID0gQWFrLmludG9PYmplY3QodmlkZW8uZGF0YXNldC5wbGF5ZXJMYXllckNmZyk7CiAgICAgICAgICAgIHZhciBmaWxlID0gY2ZnLnZpZGVvaW5mby5tcDR1cmw7CiAgICAgICAgICAgIEFhay5sb2codmlkZW8sIGNmZywgZmlsZSk7CgogICAgICAgICAgICAvLyBSZXBsYWNlIHBsYXllcgogICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgUGxheWVyLnZpZGVvanModmlkZW8sIHsKICAgICAgICAgICAgICBzb3VyY2UgOiBmaWxlLAogICAgICAgICAgICAgIHR5cGUgOiAnbXA0JywKICAgICAgICAgICAgICBhdXRvcGxheSA6IGZhbHNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBteXNwYXNzX2RlIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy83NgogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9sdG85cHlkCiAgICAgICAgaG9zdCA6IFsnbXlzcGFzcy5kZSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciB2aWRlb2lkID0gbG9jYXRpb24ucGF0aG5hbWUubWF0Y2goL1wvKFxkKylcLyQvKTsKCiAgICAgICAgICBpZiAodmlkZW9pZCAhPT0gbnVsbCkgewogICAgICAgICAgICBBYWsucmVxdWVzdCh7CiAgICAgICAgICAgICAgdXJsIDogJ2h0dHA6Ly93d3cubXlzcGFzcy5kZS9teXNwYXNzL2luY2x1ZGVzL2FwcHMvdmlkZW8vZ2V0dmlkZW9tZXRhZGF0YXhtbC5waHA/aWQ9JyArIHZpZGVvaWRbMV0sCiAgICAgICAgICAgICAgb25sb2FkIDogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3VsdC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICBBYWsubG9nKHJlcyk7CgogICAgICAgICAgICAgICAgLy8gR2V0IHZpZGVvCiAgICAgICAgICAgICAgICB2YXIgcGFyc2VyID0gbmV3IHdpbmRvdy5ET01QYXJzZXIoKTsKICAgICAgICAgICAgICAgIHZhciBkb20gPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHJlcywgImFwcGxpY2F0aW9uL3htbCIpOwogICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBkb20uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInVybF9mbHYiKS5pdGVtKDApLnRleHRDb250ZW50OwoKICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBlbGVtZW50cwogICAgICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJ2Rpdi5sb2FkaW5nR2lmJyk7CgogICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBwbGF5ZXIKICAgICAgICAgICAgICAgIHZhciBQbGF5ZXIgPSBuZXcgQWFrLnBsYXllcigpOwogICAgICAgICAgICAgICAgUGxheWVyLnZpZGVvanMoJyNwbGF5ZXInLCB7CiAgICAgICAgICAgICAgICAgIHNvdXJjZSA6IGZpbGUsCiAgICAgICAgICAgICAgICAgIHR5cGUgOiAnbXA0JywKICAgICAgICAgICAgICAgICAgYXV0b3BsYXkgOiBmYWxzZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBOZWRlcmxhbmQKICAgICAgcnRseGxfbmwgOiB7CiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL2wyemt2M2QKICAgICAgICBob3N0IDogWydydGx4bC5ubCcsICdydGxuaWV1d3MubmwnXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBQbGF5ZXIgPSBuZXcgQWFrLnBsYXllcigpOwogICAgICAgICAgUGxheWVyLmVkaXRpbmcoJyNfcnRsb3NtZjAnLCB7CiAgICAgICAgICAgIHNldEZsYXNodmFycyA6IHsKICAgICAgICAgICAgICBhZGJsb2NrIDogZmFsc2UKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBOb3J3YXkKICAgICAgdmd0dl9uZXR3b3JrIDogewogICAgICAgIC8vIG5vdGU6IHNraXAgdmlkZW8gYWRzICsgYW50aS1hZGJsb2NrCiAgICAgICAgLy8gandwbGF5ZXI6IGh0dHA6Ly90aW55dXJsLmNvbS96eXY3OWhnCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE0MDIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzY3CiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL253cDg1dCwgaHR0cDovL3Rpbnl1cmwuY29tL253cDg1dAogICAgICAgIGhvc3QgOiBbJ3ZndHYubm8nLCAndmcubm8nXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBvbGRIYXNoID0gbnVsbDsKICAgICAgICAgIHZhciB2aWRlb0lkID0gbnVsbDsKICAgICAgICAgIHZhciB2aWRlb0lkUmVnZXggPSAvI1whXC92aWRlb1wvKFxkKylcLy87CgogICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGxvY2F0aW9uIGhhc2ggY2hhbmdlcwogICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcGxheWVyID0gQWFrLmdldEVsZW1lbnQoJy52aWRlby1wbGF5ZXInKTsKCiAgICAgICAgICAgIGlmIChwbGF5ZXIgJiYgbG9jYXRpb24uaGFzaCAhPSBvbGRIYXNoICYmIHZpZGVvSWRSZWdleC50ZXN0KGxvY2F0aW9uLmhhc2gpKSB7CiAgICAgICAgICAgICAgb2xkSGFzaCA9IGxvY2F0aW9uLmhhc2g7CiAgICAgICAgICAgICAgdmlkZW9JZCA9IG9sZEhhc2gubWF0Y2godmlkZW9JZFJlZ2V4KVsxXTsKLyoKICAgICAgICAgICAgICB2YXIgaGxzdXJsID0gJ2h0dHBzOi8vc3Zwc2VjdXJlaGR2b2QtdmguYWthbWFpaGQubmV0L2kvMjAxNi8wMy8yMDE2MDMxMl81NmU0MjFmODZhZjQ1X3ZnMDEvLDEyODBfNzIwXzM1MDAsOTYwXzU0MF8xNTAwLDY0MF8zNjBfODAwLDQ4MF8yNzBfNTAwLC5tcDQuY3NtaWwvbWFzdGVyLm0zdTgnOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBsYXllcikKCiAgICAgICAgICAgICAgLy8gZG9uJ3Qgd29yayB3aXRoIGNocm9tZQogICAgICAgICAgICAgIC8vIHBsYXllci5pbm5lckhUTUwgPSAnPGRpdiBpZD0ibm9BZFBsYXllciI+VGhpcyB0ZXh0IHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHBsYXllci48L2Rpdj4nOwoKCiAgICAgICAgICAgICAgLy8gY2FuJ3QgbG9hZCBtM3U4IDQwMzIgc3RhdHVzIGNvZGUKICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHVuc2FmZVdpbmRvdy5qd3BsYXllcikKCiAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICAgICAgdXJsIDogJ2h0dHA6Ly9zdnAudmcubm8vc3ZwL2FwaS92MS92Z3R2L2Fzc2V0cy8nICsgdmlkZW9JZCArICc/YWRkaXRpb25hbD1zZXR0aW5nc3xjaGFwdGVyc3xjdWVQb2ludHN8ZXh0ZXJuYWxJZHxiYXJyZWxzfGV4dGVybmFsQ2F0ZWdvcnlJZHxuZXh0QXNzZXQmYXBwTmFtZT12Z3R2LXdlYnNpdGUnLAogICAgICAgICAgICAgICAgb25sb2FkIDogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICB2YXIgcmVzID0gcmVzdWx0LnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2UocmVzKTsKICAgICAgICAgICAgICAgICAgQWFrLmxvZyhvYmopOwoKICAgICAgICAgICAgICAgICAgLy8gcmVwbGFjZSBwbGF5ZXIKICAgICAgICAgICAgICAgICAgdmFyIFBsYXllciA9IG5ldyBBYWsucGxheWVyKCk7CiAgICAgICAgICAgICAgICAgIFBsYXllci52bGMocGxheWVyLCB7CiAgICAgICAgICAgICAgICAgICAgc291cmNlIDogb2JqLnN0cmVhbVVybHMuaGxzLCAvLyBtM3U4CiAgICAgICAgICAgICAgICAgICAgdHlwZSA6ICdobHMnLAogICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5IDogZmFsc2UKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwge30sIHsKICAgICAgICAgICAgICAgIGluc2VydCA6ICdpbm5lcicKICAgICAgICAgICAgICB9KTsKKi8KICAgICAgICAgICAgfQogICAgICAgICAgfSwgMWUzKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG10Z19yYWRpbyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTQ5NQogICAgICAgIGhvc3QgOiBbJ3BsYXkucmFkaW8xLnNlJywgJ3BsYXkuYmFuZGl0LnNlJywgJ3BsYXkubHVnbmFmYXZvcml0ZXIuY29tJywgJ3BsYXkucml4Zm0uc2UnXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB3aW5kb3cucGxheWVyX2xvYWRfbGl2ZSh3aW5kb3cuc3RyZWFtX2lkKTsKICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRwbGF5X25ldHdvcmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE0NjMKICAgICAgICBob3N0IDogWydkcGxheS5jb20nLCAnZHBsYXkuZGsnLCAnZHBsYXkuc2UnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgMzY1KTsKICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSBkYXRlLmdldFRpbWUoKS50b1N0cmluZygpOwogICAgICAgICAgdmFyIHZhbHVlID0gSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICJub3RpZmljYXRpb25TdWJtaXNzaW9uIiA6ICJzdWJtaXR0ZWQiLAogICAgICAgICAgICAgICJyZXBvcnRpbmdFeHBpcnkiIDogdGltZXN0YW1wLAogICAgICAgICAgICAgICJub3RpZmljYXRpb25FeHBpcnkiIDogdGltZXN0YW1wCiAgICAgICAgICAgIH0pOwogICAgICAgICAgQWFrLnNldENvb2tpZSgnZHNjLWFkYmxvY2snLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB2aWFzYXRfdHYgOiB7CiAgICAgICAgLy8gbm90ZTogc2tpcCB2aWRlbyBhZHMgKyBhbnRpLWFkYmxvY2sKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT10djNwbGF5CiAgICAgICAgLyogdGVzdDogaHR0cDovL3d3dy50djNwbGF5Lm5vL3Byb2dyYW1tZXIvcmVkbmluZ3Nza295dGEgaGRzL2hscwogICAgICAgICAgICAgICAgICAgaHR0cDovL3d3dy50djNwbGF5LmRrL3Byb2dyYW1tZXIvbGluc2Utb2ctZGlkZGUtZWtzdHJhIGhkcy9obHMKICAgICAgICAgICAgICAgICAgIGh0dHA6Ly93d3cudHYzcGxheS5zZS9wcm9ncmFtL2dsYW1vdXJhbWEgaGRzL2hscwogICAgICAgICAgICAgICAgICAgaHR0cDovL3d3dy50djZwbGF5LnNlL3Byb2dyYW0vOTktc2FrZXItbWFuLW1hc3RlLWdvcmEtaW5uYW4tbWFuLWRvciBoZHMvaGxzCiAgICAgICAgICAgICAgICAgICBodHRwOi8vd3d3LnR2OHBsYXkuc2UvcHJvZ3JhbS9lZnRlcmx5c3QtLTEgaGRzL2hscwogICAgICAgICAgICAgICAgICAgaHR0cDovL3d3dy50djEwcGxheS5zZS9wcm9ncmFtL2dhcnBlbnMtZXVyb3BhIGhkcy9obHMKICAgICAgICAgICAgICAgICAgIGh0dHA6Ly90dnBsYXkuc2thdGllcy5sdi9wYXJyYWlkZXMvdHYzLXppbmFzIGhkcy9obHMKICAgICAgICAgICAgICAgICAgIGh0dHA6Ly9wbGF5LnR2My5sdC9wcm9ncmFtb3MvYmVhdG9zLXZpcnR1dmUgcnRtcC9obHMKICAgICAgICAgICAgICAgICAgIGh0dHA6Ly90djNwbGF5LnR2My5lZS9zaXN1L3B1aGFwYWV2LXNlcG9nYSBydG1wL2hscyAqLwogICAgICAgIGhvc3QgOiBbJ3R2M3BsYXkubm8nLCAndHYzcGxheS5kaycsICd0djNwbGF5LnNlJywgJ3R2NnBsYXkuc2UnLCAndHY4cGxheS5zZScsICd0djEwcGxheS5zZScsICd0dnBsYXkuc2thdGllcy5sdicsICdwbGF5LnR2My5sdCcsICd0djNwbGF5LnR2My5lZSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5oYXNFbGVtZW50KCcjdmlkZW8tcGxheWVyJywgZnVuY3Rpb24gKHRoaXNFbGVtZW50KSB7CiAgICAgICAgICAgIHRoaXNFbGVtZW50LmlkID0gJyc7CiAgICAgICAgICAgIC8vdmFyIHZpZGVvSWQgPSBsb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpOwogICAgICAgICAgICB2YXIgdmlkZW9JZCA9IHRoaXNFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS12aWRlby1pZCcpOwogICAgICAgICAgICBBYWsubG9nKHRoaXNFbGVtZW50LCB2aWRlb0lkKTsKCiAgICAgICAgICAgIC8vIGdldCB2aWRlbyBzb3VyY2VzCiAgICAgICAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICAgICAgICB1cmwgOiAnaHR0cDovL3BsYXlhcGkubXRneC50di92My92aWRlb3Mvc3RyZWFtLycgKyB2aWRlb0lkLAogICAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXN1bHQucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2UocmVzKTsKICAgICAgICAgICAgICAgIEFhay5sb2cob2JqKTsKCiAgICAgICAgICAgICAgICAvKiBJbm5ob2xkZXQgZHUgcHLDuHZlciDDpSBzZSBlciBrdW4gdGlsZ2plbmdlbGlnIGZvciBicnVrZXJlIGkgTm9yZ2UKICAgICAgICAgICAgICAgIFByb2dyYW1tZXQgZXIgYmxva2VyZXQgZm9yIHZpc25pbmcgZnJhIGRlbm5lIGdlb2dyYWZpc2tlIHBvc2l0aW9uLgogICAgICAgICAgICAgICAgUHJvZ3JhbcSFIGdhbGl0ZSBtYXR5dGkgdGlrIGp1bmdkYW1pZXNpIGnFoSBMaWV0dXZvcyBpbnRlcm5ldG8gdGlla8SXasWzIHRpbmtsxbMgKi8KICAgICAgICAgICAgICAgIGlmIChvYmoubXNnKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzRWxlbWVudC5pbm5lckhUTUwgPSBvYmoubXNnOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbi5ob3N0ID09PSAndHYzcGxheS50djMuZWUnKSB7CiAgICAgICAgICAgICAgICAgIHZhciBQbGF5ZXIgPSBuZXcgQWFrLnBsYXllcigpOwogICAgICAgICAgICAgICAgICBQbGF5ZXIuZ3JpbmRwbGF5ZXIodGhpc0VsZW1lbnQsIHsKICAgICAgICAgICAgICAgICAgICBzb3VyY2UgOiBvYmouc3RyZWFtcy5tZWRpdW0sCiAgICAgICAgICAgICAgICAgICAgdHlwZSA6ICdydG1wL21wNCcsCiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXkgOiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIHZpZGVvIHRhZyBmb3IgbmV3IHBsYXllcgogICAgICAgICAgICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICAgICAgICAgICAgdGFnIDogJ3ZpZGVvJywKICAgICAgICAgICAgICAgICAgICBpZCA6ICdub0FkUGxheWVyJywKICAgICAgICAgICAgICAgICAgICBjbGFzc2lkIDogJ3ZpZGVvLWpzIHZqcy1kZWZhdWx0LXNraW4nLAogICAgICAgICAgICAgICAgICAgIHdpZHRoIDogdGhpc0VsZW1lbnQuY2xpZW50V2lkdGggfHwgNzMwLAogICAgICAgICAgICAgICAgICAgIGhlaWdodCA6IHRoaXNFbGVtZW50LmNsaWVudEhlaWdodCB8fCA0MTAsCiAgICAgICAgICAgICAgICAgICAgcHJlbG9hZCA6ICdhdXRvJywKICAgICAgICAgICAgICAgICAgICBjb250cm9scyA6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXkgOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHJlcGxhY2UgOiB0aGlzRWxlbWVudAogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgIC8vIHBhcnNlIHNvdXJjZXMKICAgICAgICAgICAgICAgICAgdmFyIHNyY0FycmF5ID0gW107CiAgICAgICAgICAgICAgICAgIGlmIChvYmouc3RyZWFtcy5oaWdoICYmIG9iai5zdHJlYW1zLmhpZ2ggIT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgc3JjQXJyYXkucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICB0eXBlIDogInZpZGVvL21wNCIsIC8vIG1wNAogICAgICAgICAgICAgICAgICAgICAgc3JjIDogb2JqLnN0cmVhbXMuaGlnaAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9ICBpZiAob2JqLnN0cmVhbXMuaGxzICYmIG9iai5zdHJlYW1zLmhscyAhPT0gJycpIHsKICAgICAgICAgICAgICAgICAgICBzcmNBcnJheS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgIHR5cGUgOiAiYXBwbGljYXRpb24veC1tcGVnVVJMIiwgLy8gbTN1OAogICAgICAgICAgICAgICAgICAgICAgc3JjIDogb2JqLnN0cmVhbXMuaGxzCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gIGlmIChvYmouc3RyZWFtcy5tZWRpdW0gJiYgb2JqLnN0cmVhbXMubWVkaXVtICE9PSAnJykgewogICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gb2JqLnN0cmVhbXMubWVkaXVtLmluZGV4T2YoJ3J0bXAnKSA9PT0gMCA/ICdydG1wL21wNCcgOiAnYXBwbGljYXRpb24vZjRtK3htbCc7CiAgICAgICAgICAgICAgICAgICAgc3JjQXJyYXkucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICB0eXBlIDogdHlwZSwKICAgICAgICAgICAgICAgICAgICAgIHNyYyA6IG9iai5zdHJlYW1zLm1lZGl1bQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIEFhay5sb2coc3JjQXJyYXksIEpTT04uc3RyaW5naWZ5KHNyY0FycmF5KSk7CiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIG5ldyBwbGF5ZXIKICAgICAgICAgICAgICAgICAgQWFrLmFkZFNjcmlwdChBYWsuaW50b1N0cmluZyhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBvblZqc1JlYWR5KCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93LnZpZGVvanMgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVmpzUmVhZHkoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnZpZGVvanMoIm5vQWRQbGF5ZXIiKS5zcmMoL19TT1VSQ0VTXy8pOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBvblZqc1JlYWR5KCk7CiAgICAgICAgICAgICAgICAgICAgICB9KSgpOwogICAgICAgICAgICAgICAgICAgIH0pLnJlcGxhY2UoIi9fU09VUkNFU18vIiwgSlNPTi5zdHJpbmdpZnkoc3JjQXJyYXkpKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gUnVzc2lhCiAgICAgIHJ1dHViZV9ydSA6IHsgLy8gcmVzZWFyY2ggc29sdXRpb24KICAgICAgICAvKiB0ZXN0OiBodHRwOi8vcnV0dWJlLnJ1L3ZpZGVvL2JkNWY2MDQ3NjU3ZjBiZGNiZmJiMGVkYWQyYmI3YzYxLyAqLwogICAgICAgIGhvc3QgOiBbJ3J1dHViZS5ydSddLAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmhhc0VsZW1lbnQoJyNydXR1YmVQbGF5ZXJIb2xkZXInLCBmdW5jdGlvbiAoKSB7ICAgICAgICAgICAgLy9kbUZ5SUc5d2RITWdQU0JCWVdzdVoyVjBSV3hsYldWdWRDZ2lJMjl3ZEdsdmJuTWlLVHNOQ2lBZ0lDQWdJQ0FnSUNBZ0lIWmhjaUJ2SUQwZ1FXRnJMbWx1ZEc5UFltcGxZM1FvYjNCMGN5NWtZWFJoYzJWMExuWmhiSFZsS1RzTkNpQWdJQ0FnSUNBZ0lDQWdJSFpoY2lCdE0zVTRWWEpzSUQwZ2J5NTJhV1JsYjE5aVlXeGhibU5sY2k1dE0zVTRPdzBLSUNBZ0lDQWdJQ0FnSUNBZ1kyOXVjMjlzWlM1c2IyY29iVE4xT0ZWeWJDazdEUW9OQ2lBZ0lDQWdJQ0FnSUNBZ0lIWmhjaUJRYkdGNVpYSWdQU0J1WlhjZ1FXRnJMbkJzWVhsbGNpZ3BPdzBLSUNBZ0lDQWdJQ0FnSUNBZ1VHeGhlV1Z5TG5acFpHVnZhbk1vSnlOeWRYUjFZbVZRYkdGNVpYSkliMnhrWlhJbkxDQjdEUW9nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdjMjkxY21ObElEb2diVE4xT0ZWeWJDd05DaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQjBlWEJsSURvZ0oyaHNjeWNzRFFvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnTHk5d2NtOTRlVG9nZEhKMVpTd05DaUFnSUNBZ0lDQWdJQ0FnSUNBZ0lDQmhkWFJ2Y0d4aGVTQTZJSFJ5ZFdVTkNpQWdJQ0FnSUNBZ0lDQWdJQ0FnZlRzZ0tUcz0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gSXRhbHkKICAgICAgcmFpX3R2IDogeyAvLyByZXNlYXJjaCBzb2x1dGlvbgogICAgICAgIGhvc3QgOiBbJ3JhaS50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7fQogICAgICB9LAogICAgICAvLyBUViBTdHJlYW0KICAgICAgYmxvY2tfc3RyZWFtc190diA6IHsKICAgICAgICAvLyBub3RlOiByZWRpcmVjdCB0byBodHRwOi8vYmxvY2suc3RyZWFtcy50di8KICAgICAgICBob3N0IDogWydmaXJzdHJvdy5jbycsICdmaXJzdHJvd3MucnUnLCAnZmlyc3Ryb3dzLnR2JywgJ2ZpcnN0cm93cy5vcmcnLCAnZmlyc3Ryb3dzLmNvJywgJ2ZpcnN0cm93cy5iaXonLCAnZmlyc3Ryb3d1cy5ldScsICdmaXJzdHJvdzF1cy5ldScsICdmaXJzdHNyb3dzcG9ydHMuZXUnLCAnZmlyc3Ryb3dzcG9ydGVzLnR2JywgJ2ZpcnN0cm93c3BvcnRlcy5jb20nLCAnanVzdGZpcnN0cm93c3BvcnRzLmNvbScsICdoYWhhc3BvcnQubWUnLCAnd2l6aXdpZy5ydScsICd3aXppd2lnLnN4JywgJ3dpeml3aWcudG8nLCAnd2l6aXdpZy50dicsICdteXAycC5iaXonLCAnbXlwMnAudHYnLCAnbXlwMnAubGEnLCAnbXlwMnAuZWMnLCAnbXlwMnAuZXUnLCAnbXlwMnAuc3gnLCAnbXlwMnAud3MnLCAnbXlwMnAuY29tJywgJ2F0ZGhlLnJ1JywgJ2F0ZGhlLnNlJywgJ2F0ZGhlLmJ6JywgJ2F0ZGhlLnRvcCcsICdhdGRoZS50bycsICdhdGRoZS5tZScsICdhdGRoZS5teCcsICcgYXRkaGUubGknLCAnYXRkaGUuYWwnXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoImFkYiIsIDEpOyAvLyBwcmV2ZW50IGFudGktYWRibG9jawogICAgICAgICAgQWFrLnV3Lm9wZW4gPSBmdW5jdGlvbiAoKSB7fTsgLy8gcHJldmVudCBwb3B1cAogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYmFubmVySW5DZW50ZXIsICNoaWRkZW5CYW5uZXJDYW52YXMgeyBkaXNwbGF5OiBub25lOyB9Iik7IC8vIGhpZGUgYWRzCiAgICAgICAgfQogICAgICB9LAogICAgICBidXppbmFfeHl6IDogewogICAgICAgIC8vIG5vdGU6IGRpc2FibGUgcmVmY29udHJvbCwgdXNlZCBieSBmaXJzdHJvd3Nwb3J0cwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjY4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyNDMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODg5CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZm9ydW0vZGlzY3Vzc2lvbi84OTc1CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tLzhWVHJrdlM5CiAgICAgICAgaG9zdCA6IFsnYnV6aW5hLnh5eicsICdmYXJtZXQuaW5mbycsICdyaW1sYWRpLmNvbScsICdraXRvcmVsby5jb20nLCAnb21uaXBvbGEuY29tJywgJ3Bvcm9zaW4uY28udWsnLCAncmltbGVuby5jb20nLCAnc2ltcGxlNGFsbHMuY29tJywgJ2Fyc29wby5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYWRzZnJhbWUgeyBoZWlnaHQ6IDE1MXB4OyB9Iik7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoL2J1emluYS54eXovLnRlc3QobG9jYXRpb24uaG9zdCkpIHsgLy8ga2VlcHMgc2FtZSBob3N0IHN0cmVhbQogICAgICAgICAgICBBYWsuaGFzRWxlbWVudCgnaWZyYW1lW3NyYyo9Ii5waHA/aGFzaD0iXScsIGZ1bmN0aW9uICh0aGlzRWxlbWVudCkgewogICAgICAgICAgICAgIC8vIGh0dHA6Ly9hcnNvcG8uY29tL3cyLnBocD9oYXNoPXBhbmRhNTgKICAgICAgICAgICAgICAvLyBodHRwOi8vd3d3LmJ1emluYS54eXovbmFuYTF2MS5waHA/b250aGV0b3AKICAgICAgICAgICAgICB2YXIgcGFydHMgPSB0aGlzRWxlbWVudC5zcmMuc3BsaXQoJy8nKTsKICAgICAgICAgICAgICBwYXJ0c1syXSA9IEFhay5ydWxlcy5idXppbmFfeHl6Lmhvc3QucG9wKCk7CiAgICAgICAgICAgICAgQWFrLmxvZyh0aGlzRWxlbWVudCwgcGFydHMpOwogICAgICAgICAgICAgIHRoaXNFbGVtZW50LnNyYyA9IHBhcnRzLmpvaW4oJy8nKTsKCiAgICAgICAgICAgICAgICAvKglkbUZ5SUc4Z1BTQjdDZ2tKQ1NBZ0lDQWljR3hoZVd4cGMzUWlJRG9nVzNzS0NRa0pJQ0FnSUNBZ0lDQWljSEp2ZG1sa1pYSWlJRG9nSW5KMGJYQWlMQW9KQ1FrZ0lDQWdJQ0FnSUNKMWNtd2lJRG9nSW5CaGJtUmhNVDlsSlRORU1UUTJOVEEzTURNeU5pVXlObk4wSlRORVVISjBTRmw1ZGtKNlpEbGFaRGRvUkY5bVVraFVaekV4TVRFek1DSUtDUWtKSUNBZ0lDQWdmUW9KQ1FrZ0lDQWdYU3dLQ1FrSklDQWdJQ0p3YkhWbmFXNXpJaUE2SUhzS0NRa0pJQ0FnSUNBZ0luSjBiWEFpSURvZ2V3b0pDUWtnSUNBZ0lDQWdJQ0oxY213aUlEb2dJbVpzYjNkd2JHRjVaWEl1Y25SdGNDMHpMakl1TVRFdWMzZG1JaXdnQ2drSkNRa0pMeThpZFhKc0lqb2dJbWgwZEhBNkx5OXlaV3hsWVhObGN5NW1iRzkzY0d4aGVXVnlMbTl5Wnk5emQyWXZabXh2ZDNCc1lYbGxjaTV5ZEcxd0xUTXVNaTR4TVM1emQyWWlMQW9KQ1FrZ0lDQWdJQ0FnSUNKdVpYUkRiMjV1WldOMGFXOXVWWEpzSWlBNklDSnlkRzF3T2k4dk1UZzFMamd5TGpJeE5TNDBOVG96TlRjNUwzWnZaQzhpQ2drSkNTQWdJQ0FnSUgwc0Nna0pDU0FnSUNBZ0lDSmpiMjUwY205c2N5SWdPaUI3Q2drSkNRa2dJQ0FnSW5WeWJDSTZJQ0pvZEhSd09pOHZjbVZzWldGelpYTXVabXh2ZDNCc1lYbGxjaTV2Y21jdmMzZG1MMlpzYjNkd2JHRjVaWEl1WTI5dWRISnZiSE10TXk0eUxqRTJMbk4zWmlJc0lDOHZJR0ZrWkdWa0lHSmxZMkYxYzJVZ2JXbHpjMmx1WndvSkNRa2dJQ0FnSUNBZ0lDSndiR0Y1SWlBNklHWmhiSE5sTEFvSkNRa2dJQ0FnSUNBZ0lDSnpZM0oxWW1KbGNpSWdPaUJtWVd4elpRb0pDUWtnSUNBZ0lDQjlDZ2tKQ1NBZ0lDQjlMQW9KQ1FrZ0lDQWdJbkJzWVhsbGNrbGtJaUE2SUNKd2JHRjVaWElpTEFvSkNRa2dJQ0FnSW1Oc2FYQWlJRG9nZXdvSkNRa2dJQ0FnSUNBaWRYSnNJaUE2SUNKd1lXNWtZVEUvWlNVelJERTBOalV3TnpBek1qWWxNalp6ZENVelJGQnlkRWhaZVhaQ2VtUTVXbVEzYUVSZlpsSklWR2N4TVRFeE16QWlDZ2tKQ1NBZ0lDQjlDZ2tKQ1NBZ2ZRb0tDUWtKSUNCMllYSWdibVYzVlhKc0lEMGdjR0Z5ZEhNdWMyeHBZMlVvTUN3Z015a3VhbTlwYmlnbkx5Y3BJQ3NnSnk5bWJHOTNjR3hoZVdWeUxUTXVNaTR4Tmk1emQyWS9ZMjl1Wm1sblBTY2dLeUJsYzJOaGNHVW9TbE5QVGk1emRISnBibWRwWm5rb2J5a3BPd29KQ1FrZ0lDOHZkbUZ5SUc1bGQxVnliQ0E5SUNkb2RIUndPaTh2Y21Wc1pXRnpaWE11Wm14dmQzQnNZWGxsY2k1dmNtY3ZjM2RtTDJac2IzZHdiR0Y1WlhJdE15NHlMakUyTG5OM1pqOWpiMjVtYVdjOUp5QXJJR1Z6WTJGd1pTaEtVMDlPTG5OMGNtbHVaMmxtZVNodktTazdDZ2tKQ1NBZ1kyOXVjMjlzWlM1c2IyY29ibVYzVlhKc0tUc0tDUWtKSUNCMGFHbHpSV3hsYldWdWRDNXpjbU1nUFNCdVpYZFZjbXc3CiAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgIAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7IC8vIHNraXAgYW50aS1hZGJsb2NrCiAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjYWRzZnJhbWUnKTsKICAgICAgICAgICAgQWFrLmdldEVsZW1lbnQoJyNyZW1vdmUtb3ZlcicpLmNsaWNrKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBhbGxteXZpZGVvc19uZXQgOiB7CiAgICAgICAgLy8gbm90ZTogb2JmdXNjYXRlZAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNzQKICAgICAgICBob3N0IDogWydhbGxteXZpZGVvcy5uZXQnLCAnYW12dHYubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHNraXAgZmFrZSBwbGF5IGJ1dHRvbgogICAgICAgICAgQWFrLnNldENvb2tpZSgnX2ZhdmJ0MzMnLCAxKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGlsaXZlX2RvbWFpbnMgOiB7CiAgICAgICAgaG9zdCA6IFsnaWxpdmUudG8nLCAnc3RyZWFtbGl2ZS50byddLAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC9eXC9lbWJlZHBsYXllci5waHAvaS50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSkgewogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAvLyBTa2lwIHRpbWVyCiAgICAgICAgICAgICAgQWFrLnV3LnJlbW92ZU92ZXJsYXlIVE1MKCk7CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgbWljYXN0X3R2IDogewogICAgICAgIGhvc3QgOiBbJ21pY2FzdC50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBwcmV2ZW50IHBvcHVuZGVyCiAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aWRfbWFpbicsIHRydWUpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgndmlkX3N1YicsIHRydWUpOwogICAgICAgICAgLy8gcmVtb3ZlIG92ZXJsYXkKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB3aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmICh3aW5kb3cucmVtb3ZlT3ZlcmxheUhUTUwpCiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlT3ZlcmxheUhUTUwoKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHhzdHJlYW1fdHYgOiB7CiAgICAgICAgaG9zdCA6IFsncHhzdHJlYW0udHYnXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICgvXlwvZW1iZWRyb3V0ZXIucGhwLy50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSkgewogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAvLyBTa2lwIHRpbWVyIGFuZCBjbG9zZSBhZHMKICAgICAgICAgICAgICBBYWsudXcuY2xvc2VBZCgpOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNhd2xpdmVfdHYgOiB7CiAgICAgICAgaG9zdCA6IFsnc2F3bGl2ZS50diddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICgvXlwvZW1iZWRcL3dhdGNoXC8vaS50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSkgewogICAgICAgICAgICAvLyBTa2lwIHRpbWVyIGFuZCBjbG9zZSBhZHMKICAgICAgICAgICAgQWFrLnV3LmRpc3BsYXkgPSBmYWxzZTsKICAgICAgICAgICAgQWFrLnV3LmNsb3NlTXlBZCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgZ29vZGNhc3RfY28gOiB7CiAgICAgICAgaG9zdCA6IFsnZ29vZGNhc3QuY28nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoL15cL3N0cmVhbS5waHAvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpKSB7CiAgICAgICAgICAgIC8vIHJlbW92ZSBhZHMgYWxsb3dlZCBieSBlYXN5bGlzdAogICAgICAgICAgICBBYWsudXcuJCgiLmFkdmVydGlzZW1lbnQiKS5oaWRlKCk7CiAgICAgICAgICAgIEFhay51dy4kKCcuYWRza3kgaWZyYW1lJykuYXR0cigic3JjIiwgImFib3V0OmJsYW5rIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBzaG93c3BvcnRfdHZfY29tIDogewogICAgICAgIGhvc3QgOiBbJ3Nob3dzcG9ydC10di5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoL15cL2NoLnBocC8udGVzdChsb2NhdGlvbi5wYXRobmFtZSkpIHsKICAgICAgICAgICAgLy8gcmVtb3ZlIGFkcyBhbGxvd2VkIGJ5IGVhc3lsaXN0CiAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjYWR2ZXJ0aXNlbWVudCwgLmFkdmVydGlzZW1lbnQnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNoYXJlY2FzdF90byA6IHsKICAgICAgICBob3N0IDogWydzaGFyZWNhc3QudG8nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoL15cL2VtYmVkLnBocC8udGVzdChsb2NhdGlvbi5wYXRobmFtZSkpIHsKCiAgICAgICAgICAgIC8vIERpc2FibGUgcG9wdW5kZXJzCiAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIEFhay5zZXRDb29raWUoJ3ZpZF9tYWluJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aWRfc3ViJywgMik7CiAgICAgICAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aWRfZGVsYXknLCB0cnVlKTsKICAgICAgICAgICAgICB9LCAxMDApOwoKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7CiAgICAgICAgICAgIH0sIDUwMDApOwoKICAgICAgICAgICAgLy8gUmVtb3ZlIHRyYW5zcGFyZW50IG92ZXJsYXkKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyN0YWJsZTEnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZpZGVvbWVnYV90diA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT12aWRlb21lZ2EKICAgICAgICBob3N0IDogWyd2aWRlb21lZ2EudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC9eXC92aWV3LnBocC8udGVzdChsb2NhdGlvbi5wYXRobmFtZSkpIHsKICAgICAgICAgICAgLy8gcHJldmVudCBwb3B1bmRlcgogICAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aWRfbWFpbnB1JywgdHJ1ZSk7CiAgICAgICAgICAgIEFhay5zZXRDb29raWUoJ3ZpZF9zdWJwdScsIHRydWUpOwogICAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aWRfZGVsYXknLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8ga2lsbCBhYmMKICAgICAgICAgIC8vIGZpeCBidWcgb24gZmlyZWZveDogVGhlIHZpZGVvIGNvdWxkIG5vdCBiZSBsb2FkZWQsIGVpdGhlciBiZWNhdXNlIHRoZSBzZXJ2ZXIgb3IgbmV0d29yayBmYWlsZWQgb3IgYmVjYXVzZSB0aGUgZm9ybWF0IGlzIG5vdCBzdXBwb3J0ZWQuCiAgICAgICAgICB2YXIgc2NyaXB0ID0gQWFrLmhhc1NjcmlwdCgnUGxlYXNlIGRpc2FibGUgQWRCbG9jayBQbHVnaW4gdG8gd2F0Y2ggdGhlIHZpZGVvJyk7CiAgICAgICAgICBpZiAoc2NyaXB0KSB7CiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBzY3JpcHQuaW5uZXJIVE1MOwogICAgICAgICAgICB2YXIgc3Vic3RyaW5nID0gc291cmNlLnN1YnN0cmluZyhzb3VyY2UubGFzdEluZGV4T2YoJ2V2YWwoJyksIHNvdXJjZS5sYXN0SW5kZXhPZignKScpICsgMSk7CiAgICAgICAgICAgIHZhciBkZW9iZnVzY2F0ZWQgPSBBYWsudW5wYWNrU2NyaXB0KHN1YnN0cmluZyk7CiAgICAgICAgICAgIHZhciBuZXdTY3JpcHQgPSAnaWYoJytkZW9iZnVzY2F0ZWQuc3Vic3RyaW5nKGRlb2JmdXNjYXRlZC5pbmRleE9mKCd0cnVlJykpOwogICAgICAgICAgICBBYWsuYWRkU2NyaXB0KG5ld1NjcmlwdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBmbG93cGxheWVyX2FudGlhZGJsb2NrIDogewogICAgICAgIGhvc3QgOiBbJ3ZpZGVvZnVuLm1lJywgJ3ZpZGVvYnVnLm5ldCcsICd2aWRlbzQ0Lm5ldCcsICdwbGF5NDQubmV0JywgJ2J5em9vLm9yZycsICdwbGF5YmIubWUnLCAndmlkZW93aW5nLm1lJywgJ3ZpZGVvem9vLm1lJywgJ2Vhc3l2aWRlby5tZScsICdwbGF5cGFuZGEubmV0J10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgCiAgICAgICAgICAvKgogICAgICAgICAgaHR0cDovL3d3dy5hbmltZXRvb24udHYvYmxhY2stbGFnb29uLWVwaXNvZGUtMQogICAgICAgICAgaHR0cDovL3ZpZGVvd2luZy5tZS9lbWJlZD93PTcxOCZoPTQzOCZ2aWRlbz1vbmdvaW5nL3l1LWdpLW9oX2FyYy12Xy1fNTMubXA0CiAgICAgICAgICBodHRwOi8vcGxheWJiLm1lL2VtYmVkLnBocD93PTcxOCZoPTQzOCZ2aWQ9YXQvbncveXUtZ2ktb2hfYXJjLXZfLV81My5tcDQKICAgICAgICAgIGh0dHA6Ly92aWRlb3pvby5tZS9lbWJlZC5waHA/dz03MTgmaD00MzgmdmlkPWF0L253L3l1LWdpLW9oX2FyYy12Xy1fNTMubXA0CiAgICAgICAgICBodHRwOi8vd3d3LmVhc3l2aWRlby5tZS9nb2dvLz93PTcxOCZoPTQzOCZmaWxlPXl1LWdpLW9oX2FyYy12Xy1fNTMubXA0JnN2PTEKICAgICAgICAgIGh0dHA6Ly9wbGF5cGFuZGEubmV0L2VtYmVkLnBocD93PTcxOCZoPTQzOCZ2aWQ9YXQvbncveXUtZ2ktb2hfYXJjLXZfLV81My5tcDQKICAgICAgICAgICAqLwoKICAgICAgICAgIC8vIGFsbG93IGZ1bGxzY3JlZW4gd2hlbiBhYnAgaXMgZW5hYmxlZCBhbmQgcmVtb3ZlIGFkIGxheWVyCiAgICAgICAgICAvLyBhZHMgYmxvY2tlZCBieSBhYnAgcnVsZQogICAgICAgICAgaWYgKC9eXC8oZW1iZWR8Z29nb3xncGx1cykvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpKSB7CiAgICAgICAgICAgIHZhciBQbGF5ZXIgPSBuZXcgQWFrLnBsYXllcigpOwogICAgICAgICAgICBQbGF5ZXIuZWRpdGluZygnI2Zsb3dwbGF5ZXJfYXBpJywgewogICAgICAgICAgICAgIHNldEF0dHJpYnV0ZXMgOiB7CiAgICAgICAgICAgICAgICBhbGxvd2Z1bGxzY3JlZW4gOiB0cnVlCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHIzeiA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1sYWJlbDpSM1oKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vQzE1OWtldm4KICAgICAgICBob3N0IDogWydjaXR5YW0uY29tJywgJ2NvbXB1dGVyd29ybGR1ay5jb20nLCAndGVjaHdvcmxkLmNvbScsICd2My5jby51ayddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvKiBkb24ndCB3b3JrIHdpdGggY2hyb21lCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAnX3IzeicsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDoge30KICAgICAgICAgIH0pOwogICAgICAgICAgKi8KICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy4kKCIjcjN6LXdhaXQiKS5yZW1vdmUoKTsKICAgICAgICAgIEFhay51dy4kKCIucjN6LWhpZGUiKS5yZW1vdmVDbGFzcygicjN6LWhpZGUiKTsKICAgICAgICAgIEFhay51dy5fcjN6ID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdvb2dsZV9qb2JydW5uZXIgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZW4vZm9ydW0vbWVzc2FnZXMvNDA1CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzNDMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTM0MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84MzEKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI3NAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjYyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU2MQogICAgICAgIGhvc3QgOiBbJ25leHQtZXBpc29kZS5uZXQnLCAna2luZ21ha2VyLm5ld3MnLCAnZ2FtZXNwb3dlcml0YS5jb20nLCAndG9kYXlpZG9sLmNvbScsICdyZWNlaXZlLWEtc21zLmNvbScsICd3YWtldXBjYWxsbWUuY29tJywgJ3JpbmdteWNlbGxwaG9uZS5jb20nLCAnZmFxbW96aWxsYS5vcmcnLCAndGhlbWVteXBjLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3Lmdvb2dsZV9qb2JydW5uZXIgPSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIGZ1Y2thZGJvY2sgY3VzdG9taXplZAogICAgICBmYWJfZGF3bl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE3NDcKICAgICAgICBob3N0IDogWydkYXduLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdkZXRlY3RBZEJsb2NrJywgJ0RldGVjdEFkQmxvY2snKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl9zcG9ydHNfZnIgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyMTcKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vU3BFTjVkdVMKICAgICAgICBob3N0IDogWydzcG9ydHMuZnInXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnZmFiSW5zdGFuY2UnLCAnRmFiSW5zdGFuY2UnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl9ldXJvcGUxX2ZyIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMTg4CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1VMZTF2elFSCiAgICAgICAgaG9zdCA6IFsnZXVyb3BlMS5mciddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdmYWJJbnN0YW5jZScsICdGYWJJbnN0YW5jZScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX25ld3lvcmtlcl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzExNzcKICAgICAgICBob3N0IDogWyduZXd5b3JrZXIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ3NuaWZmQWRCbG9jaycsICdTbmlmZkFkQmxvY2snKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl93aXJlZF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEwNjEKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mci9mb3J1bS9kaXNjdXNzaW9uLzgyMzUKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vUHExNHY0RkMKICAgICAgICBob3N0IDogWyd3aXJlZC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnc25pZmZBZEJsb2NrJywgJ1NuaWZmQWRCbG9jaycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX21hbmdhc3Byb2plY3RfZG9tYWlucyA6IHsKICAgICAgICAvLyBub3RlOiBmdWNrYWRibG9jayB3aXRoIGN1c3RvbSBpbnN0YW5jZSBuYW1lCiAgICAgICAgLy8gbm90ZTogYWxzbyBhZGRlZCBhYnAgcnVsZQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMTI3CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZnIvZm9ydW0vZGlzY3Vzc2lvbi80MTMyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg1OAogICAgICAgIC8vIHNvdXJjZTogaHR0cHM6Ly9tYW5nYXMuemx4LmNvbS5ici9tYW5nYXpvcmRfbGliL2pzL2xpYi9jb250cm9sbGVycy9MZWl0b3IvTGVpdG9yLm1pbi5qcwogICAgICAgIGhvc3QgOiBbJ21hbmdhc3Byb2plY3QuY29tLmJyJywgJ21hbmdhc3Byb2plY3QubmV0LmJyJywgJ21hbmdhcy56bHguY29tLmJyJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ21hbmdhc0xlaXRvclNsaWRlcicsIEFhay5nZW5lcmF0ZUlEKCkpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX3FuaW1hdGVfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy83MzkKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNzA1CiAgICAgICAgLy8gbm90ZTogZnVja2FkYmxvY2sgY3VzdG9taXplZAogICAgICAgIGhvc3QgOiBbJ3FuaW1hdGUuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRCbG9ja0RldGVjdGVkID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBmYWJfZXVyb3RyYW5zcG9ydF9kZSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODU4CiAgICAgICAgLy8gbm90ZTogZnVja2FkYmxvY2sgd2l0aCBjdXN0b20gaW5zdGFuY2UgbmFtZQogICAgICAgIGhvc3QgOiBbJ2V1cm90cmFuc3BvcnQuZGUnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnYW50aUFkQmxvY2snLCBBYWsuZ2VuZXJhdGVJRCgpKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl9jYWRldGVjdCA6IHsKICAgICAgICAvLyBieTogU2tyNHRjaEdyM2F6eU1vbmtpQmFsbGxsbGxaenp6CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzc4NAogICAgICAgIC8vIG5vdGU6IGZ1Y2thZGJsb2NrIHdpdGggY3VzdG9tIGluc3RhbmNlIG5hbWUKICAgICAgICBob3N0IDogWyd0emV0emUuaXQnLCAnYmVwcGVncmlsbG8uaXQnLCAnbGEtY29zYS5pdCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdjYWRldGVjdCcsICdDQURldGVjdCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX2FnYXJfZ2FtZSA6IHsKICAgICAgICAvLyBub3RlOiBmdWNrYWRibG9jayB3aXRoIGN1c3RvbSBpbnN0YW5jZSBuYW1lCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyNTcKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTEzNQogICAgICAgIGhvc3QgOiBbJ2FnYXJpby5zeCcsICdhZ2FyYWJpLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdhZ2FyaW9fU1hfYWRzJywgQWFrLmdlbmVyYXRlSUQoKSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmYWJfZmlsZXNwYWNlX2NvbSA6IHsKICAgICAgICAvLyBub3RlOiBmdWNrYWRibG9jayB3aXRoIGN1c3RvbSBpbnN0YW5jZSBuYW1lCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1lBUzBBczg3CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEwMzcKICAgICAgICBob3N0IDogWydmaWxlc3BhY2UuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ2ZBQicsIEFhay5nZW5lcmF0ZUlEKCkpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX3RvcHNlcmlhbHlfc2sgOiB7CiAgICAgICAgLy8gbm90ZTogZnVja2FkYmxvY2sgd2l0aCBjdXN0b20gaW5zdGFuY2UgbmFtZQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS80MnRVUTlhVgogICAgICAgIGhvc3QgOiBbJ3RvcHNlcmlhbHkuc2snXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnc3JhdE5hVmFzJywgQWFrLmdlbmVyYXRlSUQoKSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmYWJfY3VzdG9taXplZCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTQ1NQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNjU3CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL040MmE1QmpFCiAgICAgICAgaG9zdCA6IFsnZXBpY3VyaW91cy5jb20nLCAnZGVza3RvcHNvbHV0aW9uLm9yZycsICdpbmRpYXRpbWVzLmNvbScsICdoaW5kdXN0YW50aW1lcy5jb20nLCAnaGFwcHl0cmlwcy5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciBfc2V0QXR0cmlidXRlID0gd2luZG93LkVsZW1lbnQucHJvdG90eXBlLnNldEF0dHJpYnV0ZTsKICAgICAgICAgICAgICB3aW5kb3cuRWxlbWVudC5wcm90b3R5cGUuc2V0QXR0cmlidXRlID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PSAnY2xhc3MnICYmIHZhbHVlLmluZGV4T2YoJ3RleHRfYWRzJykgIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKHRoaXMsICdmYWIgaW50ZXJjZXB0ZWQgOi0pJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfc2V0QXR0cmlidXRlLmNhbGwodGhpcywgbmFtZSwgdmFsdWUpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGQzeHQzZXJfYW50aWFkYmxvY2sgOiB7CiAgICAgICAgLy8gc2l0ZTogaHR0cDovL2QzeHQzci5jb20vYW50aS1hZGJsb2NrCiAgICAgICAgLy8gY2FzZTogaHR0cDovL3Nwb3J0LXNob3cuZnIvanMvYWR2ZXJ0aXNlbWVudC1BZEJsb2NrLmpzCiAgICAgICAgLy8gY2FzZTogaHR0cDovL3d3dy4yc2l0ZS5tZS9hZHZlcnRpc2VtZW50LUFkQmxvY2suanMKICAgICAgICBob3N0IDogWydzcG9ydC1zaG93LmZyJywgJ3ZpcGZsYXNoLm5ldCcsICcyc2l0ZS5tZSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNibG9ja2Jsb2NrQSB7dmlzaWJpbGl0eTppbnZpc2libGU7ZGlzcGxheTpub25lO30gI2Jsb2NrYmxvY2tBIHRkIHt2aXNpYmlsaXR5OmludmlzaWJsZTtkaXNwbGF5Om5vbmU7fSAjYmxvY2tibG9ja0EgdGQgcCB7dmlzaWJpbGl0eTppbnZpc2libGU7ZGlzcGxheTpub25lO30gI2Jsb2NrYmxvY2tCIHt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTpibG9jazt9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBhZGJsb2NrX25vdGlmeSA6IHsKICAgICAgICAvLyBieTogU2tyNHRjaEdyM2F6eU1vbmtpQmFsbGxsbGxaenp6CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE3NjYKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTM5MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMDM5CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU5MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84MTMKICAgICAgICBob3N0IDogWydnYW1ldHJhbnNmZXJzLmNvbScsICd3aW5hbmRtYWMuY29tJywgJ2ZyZWUtc3RlYW0tZ2l2ZWF3YXlzLmNvbScsICdjYW5hbHdwLmNvbScsICdhbHBoYWhpc3RvcnkuY29tJywgJ25vcmRwcmVzc2UuYmUnLCAnc29zcGMubmFtZScsICdiYWJvby5jb20uYnInXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2FuQ29va2llJywgdHJ1ZSk7CiAgICAgICAgICBBYWsudXcuYW5PcHRpb25zID0ge307CiAgICAgICAgfQogICAgICB9LAogICAgICBsdXR0ZV9hZGJsb2NrIDogewogICAgICAgIC8vIHNpdGU6IGh0dHA6Ly9sdXR0ZWFkYmxvY2suYmxvZ3Nwb3QuY29tLzIwMTQvMTEvbGUtc2NyaXB0Lmh0bWwKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTM4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU4MAogICAgICAgIGhvc3QgOiBbJ2xld2VidHZib3VxdWV0ZnJhbmNvcGhvbmUub3ZlcmJsb2cuY29tJywgJ3dlYnR2LmJsb2d1ZXouY29tJywgJ2xhdGVsZWdyYXR1aXRlLmJsb2dzcG90LmNvbScsICd0b3RhbGRlYnJpZC5vcmcnLCAnMzcuMTg3LjE3My4yMDUnLCAndHZncmF0dWl0ZS5ibG9nc3BvdC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjbXlfYWRfZGl2Jyk7CiAgICAgICAgICBBYWsudXcuamFiYmFodWQgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFudGlibG9jayA6IHsKICAgICAgICAvLyBzaXRlOiBhbnRpYmxvY2sub3JnCiAgICAgICAgLy8gbm90ZTogY3VzdG9taXplZAogICAgICAgIC8vIGlzc3VlOiAKICAgICAgICBob3N0IDogWydteWJhbmsucGwnLCAncmFwaWRncmFiLnBsJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciBfYWRkRXZlbnRMaXN0ZW5lciA9IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyOwogICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7CiAgICAgICAgICAgICAgICBpZiAobGlzdGVuZXIudG9TdHJpbmcoKS5pbmRleE9mKCcubmV4dEZ1bmN0aW9uKCl9JykgPiAtMSkgewogICAgICAgICAgICAgICAgICBsaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oWydBbnRpQWRiS2lsbGVyJywgbG9jYXRpb24uaG9zdCwgJ0FudGlCbG9ja3tjdXN0b21pemVkfSddKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9hZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgdHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJsb2NrYWRibG9jayA6IHsKICAgICAgICAvLyBzaXRlOiBibG9ja2FkYmxvY2suY29tCiAgICAgICAgLy8gbm90ZTogcmFuZG9tIGluc3RhbmNlIG5hbWUKICAgICAgICAvLyBzb3VyY2U6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL1dhdGlsaW4vYWY3NWUwYTJlODJhMmVmYjM4NGJkZTljN2I0MWRlYzgKICAgICAgICAvLyBpc3N1ZXM6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bGFiZWw6QmxvY2tBZEJsb2NrCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZm9ydW0vZGlzY3Vzc2lvbi84MjczCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZm9ydW0vZGlzY3Vzc2lvbi83NjI1CiAgICAgICAgaG9zdCA6IFsnYmxvY2thZGJsb2NrLmNvbScsICdsaW5rZHJvcC5uZXQnLCAncmV2Y2xvdWRzLmNvbScsICdsZXBvcm5vLm9yZycsICd1cGxvYWRzaHViLmNvbScsICdkYXNvbG8ub3JnJywgJ2Z1bGxzdHVmZi5uZXQnLCAnemV1c25ld3MuaXQnLCAnY2hlbWlub3RzLm5ldCcsICdsb2xzeS50dicsICdhbmltZXMtbWFuZ2FzLWRkbC5jb20nLCAnbm90aWNpYXNhdXRvbW90aXZhcy5jb20uYnInLCAnZGFya3N0YXJzLm9yZycsICdjb3JlcGFja3MuY29tJywgJ25hdHVyYWxiZC5jb20nLCAnY29vbHNvZnQuYWx0ZXJ2aXN0YS5vcmcnLCAnb3BlbmxvYWQudXMnLCAnY2RhLW9ubGluZS5wbCcsICd1cmJhbnBsYW5ldC5vcmcnLCAnbWFtYWhkLmNvbScsICdzYWRlZW1wYy5jb20nLCAnYXZtb28uY29tJywgJ3RoYWlsYW5kZS1mci5jb20nLCAnYnRhaWEuY29tJywgJ3R1c29mdC5vcmcnLCAnaGlzc2UubmV0JywgJ2V1cm9wZXVwLmNvbScsICducmouZnInLCAnc3Juay5jbycsICdhbmltbWV4LmNvJywgJ3NvY2tldGxvb3AuY29tJywgJ2NyYWNraGV4LmNvbScsICdyZXZlYWxlZHRyaWNrczR1LmNvbScsICdwaXp6YW1ha2luZy5jb20nLCAnY29tcHV0ZXJ3b3JtLm5ldCcsICd5b3VybGlmZXVwZGF0ZWQubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyB2YXJpYW50IDEKICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgX3NldFRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dDsKICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCA9IGZ1bmN0aW9uIChmbiwgZGVsYXkpIHsKICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGZuLnRvU3RyaW5nKCkpCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnc3RyaW5nJyAmJiBmbi5pbmRleE9mKCdiYWJfZWxlbWVudGlkJykgPiAtMSkgewogICAgICAgICAgICAgICAgICBmbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oWydBbnRpQWRiS2lsbGVyJywgbG9jYXRpb24uaG9zdCwgJ0Jsb2NrQWRCbG9jayddKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9zZXRUaW1lb3V0LmNhbGwodGhpcywgZm4sIGRlbGF5KTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBncHRfc3AgOiB7CiAgICAgICAgLy8gYnk6IFJlZWssIEdpd2F5dW1lCiAgICAgICAgLy8gbm90ZTogd2hlbiBhZGJsb2NrIGRldGVjdGVkIGluamVjdCBuZXcgYWRzLCByZWRpcmVjdCB0byBodHRwOi8vdGlueXVybC5jb20venEyejVvNgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNjM2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE1OTYKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI5NwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMTQ0CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE1NDIKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vOEFqaXRmYjIKICAgICAgICBob3N0IDogWydtYXJrZXR3YXRjaC5jb20nLCAnZGVhZGxpbmUuY29tJywgJ3R3ZWFrdG93bi5jb20nLCAnbnlwb3N0LmNvbScsICdyZWFsZ20uY29tJywgJ25hc2RhcS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuY29udGFpbmVyLS1iYW5uZXJBZCwgLmNvbC0tYWQgeyBkaXNwbGF5OiBub25lOyB9Iik7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAvLyBHaXdheXVtZSAKICAgICAgICAgICAgICB3aW5kb3cuX3NwXyA9IHdpbmRvdy5fc3BfIHx8IHt9OwogICAgICAgICAgICAgIHdpbmRvdy5fc3BfLmNvbmZpZyA9IHdpbmRvdy5fc3BfLmNvbmZpZyB8fCB7fTsKICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93Ll9zcF8uY29uZmlnLCAiY29udGVudF9jb250cm9sX2NhbGxiYWNrIiwgewogICAgICAgICAgICAgICAgdmFsdWUgOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgICAgICBjb25maWd1cmFibGUgOiBmYWxzZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIC8vIFJlZWsKICAgICAgICAgICAgICB2YXIgX2FkZEV2ZW50TGlzdGVuZXIgPSB3aW5kb3cuRXZlbnRUYXJnZXQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI7CiAgICAgICAgICAgICAgd2luZG93LkV2ZW50VGFyZ2V0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSAnc3AuYmxvY2tpbmcnKSB7CiAgICAgICAgICAgICAgICAgIGxpc3RlbmVyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhbJ0FudGlBZGJLaWxsZXInLCBsb2NhdGlvbi5ob3N0LCAnR1BUe3NwLWJsb2NraW5nfSddKTsKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9hZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgdHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGtydXhfYXNsIDogewogICAgICAgIC8vIG5vdGU6IHdoZW4gYWRibG9jayBkZXRlY3RlZCBpbmplY3QgbmV3IGFkcwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS8wSEQ3Tjg0aQogICAgICAgIGhvc3QgOiBbJ2NvbW1lbnRjYW1hcmNoZS5uZXQnLCAnam91cm5hbGRlc2ZlbW1lcy5jb20nLCAnbGludGVybmF1dGUuY29tJ10sCiAgICAgICAgb25CZWZvcmVTY3JpcHQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW3sKICAgICAgICAgICAgICBkZXRlY3RlZCA6ICdLcnV4e2FzbH0nLAogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ0FzbC5wcm90b3R5cGUuaW5qZWN0JywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGtydXhfYWRwIDogewogICAgICAgIC8vIG5vdGU6IHdoZW4gYWRibG9jayBkZXRlY3RlZCBpbmplY3QgbmV3IGFkcwogICAgICAgIC8vIHNvdXJjZTogCiAgICAgICAgaG9zdCA6IFsnZm91cmNoZXR0ZS1ldC1iaWtpbmkuZnInLCAnbWV0ZW9jaXR5LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRQcm90ZWN0ID0gMTsKICAgICAgICB9CiAgICAgIH0sCSAKICAgICAgcGhvZW5peF9nb3lhdmVsYWIgOiB7CiAgICAgICAgLy8gbm90ZTogd2hlbiBhZGJsb2NrIGRldGVjdGVkIGluamVjdCBuZXcgYWRzCiAgICAgICAgLy8gbm90ZTogc2NyaXB0IGFudGktYWRibG9jayBvYmZ1c2NhdGVkLAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8KICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS9nbDNnaHEyCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL2hzQW1kU3VmCiAgICAgICAgaG9zdCA6IFsnZGVtby1waG9lbml4LmNvbScsICdkcHN0cmVhbS5uZXQnLCAnZ3VtLWd1bS1zdHJlYW1pbmcuY29tJywgJ2pldS5pbmZvJywgJ3NvZm9vdC5jb20nLCAnZ2FhcmEtZnIuY29tJywgJ2dheXR1YmUuY29tJywgJ3R1eGJvYXJkLmNvbScsICd4c3RvcnktZnIuY29tJywgJ2hlbnRhaWZyLm5ldCcsICdmaWxtc3RyZWFtaW5nLWhkLmNvbScsICdmaWxtdmYubmV0JywgJ2hlbnRhaWhhdmVuLm9yZycsICduYXJ1dG9zaGlwcHVkZW52Zi5jb20nLCAndGhlYmFkYnV6ei5jb20nLCAnbWFuZ2EtbmV3cy5jb20nLCAnamV1LnZpZGVvJywgJ21hbmdhcy1mci5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vQWFrLnV3Ll9fJGRjID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsuYWRkU3R5bGUoJ2JvZHkge3Zpc2liaWxpdHk6IHZpc2libGU7fScpOwogICAgICAgIH0sCiAgICAgICAgb25CZWZvcmVTY3JpcHQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW3sgCiAgICAgICAgICAgICAgZGV0ZWN0ZWQgOiAnUGhvZW5peEdveWF2ZWxhYicsCiAgICAgICAgICAgICAgY29udGFpbnMgOiAnUEhFTlYnLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVtb3ZlOiB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgIF07CiAgICAgICAgfQogICAgICB9LAogICAgICBhZF9kZWZlbmRfdWFicCA6IHsKICAgICAgICAvLyBub3RlOiB3aGVuIGFkYmxvY2sgZGV0ZWN0ZWQgaW5qZWN0IG5ldyBhZHMKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vY0ZRQ3A4MFcKICAgICAgICBob3N0IDogWyd0dnNwaWVsZmlsbS5kZScsICdmaW5hbnplbi5jaCddLAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICAgICAgZGV0ZWN0ZWQgOiAnQWREZWZlbmR7VUFCUEluamVjdH0nLAogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ1VBQlBJbmplY3QnLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVtb3ZlIDogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYWRfZGVmZW5kX3VhYiA6IHsKICAgICAgICAvLyBub3RlOiB3aGVuIGFkYmxvY2sgZGV0ZWN0ZWQgaW5qZWN0IG5ldyBhZHMKICAgICAgICAvLyB1c2Vyc2NyaXB0OiBodHRwczovL29wZW51c2VyanMub3JnL3NjcmlwdHMvc2Nod2FyenRlZS9BZERlZmVuZF9LbGF0c2NoZQogICAgICAgIC8vIHVzZXJzY3JpcHQ6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2Fub255bW91cy9hOWI5OTU2YmFmMWQ1OWExMDdjNQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS8xVnlXMHU5bSwgaHR0cDovL3Bhc3RlYmluLmNvbS9BWnFoUnhXVQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWxhYmVsOkFkRGVmZW5kCiAgICAgICAgLy8gcHVsbDogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9wdWxsLzQ2NwogICAgICAgIGhvc3QgOiBbJ3dhdGNoZ2VuZXJhdGlvbi5mcicsICd0dXJiby5mcicsICcyNG1hdGlucy5mcicsICdmb290MDEuY29tJywgJ2NsdWJpYy5jb20nLCAnbWFjZy5jbycsICdiZWdlZWsuZnInLCAnaWdlbi5mcicsICdnYW1lc3Rhci5kZScsICdmb2N1cy5kZScsICdzdGVybi5kZScsICdzYXQxLicsICdwcm9zaWViZW4uJywgJ2thYmVsZWlucy4nLCAnc2F0MWdvbGQuJywgJ3NpeHguJywgJ3Byb3NpZWJlbm1heHguJywgJ2ZlbS5jb20nLCAndGhlLXZvaWNlLW9mLWdlcm1hbnkuJywgJ3dldHRlci5jb20nLCAnd2V0dGVyb25saW5lLmRlJywgJ3Bjd2VsdC5kZScsICdib2Vyc2Utb25saW5lLmRlJywgJ3Nwb3J0YXV0by5kZScsICdhdXRvLW1vdG9yLXVuZC1zcG9ydC5kZScsICdtb3Rvci1rbGFzc2lrLmRlJywgJzR3aGVlbGZ1bi5kZScsICdhdXRvc3RyYXNzZW52ZXJrZWhyLmRlJywgJ2x1c3RpY2guZGUnLCAnc3BveC5jb20nLCAnc2h6LmRlJywgJ3RyYW5zZmVybWFya3QuZGUnLCAncnAtb25saW5lLmRlJywgJ21vdG9ycmFkb25saW5lLmRlJywgJzIwbWluLmNoJywgJ21haW4tc3BpdHplLmRlJywgJ3dvcm1zZXItemVpdHVuZy5kZScsICdsYW1wZXJ0aGVpbWVyLXplaXR1bmcuZGUnLCAnd2llc2JkZW5lci10YWdibGF0dC5kZScsICdidWVyc3RhZWR0ZXItemVpdHVuZy5kZScsICd3aWVzYmRlbmVyLWt1cmllci5kZScsICdyaGVpbi1tYWluLXByZXNzZS5kZScsICdhbGxnZW1laW5lLXplaXR1bmcuZGUnLCAnYXJpdmEuZGUnLCAnc3BpZWdlbC5kZScsICdicmlnaXR0ZS5kZScsICdkc2hpbmkubmV0JywgJ2dhbGEuZGUnLCAnZ2FtZXByby5kZScsICdnYW1vbmEuZGUnLCAncG5uLmRlJywgJ3Byb21vYmlsLmRlJywgJ3Nwb3J0YWwuZGUnLCAnd2ViZmFpbC5jb20nLCAnY29tcHV0ZXJiaWxkLmRlJywgJ2ZpbmFuemVuLm5ldCcsICdjb211bmlvLmRlJywgJ21lZGlzaXRlLmZyJ10sCiAgICAgICAgb25CZWZvcmVTY3JpcHQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW3sKICAgICAgICAgICAgICBkZXRlY3RlZCA6ICdBZERlZmVuZHt1YWJJbmplY3R9JywKICAgICAgICAgICAgICBjb250YWlucyA6ICd1YWJJbmplY3QnLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVtb3ZlIDogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLyogc29sdmVkIGJ5IEFha0xJc3QKICAgICAgdGlzb29taV9pbmRpcmVrdCA6IHsKICAgICAgLy8gaW5saW5lOiBodHRwOi8vcGFzdGViaW4uY29tL25wbVhUVUh3CiAgICAgIC8vIGV4dGVybmFsOiBodHRwOi8vcGFzdGViaW4uY29tL2h2V25DdUR3CiAgICAgIGhvc3QgOiBbJ2VuZXJneS5kZScsICdnZXR2aWRzLmRlJywgJ2dld2luZGUtbm9ybWVuLmRlJywgJ3BvZGNhc3QuZGUnLCAnc3BpZWxlc3BpZWxlbjI0LmRlJywgJ2RpYWxvLmRlJ10sCiAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgdmFyIHRleHQgPSB0YXJnZXQudGV4dDsKICAgICAgaWYgKEFhay5jb250YWlucyh0ZXh0LCAnbj0iYWJjZGVmZ2hpamtsbSIscj0ibm9wcXJzdHV2d3h5eiIsaT0iMDEyMzQ1Njc4OSI7dmFyIHM9dD09MD9pOnQ9PTE/bicpKSB7CiAgICAgIEFhay5zdG9wU2NyaXB0KGUpOwogICAgICBBYWsubG9nKCdUaXNvb21pIEluZGlyZWt0Jyk7CiAgICAgIH0KICAgICAgfQogICAgICB9LAogICAgICAgKi8KICAgICAgLyogc29sdmVkIGJ5IEFha0xJc3QKICAgICAgdGlzb29taV9kaXJla3QgOiB7CiAgICAgIC8vIGlubGluZTogaHR0cDovL3Bhc3RlYmluLmNvbS8ydnEzOEpYWQogICAgICBob3N0IDogWydhdXRvemVpdHVuZy5kZScsICdmb3JtZWwxLmRlJywgJ2ZyZW1kd29ydC5kZScsICdpbnNpZGUtaGFuZHkuZGUnLCAnbW90b3JzcG9ydC10b3RhbC5jb20nLCAnYXVzc2Vud2lydHNjaGFmdHNsdXBlLmRlJywgJ2Rvbm5lcndldHRlci5kZScsICd3aW50b3RhbC5kZSddLAogICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgIHZhciB0ZXh0ID0gdGFyZ2V0LnRleHQ7CiAgICAgIGlmIChBYWsuY29udGFpbnModGV4dCwgJ2Z1bmN0aW9uIGRldGVjdCgpJykpIHsKICAgICAgQWFrLnN0b3BTY3JpcHQoZSk7CiAgICAgIEFhay5sb2coJ1Rpc29vbWkgRGlyZWt0Jyk7CiAgICAgIH0KICAgICAgfQogICAgICB9LAogICAgICAgKi8KICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgLy8gR2VuZXJpYwogICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICBnZW5lcmljIDogewogICAgICAgIGhvc3QgOiBbJy4qPyddLAogICAgICAgIG9uUmVtb3ZlIDogZnVuY3Rpb24gKHJlbW92ZWROb2RlKSB7CiAgICAgICAgICBpZiAoQWFrLm9wdHMucmVtb3ZlZCkgewogICAgICAgICAgICBpZiAocmVtb3ZlZE5vZGUuc3JjIHx8CiAgICAgICAgICAgICAgcmVtb3ZlZE5vZGUuaWQgfHwKICAgICAgICAgICAgICByZW1vdmVkTm9kZS5jbGFzc05hbWUgJiYKICAgICAgICAgICAgICAhL15maXJlYnVnLy50ZXN0KHJlbW92ZWROb2RlLmNsYXNzTmFtZSkpIHsKICAgICAgICAgICAgICAvLyBOb2RlIHJlbW92ZWQKICAgICAgICAgICAgICBBYWsubG9nKHJlbW92ZWROb2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAvLyBGdWNrQWRCbG9jayAmIEJsb2NrQWRCbG9jayB2MyBhbmQgdjQKICAgICAgICAgIC8vIHNpdGU6IGh0dHA6Ly93d3cuc2l0ZXh3LmZyL2Z1Y2thZGJsb2NrLwogICAgICAgICAgLy8gcmVwbzogaHR0cHM6Ly9naXRodWIuY29tL3NpdGV4dy9GdWNrQWRCbG9jawogICAgICAgICAgLy8gcmVwbzogaHR0cHM6Ly9naXRodWIuY29tL3NpdGV4dy9CbG9ja0FkQmxvY2sKICAgICAgICAgIC8vIG5vdGU6IHdoZW4gZnVja2FkYmxvY2suanMgb3IgYmxvY2thZGJsb2NrLmpzIGlzIGJsb2NrZWQKICAgICAgICAgIC8vIGRlbW8gdjM6IGh0dHA6Ly9zaC5zdC92b3ZIRQogICAgICAgICAgLy8gZGVtbyB2NDogaHR0cDovL2FsLmx5L3FCYlhICiAgICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODg4CiAgICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODI0CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdmdWNrQWRCbG9jaycsICdGdWNrQWRCbG9jaycpOwogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnYmxvY2tBZEJsb2NrJywgJ0Jsb2NrQWRCbG9jaycpOwoKICAgICAgICAgIC8vIGNhblJ1bkFkcwogICAgICAgICAgLy8gcmVwbzogaHR0cHM6Ly9naXRodWIuY29tL01hdHRoZXdHcm9zcy9DYW5SdW5BZHMKICAgICAgICAgIC8vIG5vdGU6IHVzZSBleHRlcm5hbGwgc2NyaXB0ICIvanMvYWRzLmpzIiAtPiB2YXIgY2FuUnVuQWRzID0gdHJ1ZTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICdjYW5SdW5BZHMnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IHRydWUKICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIGNhblNob3dBZHMKICAgICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMTk3CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAnY2FuU2hvd0FkcycsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogdHJ1ZQogICAgICAgICAgfSk7CgogICAgICAgICAgLy8gQWRibG9ja2VyIERldGVjdGluZyBTY3JpcHRzOiBNZXRob2QgMgogICAgICAgICAgLy8gZ2lzdDogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vaXJhemFzeWVkLzNkMjQ3ZDNkMTIxZTc4MWEzODcyCiAgICAgICAgICAvLyBub3RlOiB1c2UgZXh0ZXJuYWxsIHNjcmlwdCAiL2pzL2Fkcy5qcyIgLT4gaXNBZEJsb2NrQWN0aXZlID0gZmFsc2U7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAnaXNBZEJsb2NrQWN0aXZlJywgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiBmYWxzZQogICAgICAgICAgfSk7CgogICAgICAgICAgLyoKICAgICAgICAgIHdpbmRvdy5pSGF2ZUxvYWRlZEFkcyA9IHRydWU7CiAgICAgICAgICB2YXIgbmljZUFkc0NoZWNrPXRydWU7CiAgICAgICAgICBhZGJsb2NrID0gZmFsc2UKICAgICAgICAgIGlzX2Jsb2NrZXIgPSBmYWxzZTsKICAgICAgICAgICAqLwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewoKICAgICAgICAgIC8vIEFkQmxvY2sgRGV0ZWN0b3IgKFhlbkZvcm8gUmVsbGVjdCkKICAgICAgICAgIC8vIHNpdGU6IGh0dHA6Ly90aW55dXJsLmNvbS9wYTI4eGRuCiAgICAgICAgICAvLyBjbG9uZUludG86IGh0dHA6Ly90aW55dXJsLmNvbS9rNnFwaG1lCiAgICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODA1CiAgICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODA0CiAgICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTkxCiAgICAgICAgICBpZiAoQWFrLnV3LlhlbkZvcm8gJiYgdHlwZW9mIEFhay51dy5YZW5Gb3JvLnJlbGxlY3QgPT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgQWFrLnV3LlhlbkZvcm8ucmVsbGVjdCA9IHsKICAgICAgICAgICAgICBBZEJsb2NrRGV0ZWN0b3IgOiB7CiAgICAgICAgICAgICAgICBzdGFydCA6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FkQmxvY2sgRGV0ZWN0b3IgKFhlbkZvcm8gUmVsbGVjdCknKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvKgogICAgICAgICAgLy8gQWR1bmJsb2NrIC0gaHR0cDovL2FkdW5ibG9jay5jb20vCiAgICAgICAgICBpZiAoQWFrLmdldENvb2tpZSgnYWRibG9jaycpID09IDEpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2FkYmxvY2snLCAwKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2Jhcl9jbG9zZWQnLCAxKTsKICAgICAgICAgIH0KICAgICAgICAgICAqLwoKICAgICAgICAgIC8vIEFkYmxvY2sgQmxvY2tlcgogICAgICAgICAgLy8gaHR0cHM6Ly93b3JkcHJlc3Mub3JnL3BsdWdpbnMvYWRkYmxvY2tibG9ja2VyLwogICAgICAgICAgLy8gaHR0cDovL3Rpbnl1cmwuY29tL25zd242ZnoKICAgICAgICAgIC8vIGh0dHA6Ly9wYXN0ZWJpbi5jb20vZDY1enIzN20KICAgICAgICAgIC8qIGNhbiBjYXVzZSBhIGJ1ZwogICAgICAgICAgdmFyIGFkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Fmc19hZHMnKTsKICAgICAgICAgIHZhciBhZCA9IGFkcy5sZW5ndGggJiYgYWRzW2Fkcy5sZW5ndGggLSAxXTsKICAgICAgICAgIGlmIChhZCAmJiBhZC5pbm5lckhUTUwubGVuZ3RoID09PSAwIHx8IGFkLmNsaWVudEhlaWdodCA9PT0gMCkgewogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lTmF0aXZlID0gSFRNTERvY3VtZW50LnByb3RvdHlwZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lOwogICAgICAgICAgSFRNTERvY3VtZW50LnByb3RvdHlwZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkgewogICAgICAgICAgaWYgKGNsYXNzTmFtZSA9PSAnYWZzX2FkcycpIHsKICAgICAgICAgIGNvbnNvbGUuaW5mbyhbJ0FudGlBZGJLaWxsZXInLCBsb2NhdGlvbi5ob3N0LCAnQWRibG9ja0Jsb2NrZXInLCBjbGFzc05hbWVdKTsKICAgICAgICAgIHZhciB1bmlxaWQgPSBEYXRlLm5vdygpOwogICAgICAgICAgdmFyIGJhaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgIGJhaXQuaW5uZXJIVE1MID0gJzxicj4nOwogICAgICAgICAgYmFpdC5jbGFzc05hbWUgPSB1bmlxaWQ7CiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGJhaXQpOwogICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodW5pcWlkKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lTmF0aXZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICAgKi8KCiAgICAgICAgICAvLyBBZGJ1ZGR5CiAgICAgICAgICBpZiAodHlwZW9mIEFhay51dy5jbG9zZUFkYnVkZHkgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgQWFrLnV3LmNsb3NlQWRidWRkeSgpOwogICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FkYnVkZHknKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBBZEJsb2NrIEFsZXJ0ZXIgKFdQKQogICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3dwLXBsdWdpbnMvYWRibG9jay1hbGVydGVyCiAgICAgICAgICAvLwogICAgICAgICAgaWYgKEFhay5nZXRFbGVtZW50KCdkaXYuYWRiX292ZXJsYXkgPiBkaXYuYWRiX21vZGFsX2ltZycpKSB7CiAgICAgICAgICAgIC8vIFJlbW92ZSBBbGVydCArIEFsbG93IFNjcm9sbAogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnZGl2LmFkYl9vdmVybGF5Jyk7CiAgICAgICAgICAgIEFhay5hZGRTdHlsZSgnaHRtbCxib2R5IHtoZWlnaHQ6YXV0bzsgb3ZlcmZsb3c6IGF1dG87fScpOwogICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FkQmxvY2tBbGVydGVyJyk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gVW5rbm93IEFudGkgQWRCbG9jayBzeXN0ZW0KICAgICAgICAgIGlmIChBYWsuZ2V0RWxlbWVudCgnI2Jsb2NrZGl2JykgJiYgQWFrLmNvbnRhaW5zKEFhay5nZXRFbGVtZW50KCcjYmxvY2tkaXYnKS5pbm5lckhUTUwsICdkaXNhYmxlIGFkIGJsb2NraW5nIG9yIHVzZSBhbm90aGVyIGJyb3dzZXIgd2l0aG91dCBhbnkgYWRibG9ja2VyIHdoZW4geW91IHZpc2l0JykpIHsKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNibG9ja2RpdicpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIEFudGlibG9jay5vcmcgdjIKICAgICAgICAgIC8vIG5vdGU6IGRldGVjdCBhbmQgc3RvcmUgYmxvY2sgaWQKICAgICAgICAgIC8vIGRlbW86IGh0dHA6Ly90aW55dXJsLmNvbS9uaHlocHprCiAgICAgICAgICB2YXIgc3R5bGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc3R5bGUnKTsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBzdHlsZSA9IHN0eWxlc1tpXTsKICAgICAgICAgICAgdmFyIGNzc1J1bGVzID0gc3R5bGUuc2hlZXQuY3NzUnVsZXM7CiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgY3NzUnVsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICB2YXIgY3NzUnVsZSA9IGNzc1J1bGVzW2pdOwogICAgICAgICAgICAgIHZhciBjc3NUZXh0ID0gY3NzUnVsZS5jc3NUZXh0OwogICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gL14jKFthLXowLTldezQsMTB9KSB+IFwqIFx7IGRpc3BsYXk6IG5vbmU7IFx9LzsKICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGNzc1RleHQpKSB7CiAgICAgICAgICAgICAgICB2YXIgaWQgPSBwYXR0ZXJuLmV4ZWMoY3NzVGV4dClbMV07CiAgICAgICAgICAgICAgICBpZiAoQWFrLmhhc1NjcmlwdCgidy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywiICsgaWQgKyAiLGZhbHNlKSIpKSB7CiAgICAgICAgICAgICAgICAgIEFhay5hYWJzLmFibzIgPSBpZDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHdpbiA9IEFhay51dzsKICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gd2luKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgaWYgKCEvXndlYmtpdC8udGVzdChwcm9wKSAmJiAvXlthLXowLTldezQsMTJ9JC9pLnRlc3QocHJvcCkgJiYgcHJvcCAhPT0gJ2RvY3VtZW50JyAmJiAod2luW3Byb3BdaW5zdGFuY2VvZiBIVE1MRG9jdW1lbnQpID09PSBmYWxzZSAmJiB3aW4uaGFzT3duUHJvcGVydHkocHJvcCkgJiYgdHlwZW9mIHdpbltwcm9wXSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgIHZhciBtZXRob2QgPSB3aW5bcHJvcF07CgogICAgICAgICAgICAgICAgLy8gQW50aWJsb2NrLm9yZyB2MyAmIEJldHRlclN0b3BBZGJsb2NrCiAgICAgICAgICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODMzCiAgICAgICAgICAgICAgICBpZiAobWV0aG9kLmRlZmVyRXhlY3V0aW9uICYmCiAgICAgICAgICAgICAgICAgIG1ldGhvZC5kaXNwbGF5TWVzc2FnZSAmJgogICAgICAgICAgICAgICAgICBtZXRob2QuZ2V0RWxlbWVudEJ5ICYmCiAgICAgICAgICAgICAgICAgIG1ldGhvZC5nZXRTdHlsZSAmJgogICAgICAgICAgICAgICAgICBtZXRob2QuaW5zZXJ0ICYmCiAgICAgICAgICAgICAgICAgIG1ldGhvZC5uZXh0RnVuY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgaWYgKG1ldGhvZC50b2dnbGUpIHsKICAgICAgICAgICAgICAgICAgICBBYWsuYWFicy5ic2EgPSBwcm9wOwogICAgICAgICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgnQmV0dGVyU3RvcEFkYmxvY2t7ZG9tfScpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIEFhay5hYWJzLmFibzMgPSBwcm9wOwogICAgICAgICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgnQW50aWJsb2NrM3tkb219Jyk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgd2luW3Byb3BdID0gbnVsbDsgLy8ga2lsbCBpbnN0YW5jZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIEJsb2NrQWRCbG9jawogICAgICAgICAgICAgICAgLy8gc2l0ZTogYmxvY2thZGJsb2NrLmNvbQogICAgICAgICAgICAgICAgLy8gbm90ZTogcmFuZG9tIGluc3RhbmNlIG5hbWUKICAgICAgICAgICAgICAgIC8vIHNvdXJjZTogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vV2F0aWxpbi9hZjc1ZTBhMmU4MmEyZWZiMzg0YmRlOWM3YjQxZGVjOAogICAgICAgICAgICAgICAgLy8gaXNzdWVzOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWxhYmVsJTNBQmxvY2tBZEJsb2NrCiAgICAgICAgICAgICAgICBpZiAobWV0aG9kLmJhYikgeyAvLyB2YXJpYW50IDEKICAgICAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdCbG9ja0FkQmxvY2t7ZG9tOnZhcmlhbnQxfScpOwogICAgICAgICAgICAgICAgICB3aW5bcHJvcF0gPSBudWxsOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChPYmplY3Qua2V5cyhtZXRob2QpLmxlbmd0aCA9PT0gMyAmJiBPYmplY3Qua2V5cyhtZXRob2QpLm1hcChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgICAgICAgICB9KS5qb2luKCkubGVuZ3RoID09PSAzMikgeyAvLyB2YXJpYW50IDIKICAgICAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdCbG9ja0FkQmxvY2t7ZG9tOnZhcmlhbnQyfScpOwogICAgICAgICAgICAgICAgICB3aW5bcHJvcF0gPSBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2Vycm9yJywgcHJvcCkKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIEFudGktQWRibG9ja2VycwogICAgICAgICAgdmFyIGFhYnMgPSB7CiAgICAgICAgICAgIC8vIFBsdWdpbnMgV29yZFByZXNzCiAgICAgICAgICAgIE5vQWRCbG9jayA6ICcoL3BsdWdpbnMvbm8tYWRibG9jay98L2Jsb2NrQmxvY2svYmxvY2tCbG9jay5qcXVlcnkuanMpJywKICAgICAgICAgICAgQmV0dGVyU3RvcEFkYmxvY2sgOiAnKC9wbHVnaW5zL2JldHRlci1zdG9wLWFkYmxvY2svfGJzYS1zY3JpcHQtZG9jdHlwZS5qc3xic2Etc2NyaXB0LW5vLWRvY3R5cGUuanMpJywKICAgICAgICAgICAgQWRCbG9ja0Jsb2NrZXIgOiAnL3BsdWdpbnMvd29yZHByZXNzLWFkYmxvY2stYmxvY2tlci8nLAogICAgICAgICAgICBBbnRpQmxvY2tCdWtzc2FBeW1hbiA6ICcvcGx1Z2lucy9hbnRpLWJsb2NrLycsCiAgICAgICAgICAgIEJsb2NrQWx5emVyIDogJy9wbHVnaW5zL2Jsb2NrYWx5emVyLWFkYmxvY2stY291bnRlci8nLAogICAgICAgICAgICBBZEJsb2NraW5nRGV0ZWN0b3IgOiAnL3BsdWdpbnMvYWQtYmxvY2tpbmctZGV0ZWN0b3IvJywKICAgICAgICAgICAgLy8gUGx1Z2lucyBXZWJzaXRlCiAgICAgICAgICAgIEFkd29ya21lZGlhIDogJyhhZHdvcmttZWRpYXxsb3h0a3xjb250ZW50bG9ja2luZ25ldHdvcmtzKS5jb20vZ0xvYWRlci5waHAnLAogICAgICAgICAgICBBZHNjZW5kbWVkaWEgOiAnYWRzY2VuZG1lZGlhLmNvbS9nd2pzLnBocCcsCiAgICAgICAgICAgIEZ1Y2tBZEJsb2NrIDogJygvZnVja2FkYmxvY2suanN8L2Jsb2NrYWRibG9jay5qcyknLAogICAgICAgICAgICBqUXVlcnlBZEJsb2NrIDogJy9qcXVlcnkuYWRibG9jay5qcycsCiAgICAgICAgICAgIGpRdWVyeUFkYmxvY2tEZXRlY3RvciA6ICcvanF1ZXJ5LmFkYmxvY2stZGV0ZWN0b3IuanMnLAogICAgICAgICAgICBBZEJsb2NrQWR2ZXJ0aXNlbWVudCA6ICcvYWR2ZXJ0aXNlbWVudC5qcycsCiAgICAgICAgICAgIEFkQmxvY2tBZHZlcnQgOiAnL2FkdmVydC5qcycsCiAgICAgICAgICAgIEFkQmxvY2tBZHZDdXN0b20gOiAnL2FkdmVydGlzZW1lbnQoLispLmpzJywKICAgICAgICAgICAgQWRCbG9ja0FkZnJhbWUgOiAnL2FkZnJhbWUuanMnLAogICAgICAgICAgICBBbnRpQWRCdXN0ZXIgOiAnL2FudGktYWQtYnVzdGVyLmpzJywKICAgICAgICAgICAgUlRLQW50aUFkYmxvY2sgOiAnL2Jsb2NrY2FrZS5qcycsCiAgICAgICAgICAgIEFkYmxvY2tEZXRlY3RvciA6ICcvQWRibG9ja0RldGVjdG9yL2hhbmRsZXIubWluLmpzJywKICAgICAgICAgICAgalF1ZXJ5QW50aUFkc0Jsb2NrIDogJy9qcXVlcnkuYW50aWFkc2Jsb2NrLmpzJywKICAgICAgICAgICAgQWRidWRkeSA6ICcvanMvYWRidWRkeS5taW4uanMnLAogICAgICAgICAgICBBbnRpQURzQmxvY2tlciA6ICcvYWFkYi9zY3JpcHQuanMnCiAgICAgICAgICB9OwoKICAgICAgICAgIHZhciBzY3JpcHRzID0gZG9jdW1lbnQuc2NyaXB0czsKICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc2NyaXB0cy5sZW5ndGg7IHkrKykgewogICAgICAgICAgICB2YXIgc2NyaXB0ID0gc2NyaXB0c1t5XTsKICAgICAgICAgICAgaWYgKHNjcmlwdC5zcmMpIHsKICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gYWFicykgewogICAgICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAoYWFic1trZXldLCAnaScpLnRlc3Qoc2NyaXB0LnNyYykpIHsKICAgICAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKFtrZXksIHNjcmlwdC5zcmNdKTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgIH0sCiAgICAgICAgb25JbnNlcnQgOiBmdW5jdGlvbiAoaW5zZXJ0ZWROb2RlKSB7CgogICAgICAgICAgLy8gQWxsIE5vZGVzCiAgICAgICAgICBpZiAoQWFrLm9wdHMuaW5zZXJ0ZWQpIHsKICAgICAgICAgICAgaWYgKGluc2VydGVkTm9kZS5zcmMgfHwKICAgICAgICAgICAgICBpbnNlcnRlZE5vZGUuaWQgfHwKICAgICAgICAgICAgICBpbnNlcnRlZE5vZGUuY2xhc3NOYW1lICYmCiAgICAgICAgICAgICAgIS9maXJlYnVnLy50ZXN0KGluc2VydGVkTm9kZS5pbm5lckhUTUwpKSB7CiAgICAgICAgICAgICAgLy8gTm9kZSBpbnNlcnRlZAogICAgICAgICAgICAgIEFhay5sb2coaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vIE5vLUFkYmxvY2sgLSBodHRwOi8vd3d3Lm5vLWFkYmxvY2suY29tLwogICAgICAgICAgaWYgKGluc2VydGVkTm9kZS5pZCAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUuaWQubGVuZ3RoID09IDQgJiYKICAgICAgICAgICAgL15bYS16MC05XXs0fSQvLnRlc3QoaW5zZXJ0ZWROb2RlLmlkKSAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUubm9kZU5hbWUgPT0gJ0RJVicgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQuaWQgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQuaWQgPT0gaW5zZXJ0ZWROb2RlLmlkICYmCiAgICAgICAgICAgIEFhay5jb250YWlucyhpbnNlcnRlZE5vZGUuaW5uZXJIVE1MLCAnbm8tYWRibG9jay5jb20nKSkgewogICAgICAgICAgICAvLyBSZW1vdmUKICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdOby1BZGJsb2NrJywgZmFsc2UsIGxvY2F0aW9uLmhyZWYpOwogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChpbnNlcnRlZE5vZGUpOwogICAgICAgICAgICAvL0Fhay5sb2coaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBTdG9wQWRibG9jayAtIGh0dHA6Ly9zdG9wYWRibG9jay5vcmcvZG93bmxvYWRzLwogICAgICAgICAgaWYgKGluc2VydGVkTm9kZS5pZCAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUuaWQubGVuZ3RoID09IDcgJiYKICAgICAgICAgICAgL15hW2EtejAtOV17Nn0kLy50ZXN0KGluc2VydGVkTm9kZS5pZCkgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5vZGVOYW1lID09ICdESVYnICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5wYXJlbnROb2RlICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5wYXJlbnROb2RlLmlkICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5wYXJlbnROb2RlLmlkID09IGluc2VydGVkTm9kZS5pZCArICcyJyAmJgogICAgICAgICAgICBBYWsuY29udGFpbnMoaW5zZXJ0ZWROb2RlLmlubmVySFRNTCwgJ3N0b3BhZGJsb2NrLm9yZycpKSB7CiAgICAgICAgICAgIC8vIFJlbW92ZQogICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ1N0b3BBZEJsb2NrJywgZmFsc2UsIGxvY2F0aW9uLmhyZWYpOwogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChpbnNlcnRlZE5vZGUpOwogICAgICAgICAgICAvL0Fhay5sb2coaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBBbnRpQWRibG9jayAoUGFja2VyKQogICAgICAgICAgdmFyIHJlSWZyYW1lSWQgPSAvXih6ZHx3ZCkkLzsKICAgICAgICAgIHZhciByZUltZ0lkID0gL14oeGR8Z2QpJC87CiAgICAgICAgICB2YXIgcmVJbWdTcmMgPSAvXC9hZHNcL2Jhbm5lci5qcGcvOwogICAgICAgICAgdmFyIHJlSWZyYW1lU3JjID0gLyhcL2FkaGFuZGxlclwvfFwvYWRpbWFnZXNcL3xhZC5odG1sKS87CgogICAgICAgICAgLy8gQ29tbXVucwogICAgICAgICAgaWYgKGluc2VydGVkTm9kZS5pZCAmJgogICAgICAgICAgICByZUltZ0lkLnRlc3QoaW5zZXJ0ZWROb2RlLmlkKSAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUubm9kZU5hbWUgPT0gJ0lNRycgJiYKICAgICAgICAgICAgcmVJbWdTcmMudGVzdChpbnNlcnRlZE5vZGUuc3JjKSB8fAogICAgICAgICAgICBpbnNlcnRlZE5vZGUuaWQgJiYKICAgICAgICAgICAgcmVJZnJhbWVJZC50ZXN0KGluc2VydGVkTm9kZS5pZCkgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5vZGVOYW1lID09ICdJRlJBTUUnICYmCiAgICAgICAgICAgIHJlSWZyYW1lU3JjLnRlc3QoaW5zZXJ0ZWROb2RlLnNyYykpIHsKCiAgICAgICAgICAgIC8vIFZhcmlhbnQgMQogICAgICAgICAgICBpZiAoaW5zZXJ0ZWROb2RlLmlkID09ICd4ZCcpIHsKICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FudGlBZGJsb2NrUGFja2VyWmR4ZCcsIGZhbHNlLCBsb2NhdGlvbi5ocmVmKTsKICAgICAgICAgICAgfSAvLyBWYXJpYW50IDIKICAgICAgICAgICAgZWxzZSBpZiAoaW5zZXJ0ZWROb2RlLmlkID09ICdnZCcpIHsKICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FudGlBZGJsb2NrUGFja2VyV2RnZCcsIGZhbHNlLCBsb2NhdGlvbi5ocmVmKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBSZW1vdmUKICAgICAgICAgICAgLy9BYWsubG9nKGluc2VydGVkTm9kZSk7CiAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGluc2VydGVkTm9kZSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQWR1bmJsb2NrIC0gaHR0cDovL2FkdW5ibG9jay5jb20vCiAgICAgICAgICB2YXIgcmVJZCA9IC9eW2Etel17OH0kLzsKICAgICAgICAgIHZhciByZUNsYXNzID0gL15bYS16XXs4fSBbYS16XXs4fS87CiAgICAgICAgICB2YXIgcmVCZyA9IC9eW2Etel17OH0tYmckLzsKICAgICAgICAgIHZhciByZU1lc3NhZ2UgPSAvSWwgc2VtYmxlcmFpdCBxdWUgdm91cyB1dGlsaXNpZXogdW4gYmxvcXVldXIgZGUgcHVibGljaXTDqSAhLzsKCiAgICAgICAgICAvLyBDb21tdW5zCiAgICAgICAgICBpZiAodHlwZW9mIEFhay51dy52dGZhYiAhPSAndW5kZWZpbmVkJyAmJgogICAgICAgICAgICB0eXBlb2YgQWFrLnV3LmFkYmxvY2tfYW50aWIgIT0gJ3VuZGVmaW5lZCcgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLnBhcmVudE5vZGUgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLnBhcmVudE5vZGUubm9kZU5hbWUgPT0gJ0JPRFknICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5pZCAmJgogICAgICAgICAgICByZUlkLnRlc3QoaW5zZXJ0ZWROb2RlLmlkKSAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUubm9kZU5hbWUgPT0gJ0RJVicgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5leHRTaWJsaW5nICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5uZXh0U2libGluZy5jbGFzc05hbWUgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5leHRTaWJsaW5nLm5vZGVOYW1lID09ICdESVYnKSB7CgogICAgICAgICAgICAvLyBGdWxsIFNjcmVlbiBNZXNzYWdlIChQcmVtaXVtKQogICAgICAgICAgICAvLyA8ZGl2IGlkPSJsZnloc3ZkcSIgY2xhc3M9InR2d25vcWRmIHN2b25leHJrIiBzdHlsZT0idG9wOiAxMDBweDsgb3BhY2l0eTogMTsgdmlzaWJpbGl0eTogdmlzaWJsZTsiPgogICAgICAgICAgICAvLyA8ZGl2IGNsYXNzPSJ0dndub3FkZi1iZyIgc3R5bGU9ImRpc3BsYXk6IGJsb2NrOyI+PC9kaXY+CiAgICAgICAgICAgIGlmIChpbnNlcnRlZE5vZGUuY2xhc3NOYW1lICYmCiAgICAgICAgICAgICAgcmVDbGFzcy50ZXN0KGluc2VydGVkTm9kZS5jbGFzc05hbWUpICYmCiAgICAgICAgICAgICAgcmVCZy50ZXN0KGluc2VydGVkTm9kZS5uZXh0U2libGluZy5jbGFzc05hbWUpICYmCiAgICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5leHRTaWJsaW5nLnN0eWxlICYmCiAgICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5leHRTaWJsaW5nLnN0eWxlLmRpc3BsYXkgIT0gJ25vbmUnKSB7CgogICAgICAgICAgICAgIC8vIFJlbW92ZSBNZXNzYWdlCiAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCJBZFVuQmxvY2tQcmVtaXVtIik7CiAgICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoaW5zZXJ0ZWROb2RlLm5leHRTaWJsaW5nKTsgLy8gb3ZlcmxheQogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGluc2VydGVkTm9kZSk7IC8vIGJveAogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIFRvcCBiYXIgTWVzc2FnZSAoRnJlZSkKICAgICAgICAgICAgLy8gPGRpdiBpZD0idml4bWdybHkiPgogICAgICAgICAgICAvLyA8ZGl2IGlkPSJtZm5oYWl5eCIgY2xhc3M9Imxrcm52Ynl0Ij4KICAgICAgICAgICAgZWxzZSBpZiAoaW5zZXJ0ZWROb2RlLm5leHRTaWJsaW5nLmlkICYmCiAgICAgICAgICAgICAgcmVJZC50ZXN0KGluc2VydGVkTm9kZS5uZXh0U2libGluZy5pZCkgJiYKICAgICAgICAgICAgICByZU1lc3NhZ2UudGVzdChpbnNlcnRlZE5vZGUuaW5uZXJIVE1MKSkgewoKICAgICAgICAgICAgICAvLyBSZW1vdmUgTWVzc2FnZQogICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgiQWRVbkJsb2NrRnJlZSIpOwogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGluc2VydGVkTm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAvLyBBbnRpYmxvY2sgLSBodHRwOi8vYW50aWJsb2NrLm9yZy8KICAgICAgICAgIHZhciByZU1zZ0lkID0gL15bYS16MC05XXs0LDEwfSQvaTsKICAgICAgICAgIHZhciByZVRhZzEgPSAvXihkaXZ8c3BhbnxifGl8Zm9udHxzdHJvbmd8Y2VudGVyKSQvaTsKICAgICAgICAgIHZhciByZVRhZzIgPSAvXihhfGJ8aXxzfHV8cXxwfHN0cm9uZ3xjZW50ZXIpJC9pOwogICAgICAgICAgdmFyIHJlV29yZHMxID0gL2FkIGJsb2NrZXJ8YWQgYmxvY2t8YWQtYmxvY2t8YWRibG9ja2VyfGFkLWJsb2NrZXJ8YWRibG9ja3xibG9xdWV1cnxibG9xdWVhZG9yfFdlcmJlYmxvY2tlcnxhZGJsb2NrZXJ0fCYjMTU3MDsmIzE1ODM7JiMxNTc2OyYjMTYwNDsmIzE2MDg7JiMxNjAzOyAmIzE1NzY7JiMxNjA0OyYjMTU4Nzt80LHQu9C+0LrQuNGA0L7QstGJ0LjQutC+0LwvaTsKICAgICAgICAgIHZhciByZVdvcmRzMiA9IC9rYXBhdHxkaXNhYmxlfGTDqXNhY3RpdmV6fGTDqXNhY3RpdmVyfGRlc2FjdGl2ZXp8ZGVzYWN0aXZlcnxkZXNhdGl2ZXxkZXNhY3RpdmFyfGRlc2FjdGl2ZXxkZXNhY3RpdmF8ZGVha3RpdmllcmV8ZGlzYWJpbGl0YXJlfCYjOTQ1OyYjOTYwOyYjOTQ5OyYjOTU3OyYjOTQ5OyYjOTYxOyYjOTQ3OyYjOTU5OyYjOTYwOyYjOTU5OyYjOTQzOyYjOTUxOyYjOTYzOyYjOTUxO3wmIzEwNzk7JiMxMDcyOyYjMTA4NzsmIzEwODg7JiMxMDc3OyYjMTA5NzsmIzEwNzI7JiMxMDkwOyYjMTEwMDt8w6FsbMOtdHNkIGxlfHB1YmxpY2l0w6lzfNGA0LXQutC70LDQvNC1fHZlcmhpbmRlcnR8YWR2ZXJ0fGthcGF0xLFuxLF6L2k7CgogICAgICAgICAgLy8gQW50aWJsb2NrLm9yZyAoYWxsIHZlcnNpb24pCiAgICAgICAgICBpZiAoaW5zZXJ0ZWROb2RlLnBhcmVudE5vZGUgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmlkICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5zdHlsZSAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUuY2hpbGROb2Rlcy5sZW5ndGggJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQgJiYKICAgICAgICAgICAgIWluc2VydGVkTm9kZS5maXJzdENoaWxkLmlkICYmCiAgICAgICAgICAgICFpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5jbGFzc05hbWUgJiYKICAgICAgICAgICAgcmVNc2dJZC50ZXN0KGluc2VydGVkTm9kZS5pZCkgJiYKICAgICAgICAgICAgcmVUYWcxLnRlc3QoaW5zZXJ0ZWROb2RlLm5vZGVOYW1lKSAmJgogICAgICAgICAgICByZVRhZzIudGVzdChpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5ub2RlTmFtZSkpIHsKICAgICAgICAgICAgLy9BYWsubG9nKGluc2VydGVkTm9kZSk7CgogICAgICAgICAgICAvLyBLaWxsIGF1ZGlvIG1lc3NhZ2UKICAgICAgICAgICAgdmFyIGF1ZGlvID0gaW5zZXJ0ZWROb2RlLnF1ZXJ5U2VsZWN0b3IoImF1ZGlvW2xvb3BdIik7CiAgICAgICAgICAgIGlmIChhdWRpbykgewogICAgICAgICAgICAgIGF1ZGlvLnBhdXNlKCk7CiAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBbnRpYmxvY2t7YXVkaW99Jyk7CiAgICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoYXVkaW8pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIEFudGlibG9jay5vcmcgdjIKICAgICAgICAgICAgLy8gZGVtbzogaHR0cDovL3Rpbnl1cmwuY29tL2gzbXd0YTQKICAgICAgICAgICAgZWxzZSBpZiAoKEFhay5hYWJzLmFibzIgJiYgaW5zZXJ0ZWROb2RlLmlkID09IEFhay5hYWJzLmFibzIpIHx8CiAgICAgICAgICAgICAgKGluc2VydGVkTm9kZS5maXJzdENoaWxkLmhhc0NoaWxkTm9kZXMoKSAmJiByZVdvcmRzMS50ZXN0KGluc2VydGVkTm9kZS5maXJzdENoaWxkLmlubmVySFRNTCkgJiYgcmVXb3JkczIudGVzdChpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5pbm5lckhUTUwpKSkgewogICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgnQW50aWJsb2NrMntpbnNlcnR9Jyk7CiAgICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBBbnRpYmxvY2sub3JnIHYzCiAgICAgICAgICAgIC8vIGRlbW86IGh0dHA6Ly90aW55dXJsLmNvbS9xZWNmYTd3CiAgICAgICAgICAgIC8vIGNhc2U6IGh0dHA6Ly90aW55dXJsLmNvbS96YnJscjNhIC8qIGZvcmsgKi8KICAgICAgICAgICAgZWxzZSBpZiAoKEFhay5hYWJzLmFibzMgJiYgaW5zZXJ0ZWROb2RlLmlkID09IEFhay5hYWJzLmFibzMpIHx8CiAgICAgICAgICAgICAgKGluc2VydGVkTm9kZS5maXJzdENoaWxkLmhhc0NoaWxkTm9kZXMoKSAmJiBpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5maXJzdENoaWxkLm5vZGVOYW1lID09ICdJTUcnICYmIC9eZGF0YTppbWFnZVwvcG5nO2Jhc2U2NC8udGVzdChpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5maXJzdENoaWxkLnNyYykpKSB7CiAgICAgICAgICAgICAgQWFrLnV3W0Fhay5hYWJzLmFibzNdID0gbnVsbDsKICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FudGlibG9jazN7aW5zZXJ0fScpOwogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGluc2VydGVkTm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gQmV0dGVyU3RvcEFkYmxvY2sKICAgICAgICAgICAgLy8gZGVtbzogaHR0cDovL3Rpbnl1cmwuY29tL2pzOXphdDQKICAgICAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1lpbWtydEtCCiAgICAgICAgICAgIC8vIGlzc3VlOiBodHRwOi8vdGlueXVybC5jb20vemV0Z2J0eAogICAgICAgICAgICBlbHNlIGlmIChBYWsuYWFicy5ic2EgJiYgaW5zZXJ0ZWROb2RlLmlkID09IEFhay5hYWJzLmJzYSkgewogICAgICAgICAgICAgIEFhay51d1tBYWsuYWFicy5ic2FdID0gbnVsbDsKICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0JldHRlclN0b3BBZGJsb2Nre2luc2VydH0nKTsKICAgICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChpbnNlcnRlZE5vZGUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vICBNYW55IGZhbHNlIHBvc2l0aXZlCiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIC8vQWFrLnJlbW92ZUVsZW1lbnQoaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGJsb2NrRGV0ZWN0IDogZnVuY3Rpb24gKCkgewoKICAgICAgLy8gRXhjbHVkZSBkb21haW5zCiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNDY2CiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjYzCiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL2ZvcnVtL2Rpc2N1c3Npb24vODQyMi8KICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzk4NgogICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODU3CiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy82MTcKICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZnIvZm9ydW0vZGlzY3Vzc2lvbi81NDI2CiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80MTkKICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzM3NwogICAgICB2YXIgZXhjbHVkZXMgPSBbIjM2MC5jbiIsICJhbWF6b24uIiwgImFwcGxlLmNvbSIsICJhc2suY29tIiwgImJhaWR1LmNvbSIsICJiaW5nLmNvbSIsICJidWZmZXJhcHAuY29tIiwgImNoYXRhbmdvLmNvbSIsICJjaHJvbWVhY3Rpb25zLmNvbSIsICJlYXN5aW5wbGF5Lm5ldCIsICJlYmF5LmNvbSIsICJmYWNlYm9vay5jb20iLCAiZmxhdHRyLmNvbSIsICJmbGlja3IuY29tIiwgImdoYWNrcy5uZXQiLCAiZ29vZ2xlLiIsICJpbWRiLmNvbSIsICJpbWdib3guY29tIiwgImltZ3VyLmNvbSIsICJpbnN0YWdyYW0uY29tIiwgImpzYmluLmNvbSIsICJqc2ZpZGRsZS5uZXQiLCAibGlua2VkaW4uY29tIiwgImxpdmUuY29tIiwgIm1haWwucnUiLCAibWljcm9zb2Z0LmNvbSIsICJtc24uY29tIiwgInBheXBhbC5jb20iLCAicGludGVyZXN0LmNvbSIsICJwcmVsb2FkZXJzLm5ldCIsICJxcS5jb20iLCAicmVkZGl0LmNvbSIsICJzdGFja292ZXJmbG93LmNvbSIsICJ0YW1wZXJtb25rZXkubmV0IiwgInR3aXR0ZXIuY29tIiwgInZpbWVvLmNvbSIsICJ3aWtpcGVkaWEub3JnIiwgInczc2Nob29scy5jb20iLCAieWFob28uIiwgInlhbmRleC5ydSIsICJ5b3V0dS5iZSIsICJ5b3V0dWJlLmNvbSIsICJ4ZW12dHYubmV0IiwgInZvZC5wbCIsICJhZ2FyLmlvIiwgInBhbmRvb24uaW5mbyIsICJmc2Yub3JnIiwgImFkYmxvY2twbHVzLm9yZyIsICJwbG5rci5jbyIsICJleGFjdHRhcmdldC5jb20iLCAiZG9sbGRpdmluZS5jb20iLCAicG9wbWVjaC5ydSIsICJjYWxtLmNvbSJdOwogICAgICB2YXIgaG9zdCA9IGxvY2F0aW9uLmhvc3Q7CiAgICAgIHZhciBleGNsdWRlZCA9IGZhbHNlOwogICAgICBleGNsdWRlcy5mb3JFYWNoKGZ1bmN0aW9uIChleGNsdWRlKSB7CiAgICAgICAgaWYgKG5ldyBSZWdFeHAoZXhjbHVkZSkudGVzdChob3N0KSkgewogICAgICAgICAgZXhjbHVkZWQgPSB0cnVlOwogICAgICAgICAgaWYgKEFhay5vcHRzLmxvZ0V4Y2x1ZGVkKSB7CiAgICAgICAgICAgIEFhay53YXJuKCdFeGNsdWRlZCcpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICAvLyBJbmNsdWRlIGRvbWFpbnMKICAgICAgLy8gSXNFdmVudHVwcG9ydGVkOiBodHRwOi8vdGlueXVybC5jb20vb2VlejhjNwogICAgICBpZiAoIWV4Y2x1ZGVkKSB7CgogICAgICAgIHZhciBoYW5kbGVyRXZlbnRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHJ1bGUgPSBBYWsucnVsZXNbbmFtZV07CgogICAgICAgICAgcnVsZS5ob3N0LmZvckVhY2goZnVuY3Rpb24gKGhvc3QpIHsKICAgICAgICAgICAgLy8gQ2hlY2sgaG9zdAogICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChob3N0KS50ZXN0KGxvY2F0aW9uLmhvc3QpKSB7CgogICAgICAgICAgICAgIC8vIE5hdGl2ZSBtb2RlCiAgICAgICAgICAgICAgaWYgKCFBYWsudXNlR00gJiYgQWFrLmlzVG9wZnJhbWUpIHsKICAgICAgICAgICAgICAgIEFhay53YXJuKCdSdW4gbmF0aXZlbHkuJyk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAvLyBMb2cgcnVsZSB1c2VkCiAgICAgICAgICAgICAgaWYgKHJ1bGUuaG9zdFswXSAhPSAnLio/JykgewogICAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdydWxlJywgcnVsZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIC8vIEJlZm9yZSBET00gbG9hZAogICAgICAgICAgICAgIGlmIChydWxlLm9uU3RhcnQpIHsKICAgICAgICAgICAgICAgIHJ1bGUub25TdGFydCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBPbiBhbGwgc3RhdGVtZW50cwogICAgICAgICAgICAgIGlmIChydWxlLm9uQWx3YXlzKSB7CiAgICAgICAgICAgICAgICBydWxlLm9uQWx3YXlzKCk7IC8vIHN0YXJ0CiAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdET01Db250ZW50TG9hZGVkJywgcnVsZS5vbkFsd2F5cyk7IC8vIGlkbGUKICAgICAgICAgICAgICAgIEFhay5vbkV2ZW50KHdpbmRvdywgJ2xvYWQnLCBydWxlLm9uQWx3YXlzKTsgLy8gZW5kCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIEJlZm9yZSBTY3JpcHQgRXhlY3V0ZWQKICAgICAgICAgICAgICBpZiAocnVsZS5vbkJlZm9yZVNjcmlwdCkgewoKICAgICAgICAgICAgICAgIC8vIG9wdGlvbnM6IGNvbnRhaW5zLCBzZWFyY2gsIHJlcGxhY2UsIG92ZXJyaWRlLCByZW1vdmUsIGV4dGVybmFsCiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uc0JlZm9yZVNjcmlwdCA9IHJ1bGUub25CZWZvcmVTY3JpcHQoKTsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc0JlZm9yZVNjcmlwdCA9PSAib2JqZWN0IikgewoKICAgICAgICAgICAgICAgICAgdmFyIGhhbmRsZXJCZWZvcmVTY3JpcHQgPSBmdW5jdGlvbiAoZSwgb3B0aW9ucykgewogICAgICAgICAgICAgICAgICAgIHZhciBpc0V2ZW50ID0gZSBpbnN0YW5jZW9mIHdpbmRvdy5FdmVudDsKICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1NjcmlwdCA9IChlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQpIHx8IGU7CgogICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobykgeyAvLyBoYXNBdHRyaWJ1dGUKICAgICAgICAgICAgICAgICAgICAgIHZhciBzcmMgPSBvLmV4dGVybmFsID8gJ3NyYycgOiAnaW5uZXJIVE1MJzsKICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2ggPSBuZXcgUmVnRXhwKG8uY29udGFpbnMsIG8uZmxhZ3MgfHwgJycpOwoKICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzU2NyaXB0W3NyY10gJiYgdGhpc1NjcmlwdFtzcmNdLmxlbmd0aCAmJiBzZWFyY2gudGVzdCh0aGlzU2NyaXB0W3NyY10pKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBTdG9wIHNjcmlwdCBleGVjdXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBzY3JpcHQKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXNTY3JpcHQucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1NjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwbGFjZSBhIHBhcnQgb2YgdGhlIHNjcmlwdAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5yZXBsYWNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3U2NyaXB0W3NyY10gPSB0aGlzU2NyaXB0W3NyY10ucmVwbGFjZShzZWFyY2gsIG8ucmVwbGFjZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnJlcGxhY2VDaGlsZChuZXdTY3JpcHQsIHRoaXNTY3JpcHQpOwogICAgICAgICAgICAgICAgICAgICAgICB9IC8vIE92ZXJyaWRlIHNjcmlwdAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChvLm92ZXJyaWRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3U2NyaXB0W3NyY10gPSBvLm92ZXJyaWRlOwogICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQobmV3U2NyaXB0LCB0aGlzU2NyaXB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSAvLyBSZW1vdmUgc2NyaXB0CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG8ucmVtb3ZlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXNTY3JpcHQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5kZXRlY3RlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIEFhay5kZXRlY3RlZChvLmRldGVjdGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQkJCQkJCQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFhay5vcHRzLmxvZ0ludGVyY2VwdGVkU2NyaXB0cykgewogICAgICAgICAgICAgICAgICAgICAgICAgIEFhay5sb2coc3JjLCBvLCB0aGlzU2NyaXB0LCBuZXdTY3JpcHQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAvLyBCcm93c2VyIHN1cHBvcnRpbmcgZXZlbnQgYmVmb3Jlc2NyaXB0ZXhlY3V0ZQogICAgICAgICAgICAgICAgICBpZiAoJ29uYmVmb3Jlc2NyaXB0ZXhlY3V0ZScgaW4gZG9jdW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdiZWZvcmVzY3JpcHRleGVjdXRlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXJCZWZvcmVTY3JpcHQoZSwgb3B0aW9uc0JlZm9yZVNjcmlwdCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8vIEJyb3dzZXIgbm90IHN1cHBvdGluZyBiZWZvcmVzY3JpcHRleGVjdXRlCgogICAgICAgICAgICAgICAgICAgIHZhciBsb2FkRG9jdW1lbnQgPSBmdW5jdGlvbiAob3B0aW9uc0JlZm9yZVNjcmlwdCkgewogICAgICAgICAgICAgICAgICAgICAgLy9pZiAoZG9jdW1lbnQucmVmZXJyZXIgPT09ICcnKQogICAgICAgICAgICAgICAgICAgICAgLy9yZXR1cm47CgogICAgICAgICAgICAgICAgICAgICAgQWFrLndhcm4oJ29uYmVmb3Jlc2NyaXB0LWNvbXBhdGlibGUnKTsKCiAgICAgICAgICAgICAgICAgICAgICAvLyBTdG9wIGxvYWRpbmcKICAgICAgICAgICAgICAgICAgICAgIEFhay5hZGRTY3JpcHQoJ3dpbmRvdy5zdG9wKCk7Jyk7IC8vIGNocm9tZS9vcGVyYQogICAgICAgICAgICAgICAgICAgICAgLy9BYWsuYWRkU2NyaXB0KCdkb2N1bWVudC5vcGVuKCk7Jyk7IC8vIGZpcmVmb3gKCiAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgY29udGVudAogICAgICAgICAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICAgICAgICAgICAgICB1cmwgOiBsb2NhdGlvbi5ocmVmLAogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzIDogewogICAgICAgICAgICAgICAgICAgICAgICAgICJSZWZlcmVyIiA6IGRvY3VtZW50LnJlZmVycmVyCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9IHJlc3VsdC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnNlciA9IG5ldyB3aW5kb3cuRE9NUGFyc2VyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaHRtbCwgInRleHQvaHRtbCIpOwogICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JpcHRzID0gZG9jLnNjcmlwdHM7CgogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2NyaXB0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNTY3JpcHQgPSBzY3JpcHRzW2ldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlckJlZm9yZVNjcmlwdCh0aGlzU2NyaXB0LCBvcHRpb25zQmVmb3JlU2NyaXB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbnZlcnQgdG8gc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGRvYy5kb2N1bWVudEVsZW1lbnQub3V0ZXJIVE1MOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXcml0ZSBuZXcgY29udGVudCB0byBIVE1MIGRvY3VtZW50OgogICAgICAgICAgICAgICAgICAgICAgICAgIEFhay5hZGRTY3JpcHQoJ2RvY3VtZW50Lm9wZW4oKTsgZG9jdW1lbnQud3JpdGUodW5lc2NhcGUoIicgKyB3aW5kb3cuZXNjYXBlKGh0bWwpICsgJyIpKTsgZG9jdW1lbnQuY2xvc2UoKTsnKTsgLy8gY2hyb21lL29wZXJhCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy9BYWsuYWRkU2NyaXB0KCdkb2N1bWVudC53cml0ZSh1bmVzY2FwZSgiJyArIGVzY2FwZShodG1sKSArICciKSk7IGRvY3VtZW50LmNsb3NlKCk7Jyk7IC8vIGZpcmVmb3gKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBsb2FkRG9jdW1lbnQob3B0aW9uc0JlZm9yZVNjcmlwdCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IC8vIEFmdGVyIFNjcmlwdCBFeGVjdXRlZAogICAgICAgICAgICAgIGlmIChydWxlLm9uQWZ0ZXJTY3JpcHQpIHsKICAgICAgICAgICAgICAgIGlmICgnb25hZnRlcnNjcmlwdGV4ZWN1dGUnIGluIGRvY3VtZW50KSB7IC8vIE1vemlsbGEgRmlyZWZveAogICAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdhZnRlcnNjcmlwdGV4ZWN1dGUnLCBydWxlLm9uQWZ0ZXJTY3JpcHQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBXaGVuIERPTSBMb2FkCiAgICAgICAgICAgICAgaWYgKHJ1bGUub25JZGxlKSB7CiAgICAgICAgICAgICAgICBpZiAoIUFhay51c2VHTSkgeyAvLyBOYXRpdmUgbW9kZQogICAgICAgICAgICAgICAgICBydWxlLm9uSWRsZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgLy9BYWsub25FdmVudCh3aW5kb3csICdET01Db250ZW50TG9hZGVkJywgcnVsZS5vbklkbGUpOwogICAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdET01Db250ZW50TG9hZGVkJywgcnVsZS5vbklkbGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBXaGVuIFdpbmRvdyBMb2FkCiAgICAgICAgICAgICAgaWYgKHJ1bGUub25FbmQpIHsKICAgICAgICAgICAgICAgIGlmICghQWFrLnVzZUdNKSB7IC8vIE5hdGl2ZSBtb2RlCiAgICAgICAgICAgICAgICAgIHJ1bGUub25FbmQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIEFhay5vbkV2ZW50KHdpbmRvdywgJ2xvYWQnLCBydWxlLm9uRW5kKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gV2hlbiBET00gQXR0ck1vZGlmaWVkCiAgICAgICAgICAgICAgaWYgKHJ1bGUub25BdHRyTW9kaWZpZWQpIHsKICAgICAgICAgICAgICAgIEFhay5vbkV2ZW50KHdpbmRvdywgJ0RPTUF0dHJNb2RpZmllZCcsIHJ1bGUub25BdHRyTW9kaWZpZWQsIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gV2hlbiBET00gU3VidHJlZU1vZGlmaWVkCiAgICAgICAgICAgICAgaWYgKHJ1bGUub25TdWJ0cmVlTW9kaWZpZWQpIHsKICAgICAgICAgICAgICAgIEFhay5vbkV2ZW50KHdpbmRvdywgJ0RPTVN1YnRyZWVNb2RpZmllZCcsIHJ1bGUub25TdWJ0cmVlTW9kaWZpZWQsIGZhbHNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gV2hlbiBET00gRWxlbWVudHMgYXJlIEluc2VydGVkIGluIERvY3VtZW50CiAgICAgICAgICAgICAgaWYgKHJ1bGUub25JbnNlcnQpIHsKCiAgICAgICAgICAgICAgICAvLyBNdXRhdGlvbiBPYnNlcnZlcgogICAgICAgICAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vbXh4emVlNAogICAgICAgICAgICAgICAgLy8gc3VwcG9ydDogaHR0cDovL3Rpbnl1cmwuY29tL25lcG43dnkKICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgIT0gJ3VuZGVmaW5lZCcgfHwKICAgICAgICAgICAgICAgICAgdHlwZW9mIFdlYktpdE11dGF0aW9uT2JzZXJ2ZXIgIT0gJ3VuZGVmaW5lZCcpIHsKCiAgICAgICAgICAgICAgICAgIC8vIE11dGF0aW9uIE9ic2VydmVyCiAgICAgICAgICAgICAgICAgIHZhciBNdXRhdGlvbk9ic2VydmVyMSA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyOwoKICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGFuIG9ic2VydmVyIGluc3RhbmNlCiAgICAgICAgICAgICAgICAgIHZhciBvYnMxID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIxKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGNhbiBzYWZlbHkgdXNlIGBmb3JFYWNoYCBiZWNhdXNlIHdlIGFscmVhZHkgdXNlIG11dGF0aW9uCiAgICAgICAgICAgICAgICAgICAgICAvLyBvYnNlcnZlcnMgdGhhdCBhcmUgbW9yZSByZWNlbnQgdGhhbiBgZm9yRWFjaGAuIChzb3VyY2U6IE1ETikKICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtdXRhdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSB3YW50IG9ubHkgYWRkZWQgbm9kZXMKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChtdXRhdGlvbi5hZGRlZE5vZGVzLCBmdW5jdGlvbiAoYWRkZWROb2RlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQWFrLm9wdHMubG9nSW5zZXJ0ZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBYWsubG9nKGFkZGVkTm9kZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLm9uSW5zZXJ0KGFkZGVkTm9kZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAvLyBPYnNlcnZlcgogICAgICAgICAgICAgICAgICBvYnMxLm9ic2VydmUoZG9jdW1lbnQsIHsKICAgICAgICAgICAgICAgICAgICBjaGlsZExpc3QgOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIHN1YnRyZWUgOiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gTXV0YXRpb24gRXZlbnRzIChBbHRlcm5hdGl2ZSBTb2x1dGlvbikKICAgICAgICAgICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tL29wOTVyZnkKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICJET01Ob2RlSW5zZXJ0ZWQiLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChBYWsub3B0cy5sb2dJbnNlcnRlZE5vZGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICBBYWsubG9nKGUudGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcnVsZS5vbkluc2VydChlLnRhcmdldCk7CiAgICAgICAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gV2hlbiBET00gRWxlbWVudHMgYXJlIFJlbW92ZWQgaW4gRG9jdW1lbnQKICAgICAgICAgICAgICBpZiAocnVsZS5vblJlbW92ZSkgewoKICAgICAgICAgICAgICAgIC8vIE11dGF0aW9uIE9ic2VydmVyCiAgICAgICAgICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS9teHh6ZWU0CiAgICAgICAgICAgICAgICAvLyBzdXBwb3J0OiBodHRwOi8vdGlueXVybC5jb20vbmVwbjd2eQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciAhPSAndW5kZWZpbmVkJyB8fAogICAgICAgICAgICAgICAgICB0eXBlb2YgV2ViS2l0TXV0YXRpb25PYnNlcnZlciAhPSAndW5kZWZpbmVkJykgewoKICAgICAgICAgICAgICAgICAgLy8gTXV0YXRpb24gT2JzZXJ2ZXIKICAgICAgICAgICAgICAgICAgdmFyIE11dGF0aW9uT2JzZXJ2ZXIyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7CgogICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYW4gb2JzZXJ2ZXIgaW5zdGFuY2UKICAgICAgICAgICAgICAgICAgdmFyIG9iczIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcjIoZnVuY3Rpb24gKG11dGF0aW9ucykgewogICAgICAgICAgICAgICAgICAgICAgLy8gV2UgY2FuIHNhZmVseSB1c2UgYGZvckVhY2hgIGJlY2F1c2Ugd2UgYWxyZWFkeSB1c2UgbXV0YXRpb24KICAgICAgICAgICAgICAgICAgICAgIC8vIG9ic2VydmVycyB0aGF0IGFyZSBtb3JlIHJlY2VudCB0aGFuIGBmb3JFYWNoYC4gKHNvdXJjZTogTUROKQogICAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG11dGF0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlIHdhbnQgb25seSByZW1vdmVkIG5vZGVzCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbi5yZW1vdmVkTm9kZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChtdXRhdGlvbi5yZW1vdmVkTm9kZXMsIGZ1bmN0aW9uIChyZW1vdmVkTm9kZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFhay5vcHRzLmxvZ1JlbW92ZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBYWsubG9nKHJlbW92ZWROb2RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGUub25SZW1vdmUocmVtb3ZlZE5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgLy8gT2JzZXJ2ZXIKICAgICAgICAgICAgICAgICAgb2JzMi5vYnNlcnZlKGRvY3VtZW50LCB7CiAgICAgICAgICAgICAgICAgICAgY2hpbGRMaXN0IDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzdWJ0cmVlIDogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIE11dGF0aW9uIEV2ZW50cyAoQWx0ZXJuYXRpdmUgU29sdXRpb24pCiAgICAgICAgICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS9vcDk1cmZ5CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAiRE9NTm9kZVJlbW92ZWQiLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChBYWsub3B0cy5sb2dSZW1vdmVkTm9kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgIEFhay5sb2coZS50YXJnZXQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBydWxlLm9uUmVtb3ZlKGUudGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgfSwgZmFsc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAvLyBBYWsgRXZlbnRzCiAgICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAnZGV0ZWN0ZWQnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgQWFrLmluZm8oWydBbnRpQWRiS2lsbGVyJywgQWFrLmlzVG9wZnJhbWUgPyAndG9wZnJhbWUnIDogJ3N1YmZyYW1lJywgbG9jYXRpb24uaG9zdCwgZS5kZXRhaWxdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgLy8gQXBwbHkgcnVsZXMKICAgICAgICBmb3IgKHZhciBuYW1lIGluIEFhay5ydWxlcykgewogICAgICAgICAgaWYgKEFhay5ydWxlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICAgICAgICBoYW5kbGVyRXZlbnRzKEFhaywgbmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfTsKCiAgQWFrLmluaXRpYWxpemUoKTsKCn0pKHdpbmRvdyk7"},{"name":"YouTube +","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":["*://www.youtube.com/tv*","*://www.youtube.com/embed/*","*://www.youtube.com/live_chat*"],"orig_includes":[],"orig_matches":["*://www.youtube.com/*"],"orig_noframes":true,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{"particleSettings":"s{\"GEN_BTTR_NTF\":true,\"GEN_SUB_LIST\":true,\"GEN_INF_SCRL\":true,\"GEN_BLUE_GLOW\":true,\"GEN_PPOT_ON\":true,\"VID_END_SHRE\":true,\"VID_DFLT_QLTY\":\"hd1080\",\"VID_PLST_ATPL\":true,\"VID_PLST_RVRS\":true,\"VID_PLR_ATPL\":true,\"VID_PLR_ALVIS\":true,\"VID_PLR_SIZE_MEM\":true,\"VID_PLR_VOL_LDN\":true,\"VID_POST_TIME\":true,\"VID_VID_CNT\":true,\"VID_DESC_SHRT\":true,\"VID_PPOT_SZ\":false,\"VID_PLR_HTML5\":true,\"BLK_ON\":true,\"floaterX\":2000,\"floaterY\":2000,\"firstTime\":false,\"volLev\":50,\"advOpts\":true,\"blacklist\":{},\"extLang\":{\"zh_CN\":{\"YTSETS\":\"YouTube+ \",\"ADV_OPTS\":\"\",\"SUB_PLST\":\"\",\"PPOT_OPEN\":\"\",\"BLCK_ADD\":\"\",\"BLCK_EDIT\":\"\",\"BLCK_SAVE\":\"\",\"BLCK_CLSE\":\"\",\"CNSL_AP\":\"\",\"CNSL_RPT\":\"\",\"CNSL_SVTH\":\"\",\"CNSL_SS\":\"\",\"CNSL_SS_CLS\":\"\",\"CNSL_PPOT\":\"\",\"CNSL_FLBR\":\"\",\"CNSL_CINM_MD\":\"\",\"CNSL_YTSC\":\"YouTube \",\"PLST_AP\":\"\",\"PLST_RVRS\":\"\",\"SHOW_CMTS\":\"\",\"HIDE_CMTS\":\"\",\"GLB_IMPR\":\"/\",\"GLB_LOCL_LANG\":\" YT+ \",\"GLB_LOCL_LANG_CSTM\":\"\",\"GLB_IMPR_SAVE\":\"\",\"GLB_RSET\":\"\",\"GLB_RSET_CONF\":\"YT+\",\"GLB_SVE\":\"\",\"GLB_SVE_SETS\":\"\",\"GLB_RMBL\":\"\",\"FTR_DESC\":\"\",\"GEN\":\"\",\"VID\":\"\",\"CHN\":\"\",\"BLK\":\"\",\"ABT\":\"\",\"HLP\":\"\",\"DNT\":\"\",\"GEN_TTL\":\"\",\"GEN_GEN\":\"\",\"GEN_LYT\":\"\",\"GEN_LOCL_LANG\":\" YT+ \",\"GEN_PPOT_ON\":\"\",\"GEN_DSBL_ADS\":\"\",\"GEN_INF_SCRL\":\"\",\"GEN_YT_LOGO_LINK\":\"YouTube \",\"GEN_SUB_LIST\":\"\",\"GEN_REM_APUN\":\"\",\"GEN_SPF_OFF\":\"\",\"GEN_HIDE_FTR\":\"\",\"GEN_BLUE_GLOW\":\"\",\"GEN_HDE_RECM_SDBR\":\"\",\"GEN_HDE_SRCH_SDBR\":\"\",\"GEN_HDE_CHN_SDBR\":\"\",\"GEN_CMPT_TTLS\":\"\",\"GEN_DSB_HVRC\":\"\",\"GEN_BTTR_NTF\":\"\",\"GEN_GRID_SUBS\":\"\",\"GEN_GRID_SRCH\":\"\",\"VID_TTL\":\"\",\"VID_PLR\":\"\",\"VID_PLR_LYT\":\"\",\"VID_DFLT_QLTY\":\"\",\"VID_DFLT_QLTY_AUTO\":\"\",\"VID_DFLT_QLTY_TNY\":\"144p\",\"VID_DFLT_QLTY_SML\":\"240p\",\"VID_DFLT_QLTY_MDM\":\"360p\",\"VID_DFLT_QLTY_LRG\":\"480p\",\"VID_DFLT_QLTY_720\":\"720p\",\"VID_DFLT_QLTY_1080\":\"1080p\",\"VID_DFLT_QLTY_1440\":\"1440p\",\"VID_DFLT_QLTY_2160\":\"2160p (4k)\",\"VID_DFLT_QLTY_2880\":\"2880p (5k)\",\"VID_DFLT_QLTY_ORIG\":\"4320p (8k)\",\"VID_PLR_ALVIS\":\"\",\"VID_PLR_ALVIS_WDTH\":\"\",\"VID_PLR_ALVIS_RST\":\"\",\"VID_PLR_ALVIS_SCRL_TOP\":\"\",\"VID_PLR_ATPL\":\"\",\"VID_LAYT\":\"\",\"VID_VID_CNT\":\"\",\"VID_POST_TIME\":\"\",\"VID_HIDE_DETLS\":\"\",\"VID_HIDE_COMS\":\"\",\"VID_HIDE_COMS_SHOW\":\"\",\"VID_HIDE_COMS_HIDE\":\"\",\"VID_HIDE_COMS_REM\":\"\",\"VID_END_SHRE\":\"\",\"VID_PLST\":\"\",\"VID_PLST_ATPL\":\"\",\"VID_PLST_RVRS\":\"\",\"VID_PLR_SIZE_MEM\":\"\",\"VID_VOL_WHEEL\":\"\",\"VID_PLR_VOL_MEM\":\"\",\"VID_PLR_VOL_LDN\":\" YouTube \",\"VID_PLR_ADS\":\"\",\"VID_PLR_ALACT\":\"\",\"VID_SUB_ADS\":\"\",\"VID_PLR_ANTS\":\"\",\"VID_PLR_HFR\":\" (60fps)\",\"VID_PLR_HTML5\":\" HTML 5 \",\"VID_PLR_CC\":\"\",\"VID_PLR_INFO\":\"\",\"VID_PLR_FIT\":\"\",\"VID_PLR_FIT_WDTH\":\":\",\"VID_PLR_DYN_SIZE\":\"\",\"VID_DESC_SHRT\":\"\",\"VID_TTL_CMPT\":\"\",\"VID_PPOT_SZ\":\"\",\"VID_LAYT_AUTO_PNL\":\"\",\"GEN_CHN_DFLT_PAGE\":\"\",\"GEN_CHN_DFLT_PAGE_DFLT\":\"\",\"GEN_CHN_DFLT_PAGE_VID\":\"\",\"GEN_CHN_DFLT_PAGE_PL\":\"\",\"GEN_CHN_DFLT_PAGE_CHN\":\"\",\"GEN_CHN_DFLT_PAGE_DISC\":\"\",\"GEN_CHN_DFLT_PAGE_ABT\":\"\",\"BLK_TTL\":\"\",\"BLK_BLK\":\"\",\"BLK_ON\":\"\",\"ABT_TTL\":\"\",\"ABT_THKS\":\"\",\"ABT_THKS_YEPPHA\":\"\",\"ABT_THKS_USERSCRIPT\":\" \",\"ABT_THKS_STACKOV\":\" \",\"ABT_INFO\":\"\",\"ABT_LNK_GHB\":\"GitHub\",\"ABT_LNK_GRFK\":\"Greasy Fork\",\"ABT_LNK_OPNU\":\"OpenUserJS\",\"WLCM\":\" YouTube+\",\"WLCMSTRT\":\"\",\"WLCMFTRS\":\"\",\"LOCALE\":\" ()\",\"lastMod\":1478206054000},\"nextCheck\":1480903070769},\"GEN_HDE_CHN_SDBR\":false,\"GEN_HDE_SRCH_SDBR\":false,\"GEN_HDE_RECM_SDBR\":false,\"GEN_HIDE_FTR\":false,\"GEN_CMPT_TTLS\":false,\"GEN_DSB_HVRC\":false,\"GEN_GRID_SRCH\":false,\"GEN_GRID_SUBS\":false,\"GEN_CHN_DFLT_PAGE\":\"default\",\"GEN_SPF_OFF\":false,\"GEN_REM_APUN\":false,\"GEN_YT_LOGO_LINK\":false,\"GEN_DSBL_ADS\":false,\"GEN_LOCL_LANG\":false,\"VID_LAYT_AUTO_PNL\":false,\"VID_HIDE_DETLS\":false,\"VID_TTL_CMPT\":false,\"VID_HIDE_COMS\":\"0\",\"VID_PLR_FIT_WDTH\":false,\"VID_PLR_FIT\":false,\"VID_PLR_DYN_SIZE\":false,\"VID_PLR_INFO\":false,\"VID_PLR_HFR\":false,\"VID_VOL_WHEEL\":true,\"VID_PLR_ALACT\":false,\"VID_PLR_VOL_MEM\":false,\"VID_PLR_ANTS\":false,\"VID_PLR_CC\":false,\"VID_PLR_ALVIS_WDTH\":false,\"VID_SUB_ADS\":false,\"VID_PLR_ADS\":true,\"lightsOut\":false,\"theaterMode\":false,\"fullBrs\":false}"},"ts":1487594258376},"enabled":false,"position":7,"file_url":"https://greasyfork.org/scripts/9932-youtube/code/YouTube%20+.user.js","uuid":"f036c817-e556-4bb9-9941-5081c51a16da","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQHZlcnNpb24gICAgICAgICAxLjcuMAovLyBAbmFtZSAgICAgICAgICAgIFlvdVR1YmUgKwovLyBAbmFtZXNwYWNlICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUKLy8gQGRlc2NyaXB0aW9uICAgICBZb3VUdWJlIHdpdGggbW9yZSBmcmVlZG9tCi8vIEBpY29uICAgICAgICAgICAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS9naC1wYWdlcy9pbWFnZXMvWVQlMkJpY29uLnBuZwovLyBAbWF0Y2ggICAgICAgICAgICo6Ly93d3cueW91dHViZS5jb20vKgovLyBAZXhjbHVkZSAgICAgICAgICo6Ly93d3cueW91dHViZS5jb20vdHYqCi8vIEBleGNsdWRlICAgICAgICAgKjovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8qCi8vIEBleGNsdWRlICAgICAgICAgKjovL3d3dy55b3V0dWJlLmNvbS9saXZlX2NoYXQqCi8vIEBydW4tYXQgICAgICAgICAgZG9jdW1lbnQtc3RhcnQKLy8gQGhvbWVwYWdlVVJMICAgICBodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlCi8vIEBzdXBwb3J0VVJMICAgICAgaHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpCi8vIEBjb250cmlidXRpb25VUkwgaHR0cHM6Ly93d3cucGF5cGFsLmNvbS9jZ2ktYmluL3dlYnNjcj9jbWQ9X3MteGNsaWNrJmhvc3RlZF9idXR0b25faWQ9VU1WUUpKRkc0QkZIVwovLyBAZ3JhbnQgICAgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgICAgR01fc2V0VmFsdWUKLy8gQG5vZnJhbWVzCi8vID09L1VzZXJTY3JpcHQ9PQooZnVuY3Rpb24gKCkgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIHBhcnRpY2xlID0gewogICAgICAgIGluamVjdDogZnVuY3Rpb24oaXNfdXNlcnNjcmlwdCkgewogICAgICAgICAgICBmdW5jdGlvbiBzZXRMb2NhbGUoY29udGVudCkgewogICAgICAgICAgICAgICAgdmFyIGksIGosIGxpc3QsIHRlbXAsIHl0cGxhYmVsOwogICAgICAgICAgICAgICAgeXRwbGFiZWwgPSBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIltkYXRhLXBdIik7CiAgICAgICAgICAgICAgICBpID0geXRwbGFiZWwubGVuZ3RoOwogICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgIGxpc3QgPSB5dHBsYWJlbFtpXS5kYXRhc2V0LnAuc3BsaXQoIiYiKTsKICAgICAgICAgICAgICAgICAgICBqID0gbGlzdC5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGotLSkgewogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gbGlzdFtqXS5zcGxpdCgifCIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVtcFswXSA9PT0gInRuZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHl0cGxhYmVsW2ldLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGxhbmcodGVtcFsxXSkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZW1wWzBdID09PSAidHRsIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgeXRwbGFiZWxbaV0uc2V0QXR0cmlidXRlKCJ0aXRsZSIsIGxhbmcodGVtcFsxXSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgeXRwbGFiZWxbaV0uZGF0YXNldC50b29sdGlwVGV4dCA9IGxhbmcodGVtcFsxXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gY29udGVudDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRMb2NhbGUoZGF0YSkgewogICAgICAgICAgICAgICAgbGFuZy5mZXRjaGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgZGF0YSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kYXRhc2V0LnNldGxvY2FsZTsKICAgICAgICAgICAgICAgIGRhdGEgPSBkYXRhICYmIEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHVzZXJfc2V0dGluZ3MuZXh0TGFuZ1tsYW5nLnl0bGFuZ10gPSBKU09OLnBhcnNlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kYXRhc2V0LnNldGxvY2FsZSk7CiAgICAgICAgICAgICAgICAgICAgdXNlcl9zZXR0aW5ncy5leHRMYW5nW2xhbmcueXRsYW5nXS5sYXN0TW9kID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgICAgICAgICAgICAgICAgdXNlcl9zZXR0aW5ncy5leHRMYW5nLm5leHRDaGVjayA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgNjA0OEU1OwogICAgICAgICAgICAgICAgICAgIHNldCgiZXh0TGFuZyIsIHVzZXJfc2V0dGluZ3MuZXh0TGFuZyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsYW5nLm9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRMYW5ndWFnZShkYXRhKSB7CiAgICAgICAgICAgICAgICBsYW5nLmZldGNoaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAoZGF0YS50YXJnZXQucmVhZHlTdGF0ZSA9PT0gNCAmJiBkYXRhLnRhcmdldC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIHVzZXJfc2V0dGluZ3MuZXh0TGFuZ1tsYW5nLnl0bGFuZ10gPSBKU09OLnBhcnNlKGRhdGEudGFyZ2V0LnJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICB1c2VyX3NldHRpbmdzLmV4dExhbmdbbGFuZy55dGxhbmddLmxhc3RNb2QgPSBuZXcgRGF0ZShkYXRhLnRhcmdldC5nZXRSZXNwb25zZUhlYWRlcigiTGFzdC1Nb2RpZmllZCIpKS5nZXRUaW1lKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB1c2VyX3NldHRpbmdzLmV4dExhbmcubmV4dENoZWNrID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgKyA2MDQ4RTU7CiAgICAgICAgICAgICAgICBzZXQoImV4dExhbmciLCB1c2VyX3NldHRpbmdzLmV4dExhbmcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrTW9kaWZpZWQoZGF0YSkgewogICAgICAgICAgICAgICAgbGFuZy5mZXRjaGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgaWYgKGRhdGEudGFyZ2V0LnJlYWR5U3RhdGUgPT09IDQgJiYgZGF0YS50YXJnZXQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICBsYW5nLmZldGNoaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBsb2NhbFhIUigiR0VUIiwgZ2V0TGFuZ3VhZ2UsIGxhbmcudXJsQmFzZSArIGxhbmcueXRsYW5nICsgIi5qc29uIiwgWyJBY2NlcHQiLCAiYXBwbGljYXRpb24vdm5kLmdpdGh1Yi5yYXciXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbGFuZyhsYWJlbCkgewogICAgICAgICAgICAgICAgbGFuZy55dGxhbmcgPSB3aW5kb3cueXQgJiYgd2luZG93Lnl0LmNvbmZpZ18gJiYgd2luZG93Lnl0LmNvbmZpZ18uR0FQSV9MT0NBTEU7CiAgICAgICAgICAgICAgICBsYW5nLnVybEJhc2UgPSAiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9QYXJ0aWNsZUNvcmUvUGFydGljbGUvY29udGVudHMvTG9jYWxlLyI7CiAgICAgICAgICAgICAgICBpZiAoIXVzZXJfc2V0dGluZ3MuZXh0TGFuZykgewogICAgICAgICAgICAgICAgICAgIHNldCgiZXh0TGFuZyIsIHt9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLkdFTl9MT0NMX0xBTkcgJiYgdXNlcl9zZXR0aW5ncy5sb2NhbExhbmcgJiYgdXNlcl9zZXR0aW5ncy5sb2NhbExhbmdbbGFiZWxdKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KHVzZXJfc2V0dGluZ3MuZXh0TGFuZykgIT09ICJ7fSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0KCJleHRMYW5nIiwge30pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlcl9zZXR0aW5ncy5sb2NhbExhbmdbbGFiZWxdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCF1c2VyX3NldHRpbmdzLkdFTl9MT0NMX0xBTkcgJiYgbGFuZy55dGxhbmcgJiYgbGFuZy55dGxhbmcgIT09ICJlbl9VUyIpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5leHRMYW5nW2xhbmcueXRsYW5nXSAmJiB1c2VyX3NldHRpbmdzLmV4dExhbmdbbGFuZy55dGxhbmddW2xhYmVsXSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxhbmcuZmV0Y2hpbmcgJiYgdXNlcl9zZXR0aW5ncy5leHRMYW5nLm5leHRDaGVjayAmJiB1c2VyX3NldHRpbmdzLmV4dExhbmcubmV4dENoZWNrIDw9IG5ldyBEYXRlKCkuZ2V0VGltZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYW5nLmZldGNoaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNfdXNlcnNjcmlwdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmcub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihnZXRMb2NhbGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmcub2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbImRhdGEtc2V0bG9jYWxlIl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZGF0YXNldC5nZXRsb2NhbGUgPSBsYW5nLnl0bGFuZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxYSFIoIkhFQUQiLCBjaGVja01vZGlmaWVkLCBsYW5nLnVybEJhc2UgKyBsYW5nLnl0bGFuZyArICIuanNvbiIsIFsiSWYtTW9kaWZpZWQtU2luY2UiLCBuZXcgRGF0ZSh1c2VyX3NldHRpbmdzLmV4dExhbmdbbGFuZy55dGxhbmddLmxhc3RNb2QpLnRvVVRDU3RyaW5nKCldKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfc2V0dGluZ3MuZXh0TGFuZy5uZXh0Q2hlY2sgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIDYwNDhFNTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldCgiZXh0TGFuZyIsIHVzZXJfc2V0dGluZ3MuZXh0TGFuZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJfc2V0dGluZ3MuZXh0TGFuZ1tsYW5nLnl0bGFuZ11bbGFiZWxdOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZXJfc2V0dGluZ3MuZXh0TGFuZ1tsYW5nLnl0bGFuZ10gJiYgIWxhbmcuZmV0Y2hpbmcgJiYgKCF1c2VyX3NldHRpbmdzLmV4dExhbmcubmV4dENoZWNrIHx8IHVzZXJfc2V0dGluZ3MuZXh0TGFuZy5uZXh0Q2hlY2sgPD0gbmV3IERhdGUoKS5nZXRUaW1lKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxhbmcuZmV0Y2hpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzX3VzZXJzY3JpcHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmcub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihnZXRMb2NhbGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFuZy5vYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbImRhdGEtc2V0bG9jYWxlIl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQuZ2V0bG9jYWxlID0gbGFuZy55dGxhbmc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFhIUigiR0VUIiwgZ2V0TGFuZ3VhZ2UsIGxhbmcudXJsQmFzZSArIGxhbmcueXRsYW5nICsgIi5qc29uIiwgWyJBY2NlcHQiLCAiYXBwbGljYXRpb24vdm5kLmdpdGh1Yi5yYXciXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbGFuZ3VhZ2VbbGFiZWxdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHNvcnRMaXN0KHByZXZpb3VzLCBuZXh0KXsKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0W09iamVjdC5rZXlzKG5leHQpWzBdXS5sb2NhbGVDb21wYXJlKHByZXZpb3VzW09iamVjdC5rZXlzKHByZXZpb3VzKVswXV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEJsYWNrbGlzdChibGlzdCkgewogICAgICAgICAgICAgICAgdmFyIGksIG9iaiwgdGVtcCwgbG5rLCBrZXlzLCBsaXN0LCBmcmFnbWVudCwgc29ydEFscGhhOwogICAgICAgICAgICAgICAgc29ydEFscGhhID0gW107CiAgICAgICAgICAgICAgICBsaXN0ID0gdXNlcl9zZXR0aW5ncy5ibGFja2xpc3Q7CiAgICAgICAgICAgICAgICBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsKICAgICAgICAgICAgICAgIHNvcnRBbHBoYSA9IFtdOwogICAgICAgICAgICAgICAgdGVtcCA9IE9iamVjdC5rZXlzKGxpc3QpOwogICAgICAgICAgICAgICAgaSA9IHRlbXAubGVuZ3RoOwogICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgIG9iaiA9IHt9OwogICAgICAgICAgICAgICAgICAgIG9ialt0ZW1wW2ldXSA9IGxpc3RbdGVtcFtpXV07CiAgICAgICAgICAgICAgICAgICAgc29ydEFscGhhLnB1c2gob2JqKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRlbXAgPSBzb3J0QWxwaGEuc29ydChzb3J0TGlzdCk7CiAgICAgICAgICAgICAgICBpID0gdGVtcC5sZW5ndGg7CiAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAga2V5cyA9IE9iamVjdC5rZXlzKHRlbXBbaV0pOwogICAgICAgICAgICAgICAgICAgIG9iaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICAgICAgb2JqLmlubmVySFRNTCA9IC8vCiAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSdibGFja2xpc3QnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0nY2xvc2UnIGRhdGEtcD0ndHRsfEdMQl9STUJMJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHZpZXdCb3g9JzAgMCAxMCAxMCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwb2x5Z29uIHBvaW50cz0nMTAsMS40IDguNiwwIDUsMy42IDEuNCwwIDAsMS40IDMuNiw1IDAsOC42IDEuNCwxMCA1LDYuNCA4LjYsMTAgMTAsOC42IDYuNCw1Jy8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj48YSB0YXJnZXQ9J19ibGFuayc+PC9hPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIG9iaiA9IHNldExvY2FsZShvYmouY29udGVudC5maXJzdENoaWxkKTsKICAgICAgICAgICAgICAgICAgICBsbmsgPSBvYmoucXVlcnlTZWxlY3RvcigiYSIpOwogICAgICAgICAgICAgICAgICAgIGxuay5ocmVmID0gIi9jaGFubmVsLyIgKyBrZXlzWzBdOwogICAgICAgICAgICAgICAgICAgIGxuay5zZXRBdHRyaWJ1dGUoInRpdGxlIiwgdGVtcFtpXVtrZXlzWzBdXSk7CiAgICAgICAgICAgICAgICAgICAgbG5rLnRleHRDb250ZW50ID0gdGVtcFtpXVtrZXlzWzBdXTsKICAgICAgICAgICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChvYmopOwogICAgICAgICAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCJcbiIpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJsaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRWYWx1ZXMobWVudSkgewogICAgICAgICAgICAgICAgdmFyIGksIHl0cCwgbGlzdDsKICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzKSB7CiAgICAgICAgICAgICAgICAgICAgbGlzdCA9IG1lbnUucXVlcnlTZWxlY3RvcigiI2JsYWNrbGlzdCIpOwogICAgICAgICAgICAgICAgICAgIGlmIChsaXN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldEJsYWNrbGlzdChsaXN0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeXRwID0gbWVudS5xdWVyeVNlbGVjdG9yQWxsKCJpbnB1dFtpZF0iKTsKICAgICAgICAgICAgICAgICAgICBpID0geXRwLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh5dHBbaV0udHlwZSA9PT0gImNoZWNrYm94IiAmJiB1c2VyX3NldHRpbmdzW3l0cFtpXS5pZF0gPT09IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHl0cFtpXS5zZXRBdHRyaWJ1dGUoImNoZWNrZWQiLCAidHJ1ZSIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh5dHBbaV0udHlwZSA9PT0gInRleHQiICYmIHR5cGVvZiB1c2VyX3NldHRpbmdzW3l0cFtpXS5pZF0gPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5dHBbaV0uc2V0QXR0cmlidXRlKCJ2YWx1ZSIsIHVzZXJfc2V0dGluZ3NbeXRwW2ldLmlkXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeXRwID0gbWVudS5xdWVyeVNlbGVjdG9yQWxsKCJvcHRpb24iKTsKICAgICAgICAgICAgICAgICAgICBpID0geXRwLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzW3l0cFtpXS5wYXJlbnROb2RlLmlkXSA9PT0geXRwW2ldLnZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5dHBbaV0uc2V0QXR0cmlidXRlKCJzZWxlY3RlZCIsICJ0cnVlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbWVudTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRNZW51KHNlY3Rpb24pIHsKICAgICAgICAgICAgICAgIHZhciBpLCB0ZW1wLCBzdmcsIGlucHV0czsKICAgICAgICAgICAgICAgIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIpOwogICAgICAgICAgICAgICAgaWYgKHNlY3Rpb24gPT09ICJNRU4iKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSAvLwogICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBpZD0nUC1zZXR0aW5ncyc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSdQLWNvbnRhaW5lcic+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nUC1zaWRlYmFyJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHVsIGlkPSdQLXNpZGViYXItbGlzdCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgaWQ9J0dFTicgY2xhc3M9J3NlbGVjdGVkJyBkYXRhLXA9J3RuZHxHRU4nPjwvbGk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgaWQ9J1ZJRCcgZGF0YS1wPSd0bmR8VklEJz48L2xpPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpIGlkPSdCTEsnIGRhdGEtcD0ndG5kfEJMSyc+PC9saT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBpZD0nQUJUJyBkYXRhLXA9J3RuZHxBQlQnPjwvbGk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGkgaWQ9J0hMUCc+PGEgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraScgZGF0YS1wPSd0bmR8SExQJz48L2E+PC9saT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBpZD0nRE5UJz48YSB0aXRsZT0nUGF5UGFsJyB0YXJnZXQ9J19ibGFuaycgaHJlZj0naHR0cHM6Ly93d3cucGF5cGFsLmNvbS9jZ2ktYmluL3dlYnNjcj9jbWQ9X3MteGNsaWNrJmhvc3RlZF9idXR0b25faWQ9VU1WUUpKRkc0QkZIVycgZGF0YS1wPSd0bmR8RE5UJz48L2E+PHN2ZyB2aWV3Qm94PScwIDAgMTUuMyAxOCc+PHBhdGggc3R5bGU9J2ZpbGw6IzI3MzQ2QTsnIGQ9J00xMywxLjRDMTIuMiwwLjQsMTAuNiwwLDguNywwSDMuMUMyLjcsMCwyLjQsMC4zLDIuMywwLjdMMCwxNS40QzAsMTUuNywwLjIsMTYsMC41LDE2aDMuNSBsMC45LTUuNWwwLDAuMkM0LjgsMTAuMyw1LjIsMTAsNS42LDEwaDEuNmMzLjIsMCw1LjctMS4zLDYuNS01LjFjMC0wLjEsMC0wLjIsMC4xLTAuM2MtMC4xLDAtMC4xLDAsMCwwQzE0LDMuMiwxMy43LDIuMiwxMywxLjQnLz48cGF0aCBzdHlsZT0nZmlsbDojMjczNDZBOycgZD0nTTYuMSw0LjFDNi4yLDQsNi4zLDQsNi40LDRoNC40YzAuNSwwLDEsMCwxLjQsMC4xYzAuMSwwLDAuMiwwLDAuNCwwLjFjMC4xLDAsMC4yLDAuMSwwLjMsMC4xIGMwLjEsMCwwLjEsMCwwLjIsMC4xYzAuMiwwLjEsMC40LDAuMiwwLjYsMC4zYzAuMi0xLjQsMC0yLjQtMC44LTMuMkMxMi4yLDAuNCwxMC42LDAsOC43LDBIMy4xQzIuNywwLDIuNCwwLjMsMi4zLDAuN0wwLDE1LjQgQzAsMTUuNywwLjIsMTYsMC41LDE2aDMuNUw1LjcsNC42QzUuOCw0LjQsNS45LDQuMiw2LjEsNC4xeicvPjxwYXRoIHN0eWxlPSdmaWxsOiMyNzkwQzM7JyBkPSdNMTMuNyw0LjlDMTMsOC43LDEwLjQsMTAsNy4yLDEwSDUuNmMtMC40LDAtMC43LDAuMy0wLjgsMC43bC0xLjEsNi44YzAsMC4zLDAuMiwwLjUsMC40LDAuNUg3IGMwLjMsMCwwLjYtMC4zLDAuNy0wLjZsMC0wLjFsMC41LTMuNWwwLTAuMkM4LjQsMTMuMyw4LjcsMTMsOSwxM2gwLjRjMi44LDAsNS0xLjEsNS43LTQuNWMwLjMtMS40LDAuMS0yLjUtMC42LTMuNCBjLTAuMi0wLjItMC41LTAuNC0wLjgtMC42QzEzLjcsNC43LDEzLjcsNC44LDEzLjcsNC45TDEzLjcsNC45eicvPjxwYXRoIHN0eWxlPSdmaWxsOiMxRjI2NEY7JyBkPSdNMTMsNC4zYy0wLjEsMC0wLjItMC4xLTAuMy0wLjFjLTAuMSwwLTAuMiwwLTAuNC0wLjFDMTEuOCw0LDExLjMsNCwxMC44LDRINi40IEM2LjMsNCw2LjIsNCw2LjEsNC4xQzUuOSw0LjIsNS44LDQuNCw1LjcsNC42bC0wLjksNS45bDAsMC4yQzQuOCwxMC4zLDUuMiwxMCw1LjYsMTBoMS42YzMuMiwwLDUuNy0xLjMsNi41LTUuMSBjMC0wLjEsMC0wLjIsMC4xLTAuM2MtMC4yLTAuMS0wLjQtMC4yLTAuNi0wLjNDMTMuMSw0LjMsMTMsNC4zLDEzLDQuMycvPjwvc3ZnPjwvbGk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgc3R5bGU9J2Rpc3BsYXk6bm9uZTsnPjxzeW1ib2wgaWQ9J3l0cC1zdmctY2hlY2ttYXJrJyB2aWV3Qm94PScwIDAgMTIuNyA5LjknPjxwb2x5Z29uIHBvaW50cz0nMS40LDQuMiAwLDUuNyA0LjIsOS45IDEyLjcsMS40IDExLjMsMCA0LjIsNy4xJy8+PC9zeW1ib2w+PHN5bWJvbCBpZD0neXRwLXN2Zy1zYXZlJyB2aWV3Qm94PScwIDAgMTYgMTYnPjxwYXRoIGQ9J00xMywwSDB2MTZoMTZWM0wxMywweiBNMywxaDl2NkgzVjF6IE0xNCwxNUgyVjloMTJWMTV6Jy8+PHJlY3QgeD0nMTAnIHk9JzInIHdpZHRoPScxJyBoZWlnaHQ9JzQnLz48L3N5bWJvbD48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2VjdGlvbiA9PT0gIkdFTiIpIHsKICAgICAgICAgICAgICAgICAgICB0ZW1wLmlubmVySFRNTCA9IC8vCiAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGlkPSdQLWNvbnRlbnQnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nUC1oZWFkZXInPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9J1Atc2F2ZScgICAgZGF0YS1wPSd0bmR8R0xCX1NWRSc+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0nUC1yZXNldCcgICBkYXRhLXA9J3RuZHxHTEJfUlNFVCc+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0nUC1pbXBleHAnICBkYXRhLXA9J3R0bHxHTEJfSU1QUic+PHN2ZyBjbGFzcz0nc2F2ZSc+PHVzZSB4bGluazpocmVmPScjeXRwLXN2Zy1zYXZlJy8+PC9zdmc+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0nUC1pbXBsYW5nJyBkYXRhLXA9J3R0bHxHTEJfTE9DTF9MQU5HJnRuZHxMT0NBTEUnPjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMiBkYXRhLXA9J3RuZHxHRU5fVFRMJz48L2gyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aHIgY2xhc3M9J1AtaG9yeic+PC9ocj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBkYXRhLXA9J3RuZHxHRU5fR0VOJz48L2gzPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J0dFTl9MT0NMX0xBTkcnICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdHRU5fTE9DTF9MQU5HJyAgICBkYXRhLXA9J3RuZHxHRU5fTE9DTF9MQU5HJz4gICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2N1c3RvbV9sYW5nJyAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nR0VOX0RTQkxfQURTJyAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J0dFTl9EU0JMX0FEUycgICAgIGRhdGEtcD0ndG5kfEdFTl9EU0JMX0FEUyc+ICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjb3V0c2lkZV9hZHMnICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdHRU5fWVRfTE9HT19MSU5LJyB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nR0VOX1lUX0xPR09fTElOSycgZGF0YS1wPSd0bmR8R0VOX1lUX0xPR09fTElOSyc+PC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNsb2dvX3JlZGlyZWN0JyAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J0dFTl9TVUJfTElTVCcgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdHRU5fU1VCX0xJU1QnICAgICBkYXRhLXA9J3RuZHxHRU5fU1VCX0xJU1QnPiAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI3N1Yl9wbGF5bGlzdCcgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nR0VOX0lORl9TQ1JMJyAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J0dFTl9JTkZfU0NSTCcgICAgIGRhdGEtcD0ndG5kfEdFTl9JTkZfU0NSTCc+ICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjaW5maW5pdGVfc2Nyb2xsJyBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdHRU5fUFBPVF9PTicgICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nR0VOX1BQT1RfT04nICAgICAgZGF0YS1wPSd0bmR8R0VOX1BQT1RfT04nPiAgICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNwb3BvdXRfb24nICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J0dFTl9SRU1fQVBVTicgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdHRU5fUkVNX0FQVU4nICAgICBkYXRhLXA9J3RuZHxHRU5fUkVNX0FQVU4nPiAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI3JlbW92ZV9hdXRvcGxheScgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nR0VOX1NQRl9PRkYnICAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J0dFTl9TUEZfT0ZGJyAgICAgIGRhdGEtcD0ndG5kfEdFTl9TUEZfT0ZGJz4gICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjc3BmX29mZicgICAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0nR0VOX0NITl9ERkxUX1BBR0UnIGRhdGEtcD0ndG5kfEdFTl9DSE5fREZMVF9QQUdFJz48L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J1Atc2VsZWN0Jz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0nR0VOX0NITl9ERkxUX1BBR0UnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nZGVmYXVsdCcgICAgZGF0YS1wPSd0bmR8R0VOX0NITl9ERkxUX1BBR0VfREZMVCc+PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSd2aWRlb3MnICAgICBkYXRhLXA9J3RuZHxHRU5fQ0hOX0RGTFRfUEFHRV9WSUQnPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ncGxheWxpc3RzJyAgZGF0YS1wPSd0bmR8R0VOX0NITl9ERkxUX1BBR0VfUEwnPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nY2hhbm5lbHMnICAgZGF0YS1wPSd0bmR8R0VOX0NITl9ERkxUX1BBR0VfQ0hOJz48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2Rpc2N1c3Npb24nIGRhdGEtcD0ndG5kfEdFTl9DSE5fREZMVF9QQUdFX0RJU0MnPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nYWJvdXQnICAgICAgZGF0YS1wPSd0bmR8R0VOX0NITl9ERkxUX1BBR0VfQUJUJz48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjY2hhbm5lbF9wYWdlJyBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIGRhdGEtcD0ndG5kfEdFTl9MWVQnPjwvaDM+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nR0VOX0dSSURfU1VCUycgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdHRU5fR1JJRF9TVUJTJyAgICAgZGF0YS1wPSd0bmR8R0VOX0dSSURfU1VCUyc+ICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjc3ViX2dyaWQnICAgICAgICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J0dFTl9HUklEX1NSQ0gnICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nR0VOX0dSSURfU1JDSCcgICAgIGRhdGEtcD0ndG5kfEdFTl9HUklEX1NSQ0gnPiAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI3NlYXJjaF9ncmlkJyAgICAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdHRU5fQlRUUl9OVEYnICAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J0dFTl9CVFRSX05URicgICAgICBkYXRhLXA9J3RuZHxHRU5fQlRUUl9OVEYnPiAgICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNibHVlX2JveCcgICAgICAgICAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nR0VOX0RTQl9IVlJDJyAgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdHRU5fRFNCX0hWUkMnICAgICAgZGF0YS1wPSd0bmR8R0VOX0RTQl9IVlJDJz4gICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjaG92ZXJjYXJkc19vZmYnICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J0dFTl9DTVBUX1RUTFMnICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nR0VOX0NNUFRfVFRMUycgICAgIGRhdGEtcD0ndG5kfEdFTl9DTVBUX1RUTFMnPiAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2ZlZWRfdGl0bGVzJyAgICAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdHRU5fQkxVRV9HTE9XJyAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J0dFTl9CTFVFX0dMT1cnICAgICBkYXRhLXA9J3RuZHxHRU5fQkxVRV9HTE9XJz4gICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNibHVlX2dsb3cnICAgICAgICAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nR0VOX0hJREVfRlRSJyAgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdHRU5fSElERV9GVFInICAgICAgZGF0YS1wPSd0bmR8R0VOX0hJREVfRlRSJz4gICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjaGlkZV9mb290ZXInICAgICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J0dFTl9IREVfUkVDTV9TREJSJyB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nR0VOX0hERV9SRUNNX1NEQlInIGRhdGEtcD0ndG5kfEdFTl9IREVfUkVDTV9TREJSJz48L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2hpZGVfcmVjb21fc2lkZWJhcicgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdHRU5fSERFX1NSQ0hfU0RCUicgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J0dFTl9IREVfU1JDSF9TREJSJyBkYXRhLXA9J3RuZHxHRU5fSERFX1NSQ0hfU0RCUic+PC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNoaWRlX3NlYXJjaF9zaWRlYmFyJyAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nR0VOX0hERV9DSE5fU0RCUicgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdHRU5fSERFX0NITl9TREJSJyAgZGF0YS1wPSd0bmR8R0VOX0hERV9DSE5fU0RCUic+IDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjaGlkZV9jaGFubmVsX3NpZGViYXInIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLkdFTl9MT0NMX0xBTkcgJiYgdXNlcl9zZXR0aW5ncy5sb2NhbExhbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoIi5QLWltcGxhbmciKS5kYXRhc2V0LnAgPSAiR0xCX0xPQ0xfTEFOR19DU1RNIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNlY3Rpb24gPT09ICJWSUQiKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSAvLwogICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBpZD0nUC1jb250ZW50Jz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J1AtaGVhZGVyJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSdQLXNhdmUnICAgIGRhdGEtcD0ndG5kfEdMQl9TVkUnPjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9J1AtcmVzZXQnICAgZGF0YS1wPSd0bmR8R0xCX1JTRVQnPjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9J1AtaW1wZXhwJyAgZGF0YS1wPSd0dGx8R0xCX0lNUFInPjxzdmcgY2xhc3M9J3NhdmUnPjx1c2UgeGxpbms6aHJlZj0nI3l0cC1zdmctc2F2ZScvPjwvc3ZnPjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9J1AtaW1wbGFuZycgZGF0YS1wPSd0dGx8R0xCX0xPQ0xfTEFORyZ0bmR8TE9DQUxFJz48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDIgZGF0YS1wPSd0bmR8VklEX1RUTCc+PC9oMj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGhyIGNsYXNzPSdQLWhvcnonPjwvaHI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDMgZGF0YS1wPSd0bmR8VklEX1BMUic+PC9oMz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUExSX0FEUycgICAgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfUExSX0FEUycgICAgICBkYXRhLXA9J3RuZHxWSURfUExSX0FEUyc+ICAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI3ZpZGVvX2FkcycgICAgICAgICAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX1NVQl9BRFMnICAgICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX1NVQl9BRFMnICAgICAgZGF0YS1wPSd0bmR8VklEX1NVQl9BRFMnPiAgICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNzdWJzX2Fkc19vbicgICAgICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9QTFJfQUxWSVMnICAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9QTFJfQUxWSVMnICAgIGRhdGEtcD0ndG5kfFZJRF9QTFJfQUxWSVMnPiAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjZmxvYXRpbmdfcGxheWVyJyAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUExSX0FMVklTX1dEVEgnIHR5cGU9J3RleHQnIHBsYWNlaG9sZGVyPSczNTAnIHNpemU9JzYnPjxsYWJlbCBmb3I9J1ZJRF9QTFJfQUxWSVNfV0RUSCcgZGF0YS1wPSd0bmR8VklEX1BMUl9BTFZJU19XRFRIJz48L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2Zsb2F0aW5nX3BsYXllcl93aWR0aCcgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX1BMUl9BVFBMJyAgICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX1BMUl9BVFBMJyAgICAgZGF0YS1wPSd0bmR8VklEX1BMUl9BVFBMJz4gICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyN2aWRlb19hdXRvcGxheScgICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9QTFJfQ0MnICAgICAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9QTFJfQ0MnICAgICAgIGRhdGEtcD0ndG5kfFZJRF9QTFJfQ0MnPiAgICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjc3VidGl0bGVzX29mZicgICAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUExSX0FOVFMnICAgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfUExSX0FOVFMnICAgICBkYXRhLXA9J3RuZHxWSURfUExSX0FOVFMnPiAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2Fubm90YXRpb25zX29mZicgICAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX0VORF9TSFJFJyAgICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX0VORF9TSFJFJyAgICAgZGF0YS1wPSd0bmR8VklEX0VORF9TSFJFJz4gICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNzaGFyZV9wYW5lbF9vZmYnICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9QTFJfVk9MX01FTScgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9QTFJfVk9MX01FTScgIGRhdGEtcD0ndG5kfFZJRF9QTFJfVk9MX01FTSc+IDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjcmVtZW1iZXJfdm9sdW1lJyAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUExSX1ZPTF9MRE4nICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfUExSX1ZPTF9MRE4nICBkYXRhLXA9J3RuZHxWSURfUExSX1ZPTF9MRE4nPiA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2Rpc2FibGVfbm9ybWFsaXNhdGlvbicgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX1BMUl9BTEFDVCcgICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX1BMUl9BTEFDVCcgICAgZGF0YS1wPSd0bmR8VklEX1BMUl9BTEFDVCc+ICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNzaG9ydGN1dHNfb24nICAgICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9QTFJfU0laRV9NRU0nICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9QTFJfU0laRV9NRU0nIGRhdGEtcD0ndG5kfFZJRF9QTFJfU0laRV9NRU0nPjwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjcmVtZW1iZXJfbW9kZScgICAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfVk9MX1dIRUVMJyAgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfVk9MX1dIRUVMJyAgICBkYXRhLXA9J3RuZHxWSURfVk9MX1dIRUVMJz4gICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI3doZWVsX3ZvbHVtZScgICAgICAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX1BMUl9IRlInICAgICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX1BMUl9IRlInICAgICAgZGF0YS1wPSd0bmR8VklEX1BMUl9IRlInPiAgICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNoZnJfb2ZmJyAgICAgICAgICAgICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9QTFJfSFRNTDUnICAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9QTFJfSFRNTDUnICAgIGRhdGEtcD0ndG5kfFZJRF9QTFJfSFRNTDUnPiAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjZm9yY2VfaHRtbDUnICAgICAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0nVklEX0RGTFRfUUxUWScgZGF0YS1wPSd0bmR8VklEX0RGTFRfUUxUWSc+PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSdQLXNlbGVjdCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgaWQ9J1ZJRF9ERkxUX1FMVFknPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nYXV0bycgICAgZGF0YS1wPSd0bmR8VklEX0RGTFRfUUxUWV9BVVRPJz48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2hpZ2hyZXMnIGRhdGEtcD0ndG5kfFZJRF9ERkxUX1FMVFlfT1JJRyc+PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdoZDI4ODAnICBkYXRhLXA9J3RuZHxWSURfREZMVF9RTFRZXzI4ODAnPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0naGQyMTYwJyAgZGF0YS1wPSd0bmR8VklEX0RGTFRfUUxUWV8yMTYwJz48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2hkMTQ0MCcgIGRhdGEtcD0ndG5kfFZJRF9ERkxUX1FMVFlfMTQ0MCc+PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdoZDEwODAnICBkYXRhLXA9J3RuZHxWSURfREZMVF9RTFRZXzEwODAnPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0naGQ3MjAnICAgZGF0YS1wPSd0bmR8VklEX0RGTFRfUUxUWV83MjAnID48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J2xhcmdlJyAgIGRhdGEtcD0ndG5kfFZJRF9ERkxUX1FMVFlfTFJHJyA+PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSdtZWRpdW0nICBkYXRhLXA9J3RuZHxWSURfREZMVF9RTFRZX01ETScgPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nc21hbGwnICAgZGF0YS1wPSd0bmR8VklEX0RGTFRfUUxUWV9TTUwnID48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9J3RpbnknICAgIGRhdGEtcD0ndG5kfFZJRF9ERkxUX1FMVFlfVE5ZJyA+PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2RlZmF1bHRfcXVhbGl0eScgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBkYXRhLXA9J3RuZHxWSURfUExSX0xZVCc+PC9oMz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUExSX0lORk8nICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX1BMUl9JTkZPJyAgICAgZGF0YS1wPSd0bmR8VklEX1BMUl9JTkZPJz4gICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNpbmZvX2JhcicgICAgICAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX1BMUl9EWU5fU0laRScgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9QTFJfRFlOX1NJWkUnIGRhdGEtcD0ndG5kfFZJRF9QTFJfRFlOX1NJWkUnPjwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjZHluYW1pY19zaXplX29mZicgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9QTFJfRklUJyAgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfUExSX0ZJVCcgICAgICBkYXRhLXA9J3RuZHxWSURfUExSX0ZJVCc+ICAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2ZpdF90b19wYWdlJyAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUExSX0ZJVF9XRFRIJyB0eXBlPSd0ZXh0JyBwbGFjZWhvbGRlcj0nMTI4MHB4JyBzaXplPSc2Jz48bGFiZWwgZm9yPSdWSURfUExSX0ZJVF9XRFRIJyBkYXRhLXA9J3RuZHxWSURfUExSX0ZJVF9XRFRIJz48L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2ZpdF9tYXhfd2lkdGgnIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIGRhdGEtcD0ndG5kfFZJRF9QTFNUJz48L2gzPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9QTFNUX0FUUEwnICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfUExTVF9BVFBMJyAgICBkYXRhLXA9J3RuZHxWSURfUExTVF9BVFBMJz4gICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI3BsYXlsaXN0X2F1dG9wbGF5JyBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUExTVF9SVlJTJyAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX1BMU1RfUlZSUycgICAgZGF0YS1wPSd0bmR8VklEX1BMU1RfUlZSUyc+ICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNwbGF5bGlzdF9yZXZlcnNlJyAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDMgZGF0YS1wPSd0bmR8VklEX0xBWVQnPjwvaDM+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX1BQT1RfU1onIHR5cGU9J3RleHQnIHBsYWNlaG9sZGVyPSc1MzMnIHNpemU9JzYnPjxsYWJlbCBmb3I9J1ZJRF9QUE9UX1NaJyBkYXRhLXA9J3RuZHxWSURfUFBPVF9TWic+PC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNwb3BvdXRfc2l6ZScgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9J1ZJRF9ISURFX0NPTVMnIGRhdGEtcD0ndG5kfFZJRF9ISURFX0NPTVMnPjwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nUC1zZWxlY3QnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSdWSURfSElERV9DT01TJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzAnIGRhdGEtcD0ndG5kfFZJRF9ISURFX0NPTVNfU0hPVyc+PC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScxJyBkYXRhLXA9J3RuZHxWSURfSElERV9DT01TX0hJREUnPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMicgZGF0YS1wPSd0bmR8VklEX0hJREVfQ09NU19SRU0nPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNjb21tZW50cycgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfVFRMX0NNUFQnICAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9UVExfQ01QVCcgICAgICBkYXRhLXA9J3RuZHxWSURfVFRMX0NNUFQnPiAgICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyN2aWRlb190aXRsZScgICAgICAgICAgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX0RFU0NfU0hSVCcgICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfREVTQ19TSFJUJyAgICAgZGF0YS1wPSd0bmR8VklEX0RFU0NfU0hSVCc+ICAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjbGFiZWxsZXNzX2J1dHRvbnMnICAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9WSURfQ05UJyAgICAgICB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX1ZJRF9DTlQnICAgICAgIGRhdGEtcD0ndG5kfFZJRF9WSURfQ05UJz4gICAgICA8L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI3VwbG9hZF9jb3VudGVyJyAgICAgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGlucHV0IGlkPSdWSURfUE9TVF9USU1FJyAgICAgdHlwZT0nY2hlY2tib3gnPjxsYWJlbCBmb3I9J1ZJRF9QT1NUX1RJTUUnICAgICBkYXRhLXA9J3RuZHxWSURfUE9TVF9USU1FJz4gICAgPC9sYWJlbD5cbjxhIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvd2lraS9GZWF0dXJlcyNyZWxhdGl2ZV91cGxvYWRfdGltZScgZGF0YS1wPSd0dGx8RlRSX0RFU0MnIHRhcmdldD0nZmVhdHVyZXMnPj88L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nVklEX0hJREVfREVUTFMnICAgIHR5cGU9J2NoZWNrYm94Jz48bGFiZWwgZm9yPSdWSURfSElERV9ERVRMUycgICAgZGF0YS1wPSd0bmR8VklEX0hJREVfREVUTFMnPiAgIDwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjaGlkZV92aWRlb19kZXRhaWxzJyAgIGRhdGEtcD0ndHRsfEZUUl9ERVNDJyB0YXJnZXQ9J2ZlYXR1cmVzJz4/PC9hPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48aW5wdXQgaWQ9J1ZJRF9MQVlUX0FVVE9fUE5MJyB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nVklEX0xBWVRfQVVUT19QTkwnIGRhdGEtcD0ndG5kfFZJRF9MQVlUX0FVVE9fUE5MJz48L2xhYmVsPlxuPGEgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzI2V4cGFuZF9kZXNjcmlwdGlvbicgICBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsKICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5HRU5fTE9DTF9MQU5HICYmIHVzZXJfc2V0dGluZ3MubG9jYWxMYW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAuY29udGVudC5xdWVyeVNlbGVjdG9yKCIuUC1pbXBsYW5nIikuZGF0YXNldC5wID0gIkdMQl9MT0NMX0xBTkdfQ1NUTSI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWN0aW9uID09PSAiQkxLIikgewogICAgICAgICAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gLy8KICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgaWQ9J1AtY29udGVudCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSdQLWhlYWRlcic+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0nUC1zYXZlJyAgICBkYXRhLXA9J3RuZHxHTEJfU1ZFJz48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSdQLXJlc2V0JyAgIGRhdGEtcD0ndG5kfEdMQl9SU0VUJz48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSdQLWltcGV4cCcgIGRhdGEtcD0ndHRsfEdMQl9JTVBSJz48c3ZnIGNsYXNzPSdzYXZlJz48dXNlIHhsaW5rOmhyZWY9JyN5dHAtc3ZnLXNhdmUnLz48L3N2Zz48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSdQLWltcGxhbmcnIGRhdGEtcD0ndHRsfEdMQl9MT0NMX0xBTkcmdG5kfExPQ0FMRSc+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGRhdGEtcD0ndG5kfEJMS19UVEwnPjwvaDI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxociBjbGFzcz0nUC1ob3J6Jz48L2hyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIGRhdGEtcD0ndG5kfEJMS19CTEsnPjwvaDM+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxpbnB1dCBpZD0nQkxLX09OJyB0eXBlPSdjaGVja2JveCc+PGxhYmVsIGZvcj0nQkxLX09OJyBkYXRhLXA9J3RuZHxCTEtfT04nPjwvbGFiZWw+XG48YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvRmVhdHVyZXMjYmxhY2tsaXN0X29uJyBkYXRhLXA9J3R0bHxGVFJfREVTQycgdGFyZ2V0PSdmZWF0dXJlcyc+PzwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9J2JsYWNrbGlzdCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nYmxhY2tsaXN0LWNvbnRyb2xzJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0nYmxhY2tsaXN0LWVkaXQnICBjbGFzcz0neXQtdWl4LWJ1dHRvbiB5dC11aXgtc2Vzc2lvbmxpbmsgeXQtdWl4LWJ1dHRvbi1kZWZhdWx0IHl0LXVpeC1idXR0b24tc2l6ZS1kZWZhdWx0Jz48c3BhbiBjbGFzcz0neXQtdWl4LWJ1dHRvbi1jb250ZW50JyBkYXRhLXA9J3RuZHxCTENLX0VESVQnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0nYmxhY2tsaXN0LXNhdmUnICBjbGFzcz0neXQtdWl4LWJ1dHRvbiB5dC11aXgtc2Vzc2lvbmxpbmsgeXQtdWl4LWJ1dHRvbi1kZWZhdWx0IHl0LXVpeC1idXR0b24tc2l6ZS1kZWZhdWx0Jz48c3BhbiBjbGFzcz0neXQtdWl4LWJ1dHRvbi1jb250ZW50JyBkYXRhLXA9J3RuZHxCTENLX1NBVkUnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0nYmxhY2tsaXN0LWNsb3NlJyBjbGFzcz0neXQtdWl4LWJ1dHRvbiB5dC11aXgtc2Vzc2lvbmxpbmsgeXQtdWl4LWJ1dHRvbi1kZWZhdWx0IHl0LXVpeC1idXR0b24tc2l6ZS1kZWZhdWx0Jz48c3BhbiBjbGFzcz0neXQtdWl4LWJ1dHRvbi1jb250ZW50JyBkYXRhLXA9J3RuZHxCTENLX0NMU0UnPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dGFyZWEgaWQ9J2JsYWNrbGlzdC1lZGl0LWxpc3QnPjwvdGV4dGFyZWE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxicj48L2JyPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLkdFTl9MT0NMX0xBTkcgJiYgdXNlcl9zZXR0aW5ncy5sb2NhbExhbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoIi5QLWltcGxhbmciKS5kYXRhc2V0LnAgPSAidHRsfEdMQl9MT0NMX0xBTkcmdG5kfEdMQl9MT0NMX0xBTkdfQ1NUTSI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWN0aW9uID09PSAiQUJUIikgewogICAgICAgICAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gLy8KICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgaWQ9J1AtY29udGVudCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSdQLWhlYWRlcic+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGRhdGEtcD0ndG5kfEFCVF9UVEwnPjwvaDI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxociBjbGFzcz0nUC1ob3J6Jz48L2hyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIGRhdGEtcD0ndG5kfEFCVF9USEtTJz48L2gzPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48YSB0YXJnZXQ9J19ibGFuaycgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1llUHBIYSc+SmVwcGUgUnVuZSBNb3J0ZW5zZW48L2E+PHNwYW4gZGF0YS1wPSd0bmR8QUJUX1RIS1NfWUVQUEhBJz48L3NwYW4+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxhIHRhcmdldD0nX2JsYW5rJyBocmVmPSdodHRwOi8vd3d3LmdyZWFzZXNwb3QubmV0Lyc+R3JlYXNlbW9ua2V5PC9hPiArIDxhIGhyZWY9J2h0dHA6Ly90YW1wZXJtb25rZXkubmV0Lyc+VGFtcGVybW9ua2V5PC9hPjxzcGFuIGRhdGEtcD0ndG5kfEFCVF9USEtTX1VTRVJTQ1JJUFQnPjwvc3Bhbj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGEgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS8nPlN0YWNrIE92ZXJmbG93PC9hPjxzcGFuIGRhdGEtcD0ndG5kfEFCVF9USEtTX1NUQUNLT1YnPjwvc3Bhbj48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBkYXRhLXA9J3RuZHxBQlRfSU5GTyc+PC9oMz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGEgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J2h0dHBzOi8vZ2l0aHViLmNvbS9QYXJ0aWNsZUNvcmUvUGFydGljbGUvJz5HaXRIdWI8L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxhIHRhcmdldD0nX2JsYW5rJyBocmVmPSdodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL3VzZXJzLzgyMjMtcGFydGljbGVjb3JlJz5HcmVhc3kgRm9yazwvYT48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+PGEgdGFyZ2V0PSdfYmxhbmsnIGhyZWY9J2h0dHA6Ly9vcGVudXNlcmpzLm9yZy9zY3JpcHRzL1BhcnRpY2xlQ29yZS8nPk9wZW5Vc2VySlM8L2E+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpbnB1dHMgPSB0ZW1wLmNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgiaW5wdXRbdHlwZT0nY2hlY2tib3gnXSArIGxhYmVsIik7CiAgICAgICAgICAgICAgICBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgInN2ZyIpOwogICAgICAgICAgICAgICAgc3ZnLmlubmVySFRNTCA9ICI8dXNlIHhsaW5rOmhyZWY9JyN5dHAtc3ZnLWNoZWNrbWFyayc+IjsKICAgICAgICAgICAgICAgIGkgPSBpbnB1dHMubGVuZ3RoOwogICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0c1tpXS5hcHBlbmRDaGlsZChzdmcuY2xvbmVOb2RlKHRydWUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBzZXRMb2NhbGUoZ2V0VmFsdWVzKHRlbXAuY29udGVudCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGV4cG9ydFNldHRpbmdzKHRhcmdldCkgewogICAgICAgICAgICAgICAgdmFyIGV4cENvbnQ7CiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygiUC1pbXBleHAiKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJQLWltcGxhbmciKSkgewogICAgICAgICAgICAgICAgICAgIGV4cENvbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZXhwLWNvbnQiKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZXhwQ29udCkgewogICAgICAgICAgICAgICAgICAgICAgICBleHBDb250Lm91dGVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGV4cENvbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIpOwogICAgICAgICAgICAgICAgICAgIGV4cENvbnQuaW5uZXJIVE1MID0gLy8KICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgaWQ9J2V4cC1jb250Jz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0naW1wbGFuZy1zYXZlJyBjbGFzcz0neXQtdWl4LWJ1dHRvbiB5dC11aXgtc2Vzc2lvbmxpbmsgeXQtdWl4LWJ1dHRvbi1kZWZhdWx0IHl0LXVpeC1idXR0b24tc2l6ZS1kZWZhdWx0Jz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0neXQtdWl4LWJ1dHRvbi1jb250ZW50JyBkYXRhLXA9J3RuZHxHTEJfSU1QUl9TQVZFJz48L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRleHRhcmVhIGlkPSdpbXBleHAtbGlzdCc+PC90ZXh0YXJlYT4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsKICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygiUC1pbXBleHAiKSkgewogICAgICAgICAgICAgICAgICAgICAgICBleHBDb250LmNvbnRlbnQucXVlcnlTZWxlY3RvcigiI2ltcGxhbmctc2F2ZSIpLmlkID0gImltcGV4cC1zYXZlIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZXhwQ29udCA9IHNldExvY2FsZShleHBDb250LmNvbnRlbnQpLmZpcnN0Q2hpbGQ7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlAtY29udGVudCIpLmFwcGVuZENoaWxkKGV4cENvbnQpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbXBleHAtbGlzdCIpLnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoIlAtaW1wZXhwIikgJiYgdXNlcl9zZXR0aW5ncykgfHwgdXNlcl9zZXR0aW5ncy5sb2NhbExhbmcgfHwgbGFuZ3VhZ2UsIHVuZGVmaW5lZCwgMik7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldC5pZCA9PT0gImltcGV4cC1zYXZlIiB8fCB0YXJnZXQuaWQgPT09ICJpbXBsYW5nLXNhdmUiKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldC5pZCA9PT0gImltcGxhbmctc2F2ZSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0KCJsb2NhbExhbmciLCBKU09OLnBhcnNlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbXBleHAtbGlzdCIpLnZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBzZXQoInVzZXJfc2V0dGluZ3MiLCBKU09OLnBhcnNlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbXBleHAtbGlzdCIpLnZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzTWVudS5zZXR0aW5nc0J1dHRvbi5jbGljaygpOwogICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nc01lbnUuc2V0dGluZ3NCdXR0b24uY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc2V0QmxhY2tMaXN0KHRhcmdldCkgewogICAgICAgICAgICAgICAgaWYgKHRhcmdldC5pZCA9PT0gImJsYWNrbGlzdC1lZGl0IikgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJibGFja2xpc3QiKS5jbGFzc0xpc3QuYWRkKCJlZGl0Iik7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJsYWNrbGlzdC1lZGl0LWxpc3QiKS52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHVzZXJfc2V0dGluZ3MuYmxhY2tsaXN0LCB1bmRlZmluZWQsIDIpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQuaWQgPT09ICJibGFja2xpc3Qtc2F2ZSIpIHsKICAgICAgICAgICAgICAgICAgICBzZXQoImJsYWNrbGlzdCIsIEpTT04ucGFyc2UoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJsYWNrbGlzdC1lZGl0LWxpc3QiKS52YWx1ZSkpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YXJnZXQuaWQgPT09ICJibGFja2xpc3QtY2xvc2UiKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkJMSyIpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gZGVsQmxhY2tMaXN0KGV2ZW50KSB7CiAgICAgICAgICAgICAgICB2YXIgbmV3S2V5ID0gdXNlcl9zZXR0aW5ncy5ibGFja2xpc3Q7CiAgICAgICAgICAgICAgICBkZWxldGUgbmV3S2V5W2V2ZW50LnRhcmdldC5uZXh0U2libGluZy5ocmVmLnNwbGl0KCIvY2hhbm5lbC8iKVsxXV07CiAgICAgICAgICAgICAgICBldmVudC50YXJnZXQucGFyZW50Tm9kZS5vdXRlckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIHNldCgiYmxhY2tsaXN0IiwgbmV3S2V5KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBkZWxOb3RpZmljYXRpb24oKSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoInNob3ctZ3VpZGUtYnV0dG9uLW5vdGlmaWNhdGlvbiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHNhdmVTZXR0aW5ncyhzYWx0KSB7CiAgICAgICAgICAgICAgICB2YXIgaSwgdmFsdWUsIG5vdGlmaWNhdGlvbiwgbmF2SWQsIHVzZXJTZXRzLCBzYXZlZFNldHM7CiAgICAgICAgICAgICAgICBuYXZJZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5zZWxlY3RlZCIpLmlkOwogICAgICAgICAgICAgICAgdXNlclNldHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiUC1jb250ZW50IikucXVlcnlTZWxlY3RvckFsbCgiW2lkXj0nIiArIG5hdklkICsgIiddIik7CiAgICAgICAgICAgICAgICBzYXZlZFNldHMgPSB1c2VyX3NldHRpbmdzOwogICAgICAgICAgICAgICAgaSA9IHVzZXJTZXRzLmxlbmd0aDsKICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICh1c2VyU2V0c1tpXS5jaGVja2VkICYmICh1c2VyU2V0c1tpXS52YWx1ZSA9PT0gIm9uIiB8fCB1c2VyU2V0c1tpXS52YWx1ZSkpIHx8ICh1c2VyU2V0c1tpXS5sZW5ndGggJiYgdXNlclNldHNbaV0udmFsdWUpIHx8ICh1c2VyU2V0c1tpXS5nZXRBdHRyaWJ1dGUoInR5cGUiKSA9PT0gInRleHQiICYmIHVzZXJTZXRzW2ldLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZWRTZXRzW3VzZXJTZXRzW2ldLm5hbWUgfHwgdXNlclNldHNbaV0uaWRdID0gdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdmFsdWUgJiYgdXNlclNldHNbaV0udHlwZSAhPT0gInJhZGlvIikgewogICAgICAgICAgICAgICAgICAgICAgICBzYXZlZFNldHNbdXNlclNldHNbaV0uaWRdID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2V0KCJ1c2VyX3NldHRpbmdzIiwgc2F2ZWRTZXRzKTsKICAgICAgICAgICAgICAgIGN1c3RvbVN0eWxlcygpOwogICAgICAgICAgICAgICAgaWYgKCFzYWx0KSB7CiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFwcGJhci1tYWluLWd1aWRlLW5vdGlmaWNhdGlvbi1jb250YWluZXIiKTsKICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmNoaWxkTm9kZXMubGVuZ3RoIDwgMSkgewogICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24ub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5pbm5lckhUTUwgPSAvLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgaWQ9J2FwcGJhci1tYWluLWd1aWRlLW5vdGlmaWNhdGlvbi1jb250YWluZXInPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2FwcGJhci1ndWlkZS1ub3RpZmljYXRpb24nIHJvbGU9J2FsZXJ0Jz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2FwcGJhci1ndWlkZS1ub3RpZmljYXRpb24tY29udGVudC13cmFwcGVyIHl0LXZhbGlnbic+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0nYXBwYmFyLWd1aWRlLW5vdGlmaWNhdGlvbi1pY29uIHl0LXNwcml0ZSc+PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2FwcGJhci1ndWlkZS1ub3RpZmljYXRpb24tdGV4dC1jb250ZW50Jz48L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbiA9IHNldExvY2FsZShub3RpZmljYXRpb24uY29udGVudCkuZmlyc3RDaGlsZDsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnl0LW1hc3RoZWFkLWxvZ28tY29udGFpbmVyIikuYXBwZW5kQ2hpbGQobm90aWZpY2F0aW9uKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmFwcGJhci1ndWlkZS1ub3RpZmljYXRpb24tdGV4dC1jb250ZW50IikudGV4dENvbnRlbnQgPSBsYW5nKCJHTEJfU1ZFX1NFVFMiKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoInNob3ctZ3VpZGUtYnV0dG9uLW5vdGlmaWNhdGlvbiIpOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGRlbE5vdGlmaWNhdGlvbiwgMjAwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbmF2aWdhdGVTZXR0aW5ncyhldmVudCkgewogICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoIlAtc2F2ZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgc2F2ZVNldHRpbmdzKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoIlAtcmVzZXQiKSAmJiB3aW5kb3cuY29uZmlybShsYW5nKCJHTEJfUlNFVF9DT05GIikpKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0KCJ1c2VyX3NldHRpbmdzIiwgZGVmYXVsdF9zZXR0aW5ncyk7CiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NNZW51LnNldHRpbmdzQnV0dG9uLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NNZW51LnNldHRpbmdzQnV0dG9uLmNsaWNrKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoImNsb3NlIikpIHsKICAgICAgICAgICAgICAgICAgICBkZWxCbGFja0xpc3QoZXZlbnQpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJQLWltcGV4cCIpIHx8IGV2ZW50LnRhcmdldC5pZCA9PT0gImltcGV4cC1zYXZlIiB8fCBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJQLWltcGxhbmciKSB8fCBldmVudC50YXJnZXQuaWQgPT09ICJpbXBsYW5nLXNhdmUiKSB7CiAgICAgICAgICAgICAgICAgICAgZXhwb3J0U2V0dGluZ3MoZXZlbnQudGFyZ2V0KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQudGFyZ2V0LmlkID09PSAiYmxhY2tsaXN0LWVkaXQiIHx8IGV2ZW50LnRhcmdldC5pZCA9PT0gImJsYWNrbGlzdC1zYXZlIiB8fCBldmVudC50YXJnZXQuaWQgPT09ICJibGFja2xpc3QtY2xvc2UiKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0QmxhY2tMaXN0KGV2ZW50LnRhcmdldCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5pZCA9PT0gIlAtY29udGFpbmVyIiB8fCBldmVudC50YXJnZXQuaWQgPT09ICJQLXNldHRpbmdzIikgewogICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gKGV2ZW50LnRhcmdldC5pZCA9PT0gIlAtc2V0dGluZ3MiKSA/IGV2ZW50LnRhcmdldCA6IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgIGV2ZW50Lm91dGVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Wyh3aW5kb3cuY2hyb21lICYmICJib2R5IikgfHwgImRvY3VtZW50RWxlbWVudCJdLnNjcm9sbFRvcCA9IDA7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCJyZXNpemUiKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnRhcmdldC5pZCAhPT0gIkROVCIgJiYgZXZlbnQudGFyZ2V0LnRhZ05hbWUgIT09ICJBIiAmJiBldmVudC50YXJnZXQucGFyZW50Tm9kZS5pZCA9PT0gIlAtc2lkZWJhci1saXN0IikgewogICAgICAgICAgICAgICAgICAgIHNhdmVTZXR0aW5ncygibm8tbm90aWZpY2F0aW9uIik7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlAtY29udGVudCIpLm91dGVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJQLWNvbnRhaW5lciIpLmFwcGVuZENoaWxkKGdldE1lbnUoZXZlbnQudGFyZ2V0LmlkKSk7CiAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcigiLnNlbGVjdGVkIikucmVtb3ZlQXR0cmlidXRlKCJjbGFzcyIpOwogICAgICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc05hbWUgPSAic2VsZWN0ZWQiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHNldHRpbmdzVGVtcGxhdGUoZXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciBwV3JhcHBlcjsKICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQuaWQgPT09ICJQIiAmJiBldmVudC50YXJnZXQudGFnTmFtZSAhPT0gIklOUFVUIikgewogICAgICAgICAgICAgICAgICAgIHBXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlAtc2V0dGluZ3MiKTsKICAgICAgICAgICAgICAgICAgICBpZiAocFdyYXBwZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcFdyYXBwZXIub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoImZsb2F0ZXIiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoImZsb2F0ZXIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb3ZpZV9wbGF5ZXIiKS5yZW1vdmVBdHRyaWJ1dGUoInN0eWxlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcFdyYXBwZXIgPSBnZXRNZW51KCJNRU4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgcFdyYXBwZXIucXVlcnlTZWxlY3RvcigiI1AtY29udGFpbmVyIikuYXBwZW5kQ2hpbGQoZ2V0TWVudSgiR0VOIikpOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYm9keS1jb250YWluZXIiKS5pbnNlcnRCZWZvcmUocFdyYXBwZXIsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYWdlLWNvbnRhaW5lciIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBuYXZpZ2F0ZVNldHRpbmdzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRbKHdpbmRvdy5jaHJvbWUgJiYgImJvZHkiKSB8fCAiZG9jdW1lbnRFbGVtZW50Il0uc2Nyb2xsVG9wID0gMDsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoInJlc2l6ZSIpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBmaXJzdFRpbWUoZXZlbnQpIHsKICAgICAgICAgICAgICAgIGlmIChldmVudCAmJiBldmVudC50YXJnZXQgJiYgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUgJiYgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUuY2xhc3NOYW1lID09PSAicGFyX2Nsb3Nld2xjbSIpIHsKICAgICAgICAgICAgICAgICAgICBzZXQoImZpcnN0VGltZSIsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsIGZpcnN0VGltZSk7CiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NNZW51LndlbGNvbWUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBzZXR0aW5nc01lbnUoKSB7CiAgICAgICAgICAgICAgICB2YXIgbm90aWZfYnV0dG9uLCBzZXR0aW5nc19idXR0b24sIHdlbGNvbWVfbWVzc2FnZTsKICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nc01lbnUuc2V0dGluZ3NCdXR0b24pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBub3RpZl9idXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIubm90aWZpY2F0aW9ucy1jb250YWluZXIiKTsKICAgICAgICAgICAgICAgIHNldHRpbmdzX2J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN5dC1tYXN0aGVhZC11c2VyLCAjeXQtbWFzdGhlYWQtc2lnbmluIik7CiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3NfYnV0dG9uKSB7CiAgICAgICAgICAgICAgICAgICAgd2VsY29tZV9tZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGVtcGxhdGUiKTsKICAgICAgICAgICAgICAgICAgICB3ZWxjb21lX21lc3NhZ2UuaW5uZXJIVE1MID0gLy8KICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgaWQ9J1BzZXR0aW5ncyc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSdQJyBkYXRhLXA9J3R0bHxZVFNFVFMnIHN0eWxlPSdoZWlnaHQ6MjhweDttYXJnaW4tcmlnaHQ6MTBweDtvcGFjaXR5Oi41NTt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7d2lkdGg6MThweDsnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgdmlld0JveD0nMCAwIDE4IDIwJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBvbHlnb24gcG9pbnRzPScwLDIwIDE0LDEyIDAsNCcvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBwb2ludHM9JzE1LDMgMTUsMCAxMywwIDEzLDMgMTAsMyAxMCw1IDEzLDUgMTMsOCAxNSw4IDE1LDUgMTgsNSAxOCwzJy8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9J3BhcnRfd2VsY29tZScgc3R5bGU9J2Rpc3BsYXk6bm9uZTttYXJnaW4tbGVmdDotMjIwcHg7dG9wOjM4cHg7cmlnaHQ6MCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gZGF0YS1wPSd0bmR8V0xDTSc+PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxicj48L2JyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGRhdGEtcD0ndG5kfFdMQ01TVFJUJz48L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJyPjwvYnI+PGJyPjwvYnI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgZGF0YS1wPSd0bmR8V0xDTUZUUlMnIHN0eWxlPSdjb2xvcjojRkZGOycgaHJlZj0naHR0cHM6Ly9naXRodWIuY29tL1BhcnRpY2xlQ29yZS9QYXJ0aWNsZS93aWtpL0ZlYXR1cmVzJyB0YXJnZXQ9J19ibGFuayc+PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J3Bhcl9jbG9zZXdsY20nPjxzcGFuPsOXPC9zcGFuPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgd2VsY29tZV9tZXNzYWdlID0gc2V0TG9jYWxlKHdlbGNvbWVfbWVzc2FnZS5jb250ZW50KTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHNldHRpbmdzVGVtcGxhdGUpOwogICAgICAgICAgICAgICAgICAgIGlmIChub3RpZl9idXR0b24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NfYnV0dG9uLmluc2VydEJlZm9yZSh3ZWxjb21lX21lc3NhZ2UsIG5vdGlmX2J1dHRvbik7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NfYnV0dG9uLmFwcGVuZENoaWxkKHdlbGNvbWVfbWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNldHRpbmdzTWVudS5zZXR0aW5nc0J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJQIik7CiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NNZW51LndlbGNvbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFydF93ZWxjb21lIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuZmlyc3RUaW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzTWVudS53ZWxjb21lLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZpcnN0VGltZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG1vZENvbW1lbnQob3JpZ2luYWwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgIHZhciBjb21tZW50cywgaXNfbGl2ZTsKICAgICAgICAgICAgICAgICAgICBjb21tZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ3YXRjaC1kaXNjdXNzaW9uIik7CiAgICAgICAgICAgICAgICAgICAgaXNfbGl2ZSA9IHdpbmRvdy55dHBsYXllciAmJiB3aW5kb3cueXRwbGF5ZXIuY29uZmlnICYmIHdpbmRvdy55dHBsYXllci5jb25maWcuYXJncyAmJiB3aW5kb3cueXRwbGF5ZXIuY29uZmlnLmFyZ3MubGl2ZXN0cmVhbTsKICAgICAgICAgICAgICAgICAgICBpZiAoYS5zcGxpdCgiY29tbWVudHMiKS5sZW5ndGggPiAxICYmICFpc19saXZlICYmIGNvbW1lbnRzICYmICFjb21tZW50cy5sYXp5bG9hZCAmJiB1c2VyX3NldHRpbmdzLlZJRF9ISURFX0NPTVMgPT09ICIxIiAmJiAhY29tbWVudHMuY2xhc3NMaXN0LmNvbnRhaW5zKCJzaG93IikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudHMubGF6eWxvYWQgPSBhcmd1bWVudHM7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBtb2RTZXRDb25maWcob3JpZ2luYWwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCJTSEFSRV9PTl9WSURFT19FTkQiIGluIGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuU0hBUkVfT05fVklERU9fRU5EID0gIXVzZXJfc2V0dGluZ3MuVklEX0VORF9TSFJFOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgiVU5JVkVSU0FMX0hPVkVSQ0FSRFMiIGluIGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuVU5JVkVSU0FMX0hPVkVSQ0FSRFMgPSAhdXNlcl9zZXR0aW5ncy5HRU5fRFNCX0hWUkM7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbW9kRW1iZWQob3JpZ2luYWwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wLCBwbGF5ZXI7CiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IGEuaWQgfHwgYTsKICAgICAgICAgICAgICAgICAgICBpZiAodGVtcCAhPT0gInBsYXllci1hcGkiICYmIHRlbXAgIT09ICJ1cHNlbGwtdmlkZW8iKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBiID0gbW9kQXJncyhiKTsKICAgICAgICAgICAgICAgICAgICB0ZW1wID0gb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICBwbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW92aWVfcGxheWVyIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHBsYXllcikgewogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0UGxheWJhY2tRdWFsaXR5KHVzZXJfc2V0dGluZ3MuVklEX0RGTFRfUUxUWSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZW1wOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBtb2RBdXRvcGxheShvcmlnaW5hbCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFiIHx8IHVzZXJfc2V0dGluZ3MucGxBcGwgfHwgKCF1c2VyX3NldHRpbmdzLnBsQXBsICYmIGIuZmVhdHVyZSAmJiBiLmZlYXR1cmUgIT09ICJhdXRvcGxheSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBtb2RBdXRvcGxheUZ1bGxzY3JlZW4ob3JpZ2luYWwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGhhc19lbmRlZCwgbmV4dF9idXR0b24sIG5leHRfY2xpY2tlZDsKICAgICAgICAgICAgICAgICAgICBoYXNfZW5kZWQgPSBhcGkgJiYgYXBpLmdldEN1cnJlbnRUaW1lICYmIE1hdGgucm91bmQoYXBpLmdldEN1cnJlbnRUaW1lKCkpID49IE1hdGguZmxvb3IoYXBpLmdldER1cmF0aW9uKCkpOwogICAgICAgICAgICAgICAgICAgIG5leHRfY2xpY2tlZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCJ5dHAtYnV0dG9uLW5leHQiKSB8fCBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygieXRwLW5leHQtYnV0dG9uIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKCF1c2VyX3NldHRpbmdzLnBsQXBsICYmICFuZXh0X2NsaWNrZWQgJiYgaGFzX2VuZGVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRfYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnl0cC1uZXh0LWJ1dHRvbiIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dF9idXR0b24gJiYgbmV4dF9idXR0b24uZ2V0QXR0cmlidXRlKCJhcmlhLWRpc2FibGVkIikgPT09ICJ0cnVlIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dF9idXR0b24ub25jbGljayA9IGFwaS5uZXh0VmlkZW87CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGFwaS5uZXh0VmlkZW8pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dF9idXR0b24uc2V0QXR0cmlidXRlKCJhcmlhLWRpc2FibGVkIiwgImZhbHNlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5wbEFwbCB8fCBuZXh0X2NsaWNrZWQgfHwgIWhhc19lbmRlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dF9jbGlja2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW92aWVfcGxheWVyIikuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG1vZEFyZ3NXYXRjaChhcmdzKSB7CiAgICAgICAgICAgICAgICBpZiAoYXJncyAmJiBhcmdzLmF1dG9wbGF5ID09PSAiMSIgJiYgIXVzZXJfc2V0dGluZ3MuVklEX1BMUl9BVFBMICYmIHdpbmRvdy5sb2NhdGlvbi5oYXNoID09PSAiIikgewogICAgICAgICAgICAgICAgICAgIGFyZ3MuYXV0b3BsYXkgPSAiMCI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbW9kQXJnc1dhdGNoLm9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbW9kUGxheWVyQ3JlYXRlKG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaSwgdGVtcCwgcGxheWVyOwogICAgICAgICAgICAgICAgICAgIHRlbXAgPSBhLmlkIHx8IGE7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXAgIT09ICJwbGF5ZXItYXBpIiAmJiB0ZW1wICE9PSAidXBzZWxsLXZpZGVvIikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYiA9IG1vZEFyZ3MoYik7CiAgICAgICAgICAgICAgICAgICAgaWYgKGEuaWQgPT09ICJ1cHNlbGwtdmlkZW8iKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyX2luc3RhbmNlID0gb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IE9iamVjdC5rZXlzKHBsYXllcl9pbnN0YW5jZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0ZW1wLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwbGF5ZXJfaW5zdGFuY2VbdGVtcFtpXV0gPT09ICJvYmplY3QiICYmIHBsYXllcl9pbnN0YW5jZVt0ZW1wW2ldXSAmJiBwbGF5ZXJfaW5zdGFuY2VbdGVtcFtpXV0uaGFzTmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcl9pbnN0YW5jZVt0ZW1wW2ldXS5oYXNOZXh0ID0gbW9kQXV0b3BsYXlGdWxsc2NyZWVuKHBsYXllcl9pbnN0YW5jZVt0ZW1wW2ldXS5oYXNOZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW92aWVfcGxheWVyIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9QTFJfRklUKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNpemVQbGF5ZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbW9kU2Vla1RvKG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odGltZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCJmbG9hdGVyIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWwuY2FsbCh0aGlzLCB0aW1lLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHNjcmlwdEV4aXQoZXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciBpLCBqLCBrZXksIHRlbXA7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQgJiYgZXZlbnQudGFyZ2V0KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoIm5hbWUiKSA9PT0gInd3dy9iYXNlIikgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cueXQuc2V0Q29uZmlnID0gbW9kU2V0Q29uZmlnKHdpbmRvdy55dC5zZXRDb25maWcpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93Ll95dF93d3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBPYmplY3Qua2V5cyh3aW5kb3cuX3l0X3d3dyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gdGVtcC5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSB0ZW1wW2ldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93Ll95dF93d3dba2V5XSA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoU3RyaW5nKHdpbmRvdy5feXRfd3d3W2tleV0pLnNwbGl0KCJwbGF5ZXItYWRkZWQiKS5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuX3l0X3d3d1trZXldID0gbW9kRW1iZWQod2luZG93Ll95dF93d3dba2V5XSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoU3RyaW5nKHdpbmRvdy5feXRfd3d3W2tleV0pLnNwbGl0KCJ3aW5kb3cuc3BmLm5hdmlnYXRlIikubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Ll95dF93d3dba2V5XSA9IG1vZEF1dG9wbGF5KHdpbmRvdy5feXRfd3d3W2tleV0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaisrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFN0cmluZyh3aW5kb3cuX3l0X3d3d1trZXldKS5zcGxpdCgiLnNldChcIlwiK2EsYixjLFwiL1wiLGQiKS5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cueXRwc2V0d2lkZSA9IHdpbmRvdy5feXRfd3d3W2tleV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPT09IDMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKCJuYW1lIikgPT09ICJ3d3cvd2F0Y2giKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy55dC53d3cud2F0Y2gucGxheWVyLnNlZWtUbyA9IG1vZFNlZWtUbyh3aW5kb3cueXQud3d3LndhdGNoLnBsYXllci5zZWVrVG8pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgibmFtZSIpID09PSAic3BmL3NwZiIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNwZi5sb2FkID0gbW9kQ29tbWVudCh3aW5kb3cuc3BmLmxvYWQpOwogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc3BmLnByZWZldGNoID0gZnVuY3Rpb24oKXtyZXR1cm47fTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5uYW1lID09PSAicG9wT3V0IikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNwZi5uYXZpZ2F0ZSA9IGZ1bmN0aW9uKCl7cmV0dXJuO307CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoKGV2ZW50ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKCJuYW1lIikgPT09ICJwbGF5ZXIvYmFzZSIpIHx8ICghd2luZG93Lmh0bWw1UGF0Y2hlZCAmJiB3aW5kb3cueXQgJiYgd2luZG93Lnl0LnBsYXllciAmJiB3aW5kb3cueXQucGxheWVyLkFwcGxpY2F0aW9uICYmIHdpbmRvdy55dC5wbGF5ZXIuQXBwbGljYXRpb24uY3JlYXRlKSkgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5odG1sNVBhdGNoZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy55dC5wbGF5ZXIuQXBwbGljYXRpb24uY3JlYXRlID0gbW9kUGxheWVyQ3JlYXRlKHdpbmRvdy55dC5wbGF5ZXIuQXBwbGljYXRpb24uY3JlYXRlKTsKICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93Ll95dF9wbGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IE9iamVjdC5rZXlzKHdpbmRvdy5feXRfcGxheWVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHRlbXAubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5feXRfcGxheWVyW3RlbXBbaV1dID09PSAiZnVuY3Rpb24iICYmIHdpbmRvdy5feXRfcGxheWVyW3RlbXBbaV1dLnRvU3RyaW5nKCkubWF0Y2goInRoaXMuYWRhcHRpdmVGb3JtYXRzIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSB0ZW1wW2ldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZEFyZ3NXYXRjaC5vcmlnaW5hbCA9IHdpbmRvdy5feXRfcGxheWVyW2tleV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RBcmdzV2F0Y2gucHJvdG90eXBlID0gbW9kQXJnc1dhdGNoLm9yaWdpbmFsLnByb3RvdHlwZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBPYmplY3Qua2V5cyhtb2RBcmdzV2F0Y2gub3JpZ2luYWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHRlbXAubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZEFyZ3NXYXRjaFt0ZW1wW2ldXSA9IG1vZEFyZ3NXYXRjaC5vcmlnaW5hbFt0ZW1wW2ldXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5feXRfcGxheWVyW2tleV0gPSBtb2RBcmdzV2F0Y2g7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tCb3VuZHMoZWxtLCBYLCBZKSB7CiAgICAgICAgICAgICAgICB2YXIgc25hcFgsIHNuYXBZOwogICAgICAgICAgICAgICAgaWYgKFggPiAtMSAmJiBYICsgZWxtLm9mZnNldFdpZHRoIDwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm9mZnNldFdpZHRoKSB7CiAgICAgICAgICAgICAgICAgICAgc25hcFggPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoWCA8IDEpIHsKICAgICAgICAgICAgICAgICAgICBYID0gMDsKICAgICAgICAgICAgICAgICAgICBzbmFwWCA9IC0xOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBYID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm9mZnNldFdpZHRoIC0gZWxtLm9mZnNldFdpZHRoOwogICAgICAgICAgICAgICAgICAgIHNuYXBYID0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChZID4gNTAgJiYgWSArIGVsbS5vZmZzZXRIZWlnaHQgPCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub2Zmc2V0SGVpZ2h0KSB7CiAgICAgICAgICAgICAgICAgICAgc25hcFkgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoWSA8IDUxKSB7CiAgICAgICAgICAgICAgICAgICAgWSA9IDUwOwogICAgICAgICAgICAgICAgICAgIHNuYXBZID0gLTE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIFkgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub2Zmc2V0SGVpZ2h0IC0gZWxtLm9mZnNldEhlaWdodDsKICAgICAgICAgICAgICAgICAgICBzbmFwWSA9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4ge1g6IFggKyAicHgiLCBZOiBZICsgInB4Iiwgc25hcFg6IHNuYXBYLCBzbmFwWTogc25hcFl9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVBvcygpIHsKICAgICAgICAgICAgICAgIHZhciB4LCB5LCBoZWlnaHQsIHBsYXllciwgYm91bmRzOwogICAgICAgICAgICAgICAgcGxheWVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vdmllX3BsYXllciIpOwogICAgICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCJmbG9hdGVyIikgfHwgd2luZG93LmlubmVyV2lkdGggPCA2NTcpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocGxheWVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5yZW1vdmVBdHRyaWJ1dGUoInN0eWxlIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCJmbG9hdGVyIik7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHVwZGF0ZVBvcyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaGVpZ2h0ID0gcGFyc2VJbnQodXNlcl9zZXR0aW5ncy5WSURfUExSX0FMVklTX1dEVEgpIHx8IDM1MDsKICAgICAgICAgICAgICAgIHBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb3ZpZV9wbGF5ZXIiKTsKICAgICAgICAgICAgICAgIGJvdW5kcyA9IGNoZWNrQm91bmRzKHBsYXllciwgdXNlcl9zZXR0aW5ncy5mbG9hdGVyWCwgdXNlcl9zZXR0aW5ncy5mbG9hdGVyWSk7CiAgICAgICAgICAgICAgICBoZWlnaHQgPSAoaGVpZ2h0IDwgMzUwID8gMzUwIDogaGVpZ2h0KSAvICgxNiAvIDkpOwogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuZmxvYXRlclNuYXBYID09PSAtMSkgewogICAgICAgICAgICAgICAgICAgIHggPSAiMHB4IjsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodXNlcl9zZXR0aW5ncy5mbG9hdGVyU25hcFggPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICB4ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm9mZnNldFdpZHRoIC0gcGxheWVyLm9mZnNldFdpZHRoICsgInB4IjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgeCA9IGJvdW5kcy5YOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuZmxvYXRlclNuYXBZID09PSAtMSkgewogICAgICAgICAgICAgICAgICAgIHkgPSAiNTBweCI7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJfc2V0dGluZ3MuZmxvYXRlclNuYXBZID09PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgeSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vZmZzZXRIZWlnaHQgLSBwbGF5ZXIub2Zmc2V0SGVpZ2h0ICsgInB4IjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgeSA9IGJvdW5kcy5ZOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcGxheWVyLnNldEF0dHJpYnV0ZSgic3R5bGUiLCAid2lkdGg6IiArIChoZWlnaHQgKiAoMTYgLyA5KSkgKyAicHg7aGVpZ2h0OiIgKyBoZWlnaHQgKyAicHg7bGVmdDoiICsgeCArICI7dG9wOiIgKyB5KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnb1RvVG9wKCkgewogICAgICAgICAgICAgICAgZG9jdW1lbnRbKHdpbmRvdy5jaHJvbWUgJiYgImJvZHkiKSB8fCAiZG9jdW1lbnRFbGVtZW50Il0uc2Nyb2xsVG9wID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBkcmFnRmxvYXRlcihldmVudCkgewogICAgICAgICAgICAgICAgdmFyIGV4Y2x1ZGVkLCBpc0ZTY3JlZW4sIGlzRmxvYXRlciwgYm91bmRzLCBwbGF5ZXI7CiAgICAgICAgICAgICAgICBpc0ZTY3JlZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIueXRwLWZ1bGxzY3JlZW4iKTsKICAgICAgICAgICAgICAgIGlzRmxvYXRlciA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoImZsb2F0ZXIiKTsKICAgICAgICAgICAgICAgIGlmIChldmVudCAmJiAhaXNGU2NyZWVuICYmIGlzRmxvYXRlcikgewogICAgICAgICAgICAgICAgICAgIHBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb3ZpZV9wbGF5ZXIiKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuYnV0dG9ucyA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi55dHAtY2hyb21lLWJvdHRvbSIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gIm1vdXNlZG93biIgJiYgcGxheWVyLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiYgKCFleGNsdWRlZCB8fCAhZXhjbHVkZWQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIGRyYWdGbG9hdGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZHJhZ0Zsb2F0ZXIsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ0Zsb2F0ZXIub2xkUG9zID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFg6IHBhcnNlSW50KHBsYXllci5zdHlsZS5sZWZ0KSAtIGV2ZW50LmNsaWVudFgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWTogcGFyc2VJbnQocGxheWVyLnN0eWxlLnRvcCkgLSBldmVudC5jbGllbnRZLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZ1g6IGV2ZW50LmNsaWVudFgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JnWTogZXZlbnQuY2xpZW50WQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC50eXBlID09PSAibW91c2Vtb3ZlIiAmJiAoZHJhZ0Zsb2F0ZXIuaGFzTW92ZWQgfHwgTWF0aC5hYnMoZXZlbnQuY2xpZW50WCAtIGRyYWdGbG9hdGVyLm9sZFBvcy5vcmdYKSA+IDEwIHx8IE1hdGguYWJzKGV2ZW50LmNsaWVudFkgLSBkcmFnRmxvYXRlci5vbGRQb3Mub3JnWSkgPiAxMCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdW5kcyA9IGNoZWNrQm91bmRzKHBsYXllciwgZXZlbnQuY2xpZW50WCArIGRyYWdGbG9hdGVyLm9sZFBvcy5YLCBldmVudC5jbGllbnRZICsgZHJhZ0Zsb2F0ZXIub2xkUG9zLlkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnN0eWxlLmxlZnQgPSBib3VuZHMuWDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5zdHlsZS50b3AgPSBib3VuZHMuWTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdGbG9hdGVyLmhhc01vdmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdGbG9hdGVyLnNuYXBYID0gYm91bmRzLnNuYXBYOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ0Zsb2F0ZXIuc25hcFkgPSBib3VuZHMuc25hcFk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmJ1dHRvbnMgIT09IDEgfHwgZXZlbnQudHlwZSA9PT0gImNsaWNrIikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHJhZ0Zsb2F0ZXIuaGFzTW92ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdGbG9hdGVyLm9sZFBvcyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ0Zsb2F0ZXIuaGFzTW92ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJfc2V0dGluZ3MuZmxvYXRlclggPSBwYXJzZUludChwbGF5ZXIuc3R5bGUubGVmdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyX3NldHRpbmdzLmZsb2F0ZXJZID0gcGFyc2VJbnQocGxheWVyLnN0eWxlLnRvcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyX3NldHRpbmdzLmZsb2F0ZXJTbmFwWCA9IGRyYWdGbG9hdGVyLnNuYXBYOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9zZXR0aW5ncy5mbG9hdGVyU25hcFkgPSBkcmFnRmxvYXRlci5zbmFwWTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldCgidXNlcl9zZXR0aW5ncyIsIHVzZXJfc2V0dGluZ3MpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIGRyYWdGbG9hdGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBkcmFnRmxvYXRlciwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGluaUZsb2F0ZXIoKSB7CiAgICAgICAgICAgICAgICB2YXIgcGxheWVyLCBwbHJBcGksIG91dF9vZl9zaWdodCwgaXNGbG9hdGVyLCBpc0ZTY3JlZW4sIGZsb2F0ZXJVSSwgc2V0dGluZ3Nfb3BlbjsKICAgICAgICAgICAgICAgIHBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb3ZpZV9wbGF5ZXIiKTsKICAgICAgICAgICAgICAgIHBsckFwaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwbGF5ZXItYXBpIikuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgICAgICBzZXR0aW5nc19vcGVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlAtc2V0dGluZ3MiKTsKICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICBvdXRfb2Zfc2lnaHQgPSBwbHJBcGkuYm90dG9tIDwgKChwbHJBcGkuaGVpZ2h0IC8gMikgKyA1MCk7CiAgICAgICAgICAgICAgICAgICAgaXNGbG9hdGVyID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygiZmxvYXRlciIpOwogICAgICAgICAgICAgICAgICAgIGlzRlNjcmVlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi55dHAtZnVsbHNjcmVlbiIpOwogICAgICAgICAgICAgICAgICAgIGZsb2F0ZXJVSSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwYXJ0X2Zsb2F0ZXJ1aSIpOwogICAgICAgICAgICAgICAgICAgIGlmICghZmxvYXRlclVJICYmICFpc0ZTY3JlZW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRlclVJID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGVtcGxhdGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXRlclVJLmlubmVySFRNTCA9IC8vCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBpZD0ncGFydF9mbG9hdGVydWknPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9J3BhcnRfZmxvYXRlcnVpX21vdmUnIGRhdGEtcD0ndHRsfFZJRF9QTFJfQUxWSVNfTU9WRSc+PHN2ZyB2aWV3Qm94PScwIDAgMjAgMjAnPjxwb2x5Z29uIHBvaW50cz0nNi40LDMuNiA3LjIsNC4zIDEwLDEuNSAxMi44LDQuMyAxMy42LDMuNiAxMCwwJy8+PHBvbHlnb24gcG9pbnRzPScxNi40LDYuNCAxNS43LDcuMiAxOC41LDEwIDE1LjcsMTIuOCAxNi40LDEzLjYgMjAsMTAnLz48cG9seWdvbiBwb2ludHM9JzMuNiw2LjQgMCwxMCAzLjYsMTMuNiA0LjMsMTIuOCAxLjUsMTAgNC4zLDcuMicvPjxwb2x5Z29uIHBvaW50cz0nMTAsMTguNSA3LjIsMTUuNyA2LjQsMTYuNCAxMCwyMCAxMy42LDE2LjQgMTIuOCwxNS43Jy8+PGNpcmNsZSBjeD0nMTAnIGN5PScxMCcgcj0nMicvPjwvc3ZnPjwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9J3BhcnRfZmxvYXRlcnVpX3Njcm9sbHRvcCcgZGF0YS1wPSd0dGx8VklEX1BMUl9BTFZJU19TQ1JMX1RPUCc+PHN2ZyB2aWV3Qm94PScwIDAgMjAgMjAnPjxwb2x5Z29uIHBvaW50cz0nMTAsMC4xIDAsMTAuMSAyLjksMTIuOSAxMCw1LjggMTcuMSwxMi45IDIwLDEwLjEgJy8+PC9zdmc+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgICAgICBmbG9hdGVyVUkgPSBzZXRMb2NhbGUoZmxvYXRlclVJLmNvbnRlbnQpLmZpcnN0Q2hpbGQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllci5hcHBlbmRDaGlsZChmbG9hdGVyVUkpOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFydF9mbG9hdGVydWlfbW92ZSIpLmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIGRyYWdGbG9hdGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBhcnRfZmxvYXRlcnVpX3Njcm9sbHRvcCIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZ29Ub1RvcCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChvdXRfb2Zfc2lnaHQgJiYgIWlzRmxvYXRlciAmJiAhc2V0dGluZ3Nfb3BlbikgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgiZmxvYXRlciIpOwogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdXBkYXRlUG9zKTsKICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlUG9zKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgicmVzaXplIikpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKCFvdXRfb2Zfc2lnaHQgfHwgc2V0dGluZ3Nfb3BlbikgJiYgaXNGbG9hdGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCJmbG9hdGVyIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJyZXNpemUiLCB1cGRhdGVQb3MpOwogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIucmVtb3ZlQXR0cmlidXRlKCJzdHlsZSIpOwogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoInJlc2l6ZSIpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gYWx3YXlzVmlzaWJsZSgpIHsKICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9QTFJfQUxWSVMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAiL3dhdGNoIikgewogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigic2Nyb2xsIiwgaW5pRmxvYXRlcik7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgIT09ICIvd2F0Y2giKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJzY3JvbGwiLCBpbmlGbG9hdGVyKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gYWx3YXlzQWN0aXZlKGV2ZW50KSB7CiAgICAgICAgICAgICAgICB2YXIgaSwgbGlzdCwgY2xlYXIsIGxlbmd0aCwgZXZlbnRDbG9uZTsKICAgICAgICAgICAgICAgIGNsZWFyID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09ICIvd2F0Y2giICYmIGFwaSAmJiBhcGkgIT09IGV2ZW50LnRhcmdldCAmJiAhYXBpLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiYgIWV2ZW50LmN0cmxLZXkgJiYgIWV2ZW50LnNoaWZ0S2V5ICYmICFldmVudC5hbHRLZXkgJiYgIWV2ZW50Lm1ldGFLZXkgJiYgIWV2ZW50LnRhcmdldC5pc0NvbnRlbnRFZGl0YWJsZTsKICAgICAgICAgICAgICAgIGlmIChjbGVhciAmJiAoKGV2ZW50LndoaWNoID4gNDcgJiYgZXZlbnQud2hpY2ggPCA1OCkgfHwgKGV2ZW50LndoaWNoID4gOTUgJiYgZXZlbnQud2hpY2ggPCAxMDYpIHx8IFsyNywgMzIsIDM1LCAzNiwgMzcsIDM4LCAzOSwgNDAsIDY2LCA2NywgNzksIDg3LCAxODcsIDE4OV0uaW5kZXhPZihldmVudC53aGljaCkgPiAtMSkgJiYgWyJFTUJFRCIsICJJTlBVVCIsICJPQkpFQ1QiLCAiVEVYVEFSRUEiLCAiSUZSQU1FIl0uaW5kZXhPZihkb2N1bWVudC5hY3RpdmVFbGVtZW50LnRhZ05hbWUpIDwgMCkgewogICAgICAgICAgICAgICAgICAgIGV2ZW50Q2xvbmUgPSBuZXcgRXZlbnQoImtleWRvd24iKTsKICAgICAgICAgICAgICAgICAgICBsaXN0ID0gT2JqZWN0LmtleXMoT2JqZWN0LmdldFByb3RvdHlwZU9mKGV2ZW50KSk7CiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gbGlzdC5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50Q2xvbmVbbGlzdFtpXV0gPSBldmVudFtsaXN0W2ldXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICAgICBhcGkuZGlzcGF0Y2hFdmVudChldmVudENsb25lKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBwbGF5ZXJTdGF0ZShldmVudCkgewogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuZnVsbEJycyB8fCB1c2VyX3NldHRpbmdzLmxpZ2h0c091dCkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3RbKGV2ZW50IDwgNSAmJiBldmVudCA+IDAgJiYgImFkZCIpIHx8ICJyZW1vdmUiXSgodXNlcl9zZXR0aW5ncy5mdWxsQnJzICYmICJwYXJ0X2Z1bGxicm93c2VyIikgfHwgIjAiLCAodXNlcl9zZXR0aW5ncy5saWdodHNPdXQgJiYgInBhcnRfY2luZW1hX21vZGUiKSB8fCAiMCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCJyZXNpemUiKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlQ3VzdG9tcyhldmVudCkgewogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBldmVudCA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgICAgICAgICAgICBzZXQoInZvbExldiIsIGV2ZW50LnZvbHVtZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNldCgidGhlYXRlck1vZGUiLCBldmVudCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gcGxheWVyUmVhZHkoKSB7CiAgICAgICAgICAgICAgICBhcGkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibW92aWVfcGxheWVyIik7CiAgICAgICAgICAgICAgICBpZiAoYXBpICYmICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYzQtcGxheWVyIikpIHsKICAgICAgICAgICAgICAgICAgICBhcGkuYWRkRXZlbnRMaXN0ZW5lcigib25TdGF0ZUNoYW5nZSIsIHBsYXllclN0YXRlKTsKICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfUExSX1ZPTF9NRU0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmFkZEV2ZW50TGlzdGVuZXIoIm9uVm9sdW1lQ2hhbmdlIiwgaGFuZGxlQ3VzdG9tcyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9QTFJfU0laRV9NRU0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmFkZEV2ZW50TGlzdGVuZXIoIlNJWkVfQ0xJQ0tFRCIsIGhhbmRsZUN1c3RvbXMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfUExSX1ZPTF9NRU0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXBpLnNldFZvbHVtZSh1c2VyX3NldHRpbmdzLnZvbExldik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLmxvb3BWaWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigidmlkZW8iKS5sb29wID0gdXNlcl9zZXR0aW5ncy5sb29wVmlkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfUExSX0FMQUNUKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCBhbHdheXNBY3RpdmUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRUaHVtYigpIHsKICAgICAgICAgICAgICAgIHZhciBhcmdzLCBiYXNlLCB0aHVtYl91cmw7CiAgICAgICAgICAgICAgICBhcmdzID0gd2luZG93Lnl0cGxheWVyLmNvbmZpZy5hcmdzOwogICAgICAgICAgICAgICAgYmFzZSA9IChhcmdzLml1cmxfd2VicCAmJiAiX3dlYnAiKSB8fCAiIjsKICAgICAgICAgICAgICAgIHRodW1iX3VybCA9IGFyZ3NbIml1cmxtYXhyZXMiICsgYmFzZV0gfHwgYXJnc1siaXVybHNkIiArIGJhc2VdIHx8IGFyZ3NbIml1cmwiICsgYmFzZV07CiAgICAgICAgICAgICAgICB3aW5kb3cub3Blbih0aHVtYl91cmwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZGVTY3JlZW5zaG90KGV2ZW50KSB7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmlkID09PSAiY2xvc2Utc2NyZWVuc2hvdCIpIHsKICAgICAgICAgICAgICAgICAgICBldmVudC50YXJnZXQucGFyZW50Tm9kZS5vdXRlckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsIGhpZGVTY3JlZW5zaG90KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRTY3JlZW5zaG90KCkgewogICAgICAgICAgICAgICAgdmFyIHdpZHRoLCBoZWlnaHQsIGFzcGVjdFJhdGlvLCB2aWRlbywgY29udGFpbmVyLCBjYW52YXMsIGNsb3NlLCBjb250ZXh0OwogICAgICAgICAgICAgICAgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJ2aWRlbyIpOwogICAgICAgICAgICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNjcmVlbnNob3QtcmVzdWx0IikgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICAgICAgICBjYW52YXMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcigiY2FudmFzIikgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgICAgICAgICBhc3BlY3RSYXRpbyA9IHZpZGVvLnZpZGVvV2lkdGggLyB2aWRlby52aWRlb0hlaWdodDsKICAgICAgICAgICAgICAgIHdpZHRoID0gdmlkZW8udmlkZW9XaWR0aDsKICAgICAgICAgICAgICAgIGhlaWdodCA9IHBhcnNlSW50KHdpZHRoIC8gYXNwZWN0UmF0aW8sIDEwKTsKICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoOwogICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGhlaWdodDsKICAgICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKHZpZGVvLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgICAgICAgICAgIGlmICghY29udGFpbmVyLmlkKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmlkID0gInNjcmVlbnNob3QtcmVzdWx0IjsKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY2FudmFzKTsKICAgICAgICAgICAgICAgICAgICBjbG9zZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgICAgICAgIGNsb3NlLmlkID0gImNsb3NlLXNjcmVlbnNob3QiOwogICAgICAgICAgICAgICAgICAgIGNsb3NlLnRleHRDb250ZW50ID0gbGFuZygiQ05TTF9TU19DTFMiKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGhpZGVTY3JlZW5zaG90KTsKICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY2xvc2UpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBleGl0RnVsbEJyb3dzZXIoa2V5KSB7CiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygicGFydF9mdWxsYnJvd3NlciIpICYmIChrZXkua2V5Q29kZSA9PT0gMjcgfHwga2V5LmtleSA9PT0gIkVzY2FwZSIgfHwgKGtleS50YXJnZXQuY2xhc3NOYW1lICYmIGtleS50YXJnZXQuY2xhc3NOYW1lLnNwbGl0KCJ5dHAtc2l6ZSIpLmxlbmd0aCA+IDEpKSkgewogICAgICAgICAgICAgICAgICAgIHRvZ2dsZUZ1bGxCcm93c2VyKGtleSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGtleS50eXBlID09PSAibW91c2Vkb3duIikgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgZXhpdEZ1bGxCcm93c2VyKTsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgZXhpdEZ1bGxCcm93c2VyKTsKICAgICAgICAgICAgICAgICAgICAgICAga2V5LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRvZ2dsZUZ1bGxCcm93c2VyKGV2ZW50KSB7CiAgICAgICAgICAgICAgICB2YXIgcGxyU3RhdGUgPSBhcGkgJiYgYXBpLmdldFBsYXllclN0YXRlICYmIGFwaS5nZXRQbGF5ZXJTdGF0ZSgpOwogICAgICAgICAgICAgICAgcGxyU3RhdGUgPSBwbHJTdGF0ZSA8IDUgJiYgcGxyU3RhdGUgPiAwOwogICAgICAgICAgICAgICAgZG9jdW1lbnRbKHdpbmRvdy5jaHJvbWUgJiYgImJvZHkiKSB8fCAiZG9jdW1lbnRFbGVtZW50Il0uc2Nyb2xsVG9wID0gMDsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLCBleGl0RnVsbEJyb3dzZXIpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2Vkb3duIiwgZXhpdEZ1bGxCcm93c2VyKTsKICAgICAgICAgICAgICAgIHNldCgiZnVsbEJycyIsIGV2ZW50ID8gIXVzZXJfc2V0dGluZ3MuZnVsbEJycyA6IHRydWUpOwogICAgICAgICAgICAgICAgYWR2YW5jZWRPcHRpb25zLmZ1bGxfYnJvd3Nlci5jbGFzc0xpc3RbKHVzZXJfc2V0dGluZ3MuZnVsbEJycyAmJiAiYWRkIikgfHwgInJlbW92ZSJdKCJhY3RpdmUiKTsKICAgICAgICAgICAgICAgIGlmIChldmVudCAmJiAocGxyU3RhdGUgfHwgZXZlbnQua2V5Q29kZSA9PT0gMjcgfHwgZXZlbnQua2V5ID09PSAiRXNjYXBlIikpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0Wyh1c2VyX3NldHRpbmdzLmZ1bGxCcnMgJiYgImFkZCIpIHx8ICJyZW1vdmUiXSgicGFydF9mdWxsYnJvd3NlciIpOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgicmVzaXplIikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVNob3J0Y3V0cygpIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKCJodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvWW91VHViZS1zaG9ydGN1dHMiLCAiX2JsYW5rIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdG9nZ2xlQ29uc29sZShldmVudCkgewogICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5pZCA9PT0gImNvbnNvbGUtYnV0dG9uIikgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCJwbGF5ZXItY29uc29sZSIpOwogICAgICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3RbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygicGxheWVyLWNvbnNvbGUiKSA/ICJhZGQiIDogInJlbW92ZSJdKCJjbG9zZSIpOwogICAgICAgICAgICAgICAgICAgIHNldCgiYWR2T3B0cyIsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoInBsYXllci1jb25zb2xlIikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVBsYXkoKSB7CiAgICAgICAgICAgICAgICBzZXQoIlZJRF9QTFJfQVRQTCIsICF1c2VyX3NldHRpbmdzLlZJRF9QTFJfQVRQTCk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0Wyh1c2VyX3NldHRpbmdzLlZJRF9QTFJfQVRQTCAmJiAiYWRkIikgfHwgInJlbW92ZSJdKCJwYXJ0X2F1dG9wbGF5b24iKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhdXRvcGxheS1idXR0b24iKS5jbGFzc0xpc3RbKHVzZXJfc2V0dGluZ3MuVklEX1BMUl9BVFBMICYmICJhZGQiKSB8fCAicmVtb3ZlIl0oImFjdGl2ZSIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRvZ2dsZUxvb3AoZXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciB2aWRlb1BsYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoInZpZGVvIik7CiAgICAgICAgICAgICAgICBpZiAodmlkZW9QbGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICB2aWRlb1BsYXllci5sb29wID0gZXZlbnQgPyAhdXNlcl9zZXR0aW5ncy5sb29wVmlkIDogdXNlcl9zZXR0aW5ncy5sb29wVmlkOwogICAgICAgICAgICAgICAgICAgIGlmIChldmVudCkgewogICAgICAgICAgICAgICAgICAgICAgICBhZHZhbmNlZE9wdGlvbnMubG9vcF9idXR0b24uY2xhc3NMaXN0WyghdXNlcl9zZXR0aW5ncy5sb29wVmlkICYmICJhZGQiKSB8fCAicmVtb3ZlIl0oImFjdGl2ZSIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNldCgibG9vcFZpZCIsIGFkdmFuY2VkT3B0aW9ucy5sb29wX2J1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoImFjdGl2ZSIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVDaW5lbWFNb2RlKGV2ZW50KSB7CiAgICAgICAgICAgICAgICB2YXIgcGxyU3RhdGUgPSBhcGkgJiYgYXBpLmdldFBsYXllclN0YXRlICYmIGFwaS5nZXRQbGF5ZXJTdGF0ZSgpIDwgNSAmJiBhcGkuZ2V0UGxheWVyU3RhdGUoKSA+IDA7CiAgICAgICAgICAgICAgICBzZXQoImxpZ2h0c091dCIsIGV2ZW50ID8gIXVzZXJfc2V0dGluZ3MubGlnaHRzT3V0IDogdHJ1ZSk7CiAgICAgICAgICAgICAgICBhZHZhbmNlZE9wdGlvbnMuY2luZW1hX21vZGUuY2xhc3NMaXN0Wyh1c2VyX3NldHRpbmdzLmxpZ2h0c091dCAmJiAiYWRkIikgfHwgInJlbW92ZSJdKCJhY3RpdmUiKTsKICAgICAgICAgICAgICAgIGlmIChldmVudCAmJiBwbHJTdGF0ZSkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3RbKHVzZXJfc2V0dGluZ3MubGlnaHRzT3V0ICYmICJhZGQiKSB8fCAicmVtb3ZlIl0oInBhcnRfY2luZW1hX21vZGUiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVUb2dnbGVzKGV2ZW50KSB7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LmRhdGFzZXQgJiYgZXZlbnQudGFyZ2V0LmRhdGFzZXQuYWN0aW9uICYmIGFkdmFuY2VkT3B0aW9ucy5hY3Rpb25zW2V2ZW50LnRhcmdldC5kYXRhc2V0LmFjdGlvbl0pIHsKICAgICAgICAgICAgICAgICAgICBhZHZhbmNlZE9wdGlvbnMuYWN0aW9uc1tldmVudC50YXJnZXQuZGF0YXNldC5hY3Rpb25dKGV2ZW50KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBob29rQnV0dG9ucygpIHsKICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5wb3BQbGF5ZXIgPSBwb3BQbGF5ZXI7CiAgICAgICAgICAgICAgICBhZHZhbmNlZE9wdGlvbnMuZnVsbF9icm93c2VyID0gYWR2YW5jZWRPcHRpb25zLmNvbnRyb2xzLnF1ZXJ5U2VsZWN0b3IoIiNmdWxsYnJvd3Nlci1idXR0b24iKTsKICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5jaW5lbWFfbW9kZSA9IGFkdmFuY2VkT3B0aW9ucy5jb250cm9scy5xdWVyeVNlbGVjdG9yKCIjY2luZW1hbW9kZS1idXR0b24iKTsKICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5sb29wX2J1dHRvbiA9IGFkdmFuY2VkT3B0aW9ucy5jb250cm9scy5xdWVyeVNlbGVjdG9yKCIjbG9vcC1idXR0b24iKTsKICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5hY3Rpb25zID0gewogICAgICAgICAgICAgICAgICAgIHRvZ2dsZVBsYXk6IHRvZ2dsZVBsYXksCiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlTG9vcDogdG9nZ2xlTG9vcCwKICAgICAgICAgICAgICAgICAgICBnZXRUaHVtYjogZ2V0VGh1bWIsCiAgICAgICAgICAgICAgICAgICAgZ2V0U2NyZWVuc2hvdDogZ2V0U2NyZWVuc2hvdCwKICAgICAgICAgICAgICAgICAgICBwb3BQbGF5ZXI6IHBvcFBsYXllciwKICAgICAgICAgICAgICAgICAgICB0b2dnbGVGdWxsQnJvd3NlcjogdG9nZ2xlRnVsbEJyb3dzZXIsCiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2luZW1hTW9kZTogdG9nZ2xlQ2luZW1hTW9kZSwKICAgICAgICAgICAgICAgICAgICB0b2dnbGVTaG9ydGN1dHM6IHRvZ2dsZVNob3J0Y3V0cwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgaGFuZGxlVG9nZ2xlcyk7CiAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5sb29wVmlkICYmICFhZHZhbmNlZE9wdGlvbnMubG9vcF9idXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCJhY3RpdmUiKSkgewogICAgICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5sb29wX2J1dHRvbi5jbGFzc0xpc3QuYWRkKCJhY3RpdmUiKTsKICAgICAgICAgICAgICAgICAgICB0b2dnbGVMb29wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5mdWxsQnJzICYmICFhZHZhbmNlZE9wdGlvbnMuZnVsbF9icm93c2VyLmNsYXNzTGlzdC5jb250YWlucygiYWN0aXZlIikpIHsKICAgICAgICAgICAgICAgICAgICBhZHZhbmNlZE9wdGlvbnMuZnVsbF9icm93c2VyLmNsYXNzTGlzdC5hZGQoImFjdGl2ZSIpOwogICAgICAgICAgICAgICAgICAgIHRvZ2dsZUZ1bGxCcm93c2VyKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5saWdodHNPdXQgJiYgIWFkdmFuY2VkT3B0aW9ucy5jaW5lbWFfbW9kZS5jbGFzc0xpc3QuY29udGFpbnMoImFjdGl2ZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgYWR2YW5jZWRPcHRpb25zLmNpbmVtYV9tb2RlLmNsYXNzTGlzdC5hZGQoImFjdGl2ZSIpOwogICAgICAgICAgICAgICAgICAgIHRvZ2dsZUNpbmVtYU1vZGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBhZHZhbmNlZE9wdGlvbnMoKSB7CiAgICAgICAgICAgICAgICB2YXIgaGVhZGVyLCBjbnNsQnRuLCBjbnNsQ29udDsKICAgICAgICAgICAgICAgIGhlYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ3YXRjaC1oZWFkZXIiKTsKICAgICAgICAgICAgICAgIGNuc2xCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29uc29sZS1idXR0b24iKTsKICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5jb250cm9scyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwbGF5ZXItY29uc29sZSIpOwogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PT0gIi93YXRjaCIgJiYgaGVhZGVyICYmICFjbnNsQnRuKSB7CiAgICAgICAgICAgICAgICAgICAgY25zbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICAgICAgY25zbEJ0bi5pbm5lckhUTUwgPSAvLwogICAgICAgICAgICAgICAgICAgICAgICBgPGJ1dHRvbiBpZD0nY29uc29sZS1idXR0b24nIGRhdGEtcD0ndHRsfEFEVl9PUFRTJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgY2xhc3M9J2Nsb3NlJyB2aWV3Qm94PScwIDAgMTAgMTAnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwb2x5Z29uIHBvaW50cz0nMTAsMS40IDguNiwwIDUsMy42IDEuNCwwIDAsMS40IDMuNiw1IDAsOC42IDEuNCwxMCA1LDYuNCA4LjYsMTAgMTAsOC42IDYuNCw1Jy8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgY2xhc3M9J29wZW4nIHZpZXdCb3g9JzAgMCAxMiAxMCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3Qgd2lkdGg9JzEyJyBoZWlnaHQ9JzInLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cmVjdCB3aWR0aD0nMTInIGhlaWdodD0nMicgeT0nNCcvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxyZWN0IHdpZHRoPScxMicgaGVpZ2h0PScyJyB5PSc4Jy8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+YDsKICAgICAgICAgICAgICAgICAgICBjbnNsQnRuID0gc2V0TG9jYWxlKGNuc2xCdG4uY29udGVudCkuZmlyc3RDaGlsZDsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHRvZ2dsZUNvbnNvbGUpOwogICAgICAgICAgICAgICAgICAgIGNuc2xDb250ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGVtcGxhdGUiKTsKICAgICAgICAgICAgICAgICAgICBjbnNsQ29udC5pbm5lckhUTUwgPSAiPGRpdiBpZD0nYWR2YW5jZWQtb3B0aW9ucyc+PC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICBjbnNsQ29udCA9IGNuc2xDb250LmNvbnRlbnQuZmlyc3RDaGlsZDsKICAgICAgICAgICAgICAgICAgICBjbnNsQ29udC5hcHBlbmRDaGlsZChjbnNsQnRuKTsKICAgICAgICAgICAgICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQoY25zbENvbnQpOwogICAgICAgICAgICAgICAgICAgIGlmIChhZHZhbmNlZE9wdGlvbnMuY29udHJvbHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWR2YW5jZWRPcHRpb25zLmNvbnRyb2xzLm91dGVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBhZHZhbmNlZE9wdGlvbnMuY29udHJvbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIpOwogICAgICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5jb250cm9scy5pbm5lckhUTUwgPSAvLwogICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBpZD0ncGxheWVyLWNvbnNvbGUnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nYXV0b3BsYXktYnV0dG9uJyBjbGFzcz0neXQtdWl4LXRvb2x0aXAnIGRhdGEtcD0ndHRwfENOU0xfQVAnIGRhdGEtYWN0aW9uPSd0b2dnbGVQbGF5Jz48c3ZnIHZpZXdCb3g9JzAgMCAxNCAxNic+PHBvbHlnb24gcG9pbnRzPScwLDE2IDE0LDggMCwwJy8+PC9zdmc+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSdsb29wLWJ1dHRvbicgY2xhc3M9J3l0LXVpeC10b29sdGlwJyBkYXRhLXA9J3R0cHxDTlNMX1JQVCcgZGF0YS1hY3Rpb249J3RvZ2dsZUxvb3AnPjxzdmcgdmlld0JveD0nMCAwIDIwLjUgMTgnPjxwYXRoIGQ9J00xMS41LDBDOSwwLDYuOCwxLDUuMSwyLjZsMS40LDEuNEM3LjgsMi44LDkuNiwyLDExLjUsMmMzLjksMCw3LDMuMSw3LDdjMCwzLjktMy4xLDctNyw3cy03LTMuMS03LTdIN0wzLjUsNEwwLDkgaDIuNWMwLDUsNCw5LDksOXM5LTQsOS05QzIwLjUsNCwxNi41LDAsMTEuNSwweicvPjwvc3ZnPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nc2F2ZS10aHVtYm5haWwtYnV0dG9uJyBjbGFzcz0neXQtdWl4LXRvb2x0aXAnIGRhdGEtcD0ndHRwfENOU0xfU1ZUSCcgZGF0YS1hY3Rpb249J2dldFRodW1iJz48c3ZnIHZpZXdCb3g9JzAgMCAyNCAxOCc+PHBhdGggZD0nTTAsMHYxOGgyNFYwSDB6IE0yMiwxNkgyVjJoMjBWMTZ6Jy8+PGNpcmNsZSBjeD0nOCcgY3k9JzYnIHI9JzMnLz48cG9seWdvbiBwb2ludHM9JzMsMTIgNiwxMCA5LDEyIDEwLDEyIDE2LDYgMjEsMTEgMjEsMTUgMywxNScvPjwvc3ZnPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nc2NyZWVuc2hvdC1idXR0b24nIGNsYXNzPSd5dC11aXgtdG9vbHRpcCcgZGF0YS1wPSd0dHB8Q05TTF9TUycgZGF0YS1hY3Rpb249J2dldFNjcmVlbnNob3QnPjxzdmcgdmlld0JveD0nMCAwIDIyIDE4Jz48cGF0aCBkPSdNMTcuNyw0bC0yLjMtNGgtOUw0LjEsNEgwdjE0aDIyVjRIMTcuN3ogTTExLDE1Yy0yLjgsMC01LTIuMi01LTVzMi4yLTUsNS01czUsMi4yLDUsNVMxMy44LDE1LDExLDE1eicvPjxjaXJjbGUgY3g9JzExJyBjeT0nMTAnIHI9JzQnLz48L3N2Zz48L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9J3BvcG91dC1idXR0b24nIGNsYXNzPSd5dC11aXgtdG9vbHRpcCcgZGF0YS1wPSd0dHB8Q05TTF9QUE9UJyBkYXRhLWFjdGlvbj0ncG9wUGxheWVyJz48c3ZnIHZpZXdCb3g9JzAgMCAyMiAxNic+PHBhdGggZD0nTTYsMHYxMmgxNlYwSDZ6IE0yMCwxMEg4VjJoMTJWMTB6Jy8+PHBvbHlnb24gcG9pbnRzPScxNCwxNCAyLDE0IDIsNiA1LDYgNSw0IDAsNCAwLDE2IDE2LDE2IDE2LDEzIDE0LDEzJy8+PC9zdmc+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSdmdWxsYnJvd3Nlci1idXR0b24nIGNsYXNzPSd5dC11aXgtdG9vbHRpcCcgZGF0YS1wPSd0dHB8Q05TTF9GTEJSJyBkYXRhLWFjdGlvbj0ndG9nZ2xlRnVsbEJyb3dzZXInPjxzdmcgdmlld0JveD0nMCAwIDIwIDE4Jz48cGF0aCBkPSdNMCwwdjE4aDIwVjBIMHogTTE4LDE2SDJWNGgxNlYxNnonLz48cG9seWdvbiBwb2ludHM9JzMsNSAzLDkgNSw5IDUsNyA3LDcgNyw1Jy8+PHBvbHlnb24gcG9pbnRzPScxNyw1IDEzLDUgMTMsNyAxNSw3IDE1LDkgMTcsOScvPjxwb2x5Z29uIHBvaW50cz0nMTcsMTUgMTcsMTEgMTUsMTEgMTUsMTMgMTMsMTMgMTMsMTUnLz48cG9seWdvbiBwb2ludHM9JzMsMTUgNywxNSA3LDEzIDUsMTMgNSwxMSAzLDExJy8+PC9zdmc+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSdjaW5lbWFtb2RlLWJ1dHRvbicgY2xhc3M9J3l0LXVpeC10b29sdGlwJyBkYXRhLXA9J3R0cHxDTlNMX0NJTk1fTUQnIGRhdGEtYWN0aW9uPSd0b2dnbGVDaW5lbWFNb2RlJz48c3ZnIHZpZXdCb3g9JzAgMCAyMCAxOCc+PHBhdGggZD0nTTE4LDB2MmgtMlYwSDR2MkgyVjBIMHYxOGgydi0yaDJ2MmgxMnYtMmgydjJoMlYwSDE4eiBNNCwxNEgydi0yaDJWMTR6IE00LDEwSDJWOGgyVjEweiBNNCw2SDJWNGgyVjZ6IE0xNCwxNiBINnYtNmg4VjE2eiBNMTQsOEg2VjJoOFY4eiBNMTgsMTRoLTJ2LTJoMlYxNHogTTE4LDEwaC0yVjhoMlYxMHogTTE4LDZoLTJWNGgyVjZ6Jy8+PC9zdmc+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSdzaG9ydGN1dHMtYnV0dG9uJyBjbGFzcz0neXQtdWl4LXRvb2x0aXAnIGRhdGEtcD0ndHRwfENOU0xfWVRTQycgZGF0YS1hY3Rpb249J3RvZ2dsZVNob3J0Y3V0cyc+PHN2ZyB2aWV3Qm94PScwIDAgMTggMTgnPjxwb2x5Z29uIHBvaW50cz0nNyw4IDEwLDggMTAsMTMgMTEsMTMgMTEsMTQgNywxNCA3LDEzIDgsMTMgOCw5IDcsOScvPjxyZWN0IHg9JzgnIHk9JzQnIHdpZHRoPScyJyBoZWlnaHQ9JzInLz48cGF0aCBkPSdNOSwwQzQsMCwwLDQsMCw5YzAsNSw0LDksOSw5czktNCw5LTlDMTgsNCwxNCwwLDksMHogTTksMTYuMWMtMy45LDAtNy4xLTMuMi03LjEtNy4xUzUuMSwxLjksOSwxLjkgczcuMSwzLjIsNy4xLDcuMVMxMi45LDE2LjEsOSwxNi4xeicvPjwvc3ZnPjwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9QTFJfQVRQTCkgewogICAgICAgICAgICAgICAgICAgICAgICBhZHZhbmNlZE9wdGlvbnMuY29udHJvbHMuY29udGVudC5xdWVyeVNlbGVjdG9yKCIjYXV0b3BsYXktYnV0dG9uIikuY2xhc3NMaXN0LmFkZCgiYWN0aXZlIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucy5jb250cm9scyA9IHNldExvY2FsZShhZHZhbmNlZE9wdGlvbnMuY29udHJvbHMuY29udGVudCkuZmlyc3RDaGlsZDsKICAgICAgICAgICAgICAgICAgICBjbnNsQ29udC5hcHBlbmRDaGlsZChhZHZhbmNlZE9wdGlvbnMuY29udHJvbHMpOwogICAgICAgICAgICAgICAgICAgIGhvb2tCdXR0b25zKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuYWR2T3B0cykgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgicGxheWVyLWNvbnNvbGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgY25zbEJ0bi5jbGFzc0xpc3QuYWRkKCJjbG9zZSIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBpbmlBY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciBvYnNlcnZlciwgbG9hZF9tb3JlLCBjbGlja190aXRsZTsKICAgICAgICAgICAgICAgIGxvYWRfbW9yZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiN3YXRjaC1tb3JlLXJlbGF0ZWQsIC5sb2FkLW1vcmUtYnV0dG9uIik7CiAgICAgICAgICAgICAgICBjbGlja190aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi55dC11aXgtdGlsZSIpOwogICAgICAgICAgICAgICAgd2hpbGUgKGNsaWNrX3RpdGxlKSB7CiAgICAgICAgICAgICAgICAgICAgY2xpY2tfdGl0bGUuY2xhc3NMaXN0LnJlbW92ZSgieXQtdWl4LXRpbGUiKTsKICAgICAgICAgICAgICAgICAgICBjbGlja190aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi55dC11aXgtdGlsZSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGxvYWRfbW9yZSAmJiAhbG9hZF9tb3JlLmNsYXNzTGlzdC5jb250YWlucygibW9kVGh1bWJzIikpIHsKICAgICAgICAgICAgICAgICAgICBsb2FkX21vcmUuY2xhc3NMaXN0LmFkZCgibW9kVGh1bWJzIik7CiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihtb2RUaHVtYnMpOwogICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUobG9hZF9tb3JlLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlT2xkVmFsdWU6IHRydWUKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChldmVudCAmJiAvcG9wb3V0bW9kZXxibGFja2xpc3QvLnRlc3QoZXZlbnQudGFyZ2V0LmNsYXNzTmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnQudGFyZ2V0OwogICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5jbGFzc0xpc3QuY29udGFpbnMoInBvcG91dG1vZGUiKSkgewogICAgICAgICAgICAgICAgICAgICAgICBwb3BQbGF5ZXIoZXZlbnQuZGF0YXNldC5saW5rKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmRhdGFzZXQueXRpZCAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXNlcl9zZXR0aW5ncy5ibGFja2xpc3RbZXZlbnQuZGF0YXNldC55dGlkXSA9IGV2ZW50LmRhdGFzZXQudXNlcjsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0KCJibGFja2xpc3QiLCB1c2VyX3NldHRpbmdzLmJsYWNrbGlzdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG1vZFRodW1icygpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBzZXRCdXR0b25zKCkgewogICAgICAgICAgICAgICAgdmFyIGksIGosIGxpc3QsIHRlbXAsIHRodW1iLCBidXR0b247CiAgICAgICAgICAgICAgICBsaXN0ID0gT2JqZWN0LmtleXMobW9kVGh1bWJzLnRodW1icyk7CiAgICAgICAgICAgICAgICBpID0gbGlzdC5sZW5ndGg7CiAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IG1vZFRodW1icy50aHVtYnNbbGlzdFtpXV07CiAgICAgICAgICAgICAgICAgICAgaiA9IHRlbXAubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIHdoaWxlIChqLS0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWIgPSB0ZW1wW2pdLnF1ZXJ5U2VsZWN0b3IoIi55dC1sb2NrdXAtdGh1bWJuYWlsLCAudGh1bWItd3JhcHBlciIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGh1bWIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLkdFTl9QUE9UX09OICYmICF0aHVtYi5xdWVyeVNlbGVjdG9yKCIucG9wb3V0bW9kZSIpICYmICEvY2hhbm5lbC8udGVzdCh0ZW1wW2pdLmZpcnN0Q2hpbGQuY2xhc3NOYW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9IC8vCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGRhdGEtcD0ndHRsfFBQT1RfT1BFTiZ0dHB8UFBPVF9PUEVOJyBjbGFzcz0neXQtdWl4LXRvb2x0aXAgcG9wb3V0bW9kZSc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHZpZXdCb3g9JzAgMCAxMCAxMCcgY2xhc3M9J3RodW1iLXN2Zyc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBvbHlnb24gcG9pbnRzPSc3LDkgMSw5IDEsNCAzLDQgMywyIDAsMiAwLDEwIDgsMTAgOCw3IDcsNycvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9J000LDB2Nmg2VjBINHogTTksNUg1VjJoNFY1eicvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zdmc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmNvbnRlbnQuZmlyc3RDaGlsZC5kYXRhc2V0LmxpbmsgPSB0ZW1wW2pdLnF1ZXJ5U2VsZWN0b3IoImFbaHJlZio9Jy93YXRjaD92J10iKS5ocmVmOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRodW1iLmFwcGVuZENoaWxkKHNldExvY2FsZShidXR0b24uY29udGVudCkuZmlyc3RDaGlsZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5CTEtfT04gJiYgIXRodW1iLnF1ZXJ5U2VsZWN0b3IoIi5ibGFja2xpc3QiKSAmJiB3aW5kb3cueXQuY29uZmlnXy5QQUdFX05BTUUgIT09ICJjaGFubmVsIiAmJiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgIT09ICIvZmVlZC9zdWJzY3JpcHRpb25zIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9IC8vCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGRhdGEtcD0ndHRsfEJMQ0tfQUREJnR0cHxCTENLX0FERCcgY2xhc3M9J3l0LXVpeC10b29sdGlwIGJsYWNrbGlzdCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHZpZXdCb3g9JzAgMCAxMCAxMCcgY2xhc3M9J3RodW1iLXN2Zyc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHBvbHlnb24gcG9pbnRzPScxMCwxLjQgOC42LDAgNSwzLjYgMS40LDAgMCwxLjQgMy42LDUgMCw4LjYgMS40LDEwIDUsNi40IDguNiwxMCAxMCw4LjYgNi40LDUnLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5jb250ZW50LmZpcnN0Q2hpbGQuZGF0YXNldC51c2VyID0gdGVtcFtqXS51c2VybmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b24uY29udGVudC5maXJzdENoaWxkLmRhdGFzZXQueXRpZCA9IGxpc3RbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGh1bWIuYXBwZW5kQ2hpbGQoc2V0TG9jYWxlKGJ1dHRvbi5jb250ZW50KS5maXJzdENoaWxkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBkZWxWaWRlb3MoKSB7CiAgICAgICAgICAgICAgICB2YXIgaSwgaiwgdGVtcCwgcGFyZW50LCBibGFja2xpc3QsIGhhc191cG5leHQ7CiAgICAgICAgICAgICAgICBoYXNfdXBuZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmF1dG9wbGF5LWJhciIpOwogICAgICAgICAgICAgICAgYmxhY2tsaXN0ID0gT2JqZWN0LmtleXModXNlcl9zZXR0aW5ncy5ibGFja2xpc3QpOwogICAgICAgICAgICAgICAgaSA9IGJsYWNrbGlzdC5sZW5ndGg7CiAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IG1vZFRodW1icy50aHVtYnNbYmxhY2tsaXN0W2ldXTsKICAgICAgICAgICAgICAgICAgICBpZiAodGVtcCkgewogICAgICAgICAgICAgICAgICAgICAgICBqID0gdGVtcC5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChqLS0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNfdXBuZXh0ICYmIGhhc191cG5leHQuY29udGFpbnModGVtcFtqXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNfdXBuZXh0LnBhcmVudE5vZGUub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzX3VwbmV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi53YXRjaC1zaWRlYmFyLXNlcGFyYXRpb24tbGluZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoYXNfdXBuZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc191cG5leHQub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc191cG5leHQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gdGVtcFtqXS5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBbal0ub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wLnNwbGljZShqLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50LmNoaWxkRWxlbWVudENvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuZmlyc3RDaGlsZC5vdXRlckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRlbXAubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgbW9kVGh1bWJzLnRodW1ic1tibGFja2xpc3RbaV1dOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0ZW1wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiLmZlZWQtaXRlbS1jb250YWluZXI6bm90KC5zZWFyY2gtaGlzdG9yeS1pdGVtKSIpOwogICAgICAgICAgICAgICAgaSA9IHRlbXAubGVuZ3RoOwogICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wW2ldLnF1ZXJ5U2VsZWN0b3JBbGwoInVsIikubGVuZ3RoIDwgMikgewogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQgPSB0ZW1wW2ldLnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBbaV0ub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChwYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuY2hpbGRFbGVtZW50Q291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmZpcnN0Q2hpbGQub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gZ2V0VmlkZW9zKCkgewogICAgICAgICAgICAgICAgdmFyIGksIGxpc3QsIHRlbXAsIGNoYW5uZWxfaWQ7CiAgICAgICAgICAgICAgICBtb2RUaHVtYnMudGh1bWJzID0ge307CiAgICAgICAgICAgICAgICBsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgCiAgICAgICAgICAgICAgICAgICAgLnl0LWxvY2t1cC1ieWxpbmUgPiBhLAogICAgICAgICAgICAgICAgICAgIC55dC1sb2NrdXAtY29udGVudCAuZy1ob3ZlcmNhcmQsCiAgICAgICAgICAgICAgICAgICAgLnZpZGVvLWxpc3QtaXRlbSAuZy1ob3ZlcmNhcmQsCiAgICAgICAgICAgICAgICAgICAgLmNoYW5uZWxzLWNvbnRlbnQtaXRlbSAueXQtbG9ja3VwLXRpdGxlID4gYQogICAgICAgICAgICAgICAgYCk7CiAgICAgICAgICAgICAgICBpID0gbGlzdC5sZW5ndGg7CiAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IGxpc3RbaV07CiAgICAgICAgICAgICAgICAgICAgY2hhbm5lbF9pZCA9IHRlbXAuZGF0YXNldC55dGlkOwogICAgICAgICAgICAgICAgICAgIHdoaWxlICh0ZW1wKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wLnRhZ05hbWUgJiYgdGVtcC50YWdOYW1lID09PSAiTEkiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wLnVzZXJuYW1lID0gbGlzdFtpXS50ZXh0Q29udGVudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbW9kVGh1bWJzLnRodW1ic1tjaGFubmVsX2lkXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZFRodW1icy50aHVtYnNbY2hhbm5lbF9pZF0gPSBbdGVtcF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1vZFRodW1icy50aHVtYnNbY2hhbm5lbF9pZF0uaW5kZXhPZih0ZW1wKSA8IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RUaHVtYnMudGh1bWJzW2NoYW5uZWxfaWRdLnB1c2godGVtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdGVtcC5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBtb2RUaHVtYnMoKSB7CiAgICAgICAgICAgICAgICBpZiAoKHVzZXJfc2V0dGluZ3MuQkxLX09OIHx8IHVzZXJfc2V0dGluZ3MuR0VOX1BQT1RfT04pICYmICF3aW5kb3cub3BlbmVyICYmIHdpbmRvdy55dCAmJiB3aW5kb3cueXQuY29uZmlnXyAmJiAvd2F0Y2h8aW5kZXh8ZmVlZHxjaGFubmVsfHJlc3VsdHMvLnRlc3Qod2luZG93Lnl0LmNvbmZpZ18uUEFHRV9OQU1FKSkgewogICAgICAgICAgICAgICAgICAgIGdldFZpZGVvcygpOwogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLkJMS19PTiAmJiB3aW5kb3cueXQuY29uZmlnXy5QQUdFX05BTUUgIT09ICJjaGFubmVsIikgewogICAgICAgICAgICAgICAgICAgICAgICBkZWxWaWRlb3MoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc2V0QnV0dG9ucygpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgaW5pQWN0aW9uKTsKICAgICAgICAgICAgICAgICAgICBpbmlBY3Rpb24oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBzZXRWaWRlb0NvdW50KCkgewogICAgICAgICAgICAgICAgdmFyIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7CiAgICAgICAgICAgICAgICBzcGFuLnRleHRDb250ZW50ID0gIiDCtyAiOwogICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLnVzZXJuYW1lLmFwcGVuZENoaWxkKHNwYW4pOwogICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLmxpbmsuaHJlZiA9IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyAiL2NoYW5uZWwvIiArIGVuaGFuY2VkRGV0YWlscy51c2VyLmRhdGFzZXQueXRpZCArICIvdmlkZW9zIjsKICAgICAgICAgICAgICAgIGVuaGFuY2VkRGV0YWlscy51c2VybmFtZS5hcHBlbmRDaGlsZChlbmhhbmNlZERldGFpbHMubGluayk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlVmlkZW9Db3VudChkZXRhaWxzKSB7CiAgICAgICAgICAgICAgICBkZXRhaWxzID0gZGV0YWlscy50YXJnZXQucmVzcG9uc2UucXVlcnlTZWxlY3RvcigiLnBsLWhlYWRlci1kZXRhaWxzIGxpOm50aC1jaGlsZCgyKSIpOwogICAgICAgICAgICAgICAgaWYgKGRldGFpbHMpIHsKICAgICAgICAgICAgICAgICAgICBlbmhhbmNlZERldGFpbHMubGluay5jbGFzc05hbWUgPSAic3BmLWxpbmsiOwogICAgICAgICAgICAgICAgICAgIGVuaGFuY2VkRGV0YWlscy5saW5rLnRleHRDb250ZW50ID0gY2lkW2VuaGFuY2VkRGV0YWlscy51c2VyLmRhdGFzZXQueXRpZF0gPSBkZXRhaWxzLnRleHRDb250ZW50OwogICAgICAgICAgICAgICAgICAgIHNldFZpZGVvQ291bnQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRWaWRlb0NvdW50KCkgewogICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLnVzZXJuYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnl0LXVzZXItaW5mbyIpOwogICAgICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidXBsb2FkZWQtdmlkZW9zIikgJiYgZW5oYW5jZWREZXRhaWxzLnVzZXJuYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLmxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLmxpbmsuaWQgPSAidXBsb2FkZWQtdmlkZW9zIjsKICAgICAgICAgICAgICAgICAgICBlbmhhbmNlZERldGFpbHMudXNlcm5hbWUuYXBwZW5kQ2hpbGQoZW5oYW5jZWREZXRhaWxzLmxpbmspOwogICAgICAgICAgICAgICAgICAgIGVuaGFuY2VkRGV0YWlscy51c2VyID0gZW5oYW5jZWREZXRhaWxzLnVzZXJuYW1lLnF1ZXJ5U2VsZWN0b3IoImEiKTsKICAgICAgICAgICAgICAgICAgICBpZiAoY2lkW2VuaGFuY2VkRGV0YWlscy51c2VyLmRhdGFzZXQueXRpZF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLmxpbmsudGV4dENvbnRlbnQgPSBjaWRbZW5oYW5jZWREZXRhaWxzLnVzZXIuZGF0YXNldC55dGlkXTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VmlkZW9Db3VudCgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsWEhSKCJHRVQiLCB1cGRhdGVWaWRlb0NvdW50LCAiL3BsYXlsaXN0P2xpc3Q9IiArIGVuaGFuY2VkRGV0YWlscy51c2VyLmRhdGFzZXQueXRpZC5yZXBsYWNlKCJVQyIsICJVVSIpLCAiZG9jIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGdldENoYW5uZWxJbmZvKGRldGFpbHMpIHsKICAgICAgICAgICAgICAgIHZhciByZXRyeSwgaXNMaXZlOwogICAgICAgICAgICAgICAgaXNMaXZlID0gZGV0YWlscy50YXJnZXQucmVzcG9uc2UucXVlcnlTZWxlY3RvcigiLnl0LWJhZGdlLWxpdmUiKTsKICAgICAgICAgICAgICAgIGlmICghaXNMaXZlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0cnkgPSBkZXRhaWxzLnRhcmdldC5yZXNwb25zZVVSTC5zcGxpdCgiL3ZpZGVvcyIpLmxlbmd0aCA8IDI7CiAgICAgICAgICAgICAgICAgICAgZGV0YWlscyA9IGRldGFpbHMudGFyZ2V0LnJlc3BvbnNlLnF1ZXJ5U2VsZWN0b3JBbGwoIltkYXRhLWNvbnRleHQtaXRlbS1pZD0nIiArIHdpbmRvdy55dHBsYXllci5jb25maWcuYXJncy52aWRlb19pZCArICInXSAueXQtbG9ja3VwLW1ldGEtaW5mbyBsaSIpOwogICAgICAgICAgICAgICAgICAgIGlmIChkZXRhaWxzICYmIGRldGFpbHMubGVuZ3RoID4gMCAmJiBlbmhhbmNlZERldGFpbHMud2F0Y2hUaW1lLnRleHRDb250ZW50LnNwbGl0KCLCtyIpLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLndhdGNoVGltZS50ZXh0Q29udGVudCArPSAiIMK3ICIgKyBkZXRhaWxzW3JldHJ5ID8gMCA6IDFdLnRleHRDb250ZW50OwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmV0cnkgJiYgd2luZG93Lnl0cGxheWVyICYmIHdpbmRvdy55dHBsYXllci5jb25maWcgJiYgd2luZG93Lnl0cGxheWVyLmNvbmZpZy5hcmdzICYmIHdpbmRvdy55dHBsYXllci5jb25maWcuYXJncy51Y2lkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsWEhSKCJHRVQiLCBnZXRDaGFubmVsSW5mbywgIi9jaGFubmVsLyIgKyB3aW5kb3cueXRwbGF5ZXIuY29uZmlnLmFyZ3MudWNpZCArICIvdmlkZW9zIiwgImRvYyIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZXRQdWJsaXNoZWRUaW1lKCkgewogICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLndhdGNoVGltZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi53YXRjaC10aW1lLXRleHQiKTsKICAgICAgICAgICAgICAgIGlmIChlbmhhbmNlZERldGFpbHMud2F0Y2hUaW1lICYmICFlbmhhbmNlZERldGFpbHMud2F0Y2hUaW1lLmZldGNoaW5nICYmIHdpbmRvdy55dHBsYXllciAmJiB3aW5kb3cueXRwbGF5ZXIuY29uZmlnKSB7CiAgICAgICAgICAgICAgICAgICAgZW5oYW5jZWREZXRhaWxzLndhdGNoVGltZS5mZXRjaGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxYSFIoIkdFVCIsIGdldENoYW5uZWxJbmZvLCAiL2NoYW5uZWwvIiArIHdpbmRvdy55dHBsYXllci5jb25maWcuYXJncy51Y2lkICsgIi9zZWFyY2g/cXVlcnk9JTIyIiArIHdpbmRvdy55dHBsYXllci5jb25maWcuYXJncy52aWRlb19pZCArICIlMjIiLCAiZG9jIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gZW5oYW5jZWREZXRhaWxzKCkgewogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PT0gIi93YXRjaCIpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfVklEX0NOVCkgewogICAgICAgICAgICAgICAgICAgICAgICBnZXRWaWRlb0NvdW50KCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9QT1NUX1RJTUUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0UHVibGlzaGVkVGltZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByZXZlcnNlQ29udHJvbCgpIHsKICAgICAgICAgICAgICAgIHZhciBpLCB0ZW1wLCBwcmV2LCBuZXh0LCBsaXN0LCB2aWRlb3M7CiAgICAgICAgICAgICAgICBwcmV2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnByZXYtcGxheWxpc3QtbGlzdC1pdGVtIik7CiAgICAgICAgICAgICAgICBuZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLm5leHQtcGxheWxpc3QtbGlzdC1pdGVtIik7CiAgICAgICAgICAgICAgICBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBsYXlsaXN0LWF1dG9zY3JvbGwtbGlzdCIpOwogICAgICAgICAgICAgICAgdmlkZW9zID0gbGlzdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgibGkiKTsKICAgICAgICAgICAgICAgIGkgPSB2aWRlb3MubGVuZ3RoOwogICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQodmlkZW9zW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRlbXAgPSBwcmV2LmhyZWY7CiAgICAgICAgICAgICAgICBwcmV2LmhyZWYgPSBuZXh0LmhyZWY7CiAgICAgICAgICAgICAgICBuZXh0LmhyZWYgPSB0ZW1wOwogICAgICAgICAgICAgICAgbGlzdC5zY3JvbGxUb3AgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuY3VycmVudGx5LXBsYXlpbmciKS5vZmZzZXRUb3A7CiAgICAgICAgICAgICAgICBpZiAoYXBpKSB7CiAgICAgICAgICAgICAgICAgICAgYXBpLnVwZGF0ZVBsYXlsaXN0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gcmV2ZXJzZUJ1dHRvbihldmVudCkgewogICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5pZCA9PT0gInJldmVyc2UiKSB7CiAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoInl0LXVpeC1idXR0b24tdG9nZ2xlZCIpOwogICAgICAgICAgICAgICAgICAgIHNldCgicGxSZXYiLCBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJ5dC11aXgtYnV0dG9uLXRvZ2dsZWQiKSk7CiAgICAgICAgICAgICAgICAgICAgcmV2ZXJzZUNvbnRyb2woKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBhdXRvcGxheUJ1dHRvbihldmVudCkgewogICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5pZCA9PT0gImF1dG9wbGF5IikgewogICAgICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCJ5dC11aXgtYnV0dG9uLXRvZ2dsZWQiKTsKICAgICAgICAgICAgICAgICAgICBzZXQoInBsQXBsIiwgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygieXQtdWl4LWJ1dHRvbi10b2dnbGVkIikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZUJ1dHRvbih0eXBlLCBsYWJlbCwgYm9vbCwgY2FsbCkgewogICAgICAgICAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICBidXR0b24uaW5uZXJIVE1MID0gLy8KICAgICAgICAgICAgICAgICAgICBgPGJ1dHRvbiBjbGFzcz0neXQtdWl4LWJ1dHRvbiB5dC11aXgtYnV0dG9uLXBsYXllci1jb250cm9scyB5dC11aXgtYnV0dG9uLW9wYWNpdHkgeXQtdWl4LXRvb2x0aXAnIHR5cGU9J2J1dHRvbic+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIGNsYXNzPSdwbC1hdXRvcGxheScgdmlld0JveD0nMCAwIDE0IDE2Jz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBwb2ludHM9JzAsMTYgMTQsOCAwLDAnLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyBjbGFzcz0ncGwtcmV2ZXJzZScgdmlld0JveD0nMCAwIDE2IDIwJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBwb2ludHM9JzcsOCAzLDggMywxNCAwLDE0IDUsMjAgMTAsMTQgNywxNCcvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwb2x5Z29uIHBvaW50cz0nMTEsMCA2LDYgOSw2IDksMTIgMTMsMTIgMTMsNiAxNiw2Jy8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5gOwogICAgICAgICAgICAgICAgaWYgKGJvb2wgPT09IHRydWUgfHwgd2luZG93LmxvY2F0aW9uLmhyZWYuc3BsaXQoYm9vbCkubGVuZ3RoID4gMSkgewogICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoImJ1dHRvbiIpLmNsYXNzTGlzdC5hZGQoInl0LXVpeC1idXR0b24tdG9nZ2xlZCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnV0dG9uLmNvbnRlbnQuZmlyc3RDaGlsZC5pZCA9IHR5cGU7CiAgICAgICAgICAgICAgICBidXR0b24uY29udGVudC5maXJzdENoaWxkLmRhdGFzZXQucCA9ICJ0dHB8IiArIGxhYmVsICsgIiZ0dGx8IiArIGxhYmVsOwogICAgICAgICAgICAgICAgYnV0dG9uLmNvbnRlbnQuZmlyc3RDaGlsZC5jbGFzc0xpc3QuYWRkKCJ5dC11aXgtYnV0dG9uLWljb24td2F0Y2gtYXBwYmFyLSIgKyB0eXBlICsgIi12aWRlby1saXN0Iik7CiAgICAgICAgICAgICAgICBidXR0b24gPSBzZXRMb2NhbGUoYnV0dG9uLmNvbnRlbnQpLmZpcnN0Q2hpbGQ7CiAgICAgICAgICAgICAgICBwbGF5bGlzdENvbnRyb2xzLnBsQmFyLmNsYXNzTmFtZSA9IHBsYXlsaXN0Q29udHJvbHMucGxCYXIuY2xhc3NOYW1lLnJlcGxhY2UoInJhZGlvLXBsYXlsaXN0IiwgIiIpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBjYWxsKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5wbGF5bGlzdC1uYXYtY29udHJvbHMiKS5hcHBlbmRDaGlsZChidXR0b24pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHBsYXlsaXN0Q29udHJvbHMoKSB7CiAgICAgICAgICAgICAgICBwbGF5bGlzdENvbnRyb2xzLnBsQmFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIndhdGNoLWFwcGJhci1wbGF5bGlzdCIpOwogICAgICAgICAgICAgICAgaWYgKHBsYXlsaXN0Q29udHJvbHMucGxCYXIpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gImNvbXBsZXRlIiAmJiB1c2VyX3NldHRpbmdzLnBsUmV2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldmVyc2VDb250cm9sKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9QTFNUX1JWUlMgJiYgIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZXZlcnNlIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlQnV0dG9uKCJyZXZlcnNlIiwgIlBMU1RfUlZSUyIsIHVzZXJfc2V0dGluZ3MucGxSZXYsIHJldmVyc2VCdXR0b24pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfUExTVF9BVFBMICYmICFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYXV0b3BsYXkiKSkgewogICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVCdXR0b24oImF1dG9wbGF5IiwgIlBMU1RfQVAiLCB1c2VyX3NldHRpbmdzLnBsQXBsLCBhdXRvcGxheUJ1dHRvbik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHhoclBhdGNoKGV2ZW50KSB7CiAgICAgICAgICAgICAgICB2YXIgdGVtcCwgcGxheWVyOwogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gNCkgewogICAgICAgICAgICAgICAgICAgIHRlbXAgPSB7YXJnczogSlNPTi5wYXJzZSgKICAgICAgICAgICAgICAgICAgICAgICAgIntcIiIgKwogICAgICAgICAgICAgICAgICAgICAgICBkZWNvZGVVUklDb21wb25lbnQodGhpcy5yZXNwb25zZVRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8lNUMvZywgIiU1QyU1QyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvJTIyL2csICIlNUMlMjIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyYvZywgIlwiLFwiIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cPS9nLCAiXCI6XCIiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1wrL2csICIlMjAiKQogICAgICAgICAgICAgICAgICAgICAgICApICsKICAgICAgICAgICAgICAgICAgICAgICAgIlwifSIKICAgICAgICAgICAgICAgICAgICApfTsKICAgICAgICAgICAgICAgICAgICB0ZW1wID0gbW9kQXJncyh0ZW1wKTsKICAgICAgICAgICAgICAgICAgICB0ZW1wID0gZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHRlbXAuYXJncykuc3BsaXQoL1x7IihbXHdcV10qPykiXH0vKVsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyU1QyU1Qy9nLCAiJTVDIikKICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyU1QyUyMi9nLCAiJTIyIikKICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoLyUyMiUyQyUyMi9nLCAiJiIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC8lMjIlM0ElMjIvZywgIj0iKQogICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvJTIwL2csICIrIik7CiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICJyZXNwb25zZVRleHQiLCB7d3JpdGFibGU6IHRydWV9KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3BvbnNlVGV4dCA9IHRlbXA7CiAgICAgICAgICAgICAgICAgICAgcGxheWVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1vdmllX3BsYXllciIpOwogICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLnNldFBsYXliYWNrUXVhbGl0eSh1c2VyX3NldHRpbmdzLlZJRF9ERkxUX1FMVFkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBjaGVja1hIUihvcmlnaW5hbCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG1ldGhvZCwgdXJsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVybC5tYXRjaCgiZ2V0X3ZpZGVvX2luZm8iKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoInJlYWR5c3RhdGVjaGFuZ2UiLCB4aHJQYXRjaCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBoaWRlVm9sdW1lKCkgewogICAgICAgICAgICAgICAgaWYgKHZvbHVtZVdoZWVsLmNCb3R0b20gJiYgdm9sdW1lV2hlZWwuY0JvdHRvbS5jbGFzc0xpc3QuY29udGFpbnMoInl0cC12b2x1bWUtc2xpZGVyLWFjdGl2ZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgdm9sdW1lV2hlZWwuY0JvdHRvbS5jbGFzc0xpc3QucmVtb3ZlKCJ5dHAtdm9sdW1lLXNsaWRlci1hY3RpdmUiKTsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgdm9sdW1lV2hlZWwuY0JvdHRvbS50aW1lcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiB2b2x1bWVXaGVlbChldmVudCkgewogICAgICAgICAgICAgICAgdmFyIGZzUGwsIHBTZXRzLCBpdkNhcmQsIHBsYXllciwgY2FuU2Nyb2xsLCBkaXJlY3Rpb247CiAgICAgICAgICAgICAgICBwbGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJ2aWRlbyIpOwogICAgICAgICAgICAgICAgZnNQbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi55dHAtcGxheWxpc3QtbWVudSIpOwogICAgICAgICAgICAgICAgcFNldHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIueXRwLXNldHRpbmdzLW1lbnUiKTsKICAgICAgICAgICAgICAgIGl2Q2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pdi1kcmF3ZXIiKTsKICAgICAgICAgICAgICAgIGNhblNjcm9sbCA9IGV2ZW50ICYmICghZnNQbCB8fCAoZnNQbCAmJiAhZnNQbC5jb250YWlucyhldmVudC50YXJnZXQpKSkgJiYgKCFpdkNhcmQgfHwgKGl2Q2FyZCAmJiAhaXZDYXJkLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpKSAmJiAoIXBTZXRzIHx8IChwU2V0cyAmJiAhcFNldHMuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkpOwogICAgICAgICAgICAgICAgaWYgKGV2ZW50ICYmIGFwaSAmJiBwbGF5ZXIgJiYgY2FuU2Nyb2xsICYmIChldmVudC50YXJnZXQuaWQgPT09IGFwaSB8fCBhcGkuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkpIHsKICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgIHZvbHVtZVdoZWVsLmNCb3R0b20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIueXRwLWNocm9tZS1ib3R0b20iKTsKICAgICAgICAgICAgICAgICAgICBpZiAodm9sdW1lV2hlZWwuY0JvdHRvbSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXZvbHVtZVdoZWVsLmNCb3R0b20uY2xhc3NMaXN0LmNvbnRhaW5zKCJ5dHAtdm9sdW1lLXNsaWRlci1hY3RpdmUiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9sdW1lV2hlZWwuY0JvdHRvbS5jbGFzc0xpc3QuYWRkKCJ5dHAtdm9sdW1lLXNsaWRlci1hY3RpdmUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9sdW1lV2hlZWwuY0JvdHRvbS50aW1lcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh2b2x1bWVXaGVlbC5jQm90dG9tLnRpbWVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXBpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGkuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoIm1vdXNlbW92ZSIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB2b2x1bWVXaGVlbC5jQm90dG9tLnRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoaGlkZVZvbHVtZSwgNDAwMCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IGV2ZW50ICYmIChldmVudC5kZWx0YVkgfHwgZXZlbnQud2hlZWxEZWx0YVkpOwogICAgICAgICAgICAgICAgICAgIGFwaS5zZXRWb2x1bWUocGxheWVyLnZvbHVtZSAqIDEwMCAtIChNYXRoLnNpZ24oZGlyZWN0aW9uKSAqIDUpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWV2ZW50ICYmIHVzZXJfc2V0dGluZ3MuVklEX1ZPTF9XSEVFTCkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIndoZWVsIiwgdm9sdW1lV2hlZWwpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgIT09ICIvd2F0Y2giKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigid2hlZWwiLCB2b2x1bWVXaGVlbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gZHJhZ1BvcE91dChldmVudCkgewogICAgICAgICAgICAgICAgdmFyIGV4Y2x1ZGVkLCBpc0ZTY3JlZW47CiAgICAgICAgICAgICAgICBleGNsdWRlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi55dHAtY2hyb21lLWJvdHRvbSIpOwogICAgICAgICAgICAgICAgaXNGU2NyZWVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnl0cC1mdWxsc2NyZWVuIik7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQgJiYgIWlzRlNjcmVlbiAmJiAoIWV4Y2x1ZGVkIHx8IChldmVudC50YXJnZXQgIT09IGV4Y2x1ZGVkICYmICFleGNsdWRlZC5jb250YWlucyhldmVudC50YXJnZXQpKSkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuYnV0dG9ucyA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gIm1vdXNlZG93biIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIGRyYWdQb3BPdXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBkcmFnUG9wT3V0LCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vbGRQb3MgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWDogZXZlbnQuY2xpZW50WCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBZOiBldmVudC5jbGllbnRZLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZ1g6IGV2ZW50LmNsaWVudFgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JnWTogZXZlbnQuY2xpZW50WQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC50eXBlID09PSAibW91c2Vtb3ZlIiAmJiAod2luZG93Lmhhc01vdmVkIHx8IE1hdGguYWJzKGV2ZW50LmNsaWVudFggLSB3aW5kb3cub2xkUG9zLm9yZ1gpID4gMTAgfHwgTWF0aC5hYnMoZXZlbnQuY2xpZW50WSAtIHdpbmRvdy5vbGRQb3Mub3JnWSkgPiAxMCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tb3ZlQnkoZXZlbnQuY2xpZW50WCAtIHdpbmRvdy5vbGRQb3MuWCwgZXZlbnQuY2xpZW50WSAtIHdpbmRvdy5vbGRQb3MuWSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuaGFzTW92ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5idXR0b25zICE9PSAxIHx8IGV2ZW50LnR5cGUgPT09ICJjbGljayIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5oYXNNb3ZlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdpbmRvdy5vbGRQb3M7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgd2luZG93Lmhhc01vdmVkOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIGRyYWdQb3BPdXQpOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsIGRyYWdQb3BPdXQsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWV2ZW50ICYmIHdpbmRvdy5uYW1lID09PSAicG9wT3V0IikgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIGRyYWdQb3BPdXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc3VtZVBsYXliYWNrKCkgewogICAgICAgICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoInZpZGVvIik7CiAgICAgICAgICAgICAgICBpZiAodGVtcCAmJiAhaXNOYU4odGVtcC5kdXJhdGlvbikgJiYgdGVtcC5jdXJyZW50VGltZSA8IHRlbXAuZHVyYXRpb24pIHsKICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdGVtcC5jdXJyZW50VGltZTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAidD0iICsgdGVtcDsKICAgICAgICAgICAgICAgICAgICB9LCAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBwb3BQbGF5ZXIodXJsKSB7CiAgICAgICAgICAgICAgICB2YXIgcG9wT3V0LCB3aWR0aCwgaGVpZ2h0LCBwb3BfdXJsLCB2aWRlbzsKICAgICAgICAgICAgICAgIHdpZHRoID0gcGFyc2VJbnQodXNlcl9zZXR0aW5ncy5WSURfUFBPVF9TWikgfHwgNTMzOwogICAgICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5yb3VuZCh3aWR0aCAvICgxNiAvIDkpKTsKICAgICAgICAgICAgICAgIHZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigidmlkZW8iKTsKICAgICAgICAgICAgICAgIHBvcF91cmwgPSAoIXVybC50YXJnZXQgJiYgdXJsKSB8fCB3aW5kb3cubG9jYXRpb24uaHJlZi5zcGxpdCgvJnQ9WzAtOV0rfCN0PVswLTldK3wmdGltZT1bMC05XSsvKS5qb2luKCIiKTsKICAgICAgICAgICAgICAgIGlmICh1cmwudGFyZ2V0ICYmIHZpZGVvICYmIHZpZGVvLmN1cnJlbnRUaW1lICYmIHZpZGVvLmN1cnJlbnRUaW1lIDwgdmlkZW8uZHVyYXRpb24pIHsKICAgICAgICAgICAgICAgICAgICBwb3BfdXJsICs9ICIjdD0iICsgdmlkZW8uY3VycmVudFRpbWU7CiAgICAgICAgICAgICAgICAgICAgd2luZG93Lnl0cGxheWVyLmNvbmZpZy5hcmdzLnN0YXJ0ID0gdmlkZW8uY3VycmVudFRpbWU7CiAgICAgICAgICAgICAgICAgICAgYXBpLmN1ZVZpZGVvQnlQbGF5ZXJWYXJzKHdpbmRvdy55dHBsYXllci5jb25maWcuYXJncyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBwb3BPdXQgPSB3aW5kb3cub3Blbihwb3BfdXJsLCAicG9wT3V0IiwgIndpZHRoPSIgKyB3aWR0aCArICIsaGVpZ2h0PSIgKyBoZWlnaHQpOwogICAgICAgICAgICAgICAgaWYgKHVybC50YXJnZXQpIHsKICAgICAgICAgICAgICAgICAgICBwb3BPdXQuYWRkRXZlbnRMaXN0ZW5lcigiYmVmb3JldW5sb2FkIiwgcmVzdW1lUGxheWJhY2spOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcG9wT3V0LmZvY3VzKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc2V0U3ViUGxheWxpc3QoZXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciBpLCBsaXN0LCBidXR0b247CiAgICAgICAgICAgICAgICBsaXN0ID0gW107CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5pZCA9PT0gInN1YnNjcmlwdGlvbi1wbGF5bGlzdCIpIHsKICAgICAgICAgICAgICAgICAgICBpID0gc3ViUGxheWxpc3QudmlkZW9fbGlzdC5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnB1c2goc3ViUGxheWxpc3QudmlkZW9fbGlzdFtpXS5kYXRhc2V0LnZpZGVvSWRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBsaXN0ID0gbGlzdC5yZXZlcnNlKCkuc3BsaWNlKDAsIDIwKS5qb2luKCIlMkMiKTsKICAgICAgICAgICAgICAgICAgICBzdWJQbGF5bGlzdC5saXN0X3RpdGxlID0gc3ViUGxheWxpc3QubGlzdF90aXRsZSAmJiBzdWJQbGF5bGlzdC5saXN0X3RpdGxlLnF1ZXJ5U2VsZWN0b3IoIi5lcGljLW5hdi1pdGVtLWhlYWRpbmciKS50ZXh0Q29udGVudC50cmltKCk7CiAgICAgICAgICAgICAgICAgICAgYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN1YnNjcmlwdGlvbi1wbGF5bGlzdCIpOwogICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5ocmVmID0gIi93YXRjaF92aWRlb3M/dGl0bGU9IiArIHN1YlBsYXlsaXN0Lmxpc3RfdGl0bGUgKyAiJnZpZGVvX2lkcz0iICsgbGlzdDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBzdWJQbGF5bGlzdCgpIHsKICAgICAgICAgICAgICAgIHZhciBidXR0b24sIG5hdl9tZW51OwogICAgICAgICAgICAgICAgbmF2X21lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuYXBwYmFyLW5hdi1tZW51Iik7CiAgICAgICAgICAgICAgICBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3Vic2NyaXB0aW9uLXBsYXlsaXN0Iik7CiAgICAgICAgICAgICAgICBzdWJQbGF5bGlzdC5saXN0X3RpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmFwcGJhci1uYXYtbWVudSIpOwogICAgICAgICAgICAgICAgc3ViUGxheWxpc3QudmlkZW9fbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoImFkZHRvLXdhdGNoLWxhdGVyLWJ1dHRvbiIpOwogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuR0VOX1NVQl9MSVNUICYmIG5hdl9tZW51ICYmIHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCIvZmVlZC9zdWJzY3JpcHRpb25zIikubGVuZ3RoID4gMSAmJiAhYnV0dG9uICYmIHN1YlBsYXlsaXN0Lmxpc3RfdGl0bGUgJiYgc3ViUGxheWxpc3QudmlkZW9fbGlzdCkgewogICAgICAgICAgICAgICAgICAgIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLmlubmVySFRNTCA9IC8vCiAgICAgICAgICAgICAgICAgICAgICAgIGA8bGkgaWQ9J3N1YnNjcmlwdGlvbi1wbGF5bGlzdC1pY29uJz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGlkPSdzdWJzY3JpcHRpb24tcGxheWxpc3QnIGRhdGEtcD0ndHRsfFNVQl9QTFNUJyBjbGFzcz0neXQtdWl4LWJ1dHRvbiBzcGYtbGluayB5dC11aXgtc2Vzc2lvbmxpbmsgeXQtdWl4LWJ1dHRvbi1lcGljLW5hdi1pdGVtIHl0LXVpeC1idXR0b24tc2l6ZS1kZWZhdWx0Jz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIHZpZXdCb3g9JzAgMCAxNCAxNic+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwb2x5Z29uIHBvaW50cz0nMCwxNiAxNCw4IDAsMCAnLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5gOwogICAgICAgICAgICAgICAgICAgIGJ1dHRvbiA9IHNldExvY2FsZShidXR0b24uY29udGVudCkuZmlyc3RDaGlsZDsKICAgICAgICAgICAgICAgICAgICBuYXZfbWVudS5hcHBlbmRDaGlsZChidXR0b24pOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgc2V0U3ViUGxheWxpc3QpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGxvYWRDb21tZW50cyhldmVudCkgewogICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQucGFyZW50Tm9kZSAmJiBldmVudC50YXJnZXQucGFyZW50Tm9kZS5pZCA9PT0gIlAtc2hvdy1jb21tZW50cyIpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobW9kQ29tbWVudHMuY29tbWVudHMubGF6eWxvYWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNwZi5sb2FkLmFwcGx5KG1haW4sIG1vZENvbW1lbnRzLmNvbW1lbnRzLmxhenlsb2FkKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbW9kQ29tbWVudHMuY29tbWVudHMuY2xhc3NMaXN0LnRvZ2dsZSgic2hvdyIpOwogICAgICAgICAgICAgICAgICAgIG1vZENvbW1lbnRzLndyYXBwZXIucXVlcnlTZWxlY3RvcigiYnV0dG9uIikudGV4dENvbnRlbnQgPSBsYW5nKChtb2RDb21tZW50cy5jb21tZW50cy5jbGFzc0xpc3QuY29udGFpbnMoInNob3ciKSAmJiAiSElERV9DTVRTIikgfHwgIlNIT1dfQ01UUyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2l6ZVBsYXllcihldmVudCkgewogICAgICAgICAgICAgICAgdmFyIGksIHRlbXAsIGlzX3NtYWxsLCBjb250ZW50LCBtYXhfd2lkdGg7CiAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi93YXRjaCIpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGVtcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwbGF5ZXItYXBpIik7CiAgICAgICAgICAgICAgICBpZiAoIXRlbXApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0ZW1wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoOwogICAgICAgICAgICAgICAgaXNfc21hbGwgPSB3aW5kb3cuaW5uZXJXaWR0aCA8IDY1NyA/ICIiIDogIi53YXRjaC1zdGFnZS1tb2RlICI7CiAgICAgICAgICAgICAgICBpZiAoaXNfc21hbGwgIT09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuVklEX1BMUl9GSVRfV0RUSCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfUExSX0ZJVF9XRFRILm1hdGNoKCIlIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF93aWR0aCA9IHdpbmRvdy5wYXJzZUludCh1c2VyX3NldHRpbmdzLlZJRF9QTFJfRklUX1dEVEgpIC8gMTAwICogdGVtcDsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF93aWR0aCA9IHdpbmRvdy5wYXJzZUludCh1c2VyX3NldHRpbmdzLlZJRF9QTFJfRklUX1dEVEgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIG1heF93aWR0aCA9IHRlbXAgPj0gbWF4X3dpZHRoID8gbWF4X3dpZHRoIDogdGVtcDsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBtYXhfd2lkdGggPSB0ZW1wID49IDEyODAgPyAxMjgwIDogdGVtcDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG1heF93aWR0aCA9IHRlbXA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb250ZW50ID0gLy8KICAgICAgICAgICAgICAgICAgICBgQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjU2cHgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgI3BsYXllci1hcGksCiAgICAgICAgICAgICAgICAgICAgICAgICNwbGF5ZXItdW5hdmFpbGFibGUgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiA1MXB4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkICFpbXBvcnRhbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgMTBweCAjMDAwOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICN0aGVhdGVyLWJhY2tncm91bmQgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQgIWltcG9ydGFudDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAke2lzX3NtYWxsfS5wbGF5ZXItd2lkdGggewogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogJHttYXhfd2lkdGh9cHggIWltcG9ydGFudDsKICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJHttYXhfd2lkdGggLyAyICogLTF9cHggIWltcG9ydGFudDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHtpc19zbWFsbH0ucGxheWVyLWhlaWdodDpub3QoLndhdGNoLXBsYXlsaXN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogJHttYXhfd2lkdGggLyAoMTYgLyA5KX1weCAhaW1wb3J0YW50OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAke2lzX3NtYWxsfSN3YXRjaC1hcHBiYXItcGxheWxpc3QgewogICAgICAgICAgICAgICAgICAgICAgICB0b3A6ICR7bWF4X3dpZHRoIC8gKDE2IC8gOSkgLSAoaXNfc21hbGwgPT09ICIiID8gMCA6IDM2MCl9cHggIWltcG9ydGFudDsKICAgICAgICAgICAgICAgICAgICB9YDsKICAgICAgICAgICAgICAgIHRlbXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgieXRwLXJlc2l6ZXIiKTsKICAgICAgICAgICAgICAgIGlmICghdGVtcCkgewogICAgICAgICAgICAgICAgICAgIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICAgICAgICAgICAgICAgIHRlbXAuaWQgPSAieXRwLXJlc2l6ZXIiOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQodGVtcCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0ZW1wLnRleHRDb250ZW50ID0gY29udGVudDsKICAgICAgICAgICAgICAgIGlmICghZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoInJlc2l6ZSIpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBtb2RQbGF5ZXJTaXplKCkgewogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuVklEX1BMUl9GSVQpIHsKICAgICAgICAgICAgICAgICAgICByZXNpemVQbGF5ZXIoKTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgcmVzaXplUGxheWVyKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJzcGZkb25lIiwgcmVzaXplUGxheWVyKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHJlc2l6ZVBsYXllcik7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigic3BmZG9uZSIsIHJlc2l6ZVBsYXllcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbW9kQ29tbWVudHMoKSB7CiAgICAgICAgICAgICAgICB2YXIgaXNfbGl2ZSA9IHdpbmRvdy55dHBsYXllciAmJiB3aW5kb3cueXRwbGF5ZXIuY29uZmlnICYmIHdpbmRvdy55dHBsYXllci5jb25maWcuYXJncyAmJiB3aW5kb3cueXRwbGF5ZXIuY29uZmlnLmFyZ3MubGl2ZXN0cmVhbTsKICAgICAgICAgICAgICAgIG1vZENvbW1lbnRzLmNvbW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIndhdGNoLWRpc2N1c3Npb24iKTsKICAgICAgICAgICAgICAgIGlmICghaXNfbGl2ZSAmJiBtb2RDb21tZW50cy5jb21tZW50cyAmJiAhZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlAtc2hvdy1jb21tZW50cyIpICYmIHVzZXJfc2V0dGluZ3MuVklEX0hJREVfQ09NUyA9PT0gIjEiKSB7CiAgICAgICAgICAgICAgICAgICAgbW9kQ29tbWVudHMud3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRlbXBsYXRlIik7CiAgICAgICAgICAgICAgICAgICAgbW9kQ29tbWVudHMud3JhcHBlci5pbm5lckhUTUwgPSAvLwogICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBpZD0nUC1zaG93LWNvbW1lbnRzJyBjbGFzcz0neXQtY2FyZCc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSd5dC11aXgtYnV0dG9uIHl0LXVpeC1idXR0b24tZXhwYW5kZXInIGRhdGEtcD0ndG5kfFNIT1dfQ01UUyc+PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgbW9kQ29tbWVudHMud3JhcHBlciA9IHNldExvY2FsZShtb2RDb21tZW50cy53cmFwcGVyLmNvbnRlbnQpLmZpcnN0Q2hpbGQ7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBsb2FkQ29tbWVudHMpOwogICAgICAgICAgICAgICAgICAgIG1vZENvbW1lbnRzLmNvbW1lbnRzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG1vZENvbW1lbnRzLndyYXBwZXIsIG1vZENvbW1lbnRzLmNvbW1lbnRzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBzZXRDdXN0b21TdHlsZXMoY2xzcykgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdFt1c2VyX3NldHRpbmdzW2Nsc3NdID8gImFkZCIgOiAicmVtb3ZlIl0oY3VzdG9tU3R5bGVzLmN1c3RvbV9zdHlsZXNbY2xzc10pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGN1c3RvbVN0eWxlcygpIHsKICAgICAgICAgICAgICAgIHZhciBjaGlsZCwgcGFyZW50LCBwbHJfYXBpLCBjb21tZW50cywgc2lkZWJhciwgeXRHcmlkLCBhZHZlcnRzLCBhZHNfbGlzdDsKICAgICAgICAgICAgICAgIGNvbW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIndhdGNoLWRpc2N1c3Npb24iKTsKICAgICAgICAgICAgICAgIHl0R3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi55dC11aXgtbWVudS10b3AtbGV2ZWwtZmxvdy1idXR0b246bGFzdC1jaGlsZCBhIik7CiAgICAgICAgICAgICAgICBjdXN0b21TdHlsZXMuY3VzdG9tX3N0eWxlcyA9IHsKICAgICAgICAgICAgICAgICAgICBHRU5fRFNCTF9BRFMgICAgOiAicGFydF9ub19hZHMiLAogICAgICAgICAgICAgICAgICAgIEdFTl9CTFVFX0dMT1cgICA6ICJwYXJ0X2RzYmxfZ2xvdyIsCiAgICAgICAgICAgICAgICAgICAgR0VOX0hJREVfRlRSICAgIDogInBhcnRfaGlkZV9mb290ZXIiLAogICAgICAgICAgICAgICAgICAgIEdFTl9CVFRSX05URiAgICA6ICJwYXJ0X25vdGlmX2J1dHRvbiIsCiAgICAgICAgICAgICAgICAgICAgR0VOX0dSSURfU1VCUyAgIDogInBhcnRfZ3JpZF9zdWJzIiwKICAgICAgICAgICAgICAgICAgICBHRU5fR1JJRF9TUkNIICAgOiAicGFydF9ncmlkX3NlYXJjaCIsCiAgICAgICAgICAgICAgICAgICAgR0VOX0NNUFRfVFRMUyAgIDogInBhcnRfY29tcGFjdF90aXRsZXMiLAogICAgICAgICAgICAgICAgICAgIFZJRF9QTFJfQVRQTCAgICA6ICJwYXJ0X2F1dG9wbGF5b24iLAogICAgICAgICAgICAgICAgICAgIFZJRF9QTFJfRFlOX1NJWkU6ICJwYXJ0X3N0YXRpY19zaXplIiwKICAgICAgICAgICAgICAgICAgICBWSURfSElERV9ERVRMUyAgOiAicGFydF9oaWRlX2RldGFpbHMiLAogICAgICAgICAgICAgICAgICAgIFZJRF9UVExfQ01QVCAgICA6ICJwYXJ0X2NvbXBhY3RfdGl0bGUiLAogICAgICAgICAgICAgICAgICAgIFZJRF9ERVNDX1NIUlQgICA6ICJwYXJ0X2xhYmVsbGVzc19idXR0b25zIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmICh3aW5kb3cueXQgJiYgd2luZG93Lnl0LmNvbmZpZ18gJiYgd2luZG93Lnl0LmNvbmZpZ18uUEFHRV9OQU1FID09PSAic2hhcmVkX2NvbnZlcnNhdGlvbiIpIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIltyZWw9J3Nob3J0bGluayddIikuaHJlZjsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAod2luZG93Lm5hbWUgPT09ICJwb3BPdXQiKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoInBhcnRfcG9wb3V0Iik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoeXRHcmlkICYmIHVzZXJfc2V0dGluZ3MuR0VOX0dSSURfU1VCUykgewogICAgICAgICAgICAgICAgICAgIHl0R3JpZC5jbGljaygpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBwbHJfYXBpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBsYXllci1hcGkiKTsKICAgICAgICAgICAgICAgICAgICBzaWRlYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLmJyYW5kZWQtcGFnZS12Mi1zZWNvbmRhcnktY29sIik7CiAgICAgICAgICAgICAgICAgICAgYWRzX2xpc3QgPSAvLwogICAgICAgICAgICAgICAgICAgICAgICBgI21hc3RoZWFkX2NoaWxkLAogICAgICAgICAgICAgICAgICAgICAgICAjZmVlZC1weXYtY29udGFpbmVyLAogICAgICAgICAgICAgICAgICAgICAgICAjd2F0Y2g3LXNpZGViYXItYWRzLAogICAgICAgICAgICAgICAgICAgICAgICAjd2F0Y2g3LXNpZGViYXItb2ZmZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIC5hZC1kaXYsCiAgICAgICAgICAgICAgICAgICAgICAgIC5weXYtYWZjLWFkcy1jb250YWluZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIC52aWRlby1saXN0LWl0ZW06bm90KC5yZWxhdGVkLWxpc3QtaXRlbSk6bm90KC5kYXNoYm9hcmQtd2lkZ2V0LWl0ZW0pYDsKICAgICAgICAgICAgICAgICAgICBhZHZlcnRzID0gdXNlcl9zZXR0aW5ncy5HRU5fRFNCTF9BRFMgJiYgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhZHNfbGlzdCk7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGFkdmVydHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBhZHZlcnRzOwogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoY2hpbGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IGNoaWxkLnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50LmNoaWxkRWxlbWVudENvdW50ID4gMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLm91dGVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQgPSBwYXJlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYWR2ZXJ0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWRzX2xpc3QpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoc2lkZWJhciAmJiBzaWRlYmFyLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICIvcmVzdWx0cyIgJiYgc2lkZWJhciAmJiBzaWRlYmFyLnF1ZXJ5U2VsZWN0b3JBbGwoIioiKS5sZW5ndGggPCAxMCkgfHwgKHNpZGViYXIgJiYgKCh1c2VyX3NldHRpbmdzLkdFTl9IREVfUkVDTV9TREJSICYmIHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCIvZmVlZC9zdWJzY3JpcHRpb25zIikubGVuZ3RoID4gMSkgfHwgKHVzZXJfc2V0dGluZ3MuR0VOX0hERV9TUkNIX1NEQlIgJiYgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAiL3Jlc3VsdHMiKSB8fCAodXNlcl9zZXR0aW5ncy5HRU5fSERFX0NITl9TREJSICYmIHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KC9cLyhjaGFubmVsfHVzZXJ8YylcLy8pLmxlbmd0aCA+IDEpKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZGViYXIub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PT0gIi93YXRjaCIgJiYgdXNlcl9zZXR0aW5ncy5WSURfSElERV9DT01TID4gMSAmJiBjb21tZW50cykgewogICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50cy5vdXRlckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuVklEX0hJREVfQ09NUyA9PT0gIjEiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCJwYXJ0X2hpZGVfY29tbWVudHMiKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJfc2V0dGluZ3MuVklEX0hJREVfQ09NUyAhPT0gIjEiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCJwYXJ0X2hpZGVfY29tbWVudHMiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuVklEX1BMUl9GSVQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbW9kUGxheWVyU2l6ZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhjdXN0b21TdHlsZXMuY3VzdG9tX3N0eWxlcykuZm9yRWFjaChzZXRDdXN0b21TdHlsZXMpOwogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaHJlZi5zcGxpdCgiL2ZlZWQvc3Vic2NyaXB0aW9ucyIpLmxlbmd0aCA8IDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoInBhcnRfZ3JpZF9zdWJzIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGRlZmF1bHRDaGFubmVsUGFnZShldmVudCkgewogICAgICAgICAgICAgICAgdmFyIHBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5HRU5fQ0hOX0RGTFRfUEFHRSAhPT0gImRlZmF1bHQiKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50ICYmIGV2ZW50LnRhcmdldCkgewogICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlID0gZXZlbnQudGFyZ2V0OwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgIT09ICJBIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHBhcmVudE5vZGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnROb2RlID0gcGFyZW50Tm9kZS5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnROb2RlICYmIHBhcmVudE5vZGUudGFnTmFtZSA9PT0gIkEiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Tm9kZSAmJiBwYXJlbnROb2RlLmhyZWYgJiYgcGFyZW50Tm9kZS5ocmVmLnNwbGl0KHVzZXJfc2V0dGluZ3MuR0VOX0NITl9ERkxUX1BBR0UpLmxlbmd0aCA8IDIgJiYgKHBhcmVudE5vZGUuaHJlZi5zcGxpdCgiL2NoYW5uZWwvIikubGVuZ3RoID4gMSB8fCBwYXJlbnROb2RlLmhyZWYuc3BsaXQoIi91c2VyLyIpLmxlbmd0aCA+IDEpICYmIHBhcmVudE5vZGUuaHJlZi5zcGxpdCgvW2EtejAtOV1cL1thLXowLTldL2kpLmxlbmd0aCA8IDQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuaHJlZiArPSAiLyIgKyB1c2VyX3NldHRpbmdzLkdFTl9DSE5fREZMVF9QQUdFOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghZXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91c2V1cCIsIGRlZmF1bHRDaGFubmVsUGFnZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG1vZEFyZ3MoY29uZmlnKSB7CiAgICAgICAgICAgICAgICB2YXIgaSwgdGVtcCwgbGlzdCwgbGVuZ3RoLCB2aWRlb3MsIG5ld19saXN0LCBjYW5fc2hhcmU7CiAgICAgICAgICAgICAgICBpZiAod2luZG93Lm5hbWUgPT09ICJwb3BPdXQiKSB7CiAgICAgICAgICAgICAgICAgICAgY2FuX3NoYXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnBsYXlsaXN0LWhlYWRlci1jb250ZW50Iik7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbl9zaGFyZSAmJiBjYW5fc2hhcmUuZGF0YXNldC5zaGFyZWFibGUgPT09ICJGYWxzZSIgJiYgIWNvbmZpZy5hcmdzLnZpZGVvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZy5hcmdzLnZpZGVvID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgIHZpZGVvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoImxpW2RhdGEtdmlkZW8taWRdIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aCA9IHZpZGVvcy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLmFyZ3MudmlkZW9baV0gPSB7ImVuY3J5cHRlZF9pZCI6IHZpZGVvc1tpXS5nZXRBdHRyaWJ1dGUoImRhdGEtdmlkZW8taWQiKX07CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBjb25maWcuYXJncy50aXRsZTsKICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy5lbCA9ICJlbWJlZGRlZCI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmFyZ3MudnEpIHsKICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy52cSA9IHVzZXJfc2V0dGluZ3MuVklEX0RGTFRfUUxUWTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9ERkxUX1FMVFkgIT09ICJhdXRvIikgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2VbInl0LXBsYXllci1xdWFsaXR5Il0gPSBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZGF0YSI6IHVzZXJfc2V0dGluZ3MuVklEX0RGTFRfUUxUWSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJleHBpcmF0aW9uIjogbmV3IERhdGUoKS5nZXRUaW1lKCkgKyA4NjRFNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjcmVhdGlvbiI6IG5ldyBEYXRlKCkuZ2V0VGltZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGlnbm9yZSkge30KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb25maWcuYXJncy5jYXB0aW9uX2F1ZGlvX3RyYWNrcyAmJiB1c2VyX3NldHRpbmdzLlZJRF9QTFJfQ0MpIHsKICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy5jYXB0aW9uX2F1ZGlvX3RyYWNrcyA9IGNvbmZpZy5hcmdzLmNhcHRpb25fYXVkaW9fdHJhY2tzLnNwbGl0KC8mZD1bMC05XXxkPVswLTldJi8pLmpvaW4oIiIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuVklEX1BMUl9WT0xfTEROKSB7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbmZpZy5hcmdzLmxvdWRuZXNzOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuVklEX1BMUl9IVE1MNSkgewogICAgICAgICAgICAgICAgICAgIGNvbmZpZy5odG1sNSA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfUExSX0lORk8pIHsKICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy5zaG93aW5mbyA9ICIxIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh3aW5kb3cub3BlbmVyICYmIHdpbmRvdy5sb2NhdGlvbi5oYXNoICE9PSAiIikgewogICAgICAgICAgICAgICAgICAgIGNvbmZpZy5hcmdzLmF1dG9wbGF5ID0gIjEiOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdXNlcl9zZXR0aW5ncy5WSURfUExSX0FUUEwpIHsKICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy5hdXRvcGxheSA9ICIwIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb25maWcuYXJncy5mZmxhZ3MpIHsKICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy5mZmxhZ3MgPSBjb25maWcuYXJncy5mZmxhZ3MucmVwbGFjZSgibGVnYWN5X2F1dG9wbGF5X2ZsYWc9dHJ1ZSIsICJsZWdhY3lfYXV0b3BsYXlfZmxhZz1mYWxzZSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuVklEX1BMUl9TSVpFX01FTSkgewogICAgICAgICAgICAgICAgICAgIGNvbmZpZy5hcmdzLnBsYXllcl93aWRlID0gKHVzZXJfc2V0dGluZ3MudGhlYXRlck1vZGUgJiYgIjEiKSB8fCAiMCI7CiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy55dHBzZXR3aWRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy55dHBzZXR3aWRlKCJ3aWRlIiwgY29uZmlnLmFyZ3MucGxheWVyX3dpZGUsIC0xKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmFyZ3MuaXZfbG9hZF9wb2xpY3kgJiYgdXNlcl9zZXR0aW5ncy5WSURfUExSX0FOVFMpIHsKICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy5pdl9sb2FkX3BvbGljeSA9ICIzIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9QTFJfQURTICYmICghdXNlcl9zZXR0aW5ncy5WSURfU1VCX0FEUyB8fCAodXNlcl9zZXR0aW5ncy5WSURfU1VCX0FEUyAmJiAhY29uZmlnLmFyZ3Muc3Vic2NyaWJlZCkpKSB7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbmZpZy5hcmdzLmFkM19tb2R1bGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmFyZ3MuYWRhcHRpdmVfZm10cyAmJiB1c2VyX3NldHRpbmdzLlZJRF9QTFJfSEZSKSB7CiAgICAgICAgICAgICAgICAgICAgbmV3X2xpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgICBsaXN0ID0gY29uZmlnLmFyZ3MuYWRhcHRpdmVfZm10cy5zcGxpdCgiLCIpOwogICAgICAgICAgICAgICAgICAgIGkgPSBsaXN0Lmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBsaXN0W2ldLnNwbGl0KC9mcHNcPShbMC05XXsyfSkvKVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0ZW1wIHx8IHRlbXAgPCAzMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3X2xpc3QucHVzaChsaXN0W2ldKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25maWcuYXJncy5hZGFwdGl2ZV9mbXRzID0gbmV3X2xpc3Quam9pbigiLCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpZzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBtb2RNYXRjaE1lZGlhKG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odGV4dCkgewogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gb3JpZ2luYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICBpZiAodGV4dCA9PT0gInNjcmVlbiBhbmQgKG1heC13aWR0aDogNjU2cHgpIiAmJiB0ZW1wLm1hdGNoZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRlbXA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0ZW1wLCAibWF0Y2hlcyIsIHt3cml0YWJsZTogdHJ1ZX0pOwogICAgICAgICAgICAgICAgICAgIHRlbXAubWF0Y2hlcyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZW1wOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmFsQ2hhbmdlcygpIHsKICAgICAgICAgICAgICAgIHZhciBsb2dvLCBjaGVja2JveCwgYXV0b3BsYXliYXIsIGRlc2NyaXB0aW9uOwogICAgICAgICAgICAgICAgYXV0b3BsYXliYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuYXV0b3BsYXktYmFyIik7CiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhY3Rpb24tcGFuZWwtZGV0YWlscyIpOwogICAgICAgICAgICAgICAgaWYgKHVzZXJfc2V0dGluZ3MuR0VOX1lUX0xPR09fTElOSyAmJiB3aW5kb3cueXQgJiYgd2luZG93Lnl0LmNvbmZpZ18gJiYgd2luZG93Lnl0LmNvbmZpZ18uTE9HR0VEX0lOKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIm1hcFtuYW1lPSdkb29kbGUnXSA+IGFyZWEsIGEjbG9nby1jb250YWluZXIiKTsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nbyAmJiBsb2dvLmhyZWYgPT09IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyAiLyIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9nby5ocmVmID0gIi9mZWVkL3N1YnNjcmlwdGlvbnMiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLkdFTl9SRU1fQVBVTiAmJiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICIvd2F0Y2giICYmIGF1dG9wbGF5YmFyKSB7CiAgICAgICAgICAgICAgICAgICAgY2hlY2tib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuY2hlY2tib3gtb24tb2ZmIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNoZWNrYm94KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrYm94Lm91dGVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh1c2VyX3NldHRpbmdzLlZJRF9MQVlUX0FVVE9fUE5MICYmIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PT0gIi93YXRjaCIgJiYgZGVzY3JpcHRpb24pIHsKICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCJ5dC11aXgtZXhwYW5kZXItY29sbGFwc2VkIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5HRU5fU1BGX09GRiAmJiB3aW5kb3cuc3BmICYmIHdpbmRvdy5zcGYuZGlzcG9zZSkgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zcGYuZGlzcG9zZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGxvY2FsWEhSKG1ldGhvZCwgY2FsbCwgdXJsLCBoZWFkKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgICAgICAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgY2FsbCk7CiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9wZW4obWV0aG9kLCB1cmwsIHRydWUpOwogICAgICAgICAgICAgICAgaWYgKGhlYWQgJiYgaGVhZCAhPT0gImRvYyIpIHsKICAgICAgICAgICAgICAgICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoaGVhZFswXSwgaGVhZFsxXSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJlcXVlc3QucmVzcG9uc2VUeXBlID0gImRvY3VtZW50IjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlcXVlc3Quc2VuZCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHBsYXllck1vZGUoKSB7CiAgICAgICAgICAgICAgICB2YXIgcGFnZUVsZW1lbnQsIHBsYXllckVsZW1lbnQ7CiAgICAgICAgICAgICAgICBpZiAodXNlcl9zZXR0aW5ncy5WSURfUExSX1NJWkVfTUVNKSB7CiAgICAgICAgICAgICAgICAgICAgcGFnZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGFnZSIpOwogICAgICAgICAgICAgICAgICAgIHBsYXllckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGxheWVyIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy55dHBzZXR3aWRlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy55dHBzZXR3aWRlKCJ3aWRlIiwgKHVzZXJfc2V0dGluZ3MudGhlYXRlck1vZGUgPyAiMSIgOiAiMCIpLCAtMSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXJFbGVtZW50ICYmIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSA9PT0gIi93YXRjaCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUVsZW1lbnQuY2xhc3NMaXN0W3VzZXJfc2V0dGluZ3MudGhlYXRlck1vZGUgPyAiYWRkIiA6ICJyZW1vdmUiXSgid2F0Y2gtd2lkZSIpOwogICAgICAgICAgICAgICAgICAgICAgICBwYWdlRWxlbWVudC5jbGFzc05hbWUgPSBwYWdlRWxlbWVudC5jbGFzc05hbWUucmVwbGFjZSh1c2VyX3NldHRpbmdzLnRoZWF0ZXJNb2RlID8gIm5vbi0iIDogIndhdGNoLXN0YWdlIiwgdXNlcl9zZXR0aW5ncy50aGVhdGVyTW9kZSA/ICIiIDogIndhdGNoLW5vbi1zdGFnZSIpOwogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJFbGVtZW50LmNsYXNzTmFtZSA9IHVzZXJfc2V0dGluZ3MudGhlYXRlck1vZGUgPyBwbGF5ZXJFbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKCJzbWFsbCIsICJsYXJnZSIpIDogcGxheWVyRWxlbWVudC5jbGFzc05hbWUucmVwbGFjZSgibGFyZ2UiLCAic21hbGwiKS5yZXBsYWNlKCJtZWRpdW0iLCAic21hbGwiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gaW5maW5pdGVTY3JvbGwoKSB7CiAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2ZXIsIGxvYWRNb3JlOwogICAgICAgICAgICAgICAgbG9hZE1vcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIubG9hZC1tb3JlLWJ1dHRvbiIpOwogICAgICAgICAgICAgICAgaWYgKGxvYWRNb3JlICYmIHVzZXJfc2V0dGluZ3MuR0VOX0lORl9TQ1JMKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFsb2FkTW9yZS5jbGFzc0xpc3QuY29udGFpbnMoImluZmluaXRlU2Nyb2xsIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9hZE1vcmUuY2xhc3NMaXN0LmFkZCgiaW5maW5pdGVTY3JvbGwiKTsKICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihpbmZpbml0ZVNjcm9sbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUobG9hZE1vcmUsIHthdHRyaWJ1dGVzOiB0cnVlfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghbG9hZE1vcmUuY2xhc3NMaXN0LmNvbnRhaW5zKCJzY3JvbGxkZXRlY3QiKSkgewogICAgICAgICAgICAgICAgICAgICAgICBsb2FkTW9yZS5jbGFzc0xpc3QuYWRkKCJzY3JvbGxkZXRlY3QiKTsKICAgICAgICAgICAgICAgICAgICAgICAgbG9hZE1vcmUuZGF0YXNldC5zY3JvbGxkZXRlY3RDYWxsYmFjayA9ICJsb2FkLW1vcmUtYXV0byI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrTmV3RmVhdHVyZXMoKSB7CiAgICAgICAgICAgICAgICB2YXIgaSwga2V5czsKICAgICAgICAgICAgICAgIGtleXMgPSBPYmplY3Qua2V5cyhkZWZhdWx0X3NldHRpbmdzKTsKICAgICAgICAgICAgICAgIGkgPSBrZXlzLmxlbmd0aDsKICAgICAgICAgICAgICAgIHdoaWxlIChpKSB7CiAgICAgICAgICAgICAgICAgICAgaSAtPSAxOwogICAgICAgICAgICAgICAgICAgIGlmICghdXNlcl9zZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eShrZXlzW2ldKSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZXQoa2V5c1tpXSwgZGVmYXVsdF9zZXR0aW5nc1trZXlzW2ldXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHNoYXJlQXBpKG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHBsYXllclJlYWR5KCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gcmVxdWVzdChldmVudCkgewogICAgICAgICAgICAgICAgdmFyIHZpZGVvX3BsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb3ZpZV9wbGF5ZXIiKTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCJmbG9hdGVyIik7CiAgICAgICAgICAgICAgICBpZiAodmlkZW9fcGxheWVyKSB7CiAgICAgICAgICAgICAgICAgICAgdmlkZW9fcGxheWVyLnJlbW92ZUF0dHJpYnV0ZSgic3R5bGUiKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZXJfc2V0dGluZ3MuVklEX1BMUl9BVFBMIHx8ICFldmVudC5kZXRhaWwudXJsLmluZGV4T2YoIi93YXRjaCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cueXRwbGF5ZXIgJiYgd2luZG93Lnl0cGxheWVyLmNvbmZpZyAmJiB3aW5kb3cueXRwbGF5ZXIuY29uZmlnLmxvYWRlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHdpbmRvdy55dHBsYXllci5jb25maWcubG9hZGVkOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5kZXN0cm95KCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHBhZ2VTY3JpcHRNZXNzYWdlcygpIHsKICAgICAgICAgICAgICAgIHZhciBrZXksIGdhdGUsIHNldHMsIG9ic2VydmVyOwogICAgICAgICAgICAgICAga2V5ID0gInBhcnJlY2VpdmUiOwogICAgICAgICAgICAgICAgZ2F0ZSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgICAgICAgICAgICAgIHNldHMgPSBKU09OLnBhcnNlKGdhdGUuZGF0YXNldFtrZXldIHx8IG51bGwpOwogICAgICAgICAgICAgICAgaWYgKCFnYXRlLnBhZ2VzY3JpcHQpIHsKICAgICAgICAgICAgICAgICAgICBnYXRlLnBhZ2VzY3JpcHQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIocGFnZVNjcmlwdE1lc3NhZ2VzKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIub2JzZXJ2ZShnYXRlLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6dHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbImRhdGEtIiArIGtleV0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChzZXRzKSB7CiAgICAgICAgICAgICAgICAgICAgdXNlcl9zZXR0aW5ncyA9IHNldHM7CiAgICAgICAgICAgICAgICAgICAgZ2F0ZS5kYXRhc2V0W2tleV0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0eWxlcygpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtcGFycmVjZWl2ZSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHNldChzZXR0aW5nLCBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nICE9PSAidXNlcl9zZXR0aW5ncyIpIHsKICAgICAgICAgICAgICAgICAgICB1c2VyX3NldHRpbmdzW3NldHRpbmddID0gbmV3X3ZhbHVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB1c2VyX3NldHRpbmdzID0gbmV3X3ZhbHVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQucGFyc2VuZCA9IEpTT04uc3RyaW5naWZ5KHVzZXJfc2V0dGluZ3MpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG1haW4oKSB7CiAgICAgICAgICAgICAgICBpZiAoaXNNYXRlcmlhbCgpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcGFnZVNjcmlwdE1lc3NhZ2VzKCk7CiAgICAgICAgICAgICAgICBjdXN0b21TdHlsZXMoKTsKICAgICAgICAgICAgICAgIHNldHRpbmdzTWVudSgpOwogICAgICAgICAgICAgICAgaW5maW5pdGVTY3JvbGwoKTsKICAgICAgICAgICAgICAgIHBsYXlsaXN0Q29udHJvbHMoKTsKICAgICAgICAgICAgICAgIHBsYXllck1vZGUoKTsKICAgICAgICAgICAgICAgIG1vZFBsYXllclNpemUoKTsKICAgICAgICAgICAgICAgIGFkdmFuY2VkT3B0aW9ucygpOwogICAgICAgICAgICAgICAgdm9sdW1lV2hlZWwoKTsKICAgICAgICAgICAgICAgIHN1YlBsYXlsaXN0KCk7CiAgICAgICAgICAgICAgICBhbHdheXNWaXNpYmxlKCk7CiAgICAgICAgICAgICAgICBtb2RUaHVtYnMoKTsKICAgICAgICAgICAgICAgIGVuaGFuY2VkRGV0YWlscygpOwogICAgICAgICAgICAgICAgbW9kQ29tbWVudHMoKTsKICAgICAgICAgICAgICAgIGRlZmF1bHRDaGFubmVsUGFnZSgpOwogICAgICAgICAgICAgICAgZ2VuZXJhbENoYW5nZXMoKTsKICAgICAgICAgICAgICAgIGRyYWdQb3BPdXQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBpc01hdGVyaWFsKCkgewogICAgICAgICAgICAgICAgdmFyIGksIHRlbXA7CiAgICAgICAgICAgICAgICB0ZW1wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigieXRkLWFwcCIpOwogICAgICAgICAgICAgICAgaWYgKHRlbXAgJiYgIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtYXRlcmlhbC1ub3RpY2UiKSkgewogICAgICAgICAgICAgICAgICAgIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIpOwogICAgICAgICAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gLy8KICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgaWQ9J21hdGVyaWFsLW5vdGljZScgc3R5bGU9J2JvcmRlci1yYWRpdXM6MnB4O2NvbG9yOiNGRkY7cGFkZGluZzoxMHB4O2JhY2tncm91bmQtY29sb3I6IzA5Rjtib3gtc2hhZG93OjAgMCAzcHggcmdiYSgwLDAsMCwuNSk7Zm9udC1zaXplOjEycHg7cG9zaXRpb246Zml4ZWQ7Ym90dG9tOjIwcHg7cmlnaHQ6MjBweDt6LWluZGV4Ojk5OTk5Jz4KICAgICAgICAgICAgICAgICAgICAgICAgWW91VHViZSBQbHVzIGlzIG5vdCB5ZXQgY29tcGF0aWJsZSB3aXRoIHRoZSBZb3VUdWJlIGJldGEgTWF0ZXJpYWwgTGF5b3V0PGJyPgogICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvUmVzdG9yZS1jbGFzc2ljLVlvdVR1YmUnIHRhcmdldD0nX2JsYW5rJyBzdHlsZT0nY29sb3I6I0ZGRjtmb250LXdlaWdodDpib2xkOyc+Q2xpY2sgaGVyZTwvYT4gZm9yIGluc3RydWN0aW9ucyB0byByZXN0b3JlIGNsYXNzaWMgWW91VHViZSBhbmQgY29udGludWUgdXNpbmcgWVQrPGJyPgogICAgICAgICAgICAgICAgICAgICAgICBUbyBrZWVwIHVzaW5nIHRoZSBjdXJyZW50IGxheW91dCB3aXRob3V0IHRoaXMgbWVzc2FnZSBwbGVhc2UgZGlzYWJsZSBZVCsKICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodGVtcC5jb250ZW50LmZpcnN0Q2hpbGQpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtdXNlcl9zZXR0aW5ncyIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGNsb3NlTWlncmF0aW9uSW5zdHJ1Y3Rpb25zKGV2ZW50KSB7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQgJiYgZXZlbnQudGFyZ2V0ICYmIGV2ZW50LnRhcmdldC5pZCA9PT0gImNsb3NlX21pZ3JhdGlvbl9pbnN0cnVjdGlvbnMiKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBjbG9zZU1pZ3JhdGlvbkluc3RydWN0aW9ucyk7CiAgICAgICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUub3V0ZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICAgICAgc2V0KCJtaWdyYXRpb25faW5zdHJ1Y3Rpb25zIiwgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbWlncmF0aW9uSW5zdHJ1Y3Rpb25zKCkgewogICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ZW1wbGF0ZSIpOwogICAgICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSAvLwogICAgICAgICAgICAgICAgICAgIGA8ZGl2IHN0eWxlPSdib3JkZXItcmFkaXVzOiAycHg7IGNvbG9yOiAjRkZGOyBmb250OiAxMnB4IFJvYm90byxhcmlhbCxzYW5zLXNlcmlmOyBwYWRkaW5nOiAxMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMCwgMTUzLCAyNTUpOyBib3gtc2hhZG93OiAwcHggMHB4IDNweCByZ2JhKDAsIDAsIDAsIDAuNSk7IHBvc2l0aW9uOiBmaXhlZDsgei1pbmRleDogOTk5OTk7IHRvcDogNTAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOyc+CiAgICAgICAgICAgICAgICAgICAgWW91VHViZSBQbHVzIGhhcyBiZWVuIHVwZGF0ZWQgYW5kIGlzIG5vdyBhIFdlYmV4dGVuc2lvbi4gVW5mb3J0dW5hdGVseSB0aGlzIG1lYW5zIHRoYXQgeW91ciBwcmV2aW91cyBzZXR0aW5ncyBuZWVkIHRvIGJlIGltcG9ydGVkIG1hbnVhbGx5Ljxicj4KICAgICAgICAgICAgICAgICAgICA8YSBocmVmPSdodHRwczovL2dpdGh1Yi5jb20vUGFydGljbGVDb3JlL1BhcnRpY2xlL3dpa2kvUmVzdG9yZS1zZXR0aW5ncycgdGFyZ2V0PSdfYmxhbmsnIHN0eWxlPSdjb2xvcjojRkZGO2ZvbnQtd2VpZ2h0OmJvbGQ7Jz5DbGljayBoZXJlPC9hPiBpZiB5b3Ugd2lzaCB0byBpbXBvcnQgdGhlIHByZXZpb3VzIHNldHRpbmdzIG9yIGtub3cgbW9yZSBhYm91dCB0aGlzIGNoYW5nZS48YnI+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0nY2xvc2VfbWlncmF0aW9uX2luc3RydWN0aW9ucycgc3R5bGU9J2JhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKTsgY29sb3I6ICNGRkY7IGN1cnNvcjogcG9pbnRlcjsgbWFyZ2luLXRvcDogMTBweDsgYm9yZGVyLXJhZGl1czogMnB4OyBwYWRkaW5nOiA0cHg7IGZsb2F0OiByaWdodDsnPkNMT1NFPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZCh0ZW1wLmNvbnRlbnQuZmlyc3RDaGlsZCk7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGNsb3NlTWlncmF0aW9uSW5zdHJ1Y3Rpb25zKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgYXBpLCBjaWQsIGV2ZW50cywgbGFuZ3VhZ2UsIHVzZXJfc2V0dGluZ3MsIHBsYXllcl9pbnN0YW5jZSwgZGVmYXVsdF9zZXR0aW5nczsKICAgICAgICAgICAgaWYgKGlzTWF0ZXJpYWwoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNpZCA9IHt9OwogICAgICAgICAgICBldmVudHMgPSB7fTsKICAgICAgICAgICAgdXNlcl9zZXR0aW5ncyA9IEpTT04ucGFyc2UoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQudXNlcl9zZXR0aW5ncyB8fCBudWxsKTsKICAgICAgICAgICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kYXRhc2V0LnVzZXJfc2V0dGluZ3MpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtdXNlcl9zZXR0aW5ncyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRlZmF1bHRfc2V0dGluZ3MgPSB7CiAgICAgICAgICAgICAgICBHRU5fQlRUUl9OVEYgICAgOiB0cnVlLAogICAgICAgICAgICAgICAgR0VOX1NVQl9MSVNUICAgIDogdHJ1ZSwKICAgICAgICAgICAgICAgIEdFTl9JTkZfU0NSTCAgICA6IHRydWUsCiAgICAgICAgICAgICAgICBHRU5fQkxVRV9HTE9XICAgOiB0cnVlLAogICAgICAgICAgICAgICAgR0VOX1BQT1RfT04gICAgIDogdHJ1ZSwKICAgICAgICAgICAgICAgIFZJRF9FTkRfU0hSRSAgICA6IHRydWUsCiAgICAgICAgICAgICAgICBWSURfREZMVF9RTFRZICAgOiAiYXV0byIsCiAgICAgICAgICAgICAgICBWSURfUExTVF9BVFBMICAgOiB0cnVlLAogICAgICAgICAgICAgICAgVklEX1BMU1RfUlZSUyAgIDogdHJ1ZSwKICAgICAgICAgICAgICAgIFZJRF9QTFJfQVRQTCAgICA6IHRydWUsCiAgICAgICAgICAgICAgICBWSURfUExSX0FMVklTICAgOiB0cnVlLAogICAgICAgICAgICAgICAgVklEX1BMUl9TSVpFX01FTTogdHJ1ZSwKICAgICAgICAgICAgICAgIFZJRF9QTFJfVk9MX0xETiA6IHRydWUsCiAgICAgICAgICAgICAgICBWSURfUE9TVF9USU1FICAgOiB0cnVlLAogICAgICAgICAgICAgICAgVklEX1ZJRF9DTlQgICAgIDogdHJ1ZSwKICAgICAgICAgICAgICAgIFZJRF9ERVNDX1NIUlQgICA6IHRydWUsCiAgICAgICAgICAgICAgICBWSURfUFBPVF9TWiAgICAgOiA1MzMsCiAgICAgICAgICAgICAgICBWSURfUExSX0hUTUw1ICAgOiB0cnVlLAogICAgICAgICAgICAgICAgQkxLX09OICAgICAgICAgIDogdHJ1ZSwKICAgICAgICAgICAgICAgIGZsb2F0ZXJYICAgICAgICA6IDIwMDAsCiAgICAgICAgICAgICAgICBmbG9hdGVyWSAgICAgICAgOiAyMDAwLAogICAgICAgICAgICAgICAgZmlyc3RUaW1lICAgICAgIDogdHJ1ZSwKICAgICAgICAgICAgICAgIHZvbExldiAgICAgICAgICA6IDUwLAogICAgICAgICAgICAgICAgYWR2T3B0cyAgICAgICAgIDogdHJ1ZSwKICAgICAgICAgICAgICAgIGJsYWNrbGlzdCAgICAgICA6IHt9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGxhbmd1YWdlID0gewogICAgICAgICAgICAgICAgWVRTRVRTICAgICAgICAgICAgICAgIDogIllvdVR1YmUrIHNldHRpbmdzIiwKICAgICAgICAgICAgICAgIEFEVl9PUFRTICAgICAgICAgICAgICA6ICJBZHZhbmNlZCBvcHRpb25zIiwKICAgICAgICAgICAgICAgIFNVQl9QTFNUICAgICAgICAgICAgICA6ICJQbGF5IHJlY2VudCB1cGxvYWRzIiwKICAgICAgICAgICAgICAgIFBQT1RfT1BFTiAgICAgICAgICAgICA6ICJPcGVuIGluIHBvcC1vdXQiLAogICAgICAgICAgICAgICAgQkxDS19BREQgICAgICAgICAgICAgIDogIkFkZCB0byBibGFja2xpc3QiLAogICAgICAgICAgICAgICAgQkxDS19FRElUICAgICAgICAgICAgIDogIkVkaXQiLAogICAgICAgICAgICAgICAgQkxDS19TQVZFICAgICAgICAgICAgIDogIlNhdmUiLAogICAgICAgICAgICAgICAgQkxDS19DTFNFICAgICAgICAgICAgIDogIkNsb3NlIiwKICAgICAgICAgICAgICAgIENOU0xfQVAgICAgICAgICAgICAgICA6ICJBdXRvcGxheSIsCiAgICAgICAgICAgICAgICBDTlNMX1JQVCAgICAgICAgICAgICAgOiAiUmVwZWF0IHZpZGVvIiwKICAgICAgICAgICAgICAgIENOU0xfU1ZUSCAgICAgICAgICAgICA6ICJPcGVuIHRodW1ibmFpbCIsCiAgICAgICAgICAgICAgICBDTlNMX1NTICAgICAgICAgICAgICAgOiAiVGFrZSBzY3JlZW5zaG90IiwKICAgICAgICAgICAgICAgIENOU0xfU1NfQ0xTICAgICAgICAgICA6ICJDTE9TRSIsCiAgICAgICAgICAgICAgICBDTlNMX1BQT1QgICAgICAgICAgICAgOiAiUG9wLW91dCB2aWRlbyIsCiAgICAgICAgICAgICAgICBDTlNMX0ZMQlIgICAgICAgICAgICAgOiAiRnVsbGJyb3dzZXIgbW9kZSIsCiAgICAgICAgICAgICAgICBDTlNMX0NJTk1fTUQgICAgICAgICAgOiAiQ2luZW1hIG1vZGUiLAogICAgICAgICAgICAgICAgQ05TTF9ZVFNDICAgICAgICAgICAgIDogIllvdVR1YmUgc2hvcnRjdXRzIGxpc3QiLAogICAgICAgICAgICAgICAgUExTVF9BUCAgICAgICAgICAgICAgIDogIkF1dG9wbGF5IiwKICAgICAgICAgICAgICAgIFBMU1RfUlZSUyAgICAgICAgICAgICA6ICJSZXZlcnNlIiwKICAgICAgICAgICAgICAgIFNIT1dfQ01UUyAgICAgICAgICAgICA6ICJTaG93IGNvbW1lbnRzIiwKICAgICAgICAgICAgICAgIEhJREVfQ01UUyAgICAgICAgICAgICA6ICJIaWRlIGNvbW1lbnRzIiwKICAgICAgICAgICAgICAgIEdMQl9JTVBSICAgICAgICAgICAgICA6ICJJbXBvcnQvZXhwb3J0IHNldHRpbmdzIiwKICAgICAgICAgICAgICAgIEdMQl9MT0NMX0xBTkcgICAgICAgICA6ICJDbGljayB0byBlZGl0IFlUKyBsYW5ndWFnZSIsCiAgICAgICAgICAgICAgICBHTEJfTE9DTF9MQU5HX0NTVE0gICAgOiAiTG9jYWwiLAogICAgICAgICAgICAgICAgR0xCX0lNUFJfU0FWRSAgICAgICAgIDogIlNhdmUgYW5kIGxvYWQiLAogICAgICAgICAgICAgICAgR0xCX1JTRVQgICAgICAgICAgICAgIDogIlJlc2V0IiwKICAgICAgICAgICAgICAgIEdMQl9SU0VUX0NPTkYgICAgICAgICA6ICJUaGlzIHdpbGwgcmVzZXQgWVQrIHNldHRpbmdzIGFuZCB0aGUgYmxhY2tsaXN0IHdpbGwgYmUgZXJhc2VkLiBEbyB5b3Ugd2FudCB0byBjb250aW51ZT8iLAogICAgICAgICAgICAgICAgR0xCX1NWRSAgICAgICAgICAgICAgIDogIlNhdmUiLAogICAgICAgICAgICAgICAgR0xCX1NWRV9TRVRTICAgICAgICAgIDogIlNldHRpbmdzIHNhdmVkIiwKICAgICAgICAgICAgICAgIEdMQl9STUJMICAgICAgICAgICAgICA6ICJSZW1vdmUgZnJvbSBibGFja2xpc3QiLAogICAgICAgICAgICAgICAgRlRSX0RFU0MgICAgICAgICAgICAgIDogIkZpbmQgb3V0IHdoYXQgdGhpcyBkb2VzIiwKICAgICAgICAgICAgICAgIEdFTiAgICAgICAgICAgICAgICAgICA6ICJHZW5lcmFsIiwKICAgICAgICAgICAgICAgIFZJRCAgICAgICAgICAgICAgICAgICA6ICJWaWRlbyIsCiAgICAgICAgICAgICAgICBDSE4gICAgICAgICAgICAgICAgICAgOiAiQ2hhbm5lbHMiLAogICAgICAgICAgICAgICAgQkxLICAgICAgICAgICAgICAgICAgIDogIkJsYWNrbGlzdCIsCiAgICAgICAgICAgICAgICBBQlQgICAgICAgICAgICAgICAgICAgOiAiQWJvdXQiLAogICAgICAgICAgICAgICAgSExQICAgICAgICAgICAgICAgICAgIDogIkhlbHAiLAogICAgICAgICAgICAgICAgRE5UICAgICAgICAgICAgICAgICAgIDogIkRvbmF0ZSIsCiAgICAgICAgICAgICAgICBHRU5fVFRMICAgICAgICAgICAgICAgOiAiR2VuZXJhbCBzZXR0aW5ncyIsCiAgICAgICAgICAgICAgICBHRU5fR0VOICAgICAgICAgICAgICAgOiAiR2VuZXJhbCIsCiAgICAgICAgICAgICAgICBHRU5fTFlUICAgICAgICAgICAgICAgOiAiTGF5b3V0IiwKICAgICAgICAgICAgICAgIEdFTl9MT0NMX0xBTkcgICAgICAgICA6ICJVc2UgbW9kaWZpZWQgWVQrIGxhbmd1YWdlIiwKICAgICAgICAgICAgICAgIEdFTl9QUE9UX09OICAgICAgICAgICA6ICJFbmFibGUgcG9wLW91dCBtb2RlIiwKICAgICAgICAgICAgICAgIEdFTl9EU0JMX0FEUyAgICAgICAgICA6ICJEaXNhYmxlIGFkdmVydGlzZW1lbnRzIG91dHNpZGUgdGhlIHZpZGVvIHBhZ2UiLAogICAgICAgICAgICAgICAgR0VOX0lORl9TQ1JMICAgICAgICAgIDogIkVuYWJsZSBpbmZpbml0ZSBzY3JvbGwgaW4gZmVlZHMiLAogICAgICAgICAgICAgICAgR0VOX1lUX0xPR09fTElOSyAgICAgIDogIllvdVR1YmUgbG9nbyByZWRpcmVjdHMgdG8gc3Vic2NyaXB0aW9ucyIsCiAgICAgICAgICAgICAgICBHRU5fU1VCX0xJU1QgICAgICAgICAgOiAiRW5hYmxlIHN1YnNjcmlwdGlvbiBwbGF5bGlzdCIsCiAgICAgICAgICAgICAgICBHRU5fUkVNX0FQVU4gICAgICAgICAgOiAiUmVtb3ZlIGF1dG9wbGF5IHVwIG5leHQiLAogICAgICAgICAgICAgICAgR0VOX1NQRl9PRkYgICAgICAgICAgIDogIkRpc2FibGUgU1BGIiwKICAgICAgICAgICAgICAgIEdFTl9ISURFX0ZUUiAgICAgICAgICA6ICJIaWRlIGZvb3RlciIsCiAgICAgICAgICAgICAgICBHRU5fQkxVRV9HTE9XICAgICAgICAgOiAiUmVtb3ZlIGJsdWUgZ2xvdyBhcm91bmQgY2xpY2tlZCBidXR0b25zIiwKICAgICAgICAgICAgICAgIEdFTl9IREVfUkVDTV9TREJSICAgICA6ICJIaWRlIHJlY29tbWVuZGVkIGNoYW5uZWxzIHNpZGViYXIiLAogICAgICAgICAgICAgICAgR0VOX0hERV9TUkNIX1NEQlIgICAgIDogIkhpZGUgc2VhcmNoIHJlc3VsdHMgc2lkZWJhciIsCiAgICAgICAgICAgICAgICBHRU5fSERFX0NITl9TREJSICAgICAgOiAiSGlkZSBjaGFubmVsIHNpZGViYXIiLAogICAgICAgICAgICAgICAgR0VOX0NNUFRfVFRMUyAgICAgICAgIDogIkNvbXBhY3QgdGl0bGVzIGluIGZlZWRzIiwKICAgICAgICAgICAgICAgIEdFTl9EU0JfSFZSQyAgICAgICAgICA6ICJEaXNhYmxlIGhvdmVyY2FyZHMiLAogICAgICAgICAgICAgICAgR0VOX0JUVFJfTlRGICAgICAgICAgIDogIkltcHJvdmVkIGJsdWUgbm90aWZpY2F0aW9uIGJveCIsCiAgICAgICAgICAgICAgICBHRU5fR1JJRF9TVUJTICAgICAgICAgOiAiR3JpZCBsYXlvdXQgaW4gc3Vic2NyaXB0aW9ucyIsCiAgICAgICAgICAgICAgICBHRU5fR1JJRF9TUkNIICAgICAgICAgOiAiR3JpZCBsYXlvdXQgaW4gc2VhcmNoIHJlc3VsdHMiLAogICAgICAgICAgICAgICAgVklEX1RUTCAgICAgICAgICAgICAgIDogIlZpZGVvIHNldHRpbmdzIiwKICAgICAgICAgICAgICAgIFZJRF9QTFIgICAgICAgICAgICAgICA6ICJQbGF5ZXIgc2V0dGluZ3MiLAogICAgICAgICAgICAgICAgVklEX1BMUl9MWVQgICAgICAgICAgIDogIlBsYXllciBsYXlvdXQiLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWSAgICAgICAgIDogIkRlZmF1bHQgdmlkZW8gcXVhbGl0eToiLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWV9BVVRPICAgIDogIkF1dG8iLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWV9UTlkgICAgIDogIjE0NHAiLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWV9TTUwgICAgIDogIjI0MHAiLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWV9NRE0gICAgIDogIjM2MHAiLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWV9MUkcgICAgIDogIjQ4MHAiLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWV83MjAgICAgIDogIjcyMHAiLAogICAgICAgICAgICAgICAgVklEX0RGTFRfUUxUWV8xMDgwICAgIDogIjEwODBwIiwKICAgICAgICAgICAgICAgIFZJRF9ERkxUX1FMVFlfMTQ0MCAgICA6ICIxNDQwcCIsCiAgICAgICAgICAgICAgICBWSURfREZMVF9RTFRZXzIxNjAgICAgOiAiMjE2MHAgKDRrKSIsCiAgICAgICAgICAgICAgICBWSURfREZMVF9RTFRZXzI4ODAgICAgOiAiMjg4MHAgKDVrKSIsCiAgICAgICAgICAgICAgICBWSURfREZMVF9RTFRZX09SSUcgICAgOiAiNDMyMHAgKDhrKSIsCiAgICAgICAgICAgICAgICBWSURfUExSX0FMVklTICAgICAgICAgOiAiUGxheWVyIGFsd2F5cyB2aXNpYmxlIHdoZW4gcmVhZGluZyBjb21tZW50cyIsCiAgICAgICAgICAgICAgICBWSURfUExSX0FMVklTX1dEVEggICAgOiAiRmxvYXRpbmcgcGxheWVyIHdpZHRoIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfQUxWSVNfTU9WRSAgICA6ICJNb3ZlIHBsYXllciIsCiAgICAgICAgICAgICAgICBWSURfUExSX0FMVklTX1NDUkxfVE9QOiAiR28gdG8gdG9wIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfQVRQTCAgICAgICAgICA6ICJBdXRvcGxheSB2aWRlb3MiLAogICAgICAgICAgICAgICAgVklEX0xBWVQgICAgICAgICAgICAgIDogIkxheW91dCIsCiAgICAgICAgICAgICAgICBWSURfVklEX0NOVCAgICAgICAgICAgOiAiU2hvdyBsaW5rIHdpdGggbnVtYmVyIG9mIHVwbG9hZGVkIHZpZGVvcyIsCiAgICAgICAgICAgICAgICBWSURfUE9TVF9USU1FICAgICAgICAgOiAiU2hvdyBob3cgbG9uZyB0aGUgdmlkZW8gaGFzIGJlZW4gcHVibGlzaGVkIiwKICAgICAgICAgICAgICAgIFZJRF9ISURFX0RFVExTICAgICAgICA6ICJIaWRlIHZpZGVvIGRldGFpbHMiLAogICAgICAgICAgICAgICAgVklEX0hJREVfQ09NUyAgICAgICAgIDogIkNvbW1lbnQgc2VjdGlvbiIsCiAgICAgICAgICAgICAgICBWSURfSElERV9DT01TX1NIT1cgICAgOiAiU2hvdyIsCiAgICAgICAgICAgICAgICBWSURfSElERV9DT01TX0hJREUgICAgOiAiSGlkZSIsCiAgICAgICAgICAgICAgICBWSURfSElERV9DT01TX1JFTSAgICAgOiAiUmVtb3ZlIiwKICAgICAgICAgICAgICAgIFZJRF9FTkRfU0hSRSAgICAgICAgICA6ICJEaXNhYmxlIHNoYXJlIHBhbmVsIHdoZW4gdmlkZW8gZW5kcyIsCiAgICAgICAgICAgICAgICBWSURfUExTVCAgICAgICAgICAgICAgOiAiUGxheWxpc3RzIiwKICAgICAgICAgICAgICAgIFZJRF9QTFNUX0FUUEwgICAgICAgICA6ICJFbmFibGUgcGxheWxpc3QgYXV0b3BsYXkgY29udHJvbCIsCiAgICAgICAgICAgICAgICBWSURfUExTVF9SVlJTICAgICAgICAgOiAiRW5hYmxlIHJldmVyc2UgcGxheWxpc3QgY29udHJvbCIsCiAgICAgICAgICAgICAgICBWSURfUExSX1NJWkVfTUVNICAgICAgOiAiTWVtb3JpemUgcGxheWVyIG1vZGUiLAogICAgICAgICAgICAgICAgVklEX1ZPTF9XSEVFTCAgICAgICAgIDogIkNoYW5nZSB2b2x1bWUgd2l0aCBtb3VzZSB3aGVlbCIsCiAgICAgICAgICAgICAgICBWSURfUExSX1ZPTF9NRU0gICAgICAgOiAiTWVtb3JpemUgYXVkaW8gdm9sdW1lIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfVk9MX0xETiAgICAgICA6ICJEaXNhYmxlIFlvdVR1YmUgbG91ZG5lc3Mgbm9ybWFsaXNhdGlvbiIsCiAgICAgICAgICAgICAgICBWSURfUExSX0FEUyAgICAgICAgICAgOiAiRGlzYWJsZSBhZHZlcnRpc2VtZW50cyBpbiB0aGUgdmlkZW8gcGFnZSIsCiAgICAgICAgICAgICAgICBWSURfUExSX0FMQUNUICAgICAgICAgOiAiUGxheWVyIHNob3J0Y3V0cyBhbHdheXMgYWN0aXZlIiwKICAgICAgICAgICAgICAgIFZJRF9TVUJfQURTICAgICAgICAgICA6ICJFbmFibGUgYWR2ZXJ0aXNlbWVudHMgb25seSBpbiB2aWRlb3MgZnJvbSBzdWJzY3JpYmVkIGNoYW5uZWxzIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfQU5UUyAgICAgICAgICA6ICJEaXNhYmxlIGFubm90YXRpb25zIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfSEZSICAgICAgICAgICA6ICJEaXNhYmxlIEhGUiAoNjBmcHMpIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfSFRNTDUgICAgICAgICA6ICJVc2UgdGhlIEhUTUw1IHBsYXllciB3aGVuIHBvc3NpYmxlIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfQ0MgICAgICAgICAgICA6ICJEaXNhYmxlIHN1YnRpdGxlcyBhbmQgQ0MiLAogICAgICAgICAgICAgICAgVklEX1BMUl9JTkZPICAgICAgICAgIDogIkVuYWJsZSBpbmZvIGJhciB3aXRoIHdhdGNoIGxhdGVyIGJ1dHRvbiIsCiAgICAgICAgICAgICAgICBWSURfUExSX0ZJVCAgICAgICAgICAgOiAiRml0IHRvIHBhZ2UgaW4gdGhlYXRlciBtb2RlIiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfRklUX1dEVEggICAgICA6ICJGaXQgdG8gcGFnZSBtYXggd2lkdGg6IiwKICAgICAgICAgICAgICAgIFZJRF9QTFJfRFlOX1NJWkUgICAgICA6ICJEaXNhYmxlIGR5bmFtaWMgcGxheWVyIHNpemUgaW4gZGVmYXVsdCB2aWV3IiwKICAgICAgICAgICAgICAgIFZJRF9ERVNDX1NIUlQgICAgICAgICA6ICJTaG9ydCB2aWRlbyBkZXNjcmlwdGlvbiBidXR0b25zIiwKICAgICAgICAgICAgICAgIFZJRF9UVExfQ01QVCAgICAgICAgICA6ICJDb21wYWN0IHRpdGxlIGluIHZpZGVvIGRlc2NyaXB0aW9uIiwKICAgICAgICAgICAgICAgIFZJRF9QUE9UX1NaICAgICAgICAgICA6ICJQb3Atb3V0IHBsYXllciBzaXplIiwKICAgICAgICAgICAgICAgIFZJRF9MQVlUX0FVVE9fUE5MICAgICA6ICJBdXRvIGV4cGFuZCB2aWRlbyBkZXNjcmlwdGlvbiIsCiAgICAgICAgICAgICAgICBHRU5fQ0hOX0RGTFRfUEFHRSAgICAgOiAiRGVmYXVsdCBjaGFubmVsIHBhZ2U6IiwKICAgICAgICAgICAgICAgIEdFTl9DSE5fREZMVF9QQUdFX0RGTFQ6ICJEZWZhdWx0IiwKICAgICAgICAgICAgICAgIEdFTl9DSE5fREZMVF9QQUdFX1ZJRCA6ICJWaWRlb3MiLAogICAgICAgICAgICAgICAgR0VOX0NITl9ERkxUX1BBR0VfUEwgIDogIlBsYXlsaXN0cyIsCiAgICAgICAgICAgICAgICBHRU5fQ0hOX0RGTFRfUEFHRV9DSE4gOiAiQ2hhbm5lbHMiLAogICAgICAgICAgICAgICAgR0VOX0NITl9ERkxUX1BBR0VfRElTQzogIkRpc2N1c3Npb24iLAogICAgICAgICAgICAgICAgR0VOX0NITl9ERkxUX1BBR0VfQUJUIDogIkFib3V0IiwKICAgICAgICAgICAgICAgIEJMS19UVEwgICAgICAgICAgICAgICA6ICJCbGFja2xpc3Qgc2V0dGluZ3MiLAogICAgICAgICAgICAgICAgQkxLX0JMSyAgICAgICAgICAgICAgIDogIkJsYWNrbGlzdCIsCiAgICAgICAgICAgICAgICBCTEtfT04gICAgICAgICAgICAgICAgOiAiRW5hYmxlIGJsYWNrbGlzdCIsCiAgICAgICAgICAgICAgICBBQlRfVFRMICAgICAgICAgICAgICAgOiAiSW5mb3JtYXRpb24gYW5kIHVzZWZ1bCBsaW5rcyIsCiAgICAgICAgICAgICAgICBBQlRfVEhLUyAgICAgICAgICAgICAgOiAiVGhhbmtzIHRvOiIsCiAgICAgICAgICAgICAgICBBQlRfVEhLU19ZRVBQSEEgICAgICAgOiAiLCB3aG8ncyB3b3JrIGluc3BpcmVkIHRoZSBjcmVhdGlvbiBvZiB0aGlzIHByb2plY3QsIHdpdGhvdXQgd2hvbSBub25lIG9mIHRoaXMgd291bGQgZXhpc3QgdG9kYXkuIiwKICAgICAgICAgICAgICAgIEFCVF9USEtTX1VTRVJTQ1JJUFQgICA6ICIgZm9yIG1ha2luZyB0aGUgdGFzayBvZiBkZXZlbG9waW5nIGFuZCBzaGlwcGluZyB0aGlyZCBwYXJ0eSBzb2Z0d2FyZSBpbmNyZWRpYmx5IGVhc2llci4iLAogICAgICAgICAgICAgICAgQUJUX1RIS1NfU1RBQ0tPViAgICAgIDogIiBmb3IgYWxsIG9mIGl0cyBwcmljZWxlc3MgaW5mb3JtYXRpb24gd2hpY2ggZ3JlYXRseSBjb250cmlidXRlcyBmb3Igc29mdHdhcmUgZGV2ZWxvcG1lbnQuIiwKICAgICAgICAgICAgICAgIEFCVF9JTkZPICAgICAgICAgICAgICA6ICJPZmZpY2lhbCBwYWdlcyIsCiAgICAgICAgICAgICAgICBBQlRfTE5LX0dIQiAgICAgICAgICAgOiAiR2l0SHViIiwKICAgICAgICAgICAgICAgIEFCVF9MTktfR1JGSyAgICAgICAgICA6ICJHcmVhc3kgRm9yayIsCiAgICAgICAgICAgICAgICBBQlRfTE5LX09QTlUgICAgICAgICAgOiAiT3BlblVzZXJKUyIsCiAgICAgICAgICAgICAgICBXTENNICAgICAgICAgICAgICAgICAgOiAiVGhhbmsgeW91IGZvciBpbnN0YWxsaW5nIFlvdVR1YmUrIiwKICAgICAgICAgICAgICAgIFdMQ01TVFJUICAgICAgICAgICAgICA6ICJZb3UgY2FuIGN1c3RvbWl6ZSB5b3VyIHNldHRpbmdzIGJ5IGNsaWNraW5nIHRoZSBidXR0b24gYWJvdmUiLAogICAgICAgICAgICAgICAgV0xDTUZUUlMgICAgICAgICAgICAgIDogIkNsaWNrIGhlcmUgdG8gc2VlIGFsbCB0aGUgZmVhdHVyZXMiLAogICAgICAgICAgICAgICAgTE9DQUxFICAgICAgICAgICAgICAgIDogIkVuZ2xpc2ggKFVTKSIKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYgKCF1c2VyX3NldHRpbmdzIHx8IE9iamVjdC5rZXlzKHVzZXJfc2V0dGluZ3MpLmxlbmd0aCA8IDEpIHsKICAgICAgICAgICAgICAgIHVzZXJfc2V0dGluZ3MgPSBkZWZhdWx0X3NldHRpbmdzOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2hlY2tOZXdGZWF0dXJlcygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh3aW5kb3cuY2hyb21lKSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsIHNjcmlwdEV4aXQsIHRydWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiYWZ0ZXJzY3JpcHRleGVjdXRlIiwgc2NyaXB0RXhpdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFpc191c2Vyc2NyaXB0ICYmICF3aW5kb3cuY2hyb21lICYmICF1c2VyX3NldHRpbmdzLm1pZ3JhdGlvbl9pbnN0cnVjdGlvbnMpIHsKICAgICAgICAgICAgICAgIG1pZ3JhdGlvbkluc3RydWN0aW9ucygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoInNwZmRvbmUiLCBtYWluKTsKICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigic3BmcmVxdWVzdCIsIHJlcXVlc3QpOwogICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJyZWFkeXN0YXRlY2hhbmdlIiwgbWFpbiwgdHJ1ZSk7CiAgICAgICAgICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gY2hlY2tYSFIoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm9wZW4pOwogICAgICAgICAgICB3aW5kb3cub25Zb3VUdWJlUGxheWVyUmVhZHkgPSBzaGFyZUFwaSh3aW5kb3cub25Zb3VUdWJlUGxheWVyUmVhZHkpOwogICAgICAgICAgICB3aW5kb3cubWF0Y2hNZWRpYSA9IG1vZE1hdGNoTWVkaWEod2luZG93Lm1hdGNoTWVkaWEpOwogICAgICAgICAgICBtYWluKCk7CiAgICAgICAgfSwKICAgICAgICBjb250ZW50U2NyaXB0TWVzc2FnZXM6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIga2V5MSwga2V5MiwgZ2F0ZSwgc2V0cywgbG9jcywgb2JzZXJ2ZXI7CiAgICAgICAgICAgIGtleTEgPSAicGFyc2VuZCI7CiAgICAgICAgICAgIGtleTIgPSAiZ2V0bG9jYWxlIjsKICAgICAgICAgICAgZ2F0ZSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgICAgICAgICAgc2V0cyA9IEpTT04ucGFyc2UoZ2F0ZS5kYXRhc2V0W2tleTFdIHx8IG51bGwpOwogICAgICAgICAgICBsb2NzID0gZ2F0ZS5kYXRhc2V0W2tleTJdIHx8IG51bGw7CiAgICAgICAgICAgIGlmICghZ2F0ZS5jb250ZW50c2NyaXB0KSB7CiAgICAgICAgICAgICAgICBnYXRlLmNvbnRlbnRzY3JpcHQgPSB0cnVlOwogICAgICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihwYXJ0aWNsZS5jb250ZW50U2NyaXB0TWVzc2FnZXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLm9ic2VydmUoZ2F0ZSwgewogICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbImRhdGEtIiArIGtleTEsICJkYXRhLSIgKyBrZXkyXQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHNldHMpIHsKICAgICAgICAgICAgICAgIGlmIChwYXJ0aWNsZS5pc191c2Vyc2NyaXB0KSB7CiAgICAgICAgICAgICAgICAgICAgcGFydGljbGUuR01fc2V0VmFsdWUocGFydGljbGUuaWQsIEpTT04uc3RyaW5naWZ5KHNldHMpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHtwYXJ0aWNsZVNldHRpbmdzOiBzZXRzfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCJkYXRhLXBhcnNlbmQiKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChsb2NzKSB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZGF0YXNldC5zZXRsb2NhbGUgPSBjaHJvbWUuaTE4bi5nZXRNZXNzYWdlKGxvY3MpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmaWx0ZXJDaHJvbWVLZXlzOiBmdW5jdGlvbihrZXlzKSB7CiAgICAgICAgICAgIGlmIChrZXlzW3BhcnRpY2xlLmlkXSAmJiBrZXlzW3BhcnRpY2xlLmlkXS5uZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kYXRhc2V0LnBhcnJlY2VpdmUgPSBKU09OLnN0cmluZ2lmeSgKICAgICAgICAgICAgICAgICAgICAoa2V5c1twYXJ0aWNsZS5pZF0ubmV3X3ZhbHVlICYmIGtleXNbcGFydGljbGUuaWRdLm5ld192YWx1ZVtwYXJ0aWNsZS5pZF0pIHx8IGtleXNbcGFydGljbGUuaWRdLm5ld192YWx1ZSB8fCB7fQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgbWFpbjogZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgdmFyIGhvbGRlcjsKICAgICAgICAgICAgaWYgKCFldmVudCAmJiBwYXJ0aWNsZS5pc191c2Vyc2NyaXB0KSB7CiAgICAgICAgICAgICAgICBldmVudCA9IEpTT04ucGFyc2UocGFydGljbGUuR01fZ2V0VmFsdWUocGFydGljbGUuaWQsICJ7fSIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZXZlbnQpIHsKICAgICAgICAgICAgICAgIGV2ZW50ID0gSlNPTi5zdHJpbmdpZnkoZXZlbnRbcGFydGljbGUuaWRdIHx8IGV2ZW50KTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kYXRhc2V0LnVzZXJfc2V0dGluZ3MgPSBldmVudDsKICAgICAgICAgICAgICAgIGlmIChwYXJ0aWNsZS5pc191c2Vyc2NyaXB0KSB7CiAgICAgICAgICAgICAgICAgICAgaG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGluayIpOwogICAgICAgICAgICAgICAgICAgIGhvbGRlci5yZWwgPSAic3R5bGVzaGVldCI7CiAgICAgICAgICAgICAgICAgICAgaG9sZGVyLnR5cGUgPSAidGV4dC9jc3MiOwogICAgICAgICAgICAgICAgICAgIGhvbGRlci5ocmVmID0gImh0dHBzOi8vcGFydGljbGVjb3JlLmdpdGh1Yi5pby9QYXJ0aWNsZS9zdHlsZXNoZWV0cy9Zb3VUdWJlUGx1cy5jc3M/dj0xLjYuOSI7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGhvbGRlcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTsKICAgICAgICAgICAgICAgIGhvbGRlci50ZXh0Q29udGVudCA9ICIoIiArIHBhcnRpY2xlLmluamVjdCArICIoIiArIHBhcnRpY2xlLmlzX3VzZXJzY3JpcHQgKyAiKSkiOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGhvbGRlcik7CiAgICAgICAgICAgICAgICBpZiAoIXBhcnRpY2xlLmlzX3VzZXJzY3JpcHQpIHsKICAgICAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5vbkNoYW5nZWQuYWRkTGlzdGVuZXIocGFydGljbGUuZmlsdGVyQ2hyb21lS2V5cyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGluaTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHBhcnRpY2xlLmlkID0gInBhcnRpY2xlU2V0dGluZ3MiOwogICAgICAgICAgICBwYXJ0aWNsZS5pc191c2Vyc2NyaXB0ID0gdHlwZW9mIEdNX2luZm8gPT09ICJvYmplY3QiID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgICAgICBpZiAocGFydGljbGUuaXNfdXNlcnNjcmlwdCkgewogICAgICAgICAgICAgICAgcGFydGljbGUuR01fZ2V0VmFsdWUgPSBHTV9nZXRWYWx1ZTsKICAgICAgICAgICAgICAgIHBhcnRpY2xlLkdNX3NldFZhbHVlID0gR01fc2V0VmFsdWU7CiAgICAgICAgICAgICAgICBwYXJ0aWNsZS5tYWluKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQocGFydGljbGUuaWQsIHBhcnRpY2xlLm1haW4pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBhcnRpY2xlLmNvbnRlbnRTY3JpcHRNZXNzYWdlcygpOwogICAgICAgIH0KICAgIH07CiAgICBwYXJ0aWNsZS5pbmkoKTsKfSgpKTs="},{"name":"iZhihu","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":["http://www.zhihu.com/*","https://www.zhihu.com/*"],"orig_matches":["http://www.zhihu.com/*","https://www.zhihu.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1487594258402},"enabled":true,"position":8,"file_url":"https://greasyfork.org/scripts/350-izhihu/code/iZhihu.user.js","uuid":"a3402b39-10fd-40e9-9ee5-c72302d817c7","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBpWmhpaHUKLy8gQG5hbWVzcGFjZSAgICBodHRwczovL2dpdGh1Yi5jb20vdW5vZ3ovaXpoaWh1Ci8vIEB2ZXJzaW9uICAgICAgMi4xMy4zCi8vIEBkZXNjcmlwdGlvbiAg55+l5LmO5o+S5Lu2Ci8vIEBtYXRjaCAgICAgICAgaHR0cDovL3d3dy56aGlodS5jb20vKgovLyBAaW5jbHVkZSAgICAgIGh0dHA6Ly93d3cuemhpaHUuY29tLyoKLy8gQG1hdGNoICAgICAgICBodHRwczovL3d3dy56aGlodS5jb20vKgovLyBAaW5jbHVkZSAgICAgIGh0dHBzOi8vd3d3LnpoaWh1LmNvbS8qCi8vIEByZXF1aXJlICAgICAgaHR0cDovL2Nkbi5zdGF0aWNmaWxlLm9yZy9qcXVlcnkvMS44LjIvanF1ZXJ5Lm1pbi5qcwovLyBAcmVxdWlyZSAgICAgIGh0dHA6Ly9jZG4uc3RhdGljZmlsZS5vcmcvaUNoZWNrLzEuMC4xL2ljaGVjay5taW4uanMKLy8gQHJlc291cmNlICAgICBqcVVJX0NTUyBodHRwOi8vY2RuLnN0YXRpY2ZpbGUub3JnL2lDaGVjay8xLjAuMS9za2lucy9zcXVhcmUvYmx1ZS5jc3MKLy8gQHJlc291cmNlICAgICB1aS1iZ19pY2hlY2stc2tpbl9zcXVhcmVfYmx1ZSBodHRwOi8vY2RuLnN0YXRpY2ZpbGUub3JnL2lDaGVjay8xLjAuMS9za2lucy9zcXVhcmUvYmx1ZS5wbmcKLy8gQHJlc291cmNlICAgICB1aS1iZ19pY2hlY2stc2tpbl9zcXVhcmVfYmx1ZTJ4IGh0dHA6Ly9jZG4uc3RhdGljZmlsZS5vcmcvaUNoZWNrLzEuMC4xL3NraW5zL3NxdWFyZS9ibHVlQDJ4LnBuZwovLyBAcmVxdWlyZSAgICAgIGh0dHA6Ly9jZG4uc3RhdGljZmlsZS5vcmcvanF1ZXJ5dWkvMS4xMC40L2pxdWVyeS11aS5taW4uanMKLy8gQHJlcXVpcmUgICAgICBodHRwOi8vY2RuLnN0YXRpY2ZpbGUub3JnL3B1cmwvMi4zLjEvcHVybC5taW4uanMKLy8gQHJlcXVpcmUgICAgICBodHRwOi8vY2RuLnN0YXRpY2ZpbGUub3JnL3VuZGVyc2NvcmUuanMvMS42LjAvdW5kZXJzY29yZS1taW4uanMKLy8gQGdyYW50ICAgICAgICBHTV94bWxIdHRwUmVxdWVzdAovLyBAZ3JhbnQgICAgICAgIEdNX2FkZFN0eWxlCi8vIEBncmFudCAgICAgICAgR01fZ2V0UmVzb3VyY2VUZXh0Ci8vIEBncmFudCAgICAgICAgR01fZ2V0UmVzb3VyY2VVUkwKLy8gQGljb24gICAgICAgICBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vdW5vZ3ovaXpoaWh1L2RldmVsb3AvbWlzYy94cGktY29uZmlnL2ljb242NC5wbmcKLy8gQGNvcHlyaWdodCAgICAyMDE1KywgQOmSouebhemDreWtkCBA5YiY5YuHIEDloqjno4oKLy8gPT0vVXNlclNjcmlwdD09Cgp2YXIganFVSV9Dc3NTcmMgPSBHTV9nZXRSZXNvdXJjZVRleHQoImpxVUlfQ1NTIikKR01fYWRkU3R5bGUgKGpxVUlfQ3NzU3JjLnJlcGxhY2UoJ3VybChibHVlJywgJ3VybChodHRwOi8vY2RuLnN0YXRpY2ZpbGUub3JnL2lDaGVjay8xLjAuMS9za2lucy9zcXVhcmUvYmx1ZScpKTsKCnZhciB2ZXJzaW9uPScyLjEzLjMnOwp2YXIgdXBkYXRlRGF0ZT0nMjAxNi00LTI1JzsKCmlmICggdHlwZW9mIHVuc2FmZVdpbmRvdyA9PT0gInVuZGVmaW5lZCIpIHsKICAgIHVuc2FmZVdpbmRvdyAgICA9ICggZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBkdW1teUVsZW0gICA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTsKICAgICAgICBkdW1teUVsZW0ub25jbGljaz1mdW5jdGlvbigpe3JldHVybiB3aW5kb3c7fTsKICAgICAgICByZXR1cm4gZHVtbXlFbGVtLm9uY2xpY2sgKCk7CiAgICB9ICkgKCk7Cn0KCi8v5Li75YWl5Y+jCi8vJChmdW5jdGlvbiBtYWluKCl7CgoKLyoqCiAqIEBjbGFzcyBVdGlscyDovoXliqnnsbsKICovCmZ1bmN0aW9uIHV0aWxzKCl7Cn07Cgp2YXIgY2ZnRGVmYXVsdCA9IHsKICAgICdjb21tZW50X3NpZGViYXInOiB0cnVlCiAgLCAnYW5zd2VyX29yZGVyQnlUaW1lJzogZmFsc2UKICAsICdBdXRob3JMaXN0JzpmYWxzZQogICwgJ1Nob3dDb21tZW50Jzp0cnVlCiAgLCAnSG9tZUxheW91dCc6ZmFsc2UKICAsICdRdWlja0Zhdm8nOnRydWUKICAsICdRdWlja0Zhdm9QaW5uZWQnOnt9CiAgLCAnQXV0aG9yUmVhcic6ZmFsc2UKICAsICdIb21lTm90aSc6ZmFsc2UKICAsICdRdWlja0Jsb2NrJzpmYWxzZQogICwgJ05vdGk3Jzp0cnVlCiAgLCAnSG9tZUZlZWRzQ29sdW1ucyc6ZmFsc2UKICAsICdSaWdodENvbW1lbnRfQXV0b1Njcm9sbFBhZ2VXaGVuQ2xvc2luZyc6dHJ1ZQogICwgJ1RvcE5hdkF1dG9Gb2xkJzpmYWxzZQp9OwogIAovKioKICog6K+75Y+W6YWN572uCiAqLwp1dGlscy5nZXRDZmcgPSBmdW5jdGlvbihrZXkpewogIGlmKCFrZXkpcmV0dXJuIGZhbHNlOwogIHZhciBjZmcgPSAkLmV4dGVuZChjZmdEZWZhdWx0LCB0aGlzLmdldFZhbHVlKCdpemhpaHUnLGNmZ0RlZmF1bHQpKTsKICByZXR1cm4ga2V5ID8gY2ZnW2tleV0gOiBjZmc7Cn07Cgp1dGlscy5zZXRDZmcgPSBmdW5jdGlvbihrZXksdmFsdWUpewogIGlmKCFrZXkpcmV0dXJuOwogIHZhciBjZmcgPSAkLmV4dGVuZChjZmdEZWZhdWx0LCB0aGlzLmdldFZhbHVlKCdpemhpaHUnLGNmZ0RlZmF1bHQpKTsKICBjZmdba2V5XT12YWx1ZTsKICB0aGlzLnNldFZhbHVlKCdpemhpaHUnLGNmZyk7Cn07CgovKioKICog6K+75Y+W5a2Y5YKoCiAqLwp1dGlscy5nZXRWYWx1ZSA9IGZ1bmN0aW9uKGtleSwgZGVmYXVsdFZhbHVlKXsKICAgIHZhciB2PXVuc2FmZVdpbmRvdy5sb2NhbFN0b3JhZ2Vba2V5XTsKICAgIGlmKHYpCiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2Uodik7CiAgICBlbHNlCiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTsKfTsKCi8qKgogKiDlhpnlhaXlrZjlgqgKICovCnV0aWxzLnNldFZhbHVlID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSl7CiAgdW5zYWZlV2luZG93LmxvY2FsU3RvcmFnZVtrZXldID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpOwp9OwoKLyoqCiAqIOWIoOmZpOWtmOWCqAogKi8KdXRpbHMuZGVsZXRlVmFsdWUgPSBmdW5jdGlvbihrZXkpewogIHJldHVybiBkZWxldGUgdW5zYWZlV2luZG93LmxvY2FsU3RvcmFnZVtrZXldOwp9OwoKdXRpbHMudHJhbnNmZXJPbGRDZmc9ZnVuY3Rpb24oKXsKICAgIHZhciBvbGRIb21lTGF5b3V0ID0gdW5zYWZlV2luZG93LmxvY2FsU3RvcmFnZVsnaXpoX0hvbWVMYXlvdXQnXQogICAgICAsIG9sZEF1dGhvckxpc3QgPSB1bnNhZmVXaW5kb3cubG9jYWxTdG9yYWdlWydpemhfQXV0aG9yTGlzdCddCiAgICAgICwgb2xkU2hvd0NvbW1lbnQgPSB1bnNhZmVXaW5kb3cubG9jYWxTdG9yYWdlWydpemhfU2hvd0NvbW1lbnQnXQogICAgICAsIG9sZFF1aWNrRmF2byA9IHVuc2FmZVdpbmRvdy5sb2NhbFN0b3JhZ2VbJ2l6aF9RdWlja0Zhdm8nXQogICAgICAsIG9sZEF1dGhvclJlYXIgPSB1bnNhZmVXaW5kb3cubG9jYWxTdG9yYWdlWydpemhfQXV0aG9yUmVhciddCiAgICAgICwgb2xkSG9tZU5vdGkgPSB1bnNhZmVXaW5kb3cubG9jYWxTdG9yYWdlWydpemhfSG9tZU5vdGknXQogICAgOwogICAgaWYob2xkSG9tZUxheW91dCl7CiAgICAgICAgaXpoSG9tZUxheW91dD1vbGRIb21lTGF5b3V0OwogICAgICAgIHVuc2FmZVdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnaXpoX0hvbWVMYXlvdXQnKTsKICAgICAgICB0aGlzLnNldENmZygnSG9tZUxheW91dCcsaXpoSG9tZUxheW91dCk7CiAgICB9CiAgICBpZihvbGRBdXRob3JMaXN0KXsKICAgICAgICBpemhBdXRob3JMaXN0PW9sZEF1dGhvckxpc3Q7CiAgICAgICAgdW5zYWZlV2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdpemhfQXV0aG9yTGlzdCcpOwogICAgICAgIHRoaXMuc2V0Q2ZnKCdBdXRob3JMaXN0JyxpemhBdXRob3JMaXN0KTsKICAgIH0KICAgIGlmKG9sZFNob3dDb21tZW50KXsKICAgICAgICBpemhSaWdodENvbW1lbnQ9b2xkU2hvd0NvbW1lbnQ7CiAgICAgICAgdW5zYWZlV2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdpemhfU2hvd0NvbW1lbnQnKTsKICAgICAgICB0aGlzLnNldENmZygnU2hvd0NvbW1lbnQnLGl6aFJpZ2h0Q29tbWVudCk7CiAgICB9CiAgICBpZihvbGRRdWlja0Zhdm8pewogICAgICAgIGl6aFF1aWNrRmF2bz1vbGRRdWlja0Zhdm87CiAgICAgICAgdW5zYWZlV2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdpemhfUXVpY2tGYXZvJyk7CiAgICAgICAgdGhpcy5zZXRDZmcoJ1F1aWNrRmF2bycsaXpoUXVpY2tGYXZvKTsKICAgIH0KICAgIGlmKG9sZEF1dGhvclJlYXIpewogICAgICAgIGl6aEF1dGhvclJlYXI9b2xkQXV0aG9yUmVhcjsKICAgICAgICB1bnNhZmVXaW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2l6aF9BdXRob3JSZWFyJyk7CiAgICAgICAgdGhpcy5zZXRDZmcoJ0F1dGhvclJlYXInLGl6aEF1dGhvclJlYXIpOwogICAgfQogICAgaWYob2xkSG9tZU5vdGkpewogICAgICAgIGl6aEhvbWVOb3RpPW9sZEhvbWVOb3RpOwogICAgICAgIHVuc2FmZVdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnaXpoX0hvbWVOb3RpJyk7CiAgICAgICAgdGhpcy5zZXRDZmcoJ0hvbWVOb3RpJyxpemhIb21lTm90aSk7CiAgICB9Cgp9OwoKCi8qKgogKiBAbWV0aG9kIGZvcm1hdFN0cgogKgogKiDmoLzlvI/ljJblrZfnrKbkuLLmqKHniYgs5pSv5oyBMuenjeagvOW8jzoKICoKICogICAgIGZvcm1hdFN0cigiaSBjYW4gc3BlYWsge2xhbmd1YWdlfSBzaW5jZSBpIHdhcyB7YWdlfSIse2xhbmd1YWdlOidqYXZhc2NyaXB0JyxhZ2U6MTB9KTsKICogICAgIGZvcm1hdFN0cigiaSBjYW4gc3BlYWsgezB9IHNpbmNlIGkgd2FzIHsxfSIsJ2phdmFzY3JpcHQnLDEwKTsKICoKICog5aaC5p6c5LiN5biM5pyb6KKr6L2s5LmJLOWImeeUqOS4pOS4quaLrOWPtyzlpoI6IGBmb3JtYXRTdHIoImkgY2FuIHNwZWFrIHswfSBzaW5jZSBpIHdhcyB7ezF9IiwnamF2YXNjcmlwdCcsMTApO2AKICoKICovCnV0aWxzLmZvcm1hdFN0ciA9IGZ1bmN0aW9uKHRwbCxvYmopewogIG9iaiA9IHR5cGVvZiBvYmogPT09ICdvYmplY3QnID8gb2JqIDogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICByZXR1cm4gdHBsLnJlcGxhY2UoL1x7XHt8XH1cfXxceyhcdyspXH0vZywgZnVuY3Rpb24gKG0sIG4pewogICAgaWYgKG0gPT0gInt7IikgeyByZXR1cm4gInsiOyB9CiAgICBpZiAobSA9PSAifX0iKSB7IHJldHVybiAifSI7IH0KICAgIHJldHVybiBvYmpbbl07CiAgfSk7Cn07Cgp1dGlscy5nZXRQYXJhbUluUXVlcnk9ZnVuY3Rpb24ocXVlcnlTdHIscGFyYW1OYW1lKXsKICAgIHZhciBwYXJhbT1wYXJhbU5hbWUrJz0nCiAgICAgICwgc3RhcnQ9cXVlcnlTdHIuaW5kZXhPZihwYXJhbSkrcGFyYW0ubGVuZ3RoCiAgICAgICwgZW5kPXF1ZXJ5U3RyLmluZGV4T2YoJyYnLHN0YXJ0KTsKICAgIHJldHVybiBlbmQ8c3RhcnQ/cXVlcnlTdHIuc3Vic3RyaW5nKHN0YXJ0KTpxdWVyeVN0ci5zdWJzdHJpbmcoc3RhcnQsZW5kKTsKfTsKCnV0aWxzLm9ic2VydmVET01BdHRyTW9kaWZpZWQgPSAoZnVuY3Rpb24oKXsKICAgIHZhciBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsCiAgICAgICAgZXZlbnRMaXN0ZW5lclN1cHBvcnRlZCA9IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyOwoKICAgIHJldHVybiBmdW5jdGlvbihvYmosIGNhbGxiYWNrKXsKICAgICAgICBpZiggTXV0YXRpb25PYnNlcnZlciApewogICAgICAgICAgICAvLyBkZWZpbmUgYSBuZXcgb2JzZXJ2ZXIKICAgICAgICAgICAgdmFyIG9icyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uKG11dGF0aW9ucywgb2JzZXJ2ZXIpewogICAgICAgICAgICAgICAgaWYoIG11dGF0aW9uc1swXS50eXBlID09ICdhdHRyaWJ1dGVzJyApCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobXV0YXRpb25zWzBdKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG9icy5vYnNlcnZlKCBvYmosIHsgYXR0cmlidXRlczp0cnVlIH0pOwogICAgICAgIH1lbHNlIGlmKCBldmVudExpc3RlbmVyU3VwcG9ydGVkICl7CiAgICAgICAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKCdET01BdHRyTW9kaWZpZWQnLCBjYWxsYmFjaywgZmFsc2UpOwogICAgICAgIH0KICAgIH0KfSkoKTsKCnV0aWxzLm9ic2VydmVET01Ob2RlQWRkZWQgPSAoZnVuY3Rpb24oKXsKICAgIHZhciBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsCiAgICAgICAgZXZlbnRMaXN0ZW5lclN1cHBvcnRlZCA9IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyOwoKICAgIHJldHVybiBmdW5jdGlvbihvYmosIGNhbGxiYWNrKXsKICAgICAgICBpZiggTXV0YXRpb25PYnNlcnZlciApewogICAgICAgICAgICAvLyBkZWZpbmUgYSBuZXcgb2JzZXJ2ZXIKICAgICAgICAgICAgdmFyIG9icyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uKG11dGF0aW9ucywgb2JzZXJ2ZXIpewogICAgICAgICAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24obXV0YXRpb24pIHsKICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhtdXRhdGlvbik7CiAgICAgICAgICAgICAgICAgIH0pOyAgICAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG9icy5vYnNlcnZlKCBvYmosIHsgY2hpbGRMaXN0OnRydWUgfSk7CiAgICAgICAgfWVsc2UgaWYoIGV2ZW50TGlzdGVuZXJTdXBwb3J0ZWQgKXsKICAgICAgICAgICAgb2JqLmFkZEV2ZW50TGlzdGVuZXIoJ0RPTU5vZGVJbnNlcnRlZCcsIGNhbGxiYWNrLCBmYWxzZSk7CiAgICAgICAgfQogICAgfQp9KSgpOwoKdXRpbHMuUmVnZXhTcmNQaWMgPSAvc3JjPSJbXHNcU10rPy5qcGciL2cKCi8vY29uc29sZS5sb2coKG5ldyBEYXRlKCkpLmdldFRpbWUoKSk7Cgp2YXIgJCA9IHdpbmRvdy4kOwp2YXIgXyA9IHRoaXMuXzsKdmFyIHB1cmwgPSB3aW5kb3cucHVybHx8JC51cmw7CgovL+S9v+eUqENhc3BlckpT55qE5qih5ouf55So5oi35pON5L2c77yaIGh0dHA6Ly9jYXNwZXJqcy5vcmcvYXBpLmh0bWwjY2xpZW50LXV0aWxzCi8vdmFyIGNsaWVudCA9IHdpbmRvdy5jcmVhdGUoKTsKCnZhciB1cmwgPSBwdXJsKCk7CnZhciBwYWdlID0gdXJsLnNlZ21lbnQoMSk7Cgp2YXIgcGFnZUlzPXt9CiAgLCAkd2luPSQod2luZG93KQogICwgX2RvYz13aW5kb3cuZG9jdW1lbnQKICAsICRib2R5PSQoX2RvYy5ib2R5KQogICwgX3BhdGg9d2luZG93LmZyYW1lRWxlbWVudD93aW5kb3cuZnJhbWVFbGVtZW50LnNyYy5yZXBsYWNlKC9odHRwcz86XC9cL3d3dy56aGlodS5jb20vLCcnKTp1cmwuZGF0YS5hdHRyWydwYXRoJ10KICAsIGNzcz0nJwogICwgJGg9JCgnaGVhZCcpCiAgLCAkcz0kKCc8c3R5bGU+JywgeyAndHlwZSc6ICd0ZXh0L2NzcycgfSkKICAsIGlQYXRoQW5zd2Vycz1fcGF0aC5pbmRleE9mKCcvYW5zd2VycycpCiAgLCBpUGF0aENvbGxlY3Rpb249X3BhdGguaW5kZXhPZignL2NvbGxlY3Rpb24nKQo7CnBhZ2VJcy5Ib21lPScvJz09X3BhdGg7CnBhZ2VJcy5BbnN3ZXI9MDxfcGF0aC5pbmRleE9mKCcvYW5zd2VyLycpOwpwYWdlSXMuUXVlc3Rpb249IXBhZ2VJcy5BbnN3ZXImJjA9PV9wYXRoLmluZGV4T2YoJy9xdWVzdGlvbi8nKTsKcGFnZUlzLkFuc3dlcnM9MDxpUGF0aEFuc3dlcnMmJl9wYXRoLnN1YnN0cihpUGF0aEFuc3dlcnMpPT0nL2Fuc3dlcnMnOwpwYWdlSXMuQ29sbGVjdGlvbj0wPT1pUGF0aENvbGxlY3Rpb247CnBhZ2VJcy5EZWJ1dHM9MD09X3BhdGguaW5kZXhPZignL2RlYnV0cy8nKTsKcGFnZUlzLk15Q29sbGVjdGlvbj0wPT1fcGF0aC5pbmRleE9mKCcvY29sbGVjdGlvbnMvbWluZScpOwpwYWdlSXMuU2V0dGluZ3NGaWx0ZXI9MD09X3BhdGguaW5kZXhPZignL3NldHRpbmdzL2ZpbHRlcicpCgp2YXIgaT0wCiAgLCAkdXNlcj0kKCcuenUtdG9wLW5hdi11c2VyaW5mbycpLy91c2VyX2F2YXRlcgogICwgej0kdXNlci5sZW5ndGg/JHVzZXIuYXR0cignaHJlZicpOicnCiAgLCAkYmFubmVyPSQoZG9jdW1lbnQuYm9keSkuY2hpbGRyZW4oKS5maXJzdCgpCiAgLCAkbWFpbj0kKCdbcm9sZT1tYWluXScpLy9tYWluCiAgLCBjc3NfQXV0aG9yTGlzdEl0ZW1BPSdwYWRkaW5nOjAgMTBweCAwIDA7JwogICwgY3NzX0F1dGhvckxpc3RJdGVtQV9uYW1lPSdwYWRkaW5nOjAgNXB4OycKOwoKd2luZG93LmlaaGlodSA9IHsKICAgICR3aW46JHdpbgogICwgJGJvZHk6JGJvZHkKICAsICRtYWluOiRtYWluCiAgLCBjb25maWc6JC5leHRlbmQoY2ZnRGVmYXVsdCwgdXRpbHMuZ2V0VmFsdWUoJ2l6aGlodScsY2ZnRGVmYXVsdCkpCn07Cgp2YXIgaXpoSG9tZUxheW91dCA9IHdpbmRvdy5pWmhpaHUuY29uZmlnWydIb21lTGF5b3V0J10KICAsIGl6aEF1dGhvckxpc3QgPSB3aW5kb3cuaVpoaWh1LmNvbmZpZ1snQXV0aG9yTGlzdCddCiAgLCBpemhSaWdodENvbW1lbnQgPSB3aW5kb3cuaVpoaWh1LmNvbmZpZ1snU2hvd0NvbW1lbnQnXQogICwgaXpoUXVpY2tGYXZvID0gd2luZG93LmlaaGlodS5jb25maWdbJ1F1aWNrRmF2byddCiAgLCBpemhBdXRob3JSZWFyID0gd2luZG93LmlaaGlodS5jb25maWdbJ0F1dGhvclJlYXInXQogICwgaXpoSG9tZU5vdGkgPSB3aW5kb3cuaVpoaWh1LmNvbmZpZ1snSG9tZU5vdGknXQogICwgaXpoUXVpY2tCbG9jayA9IHdpbmRvdy5pWmhpaHUuY29uZmlnWydRdWlja0Jsb2NrJ10KICAsIGl6aFRvcE5hdkF1dG9Gb2xkID0gd2luZG93LmlaaGlodS5jb25maWdbJ1RvcE5hdkF1dG9Gb2xkJ10KOwoKdXRpbHMudHJhbnNmZXJPbGRDZmcoKTsKCiRib2R5LmF0dHIoewogICAgJ2l6aEhvbWVMYXlvdXQnIDogaXpoSG9tZUxheW91dD8nMSc6JycKICAsICdpemhBdXRob3JMaXN0JyA6IGl6aEF1dGhvckxpc3Q/JzEnOicnCiAgLCAnaXpoUmlnaHRDb21tZW50JyA6IGl6aFJpZ2h0Q29tbWVudD8nMSc6JycKICAsICdpemhRdWlja0Zhdm8nIDogaXpoUXVpY2tGYXZvPycxJzonJwogICwgJ2l6aEF1dGhvclJlYXInIDogaXpoQXV0aG9yUmVhcj8nMSc6JycKICAsICdpemhIb21lTm90aScgOiBpemhIb21lTm90aT8nMSc6JycKICAsICdpemhRdWlja0Jsb2NrJyA6IGl6aFF1aWNrQmxvY2s/JzEnOicnCiAgLCAnaXpoVG9wTmF2QXV0b0ZvbGQnIDogaXpoVG9wTmF2QXV0b0ZvbGQ/JzEnOicnCn0pOwoKdmFyIF9RdWlja0Jsb2NrID0gbmV3IFF1aWNrQmxvY2sod2luZG93LmlaaGlodSkKICAsIF9RdWlja0Zhdm8gPSBuZXcgUXVpY2tGYXZvKHdpbmRvdy5pWmhpaHUpCiAgLCBfQ29tbWVudCA9IG5ldyBDb21tZW50KHdpbmRvdy5pWmhpaHUpCiAgLCBfTm90aTcgPSBuZXcgTm90aTcod2luZG93LmlaaGlodSkKICAsIF9BbnN3ZXIgPSBuZXcgQW5zd2VyKHdpbmRvdy5pWmhpaHUpCiAgLCBfU2VhcmNoaW5nTGlzdCA9IG5ldyBTZWFyY2hpbmdMaXN0KHdpbmRvdy5pWmhpaHUpCiAgLCBfVG9wTmF2ID0gbmV3IFRvcE5hdih3aW5kb3cuaVpoaWh1KQo7Cgpjc3MrPVsnLnRfc2hvd2ZyYW1le3BhZGRpbmc6MTBweCAxMHB4IDEwcHggMTBweDtiYWNrZ3JvdW5kOiNmMGYwZjA7Ym9yZGVyOjFweCBzb2xpZCAjZmZmO2JveC1zaGFkb3c6MnB4IDVweCAxNXB4ICMzMzM7Ym9yZGVyLXJhZGl1czoxMHB4Oy1tb3otYm94LXNoYWRvdzoycHggNXB4IDE1cHggIzMzMzstbW96LWJvcmRlci1yYWRpdXM6MTBweDstd2Via2l0LWJveC1zaGFkb3c6MnB4IDVweCAxNXB4ICMzMzM7LXdlYmtpdC1ib3JkZXItcmFkaXVzOjEwcHh9I2laaGlodV9ydGpkZGl2e3dpZHRoOjY1MHB4O2hlaWdodDo0MzdweH0jaVpoaWh1X3NldGRpdnt3aWR0aDo2MDBweDtoZWlnaHQyOjI5NXB4fS50X3NldGRpdntwYWRkaW5nLWJvdHRvbToxMHB4O2JhY2tncm91bmQ6I2ZjZmNmYzt3aWR0aDoxMDAlO2hlaWdodDoxMDAlfS50X3NldF90Yntmb250LWZhbWlseToiTHVjaWRhIFNhbnMgVW5pY29kZSIsIkx1Y2lkYSBHcmFuZGUiLFNhbnMtU2VyaWYgIWltcG9ydGFudDtmb250LXNpemU6MTJweCAhaW1wb3J0YW50O3RleHQtc2hhZG93Om5vbmUgIWltcG9ydGFudDtib3JkZXItY29sbGFwc2U6Y29sbGFwc2UgIWltcG9ydGFudDttYXJnaW46MCAhaW1wb3J0YW50O2xpbmUtaGVpZ2h0OjEyMCV9LnRfc2V0X3RiIHRoZWFkIHRke2JhY2tncm91bmQ6IzAwODBjMDtjb2xvcjojZmZmO2JvcmRlcjpub25lICFpbXBvcnRhbnQ7cGFkZGluZzo0cHggOHB4IDRweCAhaW1wb3J0YW50O2JvcmRlci1yYWRpdXMtdG9wbGVmdDoxMHB4O2JvcmRlci1yYWRpdXMtdG9wcmlnaHQ6MTBweDstbW96LWJvcmRlci1yYWRpdXMtdG9wbGVmdDoxMHB4Oy1tb3otYm9yZGVyLXJhZGl1cy10b3ByaWdodDoxMHB4Oy13ZWJraXQtYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czoxMHB4Oy13ZWJraXQtYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6MTBweH0udF9zZXRfdGIgdGgsLnRfc2V0X3RiIHRke3BhZGRpbmc6OHB4O2JhY2tncm91bmQ6I2U4ZWRmZjtib3JkZXI6bm9uZSAhaW1wb3J0YW50O2JvcmRlci10b3A6MnB4IHNvbGlkICNmY2ZjZmMgIWltcG9ydGFudDtjb2xvcjojNjY5O2xpbmUtaGVpZ2h0OjEuMWVtICFpbXBvcnRhbnR9LnRfc2V0X3RiIHRkIGlucHV0LC50X3NldF90YiB0ZCB0ZXh0YXJlYXtmb250LXNpemU6MTJweCAhaW1wb3J0YW50O3BhZGRpbmc6MCAhaW1wb3J0YW50fS50X3NldF90YiB0Ym9keSB0cjpob3ZlciB0aCwudF9zZXRfdGIgdGJvZHkgdHI6aG92ZXIgdGR7YmFja2dyb3VuZDojZDBkYWZkfS50X3NldF90YiB0Zm9vdCB0ZHtib3JkZXItcmFkaXVzLWJvdHRvbWxlZnQ6MTBweDtib3JkZXItcmFkaXVzLWJvdHRvbXJpZ2h0OjEwcHg7LW1vei1ib3JkZXItcmFkaXVzLWJvdHRvbWxlZnQ6MTBweDstbW96LWJvcmRlci1yYWRpdXMtYm90dG9tcmlnaHQ6MTBweDstd2Via2l0LWJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MTBweDstd2Via2l0LWJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjEwcHh9LnRfc2V0X2Z0e2ZvbnQtZmFtaWx5OkFyaWFsLHNhbnMtc2VyaWYs54C577+977+9ICFpbXBvcnRhbnQ7Zm9udC1zaXplOjEycHggIWltcG9ydGFudDtmb250LXdlaWdodDpib2xkICFpbXBvcnRhbnQ7dGV4dC1zaGFkb3c6bm9uZSAhaW1wb3J0YW50O21hcmdpbi10b3A6MTVweCAhaW1wb3J0YW50fS50X3NldF9mdCBhe3RleHQtZGVjb3JhdGlvbjpub25lO2NvbG9yOiMwMDB9LnRfc2V0YnRue2JvcmRlcjoxcHggc29saWQgYmxhY2s7cGFkZGluZzoycHg7Y3Vyc29yOnBvaW50ZXI7YmFja2dyb3VuZDojZmZmO2NvbG9yOiMwMDgwYzB9LnRfc2V0ZnRidG4gc3BhbntwYWRkaW5nOjJweCAxMHB4IDJweCAxMHB4ICFpbXBvcnRhbnR9LnRfcnRqZGJ0bntiYWNrZ3JvdW5kOiMwMDgwYzAgIWltcG9ydGFudDtjb2xvcjojZmZmICFpbXBvcnRhbnR9LnRfcnRqZHR4dHBvc3twYWRkaW5nLXRvcDo1cHh9I2laaGlodV9ydGhpbnR7Zm9udC1mYW1pbHk6QXJpYWwsc2Fucy1zZXJpZizngLnvv73vv70gIWltcG9ydGFudDtmb250LXNpemU6MTZweCAhaW1wb3J0YW50O2ZvbnQtd2VpZ2h0OmJvbGQ7cGFkZGluZzo1cHggMTBweCA1cHggMTBweDtwb3NpdGlvbjpmaXhlZDt0b3A6MjBweDtib3JkZXItcmFkaXVzOjVweDstbW96LWJvcmRlci1yYWRpdXM6NXB4Oy13ZWJraXQtYm9yZGVyLXJhZGl1czo1cHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7b3BhY2l0eTowLjd9LnRfcnRoaW50X257Y29sb3I6I2ZmZiAhaW1wb3J0YW50O2JhY2tncm91bmQ6IzAwMCAhaW1wb3J0YW50fS50X3J0aGludF9me2JhY2tncm91bmQ6Izg4MDAwMCAhaW1wb3J0YW50O2NvbG9yOiNmZmZmZGQgIWltcG9ydGFudH0udF91cGJ0bntiYWNrZ3JvdW5kOiMwMDgwYzAgIWltcG9ydGFudDtjb2xvcjojZmZmICFpbXBvcnRhbnR9LnRfdXBpbmZve2hlaWdodDoxMjBweCAhaW1wb3J0YW50O3ZlcnRpY2FsLWFsaWduOnRleHQtdG9wICFpbXBvcnRhbnR9I2l6aF91cGRhdGVkaXYgdGh7Ym9yZGVyLXJpZ2h0OjJweCBzb2xpZCAjZmNmY2ZjICFpbXBvcnRhbnR9I2l6aF91cGRhdGVkaXYgdGZvb3QgdGR7Ym9yZGVyOm5vbmUgIWltcG9ydGFudDtib3JkZXItdG9wOjJweCBzb2xpZCAjZmNmY2ZjICFpbXBvcnRhbnQ7Zm9udC1mYW1pbHk6QXJpYWwsc2Fucy1zZXJpZizngLnvv73vv70gIWltcG9ydGFudDtmb250LXNpemU6MTJweCAhaW1wb3J0YW50O2ZvbnQtc3R5bGU6bm9ybWFsICFpbXBvcnRhbnQ7dGV4dC1zaGFkb3c6bm9uZSAhaW1wb3J0YW50fS50X3R4dHNob3d7dGV4dC1hbGlnbjpjZW50ZXI7YmFja2dyb3VuZDojMDA4MGMwO2NvbG9yOiNmMGYwZjA7dXNlci1zZWxlY3Q6bm9uZTstbW96LXVzZXItc2VsZWN0Om5vbmV9LnRfZnJzaG93e2ZvbnQtc2l6ZToxLjJlbTtwb3NpdGlvbjpmaXhlZDt6LWluZGV4Ojk5OTk5O3RvcDo0NXB4O3dpZHRoOjIwMHB4O29wYWNpdHk6MC45O2N1cnNvcjpwb2ludGVyfS50X3Rib3h7cGFkZGluZzoxMHB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JvcmRlcjoxcHggc29saWQgI2YwZjBmMDtsaW5lLWhlaWdodDoyMHB4OypoZWlnaHQ6MSU7d2lkdGg6MjAwcHg7LW1vei1ib3gtc2hhZG93OjJweCA1cHggMTVweCAjMzMzOy1tb3otYm9yZGVyLXJhZGl1czo3cHg7LXdlYmtpdC1ib3gtc2hhZG93OjJweCA1cHggMTVweCAjMzMzOy13ZWJraXQtYm9yZGVyLXJhZGl1czo3cHh9LnRfdGJveCBze3Bvc2l0aW9uOmFic29sdXRlO3RvcDotMjBweDtsZWZ0OjE2MHB4O2Rpc3BsYXk6YmxvY2s7aGVpZ2h0OjA7d2lkdGg6MDtmb250LXNpemU6MDtsaW5lLWhlaWdodDowO2JvcmRlci1jb2xvcjp0cmFuc3BhcmVudCB0cmFuc3BhcmVudCAjZjBmMGYwIHRyYW5zcGFyZW50O2JvcmRlci1zdHlsZTpkYXNoZWQgZGFzaGVkIHNvbGlkIGRhc2hlZDtib3JkZXItd2lkdGg6MTBweH0udF90Ym94IGl7cG9zaXRpb246YWJzb2x1dGU7dG9wOi05cHg7bGVmdDotMTBweDtkaXNwbGF5OmJsb2NrO2hlaWdodDowO3dpZHRoOjA7Zm9udC1zaXplOjA7bGluZS1oZWlnaHQ6MDtib3JkZXItY29sb3I6dHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgIzAwODBjMCB0cmFuc3BhcmVudDtib3JkZXItc3R5bGU6ZGFzaGVkIGRhc2hlZCBzb2xpZCBkYXNoZWQ7Ym9yZGVyLXdpZHRoOjEwcHh9QG1lZGlhIHNjcmVlbiBhbmQgKC13ZWJraXQtbWluLWRldmljZS1waXhlbC1yYXRpbzowKXsjaVpoaWh1X3J0amRkaXZ7aGVpZ2h0OjQxN3B4fSNpWmhpaHVfc2V0ZGl2e2hlaWdodDI6Mjk1cHh9I2l6aF91cGRhdGVkaXZ7aGVpZ2h0OjMxNXB4fX0nCiAgICAgLCcnXS5qb2luKCdcbicpOwppZihwYWdlSXMuUXVlc3Rpb24mJml6aEF1dGhvckxpc3QpewogICAgY3NzKz1bJ2Rpdi51bm97cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO2JvcmRlcjoxcHggc29saWQgIzA3NzFDMTtib3JkZXItcmlnaHQtd2lkdGg6MDtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czo2cHh9JwogICAgICAgICAsJ2Rpdi51bm8gLmZyYW1le292ZXJmbG93LXg6aGlkZGVuO292ZXJmbG93LXk6YXV0bztkaXJlY3Rpb246cnRsfScKICAgICAgICAgLCdkaXYudW5vIHNwYW4ubWVULGRpdi51bm8gc3Bhbi5tZUIsZGl2LnVubyB1bC5wcCBsaSBzcGFuLm1le3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjA7ZGlzcGxheTpibG9jaztoZWlnaHQ6MXB4O3dpZHRoOjFweDtsaW5lLWhlaWdodDoxcHg7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXItc3R5bGU6c29saWQ7Ym9yZGVyLWNvbG9yOnRyYW5zcGFyZW50O30nCiAgICAgICAgICwnZGl2LnVubyBzcGFuLm1lVHtib3JkZXItd2lkdGg6NnB4IDRweDtib3JkZXItdG9wLXdpZHRoOjBweDtib3JkZXItYm90dG9tLWNvbG9yOiNmZmY7fScKICAgICAgICAgLCdkaXYudW5vIHNwYW4ubWVCe2JvcmRlci13aWR0aDo2cHggNHB4O2JvcmRlci1ib3R0b20td2lkdGg6MHB4O2JvcmRlci10b3AtY29sb3I6I2ZmZjttYXJnaW4tdG9wOi03cHg7fScKICAgICAgICAgLCdkaXYudW5vIHVse2JhY2tncm91bmQtY29sb3I6IzA3NzFDMTtwYWRkaW5nOjA7bWFyZ2luOjA7ZGlyZWN0aW9uOmx0cn0nCiAgICAgICAgICwnZGl2LnVubyB1bCBsaXtkaXNwbGF5OmJsb2NrO2xpc3Qtc3R5bGUtdHlwZTpub25lO21hcmdpbjowO3BhZGRpbmc6MDt3aGl0ZS1zcGFjZTpub3dyYXA7fScKICAgICAgICAgLCdkaXYudW5vIHVsIGxpIGF7ZGlzcGxheTpibG9jazt9ZGl2LnVubyBsaSBhLnNlbHt0ZXh0LWRlY29yYXRpb246bm9uZTt9JwogICAgICAgICAsJ2Rpdi51bm8gdWwgbGkgYXsnK2Nzc19BdXRob3JMaXN0SXRlbUErJ30nCiAgICAgICAgICwnZGl2LnVubyB1bC5wcCBsaSBzcGFuLm1le3Bvc2l0aW9uOnN0YXRpYzttYXJnaW46NnB4IC04cHg7Ym9yZGVyLXdpZHRoOjRweCA2cHg7Ym9yZGVyLXJpZ2h0LWNvbG9yOiNmZmY7ZmxvYXQ6cmlnaHQ7fScKICAgICAgICAgLCdkaXYudW5vIGxpIGEgc3Bhbi5uYW1le3RleHQtYWxpZ246cmlnaHQ7ZGlzcGxheTpibG9jazsnK2Nzc19BdXRob3JMaXN0SXRlbUFfbmFtZSsnYmFja2dyb3VuZC1jb2xvcjojZmZmO31kaXYudW5vIGxpIGEuc2VsIHNwYW4ubmFtZXtjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6IzA3NzFDMTt9JwogICAgICAgICAsJ2Rpdi51bm8gbGkgYSBzcGFuLm5hbWUubm9uYW1le2NvbG9yOiMwMDA7fScKICAgICAgICAgLCdkaXYudW5vIGxpIGEgc3Bhbi5uYW1lLmNvbGxhcHNlZHtjb2xvcjojOTk5OTk5O30nCiAgICAgICAgICwnZGl2LnVubyBsaSBhIHNwYW4ubmFtZS5mcmllbmR7Zm9udC1zdHlsZTppdGFsaWM7fScKICAgICAgICAgLCdkaXYudW5vIGxpIHNwYW4uaHB7YmFja2dyb3VuZC1jb2xvcjojOTk5OTk5O3Bvc2l0aW9uOnJlbGF0aXZlO2Zsb2F0OnJpZ2h0O21hcmdpbi10b3A6LTJweDtsaW5lLWhlaWdodDoycHg7aGVpZ2h0OjJweDt9JwogICAgICAgICAsJ2Rpdi51bm8gdGFibGUucGx1c3tmbG9hdDpyaWdodDttYXJnaW46N3B4IC05cHg7aGVpZ2h0OjdweDtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7Ym9yZGVyLXN0eWxlOmhpZGRlbjt9ZGl2LnVubyB0YWJsZS5wbHVzIHRke2JvcmRlcjoxcHggc29saWQgI2ZmZjt3aWR0aDoxcHg7aGVpZ2h0OjFweDt9JwogICAgICAgICAsJ2Rpdi51bm8gYS5zZWwgdGFibGUucGx1c3t9ZGl2LnVubyBhLnNlbCB0YWJsZS5wbHVzIHRke30nCiAgICAgICAgICwnZGl2LnVubyBsaSBhIHNwYW4uZnVuY3t0ZXh0LWFsaWduOmNlbnRlcjt9JwogICAgICAgICAsJ2Rpdi5pemgtYW5zd2VyLXByZXZpZXd7cG9zaXRpb246Zml4ZWQ7bWFyZ2luLXRvcDoxcHg7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlcjoxcHggc29saWQgIzA3NzFDMTtib3JkZXItdG9wLXdpZHRoOjIycHg7Ym9yZGVyLXRvcC1yaWdodC1yYWRpdXM6NnB4O2JveC1zaGFkb3c6NXB4IDVweCA1cHggIzc3Nzt9JwogICAgICAgICAsJ2Rpdi5pemgtYW5zd2VyLXByZXZpZXcgLnptLWVkaXRhYmxlLWNvbnRlbnR7dG9wOjA7Ym90dG9tOjA7bGVmdDowO3JpZ2h0OjA7b3ZlcmZsb3cteTphdXRvO3BhZGRpbmc6MTBweDt9JwogICAgICAgICAsJ2Rpdi5pemgtYW5zd2VyLXByZXZpZXcgaW1nLnptLWxpc3QtYXZhdGFye3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjEwcHg7dG9wOi0zNXB4O2JvcmRlcjoxcHggc29saWQgIzA3NzFDMTtib3JkZXItcmFkaXVzOjZweDt9JwogICAgICAgICAsJ2Rpdi5pemgtYW5zd2VyLXByZXZpZXcgc3Bhbi5jb21tZW50e3Bvc2l0aW9uOmFic29sdXRlO3RvcDotMThweDtsaW5lLWhlaWdodDoxOHB4O2JvcmRlci10b3AtcmlnaHQtcmFkaXVzOjNweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7cGFkZGluZzowIDVweDt9JwogICAgICAgICAsJyddLmpvaW4oJ1xuJyk7Cn0KY3NzKz1bJy56LWljb24taXpoLWZvbGR7YmFja2dyb3VuZC1wb3NpdGlvbjotMTczcHggLTEwN3B4O3dpZHRoOjE1cHg7aGVpZ2h0OjE1cHg7fScKICAgICAsJyddLmpvaW4oJ1xuJyk7CmNzcys9WycudF9zZXRfdGJ7Zm9udC1mYW1pbHk6Ikx1Y2lkYSBTYW5zIFVuaWNvZGUiLCJMdWNpZGEgR3JhbmRlIixTYW5zLVNlcmlmICFpbXBvcnRhbnQ7Zm9udC1zaXplOjEycHggIWltcG9ydGFudDt0ZXh0LXNoYWRvdzpub25lICFpbXBvcnRhbnQ7Ym9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlICFpbXBvcnRhbnQ7bWFyZ2luOjAgIWltcG9ydGFudDtsaW5lLWhlaWdodDoxMjAlfScKICAgICAsJy50X3NldF90YiB0aGVhZCB0ZHtiYWNrZ3JvdW5kOiMwMDgwYzA7Y29sb3I6I2ZmZjtib3JkZXI6bm9uZSAhaW1wb3J0YW50O3BhZGRpbmc6NHB4IDhweCA0cHggIWltcG9ydGFudDtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjZweDtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czo2cHh9JwogICAgICwnLnRfc2V0X3RiIHRoLC50X3NldF90YiB0ZHtwYWRkaW5nOjhweDtiYWNrZ3JvdW5kOiNlN2YzZjk7Ym9yZGVyOm5vbmUgIWltcG9ydGFudDtib3JkZXItdG9wOjJweCBzb2xpZCAjZmNmY2ZjICFpbXBvcnRhbnQ7Y29sb3I6IzY2OTtsaW5lLWhlaWdodDoxLjFlbSAhaW1wb3J0YW50fScKICAgICAsJy50X3NldF90YiB0ZCBpbnB1dCwudF9zZXRfdGIgdGQgdGV4dGFyZWF7Zm9udC1zaXplOjEycHggIWltcG9ydGFudDtwYWRkaW5nOjAgIWltcG9ydGFudH0nCiAgICAgLCcudF9zZXRfdGIgdGJvZHkgdHI6aG92ZXIgdGgsLnRfc2V0X3RiIHRib2R5IHRyOmhvdmVyIHRke2JhY2tncm91bmQ6I2QwZGFmZH0nCiAgICAgLCcudF9zZXRfdGIgdGZvb3QgdGR7Ym9yZGVyLXJhZGl1cy1ib3R0b21sZWZ0OjEwcHg7Ym9yZGVyLXJhZGl1cy1ib3R0b21yaWdodDoxMHB4Oy1tb3otYm9yZGVyLXJhZGl1cy1ib3R0b21sZWZ0OjEwcHg7LW1vei1ib3JkZXItcmFkaXVzLWJvdHRvbXJpZ2h0OjEwcHg7LXdlYmtpdC1ib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjEwcHg7LXdlYmtpdC1ib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czoxMHB4fScKICAgICAsJy50X3NldF90YiB0ZHt3aGl0ZS1zcGFjZTpub3dyYXA7fScKICAgICAsJy50X3NldF90YiB0ZCAuaWNvbi1oZWxwe2Zsb2F0OnJpZ2h0O30nCiAgICAgLCcnXS5qb2luKCdcbicpOwpjc3MrPVsnLml6aF9ib3hTaGFkb3d7Ym94LXNoYWRvdzogNXB4IDVweCAzcHggMHB4ICM5OTkgIWltcG9ydGFudDt9JwogICAgICwnI3poLXF1ZXN0aW9uLW1ldGEtd3JhcC5pemhfbm9Cb3JkZXJ7Ym9yZGVyLWJvdHRvbS1jb2xvcjp0cmFuc3BhcmVudCAhaW1wb3J0YW50O30nCiAgICAgLCcjemgtcXVlc3Rpb24tZmlsdGVyLXdyYXAuaXpoX25vQm9yZGVye2JvcmRlci10b3AtY29sb3I6dHJhbnNwYXJlbnQgIWltcG9ydGFudDt9JwogICAgICwnYS5pemgtYnV0dG9uLm9ue2NvbG9yOiMyMjU1OTk7dGV4dC1zaGFkb3c6MCAwIDFweCAjMjI1NTk5O30nCiAgICAgLCdhLml6aC1idXR0b24gLnpnLWljb257b3BhY2l0eTowLjU7fScKICAgICAsJ2EuaXpoLWJ1dHRvbi5vbiAuemctaWNvbntvcGFjaXR5OjE7fScKICAgICAsJ2EuaXpoLWJ1dHRvbi5vZmZ7Y29sb3I6I2VlZTt9JwogICAgICwnYS5pemgtYnV0dG9uLm9mZiAuemctaWNvbntvcGFjaXR5OjAuMjt9JwogICAgICwnLml6aC1mZWVkcy1maWx0ZXJ7fScKICAgICAsJy5pemgtZmVlZHMtZmlsdGVyIC5pemgtZmVlZHMtZmlsdGVyLW9wdGlvbntvcGFjaXR5OjAuNTtjb2xvcjojOTk5OTk5O3BhZGRpbmctbGVmdDo1cHg7dGV4dC1kZWNvcmF0aW9uOm5vbmU7Y3Vyc29yOnBvaW50ZXI7fScKICAgICAsJy5pemgtZmVlZHMtZmlsdGVyIC5pemgtZmVlZHMtZmlsdGVyLW9wdGlvbiBpe2JhY2tncm91bmQtcG9zaXRpb246LTE4M3B4IC00cHg7fScKICAgICAsJy5pemgtZmVlZHMtZmlsdGVyIC5pemgtZmVlZHMtZmlsdGVyLW9wdGlvbi5vbntvcGFjaXR5OjE7Y29sb3I6IzIyNTU5OTt9JwogICAgICwnLml6aC1mZWVkcy1maWx0ZXIgLml6aC1mZWVkcy1maWx0ZXItb3B0aW9uLm9uIGl7YmFja2dyb3VuZC1wb3NpdGlvbjotMTgzcHggLTI0cHg7fScKICAgICAsJyddLmpvaW4oJ1xuJyk7CmlmKGl6aEhvbWVMYXlvdXQpewogICAgY3NzICs9ICBbJyN6aC1xdWVzdGlvbi1saXN0IHsgcGFkZGluZy1sZWZ0OjMwcHghaW1wb3J0YW50IH0nCiAgICAgICAgICAgICwnI3poLW1haW4tZmVlZC1mcmVzaC1idXR0b24geyBtYXJnaW4tbGVmdDotMzBweCFpbXBvcnRhbnQgfScKICAgICAgICAgICAgLCcuZmVlZC1pdGVtIHsnCiAgICAgICAgICAgICwnICAgIGJvcmRlci1ib3R0b206MXB4IHNvbGlkICNFRUUhaW1wb3J0YW50OycKICAgICAgICAgICAgLCcgICAgbWFyZ2luLXRvcDotMXB4IWltcG9ydGFudCcKICAgICAgICAgICAgLCd9JwogICAgICAgICAgICAsJy5mZWVkLWl0ZW0gLmF2YXRhciB7IGRpc3BsYXk6bm9uZSFpbXBvcnRhbnQgfScKICAgICAgICAgICAgLCcnCiAgICAgICAgICAgICwnLmZlZWQtbWFpbiwuZmVlZC1pdGVtLmNvbWJpbmUgeyBtYXJnaW4tbGVmdDowIWltcG9ydGFudCB9JwogICAgICAgICAgICAsJy5mZWVkLWl0ZW0tcSB7IG1hcmdpbi1sZWZ0Oi0zMHB4IWltcG9ydGFudDtwYWRkaW5nLWxlZnQ6MCFpbXBvcnRhbnQgfScKICAgICAgICAgICAgLCcnCiAgICAgICAgICAgICx3aW5kb3cuaVpoaWh1LkNvbW1lbnQuUmlnaHRDb21tZW50ID8gJycgOiAnLmZlZWQtaXRlbS1hIC56bS1jb21tZW50LWJveCB7IG1heC13aWR0aDo2MDJweCFpbXBvcnRhbnQgfScKICAgICAgICAgICAgLHdpbmRvdy5pWmhpaHUuQ29tbWVudC5SaWdodENvbW1lbnQgPyAnJyA6ICcuZmVlZC1pdGVtLXEgLnptLWNvbW1lbnQtYm94IHsgbWF4LXdpZHRoOjYzMnB4IWltcG9ydGFudDsgd2lkdGg6NjMycHghaW1wb3J0YW50IH0nCiAgICAgICAgICAgICwnJwogICAgICAgICAgICAsJy56bS10YWctZWRpdG9yLCcKICAgICAgICAgICAgLCcjemgtcXVlc3Rpb24tdGl0bGUsJwogICAgICAgICAgICAsJyN6aC1xdWVzdGlvbi1kZXRhaWwsJwogICAgICAgICAgICAsJyN6aC1xdWVzdGlvbi1tZXRhLXdyYXAsJwogICAgICAgICAgICAsJy56aC1hbnN3ZXJzLXRpdGxlLCcKICAgICAgICAgICAgLCcjemgtcXVlc3Rpb24tZmlsdGVyLXdyYXAgeycKICAgICAgICAgICAgLCcgICAgbWFyZ2luLWxlZnQ6LTMycHghaW1wb3J0YW50JwogICAgICAgICAgICAsJ30nCiAgICAgICAgICAgICwnJwogICAgICAgICAgICAsJyN6aC1xdWVzdGlvbi1sb2ctcGFnZS13cmFwIC56bS10YWctZWRpdG9yLCcKICAgICAgICAgICAgLCcjemgtcXVlc3Rpb24tbG9nLXBhZ2Utd3JhcCAjemgtcXVlc3Rpb24tdGl0bGUgeycKICAgICAgICAgICAgLCcgICAgbWFyZ2luLWxlZnQ6MCAhaW1wb3J0YW50JwogICAgICAgICAgICAsJ30nCiAgICAgICAgICAgICwnJwogICAgICAgICAgICAsJy56aC1hbnN3ZXJzLXRpdGxlLCcKICAgICAgICAgICAgLCcjemgtcXVlc3Rpb24tZmlsdGVyLXdyYXAgeycKICAgICAgICAgICAgLCcgICAgYm9yZGVyLWJvdHRvbToxcHggc29saWQgI0VFRSFpbXBvcnRhbnQ7JwogICAgICAgICAgICAsJyAgICB6LWluZGV4OjEwMDAhaW1wb3J0YW50JwogICAgICAgICAgICAsJ30nCiAgICAgICAgICAgICwnJwogICAgICAgICAgICAsJyN6aC1xdWVzdGlvbi1tZXRhLXdyYXAgeycKICAgICAgICAgICAgLCcgICAgbWFyZ2luLWJvdHRvbTowIWltcG9ydGFudDsnCiAgICAgICAgICAgICwnICAgIHBhZGRpbmctYm90dG9tOjEwcHghaW1wb3J0YW50OycKICAgICAgICAgICAgLCcgICAgYm9yZGVyLWJvdHRvbToxcHggc29saWQgI0VFRSFpbXBvcnRhbnQnCiAgICAgICAgICAgICwnfScKICAgICAgICAgICAgLCcnCiAgICAgICAgICAgICwnI3poLXF1ZXN0aW9uLWFuc3dlci13cmFwIHsgbWFyZ2luLXRvcDotMXB4IWltcG9ydGFudCB9JwogICAgICAgICAgICAsJycKICAgICAgICAgICAgLCcjemgtcXVlc3Rpb24tY29sbGFwc2VkLXdyYXAsI3poLXF1ZXN0aW9uLWFuc3dlci13cmFwIHsgYm9yZGVyOm5vbmUhaW1wb3J0YW50IH0nCiAgICAgICAgICAgICwnLnp1LXF1ZXN0aW9uLWNvbGxhcC10aXRsZSB7IGJvcmRlci10b3A6MXB4IHNvbGlkICNFRUUhaW1wb3J0YW50IH0nCiAgICAgICAgICAgICwnI3poLXF1ZXN0aW9uLWNvbGxhcHNlZC13cmFwPmRpdjpsYXN0LWNoaWxkLC56bS1pdGVtLWFuc3dlcjpsYXN0LWNoaWxkIHsgYm9yZGVyLWJvdHRvbToxcHggc29saWQgI0VFRSFpbXBvcnRhbnQgfScKICAgICAgICAgICAgLCcnCiAgICAgICAgICAgICwnLnp1LWF1dG9oaWRlLCcKICAgICAgICAgICAgLCcuem0tY29tbWVudC1vcC1saW5rLCcKICAgICAgICAgICAgLCcuem0tc2lkZS10cmVuZC1kZWwsJwogICAgICAgICAgICAsJy51bnBpbiB7JwogICAgICAgICAgICAsJyAgICB2aXNpYmlsaXR5OnZpc2libGUhaW1wb3J0YW50OycKICAgICAgICAgICAgLCcgICAgb3BhY2l0eTowOycKICAgICAgICAgICAgLCd9JwogICAgICAgICAgICAsJy5mZWVkLWl0ZW06aG92ZXIgLnp1LWF1dG9oaWRlLCcKICAgICAgICAgICAgLCcuem0taXRlbS1hbnN3ZXIgLnp1LWF1dG9oaWRlLCcKICAgICAgICAgICAgLCcuem0taXRlbS1jb21tZW50OmhvdmVyIC56bS1jb21tZW50LW9wLWxpbmssJwogICAgICAgICAgICAsJy56bS1zaWRlLXRyZW5kLXJvdzpob3ZlciAuem0tc2lkZS10cmVuZC1kZWwsJwogICAgICAgICAgICAsJy56bS1zaWRlLW5hdi1saTpob3ZlciAudW5waW4geycKICAgICAgICAgICAgLCcgICAgb3BhY2l0eToxOycKICAgICAgICAgICAgLCd9JwogICAgICAgICAgICAsJy56bS1pdGVtLXZvdGUtY291bnQ6aG92ZXIsLnptLXZvdGViYXIgYnV0dG9uOmhvdmVyeycKICAgICAgICAgICAgLCcgICAgYmFja2dyb3VuZDojYTZjZTU2IWltcG9ydGFudDsnCiAgICAgICAgICAgICwnICAgIGNvbG9yOiMzRTVFMDAgIWltcG9ydGFudCcKICAgICAgICAgICAgLCd9JwogICAgICAgICAgICAsJycKICAgICAgICAgICAgLCdhLGE6aG92ZXIsJwogICAgICAgICAgICAsJ2ksJwogICAgICAgICAgICAsJy56dS1hdXRvaGlkZSwnCiAgICAgICAgICAgICwnLnptLXZvdGViYXIgYnV0dG9uLCcKICAgICAgICAgICAgLCcuem0taXRlbS1jb21tZW50OmhvdmVyIC56bS1jb21tZW50LW9wLWxpbmssJwogICAgICAgICAgICAsJy56bS1jb21tZW50LW9wLWxpbmssJwogICAgICAgICAgICAsJy56bS1zaWRlLXRyZW5kLXJvdzpob3ZlciAuem0tc2lkZS10cmVuZC1kZWwsJwogICAgICAgICAgICAsJy56bS1zaWRlLXRyZW5kLWRlbCwnCiAgICAgICAgICAgICwnLnptLXNpZGUtbmF2LWxpLCcKICAgICAgICAgICAgLCcuenUtbWFpbi1mZWVkLWZyZXNoLWJ1dHRvbiwnCiAgICAgICAgICAgICwnLnpnLWljb24sJwogICAgICAgICAgICAsJy56bS1zaWRlLW5hdi1saTpob3ZlciAuemctaWNvbiwnCiAgICAgICAgICAgICwnLnptLXNpZGUtbmF2LWxpOmhvdmVyIGksJwogICAgICAgICAgICAsJy51bnBpbiwnCiAgICAgICAgICAgICwnLnptLXNpZGUtbmF2LWxpOmhvdmVyIC51bnBpbiB7JwogICAgICAgICAgICAsJyAgICAtbW96LXRyYW5zaXRpb246Y29sb3IgLjJzIGxpbmVhcixvcGFjaXR5IC4xNXMgbGluZWFyLGJhY2tncm91bmQtY29sb3IgLjJzIGxpbmVhcixiYWNrZ3JvdW5kLXBvc2l0aW9uIC4ycyBsaW5lYXIgLjFzOycKICAgICAgICAgICAgLCcgICAgLXdlYmtpdC10cmFuc2l0aW9uOmNvbG9yIC4ycyBsaW5lYXIsb3BhY2l0eSAuMTVzIGxpbmVhcixiYWNrZ3JvdW5kLWNvbG9yIC4ycyBsaW5lYXIsYmFja2dyb3VuZC1wb3NpdGlvbiAuMnMgbGluZWFyIC4xczsnCiAgICAgICAgICAgICwnICAgIHRyYW5zaXRpb246Y29sb3IgLjJzIGxpbmVhcixvcGFjaXR5IC4xNXMgbGluZWFyLGJhY2tncm91bmQtY29sb3IgLjJzIGxpbmVhcixiYWNrZ3JvdW5kLXBvc2l0aW9uIC4ycyBsaW5lYXIgLjFzOycKICAgICAgICAgICAgLCd9JwogICAgICAgICAgICAsJycKICAgICAgICAgICAgLCdoM3sgbGluZS1oZWlnaHQ6MjVweCB9JwogICAgICAgICAgICAsJy56dS1mb290ZXItaW5uZXIge3BhZGRpbmc6MTVweCAwIWltcG9ydGFudH0nCiAgICAgICAgICAgICwnLnptLXNpZGUtcGlubmVkLXRvcGljcyAuem0tc2lkZS1uYXYtbGl7ZmxvYXQ6bGVmdDtwYWRkaW5nLXJpZ2h0OjMwcHghaW1wb3J0YW50fScKICAgICAgICAgICAgLCcuem0tc2lkZS1saXN0LWNvbnRlbnR7Y2xlYXI6Ym90aH0nCiAgICAgICAgICAgICwnLnVucGlueyBkaXNwbGF5OmlubGluZS1ibG9jayFpbXBvcnRhbnQgfScKICAgICAgICAgICAsJyddLmpvaW4oJ1xuJyk7Cn0KCnZhciBjc3NfY29tbWVudD0nJzsKaWYocGFnZUlzLkhvbWV8fHBhZ2VJcy5RdWVzdGlvbnx8cGFnZUlzLkFuc3dlcil7CiAgICBjc3NfY29tbWVudCA9IHdpbmRvdy5pWmhpaHUuQ29tbWVudC5jc3M7Cn0KCmNzcyArPSB3aW5kb3cuaVpoaWh1LkFuc3dlci5jc3M7CgppZih3aW5kb3cuaVpoaWh1LlF1aWNrRmF2byl7CiAgICBjc3MgKz0gd2luZG93LmlaaGlodS5RdWlja0Zhdm8uY3NzOwp9CmlmKHdpbmRvdy5pWmhpaHUuUXVpY2tCbG9jayl7CiAgICBjc3MgKz0gd2luZG93LmlaaGlodS5RdWlja0Jsb2NrLmNzczsKfQppZih3aW5kb3cuaVpoaWh1Lk5vdGk3KXsKICAgIGNzcyArPSB3aW5kb3cuaVpoaWh1Lk5vdGk3LmNzczsKICAgIHdpbmRvdy5pWmhpaHUuTm90aTcuZW5oYW5jZSgpOwp9CnZhciBoZWFkcyA9IF9kb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKTsKaWYgKGhlYWRzLmxlbmd0aCA+IDApIHsKICAgIHZhciBub2RlID0gX2RvYy5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgbm9kZS50eXBlID0gInRleHQvY3NzIjsKICAgIG5vZGUuaWQgPSAiaXpoQ1NTX21haW4iOwogICAgbm9kZS5hcHBlbmRDaGlsZChfZG9jLmNyZWF0ZVRleHROb2RlKGNzcykpOwogICAgaGVhZHNbMF0uYXBwZW5kQ2hpbGQobm9kZSk7IAogICAgaWYoY3NzX2NvbW1lbnQhPScnKXsKICAgICAgICBub2RlID0gX2RvYy5jcmVhdGVFbGVtZW50KCJzdHlsZSIpCiAgICAgICAgbm9kZS50eXBlID0gInRleHQvY3NzIjsKICAgICAgICBub2RlLmlkID0gIml6aENTU19jb21tZW50IjsKICAgICAgICBub2RlLmFwcGVuZENoaWxkKF9kb2MuY3JlYXRlVGV4dE5vZGUoY3NzX2NvbW1lbnQpKTsKICAgICAgICBoZWFkc1swXS5hcHBlbmRDaGlsZChub2RlKTsKICAgIH0KfQoKaWYoISQoJy5tb2RhbC1kaWFsb2ctYmcnKS5sZW5ndGgpewogICAgJGJvZHkuYXBwZW5kKAogICAgICAgICQoJzxkaXYnLCB7IGlkOiAnaXpoLWRsZy1iZycsICdjbGFzcyc6ICdtb2RhbC1kaWFsb2ctYmcnIH0pLmNzcyh7CiAgICAgICAgICAgICd6LWluZGV4JzogOTUKICAgICAgICAgICwgJ29wYWNpdHknOiAwLjUKICAgICAgICAgICwgJ3Bvc2l0aW9uJzogJ2ZpeGVkJwogICAgICAgICAgLCAndG9wJzogMAogICAgICAgICAgLCAnYm90dG9tJzogMAogICAgICAgICAgLCAnbGVmdCc6IDAKICAgICAgICAgICwgJ3JpZ2h0JzogMAogICAgICAgICAgLCAnZGlzcGxheSc6ICdub25lJwogICAgICAgIH0pCiAgICApOwp9Cgp3aW5kb3cuaVpoaWh1LmdldEl0ZW09ZnVuY3Rpb24oJGMpewogICAgdmFyICRpdGVtPSQobnVsbCk7CiAgICBpZigkYyAmJiAkYy5sZW5ndGgpeyAKICAgICAgICB2YXIgJGl0ZW1NZXRhPSRjLmNsb3Nlc3QoJy56bS1pdGVtLW1ldGEnKTsKICAgICAgICBpZiAoJGl0ZW1NZXRhLmlzKCcuZmVlZC1tZXRhJykgfHwgJGl0ZW1NZXRhLnBhcmVudCgpLmlzKCcuZmVlZC1tZXRhJykpewogICAgICAgICAgICAkaXRlbT0kYy5jbG9zZXN0KCcuZmVlZC1pdGVtJyk7CiAgICAgICAgICAgICRpdGVtLmF0dHIoJ2RhdGEtYWlkJywgJGl0ZW0uY2hpbGRyZW4oJ21ldGFbaXRlbXByb3A9YW5zd2VyLWlkXScpLmF0dHIoJ2NvbnRlbnQnKSkKICAgICAgICB9ZWxzZSBpZigkaXRlbU1ldGEuaXMoJy5hbnN3ZXItYWN0aW9ucycpKXsKICAgICAgICAgICAgJGl0ZW09JGMuY2xvc2VzdCgnLnptLWl0ZW0tYW5zd2VyLC5mZWVkLWl0ZW0nKTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgJGl0ZW09JGl0ZW1NZXRhLnByZXYoKTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gJGl0ZW07Cn07Cgp1dGlscy5vYnNlcnZlRE9NTm9kZUFkZGVkKGRvY3VtZW50LmJvZHksZnVuY3Rpb24oZXZlbnQpewoJaWYoaXpoVG9wTmF2QXV0b0ZvbGQpewoJCXdpbmRvdy5pWmhpaHUuVG9wTmF2Lm9uTm9kZUFkZGVkKGV2ZW50KQoJfQp9KQovKioKICogQGNsYXNzIEFuc3dlcgogKi8KZnVuY3Rpb24gQW5zd2VyKGlaaGlodSkgewogICAgaWYgKCB0eXBlb2YgaVpoaWh1ID09PSAndW5kZWZpbmVkJyB8fCAhaVpoaWh1KSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBpWmhpaHUuQW5zd2VyID0gdGhpczsKCiAgICB0aGlzLl9lPW51bGw7CiAgICB0aGlzLnBwV2lkdGg9MDsKICAgIHRoaXMucHBIZWlnaHQ9NDAwOwoKICAgIHRoaXMuY3NzID0gCiAgICAgICAgWycuem0tdm90ZWJhciAuaXpoLWJ1dHRvbi5mb2xke21hcmdpbjo1cHggMHB4IDBweDtkaXNwbGF5OmJsb2NrO2NvbG9yOiM2OThFQkY7aGVpZ2h0OjI0cHg7bGluZS1oZWlnaHQ6MjRweDt3aWR0aDozOHB4O2JvcmRlci1yYWRpdXM6M3B4O2JvcmRlcjowcHggbm9uZTtjdXJzb3I6cG9pbnRlcjtiYWNrZ3JvdW5kOm5vbmUgcmVwZWF0IHNjcm9sbCAwJSAwJSAjRUZGNkZBO2ZvbnQtd2VpZ2h0OmZvbnQtd2VpZ2h0O3Bvc2l0aW9uOnJlbGF0aXZlO30nCiAgICAgICAgLCcnXS5qb2luKCdcbicpOwoKICAJdGhpcy5wcm9jZXNzQW5zd2VyPWZ1bmN0aW9uKCRhLCRwcCxiQXV0aG9yUmVhcixiQXV0aG9yTGlzdCl7CiAgICAgICAgaWYoISRhfHwhJGEubGVuZ3RoKXJldHVybjsKICAgICAgICBpZigkYS5hdHRyKCdpemhfcHJvY2Vzc2VkJyk9PScxJylyZXR1cm47CiAgICAgICAgdmFyIHNlbENvbGxhcHNlPScubWV0YS1pdGVtW25hbWU9Y29sbGFwc2VdJwogICAgICAgICAgLCAkbWV0YT0kYS5maW5kKCcuem0taXRlbS1tZXRhJykKICAgICAgICAgICwgJGF1dGhvcj0kYS5maW5kKCcuem0taXRlbS1hbnN3ZXItYXV0aG9yLWluZm8nKQogICAgICAgICAgLCAkZmF2bz0kYS5maW5kKCcubWV0YS1pdGVtW25hbWU9ZmF2b10nKQogICAgICAgICAgLCAkdm90ZT0kYS5maW5kKCcuem0tdm90ZWJhcicpCiAgICAgICAgOwogICAgICAgIGlmKGlaaGlodS5RdWlja0Jsb2NrKXsKICAgICAgICAgICAgLy8gUmVnaW9uOiDlv6vpgJ/lsY/olL0KICAgICAgICAgICAgaVpoaWh1LlF1aWNrQmxvY2suYWRkUXVpY2tCbG9jaygkYSkKCiAgICAgICAgICAgIC8vIFJlZ2lvbiBlbmQKICAgICAgICB9CiAgICAgICAgaWYoJGF1dGhvci5sZW5ndGgpey8vcmVsb2NhdGVQZXJzb25JbmZvCiAgICAgICAgICAgIGlmKGJBdXRob3JSZWFyKXsKICAgICAgICAgICAgICAgICRhdXRob3IuY3NzKHsKICAgICAgICAgICAgICAgICAgICAndGV4dEFsaWduJzoncmlnaHQnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmKCRhLmlzKCcuZmVlZC1pdGVtJykpewogICAgICAgICAgICAgICAgICAgICRhLmZpbmQoJy5lbnRyeS1ib2R5IC56bS1pdGVtLWFuc3dlci1kZXRhaWwgLnptLWl0ZW0tcmljaC10ZXh0JykKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkYXV0aG9yLmhpZGUoKSkuYmluZCgnRE9NTm9kZUluc2VydGVkJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGM9JChldmVudC50YXJnZXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGMuaXMoJy56bS1lZGl0YWJsZS1jb250ZW50JykpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oJy56bS1pdGVtLWFuc3dlci1hdXRob3ItaW5mbycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5pbnNlcnRCZWZvcmUoJGMuY2hpbGRyZW4oJy5hbnN3ZXItZGF0ZS1saW5rLXdyYXAnKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOidhYnNvbHV0ZScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICdyaWdodCc6MAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgJGF1dGhvci5pbnNlcnRCZWZvcmUoJG1ldGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICRhdXRob3I9JGF1dGhvci5jaGlsZHJlbigpLmVxKDEpOwogICAgICAgICAgICBpZiAoJHBwICYmIGJBdXRob3JMaXN0KXsKICAgICAgICAgICAgICAgIC8vIFJlZ2lvbjog5Zue562U55uu5b2V6aG5CiAgICAgICAgICAgICAgICB2YXIgY29sbGFwc2VkPSRhLmF0dHIoJ2RhdGEtY29sbGFwc2VkJyk9PScxJwogICAgICAgICAgICAgICAgICAsICRwcGxhPSQoJzxhPicsewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZjonI2Fuc3dlci0nKyRhLmF0dHIoJ2RhdGEtYWlkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAsIHRhcmdldDonX3NlbGYnCiAgICAgICAgICAgICAgICAgICAgICAgICAgLCBzdHlsZTpjc3NfQXV0aG9yTGlzdEl0ZW1BCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICwgJHBwbD0kKCc8bGk+JykuYXBwZW5kKCRwcGxhKQogICAgICAgICAgICAgICAgICAsICR1bm89aVpoaWh1LiR1bm9BbnN3ZXJzCiAgICAgICAgICAgICAgICBpZihjb2xsYXBzZWQpewogICAgICAgICAgICAgICAgICAgICRwcGwuYXBwZW5kVG8oJHBwKQogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgJHBwbC5pbnNlcnRCZWZvcmUoJHVuby4kZW5kT2ZMYXN0QSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCRhLmF0dHIoJ2RhdGEtaXNvd25lcicpPT0nMScpewogICAgICAgICAgICAgICAgICAgIGlaaGlodS5BbnN3ZXIuX2U9JGEuZ2V0KDApOwogICAgICAgICAgICAgICAgICAgICRwcGxhLmFwcGVuZCgkKCc8c3Bhbj4nLCB7ICdjbGFzcyc6ICdtZScgfSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIG5hbWVDU1M9J25hbWUnOwogICAgICAgICAgICAgICAgaWYoJGEuYXR0cignZGF0YS1pc2ZyaWVuZCcpPT0nMScpewogICAgICAgICAgICAgICAgICAgIG5hbWVDU1MrPScgZnJpZW5kJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGNvbGxhcHNlZCl7CiAgICAgICAgICAgICAgICAgICAgbmFtZUNTUys9JyBjb2xsYXBzZWQnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZighJGF1dGhvci5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgIG5hbWVDU1MrPScgbm9uYW1lJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICQoJzxzcGFuPicsewogICAgICAgICAgICAgICAgICAgICdjbGFzcyc6bmFtZUNTUwogICAgICAgICAgICAgICAgICAsIHN0eWxlOmNzc19BdXRob3JMaXN0SXRlbUFfbmFtZQogICAgICAgICAgICAgICAgfSkudGV4dCghJGF1dGhvci5sZW5ndGg/J+WMv+WQjeeUqOaItyc6JGF1dGhvci50ZXh0KCkpLmFwcGVuZFRvKCRwcGxhKTsKICAgICAgICAgICAgICAgIGlmICgkcHBsLndpZHRoKCk+aVpoaWh1LkFuc3dlci5wcFdpZHRoKQogICAgICAgICAgICAgICAgICAgIGlaaGlodS5BbnN3ZXIucHBXaWR0aD0kcHBsLndpZHRoKCk7CiAgICAgICAgICAgICAgICAvLyBSZWdpb24gZW5kCiAgICAgICAgICAgICAgICAvLyBSZWdpb246IOWbnuetlOevh+W5heaMh+ekugogICAgICAgICAgICAgICAgdmFyIG5IUD1NYXRoLmNlaWwoJCgnLnptLWVkaXRhYmxlLWNvbnRlbnQnLCRhKS50ZXh0KCkubGVuZ3RoLzEwMCk7CiAgICAgICAgICAgICAgICAkKCc8c3Bhbj4nLHsKICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOidocCcKICAgICAgICAgICAgICAgIH0pLmNzcyh7J3dpZHRoJzpuSFAqMTAsJ21hcmdpbi1sZWZ0JzotbkhQKjEwfSkuYXBwZW5kVG8oJHBwbGEpOwogICAgICAgICAgICAgICAgLy8gUmVnaW9uIGVuZAogICAgICAgICAgICAgICAgJHBwbGEubW91c2VvdmVyKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmcm09JCh0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlKQogICAgICAgICAgICAgICAgICAgICAgLCAkdW5vPWlaaGlodS4kdW5vQW5zd2VycwogICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ3NlbCcpOwogICAgICAgICAgICAgICAgICAgIGlmKGlaaGlodS5BbnN3ZXIuX2UpewogICAgICAgICAgICAgICAgICAgICAgICAkdW5vLmNoaWxkcmVuKCcubWVUJykuY3NzKCdkaXNwbGF5JywwPmlaaGlodS5BbnN3ZXIuX2Uub2Zmc2V0VG9wLSRmcm0uc2Nyb2xsVG9wKCk/Jyc6J25vbmUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHVuby5jaGlsZHJlbignLm1lQicpLmNzcygnZGlzcGxheScsJGZybS5oZWlnaHQoKTxpWmhpaHUuQW5zd2VyLl9lLm9mZnNldFRvcC0kZnJtLnNjcm9sbFRvcCgpK2laaGlodS5BbnN3ZXIuX2Uub2Zmc2V0SGVpZ2h0PycnOidub25lJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIFJlZ2lvbjog5Zue562U6aKE6KeICiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbT0kKCdzcGFuLm5hbWUnLHRoaXMpOwogICAgICAgICAgICAgICAgICAgIGlmKCFuYW0ubGVuZ3RoKXJldHVybjsKICAgICAgICAgICAgICAgICAgICB2YXIgYWlkPSQodGhpcykuYXR0cignaHJlZicpLnJlcGxhY2UoJyNhbnN3ZXItJywnJykKICAgICAgICAgICAgICAgICAgICAgICwgcHJ2PSR1bm8ubmV4dCgnLml6aC1hbnN3ZXItcHJldmlldycpCiAgICAgICAgICAgICAgICAgICAgICAsIHRvcD0kKHRoaXMpLnBvc2l0aW9uKCkudG9wKyR1bm8ucG9zaXRpb24oKS50b3AKICAgICAgICAgICAgICAgICAgICAgICwgc2VsPScuem0taXRlbS1hbnN3ZXJbZGF0YS1haWQ9JythaWQrJ10gPiAuem0taXRlbS1yaWNoLXRleHQnCiAgICAgICAgICAgICAgICAgICAgICAsIGN0eD1uYW0uaXMoJy5jb2xsYXBzZWQnKT8nI3poLXF1ZXN0aW9uLWNvbGxhcHNlZC13cmFwJzonI3poLXF1ZXN0aW9uLWFuc3dlci13cmFwJwogICAgICAgICAgICAgICAgICAgICAgLCBkaXY9JChzZWwsY3R4KQogICAgICAgICAgICAgICAgICAgICAgLCBjbXQ9JCgnLnptLWl0ZW0tbWV0YSA+IC56dS1xdWVzdGlvbi1hbnN3ZXItbWV0YS1jb21tZW50JyxkaXYucGFyZW50KCkpCiAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgIGlmKCFwcnYubGVuZ3RoKXsKICAgICAgICAgICAgICAgICAgICAgICAgcHJ2PSQoJzxkaXY+Jyx7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzpkaXYuY2xhc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoJ2l6aC1hbnN3ZXItcHJldmlldycpLndpZHRoKGRpdi53aWR0aCgpKzIyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1vdXNlb3ZlcihmdW5jdGlvbigpeyR1bm8ubW91c2VvdmVyKCk7JCgnbGkgYVtocmVmPSMnKyQodGhpcykuYXR0cignZGF0YS1haWQnKSsnXScsJHVubykuYWRkQ2xhc3MoJ3NlbCcpOyQodGhpcykuc2hvdygpO30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubW91c2VvdXQoZnVuY3Rpb24oKXskdW5vLm1vdXNlb3V0KCk7JCgnbGkgYVtocmVmPSMnKyQodGhpcykuYXR0cignZGF0YS1haWQnKSsnXScsJHVubykucmVtb3ZlQ2xhc3MoJ3NlbCcpOyQodGhpcykuaGlkZSgpO30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xpY2soZnVuY3Rpb24oKXskKCdsaSBhW2hyZWY9IycrJCh0aGlzKS5hdHRyKCdkYXRhLWFpZCcpKyddJywkdW5vKVswXS5jbGljaygpO30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaW5zZXJ0QWZ0ZXIoJHVubykKICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihwcnYuYXR0cignZGF0YS1haWQnKSE9YWlkKXsKICAgICAgICAgICAgICAgICAgICAgICAgcHJ2LmF0dHIoJ2RhdGEtYWlkJyxhaWQpLmVtcHR5KCkuYXBwZW5kKGRpdi5jbG9uZSgpLmNoaWxkcmVuKCkpLmZpbmQoJ2EnKS5hdHRyKCdvbmNsaWNrJywncmV0dXJuIGZhbHNlOycpOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkKCdzcGFuLm1lJyx0aGlzKS5sZW5ndGgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcnYuZmluZCgnYS56dS1lZGl0LWJ1dHRvbicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZighbmFtLmhhc0NsYXNzKCdub25hbWUnKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2ltZy56bS1saXN0LWF2YXRhcicsZGl2LnBhcmVudCgpKS5jbG9uZSgpLmFwcGVuZFRvKHBydik7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0PWNtdC50ZXh0KCksaT10LmluZGV4T2YoJ+adoeivhOiuuicpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihjbXQubGVuZ3RoJiZpPjApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCc8c3Bhbj4nLHsnY2xhc3MnOidjb21tZW50J30pLnRleHQodC5zdWJzdHJpbmcoMCxpKSkucHJlcGVuZChjbXQuY2hpbGRyZW4oJ2knKS5jbG9uZSgpKS5hcHBlbmRUbyhwcnYpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgdGg9ZGl2LmhlaWdodCgpKzMzCiAgICAgICAgICAgICAgICAgICAgICAsIG1heFRvcD0kdW5vLnBvc2l0aW9uKCkudG9wKzEyCiAgICAgICAgICAgICAgICAgICAgICAsIGNvbnRlbnRQb3NpdGlvbj0nJzsKICAgICAgICAgICAgICAgICAgICBpZihtYXhUb3ArdGg8JHdpbi5oZWlnaHQoKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRvcCt0aDwkd2luLmhlaWdodCgpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBydi5jc3Moeyd0b3AnOnRvcD5tYXhUb3A/dG9wOm1heFRvcCwnYm90dG9tJzonJ30pOwogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBydi5jc3Moeyd0b3AnOicnLCdib3R0b20nOjB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICBwcnYuY3NzKHsndG9wJzptYXhUb3AsJ2JvdHRvbSc6MH0pOwogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50UG9zaXRpb249J2Fic29sdXRlJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcHJ2LmNzcyh7J2xlZnQnOiR1bm8ud2lkdGgoKX0pLnNob3coKS5jaGlsZHJlbigpLmZpcnN0KCkuY3NzKCdwb3NpdGlvbicsY29udGVudFBvc2l0aW9uKTsKICAgICAgICAgICAgICAgICAgICAvLyBSZWdpb24gZW5kCiAgICAgICAgICAgICAgICB9KS5tb3VzZW91dChmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ3NlbCcpOwogICAgICAgICAgICAgICAgICAgIHZhciAkdW5vPSQodGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlKTsKICAgICAgICAgICAgICAgICAgICAkdW5vLm5leHQoKS5oaWRlKCk7CiAgICAgICAgICAgICAgICB9KS5jbGljayhmdW5jdGlvbigpeyQodGhpcykubW91c2VvdXQoKTsKICAgICAgICAgICAgICAgIGlaaGlodS4kdW5vQW5zd2Vycy5jc3MoJ2xlZnQnLDktaVpoaWh1LiR1bm9BbnN3ZXJzLndpZHRoKCkpO30pOwogICAgICAgICAgICAgICAgaWYoaVpoaWh1LkFuc3dlci5fZT09JGEuZ2V0KDApKXsKICAgICAgICAgICAgICAgICAgICBpWmhpaHUuQW5zd2VyLl9lPSRwcGxhLmdldCgwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYoaVpoaWh1LlF1aWNrRmF2bykKICAgICAgICAgICAgaVpoaWh1LlF1aWNrRmF2by5hZGRRdWlja0Zhdm8oJGZhdm8sJGEpOwoKICAgICAgICAkbWV0YS5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQucHJvY2Vzc0NvbW1lbnQoJChldmVudC50YXJnZXQpKTsKICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBpWmhpaHUuQ29tbWVudC5wcm9jZXNzQ29tbWVudEJ1dHRvbigkYSk7CgogICAgICAgIHZhciAkY209JCgnLnptLWNvbW1lbnQtYm94JywkYSk7CiAgICAgICAgaWYoJGNtLmxlbmd0aCAmJiAkY20uaXMoJzp2aXNpYmxlJykpewogICAgICAgIAl2YXIgZm9jdXNOYW1lID0gaVpoaWh1LkNvbW1lbnQuc2Nyb2xsRm9jdXNDb21tZW50T25QYWdlTG9hZCgkY20pOwogICAgCiAgICAgICAgICAgIGlaaGlodS5Db21tZW50Lm1ldGFTY3JvbGxUb1ZpZXdCb3R0b20oJGNtLmNsb3Nlc3QoJy56bS1pdGVtLW1ldGEnKSxmdW5jdGlvbigpewogICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQucHJvY2Vzc0NvbW1lbnQoJGNtLCBmb2N1c05hbWUpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgJGEuYXR0cignaXpoX3Byb2Nlc3NlZCcsJzEnKTsKICAgIH07CgogICAgcmV0dXJuIHRoaXM7Cn0KCi8qKgogKiBAY2xhc3MgQ29tbWVudAogKi8KZnVuY3Rpb24gQ29tbWVudChpWmhpaHUpIHsKICAgIGlmICggdHlwZW9mIGlaaGlodSA9PT0gJ3VuZGVmaW5lZCcgfHwgIWlaaGlodSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgaVpoaWh1LkNvbW1lbnQgPSB0aGlzOwoKICAgIHZhciBjc3NfY29tbWVudD17CiAgICAgICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yJzonI2ZmZicKICAgICAgICAgICwgJ291dGxpbmUnOidub25lJwogICAgICAgICAgLCAnei1pbmRleCc6Jzk5OTknCiAgICAgICAgICAsICdib3JkZXItcmFkaXVzJzonMCA2cHggMCAwJwogICAgICAgICAgLCAncG9zaXRpb24nOidhYnNvbHV0ZScKICAgICAgICAgICwgJ3Zpc2liaWxpdHknOidoaWRkZW4nCiAgICAgICAgICAsICd0b3AnOi03MAogICAgICAgIH0KICAgIDsKICAgIHRoaXMuUmlnaHRDb21tZW50ID0gaVpoaWh1LmNvbmZpZ1snU2hvd0NvbW1lbnQnXTsKICAgIHRoaXMuQXV0b1Njcm9sbFBhZ2VXaGVuQ2xvc2luZyA9IGlaaGlodS5jb25maWdbJ1JpZ2h0Q29tbWVudF9BdXRvU2Nyb2xsUGFnZVdoZW5DbG9zaW5nJ107CiAgICBpZiAoIXRoaXMuUmlnaHRDb21tZW50KXsKICAgICAgICB0aGlzLmNzcyA9IAogICAgICAgICAgICBbJy56bS1jb21tZW50LWJveC5lbXB0eSAuaXpoLWJ1dHRvbi1jY3tkaXNwbGF5Om5vbmU7fScKICAgICAgICAgICAgLCcnXS5qb2luKCdcbicpOwogICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmNzcyA9IAogICAgICAgICAgICBbJy5tZW50aW9uLXBvcHVwe3otaW5kZXg6MTAwMDAgIWltcG9ydGFudDt9JwogICAgICAgICAgICAsJy56bS1pdGVtLW1ldGEgLm1ldGEtaXRlbS50b2dnbGUtY29tbWVudHtkaXNwbGF5OmJsb2NrO2Zsb2F0OnJpZ2h0O21hcmdpbi1sZWZ0OjdweCAhaW1wb3J0YW50O30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94e3Bvc2l0aW9uOmFic29sdXRlO21hcmdpbi10b3A6MDt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCAuaWNvbi1zcGlrZXtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCA+IC56bS1jb21tZW50LWJveC1mdHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7cmlnaHQ6MDt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveC5lbXB0eXtwYWRkaW5nLXRvcDoxMHB4ICFpbXBvcnRhbnQ7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3ggPiAuem0tY29tbWVudC1mb3Jte21hcmdpbjoxNXB4ICFpbXBvcnRhbnQ7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3guZW1wdHkgPiAuem0tY29tbWVudC1mb3Jte2JvdHRvbToyNXB4O30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94ID4gLnptLWNvbW1lbnQtZm9ybSAuem0tY29tbWVudC1lZGl0YWJsZXtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206NjBweDt0b3A6MDtsZWZ0OjA7cmlnaHQ6MDtvdmVyZmxvdzphdXRvO30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94LmVtcHR5ID4gLnptLWNvbW1lbnQtZm9ybSAuem0tY29tbWVudC1lZGl0YWJsZXtib3R0b206MjVweDt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCA+IC56bS1jb21tZW50LWZvcm0gLnptLWNvbW1hbmR7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3JpZ2h0OjA7Ym90dG9tOjQwcHg7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3guZW1wdHkgPiAuem0tY29tbWVudC1mb3JtIC56bS1jb21tYW5ke2JvdHRvbToxMHB4O30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94IFtjbGFzc149aXpoLWJ1dHRvbnMtY21de3Bvc2l0aW9uOmFic29sdXRlO3RvcDo3MHB4O30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94LmVtcHR5IFtjbGFzc149aXpoLWJ1dHRvbnMtY21de3RvcDphdXRvO2JvdHRvbTozMHB4O3otaW5kZXg6MTA7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3ggLml6aC1idXR0b25zLWNtLUx7bGVmdDowO30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94IC5pemgtYnV0dG9ucy1jbS1MID4gYXttYXJnaW4tcmlnaHQ6N3B4O30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94IC5pemgtYnV0dG9ucy1jbS1Se3JpZ2h0OjFlbTt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCAuaXpoLWJ1dHRvbnMtY20tUiA+IGF7bWFyZ2luLWxlZnQ6N3B4O30nCiAgICAgICAgICAgICwnLnptLWNvbW1lbnQtYm94IGEuaXpoLWJ1dHRvbi5vbntjb2xvcjojMjI1NTk5O3RleHQtc2hhZG93OjAgMCAxcHggIzIyNTU5OTt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCBhLml6aC1idXR0b24gLnpnLWljb257b3BhY2l0eTowLjU7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3ggYS5pemgtYnV0dG9uLm9uIC56Zy1pY29ue29wYWNpdHk6MTt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCBhLml6aC1idXR0b24ub2Zme2NvbG9yOiNlZWU7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3ggYS5pemgtYnV0dG9uLm9mZiAuemctaWNvbntvcGFjaXR5OjAuMjt9JwogICAgICAgICAgICAvLywnLnptLWNvbW1lbnQtYm94LmVtcHR5IFtjbGFzc149aXpoLWJ1dHRvbnMtY21de3RvcDphdXRvO2JvdHRvbTo3cHg7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3guZW1wdHkgLnptLWNvbW1lbnQtbGlzdHt2aXNpYmlsaXR5OmhpZGRlbjt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCAuem0tY29tbWVudC1saXN0IC56bS1pdGVtLWNvbW1lbnRbaXpoX2hpbGlnaHRde2JhY2tncm91bmQtY29sb3I6cmdiKDI1NSwyNTUsMTYwKTt9JwogICAgICAgICAgICAsJy56bS1jb21tZW50LWJveCAuaXpoLWJ1dHRvbi5vbiAuemctaWNvbi1jb21tZW50LWxpa2V7YmFja2dyb3VuZC1wb3NpdGlvbjotMjIycHggLTc5cHg7fScKICAgICAgICAgICAgLCcuem0tY29tbWVudC1ib3ggLml6aC1idXR0b24gLnotaWNvbi1mb2xke2hlaWdodDo2cHg7fScKICAgICAgICAgICAgLCcnXS5qb2luKCdcbicpOwogICAgICAgIHRoaXMub25XaW5Mb2FkPWZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBpWmhpaHU9d2luZG93LmlaaGlodTsKICAgICAgICAgICAgaVpoaWh1LiR3aW4uc2Nyb2xsKGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgICAgIGlmKGlaaGlodS5Db21tZW50Lk9wZW5pbmcmJiFpWmhpaHUuQ29tbWVudC5QYWdlTm90U2Nyb2xsKXsKICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0ZT10cnVlOwogICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50LmJveCgkKGlaaGlodS5Db21tZW50Lk9wZW5pbmcpLHRydWUsYW5pbWF0ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIAogICAgICAgICAgICBpWmhpaHUuJHdpbi5yZXNpemUoZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgaWYoaVpoaWh1LkNvbW1lbnQuT3BlbmluZyl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRjbT0kKGlaaGlodS5Db21tZW50Lk9wZW5pbmcpOwogICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50Lk9wZW5pbmcgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50LmNsb3NlKG51bGwsJGNtKTsKICAgICAgICAgICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5vcGVuKG51bGwsJGNtKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmKGlaaGlodS5TY3JvbGxUb3ApewogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A9aVpoaWh1LlNjcm9sbFRvcDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLm9uV2luTG9hZCgpCiAgICB9CiAgICB0aGlzLnByb2Nlc3NDb21tZW50QnV0dG9uID0gZnVuY3Rpb24oJGEpewogICAgICAgIGlmKGlaaGlodS5Db21tZW50LlJpZ2h0Q29tbWVudCl7CiAgICAgICAgICAgIHZhciAkYmM9JGEuZmluZCgnLm1ldGEtaXRlbS50b2dnbGUtY29tbWVudCcpOwogICAgICAgICAgICAkYmMucHJlcGVuZFRvKCRiYy5wYXJlbnQoKSk7CiAgICAgICAgfQogICAgfTsKICAgIHRoaXMuc2Nyb2xsRm9jdXNDb21tZW50T25QYWdlTG9hZCA9IGZ1bmN0aW9uKCRjbSl7CiAgICAgICAgaWYoIWlaaGlodS5Db21tZW50LlJpZ2h0Q29tbWVudClyZXR1cm47CiAgICAgICAgdmFyIGZvY3VzTmFtZT11cmwuZGF0YS5hdHRyLmZyYWdtZW50OwogICAgICAgIGlmKCFmb2N1c05hbWV8fGZvY3VzTmFtZT09JycpcmV0dXJuOwogICAgCWlmKHdpbmRvdy5pWmhpaHU0Q1JYKXsKICAgICAgICAgICAgdmFyICRpY20yQz0kY20uZmluZCgnLnptLWNvbW1lbnQtbGlzdCAuem0taXRlbS1jb21tZW50IGEuemctYW5jaG9yLWhpZGRlbltuYW1lPSInK2ZvY3VzTmFtZSsnIl0nKS5wYXJlbnQoKQogICAgICAgICAgICAgICwgb2Zmc2V0VG9wPSRpY20yQy5sZW5ndGg/JGljbTJDLm9mZnNldCgpLnRvcDowCiAgICAgICAgICAgIDtpZihvZmZzZXRUb3Ape2RvY3VtZW50LmJvZHkuc2Nyb2xsVG9wPW9mZnNldFRvcDt9CiAgICAJfQogICAgICAgIHJldHVybiBmb2N1c05hbWU7CiAgICB9OwogICAgCiAgICB0aGlzLm1ldGFTY3JvbGxUb1ZpZXdCb3R0b20gPSBmdW5jdGlvbigkaXRlbU1ldGEsZnVuY0FmdGVyU2Nyb2xsLGFsd2F5cyxhbmltYXRlKXsKICAgICAgICBpZighaVpoaWh1LkNvbW1lbnQuUmlnaHRDb21tZW50IHx8ICFpWmhpaHUuQ29tbWVudC5BdXRvU2Nyb2xsUGFnZVdoZW5DbG9zaW5nKXsKICAgICAgICAgICAgaWYoZnVuY0FmdGVyU2Nyb2xsKXtmdW5jQWZ0ZXJTY3JvbGwoKTt9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYodHlwZW9mIGFsd2F5cyA9PT0gJ3VuZGVmaW5lZCcpYWx3YXlzPXRydWU7Ly9pZiBmYWxzZSwgc2Nyb2xsaW5nIG9ubHkgd2hlbiB0aGUgLnptLWl0ZW0tbWV0YSBvdXQgb2YgdmlzaWJsZSByYW5nZQogICAgICAgIGlmKHR5cGVvZiBhbmltYXRlID09PSAndW5kZWZpbmVkJylhbmltYXRlPWZhbHNlOy8vaWYgZmFsc2UsIHNjcm9sbGluZyBpbnN0YW50bHkKICAgICAgICBpZihhbHdheXMpJGl0ZW1NZXRhLmNoaWxkcmVuKCcuem0tY29tbWVudC1ib3gnKS5jc3MoJ3Bvc2l0aW9uJywnZml4ZWQnKTsKICAgICAgICB2YXIgd2luSGVpZ2h0PWlaaGlodS4kd2luLmhlaWdodCgpCiAgICAgICAgICAsIHNjcm9sbE9iaj13aW5kb3cuaVpoaWh1NENSWD9kb2N1bWVudC5ib2R5OmRvY3VtZW50LmRvY3VtZW50RWxlbWVudAogICAgICAgICAgLCBzY3JvbGxUb3BOb3c9c2Nyb2xsT2JqLnNjcm9sbFRvcAogICAgICAgICAgLCBuYXZIZWlnaHQ9aVpoaWh1LiRib2R5LmNoaWxkcmVuKCkuZmlyc3QoKS5oZWlnaHQoKQogICAgICAgICAgLCBiYXI9JCgnLnp1LWdsb2JhbC1ub3RpZnkuenUtZ2xvYmFsLW5vdGlmeS1pbmZvOnZpc2libGUnKQogICAgICAgICAgLCBiYXJIZWlnaHQ9IWJhci5sZW5ndGg/MDpiYXIub3V0ZXJIZWlnaHQoKQogICAgICAgICAgLCBiYXNlVG9wPSgoYmFySGVpZ2h0JiZiYXIuY3NzKCdwb3NpdGlvbicpPT0nZml4ZWQnKT9iYXJIZWlnaHQ6KHNjcm9sbFRvcE5vdz5iYXJIZWlnaHQ/MDpiYXJIZWlnaHQtc2Nyb2xsVG9wTm93KSkrbmF2SGVpZ2h0CiAgICAgICAgICAsIG1heEhlaWdodD13aW5IZWlnaHQtYmFzZVRvcAogICAgICAgICAgLCBtZXRhSGVpZ2h0PSRpdGVtTWV0YS5pbm5lckhlaWdodCgpCiAgICAgICAgICAsIG9mZnNldFRvcD0kaXRlbU1ldGEub2Zmc2V0KCkudG9wCiAgICAgICAgICAsIG9mZnNldEJvdHRvbT1vZmZzZXRUb3ArbWV0YUhlaWdodAogICAgICAgICAgLCAkaXRlbT1pWmhpaHUuZ2V0SXRlbSgkaXRlbU1ldGEpCiAgICAgICAgICAsIGl0ZW1IZWlnaHQ9JGl0ZW0uaW5uZXJIZWlnaHQoKQogICAgICAgICAgLCBvZmZzZXRUb3BBPSRpdGVtLm9mZnNldCgpLnRvcAogICAgICAgICAgLCBvZmZzZXRCb3R0b21BPW9mZnNldFRvcEEraXRlbUhlaWdodAogICAgICAgICAgLCBzY3JvbGxUb3BFbmQ9aXRlbUhlaWdodD5tYXhIZWlnaHQ/b2Zmc2V0Qm90dG9tLXdpbkhlaWdodDoob2Zmc2V0VG9wQTw9c2Nyb2xsVG9wTm93P29mZnNldFRvcEEtYmFzZVRvcDpvZmZzZXRCb3R0b20td2luSGVpZ2h0KQogICAgICAgIDsKICAgICAgICBpZighYWx3YXlzKXsKICAgICAgICAgICAgYWx3YXlzPW9mZnNldFRvcDxzY3JvbGxUb3BOb3crYmFzZVRvcHx8b2Zmc2V0Qm90dG9tPnNjcm9sbFRvcE5vdyt3aW5IZWlnaHQtYmFzZVRvcDsKICAgICAgICB9CiAgICAgICAgaWYoYWx3YXlzKXsKICAgICAgICAgICAgaVpoaWh1LlNjcm9sbFRvcD1zY3JvbGxUb3BFbmQ7CiAgICAgICAgICAgIGlmKGFuaW1hdGUpewogICAgICAgICAgICAgICAgJChzY3JvbGxPYmopLmFuaW1hdGUoeydzY3JvbGxUb3AnOnNjcm9sbFRvcEVuZH0sZnVuY0FmdGVyU2Nyb2xsKTsKICAgICAgICAJfWVsc2V7CiAgICAgICAgICAgICAgICAkKHNjcm9sbE9iaikuc2Nyb2xsVG9wKHNjcm9sbFRvcEVuZCk7CiAgICAgICAgICAgICAgICBpZihmdW5jQWZ0ZXJTY3JvbGwpe2Z1bmNBZnRlclNjcm9sbCgpO30KICAgICAgICAJfQogICAgICAgIH1lbHNlewogICAgICAgICAgICBpZihmdW5jQWZ0ZXJTY3JvbGwpe2Z1bmNBZnRlclNjcm9sbCgpO30KICAgICAgICB9CiAgICB9OwogICAgdGhpcy5ib3ggPSBmdW5jdGlvbigkY20sa2VlcFNpemUsYW5pbWF0ZSl7aWYoISRjbXx8ISRjbS5sZW5ndGgpcmV0dXJuOwogICAgICAgICRjbS5zdG9wKCk7CiAgICAgICAgaWYodHlwZW9mIGtlZXBTaXplID09PSAndW5kZWZpbmVkJylrZWVwU2l6ZT1mYWxzZTsKICAgICAgICBpZih0eXBlb2YgYW5pbWF0ZSA9PT0gJ3VuZGVmaW5lZCcpYW5pbWF0ZT1mYWxzZTsKICAgICAgICB2YXIgd2luSGVpZ2h0PWlaaGlodS4kd2luLmhlaWdodCgpCiAgICAgICAgICAsIHRoPWtlZXBTaXplP3BhcnNlSW50KCRjbS5hdHRyKCdpemhfY21IZWlnaHQnKSk6MAogICAgICAgICAgLCBzY3JvbGxUb3A9KGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wKT9kb2N1bWVudC5ib2R5LnNjcm9sbFRvcDpkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wCiAgICAgICAgICAsIG5hdkhlaWdodD1pWmhpaHUuJGJvZHkuY2hpbGRyZW4oKS5maXJzdCgpLmhlaWdodCgpCiAgICAgICAgICAsIGJhcj0kKCcuenUtZ2xvYmFsLW5vdGlmeS56dS1nbG9iYWwtbm90aWZ5LWluZm86dmlzaWJsZScpCiAgICAgICAgICAsIGJhckhlaWdodD0hYmFyLmxlbmd0aD8wOmJhci5vdXRlckhlaWdodCgpCiAgICAgICAgICAsIGJhc2VUb3A9KChiYXJIZWlnaHQmJmJhci5jc3MoJ3Bvc2l0aW9uJyk9PSdmaXhlZCcpP2JhckhlaWdodDooc2Nyb2xsVG9wPmJhckhlaWdodD8wOmJhckhlaWdodC1zY3JvbGxUb3ApKStuYXZIZWlnaHQKICAgICAgICAgICwgbWluSGVpZ2h0PTExMgogICAgICAgICAgLCBtYXhIZWlnaHQ9d2luSGVpZ2h0LWJhc2VUb3AtMzUKICAgICAgICAgICwgdG9vU21hbGw9bWF4SGVpZ2h0PG1pbkhlaWdodAogICAgICAgICAgLCAkbWV0YT0kY20uY2xvc2VzdCgnLnptLWl0ZW0tbWV0YScpCiAgICAgICAgICAsIG1ldGFIZWlnaHQ9MiokbWV0YS5oZWlnaHQoKS0kbWV0YS5pbm5lckhlaWdodCgpCiAgICAgICAgICAsIG9mZnNldFRvcD1zY3JvbGxUb3AtJG1ldGEub2Zmc2V0KCkudG9wCiAgICAgICAgICAsIG9mZnNldEJvdHRvbT0tb2Zmc2V0VG9wLXdpbkhlaWdodAogICAgICAgIDtpZih0b29TbWFsbCltYXhIZWlnaHQ9bWluSGVpZ2h0OwogICAgICAgIGlmKCF0aHx8aXNOYU4odGgpKXsKICAgICAgICAgICAgdmFyICR0PSRjbS5jbG9uZSgpLmNzcyh7J3Bvc2l0aW9uJzonYWJzb2x1dGUnLCd6LWluZGV4JzonLTEnfSkuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkuc2hvdygpCiAgICAgICAgICAgICAgLCAkbD0kdC5jaGlsZHJlbignLnptLWNvbW1lbnQtbGlzdCcpCiAgICAgICAgICAgIDsKICAgICAgICAgICAgaWYoISRjbS5pcygnLmVtcHR5JykmJiRsLmNoaWxkcmVuKCkubGVuZ3RoPjApJGwuY3NzKHsncG9zaXRpb24nOidhYnNvbHV0ZScsJ2hlaWdodCc6JycsJ3RvcCc6JycsJ2JvdHRvbSc6Jyd9KTsKICAgICAgICAgICAgdGg9JGwuaGVpZ2h0KCk7CiAgICAgICAgICAgIHRoKz10aD09MD9taW5IZWlnaHQ6MTAwOwogICAgICAgICAgICAkdC5yZW1vdmUoKTskdD1udWxsOy8vY29uc29sZS5sb2codGgpOwogICAgICAgICAgICAkY20uY3NzKCdoZWlnaHQnLHRoPD1taW5IZWlnaHQ/bWluSGVpZ2h0Oih0aDxtYXhIZWlnaHQ/dGgtMTAwOm1heEhlaWdodC04MCkpOwogICAgICAgIH0KICAgICAgICB2YXIgdGFyZ2V0PXt9LG90aGVyPXsnaGVpZ2h0JzonJ307CiAgICAgICAgJGNtLmF0dHIoJ2l6aF9jbUhlaWdodCcsdGgpLmNzcyh7J2Rpc3BsYXknOicnLCd2aXNpYmlsaXR5JzondmlzaWJsZScsJ3Bvc2l0aW9uJzonYWJzb2x1dGUnfSk7CiAgICAgICAgaWYodGg8PW1heEhlaWdodCl7CiAgICAgICAgICAgIHZhciB0b3A9LW9mZnNldFRvcC03MCxmaXhIZWlnaHQ9KHRoPD1taW5IZWlnaHQ/LTE6Nyk7CiAgICAgICAgICAgIGlmKCF0b29TbWFsbCYmdG9wK3RoPndpbkhlaWdodCl7CiAgICAgICAgICAgICAgICB0YXJnZXQ9eyd0b3AnOi1vZmZzZXRCb3R0b20tdGgtbWV0YUhlaWdodCtmaXhIZWlnaHQsJ2JvdHRvbSc6b2Zmc2V0Qm90dG9tfTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICBvZmZzZXRUb3ArPSgoIXRvb1NtYWxsKSYmdG9wPmJhc2VUb3A/dG9wOmJhc2VUb3ApOwogICAgICAgICAgICAgICAgdGFyZ2V0PXsndG9wJzpvZmZzZXRUb3AsJ2JvdHRvbSc6LW9mZnNldFRvcC10aC1tZXRhSGVpZ2h0K2ZpeEhlaWdodH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGNtLmZpbHRlcignLmVtcHR5JykuZmluZCgnLnptLWNvbW1lbnQtZm9ybSAuem0tY29tbWVudC1lZGl0YWJsZScpLmNzcyh7J2JvdHRvbSc6Jyd9KTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgdGFyZ2V0PXsndG9wJzpvZmZzZXRUb3ArYmFzZVRvcCwnYm90dG9tJzpvZmZzZXRCb3R0b219OwogICAgICAgICAgICAkY20uZmlsdGVyKCcuZW1wdHknKS5maW5kKCcuem0tY29tbWVudC1mb3JtIC56bS1jb21tZW50LWVkaXRhYmxlJykuY3NzKHsnYm90dG9tJzonMjBweCd9KTsKICAgICAgICB9CiAgICAgICAgaWYoYW5pbWF0ZSl7CiAgICAgICAgICAgICRjbS5hbmltYXRlKHRhcmdldCxmdW5jdGlvbigpeyRjbS5jc3Mob3RoZXIpO30pOwogICAgICAgIH1lbHNlewogICAgICAgICAgICAkY20uY3NzKCQuZXh0ZW5kKHRhcmdldCxvdGhlcikpOwogICAgICAgIH0KICAgICAgICAkY207CiAgICB9OwogICAgdGhpcy5vcGVuID0gZnVuY3Rpb24oJGFjLCRjbSxpY21Gb2N1cyl7Ly8gaWYgJGFjIGlzIG51bGwsIGp1c3QgcmUtc2l6aW5nIGFuZCByZS1sb2NhdGluZyBjb21tZW50LWJveAogICAgICAgIHZhciBub0NvbW1lbnRPcGVuaW5nID0gaVpoaWh1LkNvbW1lbnQuT3BlbmluZyA9PSBudWxsOwogICAgICAgIGlaaGlodS5Db21tZW50Lk9wZW5pbmcgPSAkY20uYXR0cignaXpoLW9wZW5pbmcnLCcxJykuY3NzKHsnZGlzcGxheSc6J25vbmUnfSkuZ2V0KDApOwogICAgICAgICQoJy56bS1jb21tZW50LWJveDp2aXNpYmxlOm5vdChbaXpoLW9wZW5pbmc9MV0pJykKICAgICAgICAgICAgLmVhY2goZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgICAgICQoZSkuY3NzKCd2aXNpYmlsaXR5JywnaGlkZGVuJykuY2xvc2VzdCgnLnptLWl0ZW0tbWV0YScpLmZpbmQoJy50b2dnbGUtY29tbWVudCcpWzBdLmNsaWNrKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIHZhciB3aW5XaWR0aD1pWmhpaHUuJHdpbi53aWR0aCgpCiAgICAgICAgICAsIG1jTGVmdD1pWmhpaHUuJG1haW4ub2Zmc2V0KCkubGVmdAogICAgICAgICAgLCAkY3Q9JGNtLmNsb3Nlc3QoJy56dS1tYWluLWNvbnRlbnQtaW5uZXInKQogICAgICAgICAgLCBjdE1hcmdpbkw9cGFyc2VJbnQoJGN0LmNzcygnbWFyZ2luLWxlZnQnKSkKICAgICAgICAgICwgY3RXaWR0aD0kY3Qud2lkdGgoKStjdE1hcmdpbkwKICAgICAgICAgICwgY3RMZWZ0PSRjdC5vZmZzZXQoKS5sZWZ0LWN0TWFyZ2luTAogICAgICAgICAgLCAkbWV0YT0kY20uY2xvc2VzdCgnLnptLWl0ZW0tbWV0YScpCiAgICAgICAgICAsIG10V2lkdGg9JG1ldGEuaW5uZXJXaWR0aCgpCiAgICAgICAgICAsIG1pbldpZHRoPWlaaGlodS4kbWFpbi53aWR0aCgpLWN0V2lkdGgKICAgICAgICAgICwgY21XaWR0aD1tdFdpZHRoCiAgICAgICAgICAsIG1heFdpZHRoPXdpbldpZHRoLWN0V2lkdGgKICAgICAgICAgICwgbz1mdW5jdGlvbigpewogICAgICAgICAgICAgICAgJGNtLmF0dHIoJ29wZW5lZCcsJzEnKTsKICAgICAgICAJCWlmKCEkYWMpewogICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50LmJveCgkY20pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAJCX0KICAgICAgICAgICAgICAgIHZhciBjdXJyVG9wPV9kb2MuYm9keS5zY3JvbGxUb3AKICAgICAgICAgICAgICAgICAgLCAkbj0kYWMubmV4dCgpLCRuPSRuLmxlbmd0aD8kbjokYWMucGFyZW50KCkubmV4dCgpCiAgICAgICAgICAgICAgICAgICwgdD0kYWMub2Zmc2V0KCkudG9wLWlaaGlodS4kbWFpbi5vZmZzZXQoKS50b3AKICAgICAgICAgICAgICAgICAgLCBiPSRhYy5vZmZzZXQoKS50b3AtaVpoaWh1LiRtYWluLm9mZnNldCgpLnRvcAogICAgICAgICAgICAgICAgICAsIHc9JGFjLndpZHRoKCkKICAgICAgICAgICAgICAgICAgLCBpbkFuc3dlcj0kYWMuaXMoJy56bS1pdGVtLWFuc3dlcicpCiAgICAgICAgICAgICAgICAgICwgaW5RdWVzdGlvbj0kYWMuaXMoJyN6aC1xdWVzdGlvbi1kZXRhaWwnKQogICAgICAgICAgICAgICAgICAsICRxdWVzdGlvbk1ldGE9JCgnI3poLXF1ZXN0aW9uLW1ldGEtd3JhcCcpLy9xdWVzdGlvbl9tZXRhCiAgICAgICAgICAgICAgICAgICwgaD1pblF1ZXN0aW9uPyRxdWVzdGlvbk1ldGEub2Zmc2V0KCkudG9wKyRxdWVzdGlvbk1ldGEuaGVpZ2h0KCkrcGFyc2VJbnQoJHF1ZXN0aW9uTWV0YS5jc3MoJ3BhZGRpbmctYm90dG9tJykpLWlaaGlodS4kbWFpbi5vZmZzZXQoKS50b3AKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDokYWMuaGVpZ2h0KCkrcGFyc2VJbnQoJGFjLmNzcygncGFkZGluZy1ib3R0b20nKSkrcGFyc2VJbnQoJG4uY3NzKCdwYWRkaW5nLXRvcCcpKQogICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgaWYoISRhYy5maW5kKCcuaXpoX3RhcGVfYSwuaXpoX3RhcGVfYicpLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAkYWMKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8ZGl2PicsIHsgJ2NsYXNzJzogJ2l6aF90YXBlX2EnIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXY+JywgeyAnY2xhc3MnOiAnaXpoX3RhcGVfYicgfSkpCiAgICAgICAgICAgICAgICBpZighJGNtKSRjbT0kYWMuZmluZCgnLnptLWNvbW1lbnQtYm94Jyk7CiAgICAgICAgICAgICAgICBpZigkY20ubGVuZ3RoKXsKICAgICAgICAgICAgICAgICAgICBpZighJGNtLmF0dHIoJ3RhYmluZGV4JykpewogICAgICAgICAgICAgICAgICAgICAgICAkY20uYXR0cigndGFiaW5kZXgnLCctMScpLmZvY3VzKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKGluUXVlc3Rpb24pewogICAgICAgICAgICAgICAgICAgICAgICAkKCcjaXpoX1F1ZXN0aW9uU2hhZG93JykuY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoZWlnaHQnOmgKICAgICAgICAgICAgICAgICAgICAgICAgICAsICdtYXJnaW4tYm90dG9tJzotaAogICAgICAgICAgICAgICAgICAgICAgICB9KS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVzdGlvbk1ldGEubmV4dCgnOnZpc2libGUnKS5hbmRTZWxmKCkuYWRkQ2xhc3MoJ2l6aF9ub0JvcmRlcicpOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAkYWMuYWRkQ2xhc3MoJ2l6aF9ib3hTaGFkb3cnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJGFjLmZpbmQoJy5pemhfdGFwZV9hJykuY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzonYWJzb2x1dGUnCiAgICAgICAgICAgICAgICAgICAgICAsICd3aWR0aCc6MQogICAgICAgICAgICAgICAgICAgICAgLCAnaGVpZ2h0JzpoCiAgICAgICAgICAgICAgICAgICAgICAsICd0b3AnOjAKICAgICAgICAgICAgICAgICAgICAgICwgJ21hcmdpbi1sZWZ0Jzp3LTEKICAgICAgICAgICAgICAgICAgICAgICwgJ3otaW5kZXgnOicxMDAwMCcKICAgICAgICAgICAgICAgICAgICAgICwgJ2JhY2tncm91bmQtY29sb3InOicjZmZmJwogICAgICAgICAgICAgICAgICAgIH0pLnNob3coKTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5ib3goCiAgICAgICAgICAgICAgICAgICAgICAgICRjbS5jc3MoeydsZWZ0JzptdFdpZHRoLTF9KS5hdHRyKCdpemhfaW5RdWVzdGlvbicsaW5RdWVzdGlvbj8nMSc6JzAnKS5yZW1vdmVBdHRyKCdpemgtb3BlbmluZycpCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAkKCcubWVudGlvbi1wb3B1cCcpLmF0dHIoJ2RhdGEtYWlkJywkYWMuYXR0cignZGF0YS1haWQnKSk7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAkYWMuZmluZCgnLnp1LXF1ZXN0aW9uLWFuc3dlci1tZXRhLWNvbW1lbnQnKVswXS5jbGljaygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGFjLmZpbmQoJy5pemhfdGFwZV9iJykuY3NzKHsKICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOidhYnNvbHV0ZScKICAgICAgICAgICAgICAgICAgLCAnd2lkdGgnOjEKICAgICAgICAgICAgICAgICAgLCAnaGVpZ2h0JzpoCiAgICAgICAgICAgICAgICAgICwgJ3RvcCc6MAogICAgICAgICAgICAgICAgICAsICdtYXJnaW4tbGVmdCc6dwogICAgICAgICAgICAgICAgICAsICd6LWluZGV4JzonOTk5OCcKICAgICAgICAgICAgICAgICAgLCAnYmFja2dyb3VuZC1jb2xvcic6JyNlZWUnCiAgICAgICAgICAgICAgICB9KS5zaG93KCk7CiAgICAgICAgICAgICAgICAvLyRhYy5jc3MoJ2JvcmRlci1jb2xvcicsJyM5OTk5OTknKTsKICAgICAgICAgICAgICAgIC8vJG4uY3NzKCdib3JkZXItY29sb3InLCcjOTk5OTk5Jyk7CiAgICAgICAgICAgICAgICAkKCcuemgtYmFja3RvdG9wJykuY3NzKCd2aXNpYmlsaXR5JywnaGlkZGVuJyk7CiAgICAgICAgICAgICAgICBpWmhpaHUuJGJvZHkuc2Nyb2xsVG9wKGN1cnJUb3ApOwogICAgICAgICAgICAgICAgaWYoaWNtRm9jdXMpewogICAgICAgICAgICAgICAgICAgIHZhciAkaWNtPSQoaWNtRm9jdXMpLmF0dHIoJ2l6aF9oaWxpZ2h0JywnMScpCiAgICAgICAgICAgICAgICAgICAgICAsICRsaXN0PSRpY20uY2xvc2VzdCgnLnptLWNvbW1lbnQtbGlzdCcpOwogICAgICAgICAgICAgICAgICAgICRsaXN0LnNjcm9sbFRvcChpY21Gb2N1cy5vZmZzZXRUb3AtJGxpc3QuZ2V0KDApLm9mZnNldFRvcCk7CiAgICAgICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuSGlMaWdodEl0ZW09aWNtRm9jdXM7CiAgICAgICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuSGlMaWdodENvbG9yPSdyZ2IoMjU1LDI1NSwxNjApJzsKICAgICAgICAgICAgICAgICAgICAkaWNtLmNsaWNrKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpWmhpaHU9d2luZG93LmlaaGlodTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoaVpoaWh1JiZpWmhpaHUuQ29tbWVudC5IaUxpZ2h0SXRlbSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGlaaGlodS5Db21tZW50LkhpTGlnaHRJdGVtKS5yZW1vdmVBdHRyKCdpemhfaGlsaWdodCcpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgogICAgICAgIGlmKG1heFdpZHRoPjU0OSltYXhXaWR0aD01NDk7CiAgICAgICAgaWYoY21XaWR0aD5tYXhXaWR0aCkKICAgICAgICAgICAgY21XaWR0aD1tYXhXaWR0aDsKICAgICAgICBpZihjbVdpZHRoPG1pbldpZHRoKQogICAgICAgICAgICBjbVdpZHRoPW1pbldpZHRoOwogICAgICAgICRjbS5hZGRDbGFzcygnaXpoX2JveFNoYWRvdycpLmNzcygkLmV4dGVuZChjc3NfY29tbWVudCx7J3dpZHRoJzpjbVdpZHRoLTl9KSk7CiAgICAgICAgLy9pZighJGNtLmlzKCcuZW1wdHknKSkKICAgICAgICAgICAgJGNtLmNzcyh7J3BhZGRpbmcnOicxMDBweCAwcHggMHB4IDdweCd9KTsKICAgICAgICAkKCdpLnptLWNvbW1lbnQtYnViYmxlJywkY20pLmhpZGUoKTsKICAgICAgICBpZihub0NvbW1lbnRPcGVuaW5nKXsKICAgICAgICAgICAgdmFyIGNtV2lkdGhPdmVyPWNtV2lkdGgtd2luV2lkdGgKICAgICAgICAgICAgICAsIHNoaWZ0TGVmdD1jbVdpZHRoT3ZlcitjdFdpZHRoK2N0TGVmdAogICAgICAgICAgICA7CiAgICAgICAgICAgIGlmKHNoaWZ0TGVmdD4wKXsKICAgICAgICAgICAgICAgIGlmKHNoaWZ0TGVmdD5jdExlZnQpe3NoaWZ0TGVmdD1tY0xlZnQ7fQogICAgICAgICAgICAgICAgZWxzZSBpZihjbVdpZHRoT3Zlcj4wKXtzaGlmdExlZnQtPWNtV2lkdGhPdmVyO30KICAgICAgICAgICAgfQogICAgICAgICAgICBpZihzaGlmdExlZnQ8MCl7c2hpZnRMZWZ0PTA7fQogICAgICAgICAgICBpZihzaGlmdExlZnQgJiYgJGFjKXsKICAgICAgICAgICAgICAgICRjdC5jc3Moeydwb3NpdGlvbic6J3JlbGF0aXZlJywnbGVmdCc6MH0pLmFuaW1hdGUoe2xlZnQ6LXNoaWZ0TGVmdH0sbyk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgJGN0LmNzcyh7J3Bvc2l0aW9uJzoncmVsYXRpdmUnLCdsZWZ0Jzotc2hpZnRMZWZ0fSk7CiAgICAgICAgICAgICAgICBvKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgbygpOwogICAgICAgIH0JCiAgICB9OwogICAgdGhpcy5jbG9zZSA9IGZ1bmN0aW9uKCRhYywkY20pewogICAgICAgIGlmKCEkY20pJGNtPSRhYy5maW5kKCcuem0tY29tbWVudC1ib3gnKTsKICAgICAgICB2YXIgJGN0PSRjbS5jbG9zZXN0KCcuenUtbWFpbi1jb250ZW50LWlubmVyJyk7CiAgICAgICAgdmFyIG89ZnVuY3Rpb24oKXsKICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ3Bvc2l0aW9uJywnJyk7CiAgICAgICAgICAgIGlmKCEkYWMpcmV0dXJuOwogICAgICAgICAgICB2YXIgJG49JGFjLm5leHQoKQogICAgICAgICAgICAgICwgJG49JG4ubGVuZ3RoPyRuOiRhYy5wYXJlbnQoKS5uZXh0KCkKICAgICAgICAgICAgICAsIGluUXVlc3Rpb249JGFjLmlzKCcjemgtcXVlc3Rpb24tZGV0YWlsJyk7CiAgICAgICAgICAgIGlmKCEkYWMpe3JldHVybjt9CiAgICAgICAgICAgIGlmKGluUXVlc3Rpb24pewogICAgICAgICAgICAgICAgJCgnI2l6aF9RdWVzdGlvblNoYWRvdycpLmhpZGUoKTsKICAgICAgICAgICAgICAgICQoJyN6aC1xdWVzdGlvbi1tZXRhLXdyYXAnKS5uZXh0KCc6dmlzaWJsZScpLmFuZFNlbGYoKS5yZW1vdmVDbGFzcygnaXpoX25vQm9yZGVyJyk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgJGFjLnJlbW92ZUNsYXNzKCdpemhfYm94U2hhZG93Jyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8kYWMuY3NzKCdib3JkZXItY29sb3InLCcjREREREREJyk7CiAgICAgICAgICAgIC8vJG4uY3NzKCdib3JkZXItY29sb3InLCcjREREREREJyk7CiAgICAgICAgICAgICQoJy5pemhfdGFwZV9hOnZpc2libGUsLml6aF90YXBlX2I6dmlzaWJsZScpLmhpZGUoKTsKICAgICAgICAgICAgJCgnLnpoLWJhY2t0b3RvcCcpLmNzcygndmlzaWJpbGl0eScsJ3Zpc2libGUnKTsKICAgICAgICB9OwoKICAgICAgICBpZihpWmhpaHUuQ29tbWVudC5PcGVuaW5nID09ICRjbS5nZXQoMCkpewogICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5PcGVuaW5nID0gbnVsbDsKICAgICAgICAgICAgJGN0LmFuaW1hdGUoe2xlZnQ6MH0sbyk7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIGlmKCEkYWMpeyRjdC5jc3Moe2xlZnQ6MH0pO30KICAgICAgICAgICAgbygpOwogICAgICAgIH0KICAgICAgICAKICAgIH07CiAgICB0aGlzLnByb2Nlc3NDb21tZW50ID0gZnVuY3Rpb24oJGNtLGZvY3VzTmFtZSl7CiAgICAgICAgdmFyIGxvYWRpbmc9ZmFsc2U7CiAgICAgICAgaWYoJGNtLmlzKCcuem0tY29tbWVudC1zcGlubmVyJykpewogICAgICAgICAgICAkY209JGNtLmNsb3Nlc3QoJy56bS1jb21tZW50LWJveCcpOwogICAgICAgICAgICBsb2FkaW5nPXRydWU7CiAgICAgICAgfQogICAgICAgIGlmKCEkY20uaXMoJy56bS1jb21tZW50LWJveCcpKXJldHVybjsKICAgICAgICB2YXIgJGl0ZW09aVpoaWh1LmdldEl0ZW0oJGNtKTsKICAgICAgICBpZihpWmhpaHUuQ29tbWVudC5SaWdodENvbW1lbnQmJmxvYWRpbmcpewogICAgICAgICAgICB2YXIgY21MZWZ0PSRpdGVtLndpZHRoKCktMTsKICAgICAgICAgICAgJGNtLmNzcyh7J2xlZnQnOmNtTGVmdCwnd2lkdGgnOjIxNiwnei1pbmRleCc6JzEwMDAwJ30pOwogICAgICAgIH0KICAgICAgICBpZigkY20uZmlsdGVyKCcuem0tY29tbWVudC1ib3gnKS5oYXMoJy56bS1jb21tZW50LWxpc3QnKS5sZW5ndGgpewovKiBDb2xsZWN0aW9ucyBmb3IgY29tbWVudAogICAgICAgICAgICAkY20uZmluZCgnLnptLWNvbW1lbnQtZWRpdGFibGUnKS5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgICAgIHZhciAkYz0kKGV2ZW50LnRhcmdldCksJGNtPSRjLmNsb3Nlc3QoJy56bS1jb21tZW50LWJveCcpOwogICAgICAgICAgICAgICAgaWYoJGMuaXMoJ2EubWVtYmVyX21lbnRpb24nKSl7CiAgICAgICAgICAgICAgICAgICAgaWYoJGNtLmNoaWxkcmVuKCcuaXpoX2NvbGxlY3Rpb25zJykubGVuZ3RoPD0wKXsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnPGRpdiBjbGFzcz0iaXpoX2NvbGxlY3Rpb25zIj5sb2FkaW5nLi4uPC9kaXY+JykuYmluZCgnbW91c2VvdmVyJyxmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmJpbmQoJ21vdXNlb3V0JyxmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmFwcGVuZFRvKCRjbSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRjLmJpbmQoJ21vdXNlb3ZlcicsZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRjZT0kKHRoaXMpLmNsb3Nlc3QoJy56bS1jb21tZW50LWVkaXRhYmxlJyksJGNtPSQodGhpcykuY2xvc2VzdCgnLnptLWNvbW1lbnQtYm94Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRjbS5jaGlsZHJlbignLml6aF9jb2xsZWN0aW9ucycpLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYm90dG9tJzokKHRoaXMpLmhlaWdodCgpLSQodGhpcykucG9zaXRpb24oKS50b3AtMQogICAgICAgICAgICAgICAgICAgICAgICAgICwgJ2xlZnQnOiQodGhpcykucG9zaXRpb24oKS5sZWZ0CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnNob3coKTsKICAgICAgICAgICAgICAgICAgICAgICAgJC5wb3N0KCdodHRwOi8vd3d3LnpoaWh1LmNvbScrJCh0aGlzKS5hdHRyKCdocmVmJykrJy9jb2xsZWN0aW9ucycKICAgICAgICAgICAgICAgICAgICAgICAgICAsICQucGFyYW0oe194c3JmOiQoJ2lucHV0W25hbWU9X3hzcmZdJykudmFsKCl9KQogICAgICAgICAgICAgICAgICAgICAgICAgICwgZnVuY3Rpb24ocmVzdWx0LHN0YXR1cyx4aHIpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAkYy5iaW5kKCdtb3VzZW91dCcsZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRjZT0kKHRoaXMpLmNsb3Nlc3QoJy56bS1jb21tZW50LWVkaXRhYmxlJyksJGNtPSQodGhpcykuY2xvc2VzdCgnLnptLWNvbW1lbnQtYm94Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRjbS5jaGlsZHJlbignLml6aF9jb2xsZWN0aW9ucycpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiovCiAgICAgICAgICAgIGlmKGlaaGlodS5Db21tZW50LlJpZ2h0Q29tbWVudCl7CiAgICAgICAgICAgICAgICAkY20uY2xvc2VzdCgnLnptLWl0ZW0tbWV0YScpLmZpbmQoJy50b2dnbGUtY29tbWVudCcpLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgICAgICAgICB2YXIgJG9wZW5lZEJ5PSQodGhpcykKICAgICAgICAgICAgICAgICAgICAgICwgJGFjPSRvcGVuZWRCeS5jbG9zZXN0KCcuem0taXRlbS1tZXRhJykKICAgICAgICAgICAgICAgICAgICAgICwgJGNtPSgkYWMucGFyZW50KCkuaXMoJy56bS1pdGVtLW1ldGEuZmVlZC1tZXRhJyk/JGFjLnBhcmVudCgpOiRhYykuZmluZCgnLnptLWNvbW1lbnQtYm94JykuY3NzKCd2aXNpYmlsaXR5JywnaGlkZGVuJykKICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgaWYoJGNtLmxlbmd0aCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkaXRlbT1pWmhpaHUuZ2V0SXRlbSgkY20pOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkY20uaXMoJzpoaWRkZW4nKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5vcGVuKCRpdGVtLCRjbSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuY2xvc2UoJGl0ZW0sJGNtKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vaWYoJGNtLmlzKCcuZW1wdHknKSkgcmV0dXJuOwogICAgICAgICAgICB2YXIgJGxpc3Q9JGNtLmZpbmQoJy56bS1jb21tZW50LWxpc3QnKTsKICAgICAgICAgICAgJGxpc3QuYmluZCgnRE9NTm9kZUluc2VydGVkJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgIC8vdXRpbHMub2JzZXJ2ZURPTU5vZGVBZGRlZCgkbGlzdFswXSxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgIAkvKmlmKCFldmVudC5hZGRlZE5vZGVzKXJldHVybjsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOb2RlcyAnK2V2ZW50LmFkZGVkTm9kZXMubGVuZ3RoKycgaW5zZXJ0ZWQnKTsKICAgICAgICAgICAgCWZvcih2YXIgaT0wO2k8ZXZlbnQuYWRkZWROb2Rlcy5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgCQl2YXIgJGljbT0kKGV2ZW50LmFkZGVkTm9kZXNbaV0pOwogICAgICAgICAgICAgICAgfSovCiAgICAgICAgICAgICAgICB2YXIgJGljbT0kKGV2ZW50LnRhcmdldCkuZmlsdGVyKCcuem0taXRlbS1jb21tZW50LC56bS1jb21tZW50LWZvcm0nKTsKICAgICAgICAgICAgICAgIGlmKCEkaWNtLmxlbmd0aClyZXR1cm47CiAgICAgICAgICAgICAgICB2YXIgJGxpc3Q9JCh0aGlzKQogICAgICAgICAgICAgICAgICAsICRjbT0kbGlzdC5jbG9zZXN0KCcuem0tY29tbWVudC1ib3g6dmlzaWJsZScpOwogICAgICAgICAgICAgICAgaWYoJGljbS5pcygnLnptLWl0ZW0tY29tbWVudCcpKXsKICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCRpY20pOwogICAgICAgICAgICAgICAgICAgIGlmKGlaaGlodS5RdWlja0Jsb2NrKXsKICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnQWRkaW5nIFF1aWNrQmxvY2snKTsKICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LlF1aWNrQmxvY2suYWRkUXVpY2tCbG9ja0luT25lQ29tbWVudCgkaWNtKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoaVpoaWh1LkNvbW1lbnQuUmlnaHRDb21tZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgJGxpc3QuY3NzKCdoZWlnaHQnLCcxMDAlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRpY20uc2hvdygpLmJpbmQoJ0RPTU5vZGVSZW1vdmVkJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGljbT0kKGV2ZW50LnRhcmdldCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighJGljbS5pcygnLnptLWl0ZW0tY29tbWVudCcpKXJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbGlzdD0kaWNtLmhpZGUoKS5jbG9zZXN0KCcuem0tY29tbWVudC1saXN0JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkY209JGxpc3QuY2xvc2VzdCgnLnptLWNvbW1lbnQtYm94OnZpc2libGUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRjbS5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ1JlZnJlc2hpbmcgY29tbWVudCBsaXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGxpc3QuY2hpbGRyZW4oKS5sZW5ndGg9PTEpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuaXpoLXF1aWNrLWJsb2NrLXN3aXRjaCcsJGNtKS5hZGQoJy5pemgtYnV0dG9ucy1jbS1SJywkY20pLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuYm94KCRjbSxmYWxzZSxmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRjbS5sZW5ndGgpewogICAgICAgICAgICAJICAgICAgICAgICAgdmFyIGNvdW50Tm93PSRsaXN0LmNoaWxkcmVuKCkubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIAkgICwgY291bnRBbGw9cGFyc2VJbnQoJGNtLmF0dHIoJ2RhdGEtY291bnQnKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBjb3VudFJlc3Q9Y291bnRBbGwtY291bnROb3cKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBub3RBbGw9JCh0aGlzKS5oYXMoJy5sb2FkLW1vcmUnKS5sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgCTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCghbm90QWxsKSYmY291bnRSZXN0PjEpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgCXJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ1JlZnJlc2hpbmcgY29tbWVudCBsaXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuaXpoLXF1aWNrLWJsb2NrLXN3aXRjaCcsJGNtKS5hZGQoJy5pemgtYnV0dG9ucy1jbS1SJywkY20pLnNob3coKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50LmJveCgkY20sZmFsc2UsZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobm90QWxsfHxjb3VudFJlc3Q8MCkkbGlzdC5zY3JvbGxUb3AoJGljbS5nZXQoMCkub2Zmc2V0VG9wKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1lbHNlIGlmKCRpY20uaXMoJy56bS1jb21tZW50LWZvcm0nKSl7CiAgICAgICAgICAgICAgICAgICAgaWYoaVpoaWh1LkNvbW1lbnQuUmlnaHRDb21tZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGNtLmxlbmd0aCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHJjbT0kaWNtOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGljbT0kcmNtLmNsb3Nlc3QoJy56bS1pdGVtLWNvbW1lbnQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyY20uZmluZCgnYS56bS1jb21tZW50LWNsb3NlLnptLWNvbW1hbmQtY2FuY2VsJykuY2xpY2soZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkcmNtPSQodGhpcykuY2xvc2VzdCgnLnptLWNvbW1lbnQtZm9ybScpLmhpZGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkY209JHJjbS5jbG9zZXN0KCcuem0tY29tbWVudC1ib3g6dmlzaWJsZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRjbS5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5ib3goJGNtLGZhbHNlLGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyY20ucGFyZW50KCkuZmluZCgnYS5yZXBseS56bS1jb21tZW50LW9wLWxpbmsnKS5jbGljayhmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRyY209JCh0aGlzKS5jbG9zZXN0KCcuem0tY29tbWVudC1jb250ZW50LXdyYXAnKS5jaGlsZHJlbignLnptLWNvbW1lbnQtZm9ybScpLnRvZ2dsZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRpY209JCh0aGlzKS5jbG9zZXN0KCcuem0taXRlbS1jb21tZW50JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGxpc3Q9JGljbS5jbG9zZXN0KCcuem0tY29tbWVudC1saXN0JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGNtPSRsaXN0LmNsb3Nlc3QoJy56bS1jb21tZW50LWJveDp2aXNpYmxlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGNtLmxlbmd0aCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50LmJveCgkY20sZmFsc2UsZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkcmNtLmlzKCc6dmlzaWJsZScpKSRsaXN0LnNjcm9sbFRvcCgkaWNtLmdldCgwKS5vZmZzZXRUb3AtJGxpc3QuZ2V0KDApLm9mZnNldFRvcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyY20udG9nZ2xlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5ib3goJGNtLGZhbHNlLGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsaXN0LnNjcm9sbFRvcCgkaWNtLmdldCgwKS5vZmZzZXRUb3AtJGxpc3QuZ2V0KDApLm9mZnNldFRvcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB2YXIgY21DbG9zZT1mdW5jdGlvbihldmVudCxhbHNvU2Nyb2xsVG9WaWV3Qm90dG9tKXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGNtPSQodGhpcykuY2xvc2VzdCgnLnptLWNvbW1lbnQtYm94Jyk7CiAgICAgICAgICAgICAgICAJCWlmKCQodGhpcykuaXMoJ1tuYW1lPWNsb3NlZm9ybV0nKSYmKCEkY20uaXMoJy5lbXB0eScpKSlyZXR1cm47CiAgICAgICAgICAgICAgICAgICAgdmFyICRpdGVtPWlaaGlodS5nZXRJdGVtKCRjbSkvLy5hdHRyKCd0YWJpbmRleCcsJy0xJykuZm9jdXMoKS5yZW1vdmVBdHRyKCd0YWJpbmRleCcpCiAgICAgICAgICAgICAgICAgICAgICAsICRpdGVtTWV0YT0kY20uY2xvc2VzdCgnLnptLWl0ZW0tbWV0YScpCiAgICAgICAgICAgICAgICAgICAgICAsIGFsc29TY3JvbGw9dGhpcy5nZXRBdHRyaWJ1dGUoJ2l6aC1hbHNvU2Nyb2xsVG9WaWV3Qm90dG9tJyl8fCcnCiAgICAgICAgICAgICAgICAgICAgICAsIHNjcm9sbFRvcD0oZG9jdW1lbnQuYm9keS5zY3JvbGxUb3ApP2RvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AKICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgaWYoYWxzb1Njcm9sbCE9PScxJyl7CiAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtTWV0YS5maW5kKCcudG9nZ2xlLWNvbW1lbnQnKVswXS5jbGljaygpOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcD1zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wPXNjcm9sbFRvcDsKICAgICAgICAgICAgICAgICAgICAgICAgfSwxMDApOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50Lm1ldGFTY3JvbGxUb1ZpZXdCb3R0b20oJGl0ZW1NZXRhLGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtTWV0YS5maW5kKCcudG9nZ2xlLWNvbW1lbnQnKVswXS5jbGljaygpOwogICAgICAgICAgICAgICAgICAgIH0sZmFsc2UsdHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLCAkYnRuQ0M9JCgnPGE+Jyx7CiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzonenUtcXVlc3Rpb24tYW5zd2VyLW1ldGEtY29tbWVudCBpemgtYnV0dG9uLWNjJwogICAgICAgICAgICAgICAgICAsIGhyZWY6J2phdmFzY3JpcHQ6dm9pZCgwKTsnCiAgICAgICAgICAgICAgICAgICwgY2xpY2s6Y21DbG9zZQogICAgICAgICAgICAgICAgICAsICdkYXRhLXRpcCc6J3MkdCTmlLbotbfor4Torrrlubbot7Povazoh7PmiYDlsZ7lm57nrZQnCiAgICAgICAgICAgICAgICB9KS50ZXh0KCfmlLbotbcnKQogICAgICAgICAgICAgICwgJGJ1dHRvbnNMPSQoJzxkaXY+Jyx7CiAgICAgICAgICAgICAgICAJJ2NsYXNzJzonaXpoLWJ1dHRvbnMtY20tTCcKICAgICAgICAgICAgICAgIH0pLnByZXBlbmRUbygkY20pCiAgICAgICAgICAgICAgLCAkYnV0dG9uc1I9JCgnPGRpdj4nLHsKICAgICAgICAgICAgICAgIAknY2xhc3MnOidpemgtYnV0dG9ucy1jbS1SJwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgOwogICAgICAgICAgICBpZihpWmhpaHUuQ29tbWVudC5SaWdodENvbW1lbnQpewogICAgICAgICAgICAgICAgJGNtLmNoaWxkcmVuKCcuem0tY29tbWVudC1mb3JtJykuZmluZCgnW25hbWU9Y2xvc2Vmb3JtXScpLmNsaWNrKGNtQ2xvc2UpOwogICAgICAgICAgICAgICAgJGJ0bkNDLmNsb25lKHRydWUpLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtaW1hZ2UnOiAndXJsKCIvc3RhdGljL2ltZy9zcHJpdGVzLTEuOS4yLnBuZyIpJwogICAgICAgICAgICAgICAgICAsICdiYWNrZ3JvdW5kLXBvc2l0aW9uJzogJy0yNjFweCAtNjJweCcKICAgICAgICAgICAgICAgICAgLCAnYmFja2dyb3VuZC1yZXBlYXQnOiAnbm8tcmVwZWF0JwogICAgICAgICAgICAgICAgICAsICdkaXNwbGF5JzogJ2lubGluZS1ibG9jaycKICAgICAgICAgICAgICAgICAgLCAnd2lkdGgnOiAxNQogICAgICAgICAgICAgICAgICAsICdoZWlnaHQnOiAxNQogICAgICAgICAgICAgICAgICAsICdwb3NpdGlvbic6ICdhYnNvbHV0ZScKICAgICAgICAgICAgICAgICAgLCAnbGVmdCc6IDAKICAgICAgICAgICAgICAgICAgLCAndG9wJzogMAogICAgICAgICAgICAgICAgICAsICd6LWluZGV4JzogJzEwMDAwJwogICAgICAgICAgICAgICAgfSkuYXR0cignZGF0YS10aXAnLCdzJGwk5pS26LW36K+E6K66JykudGV4dCgnJykucHJlcGVuZFRvKCRjbSkKICAgICAgICAgICAgICAgICRidXR0b25zUi5wcmVwZW5kVG8oJGNtKTsKICAgICAgICAgICAgICAgIGlmKCRsaXN0LmNoaWxkcmVuKCkubGVuZ3RoPT0wKXsKICAgICAgICAgICAgICAgICAgICAkYnV0dG9uc1IuaGlkZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGJ0bkNDLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgJ2Zsb2F0JzonbGVmdCcKICAgICAgICAgICAgICAgICAgLCAnbWFyZ2luLWxlZnQnOjcKICAgICAgICAgICAgICAgIH0pLmF0dHIoJ2l6aC1hbHNvU2Nyb2xsVG9WaWV3Qm90dG9tJywnMScpLnByZXBlbmQoJzxpIGNsYXNzPSJ6LWljb24taXpoLWZvbGQiLz4nKS5wcmVwZW5kVG8oJGJ1dHRvbnNMKTsKICAgICAgICAgICAgICAgICQoJzxhPicsewogICAgICAgICAgICAgICAgICAgICdjbGFzcyc6J2l6aC1idXR0b24gaXpoLWJhY2stdG9wJwogICAgICAgICAgICAgICAgICAsICdkYXRhLXRpcCc6J3MkbCTov5Tlm57pobbpg6gnCiAgICAgICAgICAgICAgICAgICwgaHJlZjonamF2YXNjcmlwdDp2b2lkKDApOycKICAgICAgICAgICAgICAgICAgLCBjbGljazpmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMucGFyZW50Tm9kZSkubmV4dEFsbCgnLnptLWNvbW1lbnQtbGlzdCcpLnNjcm9sbFRvcCgwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgJCgnPGk+JywgeyAnY2xhc3MnOiAnemctaWNvbiB6LWljb24tZm9sZCcgfSkKICAgICAgICAgICAgICAgICkuYWRkKAogICAgICAgICAgICAgICAgICAgICQoJzxhPicsewogICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOidpemgtYnV0dG9uIGl6aC1zaG93LWdvb2QnCiAgICAgICAgICAgICAgICAgICAgICAsICdkYXRhLXRpcCc6J3MkbCTkurrmsJTlppnor4QnCiAgICAgICAgICAgICAgICAgICAgICAsIGhyZWY6J2phdmFzY3JpcHQ6dm9pZCgwKTsnCiAgICAgICAgICAgICAgICAgICAgICAsIGNsaWNrOmZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZT0kKHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkYz0kZS5jbG9zZXN0KCcuem0tY29tbWVudC1ib3gnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGw9JGMuZmluZCgnLnptLWNvbW1lbnQtbGlzdCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkbj0kbC5maW5kKCcuem0taXRlbS1jb21tZW50JykuaGFzKCdzcGFuLmxpa2UtbnVtLm5pbCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGUuaGFzQ2xhc3MoJ29uJykpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGUuYXR0cignc2Nyb2xsVG9wX3Nob3dnb29kJywkbFswXS5zY3JvbGxUb3ApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG4uc2hvdygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuYm94KCRjLGZhbHNlLGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlLnJlbW92ZUNsYXNzKCdvbicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9IHBhcnNlSW50KCRlLmF0dHIoJ3Njcm9sbFRvcCcpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFpc05hTihzY3JvbGxUb3ApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsLnNjcm9sbFRvcChzY3JvbGxUb3ApOwogICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlLmF0dHIoJ3Njcm9sbFRvcCcsJGxbMF0uc2Nyb2xsVG9wKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRuLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50LmJveCgkYyxmYWxzZSxmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZS5hZGRDbGFzcygnb24nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBwYXJzZUludCgkZS5hdHRyKCdzY3JvbGxUb3Bfc2hvd2dvb2QnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighaXNOYU4oc2Nyb2xsVG9wKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbC5zY3JvbGxUb3Aoc2Nyb2xsVG9wKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICAkKCc8aT4nLCB7ICdjbGFzcyc6ICd6Zy1pY29uIHpnLWljb24tY29tbWVudC1saWtlJyB9KQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICkuY3NzKHsKICAgICAgICAgICAgICAgICAgICAnZmxvYXQnOidyaWdodCcKICAgICAgICAgICAgICAgIH0pLmFwcGVuZFRvKCRidXR0b25zUik7CgogICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuUGFnZU5vdFNjcm9sbCA9IHRydWU7CiAgICAgICAgICAgICAgICAkbGlzdC5zY3JvbGwoZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGU9JCh0aGlzKQogICAgICAgICAgICAgICAgICAgICAgLCAkYj0kZS5jbG9zZXN0KCcuem0tY29tbWVudC1ib3gnKS5maW5kKCcuaXpoLWJhY2stdG9wJykKICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgaWYoJGUuaGVpZ2h0KCkgPCB0aGlzLnNjcm9sbFRvcCl7CiAgICAgICAgICAgICAgICAgICAgICAgICRiLnJlbW92ZUNsYXNzKCdvZmYnKTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgJGIuYWRkQ2xhc3MoJ29mZicpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLnNjcm9sbCgpOwogICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuUGFnZU5vdFNjcm9sbCA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIHZhciBpY21Gb2N1cz1udWxsOwogICAgICAgICAgICAgICAgICAgICRsaXN0LmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICdoZWlnaHQnOiRjbS5pcygnLmVtcHR5Jyk/Jyc6JzEwMCUnCiAgICAgICAgICAgICAgICAgICAgICAsICdvdmVyZmxvdyc6J2F1dG8nCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAkbGlzdC5jaGlsZHJlbignLnptLWl0ZW0tY29tbWVudCcpLmVhY2goZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGljbT0kKGUpOwogICAgICAgICAgICAgICAgICAgICRpY20uYmluZCgnRE9NTm9kZVJlbW92ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRpY209JChldmVudC50YXJnZXQpOwogICAgICAgICAgICAgICAgICAgICAgICBpZighJGljbS5pcygnLnptLWl0ZW0tY29tbWVudCcpKXJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRjbT0kaWNtLmhpZGUoKS5jbG9zZXN0KCcuem0tY29tbWVudC1ib3g6dmlzaWJsZScpOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkY20ubGVuZ3RoKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCQodGhpcykuY2xvc2VzdCgnLnptLWNvbW1lbnQtbGlzdCcpLmNoaWxkcmVuKCkubGVuZ3RoPT0xKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcuaXpoLXF1aWNrLWJsb2NrLXN3aXRjaCcsJGNtKS5hZGQoJy5pemgtYnV0dG9ucy1jbS1SJywkY20pLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlaaGlodS5Db21tZW50LmJveCgkY20sZmFsc2UsZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgJGljbS5maW5kKCdzcGFuLmxpa2UtbnVtJykuZWFjaChmdW5jdGlvbihpLGUpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGlwPWUuZ2V0QXR0cmlidXRlKCdkYXRhLXRpcCcpLnJlcGxhY2UoJ3MkciQnLCdzJGwkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRpcCE9JycpZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGlwJyx0aXApOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGlmICghaWNtRm9jdXMmJmZvY3VzTmFtZSYmZm9jdXNOYW1lIT0nJwogICAgICAgICAgICAgICAgICAgICAgICAmJiAkaWNtLmNoaWxkcmVuKCdhLnpnLWFuY2hvci1oaWRkZW5bbmFtZT0iJytmb2N1c05hbWUrJyJdJykubGVuZ3RoKXsKICAgICAgICAgICAgICAgICAgICAgICAgaWNtRm9jdXM9JGljbS5nZXQoMCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5vcGVuKCRpdGVtLCRjbSxpY21Gb2N1cyk7CiAgICAgICAgICAgICAgICB1dGlscy5vYnNlcnZlRE9NTm9kZUFkZGVkKCRjbS5jaGlsZHJlbignLnptLWNvbW1lbnQtZm9ybScpLmNoaWxkcmVuKCcuem0tY29tbWVudC1lZGl0YWJsZScpWzBdLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGU9JChldmVudC50YXJnZXQpCiAgICAgICAgICAgICAgICAgICAgICAsICRmPSRlLmNsb3Nlc3QoJy56bS1jb21tZW50LWZvcm0nKQogICAgICAgICAgICAgICAgICAgICAgLCAkbD0kZi5wcmV2KCcuem0tY29tbWVudC1saXN0JykKICAgICAgICAgICAgICAgICAgICAgICwgJGM9JGYuY2xvc2VzdCgnLnptLWNvbW1lbnQtYm94W29wZW5lZD0xXScpCiAgICAgICAgICAgICAgICAgICAgICAsIGNoPSRjLmhlaWdodCgpCiAgICAgICAgICAgICAgICAgICAgICAsIHdpbkhlaWdodD1pWmhpaHUuJHdpbi5oZWlnaHQoKQogICAgICAgICAgICAgICAgICAgICAgLCBzY3JvbGxUb3A9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCtkb2N1bWVudC5ib2R5LnNjcm9sbFRvcAogICAgICAgICAgICAgICAgICAgICAgLCBuYXZIZWlnaHQ9aVpoaWh1LiRib2R5LmNoaWxkcmVuKCkuZmlyc3QoKS5oZWlnaHQoKQogICAgICAgICAgICAgICAgICAgICAgLCBiYXI9JCgnLnp1LWdsb2JhbC1ub3RpZnkuenUtZ2xvYmFsLW5vdGlmeS1pbmZvOnZpc2libGUnKQogICAgICAgICAgICAgICAgICAgICAgLCBiYXJIZWlnaHQ9IWJhci5sZW5ndGg/MDpiYXIub3V0ZXJIZWlnaHQoKQogICAgICAgICAgICAgICAgICAgICAgLCBiYXNlVG9wPSgoYmFySGVpZ2h0JiZiYXIuY3NzKCdwb3NpdGlvbicpPT0nZml4ZWQnKT9iYXJIZWlnaHQ6KHNjcm9sbFRvcD5iYXJIZWlnaHQ/MDpiYXJIZWlnaHQtc2Nyb2xsVG9wKSkrbmF2SGVpZ2h0CiAgICAgICAgICAgICAgICAgICAgICAsIG1pbkhlaWdodD0xMTIKICAgICAgICAgICAgICAgICAgICAgICwgbWF4SGVpZ2h0PXdpbkhlaWdodC1iYXNlVG9wLTM1CiAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgIGlmKCEkYy5sZW5ndGgpcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGlmKCEkYy5pcygnLmVtcHR5JykmJiRsLmNoaWxkcmVuKCkubGVuZ3RoPjApewogICAgICAgICAgICAgICAgICAgICAgICBsaD0kbC5oZWlnaHQoKTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgbGg9MDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyICR0PSRlLmNsb25lKCkuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkKICAgICAgICAgICAgICAgICAgICAJICAgIC5jc3Moeydwb3NpdGlvbic6J2Fic29sdXRlJywnei1pbmRleCc6Jy0xJywnd2lkdGgnOiRlLndpZHRoKCksJ21pbi1oZWlnaHQnOjIyfSkKICAgICAgICAgICAgICAgICAgICAgICwgZWg9JHQuaGVpZ2h0KCkKICAgICAgICAgICAgICAgICAgICAgICwgaD1NYXRoLm1heChlaCxsaCkrKGxoPT0wPzkwOjEwMCkKICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgJHQucmVtb3ZlKCk7JHQ9bnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihpc05hTihjaCl8fGNoIT1oKXsKICAgICAgICAgICAgICAgICAgICAgICAgJGMuYXR0cignaXpoX2NtSGVpZ2h0JyxoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQuYm94KCRjLHRydWUsZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZighJGYuaXMoJy5leHBhbmRlZCcpJiZldmVudC5hZGRlZE5vZGVzLmxlbmd0aCl7CiAgICAgICAgICAgICAgICAgICAgICAgICRmLmNzcyh7J2hlaWdodCc6JycsJ2JvdHRvbSc6Jyd9KTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgZWgrPTMwOwogICAgICAgICAgICAgICAgICAgICAgICAkZi5jc3MobGg9PTB8fGVoPmNoP3snaGVpZ2h0JzonJywnYm90dG9tJzoyNX06eydoZWlnaHQnOmVoLCdib3R0b20nOicnfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgJGJ0bkNDLnByZXBlbmQoJzxpIGNsYXNzPSJ6LWljb24tZm9sZCIvPicpCiAgICAgICAgICAgICAgICAuY3NzKHsKICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOidhYnNvbHV0ZScKICAgICAgICAgICAgICAgICAgLCAnY3Vyc29yJzoncG9pbnRlcicKICAgICAgICAgICAgICAgICAgLCAnbWFyZ2luLWxlZnQnOi0xCiAgICAgICAgICAgICAgICAgICwgJ2xlZnQnOjAKICAgICAgICAgICAgICAgICAgLCAnYmFja2dyb3VuZC1jb2xvcic6JyNmYmZiZmInCiAgICAgICAgICAgICAgICAgICwgJ3BhZGRpbmcnOicycHggNXB4JwogICAgICAgICAgICAgICAgICAsICdib3R0b20nOi0yMgogICAgICAgICAgICAgICAgICAsICdib3JkZXInOicxcHggc29saWQgI2RkZCcKICAgICAgICAgICAgICAgICAgLCAnYm9yZGVyLXJhZGl1cyc6JzRweCcKICAgICAgICAgICAgICAgIH0pLmluc2VydEJlZm9yZSgkY20uZmluZCgnLnptLWNvbW1lbnQtYm94LWZ0JykpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGlaaGlodS5RdWlja0Jsb2NrKXsKICAgICAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLmFkZFF1aWNrQmxvY2tJbkNvbW1lbnRMaXN0KCRidXR0b25zTCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwoKICAgIHJldHVybiB0aGlzOwp9CgovKioKICogQGNsYXNzIE5vdGk3CiAqLwpmdW5jdGlvbiBOb3RpNyhpWmhpaHUpIHsKICAgIGlmICggdHlwZW9mIGlaaGlodSA9PT0gJ3VuZGVmaW5lZCcgfHwgIWlaaGlodSB8fCAhaVpoaWh1LmNvbmZpZ1snTm90aTcnXSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgaVpoaWh1Lk5vdGk3ID0gdGhpczsKICAgIAogICAgdGhpcy4kbm90aTcgPSAkKCcjemgtdG9wLW5hdi1saXZlLW5ldycpOwogICAgdGhpcy4kZnJhbWUgPSAkKCcuem0tbm90aTctZnJhbWUnLHRoaXMuJG5vdGk3KTsKICAgIHRoaXMuJGNvbnRlbnQgPSAkKCcuem0tbm90aTctY29udGVudC1ib2R5Jyx0aGlzLiRub3RpNyk7CiAgICB0aGlzLiRmb290ZXIgPSAkKCcuem0tbm90aTctcG9wdXAtZm9vdGVyJyx0aGlzLiRub3RpNyk7CiAgICB0aGlzLiR0YWIgPSAkKCcuem0tbm90aTctcG9wdXAtdGFiLWNvbnRhaW5lcicsJyN6aC10b3AtbmF2LWxpdmUtbmV3LWlubmVyJyk7CgogICAgdGhpcy5jc3MgPSAKICAgICAgICBbJyN6aC10b3AtbmF2LWxpdmUtbmV3IC56bS1ub3RpNy1wb3B1cC1mb290ZXIgYVt1bnJlYWRvbmx5PSIxIl17Y29sb3I6IzIyNTU5OSAhaW1wb3J0YW50O3RleHQtc2hhZG93OjAgMCAxcHggIzIyNTU5OTt9JwogICAgICAgICwnJ10uam9pbignXG4nKTsKICAgIHRoaXMuZW5oYW5jZSA9IGZ1bmN0aW9uKCl7CiAgICAgICAgaVpoaWh1Lk5vdGk3LiR0YWIuZmluZCgnLnptLW5vdGk3LXBvcHVwLXRhYi1pdGVtJykuZWFjaChmdW5jdGlvbihpLGUpewogICAgICAgICAgICB1dGlscy5vYnNlcnZlRE9NQXR0ck1vZGlmaWVkKGUsZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgdmFyICRlPSQoZXZlbnQudGFyZ2V0KTsKICAgICAgICAgICAgICAgIGlmKCRlLmlzKCcuem0tbm90aTctcG9wdXAtdGFiLWl0ZW0uY3VycmVudCcpKXsKICAgICAgICAgICAgICAgIAl2YXIgY3VycmVudENsYXNzPSRlLmF0dHIoJ2NsYXNzJykKICAgICAgICAgICAgICAgIAkgICwgJGJGaWx0ZXJSZWFkPSQoJy5pemgtZmlsdGVyLXJlYWQnLGlaaGlodS5Ob3RpNy4kZm9vdGVyKTsKICAgICAgICAgICAgICAgIAlpZihjdXJyZW50Q2xhc3MhPSRiRmlsdGVyUmVhZC5hdHRyKCdjdXJyZW50Q2xhc3MnKSl7CiAgICAgICAgICAgICAgICAJICAgICRiRmlsdGVyUmVhZC5hdHRyKHsndW5yZWFkT25seSc6JycsJ2N1cnJlbnRDbGFzcyc6Y3VycmVudENsYXNzfSk7CiAgICAgICAgICAgICAgICAJfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICBpWmhpaHUuTm90aTcuJGZvb3Rlci5hcHBlbmQoCiAgICAgICAgICAgICQoJzxhPicsewogICAgICAgICAgICAgICAgJ2NsYXNzJzonaXpoLWZpbHRlci1yZWFkJwogICAgICAgICAgICAgICwgaHJlZjonamF2YXNjcmlwdDp2b2lkKDApOycKICAgICAgICAgICAgICAsICd1bnJlYWRPbmx5JzonJwogICAgICAgICAgICAgICwgY2xpY2s6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICB2YXIgdW5yZWFkT25seT10aGlzLmdldEF0dHJpYnV0ZSgndW5yZWFkT25seScpPT0nMScKICAgICAgICAgICAgICAgICAgICAgICwgJGNvbnRlbnRWaXNpYmxlPWlaaGlodS5Ob3RpNy4kY29udGVudC5maWx0ZXIoJzp2aXNpYmxlJykKICAgICAgICAgICAgICAgICAgICAgICwgJHNjcm9sbGVyPSRjb250ZW50VmlzaWJsZS5jbG9zZXN0KCcuemgtc2Nyb2xsZXItaW5uZXInKQogICAgICAgICAgICAgICAgICAgICAgLCAkaXRlbXM9JGNvbnRlbnRWaXNpYmxlLmZpbmQoJy56bS1ub3RpNy1jb250ZW50LWl0ZW0nKQogICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICB1bnJlYWRPbmx5PSF1bnJlYWRPbmx5OwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCd1bnJlYWRPbmx5Jyx1bnJlYWRPbmx5PycxJzonJyk7CiAgICAgICAgICAgICAgICAgICAgaWYodW5yZWFkT25seSl7CiAgICAgICAgICAgICAgICAgICAgICAgICRzY3JvbGxlci5hdHRyKCdzY3JvbGxUb3AnLCRzY3JvbGxlclswXS5zY3JvbGxUb3ApOwogICAgICAgICAgICAgICAgICAgICAgICAkaXRlbXMubm90KCcudW5yZWFkJykuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsVG9wID0gcGFyc2VJbnQoJHNjcm9sbGVyLmF0dHIoJ3Njcm9sbFRvcF91bnJlYWQnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFpc05hTihzY3JvbGxUb3ApKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjcm9sbGVyLnNjcm9sbFRvcChzY3JvbGxUb3ApOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAkc2Nyb2xsZXIuYXR0cignc2Nyb2xsVG9wX3VucmVhZCcsJHNjcm9sbGVyWzBdLnNjcm9sbFRvcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtcy5ub3QoJy51bnJlYWQnKS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBwYXJzZUludCgkc2Nyb2xsZXIuYXR0cignc2Nyb2xsVG9wJykpOwogICAgICAgICAgICAgICAgICAgICAgICBpZighaXNOYU4oc2Nyb2xsVG9wKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY3JvbGxlci5zY3JvbGxUb3Aoc2Nyb2xsVG9wKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0pLnRleHQoJ+makOiXj+W3suivuycpCiAgICAgICAgKTsKICAgIH07CgogICAgcmV0dXJuIHRoaXM7Cn0KCi8qKgogKiBAY2xhc3MgUXVpY2tCbG9jawogKi8KZnVuY3Rpb24gUXVpY2tCbG9jayhpWmhpaHUpIHsKICAgIGlmICggdHlwZW9mIGlaaGlodSA9PT0gJ3VuZGVmaW5lZCcgfHwgIWlaaGlodSB8fCAhaVpoaWh1LmNvbmZpZ1snUXVpY2tCbG9jayddKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBpWmhpaHUuUXVpY2tCbG9jayA9IHRoaXM7CiAgICAKLyoKICAgIHZhciBjc3NfUXVpY2tCbG9jayA9IHsKICAgICAgICAgICAgJ2JhY2tncm91bmQtcG9zaXRpb24nOictMTQ2cHggLTIwMnB4JwogICAgICAgICAgLCAnd2lkdGgnOjE2CiAgICAgICAgICAsICdoZWlnaHQnOjE2CiAgICAgIAl9CiAgICA7CiovCiAgICB0aGlzLlBlbmRpbmcgPSB7VXNlcnM6JywnLENvdW50OjB9OwogICAgdGhpcy5CbG9ja2luZyA9IHtVc2VyczonLCcsQ291bnQ6MH07CiAgICB0aGlzLlVuZm9sbG93ZWQgPSB7VXNlcnM6JywnLENvdW50OjB9OwogICAgdGhpcy5SZWZvbGxvd2VkID0ge1VzZXJzOicsJyxDb3VudDowfTsKICAgIHRoaXMuVXNlcnMyQiA9IFtdCiAgICB0aGlzLlVzZXJzMkJCUSA9IFtdCiAgICB0aGlzLmNzcyA9IAogICAgICAgIFsnLml6aF9ibG9ja0NhcnR7YmFja2dyb3VuZC1jb2xvcjojMDc3MUMxO3Bvc2l0aW9uOmZpeGVkO3JpZ2h0OjA7ei1pbmRleDo5O3BhZGRpbmc6MCAzMHB4IDAgNjBweDtib3JkZXI6MXB4IHNvbGlkICMwNzcxQzE7Ym9yZGVyLWxlZnQtd2lkdGg6MTBweDtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjZweDt9JwogICAgICAgICwnLml6aF9ibG9ja0NhcnQgLmRve2NvbG9yOiNmZmY7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTpibG9jazttYXJnaW46MnB4O21pbi13aWR0aDo4MHB4O3dpZHRoOjEwMCU7aGVpZ2h0OjIwcHg7fScKICAgICAgICAsJy5pemhfYmxvY2tDYXJ0LnBlbmRpbmcgLmRvOmFmdGVye3RleHQtZGVjb3JhdGlvbjpibGluaztjb2xvcjpyZWQ7fScKICAgICAgICAsJy5pemhfYmxvY2tDYXJ0IC5kbzphZnRlcntwb3NpdGlvbjpyZWxhdGl2ZTtjb250ZW50OmF0dHIoaXpoX251bTJCKTt9JwogICAgICAgICwnLml6aF9ibG9ja0NhcnQgLmRvIC5idXR0b257Y29sb3I6I2ZmZjt9JwogICAgICAgICwnLml6aF9ibG9ja0NhcnQgLmZyYW1le292ZXJmbG93LXk6YXV0bztvdmVyZmxvdy14OmhpZGRlbjtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MjVweDtib3R0b206MDtsZWZ0OjA7cmlnaHQ6MDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7cGFkZGluZy10b3A6NXB4O30nCiAgICAgICAgLCcuaXpoX2Jsb2NrQ2FydCAubGlzdHtkaXNwbGF5OmJsb2NrO21hcmdpbjoycHg7d2lkdGg6MTAwJTtwYWRkaW5nLXJpZ2h0OjVweDt9JwogICAgICAgICwnLml6aF9ibG9ja0NhcnQgLmxpc3QgLnJlbHtib3JkZXItd2lkdGg6MCAycHg7Ym9yZGVyLXN0eWxlOnNvbGlkO2JvcmRlci1jb2xvcjojZmZmO3dpZHRoOjI0cHg7aGVpZ2h0OjE4cHg7fScKICAgICAgICAsJy5pemhfYmxvY2tDYXJ0IC5saXN0LmlfZm8gLnJlbHtib3JkZXItbGVmdC1jb2xvcjojMjU5O2JhY2tncm91bmQtcG9zaXRpb246LTEyMHB4IC0xODRweDt9JwogICAgICAgICwnLml6aF9ibG9ja0NhcnQgLmxpc3QuZm9faSAucmVse2JvcmRlci1yaWdodC1jb2xvcjojMjU5O2JhY2tncm91bmQtcG9zaXRpb246LTEyMHB4IC0xNjRweDt9JwogICAgICAgICwnLml6aF9ibG9ja0NhcnQgLmxpc3QuaV9mby5mb19pIC5yZWx7YmFja2dyb3VuZC1wb3NpdGlvbjotNzhweCAtMjAwcHg7fScKICAgICAgICAsJy5pemhfYmxvY2tDYXJ0IC51c2VyMkJ7ZGlzcGxheTpibG9jazttYXJnaW46MnB4IDA7cGFkZGluZzowIDQwcHggMCA2MHB4O30nCiAgICAgICAgLCcuaXpoX2Jsb2NrQ2FydCAudXNlcjJCIGkuemctaWNvbntkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjA7bWFyZ2luLXRvcDo1cHg7fScKICAgICAgICAsJy5pemhfYmxvY2tDYXJ0IC51c2VyMkIgLm5hbWV7ZGlzcGxheTpibG9jaztjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6IzAwMDt3aGl0ZS1zcGFjZTpub3dyYXA7cGFkZGluZzoycHggNXB4O2JvcmRlci1yYWRpdXM6M3B4O30nCiAgICAgICAgLCcuaXpoX2Jsb2NrQ2FydCAubGlzdCAudXNlcjJCLnVuZm8gLm5hbWV7YmFja2dyb3VuZC1jb2xvcjojZjAwO30nCiAgICAgICAgLCcuaXpoX2Jsb2NrQ2FydCAudXNlcjJCIC5kZWx7ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTttYXJnaW4tbGVmdDotNC41ZW07fScKICAgICAgICAsJy5pemhfYmxvY2tDYXJ0IC51c2VyMkIgaS5zYXl7ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTttYXJnaW4tbGVmdDotNDRweDtib3JkZXItcmFkaXVzOjZweCA2cHggMCA2cHg7Ym9yZGVyOjFweCBzb2xpZCAjOTk5O3BhZGRpbmc6MCA1cHggMCAzcHg7fScKICAgICAgICAsJy5pemhfYmxvY2tDYXJ0IC51c2VyMkIgaS5zYXlfMXtkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO21hcmdpbi1sZWZ0Oi0xMHB4O2hlaWdodDo2cHg7YmFja2dyb3VuZC1jb2xvcjojZmZmO3dpZHRoOjZweDttYXJnaW4tdG9wOjE3cHg7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgIzk5OTt9JwogICAgICAgICwnLml6aF9ibG9ja0NhcnQgLnVzZXIyQiBpLnNheV8ye2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7bWFyZ2luLWxlZnQ6LTlweDtoZWlnaHQ6NnB4O2JhY2tncm91bmQtY29sb3I6I2ZmZjt3aWR0aDo2cHg7bWFyZ2luLXRvcDoxN3B4O2JvcmRlci1yYWRpdXM6MCAwIDAgNnB4O2JvcmRlcjoxcHggc29saWQgIzk5OTtib3JkZXItd2lkdGg6MCAwIDFweCAxcHh9JwogICAgICAgICwnLml6aC1xdWljay1ibG9ja3twb3NpdGlvbjphYnNvbHV0ZTt0ZXh0LWFsaWduOmNlbnRlcjt3aWR0aDo0ZW07bWFyZ2luLXRvcDoxLjVlbTt3aGl0ZS1zcGFjZTpub3dyYXA7fScKICAgICAgICAsJy5pemgtcXVpY2stYmxvY2sgW2NsYXNzXj1pemgtcXVpY2stYmxvY2tde3Bvc2l0aW9uOmFic29sdXRlO2Rpc3BsYXk6YmxvY2s7d2hpdGUtc3BhY2U6bm93cmFwO30nCiAgICAgICAgLCcuaXpoLXF1aWNrLWJsb2NrOmFmdGVye2NvbnRlbnQ6YXR0cihpemhfbnVtMkIpO21hcmdpbi10b3A6MWVtO2Rpc3BsYXk6YmxvY2s7fScKICAgICAgICAsJy56bS1jb21tZW50LWhkIC5pemgtcXVpY2stYmxvY2stcGVuZHtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7dG9wOjQwcHg7fScKICAgICAgICAsJycKICAgICAgICBdLmpvaW4oJ1xuJyk7CiAgICB0aGlzLnVuYmxvY2tBbGwgPSBmdW5jdGlvbigpewogICAgICAgICQoJy5ibG9ja2VkLXVzZXJzID4gLml0ZW0tY2FyZCcpLmVhY2goZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgdmFyIHVpZD0kKGUpLmF0dHIoJ2RhdGEtaWQnKTsKICAgICAgICAgICAgJC5wb3N0KCcvc2V0dGluZ3MvdW5ibG9ja3VzZXInLCQucGFyYW0oewogICAgICAgICAgICAgICAgX3hzcmY6JCgnaW5wdXRbbmFtZT1feHNyZl0nKS52YWwoKQogICAgICAgICAgICAgICwgdWlkOnVpZAogICAgICAgICAgICB9KSxmdW5jdGlvbihyKXsKICAgICAgICAgICAgCS8vY29uc29sZS5sb2cocik7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoJICB9OwoJICB0aGlzLmRvVW5mb2xsb3cgPSBmdW5jdGlvbigpewogICAgICAgIHZhciAkZSA9IGlaaGlodS5RdWlja0Jsb2NrLlVzZXJzMkJCUS5zaGlmdCgpCiAgICAgICAgaWYodHlwZW9mICRlID09PSAndW5kZWZpbmVkJykgcmV0dXJuCgogICAgICAgIHZhciB1aWQ9JGUuYXR0cigndWlkJyk7CiAgICAgICAgJC5wb3N0KCcvbm9kZS9NZW1iZXJGb2xsb3dCYXNlVjInCiAgICAgICAgICAsICQucGFyYW0oewogICAgICAgICAgICAgICAgbWV0aG9kOid1bmZvbGxvd19tZW1iZXInCiAgICAgICAgICAgICAgLCBwYXJhbXM6SlNPTi5zdHJpbmdpZnkoeydoYXNoX2lkJzp1aWR9KQogICAgICAgICAgICAgICwgX3hzcmY6JCgnaW5wdXRbbmFtZT1feHNyZl0nKS52YWwoKQogICAgICAgICAgICAgIH0pCiAgICAgICAgICAsIGZ1bmN0aW9uKHIpewogICAgICAgICAgICAgICAgICB2YXIgcXVlcnk9ZGVjb2RlVVJJQ29tcG9uZW50KHRoaXMuZGF0YSkKICAgICAgICAgICAgICAgICAgICAsIHBhcmFtcz11dGlscy5nZXRQYXJhbUluUXVlcnkocXVlcnksJ3BhcmFtcycpCiAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgZXZhbCgncGFyYW1zPScrcGFyYW1zKTsKICAgICAgICAgICAgICAgICAgdmFyIGJpZD0nZmItJytwYXJhbXMuaGFzaF9pZAogICAgICAgICAgICAgICAgICAgICwgd2hvPWJpZCsnLCcKICAgICAgICAgICAgICAgICAgICAsIHVuZm9sbG93ZWQ9aVpoaWh1LlF1aWNrQmxvY2suVW5mb2xsb3dlZAogICAgICAgICAgICAgICAgICAgICwgcmVmb2xsb3dlZD1pWmhpaHUuUXVpY2tCbG9jay5SZWZvbGxvd2VkCiAgICAgICAgICAgICAgICAgICAgLCAkY2FydERJVj0kKCcjaXpoX2Jsb2NrQ2FydCcpCiAgICAgICAgICAgICAgICAgICAgLCAkdXNlcj0kY2FydERJVi5maW5kKCcudXNlcjJCW3VpZD0nK3BhcmFtcy5oYXNoX2lkKyddJykKICAgICAgICAgICAgICAgICAgICAsICRsaXN0PSR1c2VyLmNsb3Nlc3QoJy5saXN0JykKICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAkdXNlci5wcmVwZW5kVG8oJGxpc3QubmV4dCgpLm5leHQoKSk7CiAgICAgICAgICAgICAgICAgIGlmKHVuZm9sbG93ZWQuVXNlcnMuaW5kZXhPZignLCcrd2hvKTwwKQogICAgICAgICAgICAgICAgICAgICAgdW5mb2xsb3dlZC5Vc2VycyArPSB3aG87CiAgICAgICAgICAgICAgICAgIGlmKHJlZm9sbG93ZWQuVXNlcnMuaW5kZXhPZignLCcrd2hvKT49MCkKICAgICAgICAgICAgICAgICAgICAgIHJlZm9sbG93ZWQuVXNlcnMgPSByZWZvbGxvd2VkLnJlcGxhY2UoJywnK3dobywnLCcpOwogICAgICAgICAgICB9CiAgICAgICAgKS5hbHdheXMoZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywganFYSFIpewogICAgICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5kb1VuZm9sbG93KCkKICAgICAgICB9KTsKCSAgfTsKICAgIHRoaXMuZG9RdWlja0Jsb2NrID0gZnVuY3Rpb24oKXsKICAgICAgICB2YXIgJGUgPSBpWmhpaHUuUXVpY2tCbG9jay5Vc2VyczJCQlEuc2hpZnQoKQogICAgICAgIGlmKHR5cGVvZiAkZSA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybgoKICAgICAgICB2YXIgYmxvY2tpbmcgPSBpWmhpaHUuUXVpY2tCbG9jay5CbG9ja2luZwogICAgICAgICAgLCBocmVmID0gJGUuYXR0cignaHJlZicpCiAgICAgICAgICAsIHdobyA9IGhyZWYuc3BsaXQoJy8nKS5wb3AoKSsnLCcKICAgICAgICA7CiAgICAgICAgaWYodHlwZW9mIGJsb2NraW5nID09PSAndW5kZWZpbmVkJyB8fCAhYmxvY2tpbmcpewogICAgICAgICAgICBibG9ja2luZyA9IGlaaGlodS5RdWlja0Jsb2NrLkJsb2NraW5nID0geyBVc2VyczonLCcsIENvdW50OjAgfTsKICAgICAgICB9ZWxzZSBpZihibG9ja2luZy5Vc2Vycy5pbmRleE9mKCcsJyt3aG8pID49IDApewogICAgICAgICAgICByZXR1cm47IC8vIEFscmVhZHkgYmxvY2tpbmcKICAgICAgICB9CiAgICAgICAgdmFyICRjYXJ0RElWPSQoJyNpemhfYmxvY2tDYXJ0Jyk7CiAgICAgICAgJGNhcnRESVYuYWRkQ2xhc3MoJ2Jsb2NraW5nJyk7CiAgICAgICAgYmxvY2tpbmcuVXNlcnMgKz0gd2hvOwogICAgICAgIGJsb2NraW5nLkNvdW50ICsrOwogICAgICAgICQucG9zdChocmVmKycvYmxvY2snLCQucGFyYW0oewogICAgICAgICAgICBhY3Rpb246J2FkZCcKICAgICAgICAgICwgX3hzcmY6JCgnaW5wdXRbbmFtZT1feHNyZl0nKS52YWwoKSAKICAgICAgICB9KSxmdW5jdGlvbihyKXsKICAgICAgICAgICAgdmFyIGhyZWY9dGhpcy51cmwucmVwbGFjZSgnL2Jsb2NrJywnJykKICAgICAgICAgICAgICAsIHVzZXJJRD1ocmVmLnNwbGl0KCcvJykucG9wKCkKICAgICAgICAgICAgICAsIHdobz0nLCcrdXNlcklEKycsJwogICAgICAgICAgICAgICwgYmxvY2tpbmc9aVpoaWh1LlF1aWNrQmxvY2suQmxvY2tpbmcKICAgICAgICAgICAgOwoKICAgICAgICAgICAgaWYoMD09LS1ibG9ja2luZy5Db3VudCkkY2FydERJVi5yZW1vdmVDbGFzcygncGVuZGluZycpOwogICAgCiAgICAgICAgICAgIGlmKGJsb2NraW5nLlVzZXJzLmluZGV4T2Yod2hvKSA8IDApCiAgICAgICAgICAgICAgICByZXR1cm47IC8vIE5vIHRoaXMgdXNlciBpbiBwZW5kaW5nCiAgICAgICAgICAgICAgCiAgICAgICAgICAgIGJsb2NraW5nLlVzZXJzID0gYmxvY2tpbmcuVXNlcnMucmVwbGFjZSh3aG8sJywnKTsKICAgICAgICAgICAgJCgnI2l6aF9ibG9ja0NhcnQgLnVzZXIyQltocmVmPSInK2hyZWYrJyJdJykuZmluZCgnLmRlbCcpWzBdLmNsaWNrKCk7CiAgICAgICAgICAgICQoJ2FbaHJlZiQ9IicraHJlZisnIl0nKS5jc3MoJ3RleHQtZGVjb3JhdGlvbicsJ2xpbmUtdGhyb3VnaCcpOwogICAgICAgIH0pLmFsd2F5cyhmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUil7CiAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLmRvUXVpY2tCbG9jaygpCiAgICAgICAgfSk7CiAgCX07CiAgICB0aGlzLnJlc2l6ZUJsb2NrQ2FydCA9IGZ1bmN0aW9uKCRjYXJ0RElWKXsKICAgICAgICBmdW5jdGlvbiBwYXJzZUNzc1B4KCRpdGVtLCBuYW1lKSB7CiAgICAgICAgICAgIHZhciBtID0gJGl0ZW0uY3NzKG5hbWUpOwogICAgICAgICAgICBpZiAobSAhPSAndW5kZWZpbmVkJykgewogICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KG0ucmVwbGFjZSgncHgnLCcnKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHZhciAkdXNlckRJViA9ICRjYXJ0RElWLmZpbmQoJy5saXN0IC51c2VyMkInKTsKICAgICAgICB2YXIgJHRpdGxlQm94ID0gJCgnI2l6aF9ibG9ja0NhcnQgLmRvJyk7CiAgICAgICAgdmFyIGggPSBwYXJzZUNzc1B4KCRjYXJ0RElWLmZpbmQoJ2Rpdi5mcmFtZScpLCdwYWRkaW5nVG9wJykgCiAgICAgICAgICAgICAgICArICgkdXNlckRJVi5oZWlnaHQoKSArIHBhcnNlQ3NzUHgoJHVzZXJESVYsJ21hcmdpblRvcCcpKSAqICR1c2VyRElWLmxlbmd0aCAKICAgICAgICAgICAgICAgICsgJHRpdGxlQm94LmhlaWdodCgpCiAgICAgICAgICAgICAgICArIHBhcnNlQ3NzUHgoJHRpdGxlQm94LCAnbWFyZ2luVG9wJykKICAgICAgICAgICAgICAgICsgcGFyc2VDc3NQeCgkdGl0bGVCb3gsICdtYXJnaW5Cb3R0b20nKTsKICAgICAgICAKICAgICAgICBpZihoK2laaGlodS4kbWFpbi5vZmZzZXQoKS50b3A8aVpoaWh1LiR3aW4uaGVpZ2h0KCkpewogICAgICAgICAgICAkY2FydERJVi5jc3MoeydoZWlnaHQnOmgsJ2JvdHRvbSc6Jyd9KTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgJGNhcnRESVYuY3NzKHsnaGVpZ2h0JzonJywnYm90dG9tJzowfSk7CiAgICAgICAgfQogICAgfTsKICAgIHRoaXMuZ2V0Q2FydERJVj1mdW5jdGlvbigpewogICAgICAgIHZhciAkY2FydERJVj0kKCcjaXpoX2Jsb2NrQ2FydCcpOwogICAgICAgIGlmKCEkY2FydERJVi5sZW5ndGgpewogICAgICAgICAgICAkY2FydERJVj0kKCc8ZGl2PicsIHsgaWQ6ICdpemhfYmxvY2tDYXJ0JywgJ2NsYXNzJzogJ2l6aF9ibG9ja0NhcnQnIH0pLmNzcyh7CiAgICAgICAgICAgICAgICAndG9wJzppWmhpaHUuJG1haW4ub2Zmc2V0KCkudG9wCiAgICAgICAgICAgIH0pLmFwcGVuZCgKICAgICAgICAgICAgICAgICQoJzxkaXY+Jyx7CiAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzonZG8nCiAgICAgICAgICAgICAgICAgICwgJ2l6aF9udW0yQic6MAogICAgICAgICAgICAgICAgICAsICd0aXRsZSc6J+S4i+S4uuOAjOWAmeWuoeOAjeWIl+ihqFxu54K55Ye75bem5LiK6KeS5Y+v5pS26LW3L+WxleW8gFxu5pWw5a2X5Li65Lq654qv5oC75pWw77yI57qi6Imy6KGo56S65LuN5pyJ5Lq654qv5q2j5b6F5YWl5YiX77yJJwogICAgICAgICAgICAgICAgfSkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICQoJzxhPicsewogICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOididXR0b24gZGVsQWxsJwogICAgICAgICAgICAgICAgICAgICAgLCBocmVmOidqYXZhc2NyaXB0OnZvaWQoMCk7JwogICAgICAgICAgICAgICAgICAgICAgLCB0aXRsZTon5riF56m644CM5YCZ5a6h44CN5YiX6KGoJwogICAgICAgICAgICAgICAgICAgICAgLCBjbGljazpmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkY2FydERJVj0kKCcjaXpoX2Jsb2NrQ2FydCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICRjYXJ0RElWLmNzcygnYm90dG9tJywnJykuZmluZCgnLmxpc3QnKS5lbXB0eSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcy5wYXJlbnROb2RlKS5hdHRyKCdpemhfbnVtMkInLCcwJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgJGNhcnRESVYuY3NzKCdoZWlnaHQnLCcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLnRleHQoJ+Wkp+i1picpLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5JzonYmxvY2snCiAgICAgICAgICAgICAgICAgICAgICAsICdwb3NpdGlvbic6J2Fic29sdXRlJwogICAgICAgICAgICAgICAgICAgICAgLCAnbGVmdCc6MjQKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgKS5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgJCgnPGlucHV0PicsewogICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOid1bmZvJwogICAgICAgICAgICAgICAgICAgICAgLCBocmVmOidqYXZhc2NyaXB0OnZvaWQoMCk7JwogICAgICAgICAgICAgICAgICAgICAgLCB0eXBlOidjaGVja2JveCcKICAgICAgICAgICAgICAgICAgICAgICwgdGl0bGU6J+mAieS4reWQju+8jOWwhuaIkeWFs+azqOS5i+S6uuagh+WHuu+8jOaUueS7peaUvumAkO+8iOWPlua2iOWFs+azqO+8ieiuuuWkhCcKICAgICAgICAgICAgICAgICAgICAgICwgY2xpY2s6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGNhcnRESVY9JCh0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJHVzZXJzPSQoJy5mcmFtZSAubGlzdC5pX2ZvIC51c2VyMkInLCRjYXJ0RElWKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkYWN0aW9uPSQoJy5hY3Rpb24nLHRoaXMucGFyZW50Tm9kZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5jaGVja2VkKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJzLmFkZENsYXNzKCd1bmZvJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb24udGV4dCgn5pS+6YCQJykuY3NzKCdwYWRkaW5nJywnMCAyZW0gMCAwJykuYXR0cigndGl0bGUnLCflr7nliJfooajlhoXmiJHlhbPms6jkuYvkurrlj5bmtojlhbPms6gnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJzLnJlbW92ZUNsYXNzKCd1bmZvJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb24udGV4dCgn5pS255uRJykuY3NzKCdwYWRkaW5nJywnMCAwIDAgMmVtJykuYXR0cigndGl0bGUnLCflsIbkuIvliJfkurrniq/pgJDkuIDliqDlhaXpu5HlkI3ljZUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkuY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXknOidibG9jaycKICAgICAgICAgICAgICAgICAgICAgICwgJ2Zsb2F0JzonbGVmdCcKICAgICAgICAgICAgICAgICAgICAgICwgJ2hlaWdodCc6MjIKICAgICAgICAgICAgICAgICAgICAgICwgJ2xpbmUtaGVpZ2h0JzoyMgogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICApLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAkKCc8c3Bhbj4nLHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzonJwogICAgICAgICAgICAgICAgICAgICAgLCBocmVmOidqYXZhc2NyaXB0OnZvaWQoMCk7JwogICAgICAgICAgICAgICAgICAgICAgLCB0aXRsZTon6YCJ5Lit5ZCO77yM5bCG5oiR5YWz5rOo55qE5Lq65qCH5Ye677yM5YeG5aSH44CM5Y+W5raI5YWz5rOo44CNJwogICAgICAgICAgICAgICAgICAgIH0pLnRleHQoJ+S7jui9uycpLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICdkaXNwbGF5JzonYmxvY2snCiAgICAgICAgICAgICAgICAgICAgICAsICdmbG9hdCc6J2xlZnQnCiAgICAgICAgICAgICAgICAgICAgICAsICdtYXJnaW4tcmlnaHQnOjIwCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICQoJzxhPicsewogICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOididXR0b24gYWN0aW9uJwogICAgICAgICAgICAgICAgICAgICAgLCBocmVmOidqYXZhc2NyaXB0OnZvaWQoMCk7JwogICAgICAgICAgICAgICAgICAgICAgLCB0aXRsZTon5bCG5LiL5YiX5Lq654qv6YCQ5LiA5Yqg5YWl6buR5ZCN5Y2VJwogICAgICAgICAgICAgICAgICAgICAgLCBjbGljazpmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRjYXJ0RElWPSQodGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJCgnLnVuZm8nLHRoaXMucGFyZW50Tm9kZSkuaXMoJzpjaGVja2VkJykpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJy5saXN0LmlfZm8gLnVzZXIyQicsJGNhcnRESVYpLmVhY2goZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LlF1aWNrQmxvY2suVXNlcnMyQkJRLnB1c2goJChlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5kb1VuZm9sbG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcubGlzdCAudXNlcjJCJywkY2FydERJVikuZWFjaChmdW5jdGlvbihpLGUpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5Vc2VyczJCQlEucHVzaCgkKGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLmRvUXVpY2tCbG9jaygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkudGV4dCgn5pS255uRJykuY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXknOidibG9jaycKICAgICAgICAgICAgICAgICAgICAgICwgJ2Zsb2F0JzoncmlnaHQnCiAgICAgICAgICAgICAgICAgICAgICAsICdtYXJnaW4tbGVmdCc6MjAKICAgICAgICAgICAgICAgICAgICAgICwgJ21hcmdpbi1yaWdodCc6LTEwCiAgICAgICAgICAgICAgICAgICAgICAsICdwYWRkaW5nJzonMCAwIDAgMmVtJwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICApLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAkKCc8YT4nLHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzonemctaWNvbiB6Zy1pY29uLWRvdWJsZS1hcnJvdycKICAgICAgICAgICAgICAgICAgICAgICwgaHJlZjonamF2YXNjcmlwdDp2b2lkKDApOycKICAgICAgICAgICAgICAgICAgICAgICwgY2xpY2s6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGNhcnRESVY9JCgnI2l6aF9ibG9ja0NhcnQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkY2FydERJVi5hdHRyKCdtaW5pJykhPScxJyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjYXJ0RElWLmZpbmQoJy5mcmFtZScpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNhcnRESVYuY3NzKHsnaGVpZ2h0JzonJywnYm90dG9tJzonJ30pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2FydERJVi5hdHRyKCdtaW5pJywnMScpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2FydERJVi5maW5kKCcuZnJhbWUnKS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLnJlc2l6ZUJsb2NrQ2FydCgkY2FydERJVik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjYXJ0RElWLmF0dHIoJ21pbmknLCcwJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICdwb3NpdGlvbic6J2Fic29sdXRlJwogICAgICAgICAgICAgICAgICAgICAgLCAnbGVmdCc6MAogICAgICAgICAgICAgICAgICAgICAgLCAndG9wJzo1CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgKS5hcHBlbmQoCiAgICAgICAgICAgICAgICAkKCc8ZGl2PicseydjbGFzcyc6J2ZyYW1lJ30KICAgICAgICAgICAgICAgICkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICQoJzxkaXY+Jyx7CiAgICAgICAgICAgICAgICAgICAgICAgICdjbGFzcyc6J2xpc3QgaV9mbyBmb19pJwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICApLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAkKCc8ZGl2PicsewogICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOidsaXN0IGlfZm8nCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICkuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICQoJzxkaXY+Jyx7CiAgICAgICAgICAgICAgICAgICAgICAgICdjbGFzcyc6J2xpc3QgZm9faScKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgKS5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgJCgnPGRpdj4nLHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzonbGlzdCcKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApLmFwcGVuZFRvKGlaaGlodS4kYm9keSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGNhcnRESVYKICAgIH0KICAgIHRoaXMuaW4yQmxvY2tDYXJ0ID0gZnVuY3Rpb24odXJsLHJldHJpZWRDb3VudCl7CiAgICAgICAgdmFyICRlID0gaVpoaWh1LlF1aWNrQmxvY2suVXNlcnMyQi5zaGlmdCgpIHx8IG51bGwKICAgICAgICAgICwgJGNhcnRESVYgPSBpWmhpaHUuUXVpY2tCbG9jay5nZXRDYXJ0RElWKCkKCiAgICAgICAgJGNhcnRESVYuYWRkQ2xhc3MoJ3BlbmRpbmcnKTsKICAgICAgICBpZih0eXBlb2YgcmV0cmllZENvdW50ID09ICd1bmRlZmluZWQnKQogICAgICAgICAgICByZXRyaWVkQ291bnQgPSAwCgogICAgICAgIC8vY29uc29sZS5sb2cocmV0cmllZENvdW50KQogICAgICAgIGlmICghJGUgfHwgJGUubGVuZ3RoID09PSAwKXsKICAgICAgICAgICAgaWYoKHVybHx8JycpPT0nJyl7CiAgICAgICAgICAgICAgICAkY2FydERJVi5yZW1vdmVDbGFzcygncGVuZGluZycpCiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgJC5hamF4KFsnJyx1cmxdLmpvaW4oJycpLHsKICAgICAgICAgICAgICAgICAgICB0eXBlOidHRVQnCiAgICAgICAgICAgICAgICAgICwgbWF4UmV0cnlDb3VudDogMwogICAgICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUil7CiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGRhdGEucGF5bG9hZCxmdW5jdGlvbihpLGUpewogICAgICAgICAgICAgICAgICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5hZGRVc2VyMkIoZSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLmluMkJsb2NrQ2FydChkYXRhLnBhZ2luZy5uZXh0KQogICAgICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbihkYXRhLHRleHRTdGF0dXMsalhIUil7CiAgICAgICAgICAgICAgICAgICAgaWYgKCsrcmV0cmllZENvdW50IDwgdGhpcy5tYXhSZXRyeUNvdW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LlF1aWNrQmxvY2suaW4yQmxvY2tDYXJ0KHVybCxyZXRyaWVkQ291bnQpCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICRjYXJ0RElWLnJlbW92ZUNsYXNzKCdwZW5kaW5nJykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybgogICAgICAgIH0KCiAgICAgICAgdmFyIGhyZWYgPSAkZS5hdHRyKCdocmVmJykKICAgICAgICAgICwgdXNlcm5hbWUgPSBocmVmLnNwbGl0KCcvJykucG9wKCkKICAgICAgICAgICwgd2hvID0gdXNlcm5hbWUrJywnCiAgICAgICAgOwoKICAgICAgICBpZigkY2FydERJVi5maW5kKCcudXNlcjJCW2hyZWY9IicraHJlZisnIl0nKS5sZW5ndGgpewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAkLmFqYXgoJy9ub2RlL01lbWJlclByb2ZpbGVDYXJkVjI/JyskLnBhcmFtKHtwYXJhbXM6SlNPTi5zdHJpbmdpZnkoeyd1cmxfdG9rZW4nOnVzZXJuYW1lfSl9KSwgewogICAgICAgICAgICB0eXBlOiAnR0VUJwogICAgICAgICAgLCB1c2VyMkI6ICRlCiAgICAgICAgICAsIG1heFJldHJ5Q291bnQ6IDMKICAgICAgICB9KS5kb25lKGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIGpxWEhSKXsKICAgICAgICAgICAgaVpoaWh1LlF1aWNrQmxvY2suYWRkVXNlcjJCKGRhdGEpCiAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLmluMkJsb2NrQ2FydCh1cmwpCiAgICAgICAgfSkuZmFpbChmdW5jdGlvbihkYXRhLHRleHRTdGF0dXMsalhIUil7CiAgICAgICAgICAgIGlmICgrK3JldHJpZWRDb3VudCA8IHRoaXMubWF4UmV0cnlDb3VudCl7CiAgICAgICAgICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5Vc2VyczJCLnVuc2hpZnQodGhpcy51c2VyMkIpCiAgICAgICAgICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5pbjJCbG9ja0NhcnQodXJsLHJldHJpZWRDb3VudCkKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIH0KICAgICAgICB9KS5hbHdheXMoZnVuY3Rpb24oZGF0YSx0ZXh0U3RhdHVzLGpYSFIpewogICAgICAgICAgICAkKCcjaXpoX2Jsb2NrQ2FydCcpLnJlbW92ZUNsYXNzKCdwZW5kaW5nJyk7CiAgICAgICAgfSk7CiAgICB9OwogICAgdGhpcy5hZGRVc2VyMkI9ZnVuY3Rpb24oZGF0YSl7CiAgICAgICAgaWYgKGRhdGEgPT09ICcnKSByZXR1cm4KICAgICAgICB2YXIgJGh0bWw9JChkYXRhLnJlcGxhY2UodXRpbHMuUmVnZXhTcmNQaWMsICcnKSkKICAgICAgICAgICwgaXNaSFBDPSRodG1sLmlzKCcuemgtcHJvZmlsZS1jYXJkJykKICAgICAgICAgICwgJGF2YXRhckxpbms9aXNaSFBDPyRodG1sLmZpbmQoJy5hdmF0YXItbGluazpmaXJzdCcpOiRodG1sLmZpbmQoJy56bS1pdGVtLWxpbmstYXZhdGFyOmZpcnN0JykKICAgICAgICAgICwgaHJlZj0kYXZhdGFyTGluay5hdHRyKCdocmVmJykKICAgICAgICBpZigoaHJlZnx8JycpPT0nJylyZXR1cm4KCiAgICAgICAgdmFyIHVzZXJJRD1ocmVmLnN1YnN0cig4KQogICAgICAgICAgLCB1c2VyTmFtZT1pc1pIUEM/JGF2YXRhckxpbmsudGV4dCgpOiRhdmF0YXJMaW5rLmF0dHIoJ3RpdGxlJykKICAgICAgICAgICwgJGJ0bkZvbGxvdz0kaHRtbC5maW5kKCdidXR0b25bZGF0YS1mb2xsb3ddJykKICAgICAgICAgICwgaGFzaElEPSEkYnRuRm9sbG93Lmxlbmd0aD8nJzokYnRuRm9sbG93LmF0dHIoJ2RhdGEtaWQnKQogICAgICAgICAgLCBmXz0kYnRuRm9sbG93Lmxlbmd0aCYmJGJ0bkZvbGxvdy5pcygnLnpnLWJ0bi11bmZvbGxvdycpCiAgICAgICAgICAsIF9mPSRidG5Gb2xsb3cubGVuZ3RoJiYkYnRuRm9sbG93LmlzKCdbZGF0YS1mb2xsb3dtZT0xXScpCiAgICAgICAgICAsIGNzc0Y9X2Z8fGZfPyd6Zy1pY29uIHJlbCAnOicnCiAgICAgICAgICAsICRjYXJ0RElWPWlaaGlodS5RdWlja0Jsb2NrLmdldENhcnRESVYoKQogICAgICAgICAgLCAkY2FydD0kY2FydERJVi5maW5kKCcubGlzdCcpCiAgICAgICAgICAsIHdobz0nLCcrdXNlcklEKycsJwogICAgICAgIDsKCiAgICAgICAgaWYoaGFzaElEPT0nJyl7CiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBibG9ja2VkIG9yIHlvdSBibG9ja2VkCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmKCRjYXJ0RElWLmZpbmQoJy5saXN0IC51c2VyMkJbaHJlZj0iJytocmVmKyciXScpLmxlbmd0aCl7CiAgICAgICAgICAgIHJldHVybjsgLy8gVXNlciBhbHJlYWR5IGluIGJsb2NrIGxpc3QKICAgICAgICB9CgogICAgICAgIHZhciAkdXNlcjJCPSQoJzxkaXY+Jyx7CiAgICAgICAgICAgICAgICAnY2xhc3MnOid1c2VyMkInKyhmXyYmJGNhcnRESVYuZmluZCgnLmRvIC51bmZvOmNoZWNrZWQnKS5sZW5ndGg/JyB1bmZvJzonJykKICAgICAgICAgICAgICAsICdocmVmJzpocmVmCiAgICAgICAgICAgICAgLCAndWlkJzpoYXNoSUQKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmFwcGVuZCgKICAgICAgICAgICAgICAgICQoJzxhPicsewogICAgICAgICAgICAgICAgICAgICdjbGFzcyc6J2J1dHRvbiBkZWwnCiAgICAgICAgICAgICAgICAgICwgaHJlZjonamF2YXNjcmlwdDp2b2lkKDApOycKICAgICAgICAgICAgICAgICAgLCBjbGljazpmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJHVzZXI9JCh0aGlzKS5jbG9zZXN0KCcudXNlcjJCJykKICAgICAgICAgICAgICAgICAgICAgICAgICAsICRjYXJ0RElWPSQoJyNpemhfYmxvY2tDYXJ0JykKICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICAkdXNlci5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG51bTJCPSRjYXJ0RElWLmZpbmQoJy5saXN0IC51c2VyMkInKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICRjYXJ0RElWLmNoaWxkcmVuKCcuZG8nKS5hdHRyKCdpemhfbnVtMkInLG51bTJCPT0wPycwJzpudW0yQj45OTk/JzFrKyc6bnVtMkIpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihudW0yQikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLnJlc2l6ZUJsb2NrQ2FydCgkY2FydERJVik7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjYXJ0RElWLmNzcygnaGVpZ2h0JywnJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkudGV4dCgn6LWmJykKICAgICAgICAgICAgKS5hcHBlbmQoCiAgICAgICAgICAgICAgICAkKCc8aT4nLHsKICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOidzYXknCiAgICAgICAgICAgICAgICAgICwgJ2RhdGEtdGlwJzoncCR0JCcrdXNlcklECiAgICAgICAgICAgICAgICB9KS50ZXh0KCflhqTmnoknKQogICAgICAgICAgICApLmFwcGVuZCgkKCc8aT4nLHsnY2xhc3MnOidzYXlfMSd9KQogICAgICAgICAgICApLmFwcGVuZCgkKCc8aT4nLHsnY2xhc3MnOidzYXlfMid9KQogICAgICAgICAgICApLmFwcGVuZCgkKCc8aT4nLHsnY2xhc3MnOmNzc0Z9KQogICAgICAgICAgICApLmFwcGVuZCgKICAgICAgICAgICAgICAgICQoJzxhPicsewogICAgICAgICAgICAgICAgICAgICdjbGFzcyc6J25hbWUnCiAgICAgICAgICAgICAgICAgICwgaHJlZjpocmVmCiAgICAgICAgICAgICAgICAgICwgdGFyZ2V0OidfYmxhbmsnCiAgICAgICAgICAgICAgICB9KS50ZXh0KHVzZXJOYW1lKQogICAgICAgICAgICApLnNob3coKQogICAgICAgIDsKICAgICAgICBpZihmXyYmX2YpewogICAgICAgICAgICAkY2FydC5lcSgwKS5hcHBlbmQoJHVzZXIyQik7CiAgICAgICAgfWVsc2UgaWYoZl8pewogICAgICAgICAgICAkY2FydC5lcSgxKS5hcHBlbmQoJHVzZXIyQik7CiAgICAgICAgfWVsc2UgaWYoX2YpewogICAgICAgICAgICAkY2FydC5lcSgyKS5hcHBlbmQoJHVzZXIyQik7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICRjYXJ0LmVxKDMpLmFwcGVuZCgkdXNlcjJCKTsKICAgICAgICB9CiAgICAgICAgdmFyIG51bTJCPSRjYXJ0RElWLmZpbmQoJy5saXN0IC51c2VyMkInKS5sZW5ndGg7CiAgICAgICAgJGNhcnRESVYuY2hpbGRyZW4oJy5kbycpLmF0dHIoJ2l6aF9udW0yQicsbnVtMkI9PTA/JzAnOm51bTJCPjk5OTk/JzEwaysnOm51bTJCKTsKICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5yZXNpemVCbG9ja0NhcnQoJGNhcnRESVYpOwogICAgfQogICAgdGhpcy5hZGRRdWlja0Jsb2NrID0gZnVuY3Rpb24oJGEpewogICAgICAgIHZhciAkdm90ZUluZm89JCgnLnptLWl0ZW0tdm90ZS1pbmZvJywkYSkKICAgICAgICBpZigkdm90ZUluZm8ubGVuZ3RoKXsKICAgICAgICAgICAgdmFyICR2b3RlcnM9JHZvdGVJbmZvLmNoaWxkcmVuKCcudm90ZXJzJykKICAgICAgICAgICAgaWYoJHZvdGVycy5sZW5ndGgpewogICAgICAgICAgICAgICAgdmFyIHM9WyfvvIwnLCR2b3RlSW5mby5hdHRyKCdkYXRhLXZvdGVjb3VudCcpLCfkuKrkuZ/kuI3og73lv43vvIzmnpzmlq3mkpUnXS5qb2luKCcnKQogICAgICAgICAgICAgICAgICAsIGFpZD0kYS5hdHRyKCdkYXRhLWFpZCcpfHwkYS5jaGlsZHJlbignW2l0ZW1wcm9wPSJaUmVhY3RvciJdJykuYXR0cignZGF0YS1pZCcpCiAgICAgICAgICAgICAgICAgICwgdXJsPVsnLycsJGEuYXR0cignZGF0YS10eXBlJyk9PSdwJz8ncG9zdCc6J2Fuc3dlcicsJy8nLGFpZCwnL3ZvdGVyc19wcm9maWxlJ10uam9pbignJykKICAgICAgICAgICAgICAgICQoJzxhPicse2hyZWY6J2phdmFzY3JpcHQ6OycsJ2NsYXNzJzondGV4dCd9KS50ZXh0KHMpLmJpbmQoJ2NsaWNrJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgdmFyICR0PSRhLmZpbmQoJy5hdXRob3ItaW5mbyA+IGEubmFtZSwuem0taXRlbS1hbnN3ZXItYXV0aG9yLWluZm8gPiBhLmF1dGhvci1saW5rJykKICAgICAgICAgICAgICAgICAgICBpZigkdCYmJHQubGVuZ3RoKXsKICAgICAgICAgICAgICAgICAgICAgICAgaVpoaWh1LlF1aWNrQmxvY2suVXNlcnMyQi5wdXNoKCR0KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpWmhpaHUuUXVpY2tCbG9jay5pbjJCbG9ja0NhcnQodXJsKQogICAgICAgICAgICAgICAgfSkuYXBwZW5kVG8oJHZvdGVJbmZvKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKICAgIHRoaXMuYWRkUXVpY2tCbG9ja0luT25lQ29tbWVudCA9IGZ1bmN0aW9uKCRjbUl0ZW0pewogICAgICAgIHZhciAkd2hlcmU9JCgnLnptLWNvbW1lbnQtaGQnLCRjbUl0ZW0pOwogICAgICAgIGlmKCR3aGVyZS5maW5kKCcuaXpoLXF1aWNrLWJsb2NrLXBlbmQnKS5sZW5ndGgpcmV0dXJuOwogICAgICAgICQoJzxhPicsewogICAgICAgICAgICAnY2xhc3MnOidpemgtcXVpY2stYmxvY2stcGVuZCBpemgtYnV0dG9uJwogICAgICAgICAgLCBocmVmOidqYXZhc2NyaXB0OnZvaWQoMCk7JwogICAgICAgICAgLCAnZGF0YS10aXAnOidzJGwk5bCG5q2k5Lq65YiX5YWl5YCZ5a6h5ZCN5Y2V5Lul5b6F5pS255uRJwogICAgICAgIH0pLnRleHQoJ+WAmeWuoScpLmNsaWNrKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciAkZSA9ICQodGhpcykubmV4dCgpCiAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLlVzZXJzMkIucHVzaCgkZSkKICAgICAgICAgICAgaVpoaWh1LlF1aWNrQmxvY2suaW4yQmxvY2tDYXJ0KCk7CiAgICAgICAgfSkucHJlcGVuZFRvKCR3aGVyZSkuaGlkZSgpOwogICAgfTsKICAgIHRoaXMuYWRkUXVpY2tCbG9ja0luQ29tbWVudExpc3QgPSBmdW5jdGlvbigkd2hlcmUpewogICAgICAgIC8vIFJlZ2lvbjog5b+r6YCf5bGP6JS9CiAgICAgICAgdmFyICRjbT0kd2hlcmUuaXMoJy56bS1jb21tZW50LWJveCcpPyR3aGVyZTokd2hlcmUuY2xvc2VzdCgnLnptLWNvbW1lbnQtYm94JykKICAgICAgICAgICwgJHU9JCgnLnptLWl0ZW0tY29tbWVudCcsJGNtKQogICAgICAgIDsKICAgICAgICAkdS5lYWNoKGZ1bmN0aW9uKGksZSl7CiAgICAgICAgICAgIGlaaGlodS5RdWlja0Jsb2NrLmFkZFF1aWNrQmxvY2tJbk9uZUNvbW1lbnQoJChlKSk7CiAgICAgICAgfSk7CiAgICAgICAgdmFyICRidG5RdWlja0Jsb2NrPSQoJzxhPicsewogICAgICAgICAgICAgICAgJ2NsYXNzJzonaXpoLXF1aWNrLWJsb2NrLXN3aXRjaCBpemgtYnV0dG9uJwogICAgICAgICAgICAgICwgaHJlZjonamF2YXNjcmlwdDp2b2lkKDApOycKICAgICAgICAgICAgICAsICdkYXRhLXRpcCc6J3MkdCTlvIDlp4vku47or4TorrrogIXkuK3pgInmi6nlsY/olL3lr7nosaEnCiAgICAgICAgICAgIH0pLnRleHQoJ+W/q+mAn+Wxj+iUvScpLmNzcyh7J21hcmdpbi1sZWZ0Jzo3fSkucHJlcGVuZFRvKCR3aGVyZSkuY2xpY2soZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIGlmKHRoaXMuZ2V0QXR0cmlidXRlKCdvbicpPT0nMScpewogICAgICAgICAgICAgICAgICAgICQoJy56bS1jb21tZW50LWhkIC5pemgtcXVpY2stYmxvY2stcGVuZCcpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmF0dHIoeydkYXRhLXRpcCc6J3MkdCTlvIDlp4vku47or4TorrrogIXkuK3pgInmi6nlsY/olL3lr7nosaEnLCdvbic6JzAnfSkucmVtb3ZlQ2xhc3MoJ29uJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICQoJy56bS1jb21tZW50LWhkIC5pemgtcXVpY2stYmxvY2stcGVuZCcpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmF0dHIoeydkYXRhLXRpcCc6J3MkdCTnu5PmnZ/ku47or4TorrrogIXkuK3pgInmi6nlsY/olL3lr7nosaEnLCdvbic6JzEnfSkuYWRkQ2xhc3MoJ29uJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgOwogICAgICAgIGlmKCRjbS5pcygnLmVtcHR5JykpewogICAgICAgICAgICAkYnRuUXVpY2tCbG9jay5oaWRlKCk7CiAgICAgICAgfQogICAgICAgIC8vIFJlZ2lvbiBlbmQKICAgIH07CiAgICAKICAgIGlaaGlodS4kYm9keS5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAkKGV2ZW50LnRhcmdldCkuZmlsdGVyKCcjemgtdG9vbHRpcCcpLmJpbmQoJ0RPTU5vZGVJbnNlcnRlZCcsZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICB2YXIgJGE9JChldmVudC50YXJnZXQpLmZpbHRlcignI3poLXRvb2x0aXAtcGVvcGxlJykuZmluZCgnYVtuYW1lPWZvY3VzXScpCiAgICAgICAgICAgICAgLCBiaWQ9JGEuYXR0cignaWQnKQogICAgICAgICAgICAgICwgd2hvPScsJytiaWQrJywnCiAgICAgICAgICAgIDsKICAgICAgICAgICAgaWYoJGEuaXMoJy56Zy1idG4tdW5mb2xsb3cnKSYmaVpoaWh1LlF1aWNrQmxvY2suVW5mb2xsb3dlZC5Vc2Vycy5pbmRleE9mKHdobyk+PTApewogICAgICAgICAgICAgICAgJGEudGV4dCgn5YWz5rOoJykucmVtb3ZlQ2xhc3MoJ3pnLWJ0bi11bmZvbGxvdycpLmFkZENsYXNzKCd6Zy1idG4tZm9sbG93Jyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoJGEuaXMoJy56Zy1idG4tZm9sbG93JykmJmlaaGlodS5RdWlja0Jsb2NrLlJlZm9sbG93ZWQuVXNlcnMuaW5kZXhPZih3aG8pPj0wKXsKICAgICAgICAgICAgICAgICRhLnRleHQoJ+WPlua2iOWFs+azqCcpLnJlbW92ZUNsYXNzKCd6Zy1idG4tZm9sbG93JykuYWRkQ2xhc3MoJ3pnLWJ0bi11bmZvbGxvdycpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiB0aGlzOwp9CgovKioKICogQGNsYXNzIFF1aWNrRmF2bwogKi8KZnVuY3Rpb24gUXVpY2tGYXZvKGlaaGlodSkgewogICAgaWYgKCB0eXBlb2YgaVpoaWh1ID09PSAndW5kZWZpbmVkJyB8fCAhaVpoaWh1IHx8ICFpWmhpaHUuY29uZmlnWydRdWlja0Zhdm8nXSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgaVpoaWh1LlF1aWNrRmF2byA9IHRoaXM7CiAgICAKICAgIHRoaXMuRGVmYXVsdENvdW50ID0gNDsKICAgIHRoaXMuUGlubmVkTGlzdCA9IGlaaGlodS5jb25maWdbJ1F1aWNrRmF2b1Bpbm5lZCddOwogICAgdGhpcy5jc3MgPSAKICAgICAgICBbJy5pemgtUGluNFF1aWNrRmF2b3twYWRkaW5nOjNweCA1cHggMDtmbG9hdDpyaWdodDtkaXNwbGF5OmJsb2NrO21hcmdpbi10b3A6NHB4O21hcmdpbi1yaWdodDoyZW07bGluZS1oZWlnaHQ6MS4yNTt9JwogICAgICAgICwnLml6aC1QaW40UXVpY2tGYXZvIC56bS1pdGVtLXRvcC1idG57dmlzaWJpbGl0eTp2aXNpYmxlO21hcmdpbjowIDRweDtmbG9hdDpyaWdodDt9JwogICAgICAgICwnZGl2Lml6aF9mYXZ7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDo5OTk5O2Rpc3BsYXk6bm9uZTtib3JkZXI6MXB4IHNvbGlkICM5OTk5OTk7YmFja2dyb3VuZC1jb2xvcjojZmZmO2JvcmRlci1yYWRpdXM6NXB4IDVweCA1cHggMDttYXJnaW4tbGVmdDotMXB4O30nCiAgICAgICAgLCdkaXYuaXpoX2ZhdiAudGl0bGV7cGFkZGluZzowIDVweDtiYWNrZ3JvdW5kLWNvbG9yOiMwODc0YzQ7Y29sb3I6I2ZmZjtmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToxNXB4O3RleHQtYWxpZ246Y2VudGVyO2JvcmRlci1yYWRpdXM6M3B4IDNweCAwIDA7fScKICAgICAgICAsJ2Rpdi5pemhfZmF2IGEuZmF2e2Rpc3BsYXk6YmxvY2s7Y2xlYXI6Ym90aDtmbG9hdDtsZWZ0O3BhZGRpbmc6MCAzNnB4IDAgMjRweDtsaW5lLWhlaWdodDoyO30nCiAgICAgICAgLCdkaXYuaXpoX2ZhdiBhLmZhdiBpe3Bvc2l0aW9uOmFic29sdXRlO21hcmdpbi10b3A6MC41ZW07fScKICAgICAgICAsJ2Rpdi5pemhfZmF2IGEuZmF2IGkuc3Bpbm5lci1ncmF5e2xlZnQ6MDt9JwogICAgICAgICwnZGl2Lml6aF9mYXYgYS5mYXYgaS56LWljb24tY29sbGVjdHtsZWZ0OjEwcHg7dmlzaWJpbGl0eTpoaWRkZW47YmFja2dyb3VuZC1wb3NpdGlvbjotNTZweCAtMzZweDt9JwogICAgICAgICwnZGl2Lml6aF9mYXYgYS5mYXYuc2VsZWN0ZWQgaS56LWljb24tY29sbGVjdHt2aXNpYmlsaXR5OnZpc2libGU7fScKICAgICAgICAsJ2Rpdi5pemhfZmF2IGEuZmF2OmhvdmVye3RleHQtZGVjb3JhdGlvbjpub25lfScKICAgICAgICAsJ2Rpdi5pemhfZmF2IGEuZmF2IHNwYW57ZmxvYXQ6cmlnaHQ7ZGlzcGxheTpibG9jazttYXJnaW4tcmlnaHQ6LTMycHh9JwogICAgICAgICwnLm1ldGEtaXRlbS5vbntwb3NpdGlvbjpyZWxhdGl2ZTt6LWluZGV4OjEwMDAwO2JhY2tncm91bmQtY29sb3I6I2ZmZjtib3JkZXI6MXB4IHNvbGlkICM5OTk5OTk7Ym9yZGVyLXRvcC1jb2xvcjojZmZmO21hcmdpbjotMXB4IC04cHggLTFweCAtMXB4O3BhZGRpbmc6MCA3cHg7Ym9yZGVyLXJhZGl1czoycHggMnB4IDNweCAzcHg7fScKICAgICAgICAsJyddLmpvaW4oJ1xuJyk7CiAgICB0aGlzLmFkZFF1aWNrRmF2byA9IGZ1bmN0aW9uKCR2LCRhKXsKICAgICAgICBpZigkdi5sZW5ndGgpewogICAgICAgICAgICBpZigkYS5jaGlsZHJlbignLml6aF9mYXYnKS5sZW5ndGg8PTApewogICAgICAgICAgICAgICAgJCgnPGRpdj4nLCB7ICdjbGFzcyc6ICdpemhfZmF2JyB9KQogICAgICAgICAgICAgICAgCS5hcHBlbmQoJCgnPGk+JywgeyAnY2xhc3MnOiAnc3Bpbm5lci1ncmF5JyB9KSkKICAgICAgICAgICAgICAgIAkuYXBwZW5kKCcmbmJzcDvliqDovb3kuK0uLi4mbmJzcDsnKQogICAgICAgICAgICAgICAgCS5iaW5kKCdtb3VzZW92ZXInLCBmdW5jdGlvbigpewoJICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnNob3coKS5wYXJlbnQoKS5maW5kKCcubWV0YS1pdGVtW25hbWU9ZmF2b10nKS5hZGRDbGFzcygnb24nKTsKICAgICAgICAgICAgICAgIAl9KQogICAgICAgICAgICAgICAgCS5iaW5kKCdtb3VzZW91dCcsIGZ1bmN0aW9uKCl7CgkgICAgICAgICAgICAgICAgICAgICQodGhpcykuaGlkZSgpLnBhcmVudCgpLmZpbmQoJy5tZXRhLWl0ZW1bbmFtZT1mYXZvXScpLnJlbW92ZUNsYXNzKCdvbicpOwoJICAgICAgICAgICAgICAgIH0pCgkgICAgICAgICAgICAuYXBwZW5kVG8oJGEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR2LmJpbmQoJ21vdXNlZW50ZXInLGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICB2YXIgJGE9aVpoaWh1LmdldEl0ZW0oJCh0aGlzKSkKICAgICAgICAgICAgICAgICAgLCAkbT0kKHRoaXMpLmFkZENsYXNzKCdvbicpLmNsb3Nlc3QoJy56bS1pdGVtLW1ldGEnKQogICAgICAgICAgICAgICAgICAsIGFpZD0kYS5hdHRyKCdkYXRhLWFpZCcpCiAgICAgICAgICAgICAgICAgICwgJG9wPSQodGhpcykub2Zmc2V0UGFyZW50KCkKICAgICAgICAgICAgICAgICAgLCBib3R0b20xPXBhcnNlSW50KCRvcC5jc3MoJ21hcmdpbi1ib3R0b20nKSkKICAgICAgICAgICAgICAgICAgLCBib3R0b20yPXBhcnNlSW50KCRhLmNzcygncGFkZGluZy1ib3R0b20nKSkKICAgICAgICAgICAgICAgICAgLCBwb3M9JCh0aGlzKS5wb3NpdGlvbigpCiAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAkYS5jaGlsZHJlbignLml6aF9mYXYnKS5jc3MoewogICAgICAgICAgICAgICAgICAgICdib3R0b20nOihpc05hTihib3R0b20xKT8wOmJvdHRvbTEpKyhpc05hTihib3R0b20yKT8wOmJvdHRvbTIpKyRvcC5oZWlnaHQoKS1wb3MudG9wCiAgICAgICAgICAgICAgICAgICwgJ2xlZnQnOnBvcy5sZWZ0KyRtLnBvc2l0aW9uKCkubGVmdAogICAgICAgICAgICAgICAgfSkuc2hvdygpOwogICAgICAgICAgICAgICAgJC5nZXRKU09OKCcvY29sbGVjdGlvbnMvanNvbicsJC5wYXJhbSh7YW5zd2VyX2lkOmFpZH0pLGZ1bmN0aW9uKHJlc3VsdCxzdGF0dXMseGhyKXsKICAgICAgICAgICAgICAgICAgICB2YXIgYWlkPXRoaXMudXJsLnN1YnN0cih0aGlzLnVybC5pbmRleE9mKCdhbnN3ZXJfaWQ9JykrMTApCiAgICAgICAgICAgICAgICAgICAgICAsIHNlbD1wYWdlSXMuUXVlc3Rpb24/Jy56bS1pdGVtLWFuc3dlcicKICAgICAgICAgICAgICAgICAgICAgICAgICAgOnBhZ2VJcy5Ib21lPycuZmVlZC1pdGVtJwogICAgICAgICAgICAgICAgICAgICAgICAgICA6cGFnZUlzLkFuc3dlcj8nLnptLWl0ZW0tYW5zd2VyJwogICAgICAgICAgICAgICAgICAgICAgICAgICA6JycKICAgICAgICAgICAgICAgICAgICAgICwgJGE9JChzZWwrJ1tkYXRhLWFpZD0nK2FpZCsnXScpCiAgICAgICAgICAgICAgICAgICAgICAsICR2PSRhLmNoaWxkcmVuKCcuaXpoX2ZhdicpLmVtcHR5KCkuYXBwZW5kKCQoJzxkaXY+Jyx7J2NsYXNzJzondGl0bGUnLHRpdGxlOifku6XkuIvkuLrmnIDov5HpgInmi6nnmoTmlLbol4/lpLknfSkuYXBwZW5kKCflv6vpgJ/mlLbol48nKSkKICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgaWYoJyc9PXNlbClyZXR1cm47CiAgICAgICAgICAgICAgICAgICAgdmFyIGZhdkFsbD1yZXN1bHQubXNnWzBdCiAgICAgICAgICAgICAgICAgICAgICAsIGZhdlNlbD1yZXN1bHQubXNnWzFdCiAgICAgICAgICAgICAgICAgICAgICAsIG51bT1pWmhpaHUuUXVpY2tGYXZvLkRlZmF1bHRDb3VudAogICAgICAgICAgICAgICAgICAgICAgLCBmYXY9bmV3IEFycmF5KCkKICAgICAgICAgICAgICAgICAgICAgICwgZmF2Tm9ybWFsPW5ldyBBcnJheSgpCiAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICQuZWFjaChmYXZBbGwsZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZJRD1lWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgLCBwaW5uZWQ9aVpoaWh1LlF1aWNrRmF2by5QaW5uZWRMaXN0W2ZJRF0KICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICBpZihwaW5uZWQpewogICAgICAgICAgICAgICAgICAgICAgICAgIGZhdi5wdXNoKGUpOwogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICBmYXZOb3JtYWwucHVzaChlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIG51bSAtPSBmYXYubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIGlmKG51bSA+IDApewogICAgICAgICAgICAgICAgICAgICAgICBmYXY9ZmF2LmNvbmNhdChmYXZOb3JtYWwuc2xpY2UoMCxudW0pKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZmF2Tm9ybWFsLmxlbmd0aD0wOwogICAgICAgICAgICAgICAgICAgIHdoaWxlKGZhdi5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZT1mYXYuc2hpZnQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICwgZklEPWVbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAsIGZOYW1lPWVbMV0KICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICBmYXZOb3JtYWxbZklEXT1mTmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRmPSQoJzxhLz4nLHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOidmYXYnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgaHJlZjonamF2YXNjcmlwdDo7JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGFpZDphaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBmaWQ6ZklECiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS50ZXh0KGZOYW1lKS5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1PScvY29sbGVjdGlvbi8nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRmPSQodGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGk9JGYuY2hpbGRyZW4oJzpmaXJzdCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRpLmhhc0NsYXNzKCdzcGlubmVyLWdyYXknKSlyZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdSs9JGYuaGFzQ2xhc3MoJ3NlbGVjdGVkJyk/J3JlbW92ZSc6J2FkZCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGkuYXR0cignY2xhc3MnLCdzcGlubmVyLWdyYXknKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLnBvc3QodSwkLnBhcmFtKHtfeHNyZjokKCdpbnB1dFtuYW1lPV94c3JmXScpLnZhbCgpLGFuc3dlcl9pZDokKHRoaXMpLmF0dHIoJ2FpZCcpLGZhdmxpc3RfaWQ6JCh0aGlzKS5hdHRyKCdmaWQnKX0pLGZ1bmN0aW9uKHJlc3VsdCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3Q9dGhpcy51cmwuc3Vic3RyaW5nKHRoaXMudXJsLmxhc3RJbmRleE9mKCcvJykrMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGZpZD11dGlscy5nZXRQYXJhbUluUXVlcnkodGhpcy5kYXRhLCdmYXZsaXN0X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGFpZD11dGlscy5nZXRQYXJhbUluUXVlcnkodGhpcy5kYXRhLCdhbnN3ZXJfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgc2VsPXBhZ2VJcy5RdWVzdGlvbj8nLnptLWl0ZW0tYW5zd2VyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnBhZ2VJcy5Ib21lPycuZmVlZC1pdGVtJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOicnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkdmk9Jyc9PXNlbD9udWxsOiQoc2VsKydbZGF0YS1haWQ9JythaWQrJ10gLml6aF9mYXYgYVtmaWQ9JytmaWQrJ10nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgaW5jPTA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCcnPT1zZWwpcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhY3Q9PSdyZW1vdmUnJiZyZXN1bHQubXNnPT0nT0snKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2aS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluYz0tMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoYWN0PT0nYWRkJyYmcmVzdWx0Lm1zZy5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHZpLmFkZENsYXNzKCdzZWxlY3RlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jPTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5jIT0wKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2aS5jaGlsZHJlbignc3BhbicpLnRleHQocGFyc2VJbnQoJHZpLmNoaWxkcmVuKCdzcGFuJykudGV4dCgpKStpbmMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2aS5jaGlsZHJlbignOmZpcnN0JykuYXR0cignY2xhc3MnLCd6LWljb24tY29sbGVjdCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkucHJlcGVuZCgkKCc8aS8+Jyx7J2NsYXNzJzonei1pY29uLWNvbGxlY3QnfSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHNwYW4vPicpLnRleHQoZVszXSkpOwogICAgICAgICAgICAgICAgICAgICAgICAkZi5hcHBlbmRUbygkdi8qLmNoaWxkcmVuKHBpbm5lZD8nLnBpbm5lZCc6Jy5ub3JtYWwnKSovKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICQuZWFjaChmYXZTZWwsZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZmF2Tm9ybWFsW2VdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHYuZmluZCgnYS5mYXZbZmlkPScrZSsnXScpLmFkZENsYXNzKCdzZWxlY3RlZCcpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkdi5iaW5kKCdtb3VzZWxlYXZlJyxmdW5jdGlvbigpewogICAgICAgICAgICAgICAgdmFyICRhPWlaaGlodS5nZXRJdGVtKCQodGhpcykucmVtb3ZlQ2xhc3MoJ29uJykpOwogICAgICAgICAgICAgICAgJGEuY2hpbGRyZW4oJy5pemhfZmF2JykuaGlkZSgpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9OwoKICAgIGlaaGlodS4kYm9keS5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKCQl2YXIgJGU9JChldmVudC50YXJnZXQpOwoJCWlmKCRlLmlzKCcubW9kYWwtZGlhbG9nJykpewoJCQkkZS5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKCQkJCXZhciAkZT0kKGV2ZW50LnRhcmdldCkKICAgICAgICAgICAgICAgICAgLCAkZmF2TGlzdD0kZS5maW5kKCcuem0tZmF2by1saXN0LWNvbnRlbnQnKQogICAgICAgICAgICAgICAgOwoJCQkJaWYoJGZhdkxpc3QubGVuZ3RoKXsKCQkJCQl2YXIgJGZhdkl0ZW1zPSRmYXZMaXN0LmNoaWxkcmVuKCcuem0tZmF2by1saXN0LWl0ZW0tbGlua1tkYXRhLWxpZF0nKQogICAgICAgICAgICAgICAgICAgICAgLCBmdW5jUGluPWZ1bmN0aW9uKGUpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBpbm5lZD1lLmNoZWNrZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkZT0kKGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGY9JGUuY2xvc2VzdCgnLnptLWZhdm8tbGlzdC1pdGVtLWxpbmsnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgO2lmKCEkZi5sZW5ndGgpcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpZD0kZS5hdHRyKCdsaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRjaGVja3M9JGUuY2xvc2VzdCgnLnptLWZhdm8tbGlzdC1jb250ZW50JykuZmluZCgnLml6aC1QaW40UXVpY2tGYXZvIC50X2pjaGtib3gnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIHRpbWU9NTAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBjc3NTdGFydD17cG9zaXRpb246J3JlbGF0aXZlJywnYmFja2dyb3VuZC1jb2xvcic6JyMwODc0QzQnLCd6LWluZGV4JzonMTAwJ30KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBjc3NFbmQ9e3Bvc2l0aW9uOicnLCdiYWNrZ3JvdW5kLWNvbG9yJzonJywnei1pbmRleCc6Jyd9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZnVuY1JvbGxVcD1mdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGI9JGUuY2xvc2VzdCgnLnptLWZhdm8tbGlzdC1pdGVtLWxpbmsnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGE9JGIucHJldigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoISRhLmxlbmd0aHx8KCRhLmhhc0NsYXNzKCdwaW5uZWQnKSYmcGFyc2VJbnQoJGEuYXR0cignZGF0YS1saWQnKSk8cGFyc2VJbnQoJGIuYXR0cignZGF0YS1saWQnKSkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYi5hbmltYXRlKHtib3R0b206JGEub3V0ZXJIZWlnaHQoKX0sewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246dGltZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgc3RlcDpmdW5jdGlvbihub3cpeyRiLmNzcyhjc3NTdGFydCk7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgY29tcGxldGU6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYi5jc3MoJC5leHRlbmQoe2JvdHRvbTowfSxjc3NFbmQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYi5pbnNlcnRCZWZvcmUoJGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmNSb2xsVXAoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGZ1bmNSb2xsRG93bj1mdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGE9JGUuY2xvc2VzdCgnLnptLWZhdm8tbGlzdC1pdGVtLWxpbmsnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGI9JGEubmV4dCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoISRiLmxlbmd0aHx8KCEkYi5oYXNDbGFzcygncGlubmVkJykmJnBhcnNlSW50KCRiLmF0dHIoJ2luZGV4JykpPnBhcnNlSW50KCRhLmF0dHIoJ2luZGV4JykpKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGEuYW5pbWF0ZSh7dG9wOiRiLm91dGVySGVpZ2h0KCl9LHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOnRpbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIHN0ZXA6ZnVuY3Rpb24obm93KXskYS5jc3MoY3NzU3RhcnQpO30KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGNvbXBsZXRlOmZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGEuY3NzKCQuZXh0ZW5kKHt0b3A6MH0sY3NzRW5kKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGEuaW5zZXJ0QWZ0ZXIoJGIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmNSb2xsRG93bigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihwaW5uZWQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmLmFkZENsYXNzKCdwaW5uZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jUm9sbFVwKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZi5yZW1vdmVDbGFzcygncGlubmVkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY1JvbGxEb3duKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpWmhpaHUuUXVpY2tGYXZvLlBpbm5lZExpc3RbbGlkXT1waW5uZWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5zZXRDZmcoJ1F1aWNrRmF2b1Bpbm5lZCcsaVpoaWh1LlF1aWNrRmF2by5QaW5uZWRMaXN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIDsKCQkJCQkkZmF2SXRlbXMuZWFjaChmdW5jdGlvbihpLGUpewoJCQkJCQl2YXIgbGlkPWUuZ2V0QXR0cmlidXRlKCdkYXRhLWxpZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkcGluPSQoJzxhLz4nLHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBocmVmOidqYXZhc2NyaXB0OnZvaWQoMCk7JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICdjbGFzcyc6J2l6aC1QaW40UXVpY2tGYXZvJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICdsaWQnOmxpZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICdkYXRhLXRpcCc6J3MkYiTkv53mjIHlnKjjgIzlv6vpgJ/mlLbol4/jgI3oj5zljZXpobbpg6jmmL7npLonCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5hcHBlbmQoJCgnPHNwYW4vPicpLmFwcGVuZCgn572u6aG2JykuYWRkKCc8aS8+Jyx7J2NsYXNzJzonem0taXRlbS10b3AtYnRuJ30pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8oJCgnLnpnLWdyYXknLGUpKS5hdHRyKCdpbmRleCcsaSkKICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICBlLnNldEF0dHJpYnV0ZSgnaW5kZXgnLGkpOwogICAgICAgICAgICAgICAgICAgICAgICAkcGluLmJpbmQoJ2NsaWNrJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWQ9IXRoaXMuY2hlY2tlZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmNQaW4odGhpcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0aGlzLmNoZWNrZWQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oJ3NwYW4nKS50ZXh0KCflj5bmtojnva7pobYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCdpJykuYWRkQ2xhc3MoJ3ptLWl0ZW0tdG9wLWJ0bi1jYW5jZWwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuY2hpbGRyZW4oJ3NwYW4nKS50ZXh0KCfnva7pobYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNoaWxkcmVuKCdpJykucmVtb3ZlQ2xhc3MoJ3ptLWl0ZW0tdG9wLWJ0bi1jYW5jZWwnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGV2ZW50LnByZXZlbnREZWZhdWx0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5jYW5jZWxCdWJibGU9dHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSlbMF0uY2hlY2tlZD1mYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoaVpoaWh1LlF1aWNrRmF2by5QaW5uZWRMaXN0W2xpZF0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHBpbi5jbGljaygpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgkJCQkJfSk7CgkJCQl9CgkJCX0pOwoJCX0KCX0pOwoKICAgIHJldHVybiB0aGlzOwp9CgovKioKICogQGNsYXNzIFNlYXJjaGluZ0xpc3QKICovCmZ1bmN0aW9uIFNlYXJjaGluZ0xpc3QoaVpoaWh1KSB7CiAgICBpZiAoIHR5cGVvZiBpWmhpaHUgPT09ICd1bmRlZmluZWQnIHx8ICFpWmhpaHUpIHsKICAgICAgICByZXR1cm4gbnVsbAogICAgfQogICAgaVpoaWh1LlNlYXJjaGluZ0xpc3QgPSB0aGlzCiAgICAKICAgIHRoaXMuJHRvcFNlYXJjaCA9ICQoJyN6aC10b3Atc2VhcmNoLWZvcm0nKQogICAgdGhpcy4kdG9wU2VhcmNoSW5wdXQgPSAkKCcjemgtdG9wLXNlYXJjaC1mb3JtID4gaW5wdXQjcScpCiAgICBpZiAoIXRoaXMuJHRvcFNlYXJjaC5sZW5ndGgpIHJldHVybgoKICAgIHRoaXMuU2VhcmNoRW5naW5lT3V0c2lkZUxpc3QgPSB7CiAgICAgICAgJ2dvb2dsZSc6IHtpY29uOidodHRwczovL3d3dy5nb29nbGUuY29tL2Zhdmljb24uaWNvJyx1cmw6J2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vP3E9c2l0ZTp6aGlodS5jb20lMjB7MH0jcT1zaXRlOnpoaWh1LmNvbSt7MH0nfQogICAgICAsICdiYWlkdSc6IHtpY29uOidodHRwOi8vd3d3LmJhaWR1LmNvbS9mYXZpY29uLmljbycsdXJsOidodHRwOi8vd3d3LmJhaWR1LmNvbS9zP3dkPXNpdGU6emhpaHUuY29tJTIwezB9J30KICAgIH0KCiAgICB1dGlscy5vYnNlcnZlRE9NTm9kZUFkZGVkKHRoaXMuJHRvcFNlYXJjaFswXSxmdW5jdGlvbihldmVudCl7CiAgICAgICAgdmFyIF9hID0gZXZlbnQuYWRkZWROb2RlcyB8fCBbXQogICAgICAgIGlmICghX2EubGVuZ3RoKSByZXR1cm4KICAgICAgICB1dGlscy5vYnNlcnZlRE9NTm9kZUFkZGVkKF9hWzBdLGZ1bmN0aW9uKGV2ZW50KXtjb25zb2xlLmxvZyhpWmhpaHUuY29uZmlnWydTZWFyY2hFbmdpbmVPdXRzaWRlJ10pCiAgICAgICAgICAgIHZhciBfYSA9IGV2ZW50LmFkZGVkTm9kZXMgfHwgW251bGxdCiAgICAgICAgICAgICAgLCAkaXRlbSA9ICQoX2FbMF0pCiAgICAgICAgICAgICAgLCBzZW9LZXkgPSBpWmhpaHUuY29uZmlnWydTZWFyY2hFbmdpbmVPdXRzaWRlJ10gfHwgJ2JhaWR1JwogICAgICAgICAgICAgICwgc2VvID0gaVpoaWh1LlNlYXJjaGluZ0xpc3QuU2VhcmNoRW5naW5lT3V0c2lkZUxpc3Rbc2VvS2V5XSB8fCB7aWNvbjonJyx1cmw6Jyd9CiAgICAgICAgICAgICAgLCBzdHJTZWFyY2hVcmwgPSBzZW8udXJsLnJlcGxhY2UoL1x7MFx9L2csIGZ1bmN0aW9uKCl7cmV0dXJuIGlaaGlodS5TZWFyY2hpbmdMaXN0LiR0b3BTZWFyY2hJbnB1dC52YWwoKX0pCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlb0tleSkKICAgICAgICAgICAgaWYgKCRpdGVtLmlzKCcuYWMtcm93W3JvbGU9b3B0aW9uXScpKXsKICAgICAgICAgICAgICAgIHZhciAkYSA9ICRpdGVtLmNoaWxkcmVuKCdhJykKICAgICAgICAgICAgICAgICAgLCBocmVmID0gJGEuYXR0cignaHJlZicpCiAgICAgICAgICAgICAgICAgICwgY3NzID0gJ2Zsb2F0OnJpZ2h0O2JhY2tncm91bmQtcG9zaXRpb246LTI4NHB4IC0ycHg7JwogICAgICAgICAgICAgICAgICAsICRhTmV3ID0gJCgnPGE+Jywge2NsYXNzOid6Zy1pY29uJyxzdHlsZTpjc3MsaHJlZjpocmVmLHRhcmdldDonX2JsYW5rJyxjbGljazpmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgICAgICAgICAgICAgfX0pCiAgICAgICAgICAgICAgICBpZiAoaHJlZi5pbmRleE9mKCcvc2VhcmNoPycpID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgJGFOZXcuY3NzKHttYXJnaW5Ub3A6JzAuNWVtJ30pCiAgICAgICAgICAgICAgICAgICAgJGl0ZW0uYXBwZW5kKCQoJzxhPicsIHtjbGFzczonaWNvbicsc3R5bGU6J21hcmdpbi10b3A6MC41ZW07ZmxvYXQ6bGVmdCcsaHJlZjpzdHJTZWFyY2hVcmwsdGFyZ2V0OidfYmxhbmsnLGNsaWNrOmZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkKICAgICAgICAgICAgICAgICAgICB9fSkuYXBwZW5kKCQoJzxpbWc+Jywge2JvcmRlcjowLHNyYzpzZW8uaWNvbix3aWR0aDoxNixoZWlnaHQ6MTZ9KSkpCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhyZWYuaW5kZXhPZignL3F1ZXN0aW9uLycpIDwgMCkgewogICAgICAgICAgICAgICAgICAgICRhTmV3LmNzcyh7bWFyZ2luVG9wOictMS41ZW0nfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRpdGVtLmFwcGVuZCgkYU5ldykKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICB9KQoKICAgIHJldHVybiB0aGlzCn0KCi8qKgogKiBAY2xhc3MgVG9wTmF2CiAqLwpmdW5jdGlvbiBUb3BOYXYoaVpoaWh1KSB7CiAgICBpZiAoIHR5cGVvZiBpWmhpaHUgPT09ICd1bmRlZmluZWQnIHx8ICFpWmhpaHUgfHwgIWlaaGlodS5jb25maWdbJ1RvcE5hdkF1dG9Gb2xkJ10pIHsKICAgICAgICByZXR1cm4gbnVsbAogICAgfQogICAgaVpoaWh1LlRvcE5hdiA9IHRoaXMKICAgIAogICAgdGhpcy4kdG9wTmF2ID0gJCgnYm9keSA+IC56dS10b3A6Zmlyc3QnKQogICAgICAgIC5vbignbW91c2VvdmVyJywgZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICB0aGlzLnN0eWxlLnRvcCA9ICcwJwogICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZSgnaXpoLW1vdXNlb3ZlcicsICcxJykKICAgICAgICAgICAgJCgnI2l6aENTU19Ob3RpTnVtJykucmVtb3ZlKCkKICAgICAgICB9KQogICAgICAgIC5vbignbW91c2VvdXQnLCBmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKCdpemgtbW91c2VvdmVyJywgJzAnKQogICAgICAgICAgICBpWmhpaHUuVG9wTmF2LmZ1bmNGb2xkKCkKICAgICAgICB9KQogICAgaWYgKCF0aGlzLiR0b3BOYXYubGVuZ3RoKSByZXR1cm4KCiAgICB0aGlzLnRvcE5hdkhlaWdodCA9IHRoaXMuJHRvcE5hdi5oZWlnaHQoKSAtIDUKCiAgICB0aGlzLmZ1bmNGb2xkID0gZnVuY3Rpb24oZXZlbnQpewogICAgICAgIHZhciBzY3JvbGxUb3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIHx8IDAKICAgICAgICAgICwgX3NlbGYgPSBpWmhpaHUuVG9wTmF2CiAgICAgICAgICAsIGlzTW91c2VPdmVyID0gJzEnID09PSAoX3NlbGYuJHRvcE5hdi5hdHRyKCdpemgtbW91c2VvdmVyJykgfHwgJycpCiAgICAgICAgICAsICRoZWFkID0gJCgnaGVhZDpmaXJzdCcpCiAgICAgICAgICAsICRjc3NOb3RpTnVtID0gJCgnI2l6aENTU19Ob3RpTnVtJykKICAgICAgICAgICwgJGZsb2F0aW5nQmFyID0gJCgnYm9keSA+IC5nb29nLXNjcm9sbGZsb2F0ZXItZmxvYXRpbmcnKQogICAgICAgIGlmIChzY3JvbGxUb3AgPT09IDApIHsKICAgICAgICAgICAgX3NlbGYuJHRvcE5hdi5jc3Moe3RvcDowfSkKICAgICAgICB9IGVsc2UgaWYgKCFpc01vdXNlT3ZlcikgewogICAgICAgICAgICBpZiAoc2Nyb2xsVG9wIDwgX3NlbGYudG9wTmF2SGVpZ2h0KSB7CiAgICAgICAgICAgICAgICBfc2VsZi4kdG9wTmF2LmNzcyh7dG9wOi1zY3JvbGxUb3B9KQogICAgICAgICAgICAgICAgJGZsb2F0aW5nQmFyLmNzcyh7bWFyZ2luVG9wOi1zY3JvbGxUb3B9KQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX3NlbGYuJHRvcE5hdi5jc3Moe3RvcDotX3NlbGYudG9wTmF2SGVpZ2h0fSkKICAgICAgICAgICAgICAgICRmbG9hdGluZ0Jhci5jc3Moe21hcmdpblRvcDotX3NlbGYudG9wTmF2SGVpZ2h0fSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2Nyb2xsVG9wID4gMjApIHsKICAgICAgICAgICAgICAgIGlmICghJGNzc05vdGlOdW0ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnPHN0eWxlPicsIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdpemhDU1NfTm90aU51bScKICAgICAgICAgICAgICAgICAgICAgICwgdHlwZTogJ3RleHQvY3NzJwogICAgICAgICAgICAgICAgICAgIH0pLmFwcGVuZFRvKCdoZWFkOmZpcnN0JykudGV4dCgnI3poLXRvcC1uYXYtY291bnQsI3poLXRvcC1uYXYtbmV3LXBte3Bvc2l0aW9uOmFic29sdXRlO3RvcDo0MHB4O2JvcmRlci1yYWRpdXM6MCAhaW1wb3J0YW50fS50b3AtbmF2LXByb2ZpbGUgLnp1LXRvcC1uYXYtdXNlcmluZm97b3ZlcmZsb3c6dmlzaWJsZSAhaW1wb3J0YW50fScpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAkY3NzTm90aU51bS5yZW1vdmUoKQogICAgfQoKICAgIGlaaGlodS4kd2luLnNjcm9sbCh0aGlzLmZ1bmNGb2xkKQoKICAgIHRoaXMub25Ob2RlQWRkZWQgPSBmdW5jdGlvbihldmVudCl7CiAgICAgICAgaVpoaWh1LlRvcE5hdi5mdW5jRm9sZCgpCiAgICAgICAgJC5lYWNoKGV2ZW50LnJlbW92ZWROb2RlcywgZnVuY3Rpb24oaSwgZSl7CiAgICAgICAgICAgIHZhciAkZmxvYXRpbmdCYXIgPSAkKGUpLmZpbHRlcignLmdvb2ctc2Nyb2xsZmxvYXRlcicpLmNzcyh7bWFyZ2luVG9wOicnfSkKICAgICAgICB9KQogICAgfQoKICAgIHJldHVybiB0aGlzCn0KCmFsbExpbmtzID0gZnVuY3Rpb24oX25hbWUsIF9saXN0U2VsLCBfbGlzdE5hbWUpIHsKICAgIHRoaXMubmFtZSA9IF9uYW1lCiAgICB0aGlzLmxpc3RTZWwgPSBfbGlzdFNlbAogICAgdGhpcy5saXN0TmFtZSA9IF9saXN0TmFtZQogICAgdGhpcy5kbGdJRCA9ICdpemgtZGxnLScgKyBfbmFtZQogICAgdGhpcy4kZGxnID0gbnVsbAogICAgdmFyIF9pbml0aWFsVGl0bGUgPSBfbGlzdE5hbWUgKyAn5Zyw5Z2A5riF5Y2VJwogICAgICAsIF9yZXN1bHQgPSBuZXcgQXJyYXkoKQogICAgICAsIF9sb2FkVGltZXMgPSAwCgogICAgLy/liIbmnpDlhoXlrrkKICAgIHZhciBwcm9jZXNzTm9kZSA9IGZ1bmN0aW9uKGNvbnRlbnQsJGRsZyl7CiAgICAgIHZhciAkcUN1cnJlbnQgPSBudWxsOwogICAgICAkKCcuem0taXRlbS1hbnN3ZXInLCBjb250ZW50KS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBpdGVtKXsKICAgICAgICB2YXIgJGEgPSAkKGl0ZW0pCiAgICAgICAgICAsICRxID0gJGEuY2xvc2VzdCgiLnptLWl0ZW0iKS5jaGlsZHJlbigiaDIiKS5jaGlsZHJlbigiYSIpCiAgICAgICAgOwogICAgICAgIGlmKCRxLmxlbmd0aCl7CiAgICAgICAgICAkcUN1cnJlbnQ9JHE7CiAgICAgICAgfWVsc2UgaWYoJHFDdXJyZW50KXsKICAgICAgICAgICRxPSRxQ3VycmVudDsKICAgICAgICB9ZWxzZXsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdmFyIGhyZWZRdWVzdGlvbiA9IHVybC5kYXRhLmF0dHJbImJhc2UiXSArICRxLmF0dHIoImhyZWYiKS5yZXBsYWNlKHVybC5kYXRhLmF0dHJbImJhc2UiXSwnJyk7CiAgICAgICAgdmFyIG9iaiA9IHsKICAgICAgICAgICAgdGl0bGU6ICRxLnRleHQoKSwKICAgICAgICAgICAgLy9xdWVzdGlvblVybDogaHJlZlF1ZXN0aW9uLAogICAgICAgICAgICBhbnN3ZXJVcmw6IGhyZWZRdWVzdGlvbiArICgkYS5wYXJlbnQoKS5pcygiLnptLWl0ZW0tZmF2IikgPyAiL2Fuc3dlci8iICsgJGEuYXR0cigiZGF0YS1hdG9rZW4iKSA6ICIiKSwKICAgICAgICAgICAgYW5zd2VyQXV0aG9yOiAkYS5maW5kKCcuem0taXRlbS1hbnN3ZXItYXV0aG9yLXdyYXAgYVtocmVmXj0iL3Blb3BsZSJdJykudGV4dCgpLnRyaW0oKSwKICAgICAgICAgICAgc3VtbWFyeTogJGEuZmluZCgiLnptLWl0ZW0tYW5zd2VyLXN1bW1hcnkiKS5jaGlsZHJlbigpLnJlbW92ZSgpLmVuZCgpLnRleHQoKSwKICAgICAgICAgICAgY29udGVudDogJGEuZmluZCgiLnptLWVkaXRhYmxlLWNvbnRlbnQiKS5odG1sKCkKICAgICAgICB9OwogICAgICAgIF9yZXN1bHQucHVzaChvYmopOwogICAgICAgIHZhciBzdHJUaXRsZSA9IHV0aWxzLmZvcm1hdFN0cignKiDjgIp7dGl0bGV944CLJiMxMzsqIHthbnN3ZXJBdXRob3J977yaJiMxMzsqIHtzdW1tYXJ5fScsIG9iaikKICAgICAgICAgICwgc3RyVVJMID0gdXRpbHMuZm9ybWF0U3RyKCd7YW5zd2VyVXJsfScsIG9iaikKICAgICAgICAgICwgJGxpID0gJCgnPGxpPicpLmFwcGVuZCgkKCc8YT4nLCB7IGhyZWY6IHN0clVSTCwgdGl0bGU6IHN0clRpdGxlIH0pLnRleHQoc3RyVVJMKSkuY3NzKHsgJ2xpc3Qtc3R5bGUtdHlwZSc6ICdub25lJyB9KQogICAgICAgICQoJy5pemhpaHUtY29sbGVjdGlvbi1saW5rcycsJGRsZykuYXBwZW5kKCRsaSk7CiAgICAgICAgdmFyIGNvdW50PV9yZXN1bHQubGVuZ3RoOwogICAgICAgICQoJy5pemhpaHUtY29sbGVjdGlvbi1pbmZvJywkZGxnKS50ZXh0KCfvvIjliqrlipvliqDovb3kuK0uLi7lt7LlvpfliLDorrDlvZUgJyArIGNvdW50ICsgJyDmnaHvvIknKTsKICAgICAgfSk7CiAgICB9OwogICAgICAgIAogICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbihwYWdlV2FudCxwYWdlTm93LCRkbGcpewogICAgICBpZiAoIXBhZ2VOb3cpcGFnZU5vdz0xOwogICAgICBpZigkZGxnLmlzKCc6aGlkZGVuJykpewogICAgICAgIHZhciBjb3VudD1fcmVzdWx0Lmxlbmd0aDsKICAgICAgICAkKCcuaXpoaWh1LWNvbGxlY3Rpb24taW5mbycsJGRsZykudGV4dCgn77yI5Yqg6L296KKr57uI5q2iLi4u5bey5b6X5Yiw6K6w5b2VICcgKyBjb3VudCArICcg5p2h77yJJyk7CiAgICAgICAgJCgnI3poLWdsb2JhbC1zcGlubmVyJykuaGlkZSgpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAKICAgICAgaWYocGFnZVdhbnQ9PTEpewogICAgICAgICQoJy5pemhpaHUtY29sbGVjdGlvbi1saW5rcycsJGRsZykuZW1wdHkoKTsKICAgICAgICAkKCcjemgtZ2xvYmFsLXNwaW5uZXInKS5zaG93KCk7CiAgICAgICAgX3Jlc3VsdC5sZW5ndGg9MDsKICAgICAgICBfbG9hZFRpbWVzKys7CiAgICAgICAgJCgnLml6aGlodS1jb2xsZWN0aW9uLWluZm8nLCRkbGcpLnRleHQoJycpOwogICAgICB9CiAgICAgIHZhciAkcGFnZXI9JChfbGlzdFNlbCkucGFyZW50KCkuZmluZCgnLnptLWludml0ZS1wYWdlcicpCiAgICAgICAgLCAkbGFzdFBhZ2U9JHBhZ2VyLmNoaWxkcmVuKCdzcGFuJykubGFzdCgpLnByZXYoKQogICAgICAgICwgdG90YWxDb3VudD0kcGFnZXIubGVuZ3RoPT0wPzE6TnVtYmVyKCRsYXN0UGFnZS50ZXh0KCkpCiAgICAgIDsKICAgICAgaWYocGFnZVdhbnQ+dG90YWxDb3VudCl7CiAgICAgICAgJCgnLml6aGlodS1jb2xsZWN0aW9uLWluZm8nLCRkbGcpLnRleHQoJ++8iOWKoOi9veWujOaIkO+8jOWFseW+l+WIsOiusOW9lSAnICsgX3Jlc3VsdC5sZW5ndGggKyAnIOadoe+8iScpOwogICAgICAgICQoJyN6aC1nbG9iYWwtc3Bpbm5lcicpLmhpZGUoKTsKICAgICAgICAkKCcuc2VsQWxsJywkZGxnKS5jbGljaygpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBhZ2VOZXh0PXBhZ2VXYW50KzE7CiAgICAgIGlmKHBhZ2VXYW50PT1wYWdlTm93KXsKICAgICAgICBwcm9jZXNzTm9kZSgkKF9saXN0U2VsKS5odG1sKCksJGRsZyk7CiAgICAgICAgaGFuZGxlcihwYWdlTmV4dCxwYWdlTm93LCRkbGcpCiAgICAgIH1lbHNlewogICAgICAgIHZhciBfdXJsPXVybC5kYXRhLmF0dHJbJ2Jhc2UnXSt1cmwuZGF0YS5hdHRyWydwYXRoJ10rJz9wYWdlPScrcGFnZVdhbnQ7CiAgICAgICAgJC5hamF4KF91cmwse3R5cGU6J2dldCcsY29udGV4dDp7bG9hZFRpbWVzOl9sb2FkVGltZXN9fSkuZG9uZShmdW5jdGlvbihyZXN1bHQpewogICAgICAgICAgaWYodGhpcy5sb2FkVGltZXMhPV9sb2FkVGltZXMpcmV0dXJuOwogICAgICAgICAgcHJvY2Vzc05vZGUocmVzdWx0LCRkbGcpOwogICAgICAgICAgaGFuZGxlcihwYWdlTmV4dCxwYWdlTm93LCRkbGcpCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CgogICAgLy/liJ3lp4vljJblvLnlh7rmoYYKICAgIHRoaXMuaW5pdERpYWxvZyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgdGhpcy4kZGxnPSQoJyMnK3RoaXMuZGxnSUQpOwogICAgICAgIHZhciByZXRWYWw9MDx0aGlzLiRkbGcubGVuZ3RoOwogICAgICAgIGlmKCFyZXRWYWwpewogICAgICAgICAgICB0aGlzLiRkbGcgPSAkKCc8ZGl2PicsIHsgaWQ6IHRoaXMuZGxnSUQsICdjbGFzcyc6ICdtb2RhbC1kaWFsb2cgYWxsTGlua3MnLCB0YWJpbmRleDogJzAnLCBzdHlsZTogJ2Rpc3BsYXk6IG5vbmU7d2lkdGg6NTAwcHgnLCBuYW1lOiBfbmFtZSwgJ2xpc3RTZWwnOiBfbGlzdFNlbCB9KQogICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8ZGl2PicsIHsgJ2NsYXNzJzogJ21vZGFsLWRpYWxvZy10aXRsZSBtb2RhbC1kaWFsb2ctdGl0bGUtZHJhZ2dhYmxlJyB9KQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHNwYW4+JywgeyAnY2xhc3MnOiAnbW9kYWwtZGlhbG9nLXRpdGxlLXRleHQnIH0pLnRleHQoX2luaXRpYWxUaXRsZSkpCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8c3Bhbj4nLCB7ICdjbGFzcyc6ICdtb2RhbC1kaWFsb2ctdGl0bGUtdGV4dCBpemhpaHUtY29sbGVjdGlvbi1pbmZvJyB9KSkKICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxzcGFuPicsIHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzogJ21vZGFsLWRpYWxvZy10aXRsZS1jbG9zZScKICAgICAgICAgICAgICAgICAgICAgICwgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI3poLWdsb2JhbC1zcGlubmVyJykuaGlkZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcubW9kYWwtZGlhbG9nLWJnJykuaGlkZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJy5tb2RhbC1kaWFsb2cnKS5oaWRlKCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8ZGl2PicsIHsgJ2NsYXNzJzogJ21vZGFsLWRpYWxvZy1jb250ZW50JyB9KQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGRpdj4nKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXY+JywgeyAnY2xhc3MnOiAnemctc2VjdGlvbicgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGRpdj4nLCB7ICdjbGFzcyc6ICdpemhpaHUtY29sbGVjdGlvbi1saW5rcyB6Zy1mb3JtLXRleHQtaW5wdXQnLCB0YWJJbmRleDogJy0xJywgc3R5bGU6ICdoZWlnaHQ6MzAwcHg7b3ZlcmZsb3cteTpzY3JvbGw7b3V0bGluZTpub25lOycgfSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxmb3JtPicsIHsgYWN0aW9uOiAnaHR0cDovL2lsb3ZlemhpaHUuZHVhcHAuY29tL3NhdmVNZS5weScsIG1ldGhvZDogJ3Bvc3QnLCB0YXJnZXQ6ICdfYmxhbmsnLCBzdHlsZTogJ2Rpc3BsYXk6bm9uZScgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZXh0YXJlYT4nLCB7IHN0eWxlOiAid2lkdGg6IDEwMCU7IiwgbmFtZTogImxpbmtzIiwgJ2NsYXNzJzogIml6aGlodS1jb2xsZWN0aW9uLWxpbmtzLXBvc3QiIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGlucHV0PicsIHsgbmFtZTogJ3RpdGxlJyB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXY+JywgeyAnY2xhc3MnOiAnem0tY29tbWFuZCcgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGRpdj4nLCB7ICdjbGFzcyc6ICd6Zy1sZWZ0JyB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGE+JywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2xhc3MnOiAnemctYnRuLWJsdWUgcmVsb2FkJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBocmVmOiAnamF2YXNjcmlwdDp2b2lkKDApOycKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRkID0gJCh0aGlzKS5jbG9zZXN0KCcubW9kYWwtZGlhbG9nJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIoMSwgTnVtYmVyKHVybC5kYXRhLnBhcmFtLnF1ZXJ5WydwYWdlJ10pLCAkZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRleHQoJ+mHjeaWsOiOt+WPlicpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8YT4nLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NsYXNzJzogJ3pnLWJ0bi1ibHVlIHNhdmUnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgaHJlZjogJ2phdmFzY3JpcHQ6dm9pZCgwKTsnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGRsZyA9ICQodGhpcykuY2xvc2VzdCgnLm1vZGFsLWRpYWxvZy1jb250ZW50JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRsaW5rcyA9ICRkbGcuZmluZCgnLml6aGlodS1jb2xsZWN0aW9uLWxpbmtzJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRsaW5rc1Bvc3QgPSAkZGxnLmZpbmQoJy5pemhpaHUtY29sbGVjdGlvbi1saW5rcy1wb3N0JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRsaW5rc1RpdGxlID0gJGxpbmtzUG9zdC5uZXh0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRmb3JtID0gJGxpbmtzUG9zdC5wYXJlbnQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgbGlua3MgPSAnJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsaW5rcy5maW5kKCdsaSBhJykuZWFjaChmdW5jdGlvbihpLCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rcyArPSBlLmdldEF0dHJpYnV0ZSgnaHJlZicpICsgJ1xuJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGlua3NQb3N0LnZhbChsaW5rcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxpbmtzVGl0bGUudmFsKCQoJyN6aC1mYXYtaGVhZC10aXRsZSwuem0tcHJvZmlsZS1oZWFkZXItbWFpbiAudGl0bGUtc2VjdGlvbiBhLm5hbWUnKS50ZXh0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmb3JtLnN1Ym1pdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkudGV4dCgn5L+d5a2YJykpCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpCiAgICAgICAgICAgICAgICAuZHJhZ2dhYmxlKHsgaGFuZGxlOiAnLm1vZGFsLWRpYWxvZy10aXRsZS1kcmFnZ2FibGUnIH0pCgogICAgICAgICAgICBpZih0aGlzLiRkbGcubGVuZ3RoKQogICAgICAgICAgICAgICAgcmV0VmFsID0gdHJ1ZQoKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJldFZhbAogICAgfQoKICAgIHRoaXMuc3RhcnQgPSBmdW5jdGlvbigkZCkgewogICAgICAgIGlmICgkKCcjemgtZ2xvYmFsLXNwaW5uZXI6dmlzaWJsZScpLmxlbmd0aCkgcmV0dXJuCiAgICAgICAgaWYgKCEkZCkgJGQgPSB0aGlzLiRkbGcKICAgICAgICBpZiAoISRkKSByZXR1cm4KICAgICAgICBpZiAoISQoJy5pemhpaHUtY29sbGVjdGlvbi1saW5rcycsICRkKS5jaGlsZHJlbigpLmxlbmd0aCkgewogICAgICAgICAgICBoYW5kbGVyKDEsIE51bWJlcih1cmwuZGF0YS5wYXJhbS5xdWVyeVsncGFnZSddKSwgJGQpCiAgICAgICAgfQogICAgfQoKfQoKLyoqCiAqIOWbnuetlOmhtQogKi8KCiAgaWYocGFnZUlzLkFuc3dlcil7Cgp2YXIgJGxibFF1ZXN0aW9uTWV0YT0kKCcjemgtcXVlc3Rpb24tbWV0YS13cmFwJykvL3F1ZXN0aW9uX21ldGEKOwoKICAgIHZhciAkcXVlc3Rpb25XcmFwPSQoJyN6aC1xdWVzdGlvbi1tZXRhLXdyYXAnKTsKICAgICRxdWVzdGlvbldyYXAuY2hpbGRyZW4oJy5wYW5lbC1jb250YWluZXInKS5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICB3aW5kb3cuaVpoaWh1LkNvbW1lbnQucHJvY2Vzc0NvbW1lbnQoJChldmVudC50YXJnZXQpKTsKICAgIH0pOwogICAgaWYod2luZG93LmlaaGlodS5Db21tZW50LlJpZ2h0Q29tbWVudCl7CiAgICAgICAgLy8kcXVlc3Rpb25XcmFwLmNoaWxkcmVuKCcubWV0YS1pdGVtW25hbWU9YWRkY29tbWVudF0nKS5wcmVwZW5kVG8oJHF1ZXN0aW9uV3JhcCk7CiAgICAgICAgd2luZG93LmlaaGlodS5Db21tZW50LnByb2Nlc3NDb21tZW50QnV0dG9uKCRxdWVzdGlvbldyYXApOwogICAgICAgIGlmKCEkKCcjaXpoX1F1ZXN0aW9uU2hhZG93JykubGVuZ3RoKXsKICAgICAgICAgICAgJCgnPGRpdj4nLHsnY2xhc3MnOidpemhfYm94U2hhZG93JyxpZDonaXpoX1F1ZXN0aW9uU2hhZG93J30pLmNzcyh7CiAgICAgICAgICAgICAgICAnei1pbmRleCc6ICctMScKICAgICAgICAgICAgICAsICdwb3NpdGlvbic6ICdyZWxhdGl2ZScKICAgICAgICAgICAgICAsICd0b3AnOiAtMjUKICAgICAgICAgICAgICAsICdtYXJnaW4tbGVmdCc6IC0zMgogICAgICAgICAgICB9KS5wcmVwZW5kVG8oJ2JvZHk+Lnp1LW1haW46Zmlyc3QnKS5oaWRlKCk7CiAgICAgICAgfSAgIAogICAgfQoKICAgIC8vcHJvY2VzcyBlYWNoIGFuc3dlcgogICAgdmFyICRsaXN0QW5zd2Vycz0kKCcuem0taXRlbS1hbnN3ZXIsLmZlZWQtaXRlbScsJyN6aC1xdWVzdGlvbi1hbnN3ZXItd3JhcCcpOwogICAgaWYoJGxpc3RBbnN3ZXJzJiYkbGlzdEFuc3dlcnMubGVuZ3RoKXsKICAgICAgICAkbGlzdEFuc3dlcnMuZWFjaChmdW5jdGlvbihpLGUpewogICAgICAgICAgICB3aW5kb3cuaVpoaWh1LkFuc3dlci5wcm9jZXNzQW5zd2VyKCQoZSksbnVsbAogICAgICAgICAgICAgICwgaXpoQXV0aG9yUmVhcgogICAgICAgICAgICAgICwgZmFsc2UpOwogICAgICAgIH0pOwogICAgfQoKICAgICQoJyN6aC1xdWVzdGlvbi1hbnN3ZXItd3JhcCcpLmJpbmQoJ0RPTU5vZGVJbnNlcnRlZCcsZnVuY3Rpb24oZXZlbnQpewogICAgICAgIHZhciAkbmE9JChldmVudC50YXJnZXQpLmZpbHRlcignLnptLWl0ZW0tYW5zd2VyJyk7CiAgICAgICAgaWYoJG5hLmxlbmd0aCl7CiAgICAgICAgICAgIHdpbmRvdy5pWmhpaHUuQW5zd2VyLnByb2Nlc3NBbnN3ZXIoJG5hLG51bGwKICAgICAgICAgICAgICAgICwgaXpoQXV0aG9yUmVhcgogICAgICAgICAgICAgICAgLCBmYWxzZSk7CiAgICAgICAgfQogICAgfSk7CgogICAgdmFyICRjbT0kKCcuem0tY29tbWVudC1ib3gnLCRxdWVzdGlvbldyYXApOwogICAgaWYoJGNtLmxlbmd0aCAmJiAkY20uaXMoJzp2aXNpYmxlJykpewogICAgCXZhciBmb2N1c05hbWUgPSBpWmhpaHUuQ29tbWVudC5zY3JvbGxGb2N1c0NvbW1lbnRPblBhZ2VMb2FkKCRjbSk7CgogICAgCWlaaGlodS5Db21tZW50Lm1ldGFTY3JvbGxUb1ZpZXdCb3R0b20oJGNtLmNsb3Nlc3QoJy56bS1pdGVtLW1ldGEnKSxmdW5jdGlvbigpewogICAgICAgICAgICBpWmhpaHUuQ29tbWVudC5wcm9jZXNzQ29tbWVudCgkY20sIGZvY3VzTmFtZSk7CiAgICAgICAgfSk7CiAgICB9CiAgfQoKLyoqCiAqIOaUtuiXj+mhtQogKi8KICBpZihwYWdlSXMuQ29sbGVjdGlvbil7CiAgICAvL+a3u+WKoOaMiemSrgogICAgJCgnI3poLWxpc3QtbWV0YS13cmFwJykKICAgICAgLmFwcGVuZCgkKCc8c3Bhbj4nLCB7ICdjbGFzcyc6ICd6Zy1idWxsJyB9KS50ZXh0KCfigKInKSkKICAgICAgLmFwcGVuZCgkKCc8YT4nLCB7IGhyZWY6ICdqYXZhc2NyaXB0OjsnLCBpZDogJ2dldEFsbExpbmtzJyB9KS50ZXh0KCflnLDlnYDmuIXljZUnKSk7CgogICAgdmFyIGJ0biA9ICQoJyNnZXRBbGxMaW5rcycpOwogICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICAgIAogICAgLy/ms6jlhozngrnlh7vkuovku7YKICAgIGJ0bi5jbGljayhmdW5jdGlvbigpewogICAgICB2YXIgYWxsTGlua3NDb2xsZWN0aW9uPW5ldyBhbGxMaW5rcygnQ29sbGVjdGlvbnMnLCcjemgtbGlzdC1hbnN3ZXItd3JhcCcsJ+aUtuiXj+WkueWGheWuuScpOwoJICBpZighYWxsTGlua3NDb2xsZWN0aW9uLmluaXREaWFsb2coKSlyZXR1cm47CiAgICAgICQoJy5tb2RhbC1kaWFsb2ctYmcnKS5zaG93KCk7CiAgICAgIHZhciB5ID0gKCR3aW4uaGVpZ2h0KCkgLSBhbGxMaW5rc0NvbGxlY3Rpb24uJGRsZy53aWR0aCgpKSAvIDIKICAgICAgICAsIHggPSAoJHdpbi53aWR0aCgpIC0gYWxsTGlua3NDb2xsZWN0aW9uLiRkbGcud2lkdGgoKSkgLyAyCiAgICAgIDsKICAgICAgYWxsTGlua3NDb2xsZWN0aW9uLiRkbGcuY3NzKHsndG9wJzogeSwgJ2xlZnQnOiB4fSkuZmFkZUluKCdzbG93Jyk7CiAgICAgIGFsbExpbmtzQ29sbGVjdGlvbi5zdGFydCgpOwogICAgfSk7CiAgfQogIGlmKHBhZ2VJcy5BbnN3ZXJzKXsKICAgIC8v5re75Yqg5oyJ6ZKuCiAgICAkKCcuem0tcHJvZmlsZS1zZWN0aW9uLW5hbWUnKQogICAgICAuYXBwZW5kKCQoJzxzcGFuPicsIHsgJ2NsYXNzJzogJ3pnLWJ1bGwnIH0pLnRleHQoJ+KAoicpKQogICAgICAuYXBwZW5kKCQoJzxhPicsIHsgaHJlZjogJ2phdmFzY3JpcHQ6OycsIGlkOiAnZ2V0QWxsTGlua3MnIH0pLnRleHQoJ+WcsOWdgOa4heWNlScpKTsKCiAgICB2YXIgYnRuID0gJCgnI2dldEFsbExpbmtzJyk7CiAgICB2YXIgcmVzdWx0ID0gW107CiAgICAgICAgCiAgICAvL+azqOWGjOeCueWHu+S6i+S7tgogICAgYnRuLmNsaWNrKGZ1bmN0aW9uKCl7CiAgICAgIHZhciBhbGxMaW5rc0Fuc3dlcnM9bmV3IGFsbExpbmtzKCdBbnN3ZXJzJywnI3poLXByb2ZpbGUtYW5zd2VyLWxpc3QnLCfnlKjmiLflm57nrZQnKTsKCSAgaWYoIWFsbExpbmtzQW5zd2Vycy5pbml0RGlhbG9nKCkpcmV0dXJuOwogICAgICAkKCcubW9kYWwtZGlhbG9nLWJnJykuc2hvdygpOwogICAgICB2YXIgeSA9ICgkd2luLmhlaWdodCgpIC0gYWxsTGlua3NBbnN3ZXJzLiRkbGcud2lkdGgoKSkgLyAyCiAgICAgICAgLCB4ID0gKCR3aW4ud2lkdGgoKSAtIGFsbExpbmtzQW5zd2Vycy4kZGxnLndpZHRoKCkpIC8gMgogICAgICA7CiAgICAgIGFsbExpbmtzQW5zd2Vycy4kZGxnLmNzcyh7J3RvcCc6IHksICdsZWZ0JzogeH0pLmZhZGVJbignc2xvdycpOwogICAgICBhbGxMaW5rc0Fuc3dlcnMuc3RhcnQoKTsKICAgIH0pOwogIH0KCiAgaWYocGFnZUlzLk15Q29sbGVjdGlvbiYmd2luZG93LmlaaGlodS5RdWlja0Zhdm8pewogICAgdmFyICRmYXZJdGVtcz0kKCcjemgtZmF2bGlzdHMtd3JhcCcpLmNoaWxkcmVuKCcuem0taXRlbScpOwogICAgJGZhdkl0ZW1zLmVhY2goZnVuY3Rpb24oaSxlKXsKICAgIH0pOwogIH0KCi8qCiAqIOmmlumhtQogKi8KICAgIHZhciAkdG9wc3Rvcnk9JCgnI2lzLXRvcHN0b3J5MicpCiAgICAgICwgaXNUb3BTdG9yeT0kdG9wc3RvcnkmJiR0b3BzdG9yeS5sZW5ndGgKICAgICAgLCBwcm9wRmVlZFR5cGU9J2RhdGEtdHlwZScvLzonZGF0YS1mZWVkdHlwZScKICAgICAgLCAkbGJsSG9tZVRpdGxlPSQoJyN6aC1ob21lLWxpc3QtdGl0bGUnKS8vYWN0aXZpdHlfY2FwdGlvbgogICAgICAsICRidG5OZXdBY3Rpdml0eT0kKCcjemgtbWFpbi1mZWVkLWZyZXNoLWJ1dHRvbicpLy9uZXdfYWN0aXZpdHkKICAgICAgLCAkZmVlZExpc3Q9JCgnLnpoLWdlbmVyYWwtbGlzdCcpLy9mZWVkX2xpc3QKICAgICAgLCAkdG9wTGlua0hvbWU9JCgnI3poLXRvcC1saW5rLWhvbWUnKQogICAgICAsICRmaWx0ZXI9Ly9pc1RvcFN0b3J5PwogICAgICAgICAgICAkKCc8c3Bhbj4nLCB7ICdjbGFzcyc6J2l6aC1mZWVkcy1maWx0ZXInIH0pCiAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxhPicsIHsgJ2NsYXNzJzogJ2l6aC1idXR0b24gaXpoLWZlZWRzLWZpbHRlci1vcHRpb24nLCAnc2hvd0ZlZWRzJzogJ3EnIH0pCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICd6Zy1pY29uJyB9KSkKICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCfpl67popgnKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8YT4nLCB7ICdjbGFzcyc6ICdpemgtYnV0dG9uIGl6aC1mZWVkcy1maWx0ZXItb3B0aW9uJywgJ3Nob3dGZWVkcyc6ICdhJyB9KQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGk+JywgeyAnY2xhc3MnOiAnemctaWNvbicgfSkpCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgn5Zue562UJykKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGE+JywgeyAnY2xhc3MnOiAnaXpoLWJ1dHRvbiBpemgtZmVlZHMtZmlsdGVyLW9wdGlvbicsICdzaG93RmVlZHMnOiAncCxyJywgJ2RhdGEtdGlwJzogJ3MkdCTkuJPmoI/jgIHlnIbmoYwnIH0pCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICd6Zy1pY29uJyB9KSkKICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCflhbbku5YnKQogICAgICAgICAgICAgICAgKQogICAgICAsICRmaWx0ZXJJbmZvPSQoJzxhPicseydjbGFzcyc6J2l6aC1mZWVkcy1maWx0ZXItaW5mbyBub3RoaW5nJyxocmVmOidqYXZhc2NyaXB0OnZvaWQoMCk7J30pLm9uKCdjbGljaycsZnVuY3Rpb24oKXskZmlsdGVyLnRyaWdnZXIoJGZpbHRlci5pcygnOmhpZGRlbicpfHwkZmlsdGVyLmF0dHIoJ2RvaW5nJyk9PSdoaWRlJz8nc2hvdyc6J2hpZGUnKTt9KQogICAgICAsIFNob3dGZWVkcz1mdW5jdGlvbih0eXBlLGVuYWJsZSl7CiAgICAgICAgICAgIHZhciBpZD0iaXpoQ1NTX0ZpbHRlckZlZWRfIit0eXBlCiAgICAgICAgICAgICAgLCBuZD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkKICAgICAgICAgICAgOwogICAgICAgICAgICBpZihlbmFibGUpewogICAgICAgICAgICAgICAgaWYobmQpbmQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChuZCk7CiAgICAgICAgICAgIH1lbHNlIGlmKGhlYWRzLmxlbmd0aCl7CiAgICAgICAgICAgICAgICBpZighbmQpewogICAgICAgICAgICAgICAgICAgIG5kPV9kb2MuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgICAgICAgICAgICAgICBuZC50eXBlPSd0ZXh0L2Nzcyc7CiAgICAgICAgICAgICAgICAgICAgbmQuaWQ9aWQ7CiAgICAgICAgICAgICAgICAgICAgbmQuYXBwZW5kQ2hpbGQoX2RvYy5jcmVhdGVUZXh0Tm9kZSgnLmZlZWQtaXRlbVsnK3Byb3BGZWVkVHlwZSsnXj0iJyt0eXBlKyciXXtkaXNwbGF5Om5vbmV9JykpOwogICAgICAgICAgICAgICAgICAgIGhlYWRzWzBdLmFwcGVuZENoaWxkKG5kKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8ve1JPVU5EVEFCTEVfQUREX1JFTEFURUQ6ICJyb3VuZHRhYmxlIixBUlRJQ0xFX1ZPVEVfVVA6ICJwb3N0X3ZvdGUiLEFSVElDTEVfQ1JFQVRFOiAicG9zdF9jcmVhdGUiLFJFQ09NTUVOREVEOiAiZmVlZF9yZWNvbW1lbmRlZCIsUVVFU1RJT05fRk9MTE9XOiAiZmVlZF9xdWVzdGlvbl9mb2xsb3ciLFFVRVNUSU9OX0NSRUFURTogImZlZWRfcXVlc3Rpb24iLEFOU1dFUl9WT1RFX1VQOiAiZmVlZF9hbnN3ZXJfdm90ZSIsQU5TV0VSX0NSRUFURTogImZlZWRfYW5zd2VyX2Fuc3dlciJ9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAsIHJlZnJlc2hGaWx0ZXJJbmZvPWZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBjb3VudD0kZmVlZExpc3QuY2hpbGRyZW4oJy5mZWVkLWl0ZW06aGlkZGVuJykubGVuZ3RoCiAgICAgICAgICAgICAgLCBpbmZvPScgPui/h+a7pOmAiemhuTwnCiAgICAgICAgICAgIDsKICAgICAgICAgICAgaWYoY291bnQpewogICAgICAgICAgICAgICAgaW5mbz0n77yIJytjb3VudCsn5p2h5Yqo5oCB6KKr6ZqQ6JeP77yJJzsKICAgICAgICAgICAgICAgICRmaWx0ZXJJbmZvLnJlbW92ZUNsYXNzKCdub3RoaW5nJykuY3NzKHtkaXNwbGF5OicnfSk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgJGZpbHRlckluZm8uYWRkQ2xhc3MoJ25vdGhpbmcnKTsKICAgICAgICAgICAgfSAgIAogICAgICAgICAgICAkZmlsdGVySW5mby50ZXh0KGluZm8pOwogICAgICAgIH0KICAgICAgLCBmZWVkc0NvbHVtbnM9ZnVuY3Rpb24oKXsgLy8gSW1wbGVtZW50ZWQgYnkgbW9ybGV5LCBtb2RpZmllZCBieSB1bm9negogICAgICAgICAgICAvL+WKqOaAgeeahOexu+WeiwogICAgICAgICAgICB2YXIgZmVlZFR5cGVzID0gLy9pc1RvcFN0b3J5PwogICAgICAgICAgICAgICAgW3sKICAgICAgICAgICAgICAgICBpbmRleDogMCwKICAgICAgICAgICAgICAgICBuYW1lOiAn5YWo6YOoJywKICAgICAgICAgICAgICAgICBjb2RlTmFtZTogJycKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICBpbmRleDogMSwKICAgICAgICAgICAgICAgICBuYW1lOiAn6Zeu6aKYJywKICAgICAgICAgICAgICAgICBjb2RlTmFtZTogJ3EnCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgaW5kZXg6IDIsCiAgICAgICAgICAgICAgICAgbmFtZTogJ+WbnuetlCcsCiAgICAgICAgICAgICAgICAgY29kZU5hbWU6ICdhJwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgIGluZGV4OiAzLAogICAgICAgICAgICAgICAgIG5hbWU6ICfkuJPmoI8nLAogICAgICAgICAgICAgICAgIGNvZGVOYW1lOiAncCcKICAgICAgICAgICAgICAgIH1dOwogICAgICAgICAgICAKICAgICAgICAgICAgLy/oh6rlrprkuYkgQ1NTIOWIsCBoZWFkCiAgICAgICAgICAgIHZhciBzdHlsZXMgPSBbXTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHN0eWxlcy5wdXNoKCcuemEtZmlsdGVye2Rpc3BsYXk6IGlubGluZS1ibG9jazttYXJnaW4tcmlnaHQ6MTBweDtjdXJzb3I6cG9pbnRlcjtjb2xvcjojOTk5O30nKTsKICAgICAgICAgICAgc3R5bGVzLnB1c2goJy56YS1maWx0ZXIuYWN0aXZle2NvbG9yOiMyNTk7fScpOwogICAgICAgICAgICBzdHlsZXMucHVzaCgnLnphLWZpbHRlcj4uemctbnVtLmhpZGV7ZGlzcGxheTpub25lO30nKTsKICAgICAgICAgICAgCiAgICAgICAgICAgICQoJzxzdHlsZS8+JykudGV4dChzdHlsZXMuam9pbignJykpLmFwcGVuZFRvKCdoZWFkJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgJHpoSG9tZUxpc3RUaXRsZSA9ICRsYmxIb21lVGl0bGU7CiAgICAgICAgICAgIAogICAgICAgICAgICAvL+agueaNruexu+Wei+a3u+WKoOi/h+a7pOaMiemSriDliLAgI3poLWhvbWUtbGlzdC10aXRsZQogICAgICAgICAgICB2YXIgZmlsdGVyQnRucyA9IFtdCiAgICAgICAgICAgICAgLCBpID0gZmVlZFR5cGVzLmxlbmd0aDsKICAgICAgICAgICAgCiAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgIGZpbHRlckJ0bnMucHVzaCgKICAgICAgICAgICAgICAgICAkKCc8c3Bhbj4nKS5hZGRDbGFzcygnemEtZmlsdGVyJykKICAgICAgICAgICAgICAgICAuYXR0cigndHlwZUluZGV4JywgZmVlZFR5cGVzW2ldLmluZGV4KQogICAgICAgICAgICAgICAgIC50ZXh0KGZlZWRUeXBlc1tpXS5uYW1lKQogICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHNwYW4+JywgeyAnY2xhc3MnOiAnemctbnVtJyB9KS5hZGRDbGFzcygnaGlkZScpKQogICAgICAgICAgICAgICAgIC5vbignY2xpY2snLCB0b2dnbGVGZWVkVHlwZSkKICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZpbHRlckJ0bnMucmV2ZXJzZSgpOwogICAgICAgICAgICBmaWx0ZXJCdG5zWzBdLmFkZENsYXNzKCdhY3RpdmUnKTsKCiAgICAgICAgICAgICR6aEhvbWVMaXN0VGl0bGUuY29udGVudHMoKS5maWx0ZXIoZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgICAgIHJldHVybiAoZSE9bnVsbCYmKGUubm9kZVZhbHVlfHwnJykuaW5kZXhPZign5pyA5paw5Yqo5oCBJyk+PTApCiAgICAgICAgICAgIH0pLnJlbW92ZSgpCiAgICAgICAgICAgICR6aEhvbWVMaXN0VGl0bGUuZmluZCgnaScpLmVxKDApLmFmdGVyKGZpbHRlckJ0bnMpLnJlbW92ZSgpOwogICAgICAgICAgICAKICAgICAgICAgICAgdmFyICR0YXJnZXRaZXJvID0gZmlsdGVyQnRuc1swXS5maW5kKCcuemctbnVtJykKICAgICAgICAgICAgICAsIGN1cmZlZWRUeXBlQ29kZU5hbWUgPSAnJwogICAgICAgICAgICAKICAgICAgICAgICAgZnVuY3Rpb24gdHlwZU1hdGNoKCRlbGVtKSB7CiAgICAgICAgICAgICBpZiAoY3VyZmVlZFR5cGVDb2RlTmFtZSA9PSAnJykgewogICAgICAgICAgICAgICAgICRlbGVtLnNob3coKTsKICAgICAgICAgICAgIH0gZWxzZSBpZiAoMCA8PSAkZWxlbS5hdHRyKHByb3BGZWVkVHlwZSkuaW5kZXhPZihjdXJmZWVkVHlwZUNvZGVOYW1lKSkgewogICAgICAgICAgICAgICAgICRlbGVtLnNob3coKTsKICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgJGVsZW0uaGlkZSgpOwogICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvL+aMiemSruS6i+S7tgogICAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVGZWVkVHlwZSgpIHsKICAgICAgICAgICAgIHZhciAkY2xpY2tlZCA9ICQodGhpcyk7CiAgICAgICAgICAgICAkY2xpY2tlZE51bSA9ICRjbGlja2VkLmZpbmQoJy56Zy1udW0nKTsKICAgICAgICAgICAgIC8vIOS6pOS6kuaViOaenAogICAgICAgICAgICAgZmlsdGVyQnRucy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgICAgICAgICAgICBpdGVtLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTsKICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgICRjbGlja2VkLmFkZENsYXNzKCdhY3RpdmUnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgICBpZiAoJGNsaWNrZWQuYXR0cigndHlwZUluZGV4JykgPT0gMCkgewogICAgICAgICAgICAgICAgICQoJy56Zy1udW0nLCAnLnphLWZpbHRlcicpLnRleHQoJycpLmFkZENsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgIHZhciB0b3RhbFVucmVhZCA9IChwYXJzZUludCgkdGFyZ2V0WmVyby50ZXh0KCkpIHx8IDApIC0gKHBhcnNlSW50KCRjbGlja2VkTnVtLnRleHQoKSkgfHwgMCk7CiAgICAgICAgICAgICAgICAgaWYgKHRvdGFsVW5yZWFkICE9IDApIHsKICAgICAgICAgICAgICAgICAgICAgJHRhcmdldFplcm8udGV4dCh0b3RhbFVucmVhZCk7CiAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgJHRhcmdldFplcm8udGV4dCgnJykuYWRkQ2xhc3MoJ2hpZGUnKTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICRjbGlja2VkTnVtLnRleHQoJycpLmFkZENsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBjdXJmZWVkVHlwZUNvZGVOYW1lID0gZmVlZFR5cGVzWyRjbGlja2VkLmF0dHIoJ3R5cGVJbmRleCcpXS5jb2RlTmFtZTsKICAgICAgICAgICAgIC8vIOS/oeaBr+a1gei/h+a7pAogICAgICAgICAgICAgJCgnLmZlZWQtaXRlbScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgdHlwZU1hdGNoKCQodGhpcykpOwogICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFR5cGVJbmRleEJ5Q29kZU5hbWUoY29kZU5hbWUpIHsKICAgICAgICAgICAgIHZhciBpID0gZmVlZFR5cGVzLmxlbmd0aDsKICAgICAgICAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICAgICAgICAgICBpZiAoY29kZU5hbWUgPT0gZmVlZFR5cGVzW2ldLmNvZGVOYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpOwogICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7CiAgICAgICAgICAgIAogICAgICAgICAgICAvL+ebkeWQrOaOqOmAgQogICAgICAgICAgICB2YXIgaGFzTmV3RmVlZCA9IGZhbHNlOwogICAgICAgICAgICAvL2NyZWF0ZSBhbiBvYnNlcnZlciBpbnN0YW5jZQogICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnMpIHsKICAgICAgICAgICAgIGlmICggISEgcGFyc2VJbnQoJGJ0bk5ld0FjdGl2aXR5LnRleHQoKSkpIHsKICAgICAgICAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbihtdXRhdGlvbikgewogICAgICAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdIYXMgTmV3IEZlZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOacieaWsOaOqOmAgeWImeinpuWPkeS5iwogICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmV3RmVlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAkYnRuTmV3QWN0aXZpdHkudGV4dCgnJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAkLndoZW4oJGJ0bk5ld0FjdGl2aXR5WzBdLmNsaWNrKCkpLmRvbmUoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmV3RmVlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgLy9wYXNzIGluIHRoZSB0YXJnZXQgbm9kZSwgYXMgd2VsbCBhcyB0aGUgb2JzZXJ2ZXIgb3B0aW9ucwogICAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKAogICAgICAgICAgICAgJGJ0bk5ld0FjdGl2aXR5WzBdLCB7CiAgICAgICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlCiAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8v55uR5ZCs5o+S5YWlCiAgICAgICAgICAgICRmZWVkTGlzdC5vbigiRE9NTm9kZUluc2VydGVkIiwgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgdmFyICRzZWxmID0gJChlLnRhcmdldCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAgaWYgKCRzZWxmLmhhc0NsYXNzKCdmZWVkLWl0ZW0nKSkgewogICAgICAgICAgICAgICAgIGlmIChoYXNOZXdGZWVkKSB7CiAgICAgICAgICAgICAgICAgICAgICRzZWxmLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgdmFyICR0YXJnZXQgPSBmaWx0ZXJCdG5zW2dldFR5cGVJbmRleEJ5Q29kZU5hbWUoJHNlbGYuYXR0cihwcm9wRmVlZFR5cGUpKV0uZmluZCgnLnpnLW51bScpOwogICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0LnRleHQoKHBhcnNlSW50KCR0YXJnZXQudGV4dCgpKSB8fCAwKSArIDEpLnJlbW92ZUNsYXNzKCdoaWRlJyk7CiAgICAgICAgICAgICAgICAgICAgICR0YXJnZXRaZXJvLnRleHQoKHBhcnNlSW50KCR0YXJnZXRaZXJvLnRleHQoKSkgfHwgMCkgKyAxKS5yZW1vdmVDbGFzcygnaGlkZScpOwogICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgIHR5cGVNYXRjaCgkc2VsZik7CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAsIGhvbWVGZWVkcz1mdW5jdGlvbihpemhIb21lRmVlZHNDb2x1bW5zKXsKICAgICAgICAgICAgaWYgKGl6aEhvbWVGZWVkc0NvbHVtbnMpewogICAgICAgICAgICAgICAgZmVlZHNDb2x1bW5zKCk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgJGZpbHRlci5jaGlsZHJlbignLml6aC1mZWVkcy1maWx0ZXItb3B0aW9uJykuYWRkQ2xhc3MoJ29uJykuY2xpY2soZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgICAgIHZhciBpPTAKICAgICAgICAgICAgICAgICAgICAgICwgJGU9JCh0aGlzKQogICAgICAgICAgICAgICAgICAgICAgLCBmcz0kZS5hdHRyKCdzaG93RmVlZHMnKQogICAgICAgICAgICAgICAgICAgICAgLCBmYT1mcy5zcGxpdCgnLCcpCiAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICQoJy5pemgtZmVlZHMtZmlsdGVyLW9wdGlvbltzaG93RmVlZHM9IicrZnMrJyJdJykudG9nZ2xlQ2xhc3MoJ29uJyk7CiAgICAgICAgICAgICAgICAgICAgZm9yKDtpPGZhLmxlbmd0aDtpKyspewogICAgICAgICAgICAgICAgICAgICAgICBTaG93RmVlZHMoZmFbaV0sJGUuaXMoJy5vbicpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaEZpbHRlckluZm8oKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYoJHRvcExpbmtIb21lLmxlbmd0aCl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRmaWx0ZXIyPSQoJzxkaXY+JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jc3Moe3Bvc2l0aW9uOidhYnNvbHV0ZScsYm9yZGVyOicxcHggc29saWQgIzc3NycsYmFja2dyb3VuZENvbG9yOicjZmZmJ30pLmhpZGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkZmlsdGVyLmNsb25lKHRydWUsdHJ1ZSkuY3NzKHtkaXNwbGF5OidibG9jayd9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbignc2hvdycsZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGU9JCh0aGlzKS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGUuaXMoJzpoaWRkZW4nKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGUuY3NzKHtkaXNwbGF5OicnLG9wYWNpdHk6MH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGUuYW5pbWF0ZSh7b3BhY2l0eToxfSwnc2xvdycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbignaGlkZScsZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGU9JCh0aGlzKS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGUuZmFkZU91dCgnc2xvdycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgJHRvcExpbmtIb21lLmFmdGVyKCRmaWx0ZXIyKS5wYXJlbnQoKQogICAgICAgICAgICAgICAgICAgICAgICAub24oJ21vdXNlZW50ZXInLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZT0kKHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgJGY9JGUuY2hpbGRyZW4oKS5sYXN0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmLnRyaWdnZXIoJ3Nob3cnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmaWx0ZXJJbmZvLmZpbHRlcignLm5vdGhpbmcnKS5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignbW91c2VsZWF2ZScsZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRlPSQodGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkZj0kZS5jaGlsZHJlbigpLmxhc3QoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGYudHJpZ2dlcignaGlkZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZpbHRlckluZm8uZmlsdGVyKCcubm90aGluZycpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZigkbGJsSG9tZVRpdGxlLmxlbmd0aCl7CiAgICAgICAgICAgICAgICAgICAgJGZpbHRlckluZm8uY3NzKHsKICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTonbm9uZScKICAgICAgICAgICAgICAgICAgICAgICwgdGV4dERlY29yYXRpb246J25vbmUnCiAgICAgICAgICAgICAgICAgICAgICAsIGN1cnNvcjoncG9pbnRlcicKICAgICAgICAgICAgICAgICAgICB9KS5pbnNlcnRCZWZvcmUoaXNUb3BTdG9yeT8kdG9wc3Rvcnk6JCgnI2ZlZWQtdmVyJykpOwogICAgICAgICAgICAgICAgICAgICRsYmxIb21lVGl0bGUuY3NzKHtvdmVyZmxvdzonaGlkZGVuJ30pCiAgICAgICAgICAgICAgICAgICAgICAgIC5wcmVwZW5kKCRmaWx0ZXIpCiAgICAgICAgICAgICAgICAgICAgICAgIC8vLmNoaWxkcmVuKCdpOmZpcnN0JykKICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCdtb3VzZWVudGVyJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGU9JCh0aGlzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICRmPSRlLmNoaWxkcmVuKCcuaXpoLWZlZWRzLWZpbHRlci1pbmZvLm5vdGhpbmcnKS5zdG9wKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRmLmlzKCc6aGlkZGVuJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGYuY3NzKHtkaXNwbGF5OicnLG9wYWNpdHk6MH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZi5hbmltYXRlKHtvcGFjaXR5OjF9LCdmYXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignbW91c2VsZWF2ZScsZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRlPSQodGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkZj0kZS5jaGlsZHJlbignLml6aC1mZWVkcy1maWx0ZXItaW5mby5ub3RoaW5nJykuc3RvcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZi5mYWRlT3V0KCdmYXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICRmaWx0ZXIuY3NzKHttYXJnaW5MZWZ0Oi0kZmlsdGVyLndpZHRoKCksZGlzcGxheTonbm9uZSd9KQogICAgICAgICAgICAgICAgICAgICAgICAub24oJ3Nob3cnLGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGU9JCh0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRlLmF0dHIoJ2RvaW5nJyk9PT0nc2hvdycpcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGUuYXR0cignZG9pbmcnLCdzaG93Jykuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGUuaXMoJzpoaWRkZW4nKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZS5jc3Moe2Rpc3BsYXk6Jyd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGUuYW5pbWF0ZSh7bWFyZ2luTGVmdDowfSwnc2xvdycsZnVuY3Rpb24oKXskKHRoaXMpLmNzcygnZGlzcGxheScsJycpLnJlbW92ZUF0dHIoJ2RvaW5nJyk7fSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignaGlkZScsZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkZT0kKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGUuYXR0cignZG9pbmcnKT09PSdoaWRlJylyZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZS5hdHRyKCdkb2luZycsJ2hpZGUnKS5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZS5hbmltYXRlKHttYXJnaW5MZWZ0Oi0kZmlsdGVyLndpZHRoKCl9LCdzbG93JyxmdW5jdGlvbigpeyQodGhpcykuY3NzKCdkaXNwbGF5Jywnbm9uZScpLnJlbW92ZUF0dHIoJ2RvaW5nJyk7fSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignbW91c2VlbnRlcicsZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRlPSQodGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlLnRyaWdnZXIoJ3Nob3cnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCdtb3VzZWxlYXZlJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGU9JCh0aGlzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGUudHJpZ2dlcignaGlkZScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICByZWZyZXNoRmlsdGVySW5mbygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgOwogICAgaWYocGFnZUlzLkhvbWV8fHBhZ2VJcy5EZWJ1dHMpewogICAgICAgICRmZWVkTGlzdC5maW5kKCcuZmVlZC1pdGVtJykuZWFjaChmdW5jdGlvbihpLGUpewogICAgICAgICAgICB3aW5kb3cuaVpoaWh1LkFuc3dlci5wcm9jZXNzQW5zd2VyKCQoZSksbnVsbAogICAgICAgICAgICAgICwgaXpoQXV0aG9yUmVhcgogICAgICAgICAgICAgICwgaXpoQXV0aG9yTGlzdAogICAgICAgICAgICApOwogICAgICAgIH0pOwogICAgICAgICRmZWVkTGlzdC5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgdmFyICRpdGVtPSQoZXZlbnQudGFyZ2V0KTsKICAgICAgICAgICAgaWYoJGl0ZW0uaXMoJy5mZWVkLWl0ZW0nKSl7CiAgICAgICAgICAgICAgICB3aW5kb3cuaVpoaWh1LkFuc3dlci5wcm9jZXNzQW5zd2VyKCRpdGVtLG51bGwKICAgICAgICAgICAgICAgICAgLCAkYm9keS5hdHRyKCdpemhBdXRob3JSZWFyJyk9PScxJwogICAgICAgICAgICAgICAgICAsICRib2R5LmF0dHIoJ2l6aEF1dGhvckxpc3QnKT09JzEnCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgcmVmcmVzaEZpbHRlckluZm8oKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIGlmIChwYWdlSXMuSG9tZSl7CiAgICAJdmFyIGJIb21lRmVlZHNDb2x1bW5zPXdpbmRvdy5pWmhpaHUuY29uZmlnWydIb21lRmVlZHNDb2x1bW5zJ10KICAgICAgICBpZiAoaXpoSG9tZU5vdGkmJiFiSG9tZUZlZWRzQ29sdW1ucwogICAgICAgICAmJiAkbGJsSG9tZVRpdGxlLmxlbmd0aAogICAgICAgICAmJiAkYnRuTmV3QWN0aXZpdHkubGVuZ3RoCiAgICAgICAgKXsKICAgICAgICAgICAgJGxibEhvbWVUaXRsZS5jc3MoewogICAgICAgICAgICAgICAgJ2Zsb2F0JzonbGVmdCcKICAgICAgICAgICAgICAsICdtYXJnaW4tYm90dG9tJzonMnB4JwogICAgICAgICAgICAgICwgJ2xpbmUtaGVpZ2h0JzonMzJweCcKICAgICAgICAgICAgICAsICd3aWR0aCc6JzEwMCUnCiAgICAgICAgICAgICAgfSkubmV4dCgpLmNzcygnY2xlYXInLCdib3RoJyk7CiAgICAgICAgICAgICRidG5OZXdBY3Rpdml0eS5jc3MoewogICAgICAgICAgICAgICAgJ2Zsb2F0JzoncmlnaHQnCiAgICAgICAgICAgICAgLCAnbWFyZ2luJzonMCcKICAgICAgICAgICAgICAsICdsaW5lLWhlaWdodCc6JzIycHgnCiAgICAgICAgICAgIH0pLmFwcGVuZFRvKCRsYmxIb21lVGl0bGUpOwogICAgICAgIH0KICAgICAgICBob21lRmVlZHMoYkhvbWVGZWVkc0NvbHVtbnMpOwogICAgfQoKCi8qKgogKiDpl67popjpobUKICovCgogIGlmKHBhZ2VJcy5RdWVzdGlvbil7CgogICAgdmFyICRsYmxRdWVzdGlvbk1ldGE9JCgnI3poLXF1ZXN0aW9uLW1ldGEtd3JhcCcpLy9xdWVzdGlvbl9tZXRhCiAgICAgICwgJGxpc3RBbnN3ZXJzPSQoJyN6aC1xdWVzdGlvbi1hbnN3ZXItd3JhcCwjemgtcXVlc3Rpb24tY29sbGFwc2VkLXdyYXAnKS5jaGlsZHJlbigpLy8kKCcuem0taXRlbS1hbnN3ZXInLCcjemgtc2luZ2xlLXF1ZXN0aW9uJykKICAgICAgLCBudW1BbnN3ZXJzQ291bnQ9JGxpc3RBbnN3ZXJzLmxlbmd0aAogICAgICAsICRidG5Db2xsYXBzZWRTd2l0Y2hlcj0kKCcjemgtcXVlc3Rpb24tY29sbGFwc2VkLXN3aXRjaGVyJykKICAgICAgLCBudW1Db2xsYXBzZWRDb3VudD0hJGJ0bkNvbGxhcHNlZFN3aXRjaGVyLmxlbmd0aHx8JGJ0bkNvbGxhcHNlZFN3aXRjaGVyLmlzKCc6aGlkZGVuJyk/MDpwYXJzZUludCgkKCcjemgtcXVlc3Rpb24tY29sbGFwc2VkLW51bScpLnRleHQoKSkKICAgICAgLCBudW1BbnN3ZXJzQ291bnRUb3RhbD1udW1BbnN3ZXJzQ291bnQrbnVtQ29sbGFwc2VkQ291bnQKICAgICAgLCAkcmVwbHk9JCgnI3poLXF1ZXN0aW9uLWFuc3dlci1mb3JtLXdyYXAnKS8vcmVwbHlfZm9ybQogICAgOwogICAgaWYoJGxibFF1ZXN0aW9uTWV0YS5sZW5ndGgpewogICAgICAgIHZhciBzPW5ldyBBcnJheSgpCiAgICAgICAgICAsICRhPSQoJzxhPicpCiAgICAgICAgICAsICRjPSQoJzxzcGFuPicseydjbGFzcyc6J3pnLWJ1bGwnfSkudGV4dCgn4oCiJykKICAgICAgICAgICwgJHA9JGxibFF1ZXN0aW9uTWV0YS5jaGlsZHJlbignLnptLW1ldGEtcGFuZWwnKS5jaGlsZHJlbignYS5tZXRhLWl0ZW06bGFzdCcpCiAgICAgICAgICAsICRtPSQoJy56dS1hbnN3ZXItZm9ybS1kaXNhYmxlZC13cmFwOnZpc2libGUgPiBhJywnI3poLXF1ZXN0aW9uLWFuc3dlci1mb3JtLXdyYXAnKQogICAgICAgIDsKICAgICAgICBpZigkbS5sZW5ndGgpewogICAgICAgICAgICBzLnB1c2goJG0uYXR0cignaHJlZicpKTsKICAgICAgICAgICAgJGEudGV4dCgn5oiR55qE5Zue562UJyk7CiAgICAgICAgfWVsc2UgaWYoJHJlcGx5Lmxlbmd0aCl7CiAgICAgICAgICAgIHZhciBpZD0nbmV3X2Fuc3dlcicKICAgICAgICAgICAgICAsICRiPSQoJzxhPicse25hbWU6aWR9KS5iZWZvcmUoJHJlcGx5LmNoaWxkcmVuKCkuZmlyc3QoKSk7CiAgICAgICAgICAgIHMucHVzaCgnI2RyYWZ0Jyk7CiAgICAgICAgICAgICRhLnRleHQoJ+aIkeimgeWbnuetlCcpOwogICAgICAgIH0KICAgICAgICAkYy5pbnNlcnRBZnRlcigkcCk7CiAgICAgICAgJGEuYXR0cignaHJlZicscy5qb2luKCcnKSkuYXR0cigndGFyZ2V0JywnX3NlbGYnKQogICAgICAgICAgICAuaW5zZXJ0QWZ0ZXIoJGMpOwogICAgfQogICAgaWYgKGl6aEF1dGhvckxpc3QmJgogICAgICAgIG51bUFuc3dlcnNDb3VudFRvdGFsPjEwMCYmCiAgICAgICAgY29uZmlybSgn6L+Z5Liq6Zeu6aKY55qE5Zue562U5pWw6L6D5aSa77yM5piv5ZCm5pqC5pe25YWz6Zet44CMaVpoaWh1IOWbnuetlOebruW9leOAje+8nycpKXsKICAgICAgICAvLyQoJyNpemhDU1NfY29tbWVudCcpLnJlbW92ZSgpOwogICAgICAgIC8vcmV0dXJuOwogICAgICAgIGl6aEF1dGhvckxpc3Q9ZmFsc2U7CiAgICAgICAgJGJvZHkuYXR0cignaXpoQXV0aG9yTGlzdCcsJzAnKTsKICAgIH0KICAgIC8vY29uc29sZS5sb2coKG5ldyBEYXRlKCkpLmdldFRpbWUoKSk7CiAgICAKICAgIHZhciAkbGJsQW5zd2Vyc0NvdW50PSQoJyN6aC1xdWVzdGlvbi1hbnN3ZXItbnVtJykvL2Fuc3dlcnNfY291bnQKICAgICAgLCAkdW5vPSQoJzxkaXY+Jyx7J2NsYXNzJzondW5vJyxzdHlsZTonZmxvYXQ6bGVmdCd9KS8vaXpoX0F1dGhvcnNMaXN0CiAgICAgICwgJHBwVD0kKCc8c3Bhbj4nLHsnY2xhc3MnOidtZVQnLHN0eWxlOidkaXNwbGF5Om5vbmUnfSkvL2l6aF9BdXRob3JzTGlzdF9Ub3BTZWxmSW5kaWNhdG9yCiAgICAgICwgJGZybT0kKCc8ZGl2PicseydjbGFzcyc6J2ZyYW1lJ30pLy9pemhfQXV0aG9yc0xpc3RfZnJhbWUKICAgICAgLCAkcHBCPSQoJzxzcGFuPicseydjbGFzcyc6J21lQicsc3R5bGU6J2Rpc3BsYXk6bm9uZSd9KS8vaXpoX0F1dGhvcnNMaXN0X0JvdHRvbVNlbGZJbmRpY2F0b3IKICAgICAgLCAkcHA9JCgnPHVsPicseydjbGFzcyc6J3BwJ30pLy9pemhfQXV0aG9yc0xpc3RfVUwKICAgICAgLCAkcHBJPSQoJzxkaXY+JykKICAgIAogICAgOwoKICAgIHdpbmRvdy5pWmhpaHUuJHVub0Fuc3dlcnMgPSAkdW5vCi8qCiAgICAvL+etlOahiOaMieaXtumXtOaOkuW6jwogICAgaWYodXRpbHMuZ2V0Q2ZnKCdhbnN3ZXJfb3JkZXJCeVRpbWUnKSl7CiAgICAgIGNsaWVudC5jbGljaygnLnpoLWFuc3dlcnMtZmlsdGVyLXBvcHVwIGRpdltkYXRhLWtleT1hZGRlZF90aW1lXScpOwogICAgfQoqLyAgICAKICAgIHZhciAkcXVlc3Rpb25XcmFwPSQoJyN6aC1xdWVzdGlvbi1tZXRhLXdyYXAnKTsKICAgICRxdWVzdGlvbldyYXAuY2hpbGRyZW4oJy5wYW5lbC1jb250YWluZXInKS5iaW5kKCdET01Ob2RlSW5zZXJ0ZWQnLGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICB3aW5kb3cuaVpoaWh1LkNvbW1lbnQucHJvY2Vzc0NvbW1lbnQoJChldmVudC50YXJnZXQpKTsKICAgIH0pOwogICAgaWYod2luZG93LmlaaGlodS5Db21tZW50LlJpZ2h0Q29tbWVudCl7CiAgICAgICAgLy8kcXVlc3Rpb25XcmFwLmNoaWxkcmVuKCcubWV0YS1pdGVtW25hbWU9YWRkY29tbWVudF0nKS5wcmVwZW5kVG8oJHF1ZXN0aW9uV3JhcCk7CiAgICAgICAgd2luZG93LmlaaGlodS5Db21tZW50LnByb2Nlc3NDb21tZW50QnV0dG9uKCRxdWVzdGlvbldyYXApOwogICAgICAgIGlmKCEkKCcjaXpoX1F1ZXN0aW9uU2hhZG93JykubGVuZ3RoKXsKICAgICAgICAgICAgJCgnPGRpdj4nLHsnY2xhc3MnOidpemhfYm94U2hhZG93JyxpZDonaXpoX1F1ZXN0aW9uU2hhZG93J30pLmNzcyh7CiAgICAgICAgICAgICAgICAnei1pbmRleCc6ICctMScKICAgICAgICAgICAgICAsICdwb3NpdGlvbic6ICdyZWxhdGl2ZScKICAgICAgICAgICAgICAsICd0b3AnOiAtMjUKICAgICAgICAgICAgICAsICdtYXJnaW4tbGVmdCc6IC0zMgogICAgICAgICAgICB9KS5wcmVwZW5kVG8oJ2JvZHk+Lnp1LW1haW46Zmlyc3QnKS5oaWRlKCk7CiAgICAgICAgfSAgIAogICAgfQoKICAgIC8vcHJvY2VzcyBlYWNoIGFuc3dlcgogICAgaWYoJGxpc3RBbnN3ZXJzJiYkbGlzdEFuc3dlcnMubGVuZ3RoKXsKICAgICAgICBpZihpemhBdXRob3JMaXN0KXsKICAgICAgICAgICAgJHVuby5hcHBlbmRUbygkYmFubmVyKTsKICAgICAgICAgICAgJHBwVC5hcHBlbmRUbygkdW5vKTsKICAgICAgICAgICAgJGZybS5hcHBlbmRUbygkdW5vKTsKICAgICAgICAgICAgJHBwLmFwcGVuZFRvKCRmcm0pOwogICAgICAgICAgICAkcHBCLmFwcGVuZFRvKCR1bm8pOwogICAgICAgICAgICAvL3Vuby5hcHBlbmRDaGlsZChwcEkpOwogICAgICAgICAgICAkdW5vLiRlbmRPZkxhc3RBPSQoJzxsaT4nKS5hZGRDbGFzcygnZW5kT2ZMYXN0QScpLmFwcGVuZFRvKCRwcCkKICAgICAgICB9CiAgICAgICAgJGxpc3RBbnN3ZXJzLmVhY2goZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgd2luZG93LmlaaGlodS5BbnN3ZXIucHJvY2Vzc0Fuc3dlcigkKGUpLCRwcAogICAgICAgICAgICAgICwgaXpoQXV0aG9yUmVhcgogICAgICAgICAgICAgICwgaXpoQXV0aG9yTGlzdCk7CiAgICAgICAgfSk7CiAgICAgICAgaWYoJHJlcGx5LmNoaWxkcmVuKCcuenUtYW5zd2VyLWZvcm0tZGlzYWJsZWQtd3JhcCcpLmlzKCc6aGlkZGVuJykpewogICAgICAgICAgICB2YXIgJHBwbGE9JCgnPGE+Jyx7aHJlZjonI2RyYWZ0Jyx0YXJnZXQ6J19zZWxmJ30pCiAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0YWJsZT4nLCB7ICdjbGFzcyc6ICdwbHVzJyB9KQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRyPicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicpKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dHI+JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JykpCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxzcGFuPicsIHsgJ2NsYXNzJzogJ25hbWUgZnVuYycgfSkudGV4dCgnLW5ldy0nKSkKICAgICAgICAgICAgICAsICRwcGw9JCgnPGxpPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kKCRwcGxhKQogICAgICAgICAgICAgICAgLmFwcGVuZFRvKCRwcCkKICAgICAgICAgICAgOwogICAgICAgIH0KICAgIH0KICAgIHZhciByZXNpemVBdXRob3JMaXN0PWZ1bmN0aW9uKCRmKXsKICAgICAgICAvLyBBZGp1c3QgQXV0aG9yTGlzdCdzIHNpemUgYW5kIGxvY2F0ZSBpdHMgcG9zaXRpb24KICAgICAgICBpZighJGZ8fCEkZi5sZW5ndGgpcmV0dXJuOwogICAgICAgIHZhciBmcm09JGYuZ2V0KDApOwogICAgICAgIHZhciB3aWR0aD13aW5kb3cuaVpoaWh1LkFuc3dlci5wcFdpZHRoCiAgICAgICAgICAsIGhlaWdodD0kd2luLmhlaWdodCgpLSRtYWluLm9mZnNldCgpLnRvcC0zLSRmLnBvc2l0aW9uKCkudG9wOwogICAgICAgIGlmKGZybS5zY3JvbGxIZWlnaHQ+aGVpZ2h0KXsKICAgICAgICAgICAgJGYuaGVpZ2h0KGhlaWdodCk7CiAgICAgICAgICAgIHdpZHRoKz0yMDsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgJGYuaGVpZ2h0KCcnKTsKICAgICAgICB9CiAgICAgICAgJGYud2lkdGgod2lkdGgpOwogICAgfTsKICAgIGlmKGlzTmFOKG51bUNvbGxhcHNlZENvdW50KSludW1Db2xsYXBzZWRDb3VudD0wOwogICAgaWYoJGxpc3RBbnN3ZXJzLmxlbmd0aHx8bnVtQ29sbGFwc2VkQ291bnQpewogICAgICAgIGlmKGl6aEF1dGhvckxpc3QpewogICAgICAgICAgICAkdW5vLmNzcyh7CiAgICAgICAgICAgICAgICAnZmxvYXQnOidub25lJwogICAgICAgICAgICAgICwgJ2xlZnQnOjktJHVuby53aWR0aCgpCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZighJGJ0bkNvbGxhcHNlZFN3aXRjaGVyLmxlbmd0aCYmIW51bUNvbGxhcHNlZENvdW50KQogICAgICAgICAgICAgICAgcmVzaXplQXV0aG9yTGlzdCgkZnJtKTsKICAgICAgICAgICAgJCgnPGRpdj4nLHsnY2xhc3MnOidtb2RhbC1kaWFsb2ctdGl0bGUnfSkuY3NzKHsKICAgICAgICAgICAgICAgICAgJ2JvcmRlci10b3AtbGVmdC1yYWRpdXMnOjAKICAgICAgICAgICAgfSkuaW5zZXJ0QmVmb3JlKCRwcFQpOwogICAgICAgICAgICAkdW5vLm1vdXNlb3ZlcihmdW5jdGlvbigpewogICAgICAgICAgICAgICAgcmVzaXplQXV0aG9yTGlzdCgkKCcuZnJhbWUnLHRoaXMpKTsKICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdsZWZ0JywnMCcpOwogICAgICAgICAgICB9KS5tb3VzZW91dChmdW5jdGlvbigpewogICAgICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ2xlZnQnLDktJCh0aGlzKS53aWR0aCgpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmKHdpbmRvdy5pWmhpaHUuQW5zd2VyLl9lKXsKICAgICAgICAgICAgICAgICR1bm8uY2hpbGRyZW4oJy5tZVQnKS5jc3MoJ2Rpc3BsYXknLDA+d2luZG93LmlaaGlodS5BbnN3ZXIuX2Uub2Zmc2V0VG9wLSRmcm0uc2Nyb2xsVG9wKCk/Jyc6J25vbmUnKTsKICAgICAgICAgICAgICAgICR1bm8uY2hpbGRyZW4oJy5tZUInKS5jc3MoJ2Rpc3BsYXknLCRmcm0uaGVpZ2h0KCk8d2luZG93LmlaaGlodS5BbnN3ZXIuX2Uub2Zmc2V0VG9wLSRmcm0uc2Nyb2xsVG9wKCkrd2luZG93LmlaaGlodS5BbnN3ZXIuX2Uub2Zmc2V0SGVpZ2h0PycnOidub25lJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYoJGJ0bkNvbGxhcHNlZFN3aXRjaGVyLmxlbmd0aCl7CiAgICAgICAgICAgIGlmKG51bUNvbGxhcHNlZENvdW50PjApewogICAgICAgICAgICAgICAgJCgnI3poLXF1ZXN0aW9uLWNvbGxhcHNlZC13cmFwJykuc2hvdygpLmJpbmQoJ0RPTU5vZGVJbnNlcnRlZCcsZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgICAgIHZhciAkYT0kKGV2ZW50LnRhcmdldCk7CiAgICAgICAgICAgICAgICAgICAgaWYoJGEuaXMoJy56bS1pdGVtLWFuc3dlcicpKXsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmlaaGlodS5BbnN3ZXIucHJvY2Vzc0Fuc3dlcigkYSwkcHAKICAgICAgICAgICAgICAgICAgICAgICAgICAsICRib2R5LmF0dHIoJ2l6aEF1dGhvclJlYXInKT09JzEnCiAgICAgICAgICAgICAgICAgICAgICAgICAgLCAkYm9keS5hdHRyKCdpemhBdXRob3JMaXN0Jyk9PScxJwogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAkKCcuem0taXRlbS1hbnN3ZXJbaXpoX3Byb2Nlc3NlZD0xXScsJyN6aC1xdWVzdGlvbi1jb2xsYXBzZWQtd3JhcCcpLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoY291bnQ9PW51bUNvbGxhcHNlZENvdW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZUF1dGhvckxpc3QoJGZybSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkYnRuQ29sbGFwc2VkU3dpdGNoZXJbMF0uY2xpY2soKTsKICAgICAgICB9CiAgICB9CgogICAgJCgnI3poLXF1ZXN0aW9uLWFuc3dlci13cmFwJykuYmluZCgnRE9NTm9kZUluc2VydGVkJyxmdW5jdGlvbihldmVudCl7CiAgICAgICAgdmFyICRuYT0kKGV2ZW50LnRhcmdldCkuZmlsdGVyKCcuem0taXRlbS1hbnN3ZXInKTsKICAgICAgICBpZigkbmEubGVuZ3RoKXsKICAgICAgICAgICAgd2luZG93LmlaaGlodS5BbnN3ZXIucHJvY2Vzc0Fuc3dlcigkbmEsJHBwCiAgICAgICAgICAgICAgLCAkYm9keS5hdHRyKCdpemhBdXRob3JSZWFyJyk9PScxJwogICAgICAgICAgICAgICwgJGJvZHkuYXR0cignaXpoQXV0aG9yTGlzdCcpPT0nMScKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICB9KTsKICAgIC8vY29uc29sZS5sb2coKG5ldyBEYXRlKCkpLmdldFRpbWUoKSk7CgogICAgdmFyICRjbT0kKCcuem0tY29tbWVudC1ib3gnLCRxdWVzdGlvbldyYXApOwogICAgaWYoJGNtLmxlbmd0aCAmJiAkY20uaXMoJzp2aXNpYmxlJykpewogICAgICAgIHZhciBmb2N1c05hbWUgPSBpWmhpaHUuQ29tbWVudC5zY3JvbGxGb2N1c0NvbW1lbnRPblBhZ2VMb2FkKCRjbSk7CiAgICAKICAgICAgICBpWmhpaHUuQ29tbWVudC5tZXRhU2Nyb2xsVG9WaWV3Qm90dG9tKCRjbS5jbG9zZXN0KCcuem0taXRlbS1tZXRhJyksZnVuY3Rpb24oKXsKICAgICAgICAgICAgaVpoaWh1LkNvbW1lbnQucHJvY2Vzc0NvbW1lbnQoJGNtLCBmb2N1c05hbWUpOwogICAgICAgIH0pOwogICAgfQogIH0KCi8qKgogKiDphY3nva7nlYzpnaIKICovCgogICAgdmFyICRidG5TZXR0aW5ncyA9ICQoJzxsaT4nKQogICAgICAgICAgICAuYXBwZW5kKCQoJzxhPicsIHsgaHJlZjogJ2phdmFzY3JpcHQ6dm9pZCgwKTsnLCB0YWJpbmRleDogJy0xJyB9KQogICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICd6Zy1pY29uIHpnLWljb24tZGQtc2V0dGluZ3MgaXpoaWh1LXNldHRpbmdzJyB9KSkKICAgICAgICAgICAgICAgIC5hcHBlbmQoJ2laaGlodScpCiAgICAgICAgICAgICkuY2xpY2soZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIHZhciAkc2V0dGluZ3MgPSAkKCcjaXpoLWRsZy1zZXR0aW5ncycpCiAgICAgICAgICAgICAgICAkKCcubW9kYWwtZGlhbG9nLWJnJykuc2hvdygpCiAgICAgICAgICAgICAgICAkKCcuaXpoLW9wdGlvbicsICcjaXpoLWRsZy1zZXR0aW5ncycpLmVhY2goZnVuY3Rpb24oaSwgZSl7CiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGUuZ2V0QXR0cmlidXRlKCduYW1lJykKICAgICAgICAgICAgICAgICAgICAgICwgdmFsdWUgPSB1dGlscy5nZXRDZmcoa2V5KQogICAgICAgICAgICAgICAgICAgICAgLCAkZSA9ICQoZSkKICAgICAgICAgICAgICAgICAgICBpZiAoJGUuaXMoJ2lucHV0OmNoZWNrYm94JykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGUpLmlDaGVjaygnY2hlY2snKQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJGUuaXMoJ3NlbGVjdCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGUudmFsdWUgPSB2YWx1ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAkc2V0dGluZ3MuY3NzKHsKICAgICAgICAgICAgICAgICAgICAnei1pbmRleCc6Jzk5JwogICAgICAgICAgICAgICAgICAsICdwb3NpdGlvbic6J2ZpeGVkJwogICAgICAgICAgICAgICAgICAsICd0b3AnOiAoJHdpbi5oZWlnaHQoKSAtICRzZXR0aW5ncy5oZWlnaHQoKSkgLyAyCiAgICAgICAgICAgICAgICAgICwgJ2xlZnQnOiAoJHdpbi53aWR0aCgpIC0gJHNldHRpbmdzLndpZHRoKCkpIC8gMgogICAgICAgICAgICAgICAgfSkuZmFkZUluKCdzbG93JykKICAgICAgICAgICAgfSkuaW5zZXJ0QmVmb3JlKCQoJ3VsI3RvcC1uYXYtcHJvZmlsZS1kcm9wZG93biBsaTpsYXN0JykpCiAgICAgICwgJGRsZ1NldHRpbmdzID0gJCgnPGRpdj4nLCB7IGlkOiAnaXpoLWRsZy1zZXR0aW5ncycsICdjbGFzcyc6ICdtb2RhbC1kaWFsb2cnLCB0YWJpbmRleDogJzAnLCBzdHlsZTogJ2Rpc3BsYXk6bm9uZTt3aWR0aDo2MDBweCd9KQogICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXY+JywgeyAnY2xhc3MnOiAnbW9kYWwtZGlhbG9nLXRpdGxlIG1vZGFsLWRpYWxvZy10aXRsZS1kcmFnZ2FibGUnIH0pCiAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxzcGFuPicsIHsgJ2NsYXNzJzogJ21vZGFsLWRpYWxvZy10aXRsZS10ZXh0JyB9KS50ZXh0KCfphY3nva7pgInpobknKSkKICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHNwYW4+JywgewogICAgICAgICAgICAgICAgICAgICdjbGFzcyc6ICdtb2RhbC1kaWFsb2ctdGl0bGUtY2xvc2UnCiAgICAgICAgICAgICAgICAgICwgY2xpY2s6IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5tb2RhbC1kaWFsb2ctYmcnKS5oaWRlKCkKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2l6aC1kbGctc2V0dGluZ3MnKS5maXJzdCgpLmhpZGUoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICApCiAgICAgICAgICAgIC5hcHBlbmQoJCgnPGRpdj4nLCB7ICdjbGFzcyc6ICdtb2RhbC1kaWFsb2ctY29udGVudCcgfSkKICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGRpdj4nLCB7fSkKICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXY+JywgeyAnY2xhc3MnOiAnemctc2VjdGlvbicgfSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGFibGU+JywgeyAnY2xhc3MnOiAndF9zZXRfdGInLCBib3JkZXI6IDAsIGNlbGxzcGFjaW5nOiAwLCBjZWxscGFkZGluZzogNSwgd2lkdGg6ICcxMDAlJyB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGhlYWQ+Jywge30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dHI+Jywge30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgY29sc3BhbjogNiwgYWxpZ246ICdsZWZ0JyB9KS50ZXh0KCfvvIjmm7TmlLnlkI7orr7nva7lsIbnq4vliLvkv53lrZjvvIzkvYblj6rmnInlvZPpobXpnaLlho3mrKHmiZPlvIDml7bmiY3kvJrnlJ/mlYjvvIknKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAJLnByZXBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAkJJCgnPGI+JykudGV4dCgn5Yqf6IO95byA5YWzJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAJCSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRib2R5PicsIHt9KQovKgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRyPicsIHt9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGNvbHNwYW46IDQsIGFsaWduOiAnbGVmdCcgfSkudGV4dCgn5Zyo6aaW6aG155u05o6l5rWP6KeI5bi45Y676K+d6aKYJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICdpY29uIGljb24taGVscCcsICdkYXRhLXRpcCc6ICIifSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBhbGlnbjogJ3JpZ2h0J30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxpbnB1dD4nLCB7IHR5cGU6ICJjaGVja2JveCIsICdjbGFzcyc6ICJpemgtb3B0aW9uIiwgaWQ6ICJpWmhpaHVfc2V0SG9tZVRvcGljcyIsIG5hbWU6ICJIb21lVG9waWNzIiB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0cj4nLCB7fSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBjb2xzcGFuOiA0LCBhbGlnbjogJ2xlZnQnIH0pLnRleHQoJ+aUueWPmOe9kemhteagt+W8j+WkluingicpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGk+JywgeyAnY2xhc3MnOiAnaWNvbiBpY29uLWhlbHAnLCAnZGF0YS10aXAnOiAicyR0JCog6aaW6aG16ZqQ6JeP5aSn5aS05YOPPGJyLz4qIOe8qei/m+aKleelqOaMiemSru+8iOmXrumimC/lm57nrZTpobXvvIk8YnIvPiog5oyJ6ZKu5Zu+5qCH5Yqo55S7ICJ9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGlucHV0PicsIHsgdHlwZTogImNoZWNrYm94IiwgJ2NsYXNzJzogIml6aC1vcHRpb24iLCBpZDogImlaaGlodV9zZXRIb21lTGF5b3V0IiwgbmFtZTogIkhvbWVMYXlvdXQiIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRyPicsIHt9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGNvbHNwYW46IDQsIGFsaWduOiAnbGVmdCcgfSkudGV4dCgn6Ieq5Yqo5pS26LW35a+86Iiq5qCPJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICdpY29uIGljb24taGVscCcsICdkYXRhLXRpcCc6ICJzJHQkKiDmu5rliqjpobXpnaLoh7PkuIvmlrnml7bvvIzoh6rliqjmlLbotbfpobbpg6jlr7zoiKrmoI8gIn0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aW5wdXQ+JywgeyB0eXBlOiAiY2hlY2tib3giLCAnY2xhc3MnOiAiaXpoLW9wdGlvbiIsIGlkOiAiaVpoaWh1X3NldFRvcE5hdkF1dG9Gb2xkIiwgbmFtZTogIlRvcE5hdkF1dG9Gb2xkIiB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0cj4nLCB7fSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBjb2xzcGFuOiA0LCBhbGlnbjogJ2xlZnQnIH0pLnRleHQoJ+iwg+aVtOmmlumhteOAjOaWsOWKqOaAgeOAjeaPkOmGkuaMiemSricpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGk+JywgeyAnY2xhc3MnOiAnaWNvbiBpY29uLWhlbHAnLCAnZGF0YS10aXAnOiAicyR0JOaMquWIsCBUaW1lbGluZSDlj7PkuIrop5I8YnIvPuS4juagh+mimOOAjOacgOaWsOWKqOaAgeOAjeW5s+ihjCJ9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGlucHV0PicsIHsgdHlwZTogImNoZWNrYm94IiwgJ2NsYXNzJzogIml6aC1vcHRpb24iLCBpZDogImlaaGlodV9zZXRIb21lTm90aSIsIG5hbWU6ICJIb21lTm90aSIgfSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dHI+Jywge30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgY29sc3BhbjogNCwgYWxpZ246ICdsZWZ0JyB9KS50ZXh0KCflvIDlkK/jgIzpppbpobXliIbmoI/jgI0nKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBhbGlnbjogJ3JpZ2h0J30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxpPicsIHsgJ2NsYXNzJzogJ2ljb24gaWNvbi1oZWxwJywgJ2RhdGEtdGlwJzogInMkdCTlsIbpppbpobXliqjmgIHliIbnsbvljZXni6zmmL7npLrvvJo8YnIvPumXrumimOOAgeWbnuetlOOAgeS4k+agjyJ9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGlucHV0PicsIHsgdHlwZTogImNoZWNrYm94IiwgJ2NsYXNzJzogIml6aC1vcHRpb24iLCBpZDogImlaaGlodV9zZXRIb21lRmVlZHNDb2x1bW5zIiwgbmFtZTogIkhvbWVGZWVkc0NvbHVtbnMiIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRyPicsIHt9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGNvbHNwYW46IDQsIGFsaWduOiAnbGVmdCcgfSkudGV4dCgn5bCG55So5oi35L+h5oGv5oyq5Yiw5Zue562U5LiL5pa5JykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICdpY29uIGljb24taGVscCcsICdkYXRhLXRpcCc6ICIifSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBhbGlnbjogJ3JpZ2h0J30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxpbnB1dD4nLCB7IHR5cGU6ICJjaGVja2JveCIsICdjbGFzcyc6ICJpemgtb3B0aW9uIiwgaWQ6ICJpWmhpaHVfc2V0QXV0aG9yUmVhciIsIG5hbWU6ICJBdXRob3JSZWFyIiB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0cj4nLCB7fSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBhbGlnbjogJ2xlZnQnIH0pLnRleHQoJ+W8gOWQr+OAjOWPs+iIt+ivhOiuuuOAjScpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGk+JywgeyAnY2xhc3MnOiAnaWNvbiBpY29uLWhlbHAnLCAnZGF0YS10aXAnOiAicyR0JOWcqOmhtemdouWPs+S+p+a1ruWKqOaYvuekuuaJk+W8gOeahOivhOiuuuWIl+ihqDxici8+5Zyo6aaW6aG144CB6Zeu6aKY44CB5Zue562U6aG15Lit55Sf5pWIIn0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aW5wdXQ+JywgeyB0eXBlOiAiY2hlY2tib3giLCAnY2xhc3MnOiAiaXpoLW9wdGlvbiIsIGlkOiAiaVpoaWh1X3NldFJpZ2h0Q29tbWVudCIsIG5hbWU6ICJTaG93Q29tbWVudCIgfSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyB3aWR0aDogMSwgbm93cmFwOiAnbm93cmFwJywgYWxpZ246ICdsZWZ0JyB9KS50ZXh0KCflhbPpl63ml7boh6rliqjljbflsY/oh7Plr7nlupTmnaHnm64nKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBhbGlnbjogJ3JpZ2h0J30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxpPicsIHsgJ2NsYXNzJzogJ2ljb24gaWNvbi1oZWxwJywgJ2RhdGEtdGlwJzogInMkdCTku4Xlr7nlj7PoiLfor4TorrrnlJ/mlYgifSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBhbGlnbjogJ3JpZ2h0J30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxpbnB1dD4nLCB7IHR5cGU6ICJjaGVja2JveCIsICdjbGFzcyc6ICJpemgtb3B0aW9uIiwgaWQ6ICJpWmhpaHVfc2V0UmlnaHRDb21tZW50X0F1dG9TY3JvbGxQYWdlV2hlbkNsb3NpbmciLCBuYW1lOiAiUmlnaHRDb21tZW50X0F1dG9TY3JvbGxQYWdlV2hlbkNsb3NpbmciIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRyPicsIHt9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGNvbHNwYW46IDQsIGFsaWduOiAnbGVmdCcgfSkudGV4dCgn5byA5ZCv44CM5b+r6YCf5bGP6JS944CN77yI5Yqg5YWl6buR5ZCN5Y2VL+WPlua2iOWFs+azqO+8ieWKn+iDvScpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGk+JywgeyAnY2xhc3MnOiAnaWNvbiBpY29uLWhlbHAnLCAnZGF0YS10aXAnOiAicyR0JOWcqOi1nuWQjOWIl+ihqOOAgeivhOiuuuWIl+ihqOS4reS9v+eUqCJ9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGlucHV0PicsIHsgdHlwZTogImNoZWNrYm94IiwgJ2NsYXNzJzogIml6aC1vcHRpb24iLCBpZDogImlaaGlodV9zZXRRdWlja0Jsb2NrIiwgbmFtZTogIlF1aWNrQmxvY2siIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRyPicsIHt9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGNvbHNwYW46IDQsIGFsaWduOiAnbGVmdCcgfSkudGV4dCgn5byA5ZCv44CM5b+r6YCf5pS26JeP44CN6I+c5Y2VJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICdpY29uIGljb24taGVscCcsICdkYXRhLXRpcCc6ICJzJHQk6byg5qCH56e75LiK44CM5pS26JeP44CN5oyJ6ZKu5pe25pi+56S6In0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aW5wdXQ+JywgeyB0eXBlOiAiY2hlY2tib3giLCAnY2xhc3MnOiAiaXpoLW9wdGlvbiIsIGlkOiAiaVpoaWh1X3NldFF1aWNrRmF2byIsIG5hbWU6ICJRdWlja0Zhdm8iIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRyPicsIHt9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGNvbHNwYW46IDQsIGFsaWduOiAnbGVmdCcgfSkudGV4dCgn5byA5ZCv44CM5Zue562U55uu5b2V44CNJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRkPicsIHsgYWxpZ246ICdyaWdodCd9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8aT4nLCB7ICdjbGFzcyc6ICdpY29uIGljb24taGVscCcsICdkYXRhLXRpcCc6ICJzJHQk5Zyo6Zeu6aKY6aG16Z2i5bem5L6n5o6p6JeP77yM6byg5qCH56e75LiK5pe25bGV5byAPGJyLz7lubblnKjlj7PkvqfljbPml7bmmL7npLrlm57nrZTpooTop4gifSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBhbGlnbjogJ3JpZ2h0J30pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxpbnB1dD4nLCB7IHR5cGU6ICJjaGVja2JveCIsICdjbGFzcyc6ICJpemgtb3B0aW9uIiwgaWQ6ICJpWmhpaHVfc2V0QXV0aG9yTGlzdCIsIG5hbWU6ICJBdXRob3JMaXN0IiB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0cj4nLCB7fSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8dGQ+JywgeyBjb2xzcGFuOiA0LCBhbGlnbjogJ2xlZnQnIH0pLnRleHQoJ+mAieaLqeOAjOWklumDqOaQnOe0ouW8leaTjuOAjScpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGk+JywgeyAnY2xhc3MnOiAnaWNvbiBpY29uLWhlbHAnLCAnZGF0YS10aXAnOiAicyR0JOS9oOaHgueahCJ9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzx0ZD4nLCB7IGFsaWduOiAncmlnaHQnfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHNlbGVjdD4nLCB7IHR5cGU6ICJjaGVja2JveCIsICdjbGFzcyc6ICJpemgtb3B0aW9uIiwgaWQ6ICJpWmhpaHVfc2V0U2VhcmNoRW5naW5lT3V0c2lkZSIsIG5hbWU6ICJTZWFyY2hFbmdpbmVPdXRzaWRlIn0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8b3B0aW9uPicsIHsgdmFsdWU6J2dvb2dsZScgfSkudGV4dCgnR29vZ2xlJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8b3B0aW9uPicsIHsgdmFsdWU6J2JhaWR1JyB9KS50ZXh0KCfnmb7luqYnKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxkaXY+JywgeyAnY2xhc3MnOiAnemctbGVmdCcgfSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgn5b2T5YmN54mI5pys77yaJyt2ZXJzaW9uKyfvvJsnKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCfmnIDlkI7mm7TmlrDvvJonK3VwZGF0ZURhdGUpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGJyPicpKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCfliLbkvZzvvJonKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxhPicsIHsgJ2RhdGEtdGlwJzogInAkdCR1bm9nengiLCBocmVmOiAiL3Blb3BsZS91bm9nengiIH0pLnRleHQoJ0DpkqLnm4Xpg63lrZAnKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgn77yMJykKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8YT4nLCB7ICdkYXRhLXRpcCc6ICJwJHQkbGl1eW9uZzI1IiwgaHJlZjogIi9wZW9wbGUvbGl1eW9uZzI1IiB9KS50ZXh0KCdA5aSp54yqKOWImOWLhyknKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgn77yMJykKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8YT4nLCB7ICdkYXRhLXRpcCc6ICJwJHQkbHVveHIiLCBocmVmOiAiL3Blb3BsZS9sdW94ciIgfSkudGV4dCgnQHl1a2lyb2NrJykpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ++8jCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGE+JywgeyAnZGF0YS10aXAnOiAicCR0JG1vcmxheSIsIGhyZWY6ICIvcGVvcGxlL21vcmxheSIgfSkudGV4dCgnQOWiqOejiicpKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxicj4nKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgn5oSf6LCi77yaJykKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8YT4nLCB7ICdkYXRhLXRpcCc6ICJwJHQkUGV0ZXJEZW5nIiwgaHJlZjogIi9wZW9wbGUvUGV0ZXJEZW5nIiB9KS50ZXh0KCdA6YKT5paH5Y2aJykpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ++8jCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGE+JywgeyAnZGF0YS10aXAnOiAicCR0JGNha3ZmY3d6IiwgaHJlZjogIi9wZW9wbGUvY2FrdmZjd3oiIH0pLnRleHQoJ0DmsLTkupHpgLgnKSkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8ZGl2PicsIHsgJ2NsYXNzJzogJ3ptLWNvbW1hbmQnIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGE+JywgeyBpZDogJ2l6aFJlZnJlc2gnLCAnY2xhc3MnOiAnemctYnRuLWJsdWUnLCBocmVmOiAnamF2YXNjcmlwdDp2b2lkKDApOycgfSkudGV4dCgn5Yi35paw572R6aG1JykpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApLmFwcGVuZFRvKF9kb2MuYm9keSkuZHJhZ2dhYmxlKHtoYW5kbGU6ICcubW9kYWwtZGlhbG9nLXRpdGxlLWRyYWdnYWJsZSd9KQoKICAgICQoJy5pemgtb3B0aW9uJywgJGRsZ1NldHRpbmdzKS5lYWNoKGZ1bmN0aW9uKGksIGUpewogICAgICAgIHZhciBrZXkgPSBlLmdldEF0dHJpYnV0ZSgnbmFtZScpCiAgICAgICAgICAsICRjaGsgPSAkKGUpLmZpbHRlcignaW5wdXQ6Y2hlY2tib3gnKS5pQ2hlY2soewogICAgICAgICAgICAgICAgY2hlY2tib3hDbGFzczogJ2ljaGVja2JveF9zcXVhcmUtYmx1ZScKICAgICAgICAgICAgICAsIGluY3JlYXNlQXJlYTogJzIwJScgLy8gb3B0aW9uYWwKICAgICAgICAgICAgfSkuYmluZCgnaWZDaGFuZ2VkJywgZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5jaGVja2VkCiAgICAgICAgICAgICAgICB1dGlscy5zZXRDZmcoa2V5LCB2YWx1ZSkKICAgICAgICAgICAgfSkKICAgICAgICAgICwgJHNlbCA9ICQoZSkuZmlsdGVyKCdzZWxlY3QnKS5iaW5kKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHV0aWxzLnNldENmZyhrZXksIHRoaXMudmFsdWUpCiAgICAgICAgICAgIH0pCiAgICB9KQogICAgJCgnI2l6aFJlZnJlc2gnKS5jbGljayhmdW5jdGlvbigpewogICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpCiAgICB9KQoKLyoKICog6K6+572uLeWxj+iUvQogKi8KaWYgKHBhZ2VJcy5TZXR0aW5nc0ZpbHRlcil7CiAgICB2YXIgYWxsPVtdCiAgICAgICwgJHNlY0Jsb2NrZWRVc2VycyA9ICQoJyNzZWN0aW9uLWJsb2NrZWQtdXNlcnMnKQogICAgICAsICRzZWNCbG9ja2VkVXNlcnNUaXRsZSA9ICRzZWNCbG9ja2VkVXNlcnMuY2hpbGRyZW4oJy5zZXR0aW5ncy1zZWN0aW9uLXRpdGxlOmZpcnN0JykuY2hpbGRyZW4oJ2gyOmZpcnN0JykKICAgICAgLCAkcG5sVW5CbG9ja2VkVXNlcnMgPSAkKCc8ZGl2PicpLmFwcGVuZFRvKCRzZWNCbG9ja2VkVXNlcnNUaXRsZSkuY3NzKHsKICAgICAgICAgICAgZmxvYXQ6ICdyaWdodCcKICAgICAgICB9KQogICAgICAsICRsYkZpbHRlckJsb2NrZWRVc2VycyA9ICQoJzxsYWJlbC8+JykuYXBwZW5kVG8oJHBubFVuQmxvY2tlZFVzZXJzKS5jc3MoewogICAgICAgICAgICBmbG9hdDogJ2xlZnQnCiAgICAgICAgfSkKICAgICAgLCAkdGJGaWx0ZXJCbG9ja2VkVXNlcnMgPSAkKCc8aW5wdXQvPicsIHsKICAgICAgICAgICAgJ2NsYXNzJzogJ3pnLWZvcm0tdGV4dC1pbnB1dCB6Zy1tcjE1JwogICAgICAgICAgLCBwbGFjZWhvbGRlcjogJ+eUqOaIt+WQjeaIluaYteensCcKICAgICAgICB9KS5hcHBlbmRUbygkcG5sVW5CbG9ja2VkVXNlcnMpLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgdmFyIGt3PXRoaXMudmFsdWUKICAgICAgICAgICAgICAsIG49MAogICAgICAgICAgICAgICwgJGxpc3RCbG9ja2VkVXNlcnM9JHNlY0Jsb2NrZWRVc2Vycy5maW5kKCcuYmxvY2tlZC11c2VycyA+IC5pdGVtID4gLmJvZHkgPiBhJykuZWFjaChmdW5jdGlvbihpLGUpewogICAgICAgICAgICAgICAgICAgIHZhciAkYSA9ICQoZSkKICAgICAgICAgICAgICAgICAgICAgICwgaHJlZiA9IGUuZ2V0QXR0cmlidXRlKCdocmVmJykgfHwgJycKICAgICAgICAgICAgICAgICAgICAgICwgdGV4dCA9IGUuaW5uZXJIVE1MCiAgICAgICAgICAgICAgICAgICAgICAsIG5vdE1hdGNoID0gKGhyZWYuaW5kZXhPZihrdykgPCAwICYmIHRleHQuaW5kZXhPZihrdykgPCAwKQogICAgICAgICAgICAgICAgICAgIGlmKCFub3RNYXRjaCl7CiAgICAgICAgICAgICAgICAgICAgICAgIG4rKwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkYS5jbG9zZXN0KCcuaXRlbScpLmNzcygnZGlzcGxheScsIG5vdE1hdGNoID8gJ25vbmUnIDogJycpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAkbGJGaWx0ZXJCbG9ja2VkVXNlcnMudGV4dChbbj9uKycgJzon5pegJywn5Lq65Yy56YWN77yaJ10uam9pbignJykpCiAgICAgICAgfSkuY3NzKHsKICAgICAgICAgICAgZmxvYXQ6ICdsZWZ0JwogICAgICAgIH0pLnRyaWdnZXIoJ2tleXVwJykKICAgICAgLCBmdW5jVW5ibG9jaz1mdW5jdGlvbigpewogICAgICAgICAgICBpZihhbGwubGVuZ3RoPT0wKXtyZXR1cm59CiAgICAgICAgICAgIHZhciBlPWFsbC5zaGlmdCgpCiAgICAgICAgICAgICQucG9zdCgnL3NldHRpbmdzL3VuYmxvY2t1c2VyJywgJC5wYXJhbSh7CiAgICAgICAgICAgICAgICBfeHNyZjogJCgnaW5wdXRbbmFtZT1feHNyZl0nKS52YWwoKQogICAgICAgICAgICAgICwgdWlkOiBlLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpCiAgICAgICAgICAgIH0pKS5kb25lKGZ1bmN0aW9uKHJlc3VsdCl7CiAgICAgICAgICAgICAgICAkKGUpLnJlbW92ZSgpCiAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24ocmVzdWx0KXsKICAgICAgICAgICAgICAgIGFsbC5wdXNoKGUpCiAgICAgICAgICAgIH0pLmFsd2F5cyhmdW5jdGlvbihyZXN1bHQpewogICAgICAgICAgICAgICAgJGxiRmlsdGVyQmxvY2tlZFVzZXJzLnRleHQoW2FsbC5sZW5ndGg/YWxsLmxlbmd0aCsnICc6J+aXoCcsJ+S6uuWMuemFje+8middLmpvaW4oJycpKQogICAgICAgICAgICAgICAgZnVuY1VuYmxvY2soKQogICAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgLCBoPSR0YkZpbHRlckJsb2NrZWRVc2Vycy5vdXRlckhlaWdodCgpCiAgICAgICwgJGJ0VW5CbG9ja2VkVXNlcnMgPSAkKCc8aW5wdXQvPicsIHsKICAgICAgICAgICAgJ2NsYXNzJzogJ3pnLWJ0biB6Zy1idG4tdW5mb2xsb3cnCiAgICAgICAgICAsIHR5cGU6ICdidXR0b24nCiAgICAgICAgICAsIHZhbHVlOiAn5Y+W5raI5bGP6JS9JwogICAgICAgIH0pLmFwcGVuZFRvKCRwbmxVbkJsb2NrZWRVc2Vycykub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAkKCcjc2VjdGlvbi1ibG9ja2VkLXVzZXJzID4gLnNldHRpbmdzLWl0ZW0gPiAuc2V0dGluZ3MtaXRlbS1jb250ZW50ID4gLmJsb2NrZWQtdXNlcnMgPiAuaXRlbScpLmVhY2goZnVuY3Rpb24oaSxlKXsKICAgICAgICAgICAgICAgIHZhciAkZSA9ICQoZSkKICAgICAgICAgICAgICAgIGlmKCRlLmlzKCc6dmlzaWJsZScpKXsKICAgICAgICAgICAgICAgICAgICBhbGwucHVzaChlKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICBmdW5jVW5ibG9jaygpCiAgICAgICAgfSkuY3NzKHsKICAgICAgICAgICAgZmxvYXQ6ICdsZWZ0JwogICAgICAgIH0pLmhlaWdodChoKQogICAgJGxiRmlsdGVyQmxvY2tlZFVzZXJzLmNzcygnbGluZS1oZWlnaHQnLCBoKydweCcpCn0KCnZhciBmaXJzdFJ1biA9IHBhcnNlSW50KHV0aWxzLmdldFZhbHVlKCdpemhfZnInLCcxJykpOwoKZnVuY3Rpb24gX0ZSc2hvdygpewppZihmaXJzdFJ1bj4wICYmIGRvY3VtZW50LmRvbWFpbj09J3poaWh1LmNvbScpewogICAgdmFyIHRib3hsZWZ0PTA7CiAgICB2YXIgYWNjaXRlbTE9ICQoJyN6aC10b3AtaW5uZXIgZGl2LnRvcC1uYXYtcHJvZmlsZSAuenUtdG9wLW5hdi11c2VyaW5mbycpOwogICAgaWYoYWNjaXRlbTEubGVuZ3RoPjApewogICAgICAgIHRib3hsZWZ0ID0gYWNjaXRlbTEub2Zmc2V0KCkubGVmdDsKICAgIH0KICAgIGlmKHRib3hsZWZ0PjApewogICAgICAgICQoJzxkaXY+JywgeyBpZDogJ2laaGlodV90Ym94JywgJ2NsYXNzJzogJ3RfZnJzaG93JyB9KS5hcHBlbmRUbygnYm9keS56aGknKS5oaWRlKCkKICAgICAgICAgICAgLmFwcGVuZCgkKCc8ZGl2PicsIHsgJ2NsYXNzJzogJ3RfdHh0c2hvdyB0X3Rib3gnIH0pCiAgICAgICAgICAgICAgICAuYXBwZW5kKCfmhJ/osKLkvb/nlKgnKQogICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8Yj4nKS50ZXh0KCdpWmhpaHUnKSkKICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPGJyIC8+JykpCiAgICAgICAgICAgICAgICAuYXBwZW5kKCfmgqjlj6/pgJrov4foj5zljZXjgJBpWmhpaHXjgJHlr7nlip/og73ov5vooYzorr7nva4nKQogICAgICAgICAgICAgICAgLmFwcGVuZCgkKCc8YnIgLz4nKSkKICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPHM+JykKICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCQoJzxpPicpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApOwogICAgICAgICQoJyNpWmhpaHVfdGJveCcpLmNzcygnbGVmdCcsdGJveGxlZnQtMTAwKS5zaG93KCkubW91c2VlbnRlcihmdW5jdGlvbigpewogICAgICAgICAgICB1dGlscy5zZXRWYWx1ZSgnaXpoX2ZyJywnMCcpOwogICAgICAgICAgICAvL19NZW51KCk7CiAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9Cn0KICAgIApzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICBfRlJzaG93KCk7Cn0sMTAwMCk7CgoKICBjb25zb2xlLmxvZygnaVpoaWh1ICcrdmVyc2lvbisnIHN0YXJ0ZWQuJyk7CiAgLy9jb25zb2xlLmxvZyh3aW5kb3cuaVpoaWh1KTsKICAvL2NvbnNvbGUubG9nKChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkpOwovL30pOwo="},{"name":"","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://pan.baidu.com/disk/home*","*://yun.baidu.com/disk/home*","*://pan.baidu.com/s/*","*://yun.baidu.com/s/*","*://pan.baidu.com/share/link*","*://yun.baidu.com/share/link*"],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1487594258409},"enabled":true,"position":9,"file_url":"https://greasyfork.org/scripts/23635-%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD/code/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD.user.js","uuid":"a1482c65-ea9d-48c5-bbca-e89ed17e042f","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICDnmb7luqbnvZHnm5jnm7TmjqXkuIvovb3liqnmiYsKLy8gQG5hbWVzcGFjZSAgICB1bmRlZmluZWQKLy8gQHZlcnNpb24gICAgICAwLjkuMjMKLy8gQGRlc2NyaXB0aW9uICDnm7TmjqXkuIvovb3nmb7luqbnvZHnm5jlkoznmb7luqbnvZHnm5jliIbkuqvnmoTmlofku7Ys6YG/5YWN5LiL6L295paH5Lu25pe26LCD55So55m+5bqm572R55uY5a6i5oi356uvLOiOt+WPlue9keebmOaWh+S7tueahOebtOaOpeS4i+i9veWcsOWdgAovLyBAYXV0aG9yICAgICAgIGl2ZXNqYXkKLy8gQG1hdGNoICAgICAgICAqOi8vcGFuLmJhaWR1LmNvbS9kaXNrL2hvbWUqCi8vIEBtYXRjaCAgICAgICAgKjovL3l1bi5iYWlkdS5jb20vZGlzay9ob21lKgovLyBAbWF0Y2ggICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL3MvKgovLyBAbWF0Y2ggICAgICAgICo6Ly95dW4uYmFpZHUuY29tL3MvKgovLyBAbWF0Y2ggICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL3NoYXJlL2xpbmsqCi8vIEBtYXRjaCAgICAgICAgKjovL3l1bi5iYWlkdS5jb20vc2hhcmUvbGluayoKLy8gQHJlcXVpcmUgICAgICBodHRwczovL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktbGF0ZXN0LmpzCi8vIEBydW4tYXQgICAgICAgZG9jdW1lbnQtc3RhcnQKLy8gQGdyYW50ICAgICAgICB1bnNhZmVXaW5kb3cKLy8gQGdyYW50ICAgICAgICBHTV9zZXRDbGlwYm9hcmQKLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24oKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgdmFyICQgPSAkIHx8IHdpbmRvdy4kOwogICAgdmFyIGxvZ19jb3VudCA9IDE7CiAgICB2YXIgd29yZE1hcEh0dHAgPSB7CiAgICAgICAgJ2xpc3QtZ3JpZC1zd2l0Y2gnOid5dmdiOVhKJywKICAgICAgICAnbGlzdC1zd2l0Y2hlZC1vbic6J2tzYlhabScsCiAgICAgICAgJ2dyaWQtc3dpdGNoZWQtb24nOid0Y2g2VzI1JywKICAgICAgICAnbGlzdC1zd2l0Y2gnOidscmJvOWEnLAogICAgICAgICdncmlkLXN3aXRjaCc6J3hoNnBvTCcsCiAgICAgICAgJ2NoZWNrYm94JzonRU9HZXhmJywKICAgICAgICAnY29sLWl0ZW0nOidReHlmdmcnLAogICAgICAgICdjaGVjayc6J2Z5ZEdOQycsCiAgICAgICAgJ2NoZWNrZWQnOidFenViR2cnLAogICAgICAgICdsaXN0LXZpZXcnOid2ZEFmS01iJywKICAgICAgICAnaXRlbS1hY3RpdmUnOiduZ2I5TzYnLAogICAgICAgICdncmlkLXZpZXcnOidKS3ZISk1iJywKICAgICAgICAnYmFyLXNlYXJjaCc6J09GYVBhTycsCiAgICAgICAgJ2RlZmF1bHQtZG9tJzonem5vdkdyd1knLAogICAgICAgICdiYXInOidhZXdHckQ3JywKICAgICAgICAnbGlzdC10b29scyc6J1FERE9RQicKICAgIH07CiAgICB2YXIgd29yZE1hcEh0dHBzID0gewogICAgICAgICdsaXN0LWdyaWQtc3dpdGNoJzoncW9ibVhCMXEnLAogICAgICAgICdsaXN0LXN3aXRjaGVkLW9uJzonZXdYbTFlJywKICAgICAgICAnZ3JpZC1zd2l0Y2hlZC1vbic6J2t4aGtYMkVtJywKICAgICAgICAnbGlzdC1zd2l0Y2gnOidydnBYbTYzJywKICAgICAgICAnZ3JpZC1zd2l0Y2gnOidteGdkSmd3dicsCiAgICAgICAgJ2NoZWNrYm94JzonRU9HZXhmJywKICAgICAgICAnY29sLWl0ZW0nOidReHlmdmcnLAogICAgICAgICdjaGVjayc6J2Z5ZEdOQycsCiAgICAgICAgJ2NoZWNrZWQnOidFenViR2cnLAogICAgICAgICdsaXN0LXZpZXcnOid2ZEFmS01iJywKICAgICAgICAnaXRlbS1hY3RpdmUnOidwY2FtWEJSWCcsCiAgICAgICAgJ2dyaWQtdmlldyc6J0pLdkhKTWInLAogICAgICAgICdiYXItc2VhcmNoJzonT0ZhUGFPJywKICAgICAgICAnZGVmYXVsdC1kb20nOidzampqWDRQYScsCiAgICAgICAgJ2Jhcic6J2Jib1g0S0wnLAogICAgICAgICdsaXN0LXRvb2xzJzonUURET1FCJwogICAgfTsKICAgIHZhciB3b3JkTWFwID0gbG9jYXRpb24ucHJvdG9jb2wgPT0gJ2h0dHA6JyA/IHdvcmRNYXBIdHRwIDogd29yZE1hcEh0dHBzOwogICAgCiAgICAvL2NvbnNvbGUubG9nKHdvcmRNYXApOwoKICAgIGZ1bmN0aW9uIHNsb2coYzEsYzIsYzMpewogICAgICAgIGMxID0gYzE/YzE6Jyc7CiAgICAgICAgYzIgPSBjMj9jMjonJzsKICAgICAgICBjMyA9IGMzP2MzOicnOwogICAgICAgIGNvbnNvbGUubG9nKCcjJysgbG9nX2NvdW50KysgKyctQmFpRHVOZXRkaXNrSGVscGVyLWxvZzonLGMxLGMyLGMzKTsKICAgIH0KCiAgICAkKGZ1bmN0aW9uKCl7CiAgICAgICAgc3dpdGNoKGRldGVjdFBhZ2UoKSl7CiAgICAgICAgICAgIGNhc2UgJ2Rpc2snOgogICAgICAgICAgICAgICAgdmFyIHBhbkhlbHBlciA9IG5ldyBQYW5IZWxwZXIoKTsKICAgICAgICAgICAgICAgIHBhbkhlbHBlci5pbml0KCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGNhc2UgJ3NoYXJlJzoKICAgICAgICAgICAgY2FzZSAncyc6CiAgICAgICAgICAgICAgICB2YXIgcGFuU2hhcmVIZWxwZXIgPSBuZXcgUGFuU2hhcmVIZWxwZXIoKTsKICAgICAgICAgICAgICAgIHBhblNoYXJlSGVscGVyLmluaXQoKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9KTsKCiAgICAvL+e9keebmOmhtemdoueahOS4i+i9veWKqeaJiwogICAgZnVuY3Rpb24gUGFuSGVscGVyKCl7CiAgICAgICAgdmFyIHl1bkRhdGEsc2lnbix0aW1lc3RhbXAsYmRzdG9rZW4sbG9naWQsZmlkX2xpc3Q7CiAgICAgICAgdmFyIGZpbGVMaXN0PVtdLHNlbGVjdEZpbGVMaXN0PVtdLGJhdGNoTGlua0xpc3Q9W10sYmF0Y2hMaW5rTGlzdEFsbD1bXSxsaW5rTGlzdD1bXSwKICAgICAgICAgICAgbGlzdF9ncmlkX3N0YXR1cz0nbGlzdCc7CiAgICAgICAgdmFyIG9ic2VydmVyLGN1cnJlbnRQYWdlLGN1cnJlbnRQYXRoLGN1cnJlbnRDYXRlZ29yeSxkaWFsb2csc2VhcmNoS2V5OwogICAgICAgIHZhciBwYW5BUElVcmwgPSBsb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyBsb2NhdGlvbi5ob3N0ICsgIi9hcGkvIjsKICAgICAgICB2YXIgcmVzdEFQSVVybCA9IGxvY2F0aW9uLnByb3RvY29sICsgIi8vcGNzLmJhaWR1LmNvbS9yZXN0LzIuMC9wY3MvIjsKICAgICAgICB2YXIgY2xpZW50QVBJVXJsID0gbG9jYXRpb24ucHJvdG9jb2wgKyAiLy9kLnBjcy5iYWlkdS5jb20vcmVzdC8yLjAvcGNzLyI7CgogICAgICAgIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHl1bkRhdGEgPSB1bnNhZmVXaW5kb3cueXVuRGF0YTsKICAgICAgICAgICAgc2xvZygneXVuRGF0YTonLHl1bkRhdGEpOwogICAgICAgICAgICBpZih5dW5EYXRhID09PSB1bmRlZmluZWQpewogICAgICAgICAgICAgICAgc2xvZygn6aG16Z2i5pyq5q2j5bi45Yqg6L2977yM5oiW6ICF55m+5bqm5bey57uP5pu05paw77yBJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW5pdFBhcmFtcygpOwogICAgICAgICAgICByZWdpc3RlckV2ZW50TGlzdGVuZXIoKTsKICAgICAgICAgICAgY3JlYXRlT2JzZXJ2ZXIoKTsKICAgICAgICAgICAgYWRkQnV0dG9uKCk7CiAgICAgICAgICAgIGNyZWF0ZUlmcmFtZSgpOwogICAgICAgICAgICBkaWFsb2cgPSBuZXcgRGlhbG9nKHthZGRDb3B5OnRydWV9KTsKCiAgICAgICAgICAgIHNsb2coJ+e9keebmOebtOaOpeS4i+i9veWKqeaJi+WKoOi9veaIkOWKn++8gScpOwogICAgICAgIH07CgogICAgICAgIGZ1bmN0aW9uIGluaXRQYXJhbXMoKXsKICAgICAgICAgICAgc2lnbiA9IGdldFNpZ24oKTsKICAgICAgICAgICAgdGltZXN0YW1wID0gZ2V0VGltZXN0YW1wKCk7CiAgICAgICAgICAgIGJkc3Rva2VuID0gZ2V0QkRTdG9rZW4oKTsKICAgICAgICAgICAgbG9naWQgPSBnZXRMb2dJRCgpOwogICAgICAgICAgICBjdXJyZW50UGFnZSA9IGdldEN1cnJlbnRQYWdlKCk7CiAgICAgICAgICAgIHNsb2coJ0N1cnJlbnQgZGlzcGxheSBtb2RlOicsY3VycmVudFBhZ2UpOwoKICAgICAgICAgICAgaWYoY3VycmVudFBhZ2UgPT0gJ2xpc3QnKQogICAgICAgICAgICAgICAgY3VycmVudFBhdGggPSBnZXRQYXRoKCk7CgogICAgICAgICAgICBpZihjdXJyZW50UGFnZSA9PSAnY2F0ZWdvcnknKQogICAgICAgICAgICAgICAgY3VycmVudENhdGVnb3J5ID0gZ2V0Q2F0ZWdvcnkoKTsKCiAgICAgICAgICAgIGlmKGN1cnJlbnRQYWdlID09ICdzZWFyY2gnKQogICAgICAgICAgICAgICAgc2VhcmNoS2V5ID0gZ2V0U2VhcmNoS2V5KCk7CgogICAgICAgICAgICByZWZyZXNoTGlzdEdyaWRTdGF0dXMoKTsKICAgICAgICAgICAgcmVmcmVzaEZpbGVMaXN0KCk7CiAgICAgICAgICAgIHJlZnJlc2hTZWxlY3RMaXN0KCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByZWZyZXNoRmlsZUxpc3QoKXsKICAgICAgICAgICAgaWYgKGN1cnJlbnRQYWdlID09ICdsaXN0JykgewogICAgICAgICAgICAgICAgZmlsZUxpc3QgPSBnZXRGaWxlTGlzdCgpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRQYWdlID09ICdjYXRlZ29yeScpewogICAgICAgICAgICAgICAgZmlsZUxpc3QgPSBnZXRDYXRlZ29yeUZpbGVMaXN0KCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFBhZ2UgPT0gJ3NlYXJjaCcpIHsKICAgICAgICAgICAgICAgIGZpbGVMaXN0ID0gZ2V0U2VhcmNoRmlsZUxpc3QoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaFNlbGVjdExpc3QoKXsKICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QgPSBbXTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHJlZnJlc2hMaXN0R3JpZFN0YXR1cygpewogICAgICAgICAgICBsaXN0X2dyaWRfc3RhdHVzID0gZ2V0TGlzdEdyaWRTdGF0dXMoKTsKICAgICAgICB9CgogICAgICAgIC8v6I635Y+W5b2T5YmN55qE6KeG5Zu+5qih5byPCiAgICAgICAgZnVuY3Rpb24gZ2V0TGlzdEdyaWRTdGF0dXMoKXsKICAgICAgICAgICAgLy9yZXR1cm4gJCgnZGl2Lmxpc3QtZ3JpZC1zd2l0Y2gnKS5oYXNDbGFzcygnbGlzdC1zd2l0Y2hlZC1vbicpPydsaXN0JzooJCgnZGl2Lmxpc3QtZ3JpZC1zd2l0Y2gnKS5oYXNDbGFzcygnZ3JpZC1zd2l0Y2hlZC1vbicpPydncmlkJzonbGlzdCcpOwogICAgICAgICAgICAvL3JldHVybiAkKCdkaXYuaXRpV3pQWScpLmhhc0NsYXNzKCdrdWR0V1k0NicpPydsaXN0JzooJCgnZGl2Lml0aVd6UFknKS5oYXNDbGFzcygnbnl0QUw5dycpPydncmlkJzonbGlzdCcpOwogICAgICAgICAgICByZXR1cm4gJCgnZGl2Licrd29yZE1hcFsnbGlzdC1ncmlkLXN3aXRjaCddKS5oYXNDbGFzcyh3b3JkTWFwWydsaXN0LXN3aXRjaGVkLW9uJ10pPydsaXN0JzooJCgnZGl2Licrd29yZE1hcFsnbGlzdC1ncmlkLXN3aXRjaCddKS5oYXNDbGFzcyh3b3JkTWFwWydncmlkLXN3aXRjaGVkLW9uJ10pPydncmlkJzonbGlzdCcpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJFdmVudExpc3RlbmVyKCl7CiAgICAgICAgICAgIHJlZ2lzdGVySGFzaENoYW5nZSgpOwogICAgICAgICAgICByZWdpc3Rlckxpc3RHcmlkU3RhdHVzKCk7CiAgICAgICAgICAgIHJlZ2lzdGVyQ2hlY2tib3goKTsKICAgICAgICAgICAgcmVnaXN0ZXJBbGxDaGVja2JveCgpOwogICAgICAgICAgICByZWdpc3RlckZpbGVTZWxlY3QoKTsKICAgICAgICB9CgogICAgICAgIC8v55uR6KeG5Zyw5Z2A5qCPI+agh+etvueahOWPmOWMlgogICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVySGFzaENoYW5nZSgpewogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsZnVuY3Rpb24oZSl7CiAgICAgICAgICAgICAgICByZWZyZXNoTGlzdEdyaWRTdGF0dXMoKTsKICAgICAgICAgICAgICAgIGlmKGdldEN1cnJlbnRQYWdlKCkgPT0gJ2xpc3QnKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoY3VycmVudFBhZ2UgPT0gZ2V0Q3VycmVudFBhZ2UoKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRQYXRoID09IGdldFBhdGgoKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IGdldFBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hGaWxlTGlzdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFNlbGVjdExpc3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYWdlID0gZ2V0Q3VycmVudFBhZ2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhdGggPSBnZXRQYXRoKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hGaWxlTGlzdCgpOwogICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoU2VsZWN0TGlzdCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ2V0Q3VycmVudFBhZ2UoKSA9PSAnY2F0ZWdvcnknKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoY3VycmVudFBhZ2UgPT0gZ2V0Q3VycmVudFBhZ2UoKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRDYXRlZ29yeSA9PSBnZXRDYXRlZ29yeSgpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYWdlID0gZ2V0Q3VycmVudFBhZ2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDYXRlZ29yeSA9IGdldENhdGVnb3J5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoRmlsZUxpc3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hTZWxlY3RMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGFnZSA9IGdldEN1cnJlbnRQYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDYXRlZ29yeSA9IGdldENhdGVnb3J5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hGaWxlTGlzdCgpOwogICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoU2VsZWN0TGlzdCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZihnZXRDdXJyZW50UGFnZSgpID09ICdzZWFyY2gnKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoY3VycmVudFBhZ2UgPT0gZ2V0Q3VycmVudFBhZ2UoKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlYXJjaEtleSA9PSBnZXRTZWFyY2hLZXkoKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGFnZSA9IGdldEN1cnJlbnRQYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hLZXkgPSBnZXRTZWFyY2hLZXkoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hGaWxlTGlzdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFNlbGVjdExpc3QoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYWdlID0gZ2V0Q3VycmVudFBhZ2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoS2V5ID0gZ2V0U2VhcmNoS2V5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hGaWxlTGlzdCgpOwogICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoU2VsZWN0TGlzdCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvL+ebkeinhuinhuWbvuWPmOWMlgogICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyTGlzdEdyaWRTdGF0dXMoKXsKICAgICAgICAgICAgLy92YXIgJGFfbGlzdCA9ICQoJ2Fbbm9kZS10eXBlPWxpc3Qtc3dpdGNoXScpOwogICAgICAgICAgICAvL3ZhciAkYV9saXN0ID0gJCgnYVtub2RlLXR5cGU9ZWVwV3pra10nKTsKICAgICAgICAgICAgdmFyICRhX2xpc3QgPSAkKCdhW25vZGUtdHlwZT0nK3dvcmRNYXBbJ2xpc3Qtc3dpdGNoJ10rJ10nKTsKICAgICAgICAgICAgJGFfbGlzdC5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgbGlzdF9ncmlkX3N0YXR1cyA9ICdsaXN0JzsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvL3ZhciAkYV9ncmlkID0gJCgnYVtub2RlLXR5cGU9Z3JpZC1zd2l0Y2hdJyk7CiAgICAgICAgICAgIC8vdmFyICRhX2dyaWQgPSAkKCdhW25vZGUtdHlwZT15dG52V1k3cV0nKTsKICAgICAgICAgICAgdmFyICRhX2dyaWQgPSAkKCdhW25vZGUtdHlwZT0nK3dvcmRNYXBbJ2dyaWQtc3dpdGNoJ10rJ10nKTsKICAgICAgICAgICAgJGFfZ3JpZC5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgbGlzdF9ncmlkX3N0YXR1cyA9ICdncmlkJzsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvL+aWh+S7tumAieaLqeahhgogICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyQ2hlY2tib3goKXsKICAgICAgICAgICAgLy92YXIgJGNoZWNrYm94ID0gJCgnc3Bhbi5jaGVja2JveCcpOwogICAgICAgICAgICAvL3ZhciAkY2hlY2tib3ggPSAkKCdzcGFuLkVPR2V4ZicpOwogICAgICAgICAgICB2YXIgJGNoZWNrYm94ID0gJCgnc3Bhbi4nK3dvcmRNYXBbJ2NoZWNrYm94J10pOwogICAgICAgICAgICAkY2hlY2tib3guZWFjaChmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICQoZWxlbWVudCkuYmluZCgnY2xpY2snLGZ1bmN0aW9uKGUpewogICAgICAgICAgICAgICAgICAgIHZhciAkcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTsKICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZW5hbWU7CiAgICAgICAgICAgICAgICAgICAgaWYobGlzdF9ncmlkX3N0YXR1cyA9PSAnbGlzdCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy9maWxlbmFtZSA9ICQoJ2Rpdi5maWxlLW5hbWUgZGl2LnRleHQgYScsJHBhcmVudCkuYXR0cigndGl0bGUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAkKCdkaXYuZmlsZS1uYW1lIGRpdi50ZXh0IGEnLCRwYXJlbnQpLmF0dHIoJ3RpdGxlJyk7CiAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYobGlzdF9ncmlkX3N0YXR1cyA9PSAnZ3JpZCcpewogICAgICAgICAgICAgICAgICAgICAgICAvL2ZpbGVuYW1lID0gJCgnZGl2LmZpbGUtbmFtZSBhJywkcGFyZW50KS5hdHRyKCd0aXRsZScpOwogICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSA9ICQoJ2Rpdi5maWxlLW5hbWUgYScsJHBhcmVudCkuYXR0cigndGl0bGUnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy9pZigkcGFyZW50Lmhhc0NsYXNzKCdpdGVtLWFjdGl2ZScpKXsKICAgICAgICAgICAgICAgICAgICAvL2lmKCRwYXJlbnQuaGFzQ2xhc3MoJ3ByV3pYQScpKXsKICAgICAgICAgICAgICAgICAgICBpZigkcGFyZW50Lmhhc0NsYXNzKHdvcmRNYXBbJ2l0ZW0tYWN0aXZlJ10pKXsKICAgICAgICAgICAgICAgICAgICAgICAgc2xvZygn5Y+W5raI6YCJ5Lit5paH5Lu277yaJytmaWxlbmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8c2VsZWN0RmlsZUxpc3QubGVuZ3RoO2krKyl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdFtpXS5maWxlbmFtZSA9PSBmaWxlbmFtZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3Quc3BsaWNlKGksMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgc2xvZygn6YCJ5Lit5paH5Lu2OicrZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goZmlsZUxpc3QsZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LnNlcnZlcl9maWxlbmFtZSA9PSBmaWxlbmFtZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ZWxlbWVudC5zZXJ2ZXJfZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6ZWxlbWVudC5wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmc19pZDplbGVtZW50LmZzX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2RpcjplbGVtZW50LmlzZGlyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RGaWxlTGlzdC5wdXNoKG9iaik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXJDaGVja2JveCgpewogICAgICAgICAgICAvL3ZhciAkY2hlY2tib3ggPSAkKCdzcGFuLmNoZWNrYm94Jyk7CiAgICAgICAgICAgIC8vdmFyICRjaGVja2JveCA9ICQoJ3NwYW4uRU9HZXhmJyk7CiAgICAgICAgICAgIHZhciAkY2hlY2tib3ggPSAkKCdzcGFuLicrd29yZE1hcFsnY2hlY2tib3gnXSk7CiAgICAgICAgICAgICRjaGVja2JveC5lYWNoKGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgJChlbGVtZW50KS51bmJpbmQoJ2NsaWNrJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy/lhajpgInmoYYKICAgICAgICBmdW5jdGlvbiByZWdpc3RlckFsbENoZWNrYm94KCl7CiAgICAgICAgICAgIC8vdmFyICRjaGVja2JveCA9ICQoJ2Rpdi5jb2wtaXRlbS5jaGVjaycpOwogICAgICAgICAgICAvL3ZhciAkY2hlY2tib3ggPSAkKCdkaXYuUXh5ZnZnLmZ5ZEdOQycpOwogICAgICAgICAgICB2YXIgJGNoZWNrYm94ID0gJCgnZGl2Licrd29yZE1hcFsnY29sLWl0ZW0nXSsnLicrd29yZE1hcFsnY2hlY2snXSk7CiAgICAgICAgICAgICRjaGVja2JveC5lYWNoKGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgJChlbGVtZW50KS5iaW5kKCdjbGljaycsZnVuY3Rpb24oZSl7CiAgICAgICAgICAgICAgICAgICAgdmFyICRwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpOwogICAgICAgICAgICAgICAgICAgIC8vaWYoJHBhcmVudC5oYXNDbGFzcygnY2hlY2tlZCcpKXsKICAgICAgICAgICAgICAgICAgICAvL2lmKCRwYXJlbnQuaGFzQ2xhc3MoJ0V6dWJHZycpKXsKICAgICAgICAgICAgICAgICAgICBpZigkcGFyZW50Lmhhc0NsYXNzKHdvcmRNYXBbJ2NoZWNrZWQnXSkpewogICAgICAgICAgICAgICAgICAgICAgICBzbG9nKCflj5bmtojlhajpgIknKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBzbG9nKCflhajpg6jpgInkuK0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGZpbGVMaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTplbGVtZW50LnNlcnZlcl9maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOmVsZW1lbnQucGF0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmc19pZDplbGVtZW50LmZzX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzZGlyOmVsZW1lbnQuaXNkaXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RGaWxlTGlzdC5wdXNoKG9iaik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXJBbGxDaGVja2JveCgpewogICAgICAgICAgICAvL3ZhciAkY2hlY2tib3ggPSAkKCdkaXYuY29sLWl0ZW0uY2hlY2snKTsKICAgICAgICAgICAgLy92YXIgJGNoZWNrYm94ID0gJCgnZGl2LlF4eWZ2Zy5meWRHTkMnKTsKICAgICAgICAgICAgdmFyICRjaGVja2JveCA9ICQoJ2Rpdi4nK3dvcmRNYXBbJ2NvbC1pdGVtJ10rJy4nK3dvcmRNYXBbJ2NoZWNrJ10pOwogICAgICAgICAgICAkY2hlY2tib3guZWFjaChmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICQoZWxlbWVudCkudW5iaW5kKCdjbGljaycpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8v5Y2V5Liq5paH5Lu26YCJ5Lit77yM54K55Ye75paH5Lu25LiN5piv54K55Ye76YCJ5Lit5qGG77yM5Lya5Y+q6YCJ5Lit6K+l5paH5Lu2CiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJGaWxlU2VsZWN0KCl7CiAgICAgICAgICAgIC8vdmFyICRkZCA9ICQoJ2Rpdi5saXN0LXZpZXcgZGQnKTsKICAgICAgICAgICAgLy92YXIgJGRkID0gJCgnZGl2LnZkQWZLTWIgZGQnKTsKICAgICAgICAgICAgdmFyICRkZCA9ICQoJ2Rpdi4nK3dvcmRNYXBbJ2xpc3QtdmlldyddKycgZGQnKTsKICAgICAgICAgICAgJGRkLmVhY2goZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLmJpbmQoJ2NsaWNrJyxmdW5jdGlvbihlKXsKICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZU5hbWUgPSBlLnRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgIGlmKG5vZGVOYW1lICE9ICdzcGFuJyAmJiBub2RlTmFtZSAhPSAnYScgJiYgbm9kZU5hbWUgIT0gJ2VtJykgewogICAgICAgICAgICAgICAgICAgICAgICBzbG9nKCdzaGlmdEtleTonK2Uuc2hpZnRLZXkpOwogICAgICAgICAgICAgICAgICAgICAgICBpZighZS5zaGlmdEtleSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RGaWxlTGlzdCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVuYW1lID0gJCgnZGl2LmZpbGUtbmFtZSBkaXYudGV4dCBhJywkKHRoaXMpKS5hdHRyKCd0aXRsZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xvZygn6YCJ5Lit5paH5Lu277yaJyArIGZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaChmaWxlTGlzdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LnNlcnZlcl9maWxlbmFtZSA9PSBmaWxlbmFtZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTplbGVtZW50LnNlcnZlcl9maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6ZWxlbWVudC5wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnNfaWQ6ZWxlbWVudC5mc19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzZGlyOmVsZW1lbnQuaXNkaXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QucHVzaChvYmopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdEZpbGVMaXN0ID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciAkZGRfc2VsZWN0ID0gJCgnZGl2Lmxpc3QtdmlldyBkZC5pdGVtLWFjdGl2ZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgJGRkX3NlbGVjdCA9ICQoJ2Rpdi52ZEFmS01iIGRkLnByV3pYQScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRkZF9zZWxlY3QgPSAkKCdkaXYuJyt3b3JkTWFwWydsaXN0LXZpZXcnXSsnIGRkLicrd29yZE1hcFsnaXRlbS1hY3RpdmUnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goJGRkX3NlbGVjdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZW5hbWUgPSAkKCdkaXYuZmlsZS1uYW1lIGRpdi50ZXh0IGEnLCQoZWxlbWVudCkpLmF0dHIoJ3RpdGxlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xvZygn6YCJ5Lit5paH5Lu277yaJyArIGZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goZmlsZUxpc3QsZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQuc2VydmVyX2ZpbGVuYW1lID09IGZpbGVuYW1lKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ZWxlbWVudC5zZXJ2ZXJfZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDplbGVtZW50LnBhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnNfaWQ6ZWxlbWVudC5mc19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2RpcjplbGVtZW50LmlzZGlyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QucHVzaChvYmopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXJGaWxlU2VsZWN0KCl7CiAgICAgICAgICAgIC8vdmFyICRkZCA9ICQoJ2Rpdi5saXN0LXZpZXcgZGQnKTsKICAgICAgICAgICAgLy92YXIgJGRkID0gJCgnZGl2LnZkQWZLTWIgZGQnKTsKICAgICAgICAgICAgdmFyICRkZCA9ICQoJ2Rpdi4nK3dvcmRNYXBbJ2xpc3QtdmlldyddKycgZGQnKTsKICAgICAgICAgICAgJGRkLmVhY2goZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnVuYmluZCgnY2xpY2snKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvL+ebkeinhuaWh+S7tuWIl+ihqOaYvuekuuWPmOWMlgogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU9ic2VydmVyKCl7CiAgICAgICAgICAgIHZhciBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXI7CiAgICAgICAgICAgIHZhciBvcHRpb25zID0gewogICAgICAgICAgICAgICAgJ2NoaWxkTGlzdCc6IHRydWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnMpewogICAgICAgICAgICAgICAgdW5yZWdpc3RlckNoZWNrYm94KCk7CiAgICAgICAgICAgICAgICB1bnJlZ2lzdGVyQWxsQ2hlY2tib3goKTsKICAgICAgICAgICAgICAgIHVucmVnaXN0ZXJGaWxlU2VsZWN0KCk7CiAgICAgICAgICAgICAgICByZWdpc3RlckNoZWNrYm94KCk7CiAgICAgICAgICAgICAgICByZWdpc3RlckFsbENoZWNrYm94KCk7CiAgICAgICAgICAgICAgICByZWdpc3RlckZpbGVTZWxlY3QoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvL3ZhciBsaXN0X3ZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlzdC12aWV3Jyk7CiAgICAgICAgICAgIC8vdmFyIGdyaWRfdmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkLXZpZXcnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vdmFyIGxpc3RfdmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52ZEFmS01iJyk7CiAgICAgICAgICAgIC8vdmFyIGdyaWRfdmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5KS3ZISk1iJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgbGlzdF92aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrd29yZE1hcFsnbGlzdC12aWV3J10pOwogICAgICAgICAgICB2YXIgZ3JpZF92aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicrd29yZE1hcFsnZ3JpZC12aWV3J10pOwoKICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShsaXN0X3ZpZXcsb3B0aW9ucyk7CiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUoZ3JpZF92aWV3LG9wdGlvbnMpOwogICAgICAgIH0KCiAgICAgICAgLy/mt7vliqDliqnmiYvmjInpkq4KICAgICAgICBmdW5jdGlvbiBhZGRCdXR0b24oKXsKICAgICAgICAgICAgLy8kKCdkaXYuYmFyLXNlYXJjaCcpLmNzcygnd2lkdGgnLCcxOCUnKTsvL+S/ruaUueaQnOe0ouahhueahOWuveW6pu+8jOmBv+WFjemBruaMoQogICAgICAgICAgICAvLyQoJ2Rpdi5PRmFQYU8nKS5jc3MoJ3dpZHRoJywnMTglJyk7CiAgICAgICAgICAgICQoJ2Rpdi4nK3dvcmRNYXBbJ2Jhci1zZWFyY2gnXSkuY3NzKCd3aWR0aCcsJzE4JScpOwogICAgICAgICAgICB2YXIgJGRyb3Bkb3duYnV0dG9uID0gJCgnPHNwYW4gY2xhc3M9ImctZHJvcGRvd24tYnV0dG9uIj48L3NwYW4+Jyk7CiAgICAgICAgICAgIHZhciAkZHJvcGRvd25idXR0b25fYSA9ICQoJzxhIGNsYXNzPSJnLWJ1dHRvbiIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyI+PHNwYW4gY2xhc3M9ImctYnV0dG9uLXJpZ2h0Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kb3dubG9hZCIgdGl0bGU9IueZvuW6pue9keebmOS4i+i9veWKqeaJiyI+PC9lbT48c3BhbiBjbGFzcz0idGV4dCIgc3R5bGU9IndpZHRoOiBhdXRvOyI+5LiL6L295Yqp5omLPC9zcGFuPjwvc3Bhbj48L2E+Jyk7CiAgICAgICAgICAgIHZhciAkZHJvcGRvd25idXR0b25fc3BhbiA9ICQoJzxzcGFuIGNsYXNzPSJtZW51IiBzdHlsZT0id2lkdGg6OTZweCI+PC9zcGFuPicpOwoKICAgICAgICAgICAgdmFyICRkaXJlY3RidXR0b24gPSAkKCc8c3BhbiBjbGFzcz0iZy1idXR0b24tbWVudSIgc3R5bGU9ImRpc3BsYXk6YmxvY2siPjwvc3Bhbj4nKTsKICAgICAgICAgICAgdmFyICRkaXJlY3RidXR0b25fc3BhbiA9ICQoJzxzcGFuIGNsYXNzPSJnLWRyb3Bkb3duLWJ1dHRvbiBnLWRyb3Bkb3duLWJ1dHRvbi1zZWNvbmQiIG1lbnVsZXZlbD0iMiI+PC9zcGFuPicpOwogICAgICAgICAgICB2YXIgJGRpcmVjdGJ1dHRvbl9hID0gJCgnPGEgY2xhc3M9ImctYnV0dG9uIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij48c3BhbiBjbGFzcz0iZy1idXR0b24tcmlnaHQiPjxzcGFuIGNsYXNzPSJ0ZXh0IiBzdHlsZT0id2lkdGg6YXV0byI+55u05o6l5LiL6L29PC9zcGFuPjwvc3Bhbj48L2E+Jyk7CiAgICAgICAgICAgIHZhciAkZGlyZWN0YnV0dG9uX21lbnUgPSAkKCc8c3BhbiBjbGFzcz0ibWVudSIgc3R5bGU9IndpZHRoOjEyMHB4O2xlZnQ6NzlweCI+PC9zcGFuPicpOwogICAgICAgICAgICB2YXIgJGRpcmVjdGJ1dHRvbl9kb3dubG9hZF9idXR0b24gPSAkKCc8YSBpZD0iZG93bmxvYWQtZGlyZWN0IiBjbGFzcz0iZy1idXR0b24tbWVudSIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyI+5LiL6L29PC9hPicpOwogICAgICAgICAgICB2YXIgJGRpcmVjdGJ1dHRvbl9saW5rX2J1dHRvbiA9ICQoJzxhIGlkPSJsaW5rLWRpcmVjdCIgY2xhc3M9ImctYnV0dG9uLW1lbnUiIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKTsiPuaYvuekuumTvuaOpTwvYT4nKTsKICAgICAgICAgICAgdmFyICRkaXJlY3RidXR0b25fYmF0Y2hodHRwbGlua19idXR0b24gPSAkKCc8YSBpZD0iYmF0Y2hodHRwbGluay1kaXJlY3QiIGNsYXNzPSJnLWJ1dHRvbi1tZW51IiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij7mibnph4/pk77mjqUoSFRUUCk8L2E+Jyk7CiAgICAgICAgICAgIHZhciAkZGlyZWN0YnV0dG9uX2JhdGNoaHR0cHNsaW5rX2J1dHRvbiA9ICQoJzxhIGlkPSJiYXRjaGh0dHBzbGluay1kaXJlY3QiIGNsYXNzPSJnLWJ1dHRvbi1tZW51IiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij7mibnph4/pk77mjqUoSFRUUFMpPC9hPicpOwogICAgICAgICAgICAkZGlyZWN0YnV0dG9uX21lbnUuYXBwZW5kKCRkaXJlY3RidXR0b25fZG93bmxvYWRfYnV0dG9uKS5hcHBlbmQoJGRpcmVjdGJ1dHRvbl9saW5rX2J1dHRvbikuYXBwZW5kKCRkaXJlY3RidXR0b25fYmF0Y2hodHRwbGlua19idXR0b24pLmFwcGVuZCgkZGlyZWN0YnV0dG9uX2JhdGNoaHR0cHNsaW5rX2J1dHRvbik7CiAgICAgICAgICAgICRkaXJlY3RidXR0b24uYXBwZW5kKCRkaXJlY3RidXR0b25fc3Bhbi5hcHBlbmQoJGRpcmVjdGJ1dHRvbl9hKS5hcHBlbmQoJGRpcmVjdGJ1dHRvbl9tZW51KSk7CiAgICAgICAgICAgICRkaXJlY3RidXR0b24uaG92ZXIoZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICRkaXJlY3RidXR0b25fc3Bhbi50b2dnbGVDbGFzcygnYnV0dG9uLW9wZW4nKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICRkaXJlY3RidXR0b25fZG93bmxvYWRfYnV0dG9uLmNsaWNrKGRvd25sb2FkQ2xpY2spOwogICAgICAgICAgICAkZGlyZWN0YnV0dG9uX2xpbmtfYnV0dG9uLmNsaWNrKGxpbmtDbGljayk7CiAgICAgICAgICAgICRkaXJlY3RidXR0b25fYmF0Y2hodHRwbGlua19idXR0b24uY2xpY2soYmF0Y2hDbGljayk7CiAgICAgICAgICAgICRkaXJlY3RidXR0b25fYmF0Y2hodHRwc2xpbmtfYnV0dG9uLmNsaWNrKGJhdGNoQ2xpY2spOwoKICAgICAgICAgICAgdmFyICRhcGlidXR0b24gPSAkKCc8c3BhbiBjbGFzcz0iZy1idXR0b24tbWVudSIgc3R5bGU9ImRpc3BsYXk6YmxvY2siPjwvc3Bhbj4nKTsKICAgICAgICAgICAgdmFyICRhcGlidXR0b25fc3BhbiA9ICQoJzxzcGFuIGNsYXNzPSJnLWRyb3Bkb3duLWJ1dHRvbiBnLWRyb3Bkb3duLWJ1dHRvbi1zZWNvbmQiIG1lbnVsZXZlbD0iMiI+PC9zcGFuPicpOwogICAgICAgICAgICB2YXIgJGFwaWJ1dHRvbl9hID0gJCgnPGEgY2xhc3M9ImctYnV0dG9uIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij48c3BhbiBjbGFzcz0iZy1idXR0b24tcmlnaHQiPjxzcGFuIGNsYXNzPSJ0ZXh0IiBzdHlsZT0id2lkdGg6YXV0byI+QVBJ5LiL6L29PC9zcGFuPjwvc3Bhbj48L2E+Jyk7CiAgICAgICAgICAgIHZhciAkYXBpYnV0dG9uX21lbnUgPSAkKCc8c3BhbiBjbGFzcz0ibWVudSIgc3R5bGU9IndpZHRoOjEyMHB4O2xlZnQ6NzdweCI+PC9zcGFuPicpOwogICAgICAgICAgICB2YXIgJGFwaWJ1dHRvbl9kb3dubG9hZF9idXR0b24gPSAkKCc8YSBpZD0iZG93bmxvYWQtYXBpIiBjbGFzcz0iZy1idXR0b24tbWVudSIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyI+5LiL6L29PC9hPicpOwogICAgICAgICAgICB2YXIgJGFwaWJ1dHRvbl9saW5rX2J1dHRvbiA9ICQoJzxhIGlkPSJodHRwbGluay1hcGkiIGNsYXNzPSJnLWJ1dHRvbi1tZW51IiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij7mmL7npLrpk77mjqU8L2E+Jyk7CiAgICAgICAgICAgIHZhciAkYXBpYnV0dG9uX2JhdGNoaHR0cGxpbmtfYnV0dG9uID0gJCgnPGEgaWQ9ImJhdGNoaHR0cGxpbmstYXBpIiBjbGFzcz0iZy1idXR0b24tbWVudSIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyI+5om56YeP6ZO+5o6lKEhUVFApPC9hPicpOwogICAgICAgICAgICB2YXIgJGFwaWJ1dHRvbl9iYXRjaGh0dHBzbGlua19idXR0b24gPSAkKCc8YSBpZD0iYmF0Y2hodHRwc2xpbmstYXBpIiBjbGFzcz0iZy1idXR0b24tbWVudSIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyI+5om56YeP6ZO+5o6lKEhUVFBTKTwvYT4nKTsKICAgICAgICAgICAgJGFwaWJ1dHRvbl9tZW51LmFwcGVuZCgkYXBpYnV0dG9uX2Rvd25sb2FkX2J1dHRvbikuYXBwZW5kKCRhcGlidXR0b25fbGlua19idXR0b24pLmFwcGVuZCgkYXBpYnV0dG9uX2JhdGNoaHR0cGxpbmtfYnV0dG9uKS5hcHBlbmQoJGFwaWJ1dHRvbl9iYXRjaGh0dHBzbGlua19idXR0b24pOwogICAgICAgICAgICAkYXBpYnV0dG9uLmFwcGVuZCgkYXBpYnV0dG9uX3NwYW4uYXBwZW5kKCRhcGlidXR0b25fYSkuYXBwZW5kKCRhcGlidXR0b25fbWVudSkpOwogICAgICAgICAgICAkYXBpYnV0dG9uLmhvdmVyKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAkYXBpYnV0dG9uX3NwYW4udG9nZ2xlQ2xhc3MoJ2J1dHRvbi1vcGVuJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkYXBpYnV0dG9uX2Rvd25sb2FkX2J1dHRvbi5jbGljayhkb3dubG9hZENsaWNrKTsKICAgICAgICAgICAgJGFwaWJ1dHRvbl9saW5rX2J1dHRvbi5jbGljayhsaW5rQ2xpY2spOwogICAgICAgICAgICAkYXBpYnV0dG9uX2JhdGNoaHR0cGxpbmtfYnV0dG9uLmNsaWNrKGJhdGNoQ2xpY2spOwogICAgICAgICAgICAkYXBpYnV0dG9uX2JhdGNoaHR0cHNsaW5rX2J1dHRvbi5jbGljayhiYXRjaENsaWNrKTsKCiAgICAgICAgICAgIHZhciAkb3V0ZXJsaW5rYnV0dG9uID0gJCgnPHNwYW4gY2xhc3M9ImctYnV0dG9uLW1lbnUiIHN0eWxlPSJkaXNwbGF5OmJsb2NrIj48L3NwYW4+Jyk7CiAgICAgICAgICAgIHZhciAkb3V0ZXJsaW5rYnV0dG9uX3NwYW4gPSAkKCc8c3BhbiBjbGFzcz0iZy1kcm9wZG93bi1idXR0b24gZy1kcm9wZG93bi1idXR0b24tc2Vjb25kIiBtZW51bGV2ZWw9IjIiPjwvc3Bhbj4nKTsKICAgICAgICAgICAgdmFyICRvdXRlcmxpbmtidXR0b25fYSA9ICQoJzxhIGNsYXNzPSJnLWJ1dHRvbiIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyI+PHNwYW4gY2xhc3M9ImctYnV0dG9uLXJpZ2h0Ij48c3BhbiBjbGFzcz0idGV4dCIgc3R5bGU9IndpZHRoOmF1dG8iPuWklumTvuS4i+i9vTwvc3Bhbj48L3NwYW4+PC9hPicpOwogICAgICAgICAgICB2YXIgJG91dGVybGlua2J1dHRvbl9tZW51ID0gJCgnPHNwYW4gY2xhc3M9Im1lbnUiIHN0eWxlPSJ3aWR0aDoxMjBweDtsZWZ0Ojc5cHgiPjwvc3Bhbj4nKTsKICAgICAgICAgICAgdmFyICRvdXRlcmxpbmtidXR0b25fZG93bmxvYWRfYnV0dG9uID0gJCgnPGEgaWQ9ImRvd25sb2FkLW91dGVybGluayIgY2xhc3M9ImctYnV0dG9uLW1lbnUiIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKTsiPuS4i+i9vTwvYT4nKTsKICAgICAgICAgICAgdmFyICRvdXRlcmxpbmtidXR0b25fbGlua19idXR0b24gPSAkKCc8YSBpZD0ibGluay1vdXRlcmxpbmsiIGNsYXNzPSJnLWJ1dHRvbi1tZW51IiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij7mmL7npLrpk77mjqU8L2E+Jyk7CiAgICAgICAgICAgIHZhciAkb3V0ZXJsaW5rYnV0dG9uX2JhdGNobGlua19idXR0b24gPSAkKCc8YSBpZD0iYmF0Y2hsaW5rLW91dGVybGluayIgY2xhc3M9ImctYnV0dG9uLW1lbnUiIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKTsiPuaJuemHj+mTvuaOpTwvYT4nKTsKICAgICAgICAgICAgJG91dGVybGlua2J1dHRvbl9tZW51LmFwcGVuZCgkb3V0ZXJsaW5rYnV0dG9uX2Rvd25sb2FkX2J1dHRvbikuYXBwZW5kKCRvdXRlcmxpbmtidXR0b25fbGlua19idXR0b24pLmFwcGVuZCgkb3V0ZXJsaW5rYnV0dG9uX2JhdGNobGlua19idXR0b24pOwogICAgICAgICAgICAkb3V0ZXJsaW5rYnV0dG9uLmFwcGVuZCgkb3V0ZXJsaW5rYnV0dG9uX3NwYW4uYXBwZW5kKCRvdXRlcmxpbmtidXR0b25fYSkuYXBwZW5kKCRvdXRlcmxpbmtidXR0b25fbWVudSkpOwogICAgICAgICAgICAkb3V0ZXJsaW5rYnV0dG9uLmhvdmVyKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAkb3V0ZXJsaW5rYnV0dG9uX3NwYW4udG9nZ2xlQ2xhc3MoJ2J1dHRvbi1vcGVuJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkb3V0ZXJsaW5rYnV0dG9uX2Rvd25sb2FkX2J1dHRvbi5jbGljayhkb3dubG9hZENsaWNrKTsKICAgICAgICAgICAgJG91dGVybGlua2J1dHRvbl9saW5rX2J1dHRvbi5jbGljayhsaW5rQ2xpY2spOwogICAgICAgICAgICAkb3V0ZXJsaW5rYnV0dG9uX2JhdGNobGlua19idXR0b24uY2xpY2soYmF0Y2hDbGljayk7CgogICAgICAgICAgICAkZHJvcGRvd25idXR0b25fc3Bhbi5hcHBlbmQoJGRpcmVjdGJ1dHRvbikuYXBwZW5kKCRhcGlidXR0b24pLmFwcGVuZCgkb3V0ZXJsaW5rYnV0dG9uKTsKICAgICAgICAgICAgJGRyb3Bkb3duYnV0dG9uLmFwcGVuZCgkZHJvcGRvd25idXR0b25fYSkuYXBwZW5kKCRkcm9wZG93bmJ1dHRvbl9zcGFuKTsKCiAgICAgICAgICAgICRkcm9wZG93bmJ1dHRvbi5ob3ZlcihmdW5jdGlvbigpewogICAgICAgICAgICAgICAgJGRyb3Bkb3duYnV0dG9uLnRvZ2dsZUNsYXNzKCdidXR0b24tb3BlbicpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIC8vJCgnZGl2LmRlZmF1bHQtZG9tIGRpdi5iYXIgZGl2Lmxpc3QtdG9vbHMnKS5hcHBlbmQoJGRyb3Bkb3duYnV0dG9uKTsKICAgICAgICAgICAgLy8kKCdkaXYuaXJoVzlwWiBkaXYueXFnUjc0NyBkaXYuUURET1FCJykuYXBwZW5kKCRkcm9wZG93bmJ1dHRvbik7CiAgICAgICAgICAgICQoJ2Rpdi4nK3dvcmRNYXBbJ2RlZmF1bHQtZG9tJ10rJyBkaXYuJyt3b3JkTWFwWydiYXInXSsnIGRpdi4nK3dvcmRNYXBbJ2xpc3QtdG9vbHMnXSkuYXBwZW5kKCRkcm9wZG93bmJ1dHRvbik7CiAgICAgICAgfQoKICAgICAgICAvL+aaguaXtuayoeeUqAogICAgICAgIC8vIGZ1bmN0aW9uIGFkZExvYWRpbmcoKXsKICAgICAgICAvLyAgICAgdmFyIHNjcmVlbldpZHRoID0gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDsKICAgICAgICAvLyAgICAgdmFyIHNjcmVlbkhlaWdodCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0OwogICAgICAgIC8vICAgICB2YXIgbGVmdCA9IChzY3JlZW5XaWR0aC0xMCkvMjsKICAgICAgICAvLyAgICAgdmFyIHRvcCA9IHNjcmVlbkhlaWdodC8yOwogICAgICAgIC8vICAgICB2YXIgJGxvYWRpbmcgPSAkKCc8ZGl2IGlkPSJkaWFsb2ctbG9hZGluZyIgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6JytsZWZ0KydweDt0b3A6Jyt0b3ArJ3B4O2Rpc3BsYXk6bm9uZTt6LWluZGV4OjUyO2NvbG9yOndoaXRlO2ZvbnQtc2l6ZToxNnB4Ij7lpITnkIbkuK08L2Rpdj4nKTsKICAgICAgICAvLyAgICAgJCgnYm9keScpLmFwcGVuZCgkbG9hZGluZyk7CiAgICAgICAgLy8gfQoKICAgICAgICBmdW5jdGlvbiBkb3dubG9hZENsaWNrKGV2ZW50KXsKICAgICAgICAgICAgc2xvZygn6YCJ5Lit5paH5Lu25YiX6KGo77yaJyxzZWxlY3RGaWxlTGlzdCk7CiAgICAgICAgICAgIHZhciBpZCA9IGV2ZW50LnRhcmdldC5pZDsKICAgICAgICAgICAgdmFyIGRvd25sb2FkTGluazsKCiAgICAgICAgICAgIGlmKGlkID09ICdkb3dubG9hZC1kaXJlY3QnKXsKICAgICAgICAgICAgICAgIHZhciBkb3dubG9hZFR5cGU7CiAgICAgICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICBhbGVydCgi6I635Y+W6YCJ5Lit5paH5Lu25aSx6LSl77yM6K+35Yi35paw6YeN6K+V77yBIik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RGaWxlTGlzdC5sZW5ndGggPT0gMSkgewogICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RGaWxlTGlzdFswXS5pc2RpciA9PT0gMSkKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRUeXBlID0gJ2JhdGNoJzsKICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzZWxlY3RGaWxlTGlzdFswXS5pc2RpciA9PT0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRUeXBlPSAnZGxpbmsnOwogICAgICAgICAgICAgICAgICAgIC8vZG93bmxvYWRUeXBlID0gc2VsZWN0RmlsZUxpc3RbMF0uaXNkaXI9PTE/J2JhdGNoJzooc2VsZWN0RmlsZUxpc3RbMF0uaXNkaXI9PT0wPydkbGluayc6J2JhdGNoJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoc2VsZWN0RmlsZUxpc3QubGVuZ3RoID4gMSl7CiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRUeXBlID0gJ2JhdGNoJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZpZF9saXN0ID0gZ2V0RmlkTGlzdChzZWxlY3RGaWxlTGlzdCk7CiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZ2V0RG93bmxvYWRMaW5rV2l0aFBhbkFQSShkb3dubG9hZFR5cGUpOwogICAgICAgICAgICAgICAgaWYocmVzdWx0LmVycm5vID09PSAwKXsKICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFR5cGUgPT0gJ2RsaW5rJykKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaW5rID0gcmVzdWx0LmRsaW5rWzBdLmRsaW5rOwogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoZG93bmxvYWRUeXBlID09ICdiYXRjaCcpewogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZExpbmsgPSByZXN1bHQuZGxpbms7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PT0gMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGluayA9IGRvd25sb2FkTGluayArICcmemlwbmFtZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHNlbGVjdEZpbGVMaXN0WzBdLmZpbGVuYW1lKSArICcuemlwJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIuWPkeeUn+mUmeivr++8gSIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIGlmKHJlc3VsdC5lcnJubyA9PSAtMSl7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+aWh+S7tuS4jeWtmOWcqOaIluW3suiiq+eZvuW6puWSjOiwkO+8jOaXoOazleS4i+i9ve+8gScpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH1lbHNlIGlmKHJlc3VsdC5lcnJubyA9PSAxMTIpewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLpobXpnaLov4fmnJ/vvIzor7fliLfmlrDph43or5XvvIEiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBhbGVydCgi5Y+R55Sf6ZSZ6K+v77yBIik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLojrflj5bpgInkuK3mlofku7blpLHotKXvvIzor7fliLfmlrDph43or5XvvIEiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgICAgICBhbGVydCgi6K+l5pa55rOV5LiN5pSv5oyB5aSa5paH5Lu25LiL6L2977yBIik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdFswXS5pc2RpciA9PSAxKXsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIuivpeaWueazleS4jeaUr+aMgeebruW9leS4i+i9ve+8gSIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoaWQgPT0gJ2Rvd25sb2FkLWFwaScpewogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGluayA9IGdldERvd25sb2FkTGlua1dpdGhSRVNUQVBJQmFpZHUoc2VsZWN0RmlsZUxpc3RbMF0ucGF0aCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09ICdkb3dubG9hZC1vdXRlcmxpbmsnKXsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZ2V0RG93bmxvYWRMaW5rV2l0aENsaWVudEFQSShzZWxlY3RGaWxlTGlzdFswXS5wYXRoKTsKICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQuZXJybm8gPT0gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGluayA9IHJlc3VsdC51cmxzWzBdLnVybDsKICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihyZXN1bHQuZXJybm8gPT0gMSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfmlofku7bkuI3lrZjlnKjvvIEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKHJlc3VsdC5lcnJubyA9PSAyKXsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+aWh+S7tuS4jeWtmOWcqOaIluiAheW3suiiq+eZvuW6puWSjOiwkO+8jOaXoOazleS4i+i9ve+8gScpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCflj5HnlJ/plJnor6/vvIEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBleGVjRG93bmxvYWQoZG93bmxvYWRMaW5rKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGxpbmtDbGljayhldmVudCl7CiAgICAgICAgICAgIHNsb2coJ+mAieS4reaWh+S7tuWIl+ihqO+8micsc2VsZWN0RmlsZUxpc3QpOwogICAgICAgICAgICB2YXIgaWQgPSBldmVudC50YXJnZXQuaWQ7CiAgICAgICAgICAgIHZhciBsaW5rTGlzdCx0aXA7CgogICAgICAgICAgICBpZihpZC5pbmRleE9mKCdkaXJlY3QnKSAhPSAtMSl7CiAgICAgICAgICAgICAgICB2YXIgZG93bmxvYWRUeXBlOwogICAgICAgICAgICAgICAgdmFyIGRvd25sb2FkTGluazsKICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLojrflj5bpgInkuK3mlofku7blpLHotKXvvIzor7fliLfmlrDph43or5XvvIEiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdEZpbGVMaXN0WzBdLmlzZGlyID09PSAxKQogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFR5cGUgPSAnYmF0Y2gnOwogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGVjdEZpbGVMaXN0WzBdLmlzZGlyID09PSAwKQogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFR5cGU9ICdkbGluayc7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoc2VsZWN0RmlsZUxpc3QubGVuZ3RoID4gMSl7CiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRUeXBlID0gJ2JhdGNoJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZpZF9saXN0ID0gZ2V0RmlkTGlzdChzZWxlY3RGaWxlTGlzdCk7CiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZ2V0RG93bmxvYWRMaW5rV2l0aFBhbkFQSShkb3dubG9hZFR5cGUpOwogICAgICAgICAgICAgICAgaWYocmVzdWx0LmVycm5vID09PSAwKXsKICAgICAgICAgICAgICAgICAgICBpZihkb3dubG9hZFR5cGUgPT0gJ2RsaW5rJykKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaW5rID0gcmVzdWx0LmRsaW5rWzBdLmRsaW5rOwogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoZG93bmxvYWRUeXBlID09ICdiYXRjaCcpewogICAgICAgICAgICAgICAgICAgICAgICBzbG9nKHNlbGVjdEZpbGVMaXN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaW5rID0gcmVzdWx0LmRsaW5rOwogICAgICAgICAgICAgICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdC5sZW5ndGggPT09IDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZExpbmsgPSBkb3dubG9hZExpbmsgKyAnJnppcG5hbWU9JyArIGVuY29kZVVSSUNvbXBvbmVudChzZWxlY3RGaWxlTGlzdFswXS5maWxlbmFtZSkgKyAnLnppcCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLlj5HnlJ/plJnor6/vvIEiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1lbHNlIGlmKHJlc3VsdC5lcnJubyA9PSAtMSl7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+aWh+S7tuS4jeWtmOWcqOaIluW3suiiq+eZvuW6puWSjOiwkO+8jOaXoOazleS4i+i9ve+8gScpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH1lbHNlIGlmKHJlc3VsdC5lcnJubyA9PSAxMTIpewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLpobXpnaLov4fmnJ/vvIzor7fliLfmlrDph43or5XvvIEiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBhbGVydCgi5Y+R55Sf6ZSZ6K+v77yBIik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGh0dHBsaW5rID0gZG93bmxvYWRMaW5rLnJlcGxhY2UoL14oW0EtWmEtel0rKTovLCdodHRwOicpOwogICAgICAgICAgICAgICAgdmFyIGh0dHBzbGluayA9IGRvd25sb2FkTGluay5yZXBsYWNlKC9eKFtBLVphLXpdKyk6LywnaHR0cHM6Jyk7CiAgICAgICAgICAgICAgICB2YXIgZmlsZW5hbWUgPSAnJzsKICAgICAgICAgICAgICAgICQuZWFjaChzZWxlY3RGaWxlTGlzdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdC5sZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBlbGVtZW50LmZpbGVuYW1lOwogICAgICAgICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZGV4ID09MCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gZWxlbWVudC5maWxlbmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBmaWxlbmFtZSArICcsJyArIGVsZW1lbnQuZmlsZW5hbWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBsaW5rTGlzdCA9IHsKICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTpmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICB1cmxzOlsKICAgICAgICAgICAgICAgICAgICAgICAge3VybDpodHRwbGluayxyYW5rOjF9LAogICAgICAgICAgICAgICAgICAgICAgICB7dXJsOmh0dHBzbGluayxyYW5rOjJ9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHRpcCA9ICfmmL7npLrmqKHmi5/nmb7luqbnvZHnm5jnvZHpobXojrflj5bnmoTpk77mjqXvvIzlj6/ku6Xkvb/nlKjlj7PplK7ov4Xpm7fkuIvovb3vvIzlpI3liLbliLDkuIvovb3lt6XlhbfpnIDopoHkvKDpgJJjb29raWXvvIzlpJrmlofku7bmiZPljIXkuIvovb3nmoTpk77mjqXlj6/ku6Xnm7TmjqXlpI3liLbkvb/nlKgnOwogICAgICAgICAgICAgICAgZGlhbG9nLm9wZW4oe3RpdGxlOifkuIvovb3pk77mjqUnLHR5cGU6J2xpbmsnLGxpc3Q6bGlua0xpc3QsdGlwOnRpcH0pOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLojrflj5bpgInkuK3mlofku7blpLHotKXvvIzor7fliLfmlrDph43or5XvvIEiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgICAgICBhbGVydCgi6K+l5pa55rOV5LiN5pSv5oyB5aSa5paH5Lu25LiL6L2977yBIik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdFswXS5pc2RpciA9PSAxKXsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIuivpeaWueazleS4jeaUr+aMgeebruW9leS4i+i9ve+8gSIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoaWQuaW5kZXhPZignYXBpJykgIT0gLTEpewogICAgICAgICAgICAgICAgICAgIHZhciBkb3dubG9hZExpbmsgPSBnZXREb3dubG9hZExpbmtXaXRoUkVTVEFQSUJhaWR1KHNlbGVjdEZpbGVMaXN0WzBdLnBhdGgpOwogICAgICAgICAgICAgICAgICAgIHZhciBodHRwbGluayA9IGRvd25sb2FkTGluay5yZXBsYWNlKC9eKFtBLVphLXpdKyk6LywnaHR0cDonKTsKICAgICAgICAgICAgICAgICAgICB2YXIgaHR0cHNsaW5rID0gZG93bmxvYWRMaW5rLnJlcGxhY2UoL14oW0EtWmEtel0rKTovLCdodHRwczonKTsKICAgICAgICAgICAgICAgICAgICBsaW5rTGlzdCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6c2VsZWN0RmlsZUxpc3RbMF0uZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHVybHM6WwogICAgICAgICAgICAgICAgICAgICAgICAgICAge3VybDpodHRwbGluayxyYW5rOjF9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAge3VybDpodHRwc2xpbmsscmFuazoyfQogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBodHRwbGluayA9IGh0dHBsaW5rLnJlcGxhY2UoJzI1MDUyOCcsJzI2NjcxOScpOwogICAgICAgICAgICAgICAgICAgIGh0dHBzbGluayA9IGh0dHBzbGluay5yZXBsYWNlKCcyNTA1MjgnLCcyNjY3MTknKTsKICAgICAgICAgICAgICAgICAgICBsaW5rTGlzdC51cmxzLnB1c2goe3VybDpodHRwbGluayxyYW5rOjN9KTsKICAgICAgICAgICAgICAgICAgICBsaW5rTGlzdC51cmxzLnB1c2goe3VybDpodHRwc2xpbmsscmFuazo0fSk7CiAgICAgICAgICAgICAgICAgICAgdGlwID0gJ+aYvuekuuaooeaLn0FQUOiOt+WPlueahOmTvuaOpSjkvb/nlKjnmb7luqbkupFJRCnvvIzlj6/ku6Xkvb/nlKjlj7PplK7ov4Xpm7fkuIvovb3vvIzlpI3liLbliLDkuIvovb3lt6XlhbfpnIDopoHkvKDpgJJjb29raWUnOwogICAgICAgICAgICAgICAgICAgIGRpYWxvZy5vcGVuKHt0aXRsZTon5LiL6L296ZO+5o6lJyx0eXBlOidsaW5rJyxsaXN0OmxpbmtMaXN0LHRpcDp0aXB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQuaW5kZXhPZignb3V0ZXJsaW5rJykgIT0gLTEpewogICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBnZXREb3dubG9hZExpbmtXaXRoQ2xpZW50QVBJKHNlbGVjdEZpbGVMaXN0WzBdLnBhdGgpOwogICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdC5lcnJubyA9PSAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgbGlua0xpc3QgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTpzZWxlY3RGaWxlTGlzdFswXS5maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybHM6cmVzdWx0LnVybHMKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihyZXN1bHQuZXJybm8gPT0gMSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfmlofku7bkuI3lrZjlnKjvvIEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKHJlc3VsdC5lcnJubyA9PSAyKXsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+aWh+S7tuS4jeWtmOWcqOaIluiAheW3suiiq+eZvuW6puWSjOiwkO+8jOaXoOazleS4i+i9ve+8gScpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCflj5HnlJ/plJnor6/vvIEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aXAgPSAn5pi+56S65qih5ouf55m+5bqm572R55uY5a6i5oi356uv6I635Y+W55qE6ZO+5o6l77yM5Y+v5Lul55u05o6l5aSN5Yi25Yiw5LiL6L295bel5YW35L2/55So77yM5LiN6ZyA6KaBY29va2llJzsKICAgICAgICAgICAgICAgICAgICBkaWFsb2cub3Blbih7dGl0bGU6J+S4i+i9vemTvuaOpScsdHlwZTonbGluaycsbGlzdDpsaW5rTGlzdCx0aXA6dGlwLHNob3djb3B5OnRydWUsc2hvd2VkaXQ6dHJ1ZX0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vZGlhbG9nLm9wZW4oe3RpdGxlOifkuIvovb3pk77mjqUnLHR5cGU6J2xpbmsnLGxpc3Q6bGlua0xpc3QsdGlwOnRpcH0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYmF0Y2hDbGljayhldmVudCl7CiAgICAgICAgICAgIHNsb2coJ+mAieS4reaWh+S7tuWIl+ihqO+8micsc2VsZWN0RmlsZUxpc3QpOwogICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdC5sZW5ndGggPT09IDApewogICAgICAgICAgICAgICAgYWxlcnQoJ+iOt+WPlumAieS4reaWh+S7tuWksei0pe+8jOivt+WIt+aWsOmHjeivle+8gScpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBpZCA9IGV2ZW50LnRhcmdldC5pZDsKICAgICAgICAgICAgdmFyIGxpbmtUeXBlLHRpcDsKICAgICAgICAgICAgbGlua1R5cGUgPSBpZC5pbmRleE9mKCdodHRwcycpID09IC0xID8gKGlkLmluZGV4T2YoJ2h0dHAnKSA9PSAtMSA/IGxvY2F0aW9uLnByb3RvY29sKyc6JyA6ICdodHRwOicpIDogJ2h0dHBzOic7CiAgICAgICAgICAgIGJhdGNoTGlua0xpc3QgPSBbXTsKICAgICAgICAgICAgYmF0Y2hMaW5rTGlzdEFsbCA9IFtdOwogICAgICAgICAgICBpZihpZC5pbmRleE9mKCdkaXJlY3QnKSAhPSAtMSl7CiAgICAgICAgICAgICAgICBiYXRjaExpbmtMaXN0ID0gZ2V0RGlyZWN0QmF0Y2hMaW5rKGxpbmtUeXBlKTsKICAgICAgICAgICAgICAgIHRpcCA9ICfmmL7npLrmiYDmnInpgInkuK3mlofku7bnmoTnm7TmjqXkuIvovb3pk77mjqXvvIzmlofku7blpLnmmL7npLrkuLrmiZPljIXkuIvovb3nmoTpk77mjqUnOwogICAgICAgICAgICAgICAgaWYoYmF0Y2hMaW5rTGlzdC5sZW5ndGggPT09IDApewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfmsqHmnInpk77mjqXlj6/ku6XmmL7npLrvvIxBUEnpk77mjqXkuI3opoHlhajpg6jpgInkuK3mlofku7blpLnvvIEnKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkaWFsb2cub3Blbih7dGl0bGU6J+aJuemHj+mTvuaOpScsdHlwZTonYmF0Y2gnLGxpc3Q6YmF0Y2hMaW5rTGlzdCx0aXA6dGlwLHNob3djb3B5OnRydWV9KTsKICAgICAgICAgICAgfSBlbHNlIGlmKGlkLmluZGV4T2YoJ2FwaScpICE9IC0xKXsKICAgICAgICAgICAgICAgIGJhdGNoTGlua0xpc3QgPSBnZXRBUElCYXRjaExpbmsobGlua1R5cGUpOwogICAgICAgICAgICAgICAgdGlwID0gJ+aYvuekuuaJgOaciemAieS4reaWh+S7tueahEFQSeS4i+i9vemTvuaOpe+8jOS4jeaYvuekuuaWh+S7tuWkuSc7CiAgICAgICAgICAgICAgICBpZihiYXRjaExpbmtMaXN0Lmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+ayoeaciemTvuaOpeWPr+S7peaYvuekuu+8jEFQSemTvuaOpeS4jeimgeWFqOmDqOmAieS4reaWh+S7tuWkue+8gScpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRpYWxvZy5vcGVuKHt0aXRsZTon5om56YeP6ZO+5o6lJyx0eXBlOidiYXRjaCcsbGlzdDpiYXRjaExpbmtMaXN0LHRpcDp0aXAsc2hvd2NvcHk6dHJ1ZX0pOwogICAgICAgICAgICB9IGVsc2UgaWYoaWQuaW5kZXhPZignb3V0ZXJsaW5rJykgIT0gLTEpewogICAgICAgICAgICAgICAgYmF0Y2hMaW5rTGlzdEFsbCA9IGdldE91dGVybGlua0JhdGNoTGlua0FsbCgpOwogICAgICAgICAgICAgICAgYmF0Y2hMaW5rTGlzdCA9IGdldE91dGVybGlua0JhdGNoTGlua0ZpcnN0KGJhdGNoTGlua0xpc3RBbGwpOwogICAgICAgICAgICAgICAgdGlwID0gJ+aYvuekuuaJgOaciemAieS4reaWh+S7tueahOWklumDqOS4i+i9vemTvuaOpe+8jOS4jeaYvuekuuaWh+S7tuWkuSc7CiAgICAgICAgICAgICAgICBpZihiYXRjaExpbmtMaXN0Lmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+ayoeaciemTvuaOpeWPr+S7peaYvuekuu+8jEFQSemTvuaOpeS4jeimgeWFqOmDqOmAieS4reaWh+S7tuWkue+8gScpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBkaWFsb2cub3Blbih7dGl0bGU6J+aJuemHj+mTvuaOpScsdHlwZTonYmF0Y2gnLGxpc3Q6YmF0Y2hMaW5rTGlzdCx0aXA6dGlwLHNob3djb3B5OnRydWUsYWxsbGlzdDpiYXRjaExpbmtMaXN0QWxsLHNob3dhbGw6dHJ1ZX0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL2RpYWxvZy5vcGVuKHt0aXRsZTon5om56YeP6ZO+5o6lJyx0eXBlOidiYXRjaCcsbGlzdDpiYXRjaExpbmtMaXN0LHRpcDp0aXAsc2hvd2NvcHk6dHJ1ZX0pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0RGlyZWN0QmF0Y2hMaW5rKGxpbmtUeXBlKXsKICAgICAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICAgICAgJC5lYWNoKHNlbGVjdEZpbGVMaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgdmFyIGRvd25sb2FkVHlwZSxkb3dubG9hZExpbmsscmVzdWx0OwogICAgICAgICAgICAgICAgaWYoZWxlbWVudC5pc2RpciA9PSAwKQogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVHlwZSA9ICdkbGluayc7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRUeXBlID0gJ2JhdGNoJzsKICAgICAgICAgICAgICAgIGZpZF9saXN0ID0gZ2V0RmlkTGlzdChbZWxlbWVudF0pOwogICAgICAgICAgICAgICAgcmVzdWx0ID0gZ2V0RG93bmxvYWRMaW5rV2l0aFBhbkFQSShkb3dubG9hZFR5cGUpOwogICAgICAgICAgICAgICAgaWYocmVzdWx0LmVycm5vID09IDApewogICAgICAgICAgICAgICAgICAgIGlmKGRvd25sb2FkVHlwZSA9PSAnZGxpbmsnKQogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZExpbmsgPSByZXN1bHQuZGxpbmtbMF0uZGxpbms7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihkb3dubG9hZFR5cGUgPT0gJ2JhdGNoJykKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRMaW5rID0gcmVzdWx0LmRsaW5rOwogICAgICAgICAgICAgICAgICAgIGRvd25sb2FkTGluayA9IGRvd25sb2FkTGluay5yZXBsYWNlKC9eKFtBLVphLXpdKyk6LyxsaW5rVHlwZSk7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZExpbmsgPSAnZXJyb3InOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGlzdC5wdXNoKHtmaWxlbmFtZTplbGVtZW50LmZpbGVuYW1lLGRvd25sb2FkbGluazpkb3dubG9hZExpbmt9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiBsaXN0OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0QVBJQmF0Y2hMaW5rKGxpbmtUeXBlKXsKICAgICAgICAgICAgdmFyIGxpc3QgPSBbXTsKICAgICAgICAgICAgJC5lYWNoKHNlbGVjdEZpbGVMaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgaWYoZWxlbWVudC5pc2RpciA9PSAxKQogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIHZhciBkb3dubG9hZExpbms7CiAgICAgICAgICAgICAgICBkb3dubG9hZExpbmsgPSBnZXREb3dubG9hZExpbmtXaXRoUkVTVEFQSUJhaWR1KGVsZW1lbnQucGF0aCk7CiAgICAgICAgICAgICAgICBkb3dubG9hZExpbmsgPSBkb3dubG9hZExpbmsucmVwbGFjZSgvXihbQS1aYS16XSspOi8sbGlua1R5cGUpOwogICAgICAgICAgICAgICAgbGlzdC5wdXNoKHtmaWxlbmFtZTplbGVtZW50LmZpbGVuYW1lLGRvd25sb2FkbGluazpkb3dubG9hZExpbmt9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiBsaXN0OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0T3V0ZXJsaW5rQmF0Y2hMaW5rQWxsKCl7CiAgICAgICAgICAgIHZhciBsaXN0ID0gW107CiAgICAgICAgICAgICQuZWFjaChzZWxlY3RGaWxlTGlzdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgICAgICAgICBpZihlbGVtZW50LmlzZGlyID09IDEpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgcmVzdWx0ID0gZ2V0RG93bmxvYWRMaW5rV2l0aENsaWVudEFQSShlbGVtZW50LnBhdGgpOwogICAgICAgICAgICAgICAgaWYocmVzdWx0LmVycm5vID09IDApewogICAgICAgICAgICAgICAgICAgIC8vZG93bmxvYWRMaW5rID0gcmVzdWx0LnVybHNbMF0udXJsOwogICAgICAgICAgICAgICAgICAgIGxpc3QucHVzaCh7ZmlsZW5hbWU6ZWxlbWVudC5maWxlbmFtZSxsaW5rczpyZXN1bHQudXJsc30pOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgLy9kb3dubG9hZExpbmsgPSAnZXJyb3InOwogICAgICAgICAgICAgICAgICAgIGxpc3QucHVzaCh7ZmlsZW5hbWU6ZWxlbWVudC5maWxlbmFtZSxsaW5rczpbe3Jhbms6MSx1cmw6J2Vycm9yJ31dfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvL2xpc3QucHVzaCh7ZmlsZW5hbWU6ZWxlbWVudC5maWxlbmFtZSxkb3dubG9hZGxpbms6ZG93bmxvYWRMaW5rfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gbGlzdDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldE91dGVybGlua0JhdGNoTGlua0ZpcnN0KGxpc3QpewogICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107CiAgICAgICAgICAgICQuZWFjaChsaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goe2ZpbGVuYW1lOmVsZW1lbnQuZmlsZW5hbWUsZG93bmxvYWRsaW5rOmVsZW1lbnQubGlua3NbMF0udXJsfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0U2lnbigpewogICAgICAgICAgICB2YXIgc2lnbkZuYzsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgc2lnbkZuYyA9IG5ldyBGdW5jdGlvbigicmV0dXJuICIgKyB5dW5EYXRhLnNpZ24yKSgpOwogICAgICAgICAgICB9IGNhdGNoKGUpewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGUubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGJhc2U2NEVuY29kZShzaWduRm5jKHl1bkRhdGEuc2lnbjUseXVuRGF0YS5zaWduMSkpOwogICAgICAgIH0KCiAgICAgICAgLy/ojrflj5blvZPliY3nm67lvZUKICAgICAgICBmdW5jdGlvbiBnZXRQYXRoKCl7CiAgICAgICAgICAgIHZhciBoYXNoID0gbG9jYXRpb24uaGFzaDsKICAgICAgICAgICAgdmFyIHJlZ3ggPSAvKF58JnxcLylwYXRoPShbXiZdKikoJnwkKS9pOwogICAgICAgICAgICB2YXIgcmVzdWx0ID0gaGFzaC5tYXRjaChyZWd4KTsKICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRbMl0pOwogICAgICAgIH0KCiAgICAgICAgLy/ojrflj5bliIbnsbvmmL7npLrnmoTnsbvliKvvvIzljbPlnLDlnYDmoI/kuK3nmoR0eXBlCiAgICAgICAgZnVuY3Rpb24gZ2V0Q2F0ZWdvcnkoKXsKICAgICAgICAgICAgdmFyIGhhc2ggPSBsb2NhdGlvbi5oYXNoOwogICAgICAgICAgICB2YXIgcmVneCA9IC8oXnwmfFwvKXR5cGU9KFteJl0qKSgmfCQpL2k7CiAgICAgICAgICAgIHZhciByZXN1bHQgPSBoYXNoLm1hdGNoKHJlZ3gpOwogICAgICAgICAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdFsyXSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnZXRTZWFyY2hLZXkoKXsKICAgICAgICAgICAgdmFyIGhhc2ggPSBsb2NhdGlvbi5oYXNoOwogICAgICAgICAgICB2YXIgcmVneCA9IC8oXnwmfFwvKWtleT0oW14mXSopKCZ8JCkvaTsKICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGhhc2gubWF0Y2gocmVneCk7CiAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0WzJdKTsKICAgICAgICB9CgogICAgICAgIC8v6I635Y+W5b2T5YmN6aG16Z2iKGxpc3TmiJbogIVjYXRlZ29yeSkKICAgICAgICBmdW5jdGlvbiBnZXRDdXJyZW50UGFnZSgpewogICAgICAgICAgICB2YXIgaGFzaCA9IGxvY2F0aW9uLmhhc2g7CiAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoaGFzaC5zdWJzdHJpbmcoaGFzaC5pbmRleE9mKCcjJykrMSxoYXNoLmluZGV4T2YoJy8nKSkpOwogICAgICAgIH0KCiAgICAgICAgLy/ojrflj5bmlofku7bliJfooagKICAgICAgICBmdW5jdGlvbiBnZXRGaWxlTGlzdCgpewogICAgICAgICAgICB2YXIgZmlsZWxpc3QgPSBbXTsKICAgICAgICAgICAgdmFyIGxpc3RVcmwgPSBwYW5BUElVcmwgKyAibGlzdCI7CiAgICAgICAgICAgIHZhciBwYXRoID0gZ2V0UGF0aCgpOwogICAgICAgICAgICBsb2dpZCA9IGdldExvZ0lEKCk7CiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICAgICAgICBkaXI6cGF0aCwKICAgICAgICAgICAgICAgIGJkc3Rva2VuOmJkc3Rva2VuLAogICAgICAgICAgICAgICAgbG9naWQ6bG9naWQsCiAgICAgICAgICAgICAgICBvcmRlcjonc2l6ZScsCiAgICAgICAgICAgICAgICBkZXNjOjAsCiAgICAgICAgICAgICAgICBjbGllbnR0eXBlOjAsCiAgICAgICAgICAgICAgICBzaG93ZW1wdHk6MCwKICAgICAgICAgICAgICAgIHdlYjoxLAogICAgICAgICAgICAgICAgY2hhbm5lbDonY2h1bmxlaScsCiAgICAgICAgICAgICAgICBhcHBpZDoyNTA1MjgKICAgICAgICAgICAgfTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDpsaXN0VXJsLAogICAgICAgICAgICAgICAgYXN5bmM6ZmFsc2UsCiAgICAgICAgICAgICAgICBtZXRob2Q6J0dFVCcsCiAgICAgICAgICAgICAgICBkYXRhOnBhcmFtcywKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgIGZpbGVsaXN0ID0gMD09PXJlc3BvbnNlLmVycm5vID8gcmVzcG9uc2UubGlzdCA6IFtdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGZpbGVsaXN0OwogICAgICAgIH0KCiAgICAgICAgLy/ojrflj5bliIbnsbvpobXpnaLkuIvnmoTmlofku7bliJfooagKICAgICAgICBmdW5jdGlvbiBnZXRDYXRlZ29yeUZpbGVMaXN0KCl7CiAgICAgICAgICAgIHZhciBmaWxlbGlzdCA9IFtdOwogICAgICAgICAgICB2YXIgbGlzdFVybCA9IHBhbkFQSVVybCArICJjYXRlZ29yeWxpc3QiOwogICAgICAgICAgICB2YXIgY2F0ZWdvcnkgPSBnZXRDYXRlZ29yeSgpOwogICAgICAgICAgICBsb2dpZCA9IGdldExvZ0lEKCk7CiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICAgICAgICBjYXRlZ29yeTpjYXRlZ29yeSwKICAgICAgICAgICAgICAgIGJkc3Rva2VuOmJkc3Rva2VuLAogICAgICAgICAgICAgICAgbG9naWQ6bG9naWQsCiAgICAgICAgICAgICAgICBvcmRlcjonc2l6ZScsCiAgICAgICAgICAgICAgICBkZXNjOjAsCiAgICAgICAgICAgICAgICBjbGllbnR0eXBlOjAsCiAgICAgICAgICAgICAgICBzaG93ZW1wdHk6MCwKICAgICAgICAgICAgICAgIHdlYjoxLAogICAgICAgICAgICAgICAgY2hhbm5lbDonY2h1bmxlaScsCiAgICAgICAgICAgICAgICBhcHBpZDoyNTA1MjgKICAgICAgICAgICAgfTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDpsaXN0VXJsLAogICAgICAgICAgICAgICAgYXN5bmM6ZmFsc2UsCiAgICAgICAgICAgICAgICBtZXRob2Q6J0dFVCcsCiAgICAgICAgICAgICAgICBkYXRhOnBhcmFtcywKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgIGZpbGVsaXN0ID0gMD09PXJlc3BvbnNlLmVycm5vID8gcmVzcG9uc2UuaW5mbyA6IFtdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGZpbGVsaXN0OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0U2VhcmNoRmlsZUxpc3QoKXsKICAgICAgICAgICAgdmFyIGZpbGVsaXN0ID0gW107CiAgICAgICAgICAgIHZhciBsaXN0VXJsID0gcGFuQVBJVXJsICsgJ3NlYXJjaCc7CiAgICAgICAgICAgIGxvZ2lkID0gZ2V0TG9nSUQoKTsKICAgICAgICAgICAgc2VhcmNoS2V5ID0gZ2V0U2VhcmNoS2V5KCk7CiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICAgICAgICByZWN1cnNpb246MSwKICAgICAgICAgICAgICAgIG9yZGVyOid0aW1lJywKICAgICAgICAgICAgICAgIGRlc2M6MSwKICAgICAgICAgICAgICAgIHNob3dlbXB0eTowLAogICAgICAgICAgICAgICAgd2ViOjEsCiAgICAgICAgICAgICAgICBwYWdlOjEsCiAgICAgICAgICAgICAgICBudW06MTAwLAogICAgICAgICAgICAgICAga2V5OnNlYXJjaEtleSwKICAgICAgICAgICAgICAgIGNoYW5uZWw6J2NodW5sZWknLAogICAgICAgICAgICAgICAgYXBwX2lkOjI1MDUyOCwKICAgICAgICAgICAgICAgIGJkc3Rva2VuOmJkc3Rva2VuLAogICAgICAgICAgICAgICAgbG9naWQ6bG9naWQsCiAgICAgICAgICAgICAgICBjbGllbnR0eXBlOjAKICAgICAgICAgICAgfTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDpsaXN0VXJsLAogICAgICAgICAgICAgICAgYXN5bmM6ZmFsc2UsCiAgICAgICAgICAgICAgICBtZXRob2Q6J0dFVCcsCiAgICAgICAgICAgICAgICBkYXRhOnBhcmFtcywKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgIGZpbGVsaXN0ID0gMD09PXJlc3BvbnNlLmVycm5vID8gcmVzcG9uc2UubGlzdCA6IFtdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGZpbGVsaXN0OwogICAgICAgIH0KCiAgICAgICAgLy/nlJ/miJDkuIvovb3ml7bnmoRmaWRfbGlzdOWPguaVsAogICAgICAgIGZ1bmN0aW9uIGdldEZpZExpc3QobGlzdCl7CiAgICAgICAgICAgIHZhciBmaWRsaXN0ID0gbnVsbDsKICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIHZhciBmaWxlaWRsaXN0ID0gW107CiAgICAgICAgICAgICQuZWFjaChsaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgZmlsZWlkbGlzdC5wdXNoKGVsZW1lbnQuZnNfaWQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZmlkbGlzdCA9ICdbJyArIGZpbGVpZGxpc3QgKyAnXSc7CiAgICAgICAgICAgIHJldHVybiBmaWRsaXN0OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0VGltZXN0YW1wKCl7CiAgICAgICAgICAgIHJldHVybiB5dW5EYXRhLnRpbWVzdGFtcDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldEJEU3Rva2VuKCl7CiAgICAgICAgICAgIHJldHVybiB5dW5EYXRhLk1ZQkRTVE9LRU47CiAgICAgICAgfQoKICAgICAgICAvL+iOt+WPluebtOaOpeS4i+i9veWcsOWdgAogICAgICAgIC8v6L+Z5Liq5Zyw5Z2A5LiN5piv55u05o6l5LiL6L295Zyw5Z2A77yM6K6/6Zeu6L+Z5Liq5Zyw5Z2A5Lya6L+U5ZueMzAy77yMcmVzcG9uc2UgaGVhZGVy5Lit55qEbG9jYXRpb27miY3mmK/nnJ/lrp7kuIvovb3lnLDlnYAKICAgICAgICAvL+aaguaXtuayoeacieaJvuWIsOaPkOWPluaWueazlQogICAgICAgIGZ1bmN0aW9uIGdldERvd25sb2FkTGlua1dpdGhQYW5BUEkodHlwZSl7CiAgICAgICAgICAgIHZhciBkb3dubG9hZFVybCA9IHBhbkFQSVVybCArICJkb3dubG9hZCI7CiAgICAgICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgICAgIGxvZ2lkID0gZ2V0TG9nSUQoKTsKICAgICAgICAgICAgdmFyIHBhcmFtcz0gewogICAgICAgICAgICAgICAgc2lnbjpzaWduLAogICAgICAgICAgICAgICAgdGltZXN0YW1wOnRpbWVzdGFtcCwKICAgICAgICAgICAgICAgIGZpZGxpc3Q6ZmlkX2xpc3QsCiAgICAgICAgICAgICAgICB0eXBlOnR5cGUsCiAgICAgICAgICAgICAgICBjaGFubmVsOidjaHVubGVpJywKICAgICAgICAgICAgICAgIHdlYjoxLAogICAgICAgICAgICAgICAgYXBwX2lkOjI1MDUyOCwKICAgICAgICAgICAgICAgIGJkc3Rva2VuOmJkc3Rva2VuLAogICAgICAgICAgICAgICAgbG9naWQ6bG9naWQsCiAgICAgICAgICAgICAgICBjbGllbnR0eXBlOjAKICAgICAgICAgICAgfTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDpkb3dubG9hZFVybCwKICAgICAgICAgICAgICAgIGFzeW5jOmZhbHNlLAogICAgICAgICAgICAgICAgbWV0aG9kOidHRVQnLAogICAgICAgICAgICAgICAgZGF0YTpwYXJhbXMsCiAgICAgICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uKHJlc3BvbnNlKXsKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnZXREb3dubG9hZExpbmtXaXRoUkVTVEFQSUJhaWR1KHBhdGgpewogICAgICAgICAgICB2YXIgbGluayA9IHJlc3RBUElVcmwgKyAnZmlsZT9tZXRob2Q9ZG93bmxvYWQmYXBwX2lkPTI1MDUyOCZwYXRoPScgKyBlbmNvZGVVUklDb21wb25lbnQocGF0aCk7CiAgICAgICAgICAgIHJldHVybiBsaW5rOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0RG93bmxvYWRMaW5rV2l0aFJFU1RBUElFUyhwYXRoKXsKICAgICAgICAgICAgdmFyIGxpbmsgPSByZXN0QVBJVXJsICsgJ2ZpbGU/bWV0aG9kPWRvd25sb2FkJmFwcF9pZD0yNjY3MTkmcGF0aD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHBhdGgpOwogICAgICAgICAgICByZXR1cm4gbGluazsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldERvd25sb2FkTGlua1dpdGhDbGllbnRBUEkocGF0aCl7CiAgICAgICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgICAgIHZhciB1cmwgPSBjbGllbnRBUElVcmwgKyAnZmlsZT9tZXRob2Q9bG9jYXRlZG93bmxvYWQmYXBwX2lkPTI1MDUyOCZ2ZXI9NC4wJnBhdGg9JyArIGVuY29kZVVSSUNvbXBvbmVudChwYXRoKTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHVybDp1cmwsCiAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLAogICAgICAgICAgICAgICAgeGhyRmllbGRzOiB7CiAgICAgICAgICAgICAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0cnVlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYXN5bmM6ZmFsc2UsCiAgICAgICAgICAgICAgICBzdWNjZXNzOmZ1bmN0aW9uKHJlc3BvbnNlKXsKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOnsKICAgICAgICAgICAgICAgICAgICA0MDQ6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZihyZXN1bHQpewogICAgICAgICAgICAgICAgaWYocmVzdWx0LmVycm9yX2NvZGUgPT0gdW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHQudXJscyA9PSB1bmRlZmluZWQpewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZXJybm8gPSAyOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gocmVzdWx0LnVybHMsZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQudXJsc1tpbmRleF0udXJsID0gZWxlbWVudC51cmwucmVwbGFjZSgnXFwnLCcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5lcnJubyA9IDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfWVsc2UgaWYocmVzdWx0LmVycm9yX2NvZGUgPT0gMzEwNjYpewogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5lcnJubyA9IDE7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICByZXN1bHQuZXJybm8gPSAtMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICByZXN1bHQgPSB7fTsKICAgICAgICAgICAgICAgIHJlc3VsdC5lcnJubyA9IC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBleGVjRG93bmxvYWQobGluayl7CiAgICAgICAgICAgIHNsb2coIuS4i+i9vemTvuaOpe+8miIrbGluayk7CiAgICAgICAgICAgICQoJyNoZWxwZXJkb3dubG9hZGlmcmFtZScpLmF0dHIoJ3NyYycsbGluayk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBjcmVhdGVJZnJhbWUoKXsKICAgICAgICAgICAgdmFyICRkaXYgPSAkKCc8ZGl2IGNsYXNzPSJoZWxwZXItaGlkZSIgc3R5bGU9InBhZGRpbmc6MDttYXJnaW46MDtkaXNwbGF5OmJsb2NrIj48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRpZnJhbWUgPSAkKCc8aWZyYW1lIHNyYz0iamF2YXNjcmlwdDp2b2lkKDApIiBpZD0iaGVscGVyZG93bmxvYWRpZnJhbWUiIHN0eWxlPSJkaXNwbGF5Om5vbmUiPjwvaWZyYW1lPicpOwogICAgICAgICAgICAkZGl2LmFwcGVuZCgkaWZyYW1lKTsKICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgkZGl2KTsKCiAgICAgICAgfQogICAgfQoKICAgIC8v5YiG5Lqr6aG16Z2i55qE5LiL6L295Yqp5omLCiAgICBmdW5jdGlvbiBQYW5TaGFyZUhlbHBlcigpewogICAgICAgIHZhciB5dW5EYXRhLHNpZ24sdGltZXN0YW1wLGJkc3Rva2VuLGNoYW5uZWwsY2xpZW50dHlwZSx3ZWIsYXBwX2lkLGxvZ2lkLGVuY3J5cHQscHJvZHVjdCx1ayxwcmltYXJ5aWQsZmlkX2xpc3QsZXh0cmEsc2hhcmVpZDsKICAgICAgICB2YXIgdmNvZGU7CiAgICAgICAgdmFyIHNoYXJlVHlwZSxidXR0b25UYXJnZXQsY3VycmVudFBhdGgsbGlzdF9ncmlkX3N0YXR1cyxvYnNlcnZlcixkaWFsb2csdmNvZGVEaWFsb2c7CiAgICAgICAgdmFyIGZpbGVMaXN0PVtdLHNlbGVjdEZpbGVMaXN0PVtdOwogICAgICAgIHZhciBwYW5BUElVcmwgPSBsb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyBsb2NhdGlvbi5ob3N0ICsgIi9hcGkvIjsKICAgICAgICB2YXIgc2hhcmVMaXN0VXJsID0gbG9jYXRpb24ucHJvdG9jb2wgKyAiLy8iICsgbG9jYXRpb24uaG9zdCArICIvc2hhcmUvbGlzdCI7CgogICAgICAgIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHl1bkRhdGEgPSB1bnNhZmVXaW5kb3cueXVuRGF0YTsKICAgICAgICAgICAgc2xvZygneXVuRGF0YTonLHl1bkRhdGEpOwogICAgICAgICAgICBpZih5dW5EYXRhID09PSB1bmRlZmluZWQgfHwgeXVuRGF0YS5GSUxFSU5GTyA9PSBudWxsKXsKICAgICAgICAgICAgICAgIHNsb2coJ+mhtemdouacquato+W4uOWKoOi9ve+8jOaIluiAheeZvuW6puW3sue7j+abtOaWsO+8gScpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRQYXJhbXMoKTsKICAgICAgICAgICAgYWRkQnV0dG9uKCk7CiAgICAgICAgICAgIGRpYWxvZyA9IG5ldyBEaWFsb2coe2FkZENvcHk6ZmFsc2V9KTsKICAgICAgICAgICAgdmNvZGVEaWFsb2cgPSBuZXcgVkNvZGVEaWFsb2cocmVmcmVzaFZDb2RlLGNvbmZpcm1DbGljayk7CiAgICAgICAgICAgIGNyZWF0ZUlmcmFtZSgpOwoKICAgICAgICAgICAgaWYoIWlzU2luZ2xlU2hhcmUoKSl7CiAgICAgICAgICAgICAgICByZWdpc3RlckV2ZW50TGlzdGVuZXIoKTsKICAgICAgICAgICAgICAgIGNyZWF0ZU9ic2VydmVyKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNsb2coJ+WIhuS6q+ebtOaOpeS4i+i9veWKoOi9veaIkOWKnyEnKTsKICAgICAgICB9OwoKICAgICAgICBmdW5jdGlvbiBpbml0UGFyYW1zKCl7CiAgICAgICAgICAgIHNoYXJlVHlwZSA9IGdldFNoYXJlVHlwZSgpOwogICAgICAgICAgICBzaWduID0geXVuRGF0YS5TSUdOOwogICAgICAgICAgICB0aW1lc3RhbXAgPSB5dW5EYXRhLlRJTUVTVEFNUDsKICAgICAgICAgICAgYmRzdG9rZW4gPSB5dW5EYXRhLk1ZQkRTVE9LRU47CiAgICAgICAgICAgIGNoYW5uZWwgPSAnY2h1bmxlaSc7CiAgICAgICAgICAgIGNsaWVudHR5cGUgPSAwOwogICAgICAgICAgICB3ZWIgPSAxOwogICAgICAgICAgICBhcHBfaWQgPSAyNTA1Mjg7CiAgICAgICAgICAgIGxvZ2lkID0gZ2V0TG9nSUQoKTsKICAgICAgICAgICAgZW5jcnlwdCA9IDA7CiAgICAgICAgICAgIHByb2R1Y3QgPSAnc2hhcmUnOwogICAgICAgICAgICBwcmltYXJ5aWQgPSB5dW5EYXRhLlNIQVJFX0lEOwogICAgICAgICAgICB1ayA9IHl1bkRhdGEuU0hBUkVfVUs7CgogICAgICAgICAgICBpZihzaGFyZVR5cGUgPT0gJ3NlY3JldCcpewogICAgICAgICAgICAgICAgZXh0cmEgPSBnZXRFeHRyYSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGlzU2luZ2xlU2hhcmUoKSl7CiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307CiAgICAgICAgICAgICAgICBpZih5dW5EYXRhLkNBVEVHT1JZID09IDIpewogICAgICAgICAgICAgICAgICAgIG9iai5maWxlbmFtZSA9IHl1bkRhdGEuRklMRU5BTUU7CiAgICAgICAgICAgICAgICAgICAgb2JqLnBhdGggPSB5dW5EYXRhLlBBVEg7CiAgICAgICAgICAgICAgICAgICAgb2JqLmZzX2lkID0geXVuRGF0YS5GU19JRDsKICAgICAgICAgICAgICAgICAgICBvYmouaXNkaXIgPSAwOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBvYmouZmlsZW5hbWUgPSB5dW5EYXRhLkZJTEVJTkZPWzBdLnNlcnZlcl9maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnBhdGggPSB5dW5EYXRhLkZJTEVJTkZPWzBdLnBhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5mc19pZCA9IHl1bkRhdGEuRklMRUlORk9bMF0uZnNfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5pc2RpciA9eXVuRGF0YS5GSUxFSU5GT1swXS5pc2RpcgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QucHVzaChvYmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2hhcmVpZCA9IHl1bkRhdGEuU0hBUkVfSUQ7CiAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCA9IGdldFBhdGgoKTsKICAgICAgICAgICAgICAgIGxpc3RfZ3JpZF9zdGF0dXMgPSBnZXRMaXN0R3JpZFN0YXR1cygpOwogICAgICAgICAgICAgICAgZmlsZUxpc3QgPSBnZXRGaWxlTGlzdCgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL+WIpOaWreWIhuS6q+exu+Wei++8iHB1YmxpY+aIluiAhXNlY3JldO+8iQogICAgICAgIGZ1bmN0aW9uIGdldFNoYXJlVHlwZSgpewogICAgICAgICAgICByZXR1cm4geXVuRGF0YS5TSEFSRV9QVUJMSUM9PT0xID8gJ3B1YmxpYycgOiAnc2VjcmV0JzsKICAgICAgICB9CgogICAgICAgIC8v5Yik5pat5piv5Y2V5Liq5paH5Lu25YiG5Lqr6L+Y5piv5paH5Lu25aS55oiW6ICF5aSa5paH5Lu25YiG5LqrCiAgICAgICAgZnVuY3Rpb24gaXNTaW5nbGVTaGFyZSgpewogICAgICAgICAgICByZXR1cm4geXVuRGF0YS5nZXRDb250ZXh0ID09PSB1bmRlZmluZWQgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvL+WIpOaWreaYr+WQpuS4uuiHquW3seeahOWIhuS6q+mTvuaOpQogICAgICAgIGZ1bmN0aW9uIGlzU2VsZlNoYXJlKCl7CiAgICAgICAgICAgIHJldHVybiB5dW5EYXRhLk1ZU0VMRiA9PSAxID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZ2V0RXh0cmEoKXsKICAgICAgICAgICAgdmFyIHNlS2V5ID0gZGVjb2RlVVJJQ29tcG9uZW50KGdldENvb2tpZSgnQkRDTE5EJykpOwogICAgICAgICAgICByZXR1cm4gJ3snICsgJyJzZWtleSI6IicgKyBzZUtleSArICciJyArICJ9IjsKICAgICAgICB9CgogICAgICAgIC8v6I635Y+W5b2T5YmN55uu5b2VCiAgICAgICAgZnVuY3Rpb24gZ2V0UGF0aCgpewogICAgICAgICAgICB2YXIgaGFzaCA9IGxvY2F0aW9uLmhhc2g7CiAgICAgICAgICAgIHZhciByZWd4ID0gLyhefCZ8XC8pcGF0aD0oW14mXSopKCZ8JCkvaTsKICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGhhc2gubWF0Y2gocmVneCk7CiAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0WzJdKTsKICAgICAgICB9CgogICAgICAgIC8v6I635Y+W5b2T5YmN55qE6KeG5Zu+5qih5byPCiAgICAgICAgZnVuY3Rpb24gZ2V0TGlzdEdyaWRTdGF0dXMoKXsKICAgICAgICAgICAgdmFyIHN0YXR1cyA9ICdsaXN0JzsKICAgICAgICAgICAgdmFyICRzdGF0dXNfZGl2ID0gJCgnZGl2Lmxpc3QtZ3JpZC1zd2l0Y2gnKTsKICAgICAgICAgICAgaWYgKCRzdGF0dXNfZGl2Lmhhc0NsYXNzKCdsaXN0LXN3aXRjaGVkLW9uJykpewogICAgICAgICAgICAgICAgc3RhdHVzID0gJ2xpc3QnOwogICAgICAgICAgICB9IGVsc2UgaWYgKCRzdGF0dXNfZGl2Lmhhc0NsYXNzKCdncmlkLXN3aXRjaGVkLW9uJykpIHsKICAgICAgICAgICAgICAgIHN0YXR1cyA9ICdncmlkJzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc3RhdHVzOwogICAgICAgIH0KCiAgICAgICAgLy/mt7vliqDkuIvovb3liqnmiYvmjInpkq4KICAgICAgICBmdW5jdGlvbiBhZGRCdXR0b24oKXsKICAgICAgICAgICAgaWYoaXNTaW5nbGVTaGFyZSgpKXsKICAgICAgICAgICAgICAgICQoJ2Rpdi5zbGlkZS1zaG93LXJpZ2h0JykuY3NzKCd3aWR0aCcsJzUwMHB4Jyk7CiAgICAgICAgICAgICAgICAkKCdkaXYuZnJhbWUtbWFpbicpLmNzcygnd2lkdGgnLCc5NiUnKTsKICAgICAgICAgICAgICAgICQoJ2Rpdi5zaGFyZS1maWxlLXZpZXdlcicpLmNzcygnd2lkdGgnLCc3NDBweCcpLmNzcygnbWFyZ2luLWxlZnQnLCdhdXRvJykuY3NzKCdtYXJnaW4tcmlnaHQnLCdhdXRvJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgJCgnZGl2LnNsaWRlLXNob3ctcmlnaHQnKS5jc3MoJ3dpZHRoJywnNTAwcHgnKTsKICAgICAgICAgICAgdmFyICRkcm9wZG93bmJ1dHRvbiA9ICQoJzxzcGFuIGNsYXNzPSJnLWRyb3Bkb3duLWJ1dHRvbiI+PC9zcGFuPicpOwogICAgICAgICAgICB2YXIgJGRyb3Bkb3duYnV0dG9uX2EgPSAkKCc8YSBjbGFzcz0iZy1idXR0b24iIGRhdGEtYnV0dG9uLWlkPSJiMjAwIiBkYXRhLWJ1dHRvbi1pbmRleD0iMjAwIiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij48L2E+Jyk7CiAgICAgICAgICAgIHZhciAkZHJvcGRvd25idXR0b25fYV9zcGFuID0gJCgnPHNwYW4gY2xhc3M9ImctYnV0dG9uLXJpZ2h0Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kb3dubG9hZCIgdGl0bGU9IueZvuW6pue9keebmOS4i+i9veWKqeaJiyI+PC9lbT48c3BhbiBjbGFzcz0idGV4dCIgc3R5bGU9IndpZHRoOiBhdXRvOyI+5LiL6L295Yqp5omLPC9zcGFuPjwvc3Bhbj4nKTsKICAgICAgICAgICAgdmFyICRkcm9wZG93bmJ1dHRvbl9zcGFuID0gJCgnPHNwYW4gY2xhc3M9Im1lbnUiIHN0eWxlPSJ3aWR0aDphdXRvO3otaW5kZXg6NDEiPjwvc3Bhbj4nKTsKCiAgICAgICAgICAgIHZhciAkZG93bmxvYWRCdXR0b24gPSAkKCc8YSBkYXRhLW1lbnUtaWQ9ImItbWVudTIwNyIgY2xhc3M9ImctYnV0dG9uLW1lbnUiIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKTsiPuebtOaOpeS4i+i9vTwvYT4nKTsKICAgICAgICAgICAgdmFyICRsaW5rQnV0dG9uID0gJCgnPGEgZGF0YS1tZW51LWlkPSJiLW1lbnUyMDgiIGNsYXNzPSJnLWJ1dHRvbi1tZW51IiBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCk7Ij7mmL7npLrpk77mjqU8L2E+Jyk7CgogICAgICAgICAgICAkZHJvcGRvd25idXR0b25fc3Bhbi5hcHBlbmQoJGRvd25sb2FkQnV0dG9uKS5hcHBlbmQoJGxpbmtCdXR0b24pOwogICAgICAgICAgICAkZHJvcGRvd25idXR0b25fYS5hcHBlbmQoJGRyb3Bkb3duYnV0dG9uX2Ffc3Bhbik7CiAgICAgICAgICAgICRkcm9wZG93bmJ1dHRvbi5hcHBlbmQoJGRyb3Bkb3duYnV0dG9uX2EpLmFwcGVuZCgkZHJvcGRvd25idXR0b25fc3Bhbik7CgogICAgICAgICAgICAkZHJvcGRvd25idXR0b24uaG92ZXIoZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICRkcm9wZG93bmJ1dHRvbi50b2dnbGVDbGFzcygnYnV0dG9uLW9wZW4nKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAkZG93bmxvYWRCdXR0b24uY2xpY2soZG93bmxvYWRCdXR0b25DbGljayk7CiAgICAgICAgICAgICRsaW5rQnV0dG9uLmNsaWNrKGxpbmtCdXR0b25DbGljayk7CgogICAgICAgICAgICAkKCdkaXYubW9kdWxlLXNoYXJlLXRvcC1iYXIgZGl2LmJhciBkaXYuYnV0dG9uLWJveCcpLmFwcGVuZCgkZHJvcGRvd25idXR0b24pOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gY3JlYXRlSWZyYW1lKCl7CiAgICAgICAgICAgIHZhciAkZGl2ID0gJCgnPGRpdiBjbGFzcz0iaGVscGVyLWhpZGUiIHN0eWxlPSJwYWRkaW5nOjA7bWFyZ2luOjA7ZGlzcGxheTpibG9jayI+PC9kaXY+Jyk7CiAgICAgICAgICAgIHZhciAkaWZyYW1lID0gJCgnPGlmcmFtZSBzcmM9ImphdmFzY3JpcHQ6dm9pZCgwKSIgaWQ9ImhlbHBlcmRvd25sb2FkaWZyYW1lIiBzdHlsZT0iZGlzcGxheTpub25lIj48L2lmcmFtZT4nKTsKICAgICAgICAgICAgJGRpdi5hcHBlbmQoJGlmcmFtZSk7CiAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJGRpdik7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByZWdpc3RlckV2ZW50TGlzdGVuZXIoKXsKICAgICAgICAgICAgcmVnaXN0ZXJIYXNoQ2hhbmdlKCk7CiAgICAgICAgICAgIHJlZ2lzdGVyTGlzdEdyaWRTdGF0dXMoKTsKICAgICAgICAgICAgcmVnaXN0ZXJDaGVja2JveCgpOwogICAgICAgICAgICByZWdpc3RlckFsbENoZWNrYm94KCk7CiAgICAgICAgICAgIHJlZ2lzdGVyRmlsZVNlbGVjdCgpOwogICAgICAgIH0KCiAgICAgICAgLy/nm5Hop4blnLDlnYDmoI8j5qCH562+5Y+Y5YyWCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJIYXNoQ2hhbmdlKCl7CiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJyxmdW5jdGlvbihlKXsKICAgICAgICAgICAgICAgIGxpc3RfZ3JpZF9zdGF0dXMgPSBnZXRMaXN0R3JpZFN0YXR1cygpOwogICAgICAgICAgICAgICAgaWYoY3VycmVudFBhdGggPT0gZ2V0UGF0aCgpKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoID0gZ2V0UGF0aCgpOwogICAgICAgICAgICAgICAgICAgIHJlZnJlc2hGaWxlTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHJlZnJlc2hTZWxlY3RGaWxlTGlzdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHJlZnJlc2hGaWxlTGlzdCgpewogICAgICAgICAgICBmaWxlTGlzdCA9IGdldEZpbGVMaXN0KCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByZWZyZXNoU2VsZWN0RmlsZUxpc3QoKXsKICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QgPSBbXTsKICAgICAgICB9CgogICAgICAgIC8v55uR6KeG6KeG5Zu+5Y+Y5YyWCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJMaXN0R3JpZFN0YXR1cygpewogICAgICAgICAgICB2YXIgJGFfbGlzdCA9ICQoJ2Fbbm9kZS10eXBlPWxpc3Qtc3dpdGNoXScpOwogICAgICAgICAgICAkYV9saXN0LmNsaWNrKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICBsaXN0X2dyaWRfc3RhdHVzID0gJ2xpc3QnOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHZhciAkYV9ncmlkID0gJCgnYVtub2RlLXR5cGU9Z3JpZC1zd2l0Y2hdJyk7CiAgICAgICAgICAgICRhX2dyaWQuY2xpY2soZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIGxpc3RfZ3JpZF9zdGF0dXMgPSAnZ3JpZCc7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy/nm5Hop4bmlofku7bpgInmi6nmoYYKICAgICAgICBmdW5jdGlvbiByZWdpc3RlckNoZWNrYm94KCl7CiAgICAgICAgICAgIC8vdmFyICRjaGVja2JveCA9ICQoJ3NwYW4uY2hlY2tib3gnKTsKICAgICAgICAgICAgdmFyICRjaGVja2JveCA9ICQoJ3NwYW4uJyt3b3JkTWFwWydjaGVja2JveCddKTsKICAgICAgICAgICAgJGNoZWNrYm94LmVhY2goZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLmJpbmQoJ2NsaWNrJyxmdW5jdGlvbihlKXsKICAgICAgICAgICAgICAgICAgICB2YXIgJHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVuYW1lOwogICAgICAgICAgICAgICAgICAgIGlmKGxpc3RfZ3JpZF9zdGF0dXMgPT0gJ2xpc3QnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gJCgnZGl2LmZpbGUtbmFtZSBkaXYudGV4dCBhJywkcGFyZW50KS5hdHRyKCd0aXRsZScpOwogICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKGxpc3RfZ3JpZF9zdGF0dXMgPT0gJ2dyaWQnKXsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAkKCdkaXYuZmlsZS1uYW1lIGEnLCRwYXJlbnQpLmF0dHIoJ3RpdGxlJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKCRwYXJlbnQuaGFzQ2xhc3MoJ2l0ZW0tYWN0aXZlJykpewogICAgICAgICAgICAgICAgICAgICAgICBzbG9nKCflj5bmtojpgInkuK3mlofku7bvvJonK2ZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxzZWxlY3RGaWxlTGlzdC5sZW5ndGg7aSsrKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0W2ldLmZpbGVuYW1lID09IGZpbGVuYW1lKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RGaWxlTGlzdC5zcGxpY2UoaSwxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICBzbG9nKCfpgInkuK3mlofku7bvvJonK2ZpbGVuYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGZpbGVMaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudC5zZXJ2ZXJfZmlsZW5hbWUgPT0gZmlsZW5hbWUpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOmVsZW1lbnQuc2VydmVyX2ZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOmVsZW1lbnQucGF0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnNfaWQ6ZWxlbWVudC5mc19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNkaXI6ZWxlbWVudC5pc2RpcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QucHVzaChvYmopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB1bnJlZ2lzdGVyQ2hlY2tib3goKXsKICAgICAgICAgICAgLy92YXIgJGNoZWNrYm94ID0gJCgnc3Bhbi5jaGVja2JveCcpOwogICAgICAgICAgICB2YXIgJGNoZWNrYm94ID0gJCgnc3Bhbi4nK3dvcmRNYXBbJ2NoZWNrYm94J10pOwogICAgICAgICAgICAkY2hlY2tib3guZWFjaChmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICQoZWxlbWVudCkudW5iaW5kKCdjbGljaycpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8v55uR6KeG5YWo6YCJ5qGGCiAgICAgICAgZnVuY3Rpb24gcmVnaXN0ZXJBbGxDaGVja2JveCgpewogICAgICAgICAgICAvL3ZhciAkY2hlY2tib3ggPSAkKCdkaXYuY29sLWl0ZW0uY2hlY2snKTsKICAgICAgICAgICAgdmFyICRjaGVja2JveCA9ICQoJ2Rpdi4nK3dvcmRNYXBbJ2NvbC1pdGVtJ10rJy4nK3dvcmRNYXBbJ2NoZWNrJ10pOwogICAgICAgICAgICAkY2hlY2tib3guZWFjaChmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICQoZWxlbWVudCkuYmluZCgnY2xpY2snLGZ1bmN0aW9uKGUpewogICAgICAgICAgICAgICAgICAgIHZhciAkcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTsKICAgICAgICAgICAgICAgICAgICAvL2lmKCRwYXJlbnQuaGFzQ2xhc3MoJ2NoZWNrZWQnKSl7CiAgICAgICAgICAgICAgICAgICAgaWYoJHBhcmVudC5oYXNDbGFzcyh3b3JkTWFwWydjaGVja2VkJ10pKXsKICAgICAgICAgICAgICAgICAgICAgICAgc2xvZygn5Y+W5raI5YWo6YCJJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdEZpbGVMaXN0ID0gW107CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2xvZygn5YWo6YOo6YCJ5LitJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdEZpbGVMaXN0ID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaChmaWxlTGlzdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ZWxlbWVudC5zZXJ2ZXJfZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDplbGVtZW50LnBhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnNfaWQ6ZWxlbWVudC5mc19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2RpcjplbGVtZW50LmlzZGlyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QucHVzaChvYmopOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB1bnJlZ2lzdGVyQWxsQ2hlY2tib3goKXsKICAgICAgICAgICAgLy92YXIgJGNoZWNrYm94ID0gJCgnZGl2LmNvbC1pdGVtLmNoZWNrJyk7CiAgICAgICAgICAgIHZhciAkY2hlY2tib3ggPSAkKCdkaXYuJyt3b3JkTWFwWydjb2wtaXRlbSddKycuJyt3b3JkTWFwWydjaGVjayddKTsKICAgICAgICAgICAgJGNoZWNrYm94LmVhY2goZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnVuYmluZCgnY2xpY2snKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvL+ebkeinhuWNleS4quaWh+S7tumAieS4rQogICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyRmlsZVNlbGVjdCgpewogICAgICAgICAgICAvL3ZhciAkZGQgPSAkKCdkaXYubGlzdC12aWV3IGRkJyk7CiAgICAgICAgICAgIHZhciAkZGQgPSAkKCdkaXYuJyt3b3JkTWFwWydsaXN0LXZpZXcnXSsnIGRkJyk7CiAgICAgICAgICAgICRkZC5lYWNoKGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgJChlbGVtZW50KS5iaW5kKCdjbGljaycsZnVuY3Rpb24oZSl7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVOYW1lID0gZS50YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgICAgICBpZihub2RlTmFtZSAhPSAnc3BhbicgJiYgbm9kZU5hbWUgIT0gJ2EnICYmIG5vZGVOYW1lICE9ICdlbScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0RmlsZUxpc3QgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVuYW1lID0gJCgnZGl2LmZpbGUtbmFtZSBkaXYudGV4dCBhJywkKHRoaXMpKS5hdHRyKCd0aXRsZScpOwogICAgICAgICAgICAgICAgICAgICAgICBzbG9nKCfpgInkuK3mlofku7bvvJonICsgZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goZmlsZUxpc3QsZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LnNlcnZlcl9maWxlbmFtZSA9PSBmaWxlbmFtZSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ZWxlbWVudC5zZXJ2ZXJfZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6ZWxlbWVudC5wYXRoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmc19pZDplbGVtZW50LmZzX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2RpcjplbGVtZW50LmlzZGlyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RGaWxlTGlzdC5wdXNoKG9iaik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXJGaWxlU2VsZWN0KCl7CiAgICAgICAgICAgIC8vdmFyICRkZCA9ICQoJ2Rpdi5saXN0LXZpZXcgZGQnKTsKICAgICAgICAgICAgdmFyICRkZCA9ICQoJ2Rpdi4nK3dvcmRNYXBbJ2xpc3QtdmlldyddKycgZGQnKTsKICAgICAgICAgICAgJGRkLmVhY2goZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnVuYmluZCgnY2xpY2snKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvL+ebkeinhuaWh+S7tuWIl+ihqOaYvuekuuWPmOWMlgogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZU9ic2VydmVyKCl7CiAgICAgICAgICAgIHZhciBNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXI7CiAgICAgICAgICAgIHZhciBvcHRpb25zID0gewogICAgICAgICAgICAgICAgJ2NoaWxkTGlzdCc6IHRydWUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnMpewogICAgICAgICAgICAgICAgdW5yZWdpc3RlckNoZWNrYm94KCk7CiAgICAgICAgICAgICAgICB1bnJlZ2lzdGVyQWxsQ2hlY2tib3goKTsKICAgICAgICAgICAgICAgIHVucmVnaXN0ZXJGaWxlU2VsZWN0KCk7CiAgICAgICAgICAgICAgICByZWdpc3RlckNoZWNrYm94KCk7CiAgICAgICAgICAgICAgICByZWdpc3RlckFsbENoZWNrYm94KCk7CiAgICAgICAgICAgICAgICByZWdpc3RlckZpbGVTZWxlY3QoKTsgCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvL3ZhciBsaXN0X3ZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlzdC12aWV3Jyk7CiAgICAgICAgICAgIC8vdmFyIGdyaWRfdmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkLXZpZXcnKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBsaXN0X3ZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJyt3b3JkTWFwWydsaXN0LXZpZXcnXSk7CiAgICAgICAgICAgIHZhciBncmlkX3ZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJyt3b3JkTWFwWydncmlkLXZpZXcnXSk7CgogICAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGxpc3RfdmlldyxvcHRpb25zKTsKICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShncmlkX3ZpZXcsb3B0aW9ucyk7CiAgICAgICAgfQoKICAgICAgICAvL+iOt+WPluaWh+S7tuS/oeaBr+WIl+ihqAogICAgICAgIGZ1bmN0aW9uIGdldEZpbGVMaXN0KCl7CiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgICAgICAgaWYoZ2V0UGF0aCgpID09ICcvJyl7CiAgICAgICAgICAgICAgICByZXN1bHQgPSB5dW5EYXRhLkZJTEVJTkZPOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9naWQgPSBnZXRMb2dJRCgpOwogICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICAgICB1azp1aywKICAgICAgICAgICAgICAgICAgICBzaGFyZWlkOnNoYXJlaWQsCiAgICAgICAgICAgICAgICAgICAgb3JkZXI6J290aGVyJywKICAgICAgICAgICAgICAgICAgICBkZXNjOjEsCiAgICAgICAgICAgICAgICAgICAgc2hvd2VtcHR5OjAsCiAgICAgICAgICAgICAgICAgICAgd2ViOndlYiwKICAgICAgICAgICAgICAgICAgICBkaXI6Z2V0UGF0aCgpLAogICAgICAgICAgICAgICAgICAgIHQ6TWF0aC5yYW5kb20oKSwKICAgICAgICAgICAgICAgICAgICBiZHN0b2tlbjpiZHN0b2tlbiwKICAgICAgICAgICAgICAgICAgICBjaGFubmVsOmNoYW5uZWwsCiAgICAgICAgICAgICAgICAgICAgY2xpZW50dHlwZTpjbGllbnR0eXBlLAogICAgICAgICAgICAgICAgICAgIGFwcF9pZDphcHBfaWQsCiAgICAgICAgICAgICAgICAgICAgbG9naWQ6bG9naWQKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgIHVybDpzaGFyZUxpc3RVcmwsCiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOidHRVQnLAogICAgICAgICAgICAgICAgICAgIGFzeW5jOmZhbHNlLAogICAgICAgICAgICAgICAgICAgIGRhdGE6cGFyYW1zLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5lcnJubyA9PT0gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZS5saXN0OwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRvd25sb2FkQnV0dG9uQ2xpY2soKXsKICAgICAgICAgICAgc2xvZygn6YCJ5Lit5paH5Lu25YiX6KGo77yaJyxzZWxlY3RGaWxlTGlzdCk7CiAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgICAgICBhbGVydCgn6I635Y+W5paH5Lu2SUTlpLHotKXvvIzor7fph43or5UnKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBidXR0b25UYXJnZXQgPSAnZG93bmxvYWQnOwogICAgICAgICAgICB2YXIgZG93bmxvYWRMaW5rID0gZ2V0RG93bmxvYWRMaW5rKCk7CgogICAgICAgICAgICBpZihkb3dubG9hZExpbmsuZXJybm8gPT0gLTIwKSB7CiAgICAgICAgICAgICAgICB2Y29kZSA9IGdldFZDb2RlKCk7CiAgICAgICAgICAgICAgICBpZih2Y29kZS5lcnJubyAhPT0gMCl7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+iOt+WPlumqjOivgeeggeWksei0pe+8gScpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZjb2RlRGlhbG9nLm9wZW4odmNvZGUpOwogICAgICAgICAgICB9IGVsc2UgaWYoZG93bmxvYWRMaW5rLmVycm5vID09IDExMil7CiAgICAgICAgICAgICAgICBhbGVydCgn6aG16Z2i6L+H5pyf77yM6K+35Yi35paw6YeN6K+VJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZG93bmxvYWRMaW5rLmVycm5vID09PSAwKSB7CiAgICAgICAgICAgICAgICB2YXIgbGluazsKICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PSAxICYmIHNlbGVjdEZpbGVMaXN0WzBdLmlzZGlyID09PSAwKQogICAgICAgICAgICAgICAgICAgIGxpbmsgPSBkb3dubG9hZExpbmsubGlzdFswXS5kbGluazsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBsaW5rID0gZG93bmxvYWRMaW5rLmRsaW5rOwogICAgICAgICAgICAgICAgZXhlY0Rvd25sb2FkKGxpbmspOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYWxlcnQoJ+iOt+WPluS4i+i9vemTvuaOpeWksei0pe+8gScpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL+iOt+WPlumqjOivgeeggQogICAgICAgIGZ1bmN0aW9uIGdldFZDb2RlKCl7CiAgICAgICAgICAgIHZhciB1cmwgPSBwYW5BUElVcmwgKyAnZ2V0dmNvZGUnOwogICAgICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgICAgICBsb2dpZCA9IGdldExvZ0lEKCk7CiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICAgICAgICBwcm9kOidwYW4nLAogICAgICAgICAgICAgICAgdDpNYXRoLnJhbmRvbSgpLAogICAgICAgICAgICAgICAgYmRzdG9rZW46YmRzdG9rZW4sCiAgICAgICAgICAgICAgICBjaGFubmVsOmNoYW5uZWwsCiAgICAgICAgICAgICAgICBjbGllbnR0eXBlOmNsaWVudHR5cGUsCiAgICAgICAgICAgICAgICB3ZWI6d2ViLAogICAgICAgICAgICAgICAgYXBwX2lkOmFwcF9pZCwKICAgICAgICAgICAgICAgIGxvZ2lkOmxvZ2lkCiAgICAgICAgICAgIH07CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICB1cmw6dXJsLAogICAgICAgICAgICAgICAgbWV0aG9kOidHRVQnLAogICAgICAgICAgICAgICAgYXN5bmM6ZmFsc2UsCiAgICAgICAgICAgICAgICBkYXRhOnBhcmFtcywKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3BvbnNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICB9CgogICAgICAgIC8v5Yi35paw6aqM6K+B56CBCiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaFZDb2RlKCl7CiAgICAgICAgICAgIHZjb2RlID0gZ2V0VkNvZGUoKTsKICAgICAgICAgICAgJCgnI2RpYWxvZy1pbWcnKS5hdHRyKCdzcmMnLHZjb2RlLmltZyk7CiAgICAgICAgfQoKICAgICAgICAvL+mqjOivgeeggeehruiupOaPkOS6pAogICAgICAgIGZ1bmN0aW9uIGNvbmZpcm1DbGljaygpewogICAgICAgICAgICB2YXIgdmFsID0gJCgnI2RpYWxvZy1pbnB1dCcpLnZhbCgpOwogICAgICAgICAgICBpZih2YWwubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICAkKCcjZGlhbG9nLWVycicpLnRleHQoJ+ivt+i+k+WFpemqjOivgeeggScpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9IGVsc2UgaWYodmFsLmxlbmd0aCA8IDQpIHsKICAgICAgICAgICAgICAgICQoJyNkaWFsb2ctZXJyJykudGV4dCgn6aqM6K+B56CB6L6T5YWl6ZSZ6K+v77yM6K+36YeN5paw6L6T5YWlJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gCiAgICAgICAgICAgIHZhciByZXN1bHQgPSBnZXREb3dubG9hZExpbmtXaXRoVkNvZGUodmFsKTsKICAgICAgICAgICAgaWYocmVzdWx0LmVycm5vID09IC0yMCl7CiAgICAgICAgICAgICAgICB2Y29kZURpYWxvZy5jbG9zZSgpOwogICAgICAgICAgICAgICAgJCgnI2RpYWxvZy1lcnInKS50ZXh0KCfpqozor4HnoIHovpPlhaXplJnor6/vvIzor7fph43mlrDovpPlhaUnKTsKICAgICAgICAgICAgICAgIHJlZnJlc2hWQ29kZSgpOwogICAgICAgICAgICAgICAgaWYoIXZjb2RlIHx8IHZjb2RlLmVycm5vICE9PSAwKXsKICAgICAgICAgICAgICAgICAgICBhbGVydCgn6I635Y+W6aqM6K+B56CB5aSx6LSl77yBJyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmNvZGVEaWFsb2cub3BlbigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5lcnJubyA9PT0gMCkgewogICAgICAgICAgICAgICAgdmNvZGVEaWFsb2cuY2xvc2UoKTsKICAgICAgICAgICAgICAgIHZhciBsaW5rOwogICAgICAgICAgICAgICAgaWYoc2VsZWN0RmlsZUxpc3QubGVuZ3RoID09MSAmJiBzZWxlY3RGaWxlTGlzdFswXS5pc2RpciA9PT0gMCkKICAgICAgICAgICAgICAgICAgICBsaW5rID0gcmVzdWx0Lmxpc3RbMF0uZGxpbms7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgbGluayA9IHJlc3VsdC5kbGluazsKICAgICAgICAgICAgICAgIGlmKGJ1dHRvblRhcmdldCA9PSAnZG93bmxvYWQnKXsKICAgICAgICAgICAgICAgICAgICBleGVjRG93bmxvYWQobGluayk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJ1dHRvblRhcmdldCA9PSAnbGluaycpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZW5hbWUgPSAnJzsKICAgICAgICAgICAgICAgICAgICAkLmVhY2goc2VsZWN0RmlsZUxpc3QsZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBlbGVtZW50LmZpbGVuYW1lOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPT0wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gZWxlbWVudC5maWxlbmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IGZpbGVuYW1lICsgJywnICsgZWxlbWVudC5maWxlbmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rTGlzdCA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHVybHM6WwogICAgICAgICAgICAgICAgICAgICAgICAgICAge3VybDpsaW5rLHJhbms6MX0KICAgICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdmFyIHRpcCA9ICLmmL7npLrojrflj5bnmoTpk77mjqXvvIzlj6/ku6Xkvb/nlKjlj7PplK7ov4Xpm7fkuIvovb3vvIzlpI3liLbml6DnlKjvvIzpnIDopoHkvKDpgJJjb29raWUiOwogICAgICAgICAgICAgICAgICAgIGRpYWxvZy5vcGVuKHt0aXRsZTon5LiL6L296ZO+5o6lJyx0eXBlOidsaW5rJyxsaXN0OmxpbmtMaXN0LHRpcDp0aXB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCflj5HnlJ/plJnor6/vvIEnKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy/nlJ/miJDkuIvovb3nlKjnmoRmaWRfbGlzdOWPguaVsAogICAgICAgIGZ1bmN0aW9uIGdldEZpZExpc3QoKXsKICAgICAgICAgICAgdmFyIGZpZGxpc3QgPSBbXTsKICAgICAgICAgICAgJC5lYWNoKHNlbGVjdEZpbGVMaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgZmlkbGlzdC5wdXNoKGVsZW1lbnQuZnNfaWQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuICdbJyArIGZpZGxpc3QgKyAnXSc7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBsaW5rQnV0dG9uQ2xpY2soKXsKICAgICAgICAgICAgc2xvZygn6YCJ5Lit5paH5Lu25YiX6KGo77yaJyxzZWxlY3RGaWxlTGlzdCk7CiAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PT0gMCl7CiAgICAgICAgICAgICAgICBhbGVydCgn5rKh5pyJ6YCJ5Lit5paH5Lu277yM6K+36YeN6K+VJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnV0dG9uVGFyZ2V0ID0gJ2xpbmsnOwogICAgICAgICAgICB2YXIgZG93bmxvYWRMaW5rID0gZ2V0RG93bmxvYWRMaW5rKCk7CgogICAgICAgICAgICBpZihkb3dubG9hZExpbmsuZXJybm8gPT0gLTIwKSB7CiAgICAgICAgICAgICAgICB2Y29kZSA9IGdldFZDb2RlKCk7CiAgICAgICAgICAgICAgICBpZighdmNvZGUgfHwgdmNvZGUuZXJybm8gIT09IDApewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfojrflj5bpqozor4HnoIHlpLHotKXvvIEnKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2Y29kZURpYWxvZy5vcGVuKHZjb2RlKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChkb3dubG9hZExpbmsuZXJybm8gPT0gMTEyKSB7CiAgICAgICAgICAgICAgICBhbGVydCgn6aG16Z2i6L+H5pyf77yM6K+35Yi35paw6YeN6K+VJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZG93bmxvYWRMaW5rLmVycm5vID09PSAwKSB7CiAgICAgICAgICAgICAgICB2YXIgbGluazsKICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PSAxICYmIHNlbGVjdEZpbGVMaXN0WzBdLmlzZGlyID09PSAwKQogICAgICAgICAgICAgICAgICAgIGxpbmsgPSBkb3dubG9hZExpbmsubGlzdFswXS5kbGluazsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBsaW5rID0gZG93bmxvYWRMaW5rLmRsaW5rOwogICAgICAgICAgICAgICAgaWYoc2VsZWN0RmlsZUxpc3QubGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICAgICAgJCgnI2RpYWxvZy1kb3dubG9hZGxpbmsnKS5hdHRyKCdocmVmJyxsaW5rKS50ZXh0KGxpbmspOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICQoJyNkaWFsb2ctZG93bmxvYWRsaW5rJykuYXR0cignaHJlZicsbGluaykudGV4dChsaW5rKTsKICAgICAgICAgICAgICAgIHZhciBmaWxlbmFtZSA9ICcnOwogICAgICAgICAgICAgICAgJC5lYWNoKHNlbGVjdEZpbGVMaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IGVsZW1lbnQuZmlsZW5hbWU7CiAgICAgICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPT0wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBlbGVtZW50LmZpbGVuYW1lOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IGZpbGVuYW1lICsgJywnICsgZWxlbWVudC5maWxlbmFtZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHZhciBsaW5rTGlzdCA9IHsKICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTpmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICB1cmxzOlsKICAgICAgICAgICAgICAgICAgICAgICAge3VybDpsaW5rLHJhbms6MX0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgdmFyIHRpcCA9ICLmmL7npLrojrflj5bnmoTpk77mjqXvvIzlj6/ku6Xkvb/nlKjlj7PplK7ov4Xpm7fkuIvovb3vvIzlpI3liLbml6DnlKjvvIzpnIDopoHkvKDpgJJjb29raWUiOwogICAgICAgICAgICAgICAgZGlhbG9nLm9wZW4oe3RpdGxlOifkuIvovb3pk77mjqUnLHR5cGU6J2xpbmsnLGxpc3Q6bGlua0xpc3QsdGlwOnRpcH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYWxlcnQoJ+iOt+WPluS4i+i9vemTvuaOpeWksei0pe+8gScpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvL+iOt+WPluS4i+i9vemTvuaOpQogICAgICAgIGZ1bmN0aW9uIGdldERvd25sb2FkTGluaygpewogICAgICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgICAgICBpZihpc1NpbmdsZVNoYXJlKXsKICAgICAgICAgICAgICAgIGZpZF9saXN0ID0gZ2V0RmlkTGlzdCgpOwogICAgICAgICAgICAgICAgbG9naWQgPSBnZXRMb2dJRCgpOwogICAgICAgICAgICAgICAgdmFyIHVybCA9IHBhbkFQSVVybCArICdzaGFyZWRvd25sb2FkP3NpZ249JyArIHNpZ24gKyAnJnRpbWVzdGFtcD0nICsgdGltZXN0YW1wICsgJyZiZHN0b2tlbj0nICsgYmRzdG9rZW4gKyAnJmNoYW5uZWw9JyArIGNoYW5uZWwgKyAnJmNsaWVudHR5cGU9JyArIGNsaWVudHR5cGUgKyAnJndlYj0nKyB3ZWIgKyAnJmFwcF9pZD0nICsgYXBwX2lkICsgJyZsb2dpZD0nICsgbG9naWQ7CiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICAgIGVuY3J5cHQ6ZW5jcnlwdCwKICAgICAgICAgICAgICAgICAgICBwcm9kdWN0OnByb2R1Y3QsCiAgICAgICAgICAgICAgICAgICAgdWs6dWssCiAgICAgICAgICAgICAgICAgICAgcHJpbWFyeWlkOnByaW1hcnlpZCwKICAgICAgICAgICAgICAgICAgICBmaWRfbGlzdDpmaWRfbGlzdAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmKHNoYXJlVHlwZSA9PSAnc2VjcmV0Jyl7CiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmV4dHJhID0gZXh0cmE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihzZWxlY3RGaWxlTGlzdFswXS5pc2RpciA9PSAxIHx8IHNlbGVjdEZpbGVMaXN0Lmxlbmd0aCA+IDEpewogICAgICAgICAgICAgICAgICAgIHBhcmFtcy50eXBlID0gJ2JhdGNoJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgdXJsOnVybCwKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLAogICAgICAgICAgICAgICAgICAgIGFzeW5jOmZhbHNlLAogICAgICAgICAgICAgICAgICAgIGRhdGE6cGFyYW1zLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KCiAgICAgICAgLy/mnInpqozor4HnoIHovpPlhaXml7bojrflj5bkuIvovb3pk77mjqUKICAgICAgICBmdW5jdGlvbiBnZXREb3dubG9hZExpbmtXaXRoVkNvZGUodmNvZGVJbnB1dCl7CiAgICAgICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgICAgIGlmKGlzU2luZ2xlU2hhcmUpewogICAgICAgICAgICAgICAgZmlkX2xpc3QgPSBnZXRGaWRMaXN0KCk7CiAgICAgICAgICAgICAgICB2YXIgdXJsID0gcGFuQVBJVXJsICsgJ3NoYXJlZG93bmxvYWQ/c2lnbj0nICsgc2lnbiArICcmdGltZXN0YW1wPScgKyB0aW1lc3RhbXAgKyAnJmJkc3Rva2VuPScgKyBiZHN0b2tlbiArICcmY2hhbm5lbD0nICsgY2hhbm5lbCArICcmY2xpZW50dHlwZT0nICsgY2xpZW50dHlwZSArICcmd2ViPScrIHdlYiArICcmYXBwX2lkPScgKyBhcHBfaWQgKyAnJmxvZ2lkPScgKyBsb2dpZDsKICAgICAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICAgICAgICAgICAgZW5jcnlwdDplbmNyeXB0LAogICAgICAgICAgICAgICAgICAgIHByb2R1Y3Q6cHJvZHVjdCwKICAgICAgICAgICAgICAgICAgICB2Y29kZV9pbnB1dDp2Y29kZUlucHV0LAogICAgICAgICAgICAgICAgICAgIHZjb2RlX3N0cjp2Y29kZS52Y29kZSwKICAgICAgICAgICAgICAgICAgICB1azp1aywKICAgICAgICAgICAgICAgICAgICBwcmltYXJ5aWQ6cHJpbWFyeWlkLAogICAgICAgICAgICAgICAgICAgIGZpZF9saXN0OmZpZF9saXN0CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgaWYoc2hhcmVUeXBlID09ICdzZWNyZXQnKXsKICAgICAgICAgICAgICAgICAgICBwYXJhbXMuZXh0cmEgPSBleHRyYTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHNlbGVjdEZpbGVMaXN0WzBdLmlzZGlyID09IDEgfHwgc2VsZWN0RmlsZUxpc3QubGVuZ3RoID4gMSApewogICAgICAgICAgICAgICAgICAgIHBhcmFtcy50eXBlID0gJ2JhdGNoJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgdXJsOnVybCwKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6J1BPU1QnLAogICAgICAgICAgICAgICAgICAgIGFzeW5jOmZhbHNlLAogICAgICAgICAgICAgICAgICAgIGRhdGE6cGFyYW1zLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ZnVuY3Rpb24ocmVzcG9uc2UpewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZXhlY0Rvd25sb2FkKGxpbmspewogICAgICAgICAgICBzbG9nKCfkuIvovb3pk77mjqXvvJonK2xpbmspOwogICAgICAgICAgICAkKCcjaGVscGVyZG93bmxvYWRpZnJhbWUnKS5hdHRyKCdzcmMnLGxpbmspOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBiYXNlNjRFbmNvZGUodCl7CiAgICAgICAgdmFyIGEsIHIsIGUsIG4sIGksIHMsIG8gPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgICAgICAgZm9yIChlID0gdC5sZW5ndGgsciA9IDAsYSA9ICIiOyBlID4gcjsgKSB7CiAgICAgICAgICAgIGlmIChuID0gMjU1ICYgdC5jaGFyQ29kZUF0KHIrKyksciA9PSBlKSB7CiAgICAgICAgICAgICAgICBhICs9IG8uY2hhckF0KG4gPj4gMik7CiAgICAgICAgICAgICAgICBhICs9IG8uY2hhckF0KCgzICYgbikgPDwgNCk7CiAgICAgICAgICAgICAgICBhICs9ICI9PSI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaSA9IHQuY2hhckNvZGVBdChyKyspLHIgPT0gZSkgewogICAgICAgICAgICAgICAgYSArPSBvLmNoYXJBdChuID4+IDIpOwogICAgICAgICAgICAgICAgYSArPSBvLmNoYXJBdCgoMyAmIG4pIDw8IDQgfCAoMjQwICYgaSkgPj4gNCk7CiAgICAgICAgICAgICAgICBhICs9IG8uY2hhckF0KCgxNSAmIGkpIDw8IDIpOwogICAgICAgICAgICAgICAgYSArPSAiPSI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBzID0gdC5jaGFyQ29kZUF0KHIrKyk7CiAgICAgICAgICAgIGEgKz0gby5jaGFyQXQobiA+PiAyKTsKICAgICAgICAgICAgYSArPSBvLmNoYXJBdCgoMyAmIG4pIDw8IDQgfCAoMjQwICYgaSkgPj4gNCk7CiAgICAgICAgICAgIGEgKz0gby5jaGFyQXQoKDE1ICYgaSkgPDwgMiB8ICgxOTIgJiBzKSA+PiA2KTsKICAgICAgICAgICAgYSArPSBvLmNoYXJBdCg2MyAmIHMpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZXRlY3RQYWdlKCl7CiAgICAgICAgdmFyIHJlZ3ggPSAvW1wvXS4rW1wvXS9nOwogICAgICAgIHZhciBwYWdlID0gbG9jYXRpb24ucGF0aG5hbWUubWF0Y2gocmVneCk7CiAgICAgICAgcmV0dXJuIHBhZ2VbMF0ucmVwbGFjZSgvXC8vZywnJyk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q29va2llKGUpIHsKICAgICAgICB2YXIgbywgdDsKICAgICAgICB2YXIgbiA9IGRvY3VtZW50LGM9ZGVjb2RlVVJJOwogICAgICAgIHJldHVybiBuLmNvb2tpZS5sZW5ndGggPiAwICYmIChvID0gbi5jb29raWUuaW5kZXhPZihlICsgIj0iKSwtMSAhPSBvKSA/IChvID0gbyArIGUubGVuZ3RoICsgMSx0ID0gbi5jb29raWUuaW5kZXhPZigiOyIsIG8pLC0xID09IHQgJiYgKHQgPSBuLmNvb2tpZS5sZW5ndGgpLGMobi5jb29raWUuc3Vic3RyaW5nKG8sIHQpKSkgOiAiIjsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRMb2dJRCgpewogICAgICAgIHZhciBuYW1lID0gIkJBSURVSUQiOwogICAgICAgIHZhciB1ID0gIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9+77yBQCPvv6Ul4oCm4oCmJiI7CiAgICAgICAgdmFyIGQgPSAvW1x1RDgwMC1cdURCRkZdW1x1REMwMC1cdURGRkZGXXxbXlx4MDAtXHg3Rl0vZzsKICAgICAgICB2YXIgZiA9IFN0cmluZy5mcm9tQ2hhckNvZGU7CiAgICAgICAgZnVuY3Rpb24gbChlKXsKICAgICAgICAgICAgaWYgKGUubGVuZ3RoIDwgMikgewogICAgICAgICAgICAgICAgdmFyIG4gPSBlLmNoYXJDb2RlQXQoMCk7CiAgICAgICAgICAgICAgICByZXR1cm4gMTI4ID4gbiA/IGUgOiAyMDQ4ID4gbiA/IGYoMTkyIHwgbiA+Pj4gNikgKyBmKDEyOCB8IDYzICYgbikgOiBmKDIyNCB8IG4gPj4+IDEyICYgMTUpICsgZigxMjggfCBuID4+PiA2ICYgNjMpICsgZigxMjggfCA2MyAmIG4pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBuID0gNjU1MzYgKyAxMDI0ICogKGUuY2hhckNvZGVBdCgwKSAtIDU1Mjk2KSArIChlLmNoYXJDb2RlQXQoMSkgLSA1NjMyMCk7CiAgICAgICAgICAgIHJldHVybiBmKDI0MCB8IG4gPj4+IDE4ICYgNykgKyBmKDEyOCB8IG4gPj4+IDEyICYgNjMpICsgZigxMjggfCBuID4+PiA2ICYgNjMpICsgZigxMjggfCA2MyAmIG4pOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBnKGUpewogICAgICAgICAgICByZXR1cm4gKGUgKyAiIiArIE1hdGgucmFuZG9tKCkpLnJlcGxhY2UoZCwgbCk7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIG0oZSl7CiAgICAgICAgICAgIHZhciBuID0gWzAsIDIsIDFdW2UubGVuZ3RoICUgM107CiAgICAgICAgICAgIHZhciB0ID0gZS5jaGFyQ29kZUF0KDApIDw8IDE2IHwgKGUubGVuZ3RoID4gMSA/IGUuY2hhckNvZGVBdCgxKSA6IDApIDw8IDggfCAoZS5sZW5ndGggPiAyID8gZS5jaGFyQ29kZUF0KDIpIDogMCk7CiAgICAgICAgICAgIHZhciBvID0gW3UuY2hhckF0KHQgPj4+IDE4KSwgdS5jaGFyQXQodCA+Pj4gMTIgJiA2MyksIG4gPj0gMiA/ICI9IiA6IHUuY2hhckF0KHQgPj4+IDYgJiA2MyksIG4gPj0gMSA/ICI9IiA6IHUuY2hhckF0KDYzICYgdCldOwogICAgICAgICAgICByZXR1cm4gby5qb2luKCIiKTsKICAgICAgICB9CiAgICAgICAgZnVuY3Rpb24gaChlKXsKICAgICAgICAgICAgcmV0dXJuIGUucmVwbGFjZSgvW1xzXFNdezEsM30vZywgbSk7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIHAoKXsKICAgICAgICAgICAgcmV0dXJuIGgoZygobmV3IERhdGUoKSkuZ2V0VGltZSgpKSk7CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIHcoZSxuKXsKICAgICAgICAgICAgcmV0dXJuIG4gPyBwKFN0cmluZyhlKSkucmVwbGFjZSgvWytcL10vZywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICIrIiA9PSBlID8gIi0iIDogIl8iOwogICAgICAgICAgICB9KS5yZXBsYWNlKC89L2csICIiKSA6IHAoU3RyaW5nKGUpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHcoZ2V0Q29va2llKG5hbWUpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBEaWFsb2coKXsKICAgICAgICB2YXIgbGlua0xpc3QgPSBbXTsKICAgICAgICB2YXIgc2hvd1BhcmFtczsKICAgICAgICB2YXIgZGlhbG9nLHNoYWRvdzsKICAgICAgICBmdW5jdGlvbiBjcmVhdGVEaWFsb2coKXsKICAgICAgICAgICAgdmFyIHNjcmVlbldpZHRoID0gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDsKICAgICAgICAgICAgdmFyIGRpYWxvZ0xlZnQgPSBzY3JlZW5XaWR0aD44MDAgPyAoc2NyZWVuV2lkdGgtODAwKS8yIDogMDsKICAgICAgICAgICAgdmFyICRkaWFsb2dfZGl2ID0gJCgnPGRpdiBjbGFzcz0iZGlhbG9nIiBzdHlsZT0id2lkdGg6IDgwMHB4OyB0b3A6IDBweDsgYm90dG9tOiBhdXRvOyBsZWZ0OiAnK2RpYWxvZ0xlZnQrJ3B4OyByaWdodDogYXV0bzsgZGlzcGxheTogaGlkZGVuOyB2aXNpYmlsaXR5OiB2aXNpYmxlOyB6LWluZGV4OiA1MjsiPjwvZGl2PicpOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19oZWFkZXIgPSAkKCc8ZGl2IGNsYXNzPSJkaWFsb2ctaGVhZGVyIj48aDM+PHNwYW4gY2xhc3M9ImRpYWxvZy10aXRsZSIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3dpZHRoOjc0MHB4O3doaXRlLXNwYWNlOm5vd3JhcDtvdmVyZmxvdy14OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzIj48L3NwYW4+PC9oMz48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfY29udHJvbCA9ICQoJzxkaXYgY2xhc3M9ImRpYWxvZy1jb250cm9sIj48c3BhbiBjbGFzcz0iZGlhbG9nLWljb24gZGlhbG9nLWNsb3NlIj7Dlzwvc3Bhbj48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfYm9keSA9ICQoJzxkaXYgY2xhc3M9ImRpYWxvZy1ib2R5IiBzdHlsZT0ibWF4LWhlaWdodDo0NTBweDtvdmVyZmxvdy15OmF1dG87cGFkZGluZzowIDIwcHg7Ij48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfdGlwID0gJCgnPGRpdiBjbGFzcz0iZGlhbG9nLXRpcCIgc3R5bGU9InBhZGRpbmctbGVmdDoyMHB4O2JhY2tncm91bmQtY29sb3I6I2ZhZjJkMztib3JkZXItdG9wOiAxcHggc29saWQgI2M0ZGJmZTsiPjxwPjwvcD48L2Rpdj4nKTsKCiAgICAgICAgICAgICRkaWFsb2dfZGl2LmFwcGVuZCgkZGlhbG9nX2hlYWRlci5hcHBlbmQoJGRpYWxvZ19jb250cm9sKSkuYXBwZW5kKCRkaWFsb2dfYm9keSk7CgogICAgICAgICAgICAvL3ZhciAkZGlhbG9nX3RleHRhcmVhID0gJCgnPHRleHRhcmVhIGNsYXNzPSJkaWFsb2ctdGV4dGFyZWEiIHN0eWxlPSJkaXNwbGF5Om5vbmU7d2lkdGgiPjwvdGV4dGFyZWE+Jyk7CiAgICAgICAgICAgIHZhciAkZGlhbG9nX3JhZGlvX2RpdiA9ICQoJzxkaXYgY2xhc3M9ImRpYWxvZy1yYWRpbyIgc3R5bGU9ImRpc3BsYXk6bm9uZTt3aWR0aDo3NjBweDtwYWRkaW5nLWxlZnQ6MjBweDtwYWRkaW5nLXJpZ2h0OjIwcHgiPjwvZGl2PicpOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19yYWRpb19tdWx0aSA9ICQoJzxpbnB1dCB0eXBlPSJyYWRpbyIgbmFtZT0ic2hvd21vZGUiIGNoZWNrZWQ9ImNoZWNrZWQiIHZhbHVlPSJtdWx0aSI+PHNwYW4+5aSa6KGMPC9zcGFuPicpOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19yYWRpb19zaW5nbGUgPSAkKCc8aW5wdXQgdHlwZT0icmFkaW8iIG5hbWU9InNob3dtb2RlIiB2YWx1ZT0ic2luZ2xlIj48c3Bhbj7ljZXooYw8L3NwYW4+Jyk7CiAgICAgICAgICAgICRkaWFsb2dfcmFkaW9fZGl2LmFwcGVuZCgkZGlhbG9nX3JhZGlvX211bHRpKS5hcHBlbmQoJGRpYWxvZ19yYWRpb19zaW5nbGUpOwogICAgICAgICAgICAkZGlhbG9nX2Rpdi5hcHBlbmQoJGRpYWxvZ19yYWRpb19kaXYpOwogICAgICAgICAgICAkKCdpbnB1dFt0eXBlPXJhZGlvXVtuYW1lPXNob3dtb2RlXScsJGRpYWxvZ19yYWRpb19kaXYpLmNoYW5nZShmdW5jdGlvbigpewogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciAkdGV4dGFyZWEgPSAkKCdkaXYuZGlhbG9nLWJvZHkgdGV4dGFyZWFbbmFtZT1kaWFsb2ctdGV4dGFyZWFdJyxkaWFsb2cpOwogICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSAkdGV4dGFyZWEudmFsKCk7CiAgICAgICAgICAgICAgICBpZih2YWx1ZSA9PSAnbXVsdGknKXsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9ccysvZywnXG4nKTsKICAgICAgICAgICAgICAgICAgICAkdGV4dGFyZWEuY3NzKCdoZWlnaHQnLCczMDBweCcpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmKHZhbHVlID09ICdzaW5nbGUnKXsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cbisvZywnICcpOwogICAgICAgICAgICAgICAgICAgICR0ZXh0YXJlYS5jc3MoJ2hlaWdodCcsJycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJHRleHRhcmVhLnZhbChjb250ZW50KTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICB2YXIgJGRpYWxvZ19idXR0b24gPSAkKCc8ZGl2IGNsYXNzPSJkaWFsb2ctYnV0dG9uIiBzdHlsZT0iZGlzcGxheTpub25lIj48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfYnV0dG9uX2RpdiA9ICQoJzxkaXYgc3R5bGU9ImRpc3BsYXk6dGFibGU7bWFyZ2luOmF1dG8iPjwvZGl2PicpCiAgICAgICAgICAgIHZhciAkZGlhbG9nX2NvcHlfYnV0dG9uID0gJCgnPGJ1dHRvbiBpZD0iZGlhbG9nLWNvcHktYnV0dG9uIiBzdHlsZT0iZGlzcGxheTpub25lIj7lpI3liLY8L2J1dHRvbj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfZWRpdF9idXR0b24gPSAkKCc8YnV0dG9uIGlkPSJkaWFsb2ctZWRpdC1idXR0b24iIHN0eWxlPSJkaXNwbGF5Om5vbmUiPue8lui+kTwvYnV0dG9uPicpOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19leGl0X2J1dHRvbiA9ICQoJzxidXR0b24gaWQ9ImRpYWxvZy1leGl0LWJ1dHRvbiIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+6YCA5Ye6PC9idXR0b24+Jyk7CgogICAgICAgICAgICAkZGlhbG9nX2J1dHRvbl9kaXYuYXBwZW5kKCRkaWFsb2dfY29weV9idXR0b24pLmFwcGVuZCgkZGlhbG9nX2VkaXRfYnV0dG9uKS5hcHBlbmQoJGRpYWxvZ19leGl0X2J1dHRvbik7CiAgICAgICAgICAgICRkaWFsb2dfYnV0dG9uLmFwcGVuZCgkZGlhbG9nX2J1dHRvbl9kaXYpOwogICAgICAgICAgICAkZGlhbG9nX2Rpdi5hcHBlbmQoJGRpYWxvZ19idXR0b24pOwoKICAgICAgICAgICAgJGRpYWxvZ19jb3B5X2J1dHRvbi5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSAnJzsKICAgICAgICAgICAgICAgIGlmKHNob3dQYXJhbXMudHlwZSA9PSAnYmF0Y2gnKXsKICAgICAgICAgICAgICAgICAgICAkLmVhY2gobGlua0xpc3QsZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQuZG93bmxvYWRsaW5rID09ICdlcnJvcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZGV4ID09IGxpbmtMaXN0Lmxlbmd0aC0xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQgKyBlbGVtZW50LmRvd25sb2FkbGluazsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9ICBjb250ZW50ICsgZWxlbWVudC5kb3dubG9hZGxpbmsgKyAnXG4nOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmKHNob3dQYXJhbXMudHlwZSA9PSAnbGluaycpewogICAgICAgICAgICAgICAgICAgICQuZWFjaChsaW5rTGlzdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudC51cmwgPT0gJ2Vycm9yJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPT0gbGlua0xpc3QubGVuZ3RoLTEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudCArIGVsZW1lbnQudXJsOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gIGNvbnRlbnQgKyBlbGVtZW50LnVybCArICdcbic7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBHTV9zZXRDbGlwYm9hcmQoY29udGVudCwndGV4dCcpOwogICAgICAgICAgICAgICAgYWxlcnQoJ+W3suWwhumTvuaOpeWkjeWItuWIsOWJqui0tOadv++8gScpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICRkaWFsb2dfZWRpdF9idXR0b24uY2xpY2soZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIHZhciAkZGlhbG9nX3RleHRhcmVhID0gJCgnZGl2LmRpYWxvZy1ib2R5IHRleHRhcmVhW25hbWU9ZGlhbG9nLXRleHRhcmVhXScsZGlhbG9nKTsKICAgICAgICAgICAgICAgIHZhciAkZGlhbG9nX2l0ZW0gPSAkKCdkaXYuZGlhbG9nLWJvZHkgZGl2JyxkaWFsb2cpOwogICAgICAgICAgICAgICAgJGRpYWxvZ19pdGVtLmhpZGUoKTsKICAgICAgICAgICAgICAgICRkaWFsb2dfY29weV9idXR0b24uaGlkZSgpOwogICAgICAgICAgICAgICAgJGRpYWxvZ19lZGl0X2J1dHRvbi5oaWRlKCk7CiAgICAgICAgICAgICAgICAkZGlhbG9nX3RleHRhcmVhLnNob3coKTsKICAgICAgICAgICAgICAgICRkaWFsb2dfcmFkaW9fZGl2LnNob3coKTsKICAgICAgICAgICAgICAgICRkaWFsb2dfZXhpdF9idXR0b24uc2hvdygpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICRkaWFsb2dfZXhpdF9idXR0b24uY2xpY2soZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgIHZhciAkZGlhbG9nX3RleHRhcmVhID0gJCgnZGl2LmRpYWxvZy1ib2R5IHRleHRhcmVhW25hbWU9ZGlhbG9nLXRleHRhcmVhXScsZGlhbG9nKTsKICAgICAgICAgICAgICAgIHZhciAkZGlhbG9nX2l0ZW0gPSAkKCdkaXYuZGlhbG9nLWJvZHkgZGl2JyxkaWFsb2cpOwogICAgICAgICAgICAgICAgJGRpYWxvZ190ZXh0YXJlYS5oaWRlKCk7CiAgICAgICAgICAgICAgICAkZGlhbG9nX3JhZGlvX2Rpdi5oaWRlKCk7CiAgICAgICAgICAgICAgICAkZGlhbG9nX2l0ZW0uc2hvdygpOwogICAgICAgICAgICAgICAgJGRpYWxvZ19leGl0X2J1dHRvbi5oaWRlKCk7CiAgICAgICAgICAgICAgICAkZGlhbG9nX2NvcHlfYnV0dG9uLnNob3coKTsKICAgICAgICAgICAgICAgICRkaWFsb2dfZWRpdF9idXR0b24uc2hvdygpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICRkaWFsb2dfZGl2LmFwcGVuZCgkZGlhbG9nX3RpcCk7CiAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQoJGRpYWxvZ19kaXYpOwogICAgICAgICAgICAkZGlhbG9nX2Rpdi5kaWFsb2dEcmFnKCk7CiAgICAgICAgICAgICRkaWFsb2dfY29udHJvbC5jbGljayhkaWFsb2dDb250cm9sKTsKICAgICAgICAgICAgcmV0dXJuICRkaWFsb2dfZGl2OwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gY3JlYXRlU2hhZG93KCl7CiAgICAgICAgICAgIHZhciAkc2hhZG93ID0gJCgnPGRpdiBjbGFzcz0iZGlhbG9nLXNoYWRvdyIgc3R5bGU9InBvc2l0aW9uOiBmaXhlZDsgbGVmdDogMHB4OyB0b3A6IDBweDsgei1pbmRleDogNTA7IGJhY2tncm91bmQ6IHJnYigwLCAwLCAwKSBub25lIHJlcGVhdCBzY3JvbGwgMCUgMCU7IG9wYWNpdHk6IDAuNTsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgZGlzcGxheTogbm9uZTsiPjwvZGl2PicpOwogICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCRzaGFkb3cpOwogICAgICAgICAgICByZXR1cm4gJHNoYWRvdzsKICAgICAgICB9CgogICAgICAgIHRoaXMub3BlbiA9IGZ1bmN0aW9uKHBhcmFtcyl7CiAgICAgICAgICAgIHNob3dQYXJhbXMgPSBwYXJhbXM7CiAgICAgICAgICAgIGxpbmtMaXN0ID0gW107CiAgICAgICAgICAgIGlmKHBhcmFtcy50eXBlID09ICdsaW5rJyl7CiAgICAgICAgICAgICAgICBsaW5rTGlzdCA9IHBhcmFtcy5saXN0LnVybHM7CiAgICAgICAgICAgICAgICAkKCdkaXYuZGlhbG9nLWhlYWRlciBoMyBzcGFuLmRpYWxvZy10aXRsZScsZGlhbG9nKS50ZXh0KHBhcmFtcy50aXRsZSArICLvvJoiICtwYXJhbXMubGlzdC5maWxlbmFtZSk7CiAgICAgICAgICAgICAgICAkLmVhY2gocGFyYW1zLmxpc3QudXJscyxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICB2YXIgJGRpdiA9ICQoJzxkaXY+PGRpdiBzdHlsZT0id2lkdGg6MzBweDtmbG9hdDpsZWZ0Ij4nK2VsZW1lbnQucmFuaysnOjwvZGl2PjxkaXYgc3R5bGU9IndoaXRlLXNwYWNlOm5vd3JhcDtvdmVyZmxvdzpoaWRkZW47dGV4dC1vdmVyZmxvdzplbGxpcHNpcyI+PGEgaHJlZj0iJytlbGVtZW50LnVybCsnIj4nK2VsZW1lbnQudXJsKyc8L2E+PC9kaXY+PC9kaXY+Jyk7CiAgICAgICAgICAgICAgICAgICAgJCgnZGl2LmRpYWxvZy1ib2R5JyxkaWFsb2cpLmFwcGVuZCgkZGl2KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgaWYocGFyYW1zLnR5cGUgPT0gJ2JhdGNoJyl7CiAgICAgICAgICAgICAgICBsaW5rTGlzdCA9IHBhcmFtcy5saXN0OwogICAgICAgICAgICAgICAgJCgnZGl2LmRpYWxvZy1oZWFkZXIgaDMgc3Bhbi5kaWFsb2ctdGl0bGUnLGRpYWxvZykudGV4dChwYXJhbXMudGl0bGUpOwogICAgICAgICAgICAgICAgaWYocGFyYW1zLnNob3dhbGwpewogICAgICAgICAgICAgICAgICAgICQuZWFjaChwYXJhbXMubGlzdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRpdGVtX2RpdiA9ICQoJzxkaXYgY2xhc3M9Iml0ZW0tY29udGFpbmVyIiBzdHlsZT0ib3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7d2hpdGUtc3BhY2U6bm93cmFwIj48L2Rpdj4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRpdGVtX25hbWUgPSAkKCc8ZGl2IHN0eWxlPSJ3aWR0aDoxMDBweDtmbG9hdDpsZWZ0O292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzIiB0aXRsZT0iJytlbGVtZW50LmZpbGVuYW1lKyciPicrZWxlbWVudC5maWxlbmFtZSsnPC9kaXY+Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkaXRlbV9zZXAgPSAkKCc8ZGl2IHN0eWxlPSJ3aWR0aDoxMnB4O2Zsb2F0OmxlZnQiPjxzcGFuPu+8mjwvc3Bhbj48L2Rpdj4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRpdGVtX2xpbmtfZGl2ID0gJCgnPGRpdiBjbGFzcz0iaXRlbS1saW5rIiBzdHlsZT0iZmxvYXQ6bGVmdDt3aWR0aDo2MThweDsiPjwvZGl2PicpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGl0ZW1fZmlyc3QgPSAkKCc8ZGl2IGNsYXNzPSJpdGVtLWZpcnN0IiBzdHlsZT0ib3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXMiPjxhIGhyZWY9IicrZWxlbWVudC5kb3dubG9hZGxpbmsrJyI+JytlbGVtZW50LmRvd25sb2FkbGluaysnPC9hPjwvZGl2PicpOwogICAgICAgICAgICAgICAgICAgICAgICAkaXRlbV9saW5rX2Rpdi5hcHBlbmQoJGl0ZW1fZmlyc3QpOwogICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gocGFyYW1zLmFsbGxpc3RbaW5kZXhdLmxpbmtzLGZ1bmN0aW9uKG4saXRlbSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LmRvd25sb2FkbGluayA9PSBpdGVtLnVybCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGl0ZW0gPSAkKCc8ZGl2IGNsYXNzPSJpdGVtLWV4IiBzdHlsZT0iZGlzcGxheTpub25lO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzIj48YSBocmVmPSInK2l0ZW0udXJsKyciPicraXRlbS51cmwrJzwvYT48L2Rpdj4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtX2xpbmtfZGl2LmFwcGVuZCgkaXRlbSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGl0ZW1fZXggPSAkKCc8ZGl2IHN0eWxlPSJ3aWR0aDoxNXB4O2Zsb2F0OmxlZnQ7Y3Vyc29yOnBvaW50ZXI7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjE2cHgiPjxzcGFuPis8L3NwYW4+PC9kaXY+Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtX2Rpdi5hcHBlbmQoJGl0ZW1fbmFtZSkuYXBwZW5kKCRpdGVtX3NlcCkuYXBwZW5kKCRpdGVtX2xpbmtfZGl2KS5hcHBlbmQoJGl0ZW1fZXgpOwogICAgICAgICAgICAgICAgICAgICAgICAkaXRlbV9leC5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHBhcmVudC50b2dnbGVDbGFzcygnc2hvd2FsbCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHBhcmVudC5oYXNDbGFzcygnc2hvd2FsbCcpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnRleHQoJy0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCdkaXYuaXRlbS1saW5rIGRpdi5pdGVtLWV4JywkcGFyZW50KS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykudGV4dCgnKycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJ2Rpdi5pdGVtLWxpbmsgZGl2Lml0ZW0tZXgnLCRwYXJlbnQpLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJ2Rpdi5kaWFsb2ctYm9keScsZGlhbG9nKS5hcHBlbmQoJGl0ZW1fZGl2KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICQuZWFjaChwYXJhbXMubGlzdCxmdW5jdGlvbihpbmRleCxlbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRkaXYgPSAkKCc8ZGl2IHN0eWxlPSJvdmVyZmxvdzpoaWRkZW47dGV4dC1vdmVyZmxvdzplbGxpcHNpczt3aGl0ZS1zcGFjZTpub3dyYXAiPjxkaXYgc3R5bGU9IndpZHRoOjEwMHB4O2Zsb2F0OmxlZnQ7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXMiIHRpdGxlPSInK2VsZW1lbnQuZmlsZW5hbWUrJyI+JytlbGVtZW50LmZpbGVuYW1lKyc8L2Rpdj48c3Bhbj7vvJo8L3NwYW4+PGEgaHJlZj0iJytlbGVtZW50LmRvd25sb2FkbGluaysnIj4nK2VsZW1lbnQuZG93bmxvYWRsaW5rKyc8L2E+PC9kaXY+Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJ2Rpdi5kaWFsb2ctYm9keScsZGlhbG9nKS5hcHBlbmQoJGRpdik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKHBhcmFtcy50aXApewogICAgICAgICAgICAgICAgJCgnZGl2LmRpYWxvZy10aXAgcCcsZGlhbG9nKS50ZXh0KHBhcmFtcy50aXApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihwYXJhbXMuc2hvd2NvcHkpewogICAgICAgICAgICAgICAgJCgnZGl2LmRpYWxvZy1idXR0b24nLGRpYWxvZykuc2hvdygpOwogICAgICAgICAgICAgICAgJCgnZGl2LmRpYWxvZy1idXR0b24gYnV0dG9uI2RpYWxvZy1jb3B5LWJ1dHRvbicsZGlhbG9nKS5zaG93KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYocGFyYW1zLnNob3dlZGl0KXsKICAgICAgICAgICAgICAgICQoJ2Rpdi5kaWFsb2ctYnV0dG9uJyxkaWFsb2cpLnNob3coKTsKICAgICAgICAgICAgICAgICQoJ2Rpdi5kaWFsb2ctYnV0dG9uIGJ1dHRvbiNkaWFsb2ctZWRpdC1idXR0b24nLGRpYWxvZykuc2hvdygpOwogICAgICAgICAgICAgICAgdmFyICRkaWFsb2dfdGV4dGFyZWEgPSAkKCc8dGV4dGFyZWEgbmFtZT0iZGlhbG9nLXRleHRhcmVhIiBzdHlsZT0iZGlzcGxheTpub25lO3Jlc2l6ZTpub25lO3dpZHRoOjc1OHB4O2hlaWdodDozMDBweDt3aGl0ZS1zcGFjZTpwcmU7d29yZC13cmFwOm5vcm1hbDtvdmVyZmxvdy14OnNjcm9sbCI+PC90ZXh0YXJlYT4nKTsKICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gJyc7CiAgICAgICAgICAgICAgICBpZihzaG93UGFyYW1zLnR5cGUgPT0gJ2JhdGNoJyl7CiAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGxpbmtMaXN0LGZ1bmN0aW9uKGluZGV4LGVsZW1lbnQpewogICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50LmRvd25sb2FkbGluayA9PSAnZXJyb3InKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRleCA9PSBsaW5rTGlzdC5sZW5ndGgtMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50ICsgZWxlbWVudC5kb3dubG9hZGxpbms7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSAgY29udGVudCArIGVsZW1lbnQuZG93bmxvYWRsaW5rICsgJ1xuJzsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZihzaG93UGFyYW1zLnR5cGUgPT0gJ2xpbmsnKXsKICAgICAgICAgICAgICAgICAgICAkLmVhY2gobGlua0xpc3QsZnVuY3Rpb24oaW5kZXgsZWxlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQudXJsID09ICdlcnJvcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZGV4ID09IGxpbmtMaXN0Lmxlbmd0aC0xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQgKyBlbGVtZW50LnVybDsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCA9ICBjb250ZW50ICsgZWxlbWVudC51cmwgKyAnXG4nOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGRpYWxvZ190ZXh0YXJlYS52YWwoY29udGVudCk7CiAgICAgICAgICAgICAgICAkKCdkaXYuZGlhbG9nLWJvZHknLGRpYWxvZykuYXBwZW5kKCRkaWFsb2dfdGV4dGFyZWEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzaGFkb3cuc2hvdygpOwogICAgICAgICAgICBkaWFsb2cuc2hvdygpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5jbG9zZSA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGRpYWxvZ0NvbnRyb2woKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRpYWxvZ0NvbnRyb2woKXsKICAgICAgICAgICAgJCgnZGl2LmRpYWxvZy1ib2R5JyxkaWFsb2cpLmNoaWxkcmVuKCkucmVtb3ZlKCk7CiAgICAgICAgICAgICQoJ2Rpdi5kaWFsb2ctaGVhZGVyIGgzIHNwYW4uZGlhbG9nLXRpdGxlJyxkaWFsb2cpLnRleHQoJycpOwogICAgICAgICAgICAkKCdkaXYuZGlhbG9nLXRpcCBwJyxkaWFsb2cpLnRleHQoJycpOwogICAgICAgICAgICAkKCdkaXYuZGlhbG9nLWJ1dHRvbicsZGlhbG9nKS5oaWRlKCk7CiAgICAgICAgICAgICQoJ2Rpdi5kaWFsb2ctcmFkaW8gaW5wdXRbdHlwZT1yYWRpb11bbmFtZT1zaG93bW9kZV1bdmFsdWU9bXVsdGldJyxkaWFsb2cpLnByb3AoJ2NoZWNrZWQnLHRydWUpOwogICAgICAgICAgICAkKCdkaXYuZGlhbG9nLXJhZGlvJyxkaWFsb2cpLmhpZGUoKTsKICAgICAgICAgICAgJCgnZGl2LmRpYWxvZy1idXR0b24gYnV0dG9uI2RpYWxvZy1jb3B5LWJ1dHRvbicsZGlhbG9nKS5oaWRlKCk7CiAgICAgICAgICAgICQoJ2Rpdi5kaWFsb2ctYnV0dG9uIGJ1dHRvbiNkaWFsb2ctZWRpdC1idXR0b24nLGRpYWxvZykuaGlkZSgpOwogICAgICAgICAgICAkKCdkaXYuZGlhbG9nLWJ1dHRvbiBidXR0b24jZGlhbG9nLWV4aXQtYnV0dG9uJyxkaWFsb2cpLmhpZGUoKTsKICAgICAgICAgICAgZGlhbG9nLmhpZGUoKTsKICAgICAgICAgICAgc2hhZG93LmhpZGUoKTsKICAgICAgICB9CgogICAgICAgIGRpYWxvZyA9IGNyZWF0ZURpYWxvZygpOwogICAgICAgIHNoYWRvdyA9IGNyZWF0ZVNoYWRvdygpOwogICAgfQoKICAgIGZ1bmN0aW9uIFZDb2RlRGlhbG9nKHJlZnJlc2hWQ29kZSxjb25maXJtQ2xpY2spewogICAgICAgIHZhciBkaWFsb2csc2hhZG93OwogICAgICAgIGZ1bmN0aW9uIGNyZWF0ZURpYWxvZygpewogICAgICAgICAgICB2YXIgc2NyZWVuV2lkdGggPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoOwogICAgICAgICAgICB2YXIgZGlhbG9nTGVmdCA9IHNjcmVlbldpZHRoPjUyMCA/IChzY3JlZW5XaWR0aC01MjApLzIgOiAwOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19kaXYgPSAkKCc8ZGl2IGNsYXNzPSJkaWFsb2ciIGlkPSJkaWFsb2ctdmNvZGUiIHN0eWxlPSJ3aWR0aDo1MjBweDt0b3A6MHB4O2JvdHRvbTphdXRvO2xlZnQ6JytkaWFsb2dMZWZ0KydweDtyaWdodDphdXRvO2Rpc3BsYXk6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ei1pbmRleDo1MiI+PC9kaXY+Jyk7CiAgICAgICAgICAgIHZhciAkZGlhbG9nX2hlYWRlciA9ICQoJzxkaXYgY2xhc3M9ImRpYWxvZy1oZWFkZXIiPjxoMz48c3BhbiBjbGFzcz0iZGlhbG9nLWhlYWRlci10aXRsZSI+PGVtIGNsYXNzPSJzZWxlY3QtdGV4dCI+5o+Q56S6PC9lbT48L3NwYW4+PC9oMz48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfY29udHJvbCA9ICQoJzxkaXYgY2xhc3M9ImRpYWxvZy1jb250cm9sIj48c3BhbiBjbGFzcz0iZGlhbG9nLWljb24gZGlhbG9nLWNsb3NlIGljb24gaWNvbi1jbG9zZSI+PHNwYW4gY2xhc3M9InNpY29uIj54PC9zcGFuPjwvc3Bhbj48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfYm9keSA9ICQoJzxkaXYgY2xhc3M9ImRpYWxvZy1ib2R5Ij48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfYm9keV9kaXYgPSAkKCc8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjtwYWRkaW5nOjIycHgiPjwvZGl2PicpOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19ib2R5X2Rvd25sb2FkX3ZlcmlmeSA9ICQoJzxkaXYgY2xhc3M9ImRvd25sb2FkLXZlcmlmeSIgc3R5bGU9Im1hcmdpbi10b3A6MTBweDtwYWRkaW5nOjAgMjhweDt0ZXh0LWFsaWduOmxlZnQ7Zm9udC1zaXplOjEycHg7Ij48L2Rpdj4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfdmVyaWZ5X2JvZHkgPSAkKCc8ZGl2IGNsYXNzPSJ2ZXJpZnktYm9keSI+6K+36L6T5YWl6aqM6K+B56CB77yaPC9kaXY+Jyk7CiAgICAgICAgICAgIHZhciAkZGlhbG9nX2lucHV0ID0gJCgnPGlucHV0IGlkPSJkaWFsb2ctaW5wdXQiIHR5cGU9InRleHQiIHN0eWxlPSJwYWRkaW5nOjNweDt3aWR0aDo4NXB4O2hlaWdodDoyM3B4O2JvcmRlcjoxcHggc29saWQgI2M2YzZjNjtiYWNrZ3JvdW5kLWNvbG9yOndoaXRlO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTsiIGNsYXNzPSJpbnB1dC1jb2RlIiBtYXhsZW5ndGg9IjQiPicpOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19pbWcgPSAkKCc8aW1nIGlkPSJkaWFsb2ctaW1nIiBjbGFzcz0iaW1nLWNvZGUiIHN0eWxlPSJtYXJnaW4tbGVmdDoxMHB4O3ZlcnRpY2FsLWFsaWduOm1pZGRsZTsiIGFsdD0i54K55Ye75o2i5LiA5bygIiBzcmM9IiIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIzMCI+Jyk7CiAgICAgICAgICAgIHZhciAkZGlhbG9nX3JlZnJlc2ggPSAkKCc8YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiIHN0eWxlPSJ0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lOyIgY2xhc3M9InVuZGVybGluZSI+5o2i5LiA5bygPC9hPicpOwogICAgICAgICAgICB2YXIgJGRpYWxvZ19lcnIgPSAkKCc8ZGl2IGlkPSJkaWFsb2ctZXJyIiBzdHlsZT0icGFkZGluZy1sZWZ0Ojg0cHg7aGVpZ2h0OjE4cHg7Y29sb3I6I2Q4MDAwMCIgY2xhc3M9InZlcmlmeS1lcnJvciI+PC9kaXY+Jyk7CiAgICAgICAgICAgIHZhciAkZGlhbG9nX2Zvb3RlciA9ICQoJzxkaXYgY2xhc3M9ImRpYWxvZy1mb290ZXIgZy1jbGVhcmZpeCI+PC9kaXY+Jyk7CiAgICAgICAgICAgIHZhciAkZGlhbG9nX2NvbmZpcm1fYnV0dG9uID0gJCgnPGEgY2xhc3M9ImctYnV0dG9uIGctYnV0dG9uLWJsdWUiIGRhdGEtYnV0dG9uLWlkPSIiIGRhdGEtYnV0dG9uLWluZGV4IGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKSIgc3R5bGU9InBhZGRpbmctbGVmdDozNnB4Ij48c3BhbiBjbGFzcz0iZy1idXR0b24tcmlnaHQiIHN0eWxlPSJwYWRkaW5nLXJpZ2h0OjM2cHg7Ij48c3BhbiBjbGFzcz0idGV4dCIgc3R5bGU9IndpZHRoOmF1dG87Ij7noa7lrpo8L3NwYW4+PC9zcGFuPjwvYT4nKTsKICAgICAgICAgICAgdmFyICRkaWFsb2dfY2FuY2VsX2J1dHRvbiA9ICQoJzxhIGNsYXNzPSJnLWJ1dHRvbiIgZGF0YS1idXR0b24taWQ9IiIgZGF0YS1idXR0b24taW5kZXggaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApOyIgc3R5bGU9InBhZGRpbmctbGVmdDogMzZweDsiPjxzcGFuIGNsYXNzPSJnLWJ1dHRvbi1yaWdodCIgc3R5bGU9InBhZGRpbmctcmlnaHQ6IDM2cHg7Ij48c3BhbiBjbGFzcz0idGV4dCIgc3R5bGU9IndpZHRoOiBhdXRvOyI+5Y+W5raIPC9zcGFuPjwvc3Bhbj48L2E+Jyk7CgogICAgICAgICAgICAkZGlhbG9nX2hlYWRlci5hcHBlbmQoJGRpYWxvZ19jb250cm9sKTsKICAgICAgICAgICAgJGRpYWxvZ192ZXJpZnlfYm9keS5hcHBlbmQoJGRpYWxvZ19pbnB1dCkuYXBwZW5kKCRkaWFsb2dfaW1nKS5hcHBlbmQoJGRpYWxvZ19yZWZyZXNoKTsKICAgICAgICAgICAgJGRpYWxvZ19ib2R5X2Rvd25sb2FkX3ZlcmlmeS5hcHBlbmQoJGRpYWxvZ192ZXJpZnlfYm9keSkuYXBwZW5kKCRkaWFsb2dfZXJyKTsKICAgICAgICAgICAgJGRpYWxvZ19ib2R5X2Rpdi5hcHBlbmQoJGRpYWxvZ19ib2R5X2Rvd25sb2FkX3ZlcmlmeSk7CiAgICAgICAgICAgICRkaWFsb2dfYm9keS5hcHBlbmQoJGRpYWxvZ19ib2R5X2Rpdik7CiAgICAgICAgICAgICRkaWFsb2dfZm9vdGVyLmFwcGVuZCgkZGlhbG9nX2NvbmZpcm1fYnV0dG9uKS5hcHBlbmQoJGRpYWxvZ19jYW5jZWxfYnV0dG9uKTsKICAgICAgICAgICAgJGRpYWxvZ19kaXYuYXBwZW5kKCRkaWFsb2dfaGVhZGVyKS5hcHBlbmQoJGRpYWxvZ19ib2R5KS5hcHBlbmQoJGRpYWxvZ19mb290ZXIpOwogICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCRkaWFsb2dfZGl2KTsKCiAgICAgICAgICAgICRkaWFsb2dfZGl2LmRpYWxvZ0RyYWcoKTsKCiAgICAgICAgICAgICRkaWFsb2dfY29udHJvbC5jbGljayhkaWFsb2dDb250cm9sKTsKICAgICAgICAgICAgJGRpYWxvZ19pbWcuY2xpY2socmVmcmVzaFZDb2RlKTsKICAgICAgICAgICAgJGRpYWxvZ19yZWZyZXNoLmNsaWNrKHJlZnJlc2hWQ29kZSk7CiAgICAgICAgICAgICRkaWFsb2dfaW5wdXQua2V5cHJlc3MoZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgaWYoZXZlbnQud2hpY2ggPT0gMTMpCiAgICAgICAgICAgICAgICAgICAgY29uZmlybUNsaWNrKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkZGlhbG9nX2NvbmZpcm1fYnV0dG9uLmNsaWNrKGNvbmZpcm1DbGljayk7CiAgICAgICAgICAgICRkaWFsb2dfY2FuY2VsX2J1dHRvbi5jbGljayhkaWFsb2dDb250cm9sKTsKICAgICAgICAgICAgJGRpYWxvZ19pbnB1dC5jbGljayhmdW5jdGlvbigpewogICAgICAgICAgICAgICAgJCgnI2RpYWxvZy1lcnInKS50ZXh0KCcnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiAkZGlhbG9nX2RpdjsKICAgICAgICB9CiAgICAgICAgdGhpcy5vcGVuID0gZnVuY3Rpb24odmNvZGUpewogICAgICAgICAgICBpZih2Y29kZSkKICAgICAgICAgICAgICAgICQoJyNkaWFsb2ctaW1nJykuYXR0cignc3JjJyx2Y29kZS5pbWcpOwogICAgICAgICAgICBkaWFsb2cuc2hvdygpOwogICAgICAgICAgICBzaGFkb3cuc2hvdygpOwogICAgICAgIH0KICAgICAgICB0aGlzLmNsb3NlID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgZGlhbG9nQ29udHJvbCgpOwogICAgICAgIH0KICAgICAgICBkaWFsb2cgPSBjcmVhdGVEaWFsb2coKTsKICAgICAgICBzaGFkb3cgPSAkKCdkaXYuZGlhbG9nLXNoYWRvdycpOwogICAgICAgIGZ1bmN0aW9uIGRpYWxvZ0NvbnRyb2woKXsKICAgICAgICAgICAgJCgnI2RpYWxvZy1pbWcnLGRpYWxvZykuYXR0cignc3JjJywnJyk7CiAgICAgICAgICAgICQoJyNkaWFsb2ctZXJyJykudGV4dCgnJyk7CiAgICAgICAgICAgIGRpYWxvZy5oaWRlKCk7CiAgICAgICAgICAgIHNoYWRvdy5oaWRlKCk7CiAgICAgICAgfQogICAgfQoKICAgICQuZm4uZGlhbG9nRHJhZyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIG1vdXNlSW5pdFgsbW91c2VJbml0WSxkaWFsb2dJbml0WCxkaWFsb2dJbml0WTsKICAgICAgICB2YXIgc2NyZWVuV2lkdGggPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoOwogICAgICAgIHZhciAkcGFyZW50ID0gdGhpczsKICAgICAgICAkKCdkaXYuZGlhbG9nLWhlYWRlcicsdGhpcykubW91c2Vkb3duKGZ1bmN0aW9uKGV2ZW50KXsKICAgICAgICAgICAgbW91c2VJbml0WCA9IHBhcnNlSW50KGV2ZW50LnBhZ2VYKTsKICAgICAgICAgICAgbW91c2VJbml0WSA9IHBhcnNlSW50KGV2ZW50LnBhZ2VZKTsKICAgICAgICAgICAgZGlhbG9nSW5pdFggPSBwYXJzZUludCgkcGFyZW50LmNzcygnbGVmdCcpLnJlcGxhY2UoJ3B4JywnJykpOwogICAgICAgICAgICBkaWFsb2dJbml0WSA9IHBhcnNlSW50KCRwYXJlbnQuY3NzKCd0b3AnKS5yZXBsYWNlKCdweCcsJycpKTsKICAgICAgICAgICAgJCh0aGlzKS5tb3VzZW1vdmUoZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAgICAgdmFyIHRlbXBYID0gZGlhbG9nSW5pdFggKyBwYXJzZUludChldmVudC5wYWdlWCkgLSBtb3VzZUluaXRYOwogICAgICAgICAgICAgICAgdmFyIHRlbXBZID0gZGlhbG9nSW5pdFkgKyBwYXJzZUludChldmVudC5wYWdlWSkgLSBtb3VzZUluaXRZOwogICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gcGFyc2VJbnQoJHBhcmVudC5jc3MoJ3dpZHRoJykucmVwbGFjZSgncHgnLCcnKSk7CiAgICAgICAgICAgICAgICB0ZW1wWCA9IHRlbXBYPDAgPyAwIDogdGVtcFg+c2NyZWVuV2lkdGgtd2lkdGggPyBzY3JlZW5XaWR0aC13aWR0aCA6IHRlbXBYOwogICAgICAgICAgICAgICAgdGVtcFkgPSB0ZW1wWTwwID8gMCA6IHRlbXBZOwogICAgICAgICAgICAgICAgJHBhcmVudC5jc3MoJ2xlZnQnLHRlbXBYKydweCcpLmNzcygndG9wJyx0ZW1wWSsncHgnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgJCgnZGl2LmRpYWxvZy1oZWFkZXInLHRoaXMpLm1vdXNldXAoZnVuY3Rpb24oZXZlbnQpewogICAgICAgICAgICAkKHRoaXMpLnVuYmluZCgnbW91c2Vtb3ZlJyk7CiAgICAgICAgfSk7CiAgICB9Cgp9KSgpOw=="},{"name":"True URL downloads","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":["http://192.168.*"],"orig_includes":["http://*","https://*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-body","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1487594258418},"enabled":false,"position":10,"file_url":"https://greasyfork.org/scripts/7362-true-url-downloads/code/True%20URL%20downloads.user.js","uuid":"dc391cae-a91e-4a67-9dfd-1da0750f1b5d","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgIFRydWUgVVJMIGRvd25sb2FkcwovLyBAbmFtZTp6aC1DTiAgICAgVHJ1ZSBVUkwgZG93bmxvYWRzCi8vIEBuYW1lOnpoLVRXICAgICBUcnVlIFVSTCBkb3dubG9hZHMKLy8gQG5hbWU6amEgICAgICAgIOi/hembt+OAgeW/q+i7iuOAgVFR5peL6aKo44Gq44Gp44Gu5bCC5pyJ44OB44Kn44O844Oz44GM6Kej6Kqt44GV44KM44GmCi8vIEBhdXRob3IgICAgICAgICBZdWxlaSwgSG9vdGhpbgovLyBAbmFtZXNwYWNlICAgICAgWXVsZWlncUBnbWFpbC5jb20KLy8gQGRlc2NyaXB0aW9uICAgIERlY3J5cHRpb24gYW5kIERpc3BsYXkgdGhlIHJlYWwgVVJMIG9mIHRoZSBkb3dubG9hZCBsaW5rcy4ob2YgeHVubGVpLGt1YWljaGUseHVhbmZlbmc7dGh1bmRlcixmbGFzaGdldCxxcWRsKQovLyBAZGVzY3JpcHRpb246emgtQ04gICAg6L+F6Zu344CB5b+r6L2m44CBUVHml4vpo47nrYnkuJPmnInpk77op6Plr4YgRGVjcnlwdGlvbiBhbmQgRGlzcGxheSB0aGUgcmVhbCBVUkwgb2YgdGhlIGRvd25sb2FkIGxpbmtzLihvZiB4dW5sZWksa3VhaWNoZSx4dWFuZmVuZzt0aHVuZGVyLGZsYXNoZ2V0LHFxZGwpCi8vIEBkZXNjcmlwdGlvbjp6aC1UVyAgICDov4Xpm7fjgIHlv6vou4rjgIFRUeaXi+miqOetieWwiOaciemPiOino+WvhiBEZWNyeXB0aW9uIGFuZCBEaXNwbGF5IHRoZSByZWFsIFVSTCBvZiB0aGUgZG93bmxvYWQgbGlua3MuKG9mIHh1bmxlaSxrdWFpY2hlLHh1YW5mZW5nO3RodW5kZXIsZmxhc2hnZXQscXFkbCkKLy8gQGRlc2NyaXB0aW9uOmphICAgICAgIFRydWUgVVJMIGRvd25sb2FkcywgRGVjcnlwdGlvbiBhbmQgRGlzcGxheSB0aGUgcmVhbCBVUkwgb2YgdGhlIGRvd25sb2FkIGxpbmtzLihvZiB4dW5sZWksa3VhaWNoZSx4dWFuZmVuZzt0aHVuZGVyLGZsYXNoZ2V0LHFxZGwpCi8vIEB2ZXJzaW9uICAgICAgICAxLjIyLjExCi8vIEBjcmVhdGUgICAgICAgICAyMDEzLTAxLTA1Ci8vIEBpbmNsdWRlICAgICAgICBodHRwOi8vKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cHM6Ly8qCi8vIEBleGNsdWRlICAgICAgICBodHRwOi8vMTkyLjE2OC4qCi8vIEBydW4tYXQgICAgICAgICBkb2N1bWVudC1ib2R5Ci8vIEBjb3B5cmlnaHQgICAgICAyMDEzKywgWXVsZWksIEhvb3RoaW4KLy8gQGdyYW50ICAgICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQGdyYW50ICAgICAgICAgIEdNX3NldENsaXBib2FyZAovLyBAbGljZW5zZSAgICAgICAgTUlUIExpY2Vuc2UKLy8gQHJlcXVpcmUgICAgICAgIGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9qcXVlcnkvMS43LjIvanF1ZXJ5Lm1pbi5qcwovLyBAcmVxdWlyZSAgICAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzI2NjE1LW1hbmFnZXJsaW5rcy9jb2RlL21hbmFnZXJMaW5rcy5qcz92ZXJzaW9uPTE4NjUzOQovLyBAY29udHJpYnV0aW9uVVJMIGh0dHBzOi8vd3d3LnBheXBhbC5jb20vY2dpLWJpbi93ZWJzY3I/Y21kPV9kb25hdGlvbnMmYnVzaW5lc3M9cml4aXhpQHNpbmEuY29tJml0ZW1fbmFtZT1HcmVhc3krRm9yaytkb25hdGlvbgovLyBAY29udHJpYnV0aW9uQW1vdW50IDEKLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24oKSB7CiAgICAndXNlIHN0cmljdCc7CiAgICBmdW5jdGlvbiBZdSgpIHsKICAgICAgICBkZWNvZGU2NCA9ICh3aW5kb3cuYXRvYikgPyBhdG9iIDogZGVjb2RlNjQ7CiAgICAgICAgdmFyIFJzdHIgPSAvXlxzKig/OnRodW5kZXJ8Zmxhc2hnZXR8cXFkbHxmczJ5b3UpOlwvXC8oW14nIlxzXSopL2ksCiAgICAgICAgICAgIGFmdCA9IC9eQUF8WlokfFxbRkxBU0hHRVRcXS9nLAogICAgICAgICAgICBhZmYgPSAvJi4qJHxcLyQvZzsKICAgICAgICB2YXIgVElkID0gInRpdGxlPSfilJxUcnVlVXJs4pSkJyBJRD0nXHUwMDU5XHUwMDc1JyI7CiAgICAgICAgdmFyIGJhc2U2NERlY29kZUNoYXJzID0gbmV3IEFycmF5KC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCA2MiwgLTEsIC0xLCAtMSwgNjMsIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgMjUsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDI2LCAyNywgMjgsIDI5LCAzMCwgMzEsIDMyLCAzMywgMzQsIDM1LCAzNiwgMzcsIDM4LCAzOSwgNDAsIDQxLCA0MiwgNDMsIDQ0LCA0NSwgNDYsIDQ3LCA0OCwgNDksIDUwLCA1MSwgLTEsIC0xLCAtMSwgLTEsIC0xKTsKICAgICAgICB2YXIgbGlua3NBcnIgPSBbXTsKICAgICAgICAvL+i/hembt+OAgeW/q+i9puOAgeaXi+mjjlVSTOino+eggeino+WvhuS7jui/memHjOW8gOWniwogICAgICAgIHZhciBEZWNyeXB0aW9uID0gZnVuY3Rpb24odXJsKSB7IC8v5YWI6Kej5a+G5YaN6Kej56CBCiAgICAgICAgICAgIGlmICh1cmwgIT0gJycpIHsKICAgICAgICAgICAgICAgIHZhciBzdHIgPSB1cmwuaHJlZiwKICAgICAgICAgICAgICAgICAgICBzciA9IHVybC5ocmVmOwogICAgICAgICAgICAgICAgdmFyIHR5cGUgPSAwOwogICAgICAgICAgICAgICAgaWYgKFJzdHIudGVzdChzdHIpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cjEgPSBzdHIubWF0Y2goUnN0cik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXA7CiAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdXRmOHRvMTYoYmFzZTY0ZGVjb2RlKHN0cjFbMV0ucmVwbGFjZShhZmYsICcnKSkpLnJlcGxhY2UoYWZ0LCAnJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFpc0NsZWFuU3RyKHRlbXApKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBkZWNvZGU2NChzdHIxWzFdLnJlcGxhY2UoYWZmLCAnJykpLnJlcGxhY2UoYWZ0LCAnJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9Y2F0Y2goZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBkZWNvZGU2NChzdHIxWzFdLnJlcGxhY2UoYWZmLCAnJykpLnJlcGxhY2UoYWZ0LCAnJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHN0ciA9IHRlbXA7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChzdHIuaW5kZXhPZigiOiIpIDwgMCkgewogICAgICAgICAgICAgICAgICAgIHN0ciA9ICJodHRwOi8vIiArIHN0ci5zcGxpdCgifCIpWzBdOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IDAgJiYgL1teKFx3fFwvfFwufFw/fFw9fFwmfFw6fFxbfFxdKV0vaWcudGVzdChzdHIpKSB7CiAgICAgICAgICAgICAgICAgICAgc3RyID0gc3RyQW5zaTJVbmljb2RlKHN0cik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoc3IgIT0gc3RyKSB7CiAgICAgICAgICAgICAgICAgICAgdXJsLnRpdGxlID0gJ+KUnOatpOmTvuaOpeW3suino+WvhuKUpCc7CiAgICAgICAgICAgICAgICAgICAgdXJsLnN0eWxlLm91dGxpbmUgPSAnI2YwZiBkYXNoZWQgMnB4JzsKICAgICAgICAgICAgICAgICAgICB1cmwuaHJlZiA9IHN0cjsKICAgICAgICAgICAgICAgICAgICBpZihsaW5rc0Fyci50b1N0cmluZygpLmluZGV4T2Yoc3RyKSA9PSAtMSkKICAgICAgICAgICAgICAgICAgICAgICAgbGlua3NBcnIucHVzaChzdHIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24obykgewogICAgICAgICAgICBpZiAoby5idXR0b24gPT0gMCAmJiAoby5jdHJsS2V5IHx8IG8ubWV0YUtleSkpIHsKICAgICAgICAgICAgICAgIGlmIChvLnRhcmdldCkgewogICAgICAgICAgICAgICAgICAgIGlmICgiSU5QVVQiID09IG8udGFyZ2V0LnRhZ05hbWUgfHwgIlRFWFRBUkVBIiA9PSBvLnRhcmdldC50YWdOYW1lKSByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgWldvcmQgPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgdmFyIFptYXQgPSBaV29yZC5tYXRjaChSc3RyKTsKICAgICAgICAgICAgICAgIHZhciBDc3QgPSAiIHN0eWxlPSdjb2xvcjpyZWQnIHRhcmdldD0nX2JsYW5rJyI7CiAgICAgICAgICAgICAgICBpZiAoWldvcmQgIT0gJycgJiYgUnN0ci50ZXN0KFpXb3JkKSkgewogICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcDsKICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSB1dGY4dG8xNihiYXNlNjRkZWNvZGUoWm1hdFsxXS5yZXBsYWNlKGFmZiwgJycpKSkucmVwbGFjZShhZnQsICcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWlzQ2xlYW5TdHIodGVtcCkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IGRlY29kZTY0KFptYXRbMV0ucmVwbGFjZShhZmYsICcnKSkucmVwbGFjZShhZnQsICcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IGRlY29kZTY0KFptYXRbMV0ucmVwbGFjZShhZmYsICcnKSkucmVwbGFjZShhZnQsICcnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyIFRsaW5rID0gdGVtcDsKICAgICAgICAgICAgICAgICAgICBpZiAoVGxpbmsgIT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFRsaW5rLmluZGV4T2YoIjovLyIpIDwgMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgVGxpbmsgPSAiaHR0cDovLyIgKyBUbGluazsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IDAgJiYgL1teKFx3fFwvfFwufFw/fFw9fFwmfFw6fFxbfFxdKV0vaWcudGVzdChUbGluaykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRsaW5rID0gc3RyQW5zaTJVbmljb2RlKFRsaW5rKTsKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIFRUayA9ICI8YSBocmVmPSciICsgVGxpbmsgKyAiJyAiICsgVElkICsgQ3N0ICsgIj4iICsgVGxpbmsgKyAiPC9hPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIG8udGFyZ2V0LmlubmVySFRNTCA9IG8udGFyZ2V0LmlubmVySFRNTC5yZXBsYWNlKC9hbXA7L2csICcnKS5yZXBsYWNlKFptYXRbMF0sIFRUayk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwgZmFsc2UpOwoKICAgICAgICBmdW5jdGlvbiBkZWNUaGlzKCl7CiAgICAgICAgICAgIERlY3J5cHRpb24odGhpcyk7CiAgICAgICAgfQoKICAgICAgICAvL+W8gOWni+Wvu+aJvuaJgOaciemTvuaOpeWcsOWdgAogICAgICAgIGZ1bmN0aW9uIHNlZWtVcmwoKSB7CiAgICAgICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKSB7CiAgICAgICAgICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBsaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2EnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgayA9IGxpbmsubGVuZ3RoOyBpIDwgazsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoL1x3K2hyZWYvaS50ZXN0KGxpbmtbaV0ub3V0ZXJIVE1MKSkgeyAvL+aemuS4vuaJgOacieS4k+eUqOmTvuWxnuaApwogICAgICAgICAgICAgICAgICAgIHZhciBsaW9uID0gbGlua1tpXS5nZXRBdHRyaWJ1dGUoIm9uY29udGV4dG1lbnUiKSxhdHRyOwogICAgICAgICAgICAgICAgICAgIGlmICgvXHcraHJlZj0vaS50ZXN0KGxpbmtbaV0ub3V0ZXJIVE1MKSkgewogICAgICAgICAgICAgICAgICAgICAgICBhdHRyID0gbGlua1tpXS5vdXRlckhUTUwubWF0Y2goL1x3K2hyZWY9L2kpLnRvU3RyaW5nKCkucmVwbGFjZSgvPS8sICcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgbGlua1tpXS5ocmVmID0gbGlua1tpXS5nZXRBdHRyaWJ1dGUoYXR0cik7CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtbaV0ucmVtb3ZlQXR0cmlidXRlKGF0dHIpOwogICAgICAgICAgICAgICAgICAgICAgICBEZWNyeXB0aW9uKGxpbmtbaV0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rW2ldLm9uY29udGV4dG1lbnUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHIgPSBsaW5rW2ldLm91dGVySFRNTC5tYXRjaCgvXHcraHJlZj0vaSkudG9TdHJpbmcoKS5yZXBsYWNlKC89LywgJycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXR0cilsaW5rW2ldLnJlbW92ZUF0dHJpYnV0ZShhdHRyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGUpewogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIERlY3J5cHRpb24obGlua1tpXSk7CiAgICAgICAgICAgICAgICAgICAgfSAvL+aemuS4vuWksei0peWQjuWGjeS+puWQrOWkhOeQhu+8jOWmgue9kemhteS4iuaciemUmeivrwogICAgICAgICAgICAgICAgICAgIGxpbmtbaV0ucmVtb3ZlQXR0cmlidXRlKCJvbmNvbnRleHRtZW51Iik7CiAgICAgICAgICAgICAgICAgICAgbGlua1tpXS5yZW1vdmVBdHRyaWJ1dGUoIm9uY2xpY2siKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgRGVjcnlwdGlvbihsaW5rW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzZWVrVXJsKCk7CiAgICAgICAgdmFyIGlzc2Vla2luZz1mYWxzZTsKICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Ob2RlSW5zZXJ0ZWQnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIGlmKGRvY3VtZW50LnJlYWR5U3RhdGU9PSJjb21wbGV0ZSIgJiYgIWlzc2Vla2luZyl7CiAgICAgICAgICAgICAgICBpc3NlZWtpbmc9dHJ1ZTsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICBzZWVrVXJsKCk7CiAgICAgICAgICAgICAgICAgICAgaXNzZWVraW5nPWZhbHNlOwogICAgICAgICAgICAgICAgfSw1MDApOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgZnVuY3Rpb24gY29weUxpbmsoKSB7CiAgICAgICAgICAgIHNob3dMaW5rRnJhbWUoZnVuY3Rpb24ocil7CiAgICAgICAgICAgICAgICBpZihyKXsKICAgICAgICAgICAgICAgICAgICBHTV9zZXRDbGlwYm9hcmQocik7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoIuWkjeWItuaIkOWKn++8gSIpOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoIuW9k+WJjemhtemdouayoeaciei1hOa6kO+8gSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgLy9HTV9yZWdpc3Rlck1lbnVDb21tYW5kKCJUcnVlIHVybCBkb3dubG9hZHMgc2VlayIsIHNlZWtVcmwpOwogICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQoIlRydWUgdXJsIGxpbmtzIGNvcHkiLCBjb3B5TGluayk7CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgaWYoZS5rZXlDb2RlID09IDg4ICYmIGUuYWx0S2V5KSB7CiAgICAgICAgICAgICAgICBjb3B5TGluaygpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGZ1bmN0aW9uIEFuc2ljb2RlQ2hyKCkgewogICAgICAgICAgICByZXR1cm4gJ0ExRTgsQTFFQyxBMUE3LEExRTMsQTFDMCxBMUE0LEExQzEsQThBNCxBOEEyLEE4QTgsQThBNixBOEJBLEE4QUMsQThBQSxBOEIwLEE4QUUsQTFDMixBOEI0LEE4QjIsQThCOSxBOEExLEE4QTUsQThBNyxBOEE5LEE4QUQsQThCMSxBOEEzLEE4QUIsQThBRixBOEIzLEE4QjUsQThCNixBOEI3LEE4QjgsQTFBNixBMUE1LEE2QTEsQTZBMixBNkEzLEE2QTQsQTZBNSxBNkE2LEE2QTcsQTZBOCxBNkE5LEE2QUEsQTZBQixBNkFDLEE2QUQsQTZBRSxBNkFGLEE2QjAsQTZCMSxBNkIyLEE2QjMsQTZCNCxBNkI1LEE2QjYsQTZCNyxBNkI4LEE2QzEsQTZDMixBNkMzLEE2QzQsQTZDNSxBNkM2LEE2QzcsQTZDOCxBNkM5LEE2Q0EsQTZDQixBNkNDLEE2Q0QsQTZDRSxBNkNGLEE2RDAsQTZEMSxBNkQyLEE2RDMsQTZENCxBNkQ1LEE2RDYsQTZENyxBNkQ4LEE3QTcsQTdBMSxBN0EyLEE3QTMsQTdBNCxBN0E1LEE3QTYsQTdBOCxBN0E5LEE3QUEsQTdBQixBN0FDLEE3QUQsQTdBRSxBN0FGLEE3QjAsQTdCMSxBN0IyLEE3QjMsQTdCNCxBN0I1LEE3QjYsQTdCNyxBN0I4LEE3QjksQTdCQSxBN0JCLEE3QkMsQTdCRCxBN0JFLEE3QkYsQTdDMCxBN0MxLEE3RDEsQTdEMixBN0QzLEE3RDQsQTdENSxBN0Q2LEE3RDgsQTdEOSxBN0RBLEE3REIsQTdEQyxBN0RELEE3REUsQTdERixBN0UwLEE3RTEsQTdFMixBN0UzLEE3RTQsQTdFNSxBN0U2LEE3RTcsQTdFOCxBN0U5LEE3RUEsQTdFQixBN0VDLEE3RUQsQTdFRSxBN0VGLEE3RjAsQTdGMSxBN0Q3LEExQUEsQTFBQyxBMUFFLEExQUYsQTFCMCxBMUIxLEExQUQsQTFFQixBMUU0LEExRTUsQTFGOSxBMUU2LEExRUQsQTJGMSxBMkYyLEEyRjMsQTJGNCxBMkY1LEEyRjYsQTJGNyxBMkY4LEEyRjksQTJGQSxBMkZCLEEyRkMsQTFGQixBMUZDLEExRkEsQTFGRCxBMUNBLEExQzcsQTFDNixBMUNDLEExRDgsQTFERSxBMUNGLEExQ0UsQTFDNCxBMUM1LEExQzksQTFDOCxBMUQyLEExRDMsQTFFMCxBMURGLEExQzMsQTFDQixBMUQ3LEExRDYsQTFENSxBMUQ5LEExRDQsQTFEQyxBMURELEExREEsQTFEQixBMUQxLEExQ0QsQTFEMCxBMkQ5LEEyREEsQTJEQixBMkRDLEEyREQsQTJERSxBMkRGLEEyRTAsQTJFMSxBMkUyLEEyQzUsQTJDNixBMkM3LEEyQzgsQTJDOSxBMkNBLEEyQ0IsQTJDQyxBMkNELEEyQ0UsQTJDRixBMkQwLEEyRDEsQTJEMixBMkQzLEEyRDQsQTJENSxBMkQ2LEEyRDcsQTJEOCxBMkIxLEEyQjIsQTJCMyxBMkI0LEEyQjUsQTJCNixBMkI3LEEyQjgsQTJCOSxBMkJBLEEyQkIsQTJCQyxBMkJELEEyQkUsQTJCRixBMkMwLEEyQzEsQTJDMixBMkMzLEEyQzQsQTlBNCxBOUE1LEE5QTYsQTlBNyxBOUE4LEE5QTksQTlBQSxBOUFCLEE5QUMsQTlBRCxBOUFFLEE5QUYsQTlCMCxBOUIxLEE5QjIsQTlCMyxBOUI0LEE5QjUsQTlCNixBOUI3LEE5QjgsQTlCOSxBOUJBLEE5QkIsQTlCQyxBOUJELEE5QkUsQTlCRixBOUMwLEE5QzEsQTlDMixBOUMzLEE5QzQsQTlDNSxBOUM2LEE5QzcsQTlDOCxBOUM5LEE5Q0EsQTlDQixBOUNDLEE5Q0QsQTlDRSxBOUNGLEE5RDAsQTlEMSxBOUQyLEE5RDMsQTlENCxBOUQ1LEE5RDYsQTlENyxBOUQ4LEE5RDksQTlEQSxBOURCLEE5REMsQTlERCxBOURFLEE5REYsQTlFMCxBOUUxLEE5RTIsQTlFMyxBOUU0LEE5RTUsQTlFNixBOUU3LEE5RTgsQTlFOSxBOUVBLEE5RUIsQTlFQyxBOUVELEE5RUUsQTlFRixBMUY2LEExRjUsQTFGOCxBMUY3LEExRjQsQTFGMyxBMUYwLEExRjIsQTFGMSxBMUVGLEExRUUsQTFFMixBMUUxLEExQTEsQTFBMixBMUEzLEExQTgsQTFBOSxBMUI0LEExQjUsQTFCNixBMUI3LEExQjgsQTFCOSxBMUJBLEExQkIsQTFCRSxBMUJGLEExRkUsQTFCMixBMUIzLEExQkMsQTFCRCxBNEExLEE0QTIsQTRBMyxBNEE0LEE0QTUsQTRBNixBNEE3LEE0QTgsQTRBOSxBNEFBLEE0QUIsQTRBQyxBNEFELEE0QUUsQTRBRixBNEIwLEE0QjEsQTRCMixBNEIzLEE0QjQsQTRCNSxBNEI2LEE0QjcsQTRCOCxBNEI5LEE0QkEsQTRCQixBNEJDLEE0QkQsQTRCRSxBNEJGLEE0QzAsQTRDMSxBNEMyLEE0QzMsQTRDNCxBNEM1LEE0QzYsQTRDNyxBNEM4LEE0QzksQTRDQSxBNENCLEE0Q0MsQTRDRCxBNENFLEE0Q0YsQTREMCxBNEQxLEE0RDIsQTREMyxBNEQ0LEE0RDUsQTRENixBNEQ3LEE0RDgsQTREOSxBNERBLEE0REIsQTREQyxBNERELEE0REUsQTRERixBNEUwLEE0RTEsQTRFMixBNEUzLEE0RTQsQTRFNSxBNEU2LEE0RTcsQTRFOCxBNEU5LEE0RUEsQTRFQixBNEVDLEE0RUQsQTRFRSxBNEVGLEE0RjAsQTRGMSxBNEYyLEE0RjMsQTVBMSxBNUEyLEE1QTMsQTVBNCxBNUE1LEE1QTYsQTVBNyxBNUE4LEE1QTksQTVBQSxBNUFCLEE1QUMsQTVBRCxBNUFFLEE1QUYsQTVCMCxBNUIxLEE1QjIsQTVCMyxBNUI0LEE1QjUsQTVCNixBNUI3LEE1QjgsQTVCOSxBNUJBLEE1QkIsQTVCQyxBNUJELEE1QkUsQTVCRixBNUMwLEE1QzEsQTVDMixBNUMzLEE1QzQsQTVDNSxBNUM2LEE1QzcsQTVDOCxBNUM5LEE1Q0EsQTVDQixBNUNDLEE1Q0QsQTVDRSxBNUNGLEE1RDAsQTVEMSxBNUQyLEE1RDMsQTVENCxBNUQ1LEE1RDYsQTVENyxBNUQ4LEE1RDksQTVEQSxBNURCLEE1REMsQTVERCxBNURFLEE1REYsQTVFMCxBNUUxLEE1RTIsQTVFMyxBNUU0LEE1RTUsQTVFNixBNUU3LEE1RTgsQTVFOSxBNUVBLEE1RUIsQTVFQyxBNUVELEE1RUUsQTVFRixBNUYwLEE1RjEsQTVGMixBNUYzLEE1RjQsQTVGNSxBNUY2LEE4QzUsQThDNixBOEM3LEE4QzgsQThDOSxBOENBLEE4Q0IsQThDQyxBOENELEE4Q0UsQThDRixBOEQwLEE4RDEsQThEMixBOEQzLEE4RDQsQThENSxBOEQ2LEE4RDcsQThEOCxBOEQ5LEE4REEsQThEQixBOERDLEE4REQsQThERSxBOERGLEE4RTAsQThFMSxBOEUyLEE4RTMsQThFNCxBOEU1LEE4RTYsQThFNyxBOEU4LEE4RTksQTJFNSxBMkU2LEEyRTcsQTJFOCxBMkU5LEEyRUEsQTJFQixBMkVDLEEyRUQsQTJFRSxEMkJCLEI2QTEsQzZERixDREYyLEQ1QzksQzhGRCxDOUNGLENGQzIsRDhBMixCMkJCLEQzRUIsRDhBNCxCM0YzLEQ3QTgsQzdEMixEOEE3LENBQzAsQzdGMCxCMUZCLEQyQjUsQjRENCxCNkFCLENCQkYsRDhBOSxCNkFBLEMxQkQsRDFDRixDOUE1LEQ4QUQsQjhGNixEMUJFLEUzREMsRDZEMCxCN0UxLEI0QUUsQzFEOSxEOEJDLENERTgsQjVBNCxDRUFBLEQ2RjcsQzBGNixCRUQ5LEQ4QUYsQzRDQixCRUMzLEQ4QjEsQzNCNCxEMkU1LEQ2QUUsQ0VEQSxENUE3LEJBRjUsQjdBNixDMEQ2LEM2QjksQzVEMixDN0M3LEI5RDQsQjNDQixEMkQyLEQ4QkYsQkVDNSxDNkYyLEQyQjIsQ0ZCMCxDRkU3LENBRTksRDhDMCxDMkYyLEMyRDIsQzhFOSxDN0FDLEMxQ0IsRDNFOCxENUY5LENBQzIsQjZGRSxEOEExLEQzREEsQkZGNyxENEM2LEJCQTUsRDhDMSxDRUU1LEJFQUUsRDhBOCxEMUM3LEQwQTksRDhCRCxEOUVGLENERjYsQkZCQSxCREJCLEJBQTUsRDJFMCxCMkZBLEJBRTAsQzRCNixDRkVELEJFQTksQ0RBNCxDMUMxLEM3RDcsRDlGMSxEOUY0LEM4Q0IsRDhFOSxEMkRBLENBQjIsQzhDQSxEOEVDLEQ4RUEsRDhDNixCREY2LEM2Q0QsQjNGMCxEOEVCLEJERjEsQkRFOSxDOEQ0LEI0RDMsQzJEOCxCMkQ2LEQ3RDAsQ0FDQixDQkZCLEQ1Q0MsQjhCNixDRkM5LEQ5REEsRDhGMCxDN0FBLEQ4RUUsQjRGQSxDMUVFLEQyRDQsRDhFRCxEMkM3LEQ4RUYsQzNDNyxEMUY2LEQ2RDksRDhGMixEOEY1LEJDRkUsQkNEQixDOENFLEI3REQsQjdDMixDNkYzLEQ4RjgsRDJDMSxDRUU5LEJDQkYsQjdGQyxCN0E1LEQwREQsRDZEQSxEM0M1LEJCRUYsQkJFMSxEOEYxLEM5QTEsQ0VCMCxCNEFCLEQ4RjMsQzlDQixEOEY2LEMyRDcsRDhGNyxDRUIxLEQ4RjksQjJBRSxCOUMwLEQ5QTMsQjBFOSxDMUU2LEM5RUMsQ0JDNSxDQkM2LEQ5QTQsQjVFOCxCNUFCLENFQkIsQjVDRCxEN0ExLEQ3RjQsRDNEMyxDQ0U1LEJBQ0UsRDlBMixEOURDLEQzRTAsRDhGRCxCN0YwLEQ3RjcsRDhGRSxEOEZBLEQ5QTEsQzRFMyxEM0I2LEQ4RjQsRDlERCxEOEZCLEM1RTUsQzBEMCxEMUYwLEIwREIsQkNEMSxEOUE2LEQ5QTUsRDlBQyxEOUFFLEQ5QUIsQ0FCOSxEOUE5LEQ2QjYsQjNERSxEOUE4LEMwRkQsQ0FDQyxEOUFBLEQ5QTcsRDlCMCxCNkIxLEI5QTksRDJDMCxDRkMwLEMyQzIsQkRDNCxENUVDLEIyRTAsQzdDOCxCRkVCLEQ5QUQsRDlBRixDRUVBLEJBRUUsQzdENixCMUUzLEI0RDksQjZFRCxEOUI0LEJGQTEsRDlERSxDN0NFLEMwRkUsRDlCOCxDQkQ3LEI3RkQsRDlCNSxEOUI3LEIxQTMsRDNFMSxEOUI5LEQwQzUsRDlCNixEOUIxLEQ5QjIsQzFBOSxEOUIzLEJDRjMsRDBERSxCOEE5LEJFRTMsRDlCRCxEOUJBLEIwQjMsRDlDMixEOUM0LEIxQjYsRDlCRixCNUI5LEJFRjMsQ0NDOCxCQUYyLEQyRDAsRDlDMyxCREU4LEIzQUIsRDlDNSxCRUVCLEQ5QzYsRDlCQixDNERGLEQ5QkUsRDlDMSxEOUMwLEQ1QUUsRDZCNSxDN0UzLEQ5QzgsQkNEOSxEOUNBLEQ5QkMsRDlDQixDNkFCLEQ5QzksRDdGNixDREEzLEJEQTEsRDlDQyxDNUJDLENEQjUsRDlDRCxEOUM3LEIzQTUsQkZGRSxCOEI1LEMwRkMsQjBGOCxCNEY2LEQ5Q0UsRDlDRixCNEEyLEQ5RDAsQjRERixCMEMxLEQ5RDEsQzlCNSxDRkYxLEQ5RDIsQzFDNSxEOUQ2LEM5QUUsRDlENSxEOUQ0LEQ5RDcsQ0JEQixCREE5LEM2QTcsRDlEMyxEOUQ4LEQ5RDksQzhFNSxDMERDLEI2RjksRDhBMyxENENBLEQ0QUEsRDBENixCM0U0LEQ1RDcsQ0ZDOCxCOUUyLEJGQ0IsQzNFMixCNkQyLENEQzMsRDlFRSxEOUYwLEI1QjMsQjZCNSxCRUE0LEM4RUIsQzhBQixCMENCLEI5QUIsQzFGOSxEOUUyLEMwQkMsQjlCMixCOUQ4LEQwQ0IsQjFGOCxDNkU0LEJFREYsQjVFNCxEN0M4LEQxRjgsQkNFNixDQURFLEJDQkQsRDlFNixEOEU3LEM0REEsQjhENCxDOEJELEIyRTEsRDREOSxDM0IwLEMzRTEsREFBMixDOERGLEQwQjQsQkVGQyxDNUE5LEI5REEsREFBMyxENEE5LERBQTQsRDlGQixCNkFDLEI3RUIsQjFGOSxEOUZDLEIzRTUsQkVGNixCRkY2LEQyQjEsQzBFNCxCNkIzLEQ5RkUsRDlGRCxCRUJCLEM2RTAsRDdCQyxEQUExLEMxQjksQjVGMixDMUU4LEJDRjUsQjRENSxDMURELEM0RkQsQkNCOCxCN0IyLEI3RUYsRDlFQyxDNkJFLEJGQUQsQkJDQixCNUNBLERCQzksRDBENyxDREI5LEIwQkMsQjNGNixCQkY3LERCQ0EsQkFBRixENEU0LEI1QjYsQjVGMyxEOEQ2LEM4RDAsQjdENixDN0QwLEQ4RDcsQkZBRixEQkJCLEQ4RDgsRDBDQyxCQkFFLEVCQkUsQzFEMCxDMUY1LEQ0RjIsQjhENSxCNEI0LEIzRjUsQzlCRSxDNUQwLEM1RDksQzBGQixCMUYwLEQ4RDksQjlDRSxCNUJELEQ4REEsRDZDNixDQkEyLEM4QUYsQzlCMixCNENDLEJGQ0MsQjlGNCxEOERCLEQ4REMsQjZFNyxCQ0MxLENDRUEsQ0ZGNyxEOERELEM3QjAsQjlEMCxCREEzLENDREUsQzZDQSxEOEUwLEQ4REUsRDhERixCMEZFLEJFRTcsQ0FBMyxCQ0Y0LEI4QjEsQjhFRSxEOEUyLEJEQ0IsRDhFNCxEOEUzLEM1RkMsRDhFNSxEOEU2LEMxQTYsQzhCMCxCMEVDLEI5QTYsQkNEMyxDRUYxLERCQkQsQzFEMyxCNkFGLEQ2RkEsQzVBQyxCREQ5LERCQkUsREJCRixDMEY4LEJFQTIsQzBDRCxEQkMwLENBQzYsQjJBQSxEM0MyLEMzRTMsRDFBQixEQkMyLEMwRDUsREJDMyxCRkIxLEM0QkMsQzdEQSxEQkM0LEQ5RTgsQzlENyxCOUI0LENFRjAsRDRDOCxCMEZDLEI0RDIsRDBEOSxEOUU5LERFQ0IsRDlFQixEOEIwLEJCQUYsQjFCMSxCM0Q3LEQ4Q0UsRDREMSxCREIzLEJGRUYsQ0ZCQixEOEQwLEI3Q0IsRDhEMSxDNkE1LEM3RjgsRDJCRCxEOEQyLEM0RTQsQ0FBRSxDN0E3LEQ4QTYsQzlGRCxDRUU3LEJCREMsQjBFQixCQkFBLEQwQUQsQjFCMCxEN0U0LEQ3QkYsQjVBNSxDMkY0LEM0Q0YsQjJBOSxCMkI3LEIxRTUsREZCMixENUJDLEJGQTgsQzJBQyxEOEQ1LEMyQjEsRDhENCxDRUQ0LERBRTAsQ0VDMCxEOEI0LEMzQUUsRDNBMSxDRUEzLEJDQjQsQzhCNCxDMkQxLEJFRUQsRDBCNixEQUUxLEM3RTQsQjNBNyxCNkYyLENDRkMsQzBGQSxDMEY3LEQxQjksRDFFMSxEOEM3LEIyREUsQzBFNSxCQUYxLEQ4QzgsRDRBRCxDRkUxLEQ4QzksRDhDQSxDRkMzLEIzRjgsQkVDNyxEOENCLERCQ0MsQzhBNSxDRkQ4LEM4RkUsQjJDRSxEM0Q2LEIyRTYsQkNCMCxEM0QxLENCQUIsQjdCNCxCN0EyLENBRTUsQzhBMSxDQURDLEIxRTQsRDBGMCxDNUQxLERCQzUsQjVGRSxCRkRBLEI5QzUsQkVFNCxDMUVELERGQjYsREZCNSxENkJCLEJERDAsRDVEOSxCMEM4LEI2QTMsQkZDOSxDQ0E4LERGQjMsQ0FCNyxEM0QyLEQ4Q0YsRDJCNixCQUM1LENCQkUsQ0NCRSxERkI3LEI1RjAsREZCNCxEM0Y1LEIzRDQsQjhGNyxERkJBLEJBQ0YsQkNBQSxCNUY1LENEQUMsQzNGQixCQUYzLEMwRjQsQ0RDMixDRkYyLERGQjgsQ0ZDNSxDMkMwLERGQjksQzJGMCxCRUZELEMxREYsQ0RDQyxEMkY3LEI3Q0QsREZDMSxERkM0LEI3RjEsQjBDOSxCNkQ2LEI3RDQsQkFBQyxDQ0ZELEJGRDQsQ0JCMSxDNkY0LEQ2QTgsREZDNSxDRUUyLEIzQjMsQ0VGQyxCNEI1LENFQzcsQkFGMCxDRUUxLEQxQkQsREZDMCxCNEY0LEIzQ0EsQjhFNixERkJCLEM0QzUsREZCQyxERkJELERGQkUsQzVCQixERkJGLERGQzIsRDRCMSxERkMzLEM3QkEsQ0VEOCxDNEQ4LERGQ0EsREZDRixENkRDLERGQzksREZEQSxDRUI2LEJBQzcsREZDRSxERkM4LEM1REUsQzlFQixCQUY0LEMzRkMsQkVENyxERkM2LERGQ0QsQzVEOCxENUE2LEJBQ0QsQkVDQyxEM0JELEI4QzAsRDZFNCxERkM3LEI5QkUsQkZBNyxDMUZDLERGQ0IsREZDQyxERkQwLERGREIsREZFNSxERkQ3LERGRDYsRDdDOSxERkUzLERGRTQsRTVFQixEMkE3LERGRDIsQkZBOSxENERCLEJGQzgsREZENCxDRkNDLERGREQsRDFDQSxERkRFLEIwQTcsQzZCNyxERkQzLEJBRTUsQjZERixDRERCLEI5RkUsRDRENSxERkRGLENGRUMsQjBBNSxERkU3LERGRDEsRDFDNixERkQ1LERGRDgsREZEOSxERkRDLEJCQTksREZFMCxERkUxLERGRTIsREZFNixERkU4LEQzQjQsQjhFNyxDNUI2LERGRUEsQzlEQSxDMUE4LEM0QzQsQkZERSxDRkY4LEQ1REMsREZFRSxCMkI4LEJBREYsREZFQyxEQkMxLEQxRTQsQ0JGNCxCNEJELEIwQTYsREZGMSxDQ0M2LERGRjIsREZFRCxERkU5LERGRUIsREZFRixERkYwLEJCQkQsREZGMyxERkY0LEJCQTMsQ0FEQixDRUE4LEUwQTcsQjNBQSxFMEE2LEUwQTEsREZGRSxDREQ5LERGRkMsREZGQSxCRkQwLEQ3QzQsQzlDQyxERkY4LEIwQTEsREZGRCxERkZCLEUwQTIsRTBBOCxCN0M4LEM2QTEsQzlCNixDMEIyLERGRjUsQzVCRSxEOEM0LERGRjksQzRGNixFMEEzLEUwQTQsRTBBNSxEMEE1LEUwQjQsQ0NFNCxFMEIxLEJGQTYsRTBBRixDRUI5LEUwQUIsQzlDNixDMEFFLEUwQUUsQkFFRCxCQUIwLEUwQTksREZGNixFMEIzLEUwQjgsQjRBRCxFMEI5LENGQjIsQkFDOCxFMEIwLEQwRkEsRTBBQyxENEZCLERGRjcsQzVFNyxFMEFELEQzRjcsRTBCNixFMEI3LEUwQzQsRDBFMSxFMEJDLEUwQzksRTBDQSxFMEJFLEUwQUEsQzlBNCxFMEMxLEUwQjIsQ0FDOCxFMEMzLEUwQjUsQ0VDQixDQkMzLEUwQ0QsRTBDNixFMEMyLEUwQ0IsRTBCQSxFMEJGLEUwQzAsRTBDNSxFMEM3LEUwQzgsRTBDQyxFMEJCLENCRDQsRTBENSxFMEQ2LEUwRDIsRTBEMCxCQ0NFLEUwRDEsQjhDMixEOEM1LEQwRUEsQzJFRixFMENGLEUwQkQsRTBENCxFMEQzLEUwRDcsRTBEQyxFMEQ4LEQ2RjYsQjNCMCxEN0VDLENCQkIsRTBEQSxDRUZCLEJBRDksRTBFMSxFMERELEQyQUQsRTBFMixFMERCLEUwRDksRTBERixFMEUwLEUwREUsRTBFNCxDNkY3LEQ4QUMsRDRFQixFMEU2LENBQzksRTBFNSxCOEMxLEUwRTcsRTBFOCxFMEU5LEUwRTMsQkFCRixDQ0U3LEUwRUEsQ0ZGOSxFMEVCLEM4QzIsQkRDMCxDNEQyLEUwRUMsRTBFRCxDN0Y0LENCQzQsRTBFRSxCQkQ4LEQ4QjYsRDJGMixFMEVGLENEQzUsQjZEQSxFMEYxLEQ0QjAsQzBBNyxCNEQxLENFQTcsRTBGMCxFMEYyLEI5Q0MsQjlGQSxDREJDLEUwRjMsQzZENCxFMEY0LEQ0QjIsQzhBNixFMEY2LEUwRjUsRTBGNyxDREMxLENBQTUsRDREQSxEQkQ3LERCRDksREJEOCxCOUU3LERCREMsREJERCxCNUQ4LERCREEsREJEQixCM0ExLERCREYsQkJGOCxENkI3LERCRTAsQkVGOSxCN0JCLERCRDAsQ0NBRSxCRkIyLEJCQjUsRDdGOCxCRkQzLEJGRTksQkNFMSxDQ0IzLERCREUsQjBEMyxDRUVCLEI3RDgsRDdCOSxDNkMyLEMwQTQsQ0NCOSxEQkU3LERCRTEsQzZCQSxEQkUzLERCRTgsQzVGNyxEQkVBLERCRTksQkZDMCxEQkU2LERCRTUsQjRCOSxDMEFDLEMyQTIsREJFMixEQkU0LEQwQ0QsREJFRCxDMERELERCRjIsQjZFMixEQkYzLERCRDIsQjlCOCxENEFCLERCRUMsQkZEMSxEQkYwLERCRDEsQjVFNixEQkVCLEJGRTUsREJFRSxEQkYxLERCRjksQjlBMSxCMEEzLEMyRjEsQjNDNyxEQkVGLERCRjgsQzZEMixEQkY0LERCRjUsREJGNyxEQkY2LERCRkUsRDNGMixCMkJBLERCRkQsRENBNCxEQkZCLERCRkEsREJGQyxDNUUwLEJCRjksRENBMyxEQ0E1LENDQzMsQjZEMSxEREMwLERDQTEsRENBMixDN0I1LEI2RTksRENBNyxEQ0E2LERDQTksQjFBNCxCNUNDLEJGQjAsRDFERixCNkMyLERDQTgsQ0JGQSxFQkYzLENCREMsQ0JGRSxDQ0MxLEM4RkIsRENBQSxDQ0VFLERDQUIsREJEMyxEQ0FGLERDQUMsQkVCMyxDQUZCLERDQUQsQzlDQSxDNEI5LEM3QkQsRENBRSxENEY2LEQwRTYsQzRBQixCNkQ1LERCRDQsQjFEQSxEQkQ1LERCRDYsQkFCRSxDOEMwLENBQkYsQzhDOSxEN0IzLEM5RjksQkZDNyxCQUY4LEQyQkMsRTJCQSxCNEE2LEIxQjgsQjhCNCxDRkM0LEQ5RTcsQ0ZBNixDREUyLEQ5RUQsQjZFMCxEMkI5LEI5QkIsRTJCOSxFMkI3LEI0RjMsQ0NFQyxDQ0FCLEI3RjIsRDhCMixEMUVCLEJBQkIsQ0FBNyxDREI3LEQyQzQsQkZFNCxCQ0QwLEI2RTEsREVDNSxERUM2LERCQkMsRDFEOSxDNkU2LEM0Q0UsQjdFRSxCN0RDLEJGRkMsRDdFMCxDNkY1LEIxQkMsREVDOCxCREIxLENDRDcsREVDQSxERUM5LEI1RUMsQzlERCxCMEMyLEM1QUUsQzVBQixDNENDLEJDRTksQ0JGRCxCQUMzLEU1RjksQzhFNyxFNUZBLENERkQsRDdCMSxCOEJFLEMyRTgsQzhEMSxFNUZCLEI2Q0EsQkNDQixEMUZELEU2QTEsQzNFRSxFNkE0LEU1RkUsRTZBNSxDREQ3LEI3QzEsRTVGQyxFNUZELEU2QTMsQzRERCxFNkE4LEU2QTcsQzNDMyxDNkRFLEU2QUEsQzRCNyxFNkEyLENBQkMsQkRFMyxCOUMzLEU2QTYsRDBENSxDRUFGLEU2QTksRTZCMCxEMkE2LEJEQUEsRTZBRCxFNkFGLEMwRDEsRDJDQyxCQ0E3LEU2QjEsRDJGNixEN0NCLENERkUsQ0RERSxDMkE2LEU2QUIsRTZBQyxCREJGLEU2QUUsRTZCMyxFNkIyLEU2QjYsRTZCOCxDNEVGLEM0QzgsQkVFQSxDOUVGLEU2QjcsQjZGMCxDM0U0LEQzRTksRTZCNCxFNkI1LEM4QTIsRTZCRCxFNkI5LEM2QzUsQ0RGMSxFNkJCLEU2QkMsQkJFOSxFNkJFLEU2QkEsQzBCNyxEM0E0LEU2QkYsQzlGNCxFNkMzLEU2QzQsRDBGNixDM0JELEMzQzQsRTZDMixFNkMxLEU2QzcsQ0ZCMSxFQkY0LEU2Q0EsRTZDNSxCQ0RFLEM5QTksQkNCNSxDRkQzLEU2QzgsRTZDOSxFNkNFLEU2RDAsRTZEMSxFNkNCLEI1RDUsRTZDQyxFNkNGLEM0REIsRTZDNixFNkNELEU2RDIsRTZENCxFNkQzLEU2RDUsRDlGOCxFNkQ2LEU2RDcsRDdEMyxFNkRELEU2REUsQkZENyxENEQwLEQ3RDYsQjRFNixDQkVGLEU2REEsRDhDMyxEN0NFLEQwQTIsQzNDRixFNkRGLEJDQkUsQjlDMixFNkRCLEQxQTcsQkFBMixDMkNGLEQ4QUIsQ0FFQixFNUVFLEU2REMsQjdGNSxDOEU2LEM0RjUsRTVCMixDNEZFLENCRkMsRTVCMyxENUFDLEQzRUUsQ0FEOCxCMEIyLENCQ0UsQ0RFQSxCQUVBLEU1QjUsRTVCNCxEN0RBLEI5RDksRDZFNixCNkE4LENERjAsRDJDQixCMUE2LENBQjUsQjNFOCxDOUYzLEJGQ0QsRDBGQixDQUQyLEU1QjYsQkJDMixDRkRDLEI5QUMsRDRENyxCQUE2LEQxRTcsQ0ZGQyxCQ0QyLEU1QjcsQzhERCxCRkVELEIxRjYsQ0JERSxCQ0M1LEJDQzQsRDJGQSxDM0RDLEJGREMsQjhCQixDM0MyLEJBQUUsRDRBMixDN0RFLEM0QUYsQjJFQyxCOUQxLEU1QkIsQzFDOCxENUFGLEU1QkMsRTVCRSxCNEU3LEI2RDQsQ0JDMixEMUIwLEI1QkMsQ0FEOSxCN0UyLEM5RTQsQkRBQixDRUJFLEQ3RjAsRDBBMSxDOUQ5LEI2RkIsRTZEOCxCQ0UyLEIzQkUsQzlEMCxFNkQ5LEIzQTIsREVDQyxEM0M4LERFQ0QsRDJBMixERUNFLEJFQ0QsREVDRixDQUFDLEQyRkMsQjNERixFNUVBLEM0RTEsQkVBMSxDRUIyLEM0RjIsQkVENixDNkE4LEIyRTMsQkVEMyxDN0ZDLENDRUIsQkRFQyxDRURELENBQkEsQzZDMSxFNUVDLEQwQkMsRDVCOSxFNUVELENBRjQsQ0RDMCxDMkM1LEU1RUYsQzJDNCxFNUYwLEU1RjgsQ0RDRCxDOUJELEQyRDksRTFBOCxEM0VDLENCRUEsQzZGMSxFMUFDLEUxQTcsRTFBOSxFMUFBLEUxQUYsQjJFRCxFMUFCLEI4REEsRTFBRCxFMUFFLEUxQjAsQjVCQSxFMUIxLEUxQjMsRTFCOCxEMUQyLEUxQjYsRTFCNSxDMUVCLEUxQjcsRDRDMCxFMUIyLEUxQkEsQjBCNixFMUI0LEJGRjksRTFCOSxFMUJCLEUxQkUsRTFCQyxENkM1LENGQkYsRTFCRCxFMUJGLEMyQ0QsQjZFQixEM0Y4LEM3Q0QsQjdFNSxCRUZFLEUxQzAsRTFDMSxFMUM3LEIzRTcsQzZFOSxCNERFLEQxQzIsRTFDOCxFMUM2LEUxQzUsRTFDMyxFMUMyLEIxQzAsRDVCOCxFMUM0LEUxQ0IsRTFDQyxFMUNBLEVGRkEsRTFEMyxFMUQyLEM3QjYsRTFDOSxFMUNFLEUxRDAsRTFENCxFMUQxLEUxQ0QsRTFDRixFMUQ1LEUxRDYsRTFENyxFMUQ4LEUxREEsRTFEQixDRUExLEU3REQsQjRBOCxENkRELEQxQjIsQjNCMixCOUE0LEQ3RjMsQzdDOSxCRURFLEI5QUUsQ0VENyxCMkVFLERCQ0YsQkNCQSxEMkQxLENCQzgsQjBDRCxDRkVGLEQ5RTMsQkRFRCxCMUQyLENBRDAsQjJCQyxDQkE3LEI3QUIsQ0FBNixDRkEzLEUwRjgsRDVDQSxFMEZCLEUwRkEsQzVDMSxDQ0ZCLEMxQjEsRTBGOSxENkUzLEIyQUYsRDZDNCxCNURCLEI0RjgsRDZBMSxDRkFGLEIwRUYsRTBGQyxFMUExLEIzQTMsRTBGRCxFMEZFLEMzQjEsQzNERCxFMUEyLEI3RjksQkJDRixFMUEzLEM0QkIsRTFBNCxFMUE1LEUxQTYsQjRCMSxCOEM5LEM2QkQsQzRFQSxCMkEyLEQwRDIsRTdEQixCQkMzLEQzRDcsRDNDNCxCOUUzLEUyQ0YsRDdBRixDN0VDLEIxRDMsQjRCMixFMkQxLEQwRjIsQzJBRSxFMkQwLEJGRTIsRDNBNixCNUQ3LEUyRDIsQjVFQSxDM0VELEI4RkQsQjhBRSxDNUQzLEI3Q0YsRTJENCxFMkQzLEI2QzgsRDdGOSxDREE1LEUyRDgsRTJENixDQUZDLEJGQjUsRDNCOSxFMkQ1LEUyRDcsQzFBRSxDMEM4LEUyREIsRTJEQSxDMEFBLEMxQ0UsRTJEQyxFMkRELEUyREUsREJDOCxEMUQzLENEQTIsQkRBOCxERUMzLEQ4QTUsQkZBQSxEQkNELEQyRUMsQzZGQSxDNUFBLERFQzQsQjFENyxERkFFLENBQkQsREZCMSxCOUFELEQyRkQsQjhBNSxCQUVCLEIzREEsQjVEQyxENUM1LEMzRDYsQ0ZEMixCQkExLEU1RjMsRTVGMixFNUY0LENERTQsQzhGNSxCNUFGLEM3QkYsRTVGNixFQ0IwLEU1RTYsQjlFOSxCNUIxLEMyQkMsRTVFOCxFNUU3LEU1RTksRDJDRCxFMUVBLEQwQ0UsQ0RBRSxEMUU1LEIyQ0EsQjFFQixCMUYyLEM1RUQsRDVDMyxEM0IwLEUxREMsRTFERCxEMkRCLEIzQjksQjFDQixDREY5LEQ1RjcsRTFERSxCRUI2LEI0RkQsRTFERixCQURDLEUxRTAsQkJCMixDMkM5LEUxRTEsRDBFQyxDREJELEUxRTIsQjVDMyxDNUM3LEUxRTMsRTFFNCxEM0Y5LEUxRTUsRDFBRCxFMUU2LENFQTIsRTFFNyxCNUMyLEUxRTgsQkJENSxEMEM0LEUyRTAsQjFEOCxEMkU0LEUyRTEsQkNDOSxDOENDLEUyRTMsRUNGRSxFQ0ZELERGQUYsRTJFMixENkJFLENERkMsQzNBNixFM0MzLEQ2RDIsRTJFNyxFMkU4LEQzQzcsRTJFQyxCRkVDLEUyRUQsRTJFNSxCM0MwLEM0RUUsRTJFRSxEMEMzLEJBRjYsRTJFOSxCN0RFLEJCQjMsQ0NBQyxDQkNCLEUyRTQsRTJFNixFMkVBLEUyRUIsRTJGNyxFMkY0LEQ0RjUsRTJGMyxDNUFELEQ1RkEsQzVDMixCMkMwLEUyRUYsRTJGMixDMUFGLENCQkMsQjVBMSxFMkY5LEJDQjEsRTJGMSxEMEQ0LEQ0QjksRTJGNSxCOUQ2LEUyRjYsQzdEMyxFMkYwLEQ3REMsRURBMSxFMkY4LEVEQTUsRTJGRSxDQUQxLEMxQjUsQkJEMCxCRkQ2LEJBRTMsQ0JBMSxFREE2LEVEQTMsRURBMixCQkQ2LEVEQTcsRDBGNCxFREE0LEJBREUsQjZGNyxFM0ExLEI2QjIsQ0NGMSxCOUE3LENGQTIsQzdBMSxCRkQyLEI2RjEsRTJGQSxFMkZCLEUyRkQsRTJGQyxDNEQ1LEUzQTIsRDNDMSxFM0E3LEM3QzQsQ0ZBNCxFM0E5LEJBQjcsRTNBOCxCQkRBLEUzQTMsRTNBNCxFM0FBLEUzQTYsQ0VGMixEM0M2LEJCQkMsRDRDMyxDNEZBLEVEQTgsRDBGQyxFM0E1LEMzRjUsRTNBRCxCMUFGLEUzQjIsQkNDMixFM0FDLEI1QkYsQzdFOSxFM0IwLEJFQUEsQ0RFRixCQkYzLENDRTgsRTNBRixFM0IxLENGQTcsRTNBRSxDRUE5LEJCREQsQjVFQixCRUU1LEIyRDIsQjNDRCxCMUI5LEUzQUIsQjJEMSxCNUFDLEI5REYsQjZFOCxDRkVCLEUzQjcsQkJDQyxDOEM3LEQwQ0EsRTNCOCxCM0VFLEVEQTksRDNGQSxEM0U0LEVEQUEsRTNCOSxEMkUyLEUzQjUsRDNERSxCOEQwLEUzQjMsRTNCNixCN0RGLEUzQjQsQzBBMixFM0JBLEQ0QjgsQjRDOCxFM0JCLEJCQzUsQzlGNyxDOUU1LEM0QkQsRURBQixDMkZELEJCREIsQkZBRSxDRUJGLEUzQkMsQkZCNixCMUVGLEQ0RjcsRTNCRSxFREFELEUzQkYsQkFBOSxFREFDLEUzQkQsRTNDMCxCQUI2LEI2QUUsRDBCOCxCMEMzLEVEQUUsRURBRixDMEMxLEUzQzEsQzVCMyxFM0MyLERDQjIsRURCMCxCOEVBLENFRUMsRUFBNyxEMEU3LENBRjksQzhENixDRkI3LEIzQzksQ0VEMixCREU0LEUzREUsQkJGMixFQUE4LEQ1QkQsQzZERCxFQUE5LEVBQUEsRUFBQyxFQUFCLEVBQUUsRUFBRCxCREQ4LEVBQUYsQzJCRSxCNEMxLEI0RjcsQkJBNyxFQ0U2LEVDRTUsQjdCRixDQkY5LEIxRTIsRUNFNyxDOUM4LEVDRTgsRUNFOSxDQUQ2LERFRDAsQjJDNSxENEZBLEM2Q0IsQjBDNyxCNEYyLEM4RDMsQ0REMCxCRkI4LEJGREIsQzdBNCxENkI0LEMwQTksREVEMSxDOUE4LEQxRUYsQzVBNCxCMEU3LEIzQjYsQzhDNSxCMEUyLEI3RjYsQzVGQSxCNkYzLEQ1RDIsQjNEMCxCQ0JDLEIzQUQsQkVGMSxCMEQxLEQyRDYsQ0FFMyxEN0E1LENEQjYsQjZCNixCRkI5LEQ1REIsQjhBNyxDNUQ3LERFRDIsQkZEOSxDMkQ1LEM3QzAsQkJBNCxCMUE4LEM1RUEsQzVGQixDQ0E3LEIxQTcsQjVENixDNEE4LERFRDMsRDFCQSxCM0U5LEMzRjIsQjdGNyxENkY0LEI1QTMsQjJGMCxDNEI0LEM0RTksQzBBRCxERUQ0LEIwRTgsQzVDNCxDMUUwLEI5RDUsQkVEQyxDREQ4LEIwQ0UsQ0RDRixERUQ2LEJFRDAsRDdCRSxERUQ1LEQ1RDAsQjBERCxDNEUyLEMyQTMsQkNGMCxEM0I1LEMwQjksQzVBMSxCMkE2LEQ0RjEsQzBBOCxDQUMzLERFRDcsRDVGQyxCOUIwLEM4QUQsQ0JBOSxERUQ5LEJGQkQsQzZCNCxEN0E3LENBQjAsQzRDMyxCM0Q2LEI5RDIsRDZCOCxFQUZDLEIwQjQsQkZFNixDQ0Y0LENEREEsRDZCRixDMkNFLENFQ0UsQ0NBMixEMEFFLEM0RDMsQjVCMixERUQ4LEQ1RjUsQkNCNyxCQkQzLEIwQTQsQzVCMixCNEVDLEQ1RjEsRUFGRCxERURBLENEQTYsQ0RFQyxDRUU2LERFREMsQ0RCMSxDMEE2LEQ3QkQsREVEQixCMEM2LEJBQjQsQzlEMyxDNEYzLEJFRTgsQjJCNixDMENDLENCRjAsQkNGMSxCQkJCLEI1QjcsQzVGNSxERUU2LERFRTMsQkVERCxERURGLEI0QjcsQkRERCxERUUwLEM0RUQsQ0ZDNixCNUUwLEI2REUsQ0FEQSxCNUY0LERFRTUsRDVDNixERUUxLENDQ0QsQzZGRSxDNUM1LEQyQjQsQkVGMixDMkQzLENDQkQsQjNCOCxCREQzLEJGRDgsQ0RDNixEMURBLEI0RUIsREVFNCxERURELERFRTcsRUFGRSxDMkIwLERFRTIsRDZDMCxCNUE3LEIyRjQsREVFOCxERUYyLERFRUQsREVGMSxDOEUwLEQ3RTEsREVFRixDM0U4LENDRTEsQjJFNSxEMkJFLERFRUUsREVFQixDRUQ1LEI0QTcsQkZBQixCRUJFLEJERDIsREVFOSxENEFFLERFREUsREVFQSxDMEJGLERFRUMsQjJGMyxCOEU5LEMyQTcsQkRDMSxERUY1LERFRjgsQjJBQixCNEE0LEI0RUEsQzlBNixERUY2LENCRDEsQjhFMyxERUY3LERFRkEsREVGOSxDQ0MyLEIwRTEsQjRFRSxFNUJBLEQwQUYsQjJFQixFQkExLERFRjQsQzlFMyxERUYzLEIwREEsRDJBMSxCMUY3LENDQUYsREVGMCxDQkE0LEQ1QUEsREVGQixCNERELEM0QTYsREVGRCxDM0ZFLEM0QTEsREZBMSxDMUNDLERFRkMsQkVFRixDNkIyLEIzQzUsQzhGNixDQkJBLERFRkUsREZBNCxEN0IyLEIzQjcsQzFDMyxDN0NCLEIyQTUsQjRFOSxEN0FCLEM0RUMsREZBMixERkEzLERGQTUsQkFCMyxERkE2LEMwREUsQzlDMyxCMkQ5LEM3RTYsREZBNyxDN0RDLERGQTgsRUJBMixDQkQzLERGQUEsREZBOSxCMkMxLEM1Q0EsREZBQixENERDLEM4QzEsREZBQyxCRUYwLERGQUQsRDZBNyxFQUI3LEVCQjYsQ0FENSxEOEZDLEI4QzQsQjlBNSxCN0M1LEQ1RkUsQjlDQSxEMEE3LEY0Q0QsQjVEMCxDM0Y0LEJFQzgsRUJCNyxCMEJELEJEQ0MsQzFCMixCMUQ2LEIzQTgsQjhEMixDOUEyLEI2RDgsRUJCOCxCRUI0LENBRkQsQzdDMyxENUZCLEI3RjMsQ0VDNCxENUFCLEIxRjMsRUNCMyxCMERGLEVDQjUsQjZCNyxDMUNGLEY1RkEsRDBCMSxENUU1LENFRDMsQkRFRixCM0UyLEI4QUIsRDVCNixFREJELEI2Q0YsQ0JCOSxEMEMyLEI3QkQsRUNCNixDQUE5LEM1RDQsRUNCOSxFQ0I4LEMyQzMsRUNCNyxEMEZELEVDQkEsRUNCQixEN0U1LEVDQkMsRUNCRCxDNkVDLENFREUsQkNDOCxDOEQ1LEI1QTksQkVDOSxENkJDLEQ0RTcsRDFBRSxEMEYxLEVBQjgsRUFCOSxFQUJBLEJBQjUsQ0FCMSxCRkY1LENERkEsRUFDMCxCMEJBLEVBQkUsQzBBNSxFQUJCLEIyRkQsQzNGNyxCQkU4LEQyRDcsQ0VGNCxFQUJGLEVBQkMsRUFDMyxEMEM3LEQzQjMsQjRCQSxDM0MxLEQ3RjIsRDVEMSxDQUM3LEVBQzUsRUFDNCxFQUM3LEVBQzYsRDZFNyxDRkQ0LEVBQ0IsQkJDRSxCREZBLEM5Q0UsRUFDQyxDOUI5LENGRkUsRUFDQSxENENFLEVBQ0QsRUFDRixDREVELEVBQzksRUFDRSxDRUVFLEJCREUsQjNCRixDNkQ1LEJFQjAsQ0VGQSxDN0U3LEJFQTcsRUFEMCxENkM3LEMxQzAsRDRERCxFQUQxLENGQkUsRUFEMixDQUVFLEM1QUYsQjBCNSxFQUQ0LEVBRDMsRjRERixDNEJBLEIxQTksRTVERixFQUQ1LENBRUYsRUFENixFQUQ3LEM2RDgsRUFEOCxFQUQ5LEQ0QkIsQzdGQSxEMkI3LEI4RkMsRUFDMixCMkRDLEMyRkMsRDRGOCxDQ0U2LEQ3RUUsRDRDMixEM0QwLEVCQzMsQzVGMyxCN0ZFLEVCRDQsQ0JCNyxFQkRFLEMwQ0EsQ0RGQixCM0FGLEM2REEsRUJGQyxDNEJFLENFQjQsQzRBOSxCMUJFLEQ0RkQsQ0FGNSxENkVDLEM2RDMsQjZFNCxCQkZBLEQwRTAsQzlCMSxENEQzLEM4QTgsQjhDQixFOEJFLEM5QkMsRThCQixDMEVFLEQwRDMsQjJDNCxCNEU1LEU4QkMsRDVDOCxCNkM1LEU4QkQsQ0FGOCxCOERDLENDRjUsQzBCNCxEMUVFLEU4QkYsRThDMixCQUJDLEIxQUQsQkREQyxFQUJELEU4QzMsRThDNixFOENCLEU4Q0MsQ0JDOSxCMEU1LEJDQUIsQjlCOSxFOEMxLENERjcsRThDQSxDRUY2LEQ1RUQsQzFENixFOEM0LEMzQjYsQjlGQixENkE2LEU4QzgsQ0FFMCxENEU2LEU4QzAsRThDNSxFOEM3LEM3QjksQjdFMyxFOEM5LEJGREQsRThEMixFOEQ3LEU4RDUsQkNEQyxCQ0NGLEU4REIsRThERSxFOERBLEIxRkEsQjBEOCxDNEIzLEI4Q0MsQzZFMixDOEJFLEM4RTEsRThDRixFOEQ0LEU4RDYsQjlGMSxFOEQ4LEQ3RjUsQzRGQixFOERDLEIyRTksRThEMSxCQ0VELEJGQzIsRThDRCxENkY5LEMxRjgsQjJGMSxFOERGLENBQzEsRThEOSxENUE0LEIxRUEsRDVCQixFOENFLEU4RDAsQjZCMCxFOEQzLEU4REQsQzBCOCxDQUY3LENCQTgsQzZEQyxDMEY1LEU4RTksRDBBMyxFOEYyLEQ2RUEsRThFMCxFOEUxLEQxRjksQkFDQixCOEY5LEI4RjEsRDRENCxFOEVGLEU4RUUsRThFQyxCOUYwLENDRDIsRThFNixDRUE2LEJGRjIsQjBCOCxFOEYxLEU4RjAsRDdDMCxFOEU0LENEQTksQzlBMyxCQkI4LEJEREIsRThFQSxFOEUyLEU4RTMsRThFNSxCNUI1LEU4RTcsQzdDNSxFOEVCLEU4RUQsQkRCMCxEN0FFLEU4RjgsRThGNSxDREIwLEU4RjYsQzFCQSxFOEU4LEMzQjcsQjBGMCxFOEY0LEU4RjcsQjlBMyxDOUQyLEMzQ0UsQ0VFMCxDMEU2LENCRjMsQ0NERCxEMEI1LENBRTEsRThGMyxCQ0VDLEU4RjksQzNERSxDNkU1LEI5RjcsQjBGNCxEN0Q4LEJDQUMsQzVFRixDQ0M0LEU5QTYsQzlBRCxFOUEyLEMwRTIsQkZDMyxFOEZFLEI5RDcsRThGQixFOUE0LEQyQ0UsRTlBMyxENkIyLEQ3QjUsRTlBNyxCREI3LEU4RkMsRThGRCxFOUExLENERDYsRDJBQyxFOUIyLEU5QTksQjRBQSxCNEJCLEU5QUIsRDBBOCxFOUE1LEIzRkUsRTlBQyxDMEUzLEU5QUEsRTlCOSxFOUI4LEU5QUUsRThGQSxFOUE4LEJGQUMsRTlCMSxFOUJBLEMyQTUsRTlBRixCOEM1LEU5QUQsRDNEQyxFOUI0LEU5QjUsRTlCNyxFOUM3LEMwQzYsRTlDNSxFOUIwLEU5QkIsQjBGMSxFOUJDLEQ1QTUsRTlCRSxFOUJGLEU5QzEsQzFGMSxDOEI2LEU5QkQsRTlDMixFOUMzLEU5QjMsRTlCNixCQkIxLEU5QzAsQkNGNyxFOUM0LEU5QzYsRTlDQSxFOUNFLEIyREIsRTlDOCxCN0FFLEU5Q0IsRTlDQyxENUMxLEM0QTMsRTlEOCxCQUUxLEU5QzksRDNBMyxFOUQ0LEU5RDcsRTlEMCxFOUNGLEM3QzEsRTlEMixFOUQ5LEIzQzgsRTlEMyxDRkYwLEU5Q0QsQjNGNyxFOUQ2LEU5REEsQ0NCNCxDRkFELEU5RDUsRTlEQyxFOURCLEU5REUsRTlEMSxFOURELEU5REYsQzNDQSxDN0I3LEI0Q0UsQkJCNixEMEMwLEVDQTMsQzVCNyxEM0ZCLEVDQTQsRUNBNSxDNkRCLEJGRUUsRUNBNixFQ0E3LEQwQUEsQzdCOCxCOEU4LEVDQTgsRDZCOSxENUZELEI0Q0IsQjJCRCxDRUU0LEM2RTcsQ0RFMSxCNEY1LENCQzAsQkNERixFOUUyLEU5RTMsRDFFQSxFOUU1LEI0RjksRTlFNCxEMUIzLENBRTIsQjJEMCxFOUU4LEU5RTYsRTlFNyxENkIzLEU5RTksRTlFQSxFOUVCLEU5RUMsRUNBRixDNUI5LEI2Q0UsRDJGMyxCNUVFLEJCRDksRUNCMSxEMkUzLENFRTMsQzRCOCxDM0JGLEI2QkUsRDhCOSxCMUM4LEIxQ0YsQjFEMSxDNUZFLEIxRDAsQzNBQixENUIxLEVCQTQsQkFDMSxDQ0JBLEVCQTUsRUJBNyxFQkE4LEVCQTYsRUJBOSxFQkFCLEVCQUEsRUJBQyxDQUNGLEQ4QjUsQzNGMSxDM0E1LEM2RjgsRUJBRCxDNENBLEVCQUUsRUJBRixFQkIwLEI3RDUsQjdGQSxFQkIxLEM3RTIsRUJCMyxCQUE0LEQxRjUsQjBCMSxFQkIyLEVCQjQsQjVBQSxDMkM4LEM3RTgsRUJCNSxDQkFFLEUzREYsRDNDMCxEOURCLENEQTEsRDZBRCxDN0YzLEQ5RTAsQkJFMyxCQUJBLEUzRTIsQ0ZBQixFM0UwLEM5QzcsQkFCOSxEMUI0LEUzRTEsQzhFQSxCOUFGLEJEQUQsQjNEOCxDRURCLENDQzAsRTNFOCxFM0U5LENERjQsQ0NBRCxCQ0IzLEUzRUEsRTNFQixEMERBLEM2RkIsQjdEQSxDN0RGLEQyQ0EsQ0VENixFM0U0LEUzRUMsQzlGMixCM0MxLEUzRTcsQzZFMyxFM0U1LEVEQjMsRTNFNixDOUIzLEM1RTYsQjlCNSxDM0JCLEUzRTMsQzVCRCxDMUE0LEMyRDksQjJENyxFM0VELEJCQTYsQzRBRCxFM0YwLEJFREEsRTNGQixFM0Y1LEJBRDMsQjdEMCxEM0NELEQ2Q0UsRDVEMyxCOUMxLEQ1QjQsRDFEOCxEMEI5LEM3RjYsQzhBQSxCMkI0LEMzREEsRTNFRSxFM0ZDLEUzRUYsQjdBOCxFM0Y3LEUzRjQsQjdCQSxDNUEyLEUzRjYsQzVERCxCMkE4LEM2RkMsQzRFMCxEN0EyLEMwRTEsRTNGOSxFM0ZBLEUzRkQsQ0NBOSxFM0YzLEQzQkUsQjFDMyxFREI0LEUzRjEsRTNGMixFM0Y4LEQwQkEsQzZDMyxENEYzLEUzRkUsQkRFMCxFNEE3LEU0QTYsRDFGMyxFNEEzLEU0QTksQzhGNyxDRkI0LEU0QTgsRTRBRSxDMkU1LEI2QjQsQkRGMixFNEEyLEJBRTksRTRBQSxFNEFDLEI2RkQsRDZERSxFNEIyLEU0QUQsRTRBMSxCQkVFLENEREQsQzdBMixDNUM5LEMxRjcsRTRBNCxDN0IzLEJEQUMsQkRCRCxFNEE1LEQ3QzcsQjJFMixFNEFCLEJDQzMsRTRBRixCQkVCLEU0QjAsQzVBOCxFNEIxLEQ1RTMsQkZBMyxFNEJBLEU0QjcsRTRCQixFNEJELEM2RDYsQkFDNixDMENCLEI4QTEsRTRCNCxENEExLEJBQTMsQkRGRSxFNEJDLENEQkYsQzRGOSxDRkZCLEM5RTYsRDNCRixDRkQxLEU0QjMsRTRCOCxFNEI5LENDRTksQ0NDRSxDMEQ0LEU0QjUsQzFCMCxFNEI2LENFRDAsQkJDMSxCNUQzLEM4RjMsQkRBNyxENUM3LEM5QUMsQjhBMixFNENBLEU0Q0MsRDFDNCxEMkJBLEJBQUQsQkFENCxFNEMzLEI1RUQsRDdDRCxFNEMwLENGRkQsRTRCRixDMURDLENDQ0EsQ0FFNyxDNEQ3LENDRDQsRTRDOCxFNEM3LEU0QzEsRTRDNCxCNUFELEQzRDksRTRDNixEMkY5LEI0RTMsQkJCNCxDOUVFLEI0QkUsQkJFQyxEMUNELENDRUQsRURCNSxDN0U1LEQ0QTgsRTRDQixEN0Q1LEU0QzIsQkRBNSxFNEM1LEQzRTYsRTRDOSxDOUY4LEU0QkUsRDNFNSxDN0ZFLEI2QzksRDRGQyxCMkIzLEU0RDcsQ0VDMixFNENELENFQkMsQjhEQixFNEQ2LEJGQ0EsRDNDRSxDM0VDLEM1QzgsRTREOCxDREM0LEU0Q0YsRTRENCxFNEQ1LEJBRkUsQ0ZFNixENUJGLEU0RDIsRTREMCxFNENFLENERTUsQ0FBQSxDMEEzLEJEQTYsRTREMyxCOEM4LEU0RTcsRDRCNCxFNERCLEMxRUYsRTRFOSxEMkU3LEU0REYsRTRFMCxDRkFBLENCREQsRTREQSxFNEQxLEU0RTUsQzhEQyxFNEUzLEM0RTcsRTRFMixFNEUxLEIzRkMsRTRFOCxCNUUxLEQ3Q0MsRTRFNixCQkFDLEQ3RDIsQ0NDRixFQkY4LEU0RTQsQjlGNixENkNELEU0RDksRTREQyxDMkZBLEU0REUsQzJDQixDMEM0LEMyRDAsQjFGNSxDQ0IyLEI1Q0UsRTRFRixDNkFGLEM2RTEsRTRGNSxDMkE5LEMwRUMsRDFERCxFNEVFLEM0QUUsRTRFRCxFNEY2LEU0RjQsQzJGRSxFNERELEU0RjAsQ0FGRSxENUM0LEU0RjEsRDFGQSxFNEVCLEU0RUMsRTRGMixDRUFCLEM1Q0IsQzdCMSxDMkJBLEU0RUEsQzFDQSxDQ0I2LEIzQjEsRTRGQixFNEYzLEU0RkEsRTRGRCxFNEZDLEIzQ0UsQjNCQSxFNEY3LEU0RjksRTRGOCxDNUVDLEMwQkQsRDRFOCxFNUEyLEIwQzQsRTVBNCxFNUEzLEJDQTQsRTVBNSxFNUExLEU0RkUsQjFGNCxFNUE4LEU1QTksRTVBNixFNUE3LEU1QUEsQzZEOSxFNUFCLEU1QUQsRTVBQyxFNUFGLEU1QUUsQjlFMCxFNUIwLEU1QjEsQkJGMCxFQ0UxLEMzRjAsQjVDNixCQkQyLEMxRTksRDRFRSxCRUM0LEQ3QzYsRDRENixCMkQzLEVDQkUsRUFDMSxDMkFGLEI0QjYsRDFENyxCM0I0LEM4QjIsQkZCQixFQ0MwLEQ2Q0IsRUNCRixFQ0MxLEVDQzUsQkVFNixDQ0JGLEM1REEsQkVCQyxFQ0M2LEIxRkUsRUNDNCxENUE4LEI1RTMsRUNDMixDMUI2LEIzRTMsRUNDMyxDQkI4LEMwQzMsQ0NGRSxDMUQyLEVDQzgsQkFFNixDMEQzLEQ2RjIsRDFDQyxCRkJFLEI3QjMsQzlENSxFQ0M3LEJCRTIsQ0NDQyxCREZELEM4QzgsQ0ZBOSxDREU5LEM1RUIsQjdFOSxEMUM5LEJBQjgsRUNDOSxFQ0NBLEJCQzAsRUNDQixFQ0UyLEIxQkEsQjdEOSxCREI5LEVDQ0MsRDFFNixFQ0NELEM4QkIsRUNEMSxFQ0QzLEJCQ0QsQkNFNSxFQ0NGLEM5QjcsQzNCQSxFQ0UzLEQ1RDUsRUNEMCxENkYzLEVDRDIsRUNDRSxFQ0Q0LEVDRDUsQzlCRixDRkE4LEQwREMsRDFBQyxDOERCLEVDRDYsQ0VGNSxDQUVDLEVDREEsRUNEOSxCMEJFLEVDRDcsRUNEOCxFQ0U0LEM4QkMsQzFDNyxFQ0RDLEQxRTAsRUNEQixENEVGLEVDREQsREJDNixFQ0RFLEIxQUMsRUNERixFQ0UwLEQ3QTYsQzVDMCxFQkJDLEIwQUUsQkVGNCxCOEI4LEQyQUYsQjBENixCNUY5LEQ4QjMsQ0JBQyxFM0RELEM2QUMsQjBFNixDNUM2LEVCQjksRUJCQSxFQkJCLEQxQzAsQzVBMyxFQUYyLEM0QjIsQzRCNSxDMENFLEVBRjMsQzRDMSxDRUVGLEVBRjAsRUFGNCxDOUZDLEM3QTMsQ0NEOCxDRUZFLEVBRjUsRUFGNixDRkFDLEMwRTcsRUFGNyxCNkJGLEVBRjgsRUFGOSxFQUZBLEVBRkIsRUFGMSxDOEFFLEUxRUIsQjdCOCxFMUVDLEUxRUQsRDdCNCxFMUVFLEUxRUYsRDNDQyxFMUYxLEJGRjEsRTFGMCxCNUQyLEIxQjcsRTFGMyxFMUYyLEJBRkMsRTFGNCxCOUI3LEJFRDEsQzRGQyxCQURELEJEQzYsRTFGNSxFMUY3LEI2QzAsQ0ZDMSxDQUE4LEUxRjYsRDVGOCxEM0ZDLEUxRjgsRTFGQyxFMUY5LEUxRkEsQzBFQSxFMUZFLEUyQTEsQzBDNyxFMUZCLEUxRkQsRTJBNSxDMUQ0LEUyQTMsRTJBOCxCMkZFLEUyQTIsQzNDRCxCMkMyLEUyQTcsRTJBNixFMkE0LEUyQTksRTJBQixEMEM5LEQ2RUQsQzNBOCxFMkFDLENGRDcsRTJBRSxCQUVGLEU5RTAsRTJBRCxFMkFBLEJCQUIsRDRCMyxFMkIwLEUyQUYsRTlFMSxFMkIxLEUyQjIsRTJCMyxDQ0ExLEUyQjQsRTJCNSxEMEZFLEMyQ0EsRDNGMSxDREY1LEU3RTAsRTdFMSxCRUMxLEMyRUEsRTdFNCxFN0UzLENERTYsQzNCNSxFN0UyLEJCQjcsQ0ZENixDMUUxLEU3RTksRTdFOCxFN0Y0LEIyQTMsRTdFQSxFN0U2LEU3RUMsRTdFQixDOUJBLEQ1RTQsRTdFNSxCN0E5LEU3RTcsRTdFRSxFN0YzLEQ2RTksRTdFRCxFN0YyLEU3RjEsQjBFMCxFN0Y1LEM3RjIsQzBDNSxDMEVELEMxRjAsRTdGMCxFN0Y2LENCRjYsRThBMixFOEExLEQ3QzEsRTdGQSxFN0Y5LEU3RkIsRTdGNyxFN0ZFLEU3RkQsRTdGQyxDMUQ1LEM3RDksQzVGRCxDNUMzLEM3RUQsRThBMyxFOEE2LEU4QTUsRThBNyxCQUY3LEU3RjgsRThBNCxDOEYwLEM5QUEsRThBOSxCOUU1LEQxRkUsRThBOCxFOEFBLEU4QUQsRThBRSxDMUE3LEU4QUYsRThCMCxFOEFDLEU4QjQsRThBQixFOEIxLEU4QjUsRThCMixFOEIzLEU4QjcsRThCNixCOUNGLEYwQUMsRjBBRCxDNkIwLEIwRUEsQzhCRixDRERGLENFQ0QsRUFCMSxFQUIyLEM2QkYsQjRDOSxFQUIzLEQ1RTcsRERGOSxFQUI0LEVBQjUsRUFCNixCOENBLERGQjAsQzlGNSxDQ0YwLEM5RkEsQzlGQixEM0MzLENCQTYsQjhBNixGMEFFLEIxQzIsRTVCOCxDQ0VGLEQzQzksQkNENyxDOUVBLEI1RTcsQzREMCxCNUU5LEVFQUUsQkJBRCxFN0RFLEVFQUYsQjNBOSxFRUIyLEVFQjEsQkRFNyxFRUIwLENFQjcsQzVDRixDMUY0LERCQ0UsRUVCMyxEMEYzLEMyRDQsQzZFOCxCN0FDLEVFQjQsQjNFQixCQkZCLEVFQjUsRTdEQyxFRUI2LEJEQUUsRjFFMixDQUU4LEQyQzksRjBEQSxGMERCLEYwREMsQzFDNixCOEVELEJFQ0UsRjBERSxDNUIxLEYwREQsRDFGMSxGMEUwLEIwQ0MsQkRFQSxEMkRGLEYwREYsQjRBRixCN0U4LEYwRTYsRjBFNSxDNkEzLEYwRTEsRjBFMixCNEMzLEYwRTMsRDVFRSxDQ0RCLEJFRDIsQkNCMixGMEU4LEYwRTcsRjBFNCxCMkExLEQ2QTIsRDNCOCxCRUI3LEM4QUMsRjBFQSxEMUY3LEQ2Q0MsQkFEQixGMEU5LEI2QkIsQ0RCNCxDNkE2LEMxQTEsRjBFQixGMEVFLEYwRUQsRjBGMCxGMEVDLEJCQkUsRjBFRixDQ0I1LEYwRjIsQjNENSxCMUQ0LEYwRjMsRjBGNCxGMEY2LEI0RTEsRjBGMSxGMEY3LEYwRkEsRjBGOCxGMEY1LEYwRkQsRjBGOSxGMEZDLEYwRkUsRjFBMSxDRUMxLEYxQTQsRjFBMyxDMUY2LEYwRkIsQ0FERCxCNEYxLEIxRjEsQ0NCMSxGMUE2LEYxQTcsRjFBQyxENUNFLEYxQTksQzhCMyxGMUEyLEYxQUIsRjFBOCxGMUE1LEYxQUEsQjBBOSxGMUFELEYxQUYsRjFCMSxGMUIwLEYxQUUsRDFBMixGMUIyLEYxQjMsQjlFRixCNUM3LEIwRDcsQjBEOSxENEVELEI1QzQsQkRENCxCQkNBLEYwQTcsQjhERSxGMEE4LEIwQTgsRjBBOSxDREVFLEYwQUEsRjBBQixDNkE0LEQ2RTUsRjFFNCxGMUU1LEMzRjMsRDNEQixENkQxLEM1RTgsRDNBRixEMkU2LEVFQzEsQjBCQixENUI1LEQxQ0UsQkNFMCxCQUQwLEJGRjgsQjhDNyxCNUMxLEM1Q0MsQ0FBMixDM0NCLEVFQzIsQzRCRixCNkEyLEVERUMsQzNBNCxENkIxLENGRTAsRURFRixDNUNFLEI2REMsQ0FBMSxFREVELEVERjAsRURGMSxDM0JDLEJGQjQsRURFRSxFREY0LEVERjIsRDVFNixDM0RGLEVERjMsRURGNixENUEzLEQxQTMsRURGNSxDM0QwLEVERjcsQkZGNCxCRUVDLEVERjgsQ0NGNyxEMURCLEQ3QzUsRDVGNixFREZDLEVERkIsRURGOSxFREZBLEVERkQsQkVBNixDQkFGLEVFQTEsQjZCRCxFRUEyLEM0QzAsRURGRSxCRERFLEIyQzcsQjZDMyxFRUE1LEQ4QkEsRUVBMyxFRUE2LEMzRTksQjNGMixFRUE3LEVFQTQsQ0ZCOSxFRUE4LEMyRjcsRUVBOSxFRUFBLERFQUIsQzZCMyxDN0M2LEQ2RjUsQjVDOSxDQkIyLEVFQUIsQ0RBQixFRUFDLEQ1QjAsRUVBRCxGNkM0LERCQzcsQjRBMyxDM0FDLEYxRTYsQ0FCOCxEMkQzLEQ2QUEsRUZGMixCRUQ4LEJEQzMsRUZGMyxCNkNDLEIwQUIsQ0FBRixFREI2LEVEQjcsQ0VGOSxCN0FGLEJGRjMsRURCOCxDMkVCLEM5QjAsRURCOSxDNkY2LEJGQjMsRURCQyxDNUY4LEQxRDAsRDdBOSxFREJBLEVEQkIsRDFFMixFREJGLEVEQzAsRURDNCxFREM4LEVEQzYsRURDRSxENUU4LEVEQzksRURDNyxFREJFLEM1RTksQzZDNixDOUU5LEQ0RDIsRURDMSxFREMyLEVEQzMsRURDNSxDMEY5LEI0QTEsQjlFOCxFREQwLEVERDEsRURDQSxFRENGLENFRjgsQ0JCNixFRENDLEVEQ0QsQ0ZGNSxFREQyLEMxRjIsRDNCMixFRENCLEM4QjcsQkNFRixDNUYwLEVERDYsQjVFRixDMkI1LEIwQUQsQ0JFOSxCMUFFLEVERDQsQ0RFQixCNUUyLEVERDUsRUREMyxFREQ3LEI1RkEsRUREOCxFREQ5LEVEREMsQjFDQyxDNUY2LEJDRUUsRUREQSxDQ0JDLEIyRUEsRUREQixDNEVCLEI0QzUsQjBGNSxFRERGLEMwREEsQjRFOCxDNUNELEVEREQsQkZDNCxFRERFLEM0QTUsRURFMCxFREUxLEVERTMsQzFENyxCQkM3LEJEQjgsRURFMixFREU0LEVERTYsRURFNSxFREU3LENBQkUsRUNFQSxDMEYxLEM5RTcsRUNFQixDNkVFLEVDRUMsQzZFRCxFQ0VELEVDRjAsRDdFNixFQ0YzLEVDRjEsRUNFRSxFQ0VGLEQ3QTMsQzlGMSxDQkVFLEVDRjQsRUNGMixDRkU5LEVDRjYsQzZCMSxCQ0MwLEVDRjUsQjVCQixCQkY2LEVDRjcsRDlGNyxCREZCLEMyQkIsRUNGOCxFQ0Y5LEI4QTMsRUNGQSxFQ0ZCLEVDRkMsRDNFRCxEOEFFLEMwRUIsQzdERCxCQUNDLEQwRTMsQ0JCRCxDREJBLEI4RDEsQjFGQyxDN0VGLEQ2RDYsQkZDNixDM0VCLEVGRjUsQzNEOCxEN0UyLEVGRjcsQjNEMyxDN0Q4LEQxRUQsRDZDOCxFRkY4LEVGRjYsQkJGRCxCM0M2LEJERDUsRDJDNixCQkUwLENGQTEsRUZGQyxFRkZCLEVGRjksQjNDQyxDOUQ0LENCQjAsRUZGRSxCMERFLEQ2QzksRUZGRCxCM0VELEY2RDUsQ0VDOCxGMEEyLEYwQTEsQjVCRSxCQ0RBLEJCRkMsQjhFNSxDNEMyLEYwQTMsQ0JFQixGMEE2LEQxQTgsQkVCRixDN0VFLEYxQjYsRjFCNyxCRkQ1LEI0QTksRjFCOCxDREJCLEM3RDQsRDVBRCxGMUI5LEYxQkEsQzdDRixEMkE0LEQ2Q0YsRjFCQixCREQxLEI0QjAsQkVCRCxCNERDLENFRDEsQkZERixGMUJELEJGRkEsRjFCQyxGMUJGLEYxQkUsRjFDMCxGMUMxLEMxRkUsQzFBMixDQUZBLEQ1QkUsQkVCQSxCRUI5LEQ1QzIsQkZBMixDREFGLEYxQjUsQkRERixCNkNCLEQ2RjEsRjNDMyxGM0M0LEI4Q0QsRjNDNixGM0M3LEIwQ0EsRjNDNSxGM0M5LENCRjEsRjNDQixEMEE2LEIxQ0EsRjNDOCxGM0NGLEI1RDEsRjNENyxGM0QyLEYzRDQsRjNEMyxCN0ZCLEIxQkYsRjNDRSxGM0NBLEI1REEsRjNEMCxGM0QxLEYzRDUsRjNDRCxCQ0UzLEMxRkQsRjNENixGM0RBLEYzQ0MsQjVDOCxCREVFLEYzREMsQjdBNCxCRkYwLEQ2RkUsQ0RCMixCNEYwLEIyREYsRjNEOCxGM0Q5LEM5QjgsRjNERCxGM0RFLEYzRTEsRjNERixGM0UzLEYzRTIsRjNEQixCRkVBLEIzRUYsRjNFMCxDN0E5LEJDRjIsRjNFQixCOUJGLEYzRTQsQjJBRCxCQkZFLENCRTMsRjNFRCxGM0U5LEI5REMsRjNFRSxGM0U1LEYzRTYsRjNFQSxDMkUxLEYzRUMsRjNFRixGM0U4LEJDRkQsQ0ZFNCxGM0YwLEYzRTcsRjNGMixEN0FELEM2QUEsRjNGMyxGM0YxLEMyQTgsQjhERCxGM0Y1LEYzRjQsQjREQixGM0Y2LEYzRjcsRjNGOCxDMEJBLEMwRTksQzVGMSxGM0ZCLEYzRkEsQjREOCxGM0ZFLEYzRjksRjNGQyxGM0ZELEY0QTEsRjRBMyxCQkM5LEY0QTIsRjRBNCxCMkJFLEY0QTYsRjRBNSxCQ0FFLEMzRDcsRDlFMSxDMEUwLEY0Q0MsRDdEMSxCN0RCLEY0Q0UsQzFBMyxDNkM5LEI0RDYsRDVCMyxGNEQwLEY0Q0YsRjREMSxDQkRBLEY0RDIsRDRDMSxENkUwLEI3RTAsQzFCOCxDMUJCLEY0RDMsQkVBQyxCNEUyLEY0RDQsRjRENSxCRUFCLEY0RDYsRjREQixGNEQ3LEY0REEsQkFGRCxGNEQ4LEY0RDksQjhFMixDQ0M3LEY0REMsQjJEQSxDM0QzLEQ0RTMsQkZCNyxGNERELEM1QjQsRjRFOSxDRkI1LENFQzksQ0JEOCxDQkY3LEJERjQsRDdDRixDMERCLEQwRjUsRjRFQSxGNEVCLEY0RUMsRjdFMyxCN0IxLEY0RUQsRDdFQixGNEVFLEU2RjksQkVDMCxFNkZBLEJBRUMsRTZGQixDRkNCLEU2RkMsRDRCQyxCQ0I2LEU2RkQsRTZGRSxCQ0NELEM4RDIsQ0VCMyxFN0ExLEI0QkYsRTdBMixDOUI0LEI4RDksQzRDOSxEN0RELEMyREEsQjdENyxENkJELENFQzYsQjdDNCxDNUE2LEU3QTMsQ0ZERixFN0E0LEU3QTUsRTdBNixDMUI3LEQ3RTksQzlGMCxDRkI4LEQ2QUYsRDZENSxFN0E3LEIwRUQsRTdBOCxFN0E5LEM5REMsRDJFRixCRUFELEU3QUEsQjBGMyxDOERFLEJERTEsRTdBQixDOEM2LEU3QUMsQkJFNixCOEY4LEQxQTQsRTdBRCxDMkU3LEJFRjgsQkRDQSxDREIzLEU3QUUsRTdBRixCRUVFLEQwRTUsQ0JFNyxDQ0QwLEJDQ0MsRTdCMCxCQ0E4LEQwRjcsRTdCMSxEMEY4LEU3QjIsRTdCMyxCNEMyLEU3QjQsRTdCNSxDOUZFLENFQUMsQzNFMCxFN0I3LEIxQzEsQjNGMSxFN0I4LEU3QjksRDdEQixENUMwLEU3QkEsQzJDQyxEN0JBLEU3QkIsRTdCQyxFN0JELEJDRUEsQzNFNSxDMEMyLEU3QkUsRTdCRixCQ0E5LEU3QzAsRTdDMSxFN0I2LEI2RDAsRTdDMixFN0MzLEU3QzQsQkJCQSxCNURFLEMyQzYsQjFFMCxFN0M1LEQ0QjUsRTdDNixCOEJGLEU3QzgsRTdDNyxCN0VDLEU3QzksQjJGOCxFN0NBLEU3Q0IsRTdDQyxFN0NELEU3Q0UsRTdDRixFN0QwLEQzQTcsQ0JGNSxFN0QxLEU3RDIsRTdEMyxFN0Q0LEM5QzksRTdENSxFN0Q2LEU3RDcsRTdEOCxFN0Q5LEJEQzksRTdEQSxGM0JFLEI4RDcsQzhCMSxGM0JGLEYzQzAsRjNDMSxCOURFLENERjgsRDhFOCxCQUIxLEMyREUsRUVCNyxCN0EzLEVFQjksRUVCOCxCMEQ1LEVFQkIsRDVENixEN0VGLEQ2QzMsRUVCRCxDQUYwLEVFQkMsRUVCRSxFRUMwLEVFQkYsRDFGMixDN0JDLEMzQzAsQjhFMSxDMUU3LEY0QzYsRDBERixGNEM3LENGREIsQzhCQSxGNEM4LEY0QzksRjRDQSxGNENCLEQ5RkEsQjhGRSxFNUYxLEQzRjAsRjRFMCxDRUNDLEIzRTEsRjFCNCxEMkVFLEY0RTEsQ0ZFOCxGNEUyLEM3Q0MsQjVENCxCNEU0LEY0RTQsRjRFMyxGNEU1LEY0RTYsRjRFNyxCQUIyLEIwQkYsRjRFOCxCN0FELEQyRUQsRDJBQixDMENGLEJGQkMsRUJBMyxENURGLEVBQzgsRjFGMyxCNkY4LENCQTMsQzRDRCxGMUU3LEYxRTgsQjhGQixGMUU5LEJBQzQsRDRDNSxCMEQyLEYxRUEsRjFFQixGMUVDLEYxRUQsRjFFRSxGMUVGLEYxRjEsRjFGMCxDNUQ1LEYxRjIsQjZGQSxGMUY0LEQyQUUsREVDNyxDQkNBLEIzREMsQjVBMixCOUEyLEM0RjQsRjFGNSxGMUY2LEMxQzQsQzFGQixENkIwLEYxRjcsRjFGOCxDMUFBLEM2QjgsQkVEQixGMUY5LEI0Q0YsRjFGQSxFREIyLEVEQjEsQ0JFMCxEMkRFLENCQzEsRDVEOCxDOEUyLEMwREYsQkNBMSxFQkMxLEQwQTQsRDZFMixCNkM3LEI4RDgsRUJDMCxCOENFLEVCQkYsQjNBNixCOUM5LEQ2QUIsQjdGNCxCN0NBLEJDRTcsQjdCRSxFQkM2LEVCQzcsQjBCOSxCRkNGLEVCQzUsRDNGRCxFQkM4LEVCQzksQjdDRSxFQkMyLEVCQzQsQzlGNixENkQ3LEQ1Q0QsRDBCMixFQkNGLENFQjgsRUJEMCxCNUE4LEIxQjMsRUJEMixDQ0E1LEM1RDYsRUJEMyxFQkQxLEM1REYsRUJDRSxDQUE0LEVCRDUsQjBGQixCQUZBLEQ4QjcsRjFFMyxFQkNBLEVCQ0IsRUJDQyxFQkNELEVCRDYsRTZDMCxFQkQ5LEJGRTgsRDJDOCxFQkQ3LEVCREMsQjhFQyxFQkQ4LEJEQkEsRDBEOCxCMEI3LEVCREQsQzREQyxENkFDLEI0RTAsQzJGNixCQ0I5LEVCREEsRUJEQixENEUwLEM2RUEsQzRENCxFQkRGLEM1QTcsRDlGNSxCMkIxLEVCRTQsQkRDNSxFQkUyLEVCRTMsQjhBQyxDREQxLEVCRTUsRUJFMSxDMUIzLEM2QTIsQ0NGMyxFQkU2LEMwQjAsRDJCOCxFQkU3LEI4QUYsQjhBRCxFQkU4LEM3QkIsQ0RGMyxFQkVBLEVCRUIsRUJFRCxEMEM4LEVCRjIsRUJFRSxFQkYxLEM4RjksRDFGQyxFQkVDLEVCRTksQjhCOSxDRkQ5LEM0RTUsRUJFRixFQkYwLENDREEsQ0RDOCxCMEYyLEVCRjYsRUJGNSxCMkIyLEI4RTAsRUJGNyxCMUVDLENDQzUsQzRBNCxDRkE1LEVCRjksRUNBMixDNUYyLEVCRkEsQzlDNSxFMkRGLEVCRkUsQ0RDRSxFQ0ExLEIxREIsRDNCNyxEMkRDLEVCRkQsRUJGQixCM0JDLEVBQjAsRDdENCxGNEFCLEIzRjQsRDZDMSxENkMyLEQ1RTksQkVDQSxGNEE3LEQyQTgsRjRBOCxGNEE5LEY0QUEsQkVDQixEM0RGLEM5RTAsQzlFMSxGM0MyLENBRTYsQ0NGMixFMkI2LENCQjQsQ0VFOCxENkRCLEY0QUQsRjRBRSxGNEFGLEY0QjIsQkFCRCxGNEIzLEIwRTMsRjRCMCxGNEIxLEJEQTIsQjJENSxGNEI2LEY0QjcsQjZFNixCMkIwLENGQ0YsRjRCNCxCNEFDLEY0QjUsRjRCOCxGNEI5LENEQTcsRjRCQSxGNEJCLEY0QkMsQ0JEMixGNEJELEY0QkUsRjRCRixGNERFLEMxQkMsQkNFOCxDOUFCLEQxREUsRTVGNSxEQ0IzLEQyRDUsRENCNCxCMEFDLERDQjUsQkREQSxEQ0I5LEQ4QzIsRENCNyxEM0YzLEM5RDYsRENCQSxEQ0I2LERDQkIsQzNBMixEQ0JDLERDQzUsRENCRCxDRURGLEQ2QTUsRENDRixEQ0NELERDRDIsQkRFNixDMkFCLERDQjgsRENDQixEQ0NFLERDQkUsQjdEMixCMEM1LERDQzcsRDBCRSxEQ0MxLEJCQTgsQjdCQyxEQ0NDLERDQzYsRENCRixDN0RCLEQxQkYsRENDMCxEQ0NBLERDRDAsQ0VBRCxEQ0MyLERDQzMsRENDOCxEQ0M5LEIyRDQsRENEMSxDQkQ1LEQ0QjcsRENEQixEQ0RGLENDQTYsRENFNixDM0U3LERDREMsQkZDMSxEQ0Q5LEIwRkEsQjlCNixEQ0U1LERDRDMsRENDNCxEQ0Q2LEM4RjQsQkZFMCxDOUJCLEIxQkQsRDNBMixEQ0RBLERDRDUsQzZCQixEQ0RFLEQ3QzIsQzNBRixCN0I2LEM3RDEsQzNBOSxEQ0UyLERDRDgsRENFQixEQ0Q0LERDREQsQkVBNSxEQ0Q3LERDRTAsRENFMyxEQ0U0LERDRjgsRENFMSxEREEyLERDRTcsQkNFQixCNEM0LEMzQTMsQjJFNyxEQ0ZBLERDRjIsRENFRixEQ0ZDLERDRUUsRDJGMCxCMkU4LEM4RDcsQzhFMyxEQ0ZCLERDRUQsRENGNyxEQ0Y1LEJFQTMsRENGNCxCMkRELERDRjMsQkNGNixEQ0U4LEJCQzQsQzBGMyxCQ0Q0LERDRTksRENFQSxEQ0YxLERDRjYsRENGOSxCNUI0LEM4RDksQkJFNyxEQ0ZFLERDRkQsRDNBQixEREExLEREQTMsRERBNSxEMkYxLEREQTQsRERBNixEREE3LEQyQTksQkFDOSxEREE5LEREQjYsRERCMSxEREI0LEREQjAsQzZDRSxDMEYyLEM5QUYsRENFQyxEREFFLEREQjcsRENGMCxEREFGLEREQjgsRERBQyxEREI5LEREQjMsRERBRCxDNEFBLEREQTgsQzBCMyxDMUFCLEREQUEsRERBQixEREIyLEJCRjEsRERCNSxEM0E4LEREQkEsRERCQixDM0E3LERERDIsRERCQyxEREQxLEI5QkQsQkVENSxCRUZBLEJBQ0EsRERDQSxEREM1LEREQkYsQjJDQixEREMzLEREQ0IsQjJBNCxEREQ1LEREQkUsQzZEMCxEREQwLERERDQsQzFFMixCN0M2LEREQ0UsRERDRixEREM0LEREQkQsRERDRCxDQ0QxLEREQzksRERDMixDM0M4LEM2QkMsQ0VBRSxERENDLEREQzgsRERDMSxEREM2LEMyREMsRDNBOSxEM0FBLERERDMsQ0ZGNCxDOEY4LERERTYsRERDNyxEREUwLEMyRTQsRERFMSxEREQ3LEQ2RjgsREREOSxEREQ4LEI4RjAsRERENixDNkNGLEI2QUQsRERFMixCQUY5LEQ0RTEsRERFNyxCNEQwLEREREEsQkZGQixEREUzLEREREYsRERERCxCNUQ5LEREREIsREREQyxERERFLEJEQUYsRERFNCxEREU1LERERjUsQzNDOSxDQkUyLERERjIsRDhFMSxDNkQxLERERjQsRDVGNCxEREYzLERERjAsRERFQyxEREVGLERERTgsRDBFRSxDOEQ4LERERUUsRERFOSxEREVBLENCRjIsRERFRCxCMUNELEMwQjYsQkNCQixEREYxLERERjcsRERGNixEREVCLEM1RUUsRERGQixERUE0LERFQTMsRERGOCxDM0VGLEMyRkIsRDVFMSxDRUI1LERERkQsQjJDQyxDNEU4LENBREYsQzdCRSxEREZBLERERkMsRERGRSxERUEyLEIwQUEsQjFDRSxERUFDLERFQTYsQkRCNixDOEVGLERFQTEsREVBNSxERUE5LERFQTgsREVBNyxERUFELEQ0Q0MsREVCMyxERUFBLERFQUUsQzBEOSxCMUExLERFQjYsREVCMSxERUIyLEQxQTYsREVCNSxERUFGLERFQjAsRDBCRCxERUI0LENBRUQsREVCOSxERUI4LERFQjcsREVCQixCREU1LEIyRDgsQzNFQSxERUJBLEM1QkEsREVCQyxDQ0Q5LEI3QUEsRDRFNSxERUJELERFQkYsQzRBMixERUMxLERFQkUsREVDMCxENUJBLERFQzIsRjJBRSxCQkEyLEMyQjIsQzVCMCxDMkM3LEYyQUYsRDBFOSxEM0RELEVCQkQsQjNFNixGMkIwLEYyQjEsQ0FBRCxCQUU3LEYyQjMsRjJCNSxGMkI0LENCRTQsQ0ZCQSxGMkIyLENBQjQsRDJDRixDMkVDLENFQzMsRjJCOCxCMEY2LEYyQjcsRjJCRSxCMkNGLEQxQzEsRjJCQSxGMkJDLEQ0RTksRjJCQixGMkI2LEYyQkYsRjJCRCxGMkI5LEYyQzcsRjJDNCxGMkM2LEYyQ0EsRjJDMixGMkMwLEYyQzUsRDZGQixGMkMxLEM3RjksQzlERixGMkM4LEI5QzYsQjVCMCxGMkMzLEYyQzksRjJEMCxGMkQ2LEJCRDcsRjJENSxDRERDLEQ2RUIsRjJEMixGMkQ0LEI4RjIsRjJDQixGMkNFLEMyRjksRDVERCxGMkNDLEYyQ0QsRjJDRixGMkQzLEYyRDksRDNCQyxCNkVBLENBRjEsQjdFNCxGMkQ3LEYyRDgsRjJEQSxGMkRELEYyREIsRjJEQyxEMUQxLEYyRDEsQ0RDOSxDRUNGLEQ2QTksRjJFMyxDM0RCLEYyRTAsQzBBRixGMkVDLEYyREUsRjJFMSxGMkU4LEYyRTIsRjJFNyxGMkU2LEYyRTksRjJERixGMkU0LEYyRUEsRDNBQyxGMkU1LEIyRjUsRjJGMixEMEFCLEYyRjUsQkJDOCxGMkY5LEYyRjAsRjJGNixGMkY4LEYyRkEsRjJGMyxGMkYxLEJBRkIsQjVGQixGMkVGLEYyRjcsRjJFRCxGMkVFLEYyRUIsRjNBNixGM0EzLEYzQTIsRjJGNCxDOERBLEYyRkIsRjNBNSxDM0Y4LEYyRkQsRjNBNyxGM0E5LEYzQTQsRjJGQyxGM0FCLEYzQUEsQzJERCxGM0FFLEYzQjAsRjNBMSxGM0IxLEYzQUMsRjNBRixGMkZFLEYzQUQsRjNCMixGM0I0LEYzQTgsRjNCMyxGM0I1LEQwQjcsRjNCOCxEOUY5LEYzQjksRjNCNyxDOEU0LEYzQjYsRjNCQSxGM0JCLEI0QzAsRUVDMyxGM0JDLEYzQkQsRDFBQSxGNEFDLEQwQzYsRDBEMCxEMURDLENGQ0UsQkRENixEMUMzLEJBRTIsRTFFOSxEMkMyLEYxQzIsQjJCOSxCMUVELEYxQzMsQzlDMCxCM0M0LEQ5RjIsQ0JBNSxGMUM0LEQ2RDQsRjFDNSxGNEMwLEYxQzYsRDRBQyxGMUM3LEIwQzAsRjRDMSxGNEMyLEI0RkMsQzVEQixDQ0JCLEQwRTQsQ0RFMCxGMUM4LEQ5RjMsQjFCQixDRkFFLEI4QTQsRjFDQSxGMUNCLEIyQzMsQzFEMSxEN0IwLEYxQzksRjFDQyxGMUNFLEQ5RjYsRDJFMSxENEEzLEY0QzMsQzhCOSxGNEM0LEYxQ0QsRjFDRixCRkUzLEYxRDAsRjFENCxGMUQ2LEYxRDEsQzlEMSxDNUUxLEMyRTMsQjlGQyxGMUQzLEYxRDUsQjlEMyxGMURCLEJBRDYsQjBGRCxGMUQ5LEYxRDgsRjFEMixGMURBLEYxRDcsQzhFQyxDRENBLEYxREQsRTVCRCxGMURDLEYxREUsRjFERixDRkU1LEY0QzUsQkRGMyxGMUUwLEYxRTEsQ0VGNyxEMkFBLEYxRkIsQjhCMixCQ0ZCLEI5REIsQjlFNixDM0Q5LENBRDMsRUFFOCxDMEMwLEJFRjUsRUFFOSxFQUVBLEVBRUIsRUFFQyxFQUVELEVBRUUsRUFFRixCREM3LEY1RkIsRjVGRCxGNUZFLEY1RkMsQkRFMixGNkExLEI0QTUsRjZBMixGNkEzLEVDQjIsRDFENCxEOUVBLEY2QTQsRUVCQSxENUIyLEQzRkUsQ0NEQyxDQUM0LEU1QzAsRjZBNSxCRUFGLEM2QTksREFBNSxCQ0M2LEI2QTksQjhCQyxDOENGLEJDQTUsREFBNixEQUE3LENDRDYsQzhDMyxEQUE4LEM2RkQsRDFCNSxEMkU5LEQxQjYsQkNDNyxCREIyLEJCRTQsREFBOSxEQUFBLEQxQzgsREFBQixEMEVELEI2RUYsQzJEQixDQkNGLEI3RUQsQzlFOCxCN0MzLEJFRjcsRDZBNCxEQUFDLERBQUQsQzZDMCxEN0U3LENBQjYsRDVBOSxDQkRGLEQ1RUYsREFBRSxENkRGLEI0Q0EsREFCMCxEQUFGLEQyRUIsREFCMSxEQUIyLERBQjMsQ0FENCxEQUI0LENBQUIsREFCNSxEQUI2LEIzQ0YsRDZFRixEQUI3LEJCQjAsQjVBRSxEQUI4LERBQjksQjlFRSxEMUFGLEQyRTgsREFCQSxCOEMzLENGRUEsQjJFRixEQUJCLERBQkMsQkRFQixDRURDLEQzRUYsREFCRCxDRUYzLERBQkUsRDNENSxCQkU1LERBQkYsQ0JCNSxDQkQwLERBQzAsQzdFQixENkVFLERBQzEsQzVCNSxCNkMxLERBQzIsQjdDQyxCRkNFLERBQzMsREFDNCxDQkFELERBQzUsQjVGNyxEQUM2LEMxQzIsRDdCQixEQUM3LENDQjgsRDJFQSxDNEIxLERBQzgsQjVGRCxCQkQxLERBQzksRDBCMyxEQUNBLERBQ0IsQ0VCRCxEQUNDLERBQ0QsREFDRSxCMkY3LERBRDEsREFDRixEMUU4LERBRDAsQzNENSxEQUQyLERBRDMsREFENCxEQUQ1LEQwQkIsRDJBNSxCMEY5LERBRDYsQzdBQixEQUQ3LEJERjcsQzNBMSxEQUQ4LERBRDksQzNGRCxDQ0I3LERBREEsREFEQixDMEJFLEM2RDcsREFEQyxEQURELEM3QjQsREFERSxEQURGLEI5QzgsQkJFRCxCNkI5LEY0RjgsRjRGOSxDREUzLEY1QjksRUJFMCxDRkYzLEJCQkYsQkFDMCxENEE1LEUxRDksRjVGNCxCMUFBLEIyRjIsRjVGNSxGNUY3LEJBRDEsRjVGNixDM0IyLEY1RjksRjVGOCxCMUI0LEQ1RUEsQjhCQSxCOUIxLEIyQzYsRDRGMCxDRkNELEIwREMsRDVDQixCQkY1LEQ2Q0EsQjdCNyxDQ0IwLEM2QjYsQjFFMSxCOUJBLEQ2RkMsQjlFMSxCN0ExLEJDRkEsRUFEQSxFQURCLENDRjksQjlGMyxFQURDLEI0RkIsQzNCMyxCN0QxLEJBRDgsRUFERCxENEY0LEVBREUsQkNENixCQkRGLEVBREYsQzFERSxDMkI4LEQ0REYsRDdDQSxFQUUwLEVBRTEsRUFFNCxFQUUyLEVBRTMsQzlERSxCOEIzLEI2QzQsRUFFNSxDQUVBLEM5Q0QsQjRDRCxFMkQ5LEM1RTIsRUFFNixDMEI1LEQ3QjgsRUFFNyxEN0FDLEM4RkMsRDhEMyxEOENELEQ0REUsRDRGOSxDOUM0LEQzQUUsQjhEMyxCM0UwLEM5RTIsRjRGNixCQUQ1LEY0RjcsRDdERixGNEYxLEI4QjAsRDVENCxCOENGLEM2RjAsQjNDMyxGNEYyLEIzQUMsRDRCRCxDN0Y3LEY0RjQsRjRGMyxDQ0NCLEM4QTQsRjRGNSxEN0UzLEM1QkYsRjVDMCxGNUJCLEY1QzMsRjVDMixENkJBLEY1QzEsRDRCRSxGNUM0LEY1Q0MsQjBDRixCNUY4LEY1QzksRjVDQSxDNURDLEY1QzUsRjVDNixGNUM3LEY1Q0IsQkVFMCxGNUM4LEI4RkEsRjVEMCxGNUQzLEJGRTcsQjlGMixGNUJDLEY1Q0QsQzJCNyxDQ0Y4LEJDRjksRjVDRSxGNUNGLEY1RDEsQjZFNSxGNUQyLEY1RDUsRjVCRCxGNUQ0LEQzQkIsQjNFQyxDQ0E0LEY1RDYsRjVENyxCRUUxLEY1RDgsQ0NERixGNURCLEIyQzgsRDdEOSxGNUQ5LEY1REEsRjVEQyxGNUUyLEY1RTAsRjVERixGNURELEY1RTEsRjVERSxGNUU0LEY1RTUsQ0NFMyxFNUJGLEI1QjgsRjVFMyxGNUU4LENDQTMsRjVFNixGNUU3LEY1QkUsQjFDNCxGNUJGLEI1QzUsQjJFNCxGNUVDLEY1RTksQjZENyxGNUVELEY1RUEsRjVFQixCNERBLEQ0RUEsRjVFRSxCM0Y5LEY1RUYsRjVGMSxGNUYwLEY1RjIsRjVGMyxDOUVELEI5QUEsQzdGQixCNkUzLENDQzksRUFBNixCM0I1LEQ0RkUsQjlFQyxEMEY5LEU5RUQsRDdBQSxFOUVFLEMyRDYsQzhFRCxCQUU0LEU5RUYsRTlGMCxFOUYxLEQ2RTEsRTlGMixFOUYzLEU5RjUsRTlGNCxFOUY2LEU5RjcsQzdFMSxFOUY4LEQ0RDgsRTlGOSxCRENFLEU5RkEsRTlGQixCRENGLEU5RkMsQjhBOCxDMUJFLEU5RkQsQjFCMixCQkQ0LEI5RjUsRTlGRSxFQUExLEVBQTIsRUFBMyxCN0Y4LEJDQUQsQ0FFNCxFMENFLEQ0QUYsQ0ZCRCxENUI3LEVBQTQsRDVERSxFQUE1LEQwQzEsQjlCQyxCNEM3LEIxRDksQzBCMSxCMUU2LEIxRTcsQjFFOCxCM0JELEM4RTgsRTVDMSxCMURGLEMxQzksQjRFRixDN0E4LEQzRDgsQzZGOSxEMUI4LEI5RkQsQzJGNSxEM0FELEQ0Q0IsQkRGQyxFNUMyLEI3QjUsRTVDMyxCQkI5LEQ1RTIsQkRGOCxENEI2LENFQTUsQzFBQyxCM0Q5LENDRjYsRTVDNixFNUM0LEU1QzgsRTVDQSxFNUM3LEI1Q0YsQzZDOCxCNUZDLEU1QzUsQ0FGNixFNUM5LEMzRDQsQjFDNSxCQ0EzLEQ3QjcsQ0RDQixDQkNELENBQ0EsQ0NEMyxFNUNDLEU1Q0IsQzRFNixEMUExLEQxQjcsRTVDRCxFNUQwLENEQjgsRDZGMCxFNUNGLEI1REQsQ0RCRSxFNUQxLEI2QkEsQ0RBOCxCOUU0LENBQzUsQjNEMSxDQkQ5LEQ0RUMsRTVEMixCN0VBLEU1Q0UsRTVENSxCNEZFLEU1RDYsRTVEMyxFNUQ0LEQyREQsQzJERixCMUM2LEQzRTIsQjZERCxDQkVDLEU1RDcsRDNGNixCMUU5LEI2RjQsRTVEQSxFNUQ4LEU1RDksQjVDMCxEMkM1LEU1REMsRTVERSxFNURELEM3QjIsRDJBMyxFNURCLEQ0RTIsRDVEQSxFNUUwLEQ3RjEsRTVFMSxCMURDLEQxRkIsRTVFMixFNUU0LEU1RTMsRTVFNSxEMkQ4LEI1Q0IsRTdERixEQUY1LERBRjgsREFGNixEQUY3LERBRkEsRDBDRixDNEM3LEIwRUUsRDBCMCxEQUY5LEQzQ0EsQkFBQSxEQkEyLEM3RjEsREFGQyxEQUZCLEM5REIsREFGRCxEQkExLEQ3REUsREFGRSxDMURBLERCQTUsRDNGNCxEQkE3LERCQTQsREJBOCxCREJDLEMwQzksREJBMyxEQkE2LEQ2QTMsREJBOSxEQkFELERCQUUsREJBQyxCQUMyLEJGQTQsREJBQixEQkFBLEQ0QzcsQjJCRixEQkFGLEI5RjksREJCMCxCM0JCLEI1QTYsQjZCQyxEQkIxLEI2RjUsREJCMixCMUM5LERCQjQsREJCMyxEQkI1LERCQjcsREJCNixEQkI4LERCQjksREJCQSxEM0NGLEY0RkEsQzdGNSxEN0MzLEM1RTQsRjRGQyxGNEZELEY0RkIsQkVDNixEMEVGLEI3RDMsRDRDRCxDQ0FBLEY1QTIsRjVBMSxCQUE4LEY0RkUsQ0JENixGNUE0LEMwRDIsQjNFQSxDREFBLEY1QTUsRjVBMyxCREI0LEY1QTgsRjVBOSxCRENELEMzQjgsQkZFMSxDQkUxLEY1QUEsRjVBNixGNUE3LEM0RjAsRjVBQyxCNEJDLEQ3RUQsQjRENyxGNUFCLEY1QUUsRjVBRCxGNUFGLEQwRDEsQzNEMSxDOEE5LEY1QjAsRjVCMSxGNUIyLEY1QjMsRjVCNCxGNUI1LEY1QjcsRjVCNixGNUI4LEIyQzksRDNENCxDQUNELEMwRUYsRDZEOCxEMkIwLEMxQkYsQkRGMCxCOEFBLEJDRjgsRjZDNixGNkM3LEY2QzgsRjZDOSxGNkNBLEY2Q0MsRjZDQixGN0U5LEY2Q0QsRjZDRSxFRUM0LEVFQzUsRUVDNixENUVCLEI2QTQsRUVDOCxFRUM3LEVFQzksRUVDQSxDN0E1LEVFQ0IsRUVDQyxCN0IwLEI1RjYsRUVDRCxFRUNGLEVFQ0UsQjhDNixFRUQwLEVFRDEsRUVEMixCNkRCLEIzQUUsRDZEMyxDNEM2LEIxQjUsQjhENixFRUQzLEVFRDQsRDRCRixDN0Q1LEJFRkIsQ0VEOSxCOUIzLEVFRDYsRUVENSxFRUQ4LEVFRDcsQzVBNSxFRUQ5LEVFREEsQzdBRSxFRURCLEM3QUYsRUVEQyxCMkE3LEVFREQsRUVERSxFRURGLEVFRTAsRUVFMSxEN0VBLEVFRTIsRUVFMyxCQ0Q4LEVFRTQsRDNDQixDQ0ZBLEIyQUMsQzFFNSxFRUU1LEM3QTYsQzNBRCxFRUU2LEVFRTcsRUVFOCxFRUU5LEVFRUEsRUVFQixFRUVDLEVFRUQsRUVFRSxFRUVGLEVFRjAsRUVGMSxFRUYyLEVFRjQsRUVGMyxFRUY1LENEQUQsQzJDMSxFRUY2LEVFRjcsRUVGOCxENUExLEVFRjksQ0ZCMyxFRUZBLEVFRkIsRUVGQyxFRUZELEVGQTEsRUVGRSxFRkEyLEI4RjUsQzNGQSxFRkEzLEVGQTQsQkRDMixEMkJGLEIyRjksRUZBNSxFRkE2LEVGQTcsRDJGOCxFRkE4LEQ2RkQsRUZBOSxDNkNDLEVGQUEsRUZBQixDMUI0LEVGQUMsQ0ZGQSxDQkY4LEVGQUUsRUZBRCxCM0ZBLEI5RjgsRUZBRixFRkIwLEQwRTIsRUZCMSxFRkIyLEI3RTYsRDBCRixFRkIzLEVGQjQsRUZCNSxDOEYxLENDRTAsRUZCNixFRkI3LEVGQjgsRUZCOSxFRkJBLEQ1RTAsRUZCQixCNEVELEMzQUEsRUZCQyxFRkJELEVGQkUsRUZCRixDRUZELEVGQzAsQzJFMCxCNEI4LEQ3QjYsQkRGNSxDRkM3LEVGQzMsRUZDMSxFRkMyLEVGQzQsQjZBNyxCQ0ZDLEJFRTIsQzNDQyxFRkM1LEVGQzYsRUZDNyxFRkNGLEVGQzgsRUZDOSxFRkNBLEM3QzIsRUZGMSxCNkNELEVGQ0IsRUZDQyxFRkNELEI2QzYsQzNCRSxFRkNFLEVGRDAsRUZEMSxFRkQyLEQ1RjIsRUZEMyxDNEY3LEVGRDQsQzRGOCxFRkQ1LEVGRDYsQjhFNCxCMEY3LEVGRDcsRUZEOCxFRkQ5LEVGREEsRUZEQixFRkRDLEVGREQsRUZERSxCRUI1LEVGRTEsRUZERixFRkUwLEVGRTIsRUZFMyxDMUNELEVGRTQsRUZFNSxFRkU2LEVGRTcsRUZFOCxFRkU5LEVGRUEsRUZFQixFRkVDLEMwRDgsRUZFRCxDMUFELEVGRUUsRUZFRixFRkYwLENGRTIsQjNBNCxDM0M1LEUzQzUsQzlDMSxFM0M2LEIxRDUsQ0VDQSxCNEIzLEM4RjIsRTNDNyxDRkQwLEUzQzgsQkNFNCxFM0M5LEUzQ0EsQzNDNixENUEyLEM0RDYsQjlFQixDRUM1LEUzQ0IsQzNGNixFM0NDLEI3QTcsQjhGMyxCQUQyLEUzQ0QsRTNDRSxENEM0LEUzQ0YsRTNEMCxEMUNCLEUzRDEsRTNEMixFM0QzLEUzRDQsRDFENixFM0Q1LEIyRkIsQzBCQixFM0Q2LEMwQUIsRTNENyxFM0Q4LEUzRDksRTNEQSxFM0RCLEI4QjcsREFFMixCNkQzLERBRTQsREFFMyxEQUU2LEM4RUUsREFFNSxCN0MwLEQxRjQsRDJGNSxENUYzLEJERDcsRDdFOCxEQUU4LERBRTcsQjBBMixDREQzLERBRTksQjhCRCxCQ0NBLEMyQkQsQzJBNCxCM0MyLERBRUEsQzJBQSxDNEIwLEJEQjUsQ0ZERSxEQUVCLEM5QzIsQjFERCxEQUVDLEI2QjgsRDRCQSxCM0ZELERBRUQsRDRDOSxDRkQ1LEM1RTMsREFFRSxEQUVGLERBRjAsQzFFQSxDQ0Q1LENGREQsRDNFNyxDMkExLERBRjEsQ0JFNSxEQUYyLENCRTYsRDJGRSxCOEY0LERBRjMsQjBBRixDRkI2LEQ1Q0YsQ0JFRCxEQUY0LEUzQzQsQzFBNSxGNkJGLEY2QzAsRjZDMSxDNEQxLEM4QjgsRDFFMyxEMERCLEQxQzUsQkNBRixCOUNELEVGRjQsQjRDNixEM0JBLEY2QzIsQjNGQixGNkMzLEI1RjEsRjZDNSxEM0VBLEY2QTcsRDFBOSxGNkE5LEY2QTgsQzFFMyxDMEQ3LEIxQTIsQ0VFRCxEMEU4LEY2QUIsQ0ZGNixGNkFBLEQ1RjAsRjZBQyxDM0I5LEJCRjQsRjZBRSxGNkFELEM0REUsQzFEOCxDQkFBLENGQkMsRjZBRixGNkIwLEY2QjEsQzJCNixCMEQ0LEM1RjksRjZCMixDN0UwLEY2QTYsQkVCOCxCRUIyLEI1RTUsQjdDNyxCRkJGLEMzRDIsQzNFNixEOENDLEI4RUYsQkRGOSxEMUE1LEIwRDAsRjdCMCxGN0IxLEQwQUMsQjBCMCxGN0IyLEY3QjMsRjdCNCxDN0NBLEJFQ0YsRjdCNyxGN0I2LEIxREUsRjdCNSxGN0I4LEY3QjksQ0VBNCxDOENELEJBQUIsRThCOCxFOEI5LEU4QkEsQkVDMixEMkY0LEQ0Q0YsQzlEOCxEMkIzLEI2QTUsQzdFQSxGMUZDLENGRUUsQ0JCMyxEMEVCLEU3RUYsQ0RFNyxCOUNCLEI2RDksRjFGRCxCMEU0LENCQ0MsRjFGRSxENEE0LEMyQUQsQzFFQyxDNkM0LEJFQjEsRjJBMSxCQ0Q1LEYyQTIsRjJBMyxGMkE0LEQyQzMsQzZCNSxDREM3LEYyQTUsRDNCMSxCRkM1LENDRTIsRjJBNixGMkE3LEQxRDUsQjZFRSxGMkE4LEYyQTksQjVERixGMkFBLEYyQUIsQjJGQyxGMkFDLEYyQUQsQzhBNyxCN0U3LEVDQTksRUNBQSxFQ0FCLEVDQUMsQzZBRSxFQ0FELEVDQUUsQjdDOSxDQUIzLEUyQjgsRjdDRixGN0QwLEIyQ0QsRjdEMSxGN0QzLEY3RDIsRTJCQixCQ0EyLEUyQkMsRTJCRCxFMkJFLEUyQkYsRTJDMCxFMkMxLEI3QjksRDJGQixCREE0LENBQ0UsQjFBNSxDQkM3LEUyQzIsQjZGQyxDOEM0LEUyQzMsQkRDOCxCMUZELEUyQzQsQjZGNixFMkM1LEM0RDksRTJDNixDRkRBLEI5REQsRTJDNyxDMEExLEUyQzgsQjJGNixFMkM5LEMxRjMsRTJDQSxFMkNCLEMyRjgsRTJDQyxFMkNELEUyQ0UsQ0FENyxEOEI4LEQ5RTUsQ0ZFMyxGMEE1LERDQjAsQzJFRCxENEE2LENERDQsRDFCMSxCM0RCLEM3RkQsQjJCNSxDMkJGLEU2RTAsQ0FCQixFNkUxLEU2RTIsQkVENCxFNkUzLEQ3QTQsQ0RENSxFNkU1LEJDREQsRTZFNCxFNkU2LEU2RTcsQzJFRSxCREJFLEU2RTgsQzJFNixCQUE3LEU2RTksRTZFQSxCM0QyLEQxRTksQkZBNSxFNkVCLEM2RUYsRTZFQyxFNkVELEU2RUUsQzZBRCxFNkVGLEM5QTcsRTZGMCxFNkYxLEU2RjIsRTVCOSxFNkYzLEU2RjQsQzJFMixFNkY1LEU2RjYsRDZFOCxFNkY3LEU2RjgsQjlDNyxGN0JCLEY3QkEsRjdCRSxGN0JDLEJBQTEsRjdCRixGN0MwLEY3QzIsRjdDMSxGN0M0LEY3QzMsRjdDNSxGN0M2LEY3QzcsQ0JFOCxCOERGLEY3RDQsRjdENSxGN0Q2LEY3RDgsRjdEQSxGN0Q3LEY3REIsRjdEOSxEN0Q3LEY3REMsRjdERCxGN0RFLEY3REYsRjdFMCxEQkNCLEQ4QUEsRTVGNyxCOUVELEJGRkQsQkJFQSxGN0M5LEM2QzcsRjdDOCxGN0NBLEY3Q0MsRjdDQixGN0NELENFQkEsRjdDRSxDNEE3LEQzRTMsRjZDRixDMkIzLEY2RDAsRjZEMSxGNkQyLEY2RDMsRjZENCxGNkQ2LEIxQUIsRjZENyxGNkQ4LEY2RDksRjZEQSxGNkRCLEY2REMsRjZERCxGNkRFLENGQ0EsRjZERixGNkUwLEY2RTEsRjZFMixGNkUzLEY2RTQsQzBGMCxGNkU1LEY2RTYsRjZFNyxGNkU4LEY2RTksRjZFQSxGNkVCLEY2RUMsRjZFRCxGNkVFLEY2RUYsRjZGMCxGNkYxLEY2RjIsRjZGMyxGNkY0LEJFQTgsRjZGNSxGNkY2LEY2RjcsRjZGOCxDOEZBLEY2RjksRjZGQSxGNkZCLEY2RkMsRjZGRCxGNkZFLEY3QTEsRjdBMixGN0EzLEY3QTQsRjdBNSxGN0E2LEY3QTcsRjdBOCxCMUVFLEY3QTksRjdBQSxGN0FCLEY3QUMsRjdBRCxDMURCLEY3QUUsRjdBRixDNEYxLEYwQUYsQkNBNixGMEIwLEMzRjksQzVCOCxEMUJCLEYwQjEsRjBCMixGMEIzLEYwQjQsRjBCNSxEMUJDLEQxRUMsRjBCNyxGMEI2LEQ0QTcsQ0REMixGMEI4LEYwQkEsRjBCOSxGMEJCLEYwQkMsQjhFQixGMEJELEJBRTgsRjBCRSxGMEJGLEJFRTksRjBDMCxCNkVDLEYwQzEsRjBDMixGMEMzLEYwQzQsQzhCNSxGMEM1LEYwQzYsRjBDNyxDNUY0LEYwQzgsRjBDOSxGMENBLEY3QkQsRjBDQixGMENDLEYwQ0QsRjBDRSxGMENGLEJBRDcsRjBEMCxGMEQxLEYwRDIsRjBEMyxGMEQ0LEYwRDUsRjBENixGMEQ4LEQzQTUsRjBENyxGMEQ5LEY1QkEsQzJCOSxGN0U0LEY3RTUsRjdFNixGN0U3LEY3RTgsQzJCNCxGN0VBLEY3RUIsQzJGMyxGNEYwLEY0RUYsQzJFOSxGN0UxLEY3RTIsQkJDNixEOUU0LENBRjIsQzBFOCxGMEE0LEJBREEsQzdBRCxDNEFDLEY3RUMsRjdFRCxGN0VFLEY3RjAsRjdFRixGN0YxLEY3RjQsRjdGMyxGN0YyLEY3RjUsRjdGNixFREU5LEVERUEsRURFQixGNkJDLEY2QkQsRjZCRSxCNkE2LEQ4QkUsQjlDNCxEOEJCLERDQjEsQ0FGMyxGN0Y3LEY3RjgsRjdGOSxGN0ZCLEY3RkEsQjFDNyxGN0ZDLEY3RkQsRjdGRSxDNkVCLEVDQjQsQjNERCxGNkIzLEY2QjQsQzFFNCxGNkI1LEY2QjYsRjZCNyxGNkI4LEY2QjksRjZCQSxDOEEzLEY2QkIsQzFGQSxCOUE4LEVERTgsQjlFQSxEOURGLEEzQTEsQTNBMixBM0EzLEExRTcsQTNBNSxBM0E2LEEzQTcsQTNBOCxBM0E5LEEzQUEsQTNBQixBM0FDLEEzQUQsQTNBRSxBM0FGLEEzQjAsQTNCMSxBM0IyLEEzQjMsQTNCNCxBM0I1LEEzQjYsQTNCNyxBM0I4LEEzQjksQTNCQSxBM0JCLEEzQkMsQTNCRCxBM0JFLEEzQkYsQTNDMCxBM0MxLEEzQzIsQTNDMyxBM0M0LEEzQzUsQTNDNixBM0M3LEEzQzgsQTNDOSxBM0NBLEEzQ0IsQTNDQyxBM0NELEEzQ0UsQTNDRixBM0QwLEEzRDEsQTNEMixBM0QzLEEzRDQsQTNENSxBM0Q2LEEzRDcsQTNEOCxBM0Q5LEEzREEsQTNEQixBM0RDLEEzREQsQTNERSxBM0RGLEEzRTAsQTNFMSxBM0UyLEEzRTMsQTNFNCxBM0U1LEEzRTYsQTNFNyxBM0U4LEEzRTksQTNFQSxBM0VCLEEzRUMsQTNFRCxBM0VFLEEzRUYsQTNGMCxBM0YxLEEzRjIsQTNGMyxBM0Y0LEEzRjUsQTNGNixBM0Y3LEEzRjgsQTNGOSxBM0ZBLEEzRkIsQTNGQyxBM0ZELEExQUIsQTFFOSxBMUVBLEEzRkUsQTNBNCc7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBVbmljb2RlQ2hyKCkgewogICAgICAgICAgICByZXR1cm4gJzAwQTQsMDBBNywwMEE4LDAwQjAsMDBCMSwwMEI3LDAwRDcsMDBFMCwwMEUxLDAwRTgsMDBFOSwwMEVBLDAwRUMsMDBFRCwwMEYyLDAwRjMsMDBGNywwMEY5LDAwRkEsMDBGQywwMTAxLDAxMTMsMDExQiwwMTJCLDAxNEQsMDE2QiwwMUNFLDAxRDAsMDFEMiwwMUQ0LDAxRDYsMDFEOCwwMURBLDAxREMsMDJDNywwMkM5LDAzOTEsMDM5MiwwMzkzLDAzOTQsMDM5NSwwMzk2LDAzOTcsMDM5OCwwMzk5LDAzOUEsMDM5QiwwMzlDLDAzOUQsMDM5RSwwMzlGLDAzQTAsMDNBMSwwM0EzLDAzQTQsMDNBNSwwM0E2LDAzQTcsMDNBOCwwM0E5LDAzQjEsMDNCMiwwM0IzLDAzQjQsMDNCNSwwM0I2LDAzQjcsMDNCOCwwM0I5LDAzQkEsMDNCQiwwM0JDLDAzQkQsMDNCRSwwM0JGLDAzQzAsMDNDMSwwM0MzLDAzQzQsMDNDNSwwM0M2LDAzQzcsMDNDOCwwM0M5LDA0MDEsMDQxMCwwNDExLDA0MTIsMDQxMywwNDE0LDA0MTUsMDQxNiwwNDE3LDA0MTgsMDQxOSwwNDFBLDA0MUIsMDQxQywwNDFELDA0MUUsMDQxRiwwNDIwLDA0MjEsMDQyMiwwNDIzLDA0MjQsMDQyNSwwNDI2LDA0MjcsMDQyOCwwNDI5LDA0MkEsMDQyQiwwNDJDLDA0MkQsMDQyRSwwNDJGLDA0MzAsMDQzMSwwNDMyLDA0MzMsMDQzNCwwNDM1LDA0MzYsMDQzNywwNDM4LDA0MzksMDQzQSwwNDNCLDA0M0MsMDQzRCwwNDNFLDA0M0YsMDQ0MCwwNDQxLDA0NDIsMDQ0MywwNDQ0LDA0NDUsMDQ0NiwwNDQ3LDA0NDgsMDQ0OSwwNDRBLDA0NEIsMDQ0QywwNDRELDA0NEUsMDQ0RiwwNDUxLDIwMTQsMjAxNiwyMDE4LDIwMTksMjAxQywyMDFELDIwMjYsMjAzMCwyMDMyLDIwMzMsMjAzQiwyMTAzLDIxMTYsMjE2MCwyMTYxLDIxNjIsMjE2MywyMTY0LDIxNjUsMjE2NiwyMTY3LDIxNjgsMjE2OSwyMTZBLDIxNkIsMjE5MCwyMTkxLDIxOTIsMjE5MywyMjA4LDIyMEYsMjIxMSwyMjFBLDIyMUQsMjIxRSwyMjIwLDIyMjUsMjIyNywyMjI4LDIyMjksMjIyQSwyMjJCLDIyMkUsMjIzNCwyMjM1LDIyMzYsMjIzNywyMjNELDIyNDgsMjI0QywyMjYwLDIyNjEsMjI2NCwyMjY1LDIyNkUsMjI2RiwyMjk5LDIyQTUsMjMxMiwyNDYwLDI0NjEsMjQ2MiwyNDYzLDI0NjQsMjQ2NSwyNDY2LDI0NjcsMjQ2OCwyNDY5LDI0NzQsMjQ3NSwyNDc2LDI0NzcsMjQ3OCwyNDc5LDI0N0EsMjQ3QiwyNDdDLDI0N0QsMjQ3RSwyNDdGLDI0ODAsMjQ4MSwyNDgyLDI0ODMsMjQ4NCwyNDg1LDI0ODYsMjQ4NywyNDg4LDI0ODksMjQ4QSwyNDhCLDI0OEMsMjQ4RCwyNDhFLDI0OEYsMjQ5MCwyNDkxLDI0OTIsMjQ5MywyNDk0LDI0OTUsMjQ5NiwyNDk3LDI0OTgsMjQ5OSwyNDlBLDI0OUIsMjUwMCwyNTAxLDI1MDIsMjUwMywyNTA0LDI1MDUsMjUwNiwyNTA3LDI1MDgsMjUwOSwyNTBBLDI1MEIsMjUwQywyNTBELDI1MEUsMjUwRiwyNTEwLDI1MTEsMjUxMiwyNTEzLDI1MTQsMjUxNSwyNTE2LDI1MTcsMjUxOCwyNTE5LDI1MUEsMjUxQiwyNTFDLDI1MUQsMjUxRSwyNTFGLDI1MjAsMjUyMSwyNTIyLDI1MjMsMjUyNCwyNTI1LDI1MjYsMjUyNywyNTI4LDI1MjksMjUyQSwyNTJCLDI1MkMsMjUyRCwyNTJFLDI1MkYsMjUzMCwyNTMxLDI1MzIsMjUzMywyNTM0LDI1MzUsMjUzNiwyNTM3LDI1MzgsMjUzOSwyNTNBLDI1M0IsMjUzQywyNTNELDI1M0UsMjUzRiwyNTQwLDI1NDEsMjU0MiwyNTQzLDI1NDQsMjU0NSwyNTQ2LDI1NDcsMjU0OCwyNTQ5LDI1NEEsMjU0QiwyNUEwLDI1QTEsMjVCMiwyNUIzLDI1QzYsMjVDNywyNUNCLDI1Q0UsMjVDRiwyNjA1LDI2MDYsMjY0MCwyNjQyLDMwMDAsMzAwMSwzMDAyLDMwMDMsMzAwNSwzMDA4LDMwMDksMzAwQSwzMDBCLDMwMEMsMzAwRCwzMDBFLDMwMEYsMzAxMCwzMDExLDMwMTMsMzAxNCwzMDE1LDMwMTYsMzAxNywzMDQxLDMwNDIsMzA0MywzMDQ0LDMwNDUsMzA0NiwzMDQ3LDMwNDgsMzA0OSwzMDRBLDMwNEIsMzA0QywzMDRELDMwNEUsMzA0RiwzMDUwLDMwNTEsMzA1MiwzMDUzLDMwNTQsMzA1NSwzMDU2LDMwNTcsMzA1OCwzMDU5LDMwNUEsMzA1QiwzMDVDLDMwNUQsMzA1RSwzMDVGLDMwNjAsMzA2MSwzMDYyLDMwNjMsMzA2NCwzMDY1LDMwNjYsMzA2NywzMDY4LDMwNjksMzA2QSwzMDZCLDMwNkMsMzA2RCwzMDZFLDMwNkYsMzA3MCwzMDcxLDMwNzIsMzA3MywzMDc0LDMwNzUsMzA3NiwzMDc3LDMwNzgsMzA3OSwzMDdBLDMwN0IsMzA3QywzMDdELDMwN0UsMzA3RiwzMDgwLDMwODEsMzA4MiwzMDgzLDMwODQsMzA4NSwzMDg2LDMwODcsMzA4OCwzMDg5LDMwOEEsMzA4QiwzMDhDLDMwOEQsMzA4RSwzMDhGLDMwOTAsMzA5MSwzMDkyLDMwOTMsMzBBMSwzMEEyLDMwQTMsMzBBNCwzMEE1LDMwQTYsMzBBNywzMEE4LDMwQTksMzBBQSwzMEFCLDMwQUMsMzBBRCwzMEFFLDMwQUYsMzBCMCwzMEIxLDMwQjIsMzBCMywzMEI0LDMwQjUsMzBCNiwzMEI3LDMwQjgsMzBCOSwzMEJBLDMwQkIsMzBCQywzMEJELDMwQkUsMzBCRiwzMEMwLDMwQzEsMzBDMiwzMEMzLDMwQzQsMzBDNSwzMEM2LDMwQzcsMzBDOCwzMEM5LDMwQ0EsMzBDQiwzMENDLDMwQ0QsMzBDRSwzMENGLDMwRDAsMzBEMSwzMEQyLDMwRDMsMzBENCwzMEQ1LDMwRDYsMzBENywzMEQ4LDMwRDksMzBEQSwzMERCLDMwREMsMzBERCwzMERFLDMwREYsMzBFMCwzMEUxLDMwRTIsMzBFMywzMEU0LDMwRTUsMzBFNiwzMEU3LDMwRTgsMzBFOSwzMEVBLDMwRUIsMzBFQywzMEVELDMwRUUsMzBFRiwzMEYwLDMwRjEsMzBGMiwzMEYzLDMwRjQsMzBGNSwzMEY2LDMxMDUsMzEwNiwzMTA3LDMxMDgsMzEwOSwzMTBBLDMxMEIsMzEwQywzMTBELDMxMEUsMzEwRiwzMTEwLDMxMTEsMzExMiwzMTEzLDMxMTQsMzExNSwzMTE2LDMxMTcsMzExOCwzMTE5LDMxMUEsMzExQiwzMTFDLDMxMUQsMzExRSwzMTFGLDMxMjAsMzEyMSwzMTIyLDMxMjMsMzEyNCwzMTI1LDMxMjYsMzEyNywzMTI4LDMxMjksMzIyMCwzMjIxLDMyMjIsMzIyMywzMjI0LDMyMjUsMzIyNiwzMjI3LDMyMjgsMzIyOSw0RTAwLDRFMDEsNEUwMyw0RTA3LDRFMDgsNEUwOSw0RTBBLDRFMEIsNEUwQyw0RTBELDRFMEUsNEUxMCw0RTExLDRFMTMsNEUxNCw0RTE1LDRFMTYsNEUxOCw0RTE5LDRFMUEsNEUxQiw0RTFDLDRFMUQsNEUxRSw0RTIyLDRFMjQsNEUyNSw0RTI3LDRFMjgsNEUyQSw0RTJCLDRFMkMsNEUyRCw0RTMwLDRFMzIsNEUzNCw0RTM2LDRFMzgsNEUzOSw0RTNBLDRFM0IsNEUzRCw0RTNFLDRFM0YsNEU0Myw0RTQ1LDRFNDcsNEU0OCw0RTQ5LDRFNEIsNEU0Qyw0RTRELDRFNEUsNEU0Riw0RTUwLDRFNTIsNEU1Myw0RTU0LDRFNTYsNEU1OCw0RTU5LDRFNUMsNEU1RCw0RTVFLDRFNUYsNEU2MCw0RTYxLDRFNjYsNEU2OSw0RTcwLDRFNzEsNEU3Myw0RTdFLDRFODYsNEU4OCw0RTg5LDRFOEIsNEU4Qyw0RThELDRFOEUsNEU4Riw0RTkxLDRFOTIsNEU5Myw0RTk0LDRFOTUsNEU5OCw0RTlBLDRFOUIsNEU5Riw0RUEwLDRFQTEsNEVBMiw0RUE0LDRFQTUsNEVBNiw0RUE3LDRFQTgsNEVBOSw0RUFCLDRFQUMsNEVBRCw0RUFFLDRFQjIsNEVCMyw0RUI1LDRFQkEsNEVCQiw0RUJGLDRFQzAsNEVDMSw0RUMyLDRFQzMsNEVDNCw0RUM1LDRFQzYsNEVDNyw0RUM5LDRFQ0EsNEVDQiw0RUNELDRFQ0UsNEVEMSw0RUQzLDRFRDQsNEVENSw0RUQ2LDRFRDcsNEVEOCw0RUQ5LDRFREQsNEVERSw0RURGLDRFRTEsNEVFMyw0RUU0LDRFRTUsNEVFOCw0RUVBLDRFRUIsNEVFQyw0RUYwLDRFRjIsNEVGMyw0RUY1LDRFRjYsNEVGNyw0RUZCLDRFRkQsNEVGRiw0RjAxLDRGMDksNEYwQSw0RjBELDRGMEUsNEYwRiw0RjEwLDRGMTEsNEYxNyw0RjE4LDRGMTksNEYxQSw0RjFCLDRGMUUsNEYxRiw0RjIwLDRGMjIsNEYyNCw0RjI1LDRGMjYsNEYyNyw0RjJBLDRGMkIsNEYyRiw0RjMwLDRGMzIsNEYzNCw0RjM2LDRGMzgsNEYzQSw0RjNDLDRGM0QsNEY0Myw0RjQ2LDRGNEQsNEY0RSw0RjRGLDRGNTAsNEY1MSw0RjUzLDRGNTUsNEY1Nyw0RjU4LDRGNTksNEY1QSw0RjVCLDRGNUMsNEY1RCw0RjVFLDRGNUYsNEY2MCw0RjYzLDRGNjQsNEY2NSw0RjY3LDRGNjksNEY2Qyw0RjZGLDRGNzAsNEY3Myw0Rjc0LDRGNzYsNEY3Qiw0RjdDLDRGN0UsNEY3Riw0RjgzLDRGODQsNEY4OCw0Rjg5LDRGOEIsNEY4RCw0RjhGLDRGOTEsNEY5NCw0Rjk3LDRGOUIsNEY5RCw0RkEwLDRGQTMsNEZBNSw0RkE2LDRGQTcsNEZBOCw0RkE5LDRGQUEsNEZBQyw0RkFFLDRGQUYsNEZCNSw0RkJGLDRGQzMsNEZDNCw0RkM1LDRGQ0EsNEZDRSw0RkNGLDRGRDAsNEZEMSw0RkQ3LDRGRDgsNEZEQSw0RkRDLDRGREQsNEZERSw0RkRGLDRGRTEsNEZFMyw0RkU2LDRGRTgsNEZFOSw0RkVBLDRGRUQsNEZFRSw0RkVGLDRGRjEsNEZGMyw0RkY4LDRGRkEsNEZGRSw1MDBDLDUwMEQsNTAwRiw1MDEyLDUwMTQsNTAxOCw1MDE5LDUwMUEsNTAxQyw1MDFGLDUwMjEsNTAyNSw1MDI2LDUwMjgsNTAyOSw1MDJBLDUwMkMsNTAyRCw1MDJFLDUwM0EsNTAzQyw1MDNFLDUwNDMsNTA0Nyw1MDQ4LDUwNEMsNTA0RSw1MDRGLDUwNTUsNTA1QSw1MDVDLDUwNjUsNTA2Qyw1MDc2LDUwNzcsNTA3Qiw1MDdFLDUwN0YsNTA4MCw1MDg1LDUwODgsNTA4RCw1MEEzLDUwQTUsNTBBNyw1MEE4LDUwQTksNTBBQyw1MEIyLDUwQkEsNTBCQiw1MENGLDUwRDYsNTBEQSw1MEU2LDUwRTcsNTBFQyw1MEVELDUwRUUsNTBGMyw1MEY1LDUwRkIsNTEwNiw1MTA3LDUxMEIsNTExMiw1MTIxLDUxM0YsNTE0MCw1MTQxLDUxNDMsNTE0NCw1MTQ1LDUxNDYsNTE0OCw1MTQ5LDUxNEIsNTE0RCw1MTUxLDUxNTQsNTE1NSw1MTU2LDUxNUEsNTE1Qyw1MTYyLDUxNjUsNTE2OCw1MTZCLDUxNkMsNTE2RCw1MTZFLDUxNzAsNTE3MSw1MTczLDUxNzQsNTE3NSw1MTc2LDUxNzcsNTE3OCw1MTc5LDUxN0IsNTE3Qyw1MTdELDUxODAsNTE4MSw1MTgyLDUxODUsNTE4OCw1MTg5LDUxOEMsNTE4RCw1MTkyLDUxOTUsNTE5Niw1MTk3LDUxOTksNTE5Qiw1MTlDLDUxQTAsNTFBMiw1MUE0LDUxQTUsNTFBQiw1MUFDLDUxQUYsNTFCMCw1MUIxLDUxQjIsNTFCMyw1MUI1LDUxQjYsNTFCNyw1MUJCLDUxQkMsNTFCRCw1MUMwLDUxQzQsNTFDNiw1MUM3LDUxQzksNTFDQiw1MUNDLDUxQ0YsNTFEMSw1MURCLDUxREQsNTFFMCw1MUUxLDUxRTQsNTFFQiw1MUVELDUxRUYsNTFGMCw1MUYzLDUxRjUsNTFGNiw1MUY4LDUxRjksNTFGQSw1MUZCLDUxRkMsNTFGRCw1MUZGLDUyMDAsNTIwMSw1MjAyLDUyMDMsNTIwNiw1MjA3LDUyMDgsNTIwQSw1MjBELDUyMEUsNTIxMSw1MjEyLDUyMTYsNTIxNyw1MjE4LDUyMTksNTIxQSw1MjFCLDUyMUQsNTIyMCw1MjI0LDUyMjgsNTIyOSw1MjJCLDUyMkQsNTIyRSw1MjMwLDUyMzMsNTIzNiw1MjM3LDUyMzgsNTIzOSw1MjNBLDUyM0IsNTIzRCw1MjNGLDUyNDAsNTI0MSw1MjQyLDUyNDMsNTI0QSw1MjRDLDUyNEQsNTI1MCw1MjUxLDUyNTQsNTI1Niw1MjVDLDUyNUUsNTI2MSw1MjY1LDUyNjcsNTI2OSw1MjZBLDUyNkYsNTI3Miw1MjdELDUyN0YsNTI4MSw1MjgyLDUyODgsNTI5MCw1MjkzLDUyOUIsNTI5RCw1MjlFLDUyOUYsNTJBMCw1MkExLDUyQTIsNTJBMyw1MkE4LDUyQTksNTJBQSw1MkFCLDUyQUMsNTJBRCw1MkIxLDUyQjIsNTJCMyw1MkJFLDUyQkYsNTJDMyw1MkM3LDUyQzksNTJDQiw1MkQwLDUyRDIsNTJENiw1MkQ4LDUyREYsNTJFNCw1MkYwLDUyRjksNTJGQSw1MkZFLDUyRkYsNTMwMCw1MzA1LDUzMDYsNTMwOCw1MzBELDUzMEYsNTMxMCw1MzE1LDUzMTYsNTMxNyw1MzE5LDUzMUEsNTMxRCw1MzIwLDUzMjEsNTMyMyw1MzI2LDUzMkEsNTMyRSw1MzM5LDUzM0EsNTMzQiw1MzNFLDUzM0YsNTM0MSw1MzQzLDUzNDUsNTM0Nyw1MzQ4LDUzNDksNTM0QSw1MzRFLDUzNEYsNTM1MSw1MzUyLDUzNTMsNTM1NSw1MzU2LDUzNTcsNTM1QSw1MzVDLDUzNUUsNTM1Riw1MzYwLDUzNjEsNTM2Miw1MzYzLDUzNjQsNTM2Niw1MzY3LDUzNjksNTM2Qiw1MzZFLDUzNkYsNTM3MCw1MzcxLDUzNzMsNTM3NCw1Mzc1LDUzNzcsNTM3OCw1MzdBLDUzN0YsNTM4Miw1Mzg0LDUzODUsNTM4Niw1Mzg5LDUzOEIsNTM4Qyw1MzhELDUzOTUsNTM5OCw1MzlBLDUzOUQsNTM5Riw1M0EyLDUzQTMsNTNBNSw1M0E2LDUzQTgsNTNBOSw1M0FFLDUzQjYsNTNCQiw1M0JGLDUzQzEsNTNDMiw1M0M4LDUzQzksNTNDQSw1M0NCLDUzQ0MsNTNDRCw1M0QxLDUzRDQsNTNENiw1M0Q3LDUzRDgsNTNEOSw1M0RCLDUzREYsNTNFMCw1M0UzLDUzRTQsNTNFNSw1M0U2LDUzRTgsNTNFOSw1M0VBLDUzRUIsNTNFQyw1M0VELDUzRUUsNTNFRiw1M0YwLDUzRjEsNTNGMiw1M0YzLDUzRjUsNTNGNiw1M0Y3LDUzRjgsNTNGOSw1M0ZCLDUzRkMsNTNGRCw1NDAxLDU0MDMsNTQwNCw1NDA2LDU0MDgsNTQwOSw1NDBBLDU0MEMsNTQwRCw1NDBFLDU0MEYsNTQxMCw1NDExLDU0MTIsNTQxMyw1NDE1LDU0MTYsNTQxNyw1NDFCLDU0MUQsNTQxRSw1NDFGLDU0MjAsNTQyMSw1NDIzLDU0MjYsNTQyNyw1NDI4LDU0MjksNTQyQiw1NDJDLDU0MkQsNTQyRSw1NDJGLDU0MzEsNTQzMiw1NDM0LDU0MzUsNTQzOCw1NDM5LDU0M0IsNTQzQyw1NDNFLDU0NDAsNTQ0Myw1NDQ2LDU0NDgsNTQ0QSw1NDRCLDU0NTAsNTQ1Miw1NDUzLDU0NTQsNTQ1NSw1NDU2LDU0NTcsNTQ1OCw1NDU5LDU0NUIsNTQ1Qyw1NDYyLDU0NjQsNTQ2Niw1NDY4LDU0NzEsNTQ3Miw1NDczLDU0NzUsNTQ3Niw1NDc3LDU0NzgsNTQ3Qiw1NDdDLDU0N0QsNTQ4MCw1NDgyLDU0ODQsNTQ4Niw1NDhCLDU0OEMsNTQ4RSw1NDhGLDU0OTAsNTQ5Miw1NDk0LDU0OTUsNTQ5Niw1NDk5LDU0OUEsNTQ5Qiw1NDlELDU0QTMsNTRBNCw1NEE2LDU0QTcsNTRBOCw1NEE5LDU0QUEsNTRBQiw1NEFDLDU0QUQsNTRBRiw1NEIxLDU0QjMsNTRCNCw1NEI4LDU0QkIsNTRCRCw1NEJGLDU0QzAsNTRDMSw1NEMyLDU0QzQsNTRDNiw1NEM3LDU0QzgsNTRDOSw1NENDLDU0Q0QsNTRDRSw1NENGLDU0RDAsNTREMSw1NEQyLDU0RDMsNTRENCw1NEQ1LDU0RDcsNTREOSw1NERBLDU0REMsNTRERCw1NERFLDU0REYsNTRFNSw1NEU2LDU0RTcsNTRFOCw1NEU5LDU0RUEsNTRFRCw1NEVFLDU0RjIsNTRGMyw1NEZBLDU0RkMsNTRGRCw1NEZGLDU1MDEsNTUwNiw1NTA3LDU1MDksNTUwRiw1NTEwLDU1MTEsNTUxNCw1NTFCLDU1MjAsNTUyMiw1NTIzLDU1MjQsNTUyNyw1NTJBLDU1MkMsNTUyRSw1NTJGLDU1MzAsNTUzMSw1NTMzLDU1MzcsNTUzQyw1NTNFLDU1M0YsNTU0MSw1NTQzLDU1NDQsNTU0Niw1NTQ5LDU1NEEsNTU1MCw1NTU1LDU1NTYsNTU1Qyw1NTYxLDU1NjQsNTU2NSw1NTY2LDU1NjcsNTU2QSw1NTZDLDU1NkQsNTU2RSw1NTc1LDU1NzYsNTU3Nyw1NTc4LDU1N0IsNTU3Qyw1NTdFLDU1ODAsNTU4MSw1NTgyLDU1ODMsNTU4NCw1NTg3LDU1ODgsNTU4OSw1NThBLDU1OEIsNTU4Riw1NTkxLDU1OTQsNTU5OCw1NTk5LDU1OUMsNTU5RCw1NTlGLDU1QTcsNTVCMSw1NUIzLDU1QjUsNTVCNyw1NUI5LDU1QkIsNTVCRCw1NUJFLDU1QzQsNTVDNSw1NUM5LDU1Q0MsNTVDRCw1NUQxLDU1RDIsNTVEMyw1NUQ0LDU1RDYsNTVEQyw1NURELDU1REYsNTVFMSw1NUUzLDU1RTQsNTVFNSw1NUU2LDU1RTgsNTVFQSw1NUVCLDU1RUMsNTVFRiw1NUYyLDU1RjMsNTVGNSw1NUY3LDU1RkQsNTVGRSw1NjAwLDU2MDEsNTYwOCw1NjA5LDU2MEMsNTYwRSw1NjBGLDU2MTgsNTYxQiw1NjFFLDU2MUYsNTYyMyw1NjI0LDU2MjcsNTYyQyw1NjJELDU2MzEsNTYzMiw1NjM0LDU2MzYsNTYzOSw1NjNCLDU2M0YsNTY0Qyw1NjRELDU2NEUsNTY1NCw1NjU3LDU2NTgsNTY1OSw1NjVDLDU2NjIsNTY2NCw1NjY4LDU2NjksNTY2QSw1NjZCLDU2NkMsNTY3MSw1Njc2LDU2N0IsNTY3Qyw1Njg1LDU2ODYsNTY4RSw1NjhGLDU2OTMsNTZBMyw1NkFGLDU2QjcsNTZCQyw1NkNBLDU2RDQsNTZENyw1NkRBLDU2REIsNTZERCw1NkRFLDU2REYsNTZFMCw1NkUxLDU2RTIsNTZFNCw1NkVCLDU2RUQsNTZGMCw1NkYxLDU2RjQsNTZGNSw1NkY5LDU2RkEsNTZGRCw1NkZFLDU2RkYsNTcwMyw1NzA0LDU3MDYsNTcwOCw1NzA5LDU3MEEsNTcxQyw1NzFGLDU3MjMsNTcyOCw1NzI5LDU3MkEsNTcyQyw1NzJELDU3MkUsNTcyRiw1NzMwLDU3MzMsNTczOSw1NzNBLDU3M0IsNTczRSw1NzQwLDU3NDIsNTc0Nyw1NzRBLDU3NEMsNTc0RCw1NzRFLDU3NEYsNTc1MCw1NzUxLDU3NTcsNTc1QSw1NzVCLDU3NUMsNTc1RCw1NzVFLDU3NUYsNTc2MCw1NzYxLDU3NjQsNTc2Niw1NzY4LDU3NjksNTc2QSw1NzZCLDU3NkQsNTc2Riw1NzczLDU3NzYsNTc3Nyw1NzdCLDU3N0MsNTc4Miw1NzgzLDU3ODQsNTc4NSw1Nzg2LDU3OEIsNTc4Qyw1NzkyLDU3OTMsNTc5Qiw1N0EwLDU3QTEsNTdBMiw1N0EzLDU3QTQsNTdBNiw1N0E3LDU3QTksNTdBQiw1N0FELDU3QUUsNTdCMiw1N0I0LDU3QjgsNTdDMiw1N0MzLDU3Q0IsNTdDRSw1N0NGLDU3RDIsNTdENCw1N0Q1LDU3RDgsNTdEOSw1N0RBLDU3REQsNTdERiw1N0UwLDU3RTQsNTdFRCw1N0VGLDU3RjQsNTdGOCw1N0Y5LDU3RkEsNTdGRCw1ODAwLDU4MDIsNTgwNiw1ODA3LDU4MEIsNTgwRCw1ODExLDU4MTUsNTgxOSw1ODFFLDU4MjAsNTgyMSw1ODI0LDU4MkEsNTgzMCw1ODM1LDU4NDQsNTg0Qyw1ODRELDU4NTEsNTg1NCw1ODU4LDU4NUUsNTg2NSw1ODZCLDU4NkMsNTg3RSw1ODgwLDU4ODEsNTg4Myw1ODg1LDU4ODksNTg5Miw1ODkzLDU4OTksNTg5QSw1ODlFLDU4OUYsNThBOCw1OEE5LDU4QkMsNThDMSw1OEM1LDU4RDEsNThENSw1OEU0LDU4RUIsNThFQyw1OEVFLDU4RjAsNThGMyw1OEY2LDU4RjksNTkwMiw1OTA0LDU5MDcsNTkwRCw1OTBGLDU5MTQsNTkxNSw1OTE2LDU5MTksNTkxQSw1OTFDLDU5MUYsNTkyNCw1OTI1LDU5MjcsNTkyOSw1OTJBLDU5MkIsNTkyRCw1OTJFLDU5MkYsNTkzMSw1OTM0LDU5MzcsNTkzOCw1OTM5LDU5M0EsNTkzQyw1OTQxLDU5NDIsNTk0NCw1OTQ3LDU5NDgsNTk0OSw1OTRCLDU5NEUsNTk0Riw1OTUxLDU5NTQsNTk1NSw1OTU2LDU5NTcsNTk1OCw1OTVBLDU5NjAsNTk2Miw1OTY1LDU5NzMsNTk3NCw1OTc2LDU5NzgsNTk3OSw1OTdELDU5ODEsNTk4Miw1OTgzLDU5ODQsNTk4Niw1OTg3LDU5ODgsNTk4QSw1OThELDU5OTIsNTk5Myw1OTk2LDU5OTcsNTk5OSw1OTlFLDU5QTMsNTlBNCw1OUE1LDU5QTgsNTlBOSw1OUFBLDU5QUIsNTlBRSw1OUFGLDU5QjIsNTlCOSw1OUJCLDU5QkUsNTlDNiw1OUNBLDU5Q0IsNTlEMCw1OUQxLDU5RDIsNTlEMyw1OUQ0LDU5RDcsNTlEOCw1OURBLDU5REMsNTlERCw1OUUzLDU5RTUsNTlFOCw1OUVDLDU5RjksNTlGQiw1OUZGLDVBMDEsNUEwMyw1QTA0LDVBMDUsNUEwNiw1QTA3LDVBMDgsNUEwOSw1QTBDLDVBMTEsNUExMyw1QTE4LDVBMUMsNUExRiw1QTIwLDVBMjMsNUEyNSw1QTI5LDVBMzEsNUEzMiw1QTM0LDVBMzYsNUEzQyw1QTQwLDVBNDYsNUE0OSw1QTRBLDVBNTUsNUE1QSw1QTYyLDVBNjcsNUE2QSw1QTc0LDVBNzUsNUE3Niw1QTc3LDVBN0EsNUE3Riw1QTkyLDVBOUEsNUE5Qiw1QUFBLDVBQjIsNUFCMyw1QUI1LDVBQjgsNUFCRSw1QUMxLDVBQzIsNUFDOSw1QUNDLDVBRDIsNUFENCw1QUQ2LDVBRDgsNUFEQyw1QUUwLDVBRTEsNUFFMyw1QUU2LDVBRTksNUFFQiw1QUYxLDVCMDksNUIxNiw1QjE3LDVCMzIsNUIzNCw1QjM3LDVCNDAsNUI1MCw1QjUxLDVCNTMsNUI1NCw1QjU1LDVCNTcsNUI1OCw1QjU5LDVCNUEsNUI1Qiw1QjVDLDVCNUQsNUI1Riw1QjYyLDVCNjMsNUI2NCw1QjY1LDVCNjYsNUI2OSw1QjZBLDVCNkMsNUI3MCw1QjcxLDVCNzMsNUI3NSw1QjdBLDVCN0QsNUI4MCw1QjgxLDVCODMsNUI4NCw1Qjg1LDVCODcsNUI4OCw1Qjg5LDVCOEIsNUI4Qyw1QjhGLDVCOTMsNUI5NSw1Qjk3LDVCOTgsNUI5OSw1QjlBLDVCOUIsNUI5Qyw1QjlELDVCOUUsNUJBMCw1QkExLDVCQTIsNUJBMyw1QkE0LDVCQTUsNUJBNiw1QkFBLDVCQUIsNUJCMCw1QkIzLDVCQjQsNUJCNSw1QkI2LDVCQjgsNUJCOSw1QkJELDVCQkUsNUJCRiw1QkMyLDVCQzQsNUJDNSw1QkM2LDVCQzcsNUJDQyw1QkQwLDVCRDIsNUJEMyw1QkRELDVCREUsNUJERiw1QkUxLDVCRTQsNUJFNSw1QkU4LDVCRUUsNUJGMCw1QkY4LDVCRjksNUJGQSw1QkZCLDVCRkMsNUJGRiw1QzAxLDVDMDQsNUMwNiw1QzA5LDVDMEEsNUMwRiw1QzExLDVDMTQsNUMxNSw1QzE2LDVDMTgsNUMxQSw1QzFDLDVDMUQsNUMyMiw1QzI0LDVDMjUsNUMyNyw1QzJDLDVDMzEsNUMzNCw1QzM4LDVDMzksNUMzQSw1QzNCLDVDM0MsNUMzRCw1QzNFLDVDM0YsNUM0MCw1QzQxLDVDNDIsNUM0NSw1QzQ4LDVDNDksNUM0QSw1QzRCLDVDNEUsNUM0Riw1QzUwLDVDNTEsNUM1NSw1QzU5LDVDNUUsNUM2MCw1QzYxLDVDNjMsNUM2NSw1QzY2LDVDNkUsNUM2Riw1QzcxLDVDNzksNUM3QSw1QzdGLDVDODEsNUM4Miw1Qzg4LDVDOEMsNUM4RCw1QzkwLDVDOTEsNUM5NCw1Qzk2LDVDOTcsNUM5OCw1Qzk5LDVDOUEsNUM5Qiw1QzlDLDVDQTIsNUNBMyw1Q0E5LDVDQUIsNUNBQyw1Q0FELDVDQjEsNUNCMyw1Q0I1LDVDQjcsNUNCOCw1Q0JELDVDQkYsNUNDMSw1Q0M0LDVDQ0IsNUNEMiw1Q0Q5LDVDRTEsNUNFNCw1Q0U1LDVDRTYsNUNFOCw1Q0VBLDVDRUQsNUNGMCw1Q0ZCLDVEMDIsNUQwMyw1RDA2LDVEMDcsNUQwRSw1RDE0LDVEMTYsNUQxQiw1RDFFLDVEMjQsNUQyNiw1RDI3LDVEMjksNUQyRCw1RDJFLDVEMzQsNUQzRCw1RDNFLDVENDcsNUQ0QSw1RDRCLDVENEMsNUQ1OCw1RDVCLDVENUQsNUQ2OSw1RDZCLDVENkMsNUQ2Riw1RDc0LDVEODIsNUQ5OSw1RDlELDVEQjcsNURDNSw1RENELDVEREIsNURERCw1RERFLDVERTEsNURFMiw1REU1LDVERTYsNURFNyw1REU4LDVERTksNURFQiw1REVFLDVERUYsNURGMSw1REYyLDVERjMsNURGNCw1REY3LDVERkQsNURGRSw1RTAxLDVFMDIsNUUwMyw1RTA1LDVFMDYsNUUwOCw1RTBDLDVFMEYsNUUxMCw1RTExLDVFMTQsNUUxNSw1RTE2LDVFMTgsNUUxOSw1RTFBLDVFMUIsNUUxQyw1RTFELDVFMjYsNUUyNyw1RTJELDVFMkUsNUUzMSw1RTM3LDVFMzgsNUUzQiw1RTNDLDVFM0QsNUU0Miw1RTQ0LDVFNDUsNUU0Qyw1RTU0LDVFNTUsNUU1Qiw1RTVFLDVFNjEsNUU2Miw1RTcyLDVFNzMsNUU3NCw1RTc2LDVFNzgsNUU3QSw1RTdCLDVFN0MsNUU3RCw1RTdGLDVFODAsNUU4NCw1RTg2LDVFODcsNUU4QSw1RThCLDVFOEYsNUU5MCw1RTkxLDVFOTMsNUU5NCw1RTk1LDVFOTYsNUU5Nyw1RTk5LDVFOUEsNUU5Qyw1RTlFLDVFOUYsNUVBMCw1RUE1LDVFQTYsNUVBNyw1RUFELDVFQjMsNUVCNSw1RUI2LDVFQjcsNUVCOCw1RUI5LDVFQkUsNUVDOSw1RUNBLDVFRDEsNUVEMiw1RUQzLDVFRDYsNUVEQiw1RUU4LDVFRUEsNUVGNCw1RUY2LDVFRjcsNUVGQSw1RUZFLDVFRkYsNUYwMCw1RjAxLDVGMDIsNUYwMyw1RjA0LDVGMDgsNUYwQSw1RjBCLDVGMEYsNUYxMSw1RjEzLDVGMTUsNUYxNyw1RjE4LDVGMUIsNUYxRiw1RjIwLDVGMjUsNUYyNiw1RjI3LDVGMjksNUYyQSw1RjJELDVGMkYsNUYzMSw1RjM5LDVGM0EsNUYzQyw1RjQwLDVGNTAsNUY1Miw1RjUzLDVGNTUsNUY1Niw1RjU3LDVGNTgsNUY1RCw1RjYxLDVGNjIsNUY2NCw1RjY2LDVGNjksNUY2QSw1RjZDLDVGNkQsNUY3MCw1RjcxLDVGNzMsNUY3Nyw1Rjc5LDVGN0IsNUY3Qyw1RjgwLDVGODEsNUY4Miw1Rjg0LDVGODUsNUY4Nyw1Rjg4LDVGODksNUY4QSw1RjhCLDVGOEMsNUY5MCw1RjkyLDVGOTUsNUY5Nyw1Rjk4LDVGOTksNUY5Qyw1RkExLDVGQTgsNUZBQSw1RkFELDVGQUUsNUZCNSw1RkI3LDVGQkMsNUZCRCw1RkMzLDVGQzQsNUZDNSw1RkM2LDVGQzksNUZDQyw1RkNELDVGQ0YsNUZEMCw1RkQxLDVGRDIsNUZENiw1RkQ3LDVGRDgsNUZEOSw1RkRELDVGRTAsNUZFMSw1RkU0LDVGRTcsNUZFQSw1RkVCLDVGRUQsNUZFRSw1RkYxLDVGRjUsNUZGOCw1RkZCLDVGRkQsNUZGRSw1RkZGLDYwMDAsNjAwMSw2MDAyLDYwMDMsNjAwNCw2MDA1LDYwMDYsNjAwQSw2MDBELDYwMEUsNjAwRiw2MDEyLDYwMTQsNjAxNSw2MDE2LDYwMTksNjAxQiw2MDFDLDYwMUQsNjAyMCw2MDIxLDYwMjUsNjAyNiw2MDI3LDYwMjgsNjAyOSw2MDJBLDYwMkIsNjAyRiw2MDM1LDYwM0IsNjAzQyw2MDNGLDYwNDEsNjA0Miw2MDQzLDYwNEIsNjA0RCw2MDUwLDYwNTIsNjA1NSw2MDU5LDYwNUEsNjA1RCw2MDYyLDYwNjMsNjA2NCw2MDY3LDYwNjgsNjA2OSw2MDZBLDYwNkIsNjA2Qyw2MDZELDYwNkYsNjA3MCw2MDczLDYwNzYsNjA3OCw2MDc5LDYwN0EsNjA3Qiw2MDdDLDYwN0QsNjA3Riw2MDgzLDYwODQsNjA4OSw2MDhDLDYwOEQsNjA5Miw2MDk0LDYwOTYsNjA5QSw2MDlCLDYwOUQsNjA5Riw2MEEwLDYwQTMsNjBBNiw2MEE4LDYwQUIsNjBBQyw2MEFELDYwQUYsNjBCMSw2MEIyLDYwQjQsNjBCOCw2MEJCLDYwQkMsNjBDNSw2MEM2LDYwQ0EsNjBDQiw2MEQxLDYwRDUsNjBEOCw2MERBLDYwREMsNjBERCw2MERGLDYwRTAsNjBFNiw2MEU3LDYwRTgsNjBFOSw2MEVCLDYwRUMsNjBFRCw2MEVFLDYwRUYsNjBGMCw2MEYzLDYwRjQsNjBGNiw2MEY5LDYwRkEsNjEwMCw2MTAxLDYxMDYsNjEwOCw2MTA5LDYxMEQsNjEwRSw2MTBGLDYxMTUsNjExQSw2MTFGLDYxMjAsNjEyMyw2MTI0LDYxMjYsNjEyNyw2MTJCLDYxM0YsNjE0OCw2MTRBLDYxNEMsNjE0RSw2MTUxLDYxNTUsNjE1RCw2MTYyLDYxNjcsNjE2OCw2MTcwLDYxNzUsNjE3Nyw2MThCLDYxOEUsNjE5NCw2MTlELDYxQTcsNjFBOCw2MUE5LDYxQUMsNjFCNyw2MUJFLDYxQzIsNjFDOCw2MUNBLDYxQ0IsNjFEMSw2MUQyLDYxRDQsNjFFNiw2MUY1LDYxRkYsNjIwNiw2MjA4LDYyMEEsNjIwQiw2MjBDLDYyMEQsNjIwRSw2MjBGLDYyMTAsNjIxMSw2MjEyLDYyMTUsNjIxNiw2MjE3LDYyMTgsNjIxQSw2MjFCLDYyMUYsNjIyMSw2MjIyLDYyMjQsNjIyNSw2MjJBLDYyMkMsNjIyRSw2MjMzLDYyMzQsNjIzNyw2MjNELDYyM0UsNjIzRiw2MjQwLDYyNDEsNjI0Myw2MjQ3LDYyNDgsNjI0OSw2MjRCLDYyNEMsNjI0RCw2MjRFLDYyNTEsNjI1Miw2MjUzLDYyNTQsNjI1OCw2MjVCLDYyNjMsNjI2Niw2MjY3LDYyNjksNjI2QSw2MjZCLDYyNkMsNjI2RCw2MjZFLDYyNkYsNjI3MCw2MjczLDYyNzYsNjI3OSw2MjdDLDYyN0UsNjI3Riw2MjgwLDYyODQsNjI4OSw2MjhBLDYyOTEsNjI5Miw2MjkzLDYyOTUsNjI5Niw2Mjk3LDYyOTgsNjI5QSw2MjlCLDYyOUYsNjJBMCw2MkExLDYyQTIsNjJBNCw2MkE1LDYyQTgsNjJBQiw2MkFDLDYyQjEsNjJCNSw2MkI5LDYyQkIsNjJCQyw2MkJELDYyQkYsNjJDMiw2MkM0LDYyQzUsNjJDNiw2MkM3LDYyQzgsNjJDOSw2MkNBLDYyQ0MsNjJDRCw2MkNFLDYyRDAsNjJEMiw2MkQzLDYyRDQsNjJENiw2MkQ3LDYyRDgsNjJEOSw2MkRBLDYyREIsNjJEQyw2MkRGLDYyRTIsNjJFMyw2MkU1LDYyRTYsNjJFNyw2MkU4LDYyRTksNjJFQyw2MkVELDYyRUUsNjJFRiw2MkYxLDYyRjMsNjJGNCw2MkY2LDYyRjcsNjJGQyw2MkZELDYyRkUsNjJGRiw2MzAxLDYzMDIsNjMwNyw2MzA4LDYzMDksNjMwRSw2MzExLDYzMTYsNjMxQSw2MzFCLDYzMUQsNjMxRSw2MzFGLDYzMjAsNjMyMSw2MzIyLDYzMjMsNjMyNCw2MzI1LDYzMjgsNjMyQSw2MzJCLDYzMkYsNjMzMiw2MzM5LDYzM0EsNjMzRCw2MzQyLDYzNDMsNjM0NSw2MzQ2LDYzNDksNjM0Qiw2MzRDLDYzNEQsNjM0RSw2MzRGLDYzNTAsNjM1NSw2MzVFLDYzNUYsNjM2MSw2MzYyLDYzNjMsNjM2Nyw2MzY5LDYzNkQsNjM2RSw2MzcxLDYzNzYsNjM3Nyw2MzdBLDYzN0IsNjM4MCw2MzgyLDYzODcsNjM4OCw2Mzg5LDYzOEEsNjM4Qyw2MzhFLDYzOEYsNjM5MCw2MzkyLDYzOTYsNjM5OCw2M0EwLDYzQTIsNjNBMyw2M0E1LDYzQTcsNjNBOCw2M0E5LDYzQUEsNjNBQyw2M0FELDYzQUUsNjNCMCw2M0IzLDYzQjQsNjNCNyw2M0I4LDYzQkEsNjNCQyw2M0JFLDYzQzQsNjNDNiw2M0M5LDYzQ0QsNjNDRSw2M0NGLDYzRDAsNjNEMiw2M0Q2LDYzREUsNjNFMCw2M0UxLDYzRTMsNjNFOSw2M0VBLDYzRUQsNjNGMiw2M0Y0LDYzRjYsNjNGOCw2M0ZELDYzRkYsNjQwMCw2NDAxLDY0MDIsNjQwNSw2NDBCLDY0MEMsNjQwRiw2NDEwLDY0MTMsNjQxNCw2NDFCLDY0MUMsNjQxRSw2NDIwLDY0MjEsNjQyNiw2NDJBLDY0MkMsNjQyRCw2NDM0LDY0M0EsNjQzRCw2NDNGLDY0NDEsNjQ0NCw2NDQ1LDY0NDYsNjQ0Nyw2NDQ4LDY0NEEsNjQ1Miw2NDU0LDY0NTgsNjQ1RSw2NDY3LDY0NjksNjQ2RCw2NDc4LDY0NzksNjQ3QSw2NDgyLDY0ODQsNjQ4NSw2NDg3LDY0OTEsNjQ5Miw2NDk1LDY0OTYsNjQ5OSw2NDlFLDY0QTQsNjRBOSw2NEFDLDY0QUQsNjRBRSw2NEIwLDY0QjUsNjRCNyw2NEI4LDY0QkEsNjRCQyw2NEMwLDY0QzIsNjRDNSw2NENELDY0Q0UsNjREMCw2NEQyLDY0RDcsNjREOCw2NERFLDY0RTIsNjRFNCw2NEU2LDY1MDAsNjUwOSw2NTEyLDY1MTgsNjUyNSw2NTJCLDY1MkUsNjUyRiw2NTM0LDY1MzUsNjUzNiw2NTM4LDY1MzksNjUzQiw2NTNFLDY1M0YsNjU0NSw2NTQ4LDY1NDksNjU0Qyw2NTRGLDY1NTEsNjU1NSw2NTU2LDY1NTksNjU1Qiw2NTVELDY1NUUsNjU2Miw2NTYzLDY1NjYsNjU2Qiw2NTZDLDY1NzAsNjU3Miw2NTc0LDY1NzcsNjU4Nyw2NThCLDY1OEMsNjU5MCw2NTkxLDY1OTMsNjU5Nyw2NTk5LDY1OUIsNjU5Qyw2NTlGLDY1QTEsNjVBNCw2NUE1LDY1QTcsNjVBOSw2NUFCLDY1QUQsNjVBRiw2NUIwLDY1QjksNjVCQyw2NUJELDY1QzEsNjVDMyw2NUM0LDY1QzUsNjVDNiw2NUNCLDY1Q0MsNjVDRSw2NUNGLDY1RDIsNjVENiw2NUQ3LDY1RTAsNjVFMiw2NUU1LDY1RTYsNjVFNyw2NUU4LDY1RTksNjVFQyw2NUVELDY1RUUsNjVFRiw2NUYwLDY1RjEsNjVGNiw2NUY3LDY1RkEsNjYwMCw2NjAyLDY2MDMsNjYwNiw2NjBBLDY2MEMsNjYwRSw2NjBGLDY2MTMsNjYxNCw2NjE1LDY2MTksNjYxRCw2NjFGLDY2MjAsNjYyNSw2NjI3LDY2MjgsNjYyRCw2NjJGLDY2MzEsNjYzNCw2NjM1LDY2MzYsNjYzQyw2NjNFLDY2NDEsNjY0Myw2NjRCLDY2NEMsNjY0Riw2NjUyLDY2NTMsNjY1NCw2NjU1LDY2NTYsNjY1Nyw2NjVBLDY2NUYsNjY2MSw2NjY0LDY2NjYsNjY2OCw2NjZFLDY2NkYsNjY3MCw2Njc0LDY2NzYsNjY3Nyw2NjdBLDY2N0UsNjY4Miw2Njg0LDY2ODcsNjY4Qyw2NjkxLDY2OTYsNjY5Nyw2NjlELDY2QTcsNjZBOCw2NkFFLDY2QjQsNjZCOSw2NkJFLDY2RDksNjZEQiw2NkRDLDY2REQsNjZFNiw2NkU5LDY2RjAsNjZGMiw2NkYzLDY2RjQsNjZGNyw2NkY5LDY2RkMsNjZGRSw2NkZGLDY3MDAsNjcwOCw2NzA5LDY3MEEsNjcwQiw2NzBELDY3MTAsNjcxNCw2NzE1LDY3MTcsNjcxQiw2NzFELDY3MUYsNjcyNiw2NzI4LDY3MkEsNjcyQiw2NzJDLDY3MkQsNjcyRiw2NzMxLDY3MzQsNjczNSw2NzNBLDY3M0QsNjc0MCw2NzQyLDY3NDMsNjc0Niw2NzQ4LDY3NDksNjc0Qyw2NzRFLDY3NEYsNjc1MCw2NzUxLDY3NTMsNjc1Niw2NzVDLDY3NUUsNjc1Riw2NzYwLDY3NjEsNjc2NSw2NzY4LDY3NjksNjc2QSw2NzZELDY3NkYsNjc3MCw2NzcyLDY3NzMsNjc3NSw2Nzc3LDY3N0MsNjc3RSw2NzdGLDY3ODEsNjc4NCw2Nzg3LDY3ODksNjc4Qiw2NzkwLDY3OTUsNjc5Nyw2Nzk4LDY3OUEsNjc5Qyw2NzlELDY3OUUsNjdBMiw2N0EzLDY3QTUsNjdBNyw2N0E4LDY3QUEsNjdBQiw2N0FELDY3QUYsNjdCMCw2N0IzLDY3QjUsNjdCNiw2N0I3LDY3QjgsNjdDMSw2N0MzLDY3QzQsNjdDRiw2N0QwLDY3RDEsNjdEMiw2N0QzLDY3RDQsNjdEOCw2N0Q5LDY3REEsNjdEQyw2N0RELDY3REUsNjdFMCw2N0UyLDY3RTUsNjdFOSw2N0VDLDY3RUYsNjdGMCw2N0YxLDY3RjMsNjdGNCw2N0ZELDY3RkYsNjgwMCw2ODA1LDY4MDcsNjgwOCw2ODA5LDY4MEEsNjgwQiw2ODBDLDY4MEUsNjgwRiw2ODExLDY4MTMsNjgxNiw2ODE3LDY4MUQsNjgyMSw2ODI5LDY4MkEsNjgzMiw2ODMzLDY4MzcsNjgzOCw2ODM5LDY4M0MsNjgzRCw2ODNFLDY4NDAsNjg0MSw2ODQyLDY4NDMsNjg0NCw2ODQ1LDY4NDYsNjg0OCw2ODQ5LDY4NEEsNjg0Qyw2ODRFLDY4NTAsNjg1MSw2ODUzLDY4NTQsNjg1NSw2ODYwLDY4NjEsNjg2Miw2ODYzLDY4NjQsNjg2NSw2ODY2LDY4NjcsNjg2OCw2ODY5LDY4NkIsNjg3NCw2ODc2LDY4NzcsNjg4MSw2ODgzLDY4ODUsNjg4Niw2ODhGLDY4OTMsNjg5Nyw2OEEyLDY4QTYsNjhBNyw2OEE4LDY4QUQsNjhBRiw2OEIwLDY4QjMsNjhCNSw2OEMwLDY4QzIsNjhDOSw2OENCLDY4Q0QsNjhEMiw2OEQ1LDY4RDgsNjhEQSw2OEUwLDY4RTMsNjhFRSw2OEYwLDY4RjEsNjhGNSw2OEY5LDY4RkEsNjhGQyw2OTAxLDY5MDUsNjkwQiw2OTBELDY5MEUsNjkxMCw2OTEyLDY5MUYsNjkyMCw2OTI0LDY5MkQsNjkzMCw2OTM0LDY5MzksNjkzRCw2OTNGLDY5NDIsNjk1NCw2OTU3LDY5NUEsNjk1RCw2OTVFLDY5NjAsNjk2Myw2OTY2LDY5NkIsNjk2RSw2OTcxLDY5NzcsNjk3OCw2OTc5LDY5N0MsNjk4MCw2OTgyLDY5ODQsNjk4Niw2OTg3LDY5ODgsNjk4OSw2OThELDY5OTQsNjk5NSw2OTk4LDY5OUIsNjk5Qyw2OUE3LDY5QTgsNjlBQiw2OUFELDY5QjEsNjlCNCw2OUI3LDY5QkIsNjlDMSw2OUNBLDY5Q0MsNjlDRSw2OUQwLDY5RDQsNjlEQiw2OURGLDY5RTAsNjlFRCw2OUYyLDY5RkQsNjlGRiw2QTBBLDZBMTcsNkExOCw2QTFGLDZBMjEsNkEyOCw2QTJBLDZBMkYsNkEzMSw2QTM1LDZBM0QsNkEzRSw2QTQ0LDZBNDcsNkE1MCw2QTU4LDZBNTksNkE1Qiw2QTYxLDZBNjUsNkE3MSw2QTc5LDZBN0MsNkE4MCw2QTg0LDZBOEUsNkE5MCw2QTkxLDZBOTcsNkFBMCw2QUE5LDZBQUIsNkFBQyw2QjIwLDZCMjEsNkIyMiw2QjIzLDZCMjQsNkIyNyw2QjMyLDZCMzcsNkIzOSw2QjNBLDZCM0UsNkI0Myw2QjQ2LDZCNDcsNkI0OSw2QjRDLDZCNTksNkI2Miw2QjYzLDZCNjQsNkI2NSw2QjY2LDZCNjcsNkI2QSw2Qjc5LDZCN0IsNkI3Qyw2QjgxLDZCODIsNkI4Myw2Qjg0LDZCODYsNkI4Nyw2Qjg5LDZCOEEsNkI4Qiw2QjhELDZCOTIsNkI5Myw2Qjk2LDZCOUEsNkI5Qiw2QkExLDZCQUEsNkJCMyw2QkI0LDZCQjUsNkJCNyw2QkJGLDZCQzEsNkJDMiw2QkM1LDZCQ0IsNkJDRCw2QkNGLDZCRDIsNkJEMyw2QkQ0LDZCRDUsNkJENiw2QkQ3LDZCRDksNkJEQiw2QkUxLDZCRUEsNkJFQiw2QkVGLDZCRjMsNkJGNSw2QkY5LDZCRkQsNkMwNSw2QzA2LDZDMDcsNkMwRCw2QzBGLDZDMTAsNkMxMSw2QzEzLDZDMTQsNkMxNSw2QzE2LDZDMTgsNkMxOSw2QzFBLDZDMUIsNkMxRiw2QzIxLDZDMjIsNkMyNCw2QzI2LDZDMjcsNkMyOCw2QzI5LDZDMkEsNkMyRSw2QzJGLDZDMzAsNkMzMiw2QzM0LDZDMzUsNkMzOCw2QzNELDZDNDAsNkM0MSw2QzQyLDZDNDYsNkM0Nyw2QzQ5LDZDNEEsNkM1MCw2QzU0LDZDNTUsNkM1Nyw2QzVCLDZDNUMsNkM1RCw2QzVFLDZDNUYsNkM2MCw2QzYxLDZDNjQsNkM2OCw2QzY5LDZDNkEsNkM3MCw2QzcyLDZDNzQsNkM3Niw2Qzc5LDZDN0QsNkM3RSw2QzgxLDZDODIsNkM4Myw2Qzg1LDZDODYsNkM4OCw2Qzg5LDZDOEMsNkM4Riw2QzkwLDZDOTMsNkM5NCw2Qzk5LDZDOUIsNkM5Riw2Q0ExLDZDQTMsNkNBNCw2Q0E1LDZDQTYsNkNBNyw2Q0E5LDZDQUEsNkNBQiw2Q0FELDZDQUUsNkNCMSw2Q0IyLDZDQjMsNkNCOCw2Q0I5LDZDQkIsNkNCQyw2Q0JELDZDQkUsNkNCRiw2Q0M0LDZDQzUsNkNDOSw2Q0NBLDZDQ0MsNkNEMCw2Q0QzLDZDRDQsNkNENSw2Q0Q2LDZDRDcsNkNEQiw2Q0RFLDZDRTAsNkNFMSw2Q0UyLDZDRTMsNkNFNSw2Q0U4LDZDRUEsNkNFQiw2Q0VFLDZDRUYsNkNGMCw2Q0YxLDZDRjMsNkNGNSw2Q0Y2LDZDRjcsNkNGOCw2Q0ZBLDZDRkIsNkNGQyw2Q0ZELDZDRkUsNkQwMSw2RDA0LDZEMDcsNkQwQiw2RDBDLDZEMEUsNkQxMiw2RDE3LDZEMTksNkQxQSw2RDFCLDZEMUUsNkQyNSw2RDI3LDZEMkEsNkQyQiw2RDJFLDZEMzEsNkQzMiw2RDMzLDZEMzUsNkQzOSw2RDNCLDZEM0MsNkQzRCw2RDNFLDZENDEsNkQ0Myw2RDQ1LDZENDYsNkQ0Nyw2RDQ4LDZENEEsNkQ0Qiw2RDRELDZENEUsNkQ0Riw2RDUxLDZENTIsNkQ1Myw2RDU0LDZENTksNkQ1QSw2RDVDLDZENUUsNkQ2MCw2RDYzLDZENjYsNkQ2OSw2RDZBLDZENkUsNkQ2Riw2RDc0LDZENzcsNkQ3OCw2RDdDLDZEODIsNkQ4NSw2RDg4LDZEODksNkQ4Qyw2RDhFLDZEOTEsNkQ5Myw2RDk0LDZEOTUsNkQ5Qiw2RDlELDZEOUUsNkQ5Riw2REEwLDZEQTEsNkRBMyw2REE0LDZEQTYsNkRBNyw2REE4LDZEQTksNkRBQSw2REFCLDZEQUUsNkRBRiw2REIyLDZEQjUsNkRCOCw2REJGLDZEQzAsNkRDNCw2REM1LDZEQzYsNkRDNyw2RENCLDZEQ0MsNkREMSw2REQ2LDZERDgsNkREOSw2RERELDZEREUsNkRFMCw2REUxLDZERTQsNkRFNiw2REVCLDZERUMsNkRFRSw2REYxLDZERjMsNkRGNyw2REY5LDZERkIsNkRGQyw2RTA1LDZFMEEsNkUwQyw2RTBELDZFMEUsNkUxMCw2RTExLDZFMTQsNkUxNiw2RTE3LDZFMUEsNkUxRCw2RTIwLDZFMjEsNkUyMyw2RTI0LDZFMjUsNkUyOSw2RTJCLDZFMkQsNkUyRiw2RTMyLDZFMzQsNkUzOCw2RTNBLDZFNDMsNkU0NCw2RTRELDZFNEUsNkU1Myw2RTU0LDZFNTYsNkU1OCw2RTVCLDZFNUYsNkU2Qiw2RTZFLDZFN0UsNkU3Riw2RTgzLDZFODUsNkU4Niw2RTg5LDZFOEYsNkU5MCw2RTk4LDZFOUMsNkU5Riw2RUEyLDZFQTUsNkVBNyw2RUFBLDZFQUYsNkVCMSw2RUIyLDZFQjQsNkVCNiw2RUI3LDZFQkEsNkVCQiw2RUJELDZFQzEsNkVDMiw2RUM3LDZFQ0IsNkVDRiw2RUQxLDZFRDMsNkVENCw2RUQ1LDZFRDcsNkVEQSw2RURFLDZFREYsNkVFMCw2RUUxLDZFRTIsNkVFNCw2RUU1LDZFRTYsNkVFOCw2RUU5LDZFRjQsNkVGOSw2RjAyLDZGMDYsNkYwOSw2RjBGLDZGMTMsNkYxNCw2RjE1LDZGMjAsNkYyNCw2RjI5LDZGMkEsNkYyQiw2RjJELDZGMkYsNkYzMSw2RjMzLDZGMzYsNkYzRSw2RjQ2LDZGNDcsNkY0Qiw2RjRELDZGNTgsNkY1Qyw2RjVFLDZGNjIsNkY2Niw2RjZELDZGNkUsNkY3Miw2Rjc0LDZGNzgsNkY3QSw2RjdDLDZGODQsNkY4OCw2Rjg5LDZGOEMsNkY4RCw2RjhFLDZGOUMsNkZBMSw2RkE3LDZGQjMsNkZCNiw2RkI5LDZGQzAsNkZDMiw2RkM5LDZGRDEsNkZEMiw2RkRFLDZGRTAsNkZFMSw2RkVFLDZGRUYsNzAxMSw3MDFBLDcwMUIsNzAyMyw3MDM1LDcwMzksNzA0Qyw3MDRGLDcwNUUsNzA2Qiw3MDZDLDcwNkQsNzA2Riw3MDcwLDcwNzUsNzA3Niw3MDc4LDcwN0MsNzA3RSw3MDdGLDcwODAsNzA4NSw3MDg5LDcwOEEsNzA4RSw3MDkyLDcwOTQsNzA5NSw3MDk2LDcwOTksNzA5Qyw3MDlELDcwQUIsNzBBQyw3MEFELDcwQUUsNzBBRiw3MEIxLDcwQjMsNzBCNyw3MEI4LDcwQjksNzBCQiw3MEJDLDcwQkQsNzBDMCw3MEMxLDcwQzIsNzBDMyw3MEM4LDcwQ0EsNzBEOCw3MEQ5LDcwREIsNzBERiw3MEU0LDcwRTYsNzBFNyw3MEU4LDcwRTksNzBFQiw3MEVDLDcwRUQsNzBFRiw3MEY3LDcwRjksNzBGRCw3MTA5LDcxMEEsNzExMCw3MTEzLDcxMTUsNzExNiw3MTE4LDcxMTksNzExQSw3MTI2LDcxMkYsNzEzMCw3MTMxLDcxMzYsNzE0NSw3MTRBLDcxNEMsNzE0RSw3MTVDLDcxNUUsNzE2NCw3MTY2LDcxNjcsNzE2OCw3MTZFLDcxNzIsNzE3Myw3MTc4LDcxN0EsNzE3RCw3MTg0LDcxOEEsNzE4Riw3MTk0LDcxOTgsNzE5OSw3MTlGLDcxQTAsNzFBOCw3MUFDLDcxQjMsNzFCNSw3MUI5LDcxQzMsNzFDRSw3MUQ0LDcxRDUsNzFFMCw3MUU1LDcxRTcsNzFFRSw3MUY5LDcyMDYsNzIxRCw3MjI4LDcyMkEsNzIyQyw3MjMwLDcyMzEsNzIzNSw3MjM2LDcyMzcsNzIzOCw3MjM5LDcyM0IsNzIzRCw3MjNGLDcyNDcsNzI0OCw3MjRDLDcyNEQsNzI1Miw3MjU2LDcyNTksNzI1Qiw3MjVELDcyNUYsNzI2MSw3MjYyLDcyNjYsNzI2Nyw3MjY5LDcyNkUsNzI2Riw3MjcyLDcyNzUsNzI3OSw3MjdBLDcyN0UsNzI3Riw3MjgwLDcyODEsNzI4NCw3MjhBLDcyOEIsNzI4RCw3MjhGLDcyOTIsNzI5Riw3MkFDLDcyQUQsNzJBRiw3MkIwLDcyQjQsNzJCNiw3MkI3LDcyQjgsNzJCOSw3MkMxLDcyQzIsNzJDMyw3MkM0LDcyQzgsNzJDRCw3MkNFLDcyRDAsNzJEMiw3MkQ3LDcyRDksNzJERSw3MkUwLDcyRTEsNzJFOCw3MkU5LDcyRUMsNzJFRCw3MkVFLDcyRUYsNzJGMCw3MkYxLDcyRjIsNzJGMyw3MkY0LDcyRjcsNzJGOCw3MkZBLDcyRkIsNzJGQyw3MzAxLDczMDMsNzMwQSw3MzBFLDczMTMsNzMxNSw3MzE2LDczMTcsNzMxQiw3MzFDLDczMUQsNzMxRSw3MzIxLDczMjIsNzMyNSw3MzI5LDczMkEsNzMyQiw3MzJDLDczMkUsNzMzMSw3MzM0LDczMzcsNzMzOCw3MzM5LDczM0UsNzMzRiw3MzRELDczNTAsNzM1Miw3MzU3LDczNjAsNzM2Qyw3MzZELDczNkYsNzM3RSw3Mzg0LDczODcsNzM4OSw3MzhCLDczOEUsNzM5MSw3Mzk2LDczOUIsNzM5Riw3M0EyLDczQTksNzNBQiw3M0FFLDczQUYsNzNCMCw3M0IyLDczQjMsNzNCNyw3M0JBLDczQkIsNzNDMCw3M0MyLDczQzgsNzNDOSw3M0NBLDczQ0QsNzNDRiw3M0QwLDczRDEsNzNEOSw3M0RFLDczRTAsNzNFNSw3M0U3LDczRTksNzNFRCw3M0YyLDc0MDMsNzQwNSw3NDA2LDc0MDksNzQwQSw3NDBGLDc0MTAsNzQxQSw3NDFCLDc0MjIsNzQyNSw3NDI2LDc0MjgsNzQyQSw3NDJDLDc0MkUsNzQzMCw3NDMzLDc0MzQsNzQzNSw3NDM2LDc0M0MsNzQ0MSw3NDU1LDc0NTcsNzQ1OSw3NDVBLDc0NUIsNzQ1Qyw3NDVFLDc0NUYsNzQ2RCw3NDcwLDc0NzYsNzQ3Nyw3NDdFLDc0ODAsNzQ4MSw3NDgzLDc0ODcsNzQ4Qiw3NDhFLDc0OTAsNzQ5Qyw3NDlFLDc0QTcsNzRBOCw3NEE5LDc0QkEsNzREMiw3NERDLDc0REUsNzRFMCw3NEUyLDc0RTMsNzRFNCw3NEU2LDc0RUUsNzRFRiw3NEY0LDc0RjYsNzRGNyw3NEZGLDc1MDQsNzUwRCw3NTBGLDc1MTEsNzUxMyw3NTE4LDc1MTksNzUxQSw3NTFDLDc1MUYsNzUyNSw3NTI4LDc1MjksNzUyQiw3NTJDLDc1MkQsNzUyRiw3NTMwLDc1MzEsNzUzMiw3NTMzLDc1MzUsNzUzNyw3NTM4LDc1M0EsNzUzQiw3NTNFLDc1NDAsNzU0NSw3NTQ4LDc1NEIsNzU0Qyw3NTRFLDc1NEYsNzU1NCw3NTU5LDc1NUEsNzU1Qiw3NTVDLDc1NjUsNzU2Niw3NTZBLDc1NzIsNzU3NCw3NTc4LDc1NzksNzU3Riw3NTgzLDc1ODYsNzU4Qiw3NThGLDc1OTEsNzU5Miw3NTk0LDc1OTYsNzU5Nyw3NTk5LDc1OUEsNzU5RCw3NTlGLDc1QTAsNzVBMSw3NUEzLDc1QTQsNzVBNSw3NUFCLDc1QUMsNzVBRSw3NUFGLDc1QjAsNzVCMSw3NUIyLDc1QjMsNzVCNCw3NUI1LDc1QjgsNzVCOSw3NUJDLDc1QkQsNzVCRSw3NUMyLDc1QzMsNzVDNCw3NUM1LDc1QzcsNzVDOCw3NUM5LDc1Q0EsNzVDRCw3NUQyLDc1RDQsNzVENSw3NUQ2LDc1RDgsNzVEQiw3NURFLDc1RTIsNzVFMyw3NUU0LDc1RTYsNzVFNyw3NUU4LDc1RUEsNzVFQiw3NUYwLDc1RjEsNzVGNCw3NUY5LDc1RkMsNzVGRiw3NjAwLDc2MDEsNzYwMyw3NjA1LDc2MEEsNzYwQyw3NjEwLDc2MTUsNzYxNyw3NjE4LDc2MTksNzYxQiw3NjFGLDc2MjAsNzYyMiw3NjI0LDc2MjUsNzYyNiw3NjI5LDc2MkEsNzYyQiw3NjJELDc2MzAsNzYzMyw3NjM0LDc2MzUsNzYzOCw3NjNDLDc2M0UsNzYzRiw3NjQwLDc2NDMsNzY0Qyw3NjRELDc2NTQsNzY1Niw3NjVDLDc2NUUsNzY2Myw3NjZCLDc2NkYsNzY3OCw3NjdCLDc2N0QsNzY3RSw3NjgyLDc2ODQsNzY4Niw3Njg3LDc2ODgsNzY4Qiw3NjhFLDc2OTEsNzY5Myw3Njk2LDc2OTksNzZBNCw3NkFFLDc2QjEsNzZCMiw3NkI0LDc2QkYsNzZDMiw3NkM1LDc2QzYsNzZDOCw3NkNBLDc2Q0QsNzZDRSw3NkNGLDc2RDAsNzZEMSw3NkQyLDc2RDQsNzZENiw3NkQ3LDc2RDgsNzZEQiw3NkRGLDc2RTUsNzZFRSw3NkVGLDc2RjEsNzZGMiw3NkY0LDc2RjgsNzZGOSw3NkZDLDc2RkUsNzcwMSw3NzA0LDc3MDcsNzcwOCw3NzA5LDc3MEIsNzcwRCw3NzE5LDc3MUEsNzcxRiw3NzIwLDc3MjIsNzcyNiw3NzI4LDc3MjksNzcyRCw3NzJGLDc3MzUsNzczNiw3NzM3LDc3MzgsNzczQSw3NzNDLDc3NDAsNzc0MSw3NzQzLDc3NDcsNzc1MCw3NzUxLDc3NUEsNzc1Qiw3NzYxLDc3NjIsNzc2Myw3NzY1LDc3NjYsNzc2OCw3NzZCLDc3NkMsNzc3OSw3NzdELDc3N0UsNzc3Riw3NzgwLDc3ODQsNzc4NSw3NzhDLDc3OEQsNzc4RSw3NzkxLDc3OTIsNzc5Riw3N0EwLDc3QTIsNzdBNSw3N0E3LDc3QTksNzdBQSw3N0FDLDc3QjAsNzdCMyw3N0I1LDc3QkIsNzdCRCw3N0JGLDc3Q0QsNzdENyw3N0RCLDc3REMsNzdFMiw3N0UzLDc3RTUsNzdFNyw3N0U5LDc3RUIsNzdFQyw3N0VELDc3RUUsNzdGMyw3N0Y2LDc3RjgsNzdGRCw3N0ZFLDc3RkYsNzgwMCw3ODAxLDc4MDIsNzgwOSw3ODBDLDc4MEQsNzgxMSw3ODEyLDc4MTQsNzgxNiw3ODE3LDc4MTgsNzgxQSw3ODFDLDc4MUQsNzgxRiw3ODIzLDc4MjUsNzgyNiw3ODI3LDc4MjksNzgyQyw3ODJELDc4MzAsNzgzNCw3ODM3LDc4MzgsNzgzOSw3ODNBLDc4M0IsNzgzQyw3ODNFLDc4NDAsNzg0NSw3ODQ3LDc4NEMsNzg0RSw3ODUwLDc4NTIsNzg1NSw3ODU2LDc4NTcsNzg1RCw3ODZBLDc4NkIsNzg2Qyw3ODZELDc4NkUsNzg3Nyw3ODdDLDc4ODcsNzg4OSw3ODhDLDc4OEQsNzg4RSw3ODkxLDc4OTMsNzg5Nyw3ODk4LDc4OUEsNzg5Qiw3ODlDLDc4OUYsNzhBMSw3OEEzLDc4QTUsNzhBNyw3OEIwLDc4QjEsNzhCMiw3OEIzLDc4QjQsNzhCOSw3OEJFLDc4QzEsNzhDNSw3OEM5LDc4Q0EsNzhDQiw3OEQwLDc4RDQsNzhENSw3OEQ5LDc4RTgsNzhFQyw3OEYyLDc4RjQsNzhGNyw3OEZBLDc5MDEsNzkwNSw3OTEzLDc5MUUsNzkyNCw3OTM0LDc5M0EsNzkzQiw3OTNDLDc5M0UsNzk0MCw3OTQxLDc5NDYsNzk0OCw3OTQ5LDc5NTMsNzk1Niw3OTU3LDc5NUEsNzk1Qiw3OTVDLDc5NUQsNzk1RSw3OTVGLDc5NjAsNzk2Miw3OTY1LDc5NjcsNzk2OCw3OTZELDc5NkYsNzk3Nyw3OTc4LDc5N0EsNzk4MCw3OTgxLDc5ODQsNzk4NSw3OThBLDc5OEYsNzk5QSw3OUE3LDc5QjMsNzlCOSw3OUJBLDc5QkIsNzlCRCw3OUJFLDc5QzAsNzlDMSw3OUMzLDc5QzYsNzlDOSw3OUNCLDc5Q0QsNzlEMSw3OUQyLDc5RDUsNzlEOCw3OURGLDc5RTMsNzlFNCw3OUU2LDc5RTcsNzlFOSw3OUVCLDc5RUQsNzlFRiw3OUYwLDc5RjgsNzlGQiw3OUZELDdBMDAsN0EwMiw3QTAzLDdBMDYsN0EwQiw3QTBELDdBMEUsN0ExNCw3QTE3LDdBMUEsN0ExRSw3QTIwLDdBMjMsN0EzMyw3QTM3LDdBMzksN0EzQiw3QTNDLDdBM0QsN0EzRiw3QTQ2LDdBNTEsN0E1Nyw3QTcwLDdBNzQsN0E3Niw3QTc3LDdBNzgsN0E3OSw3QTdBLDdBN0YsN0E4MCw3QTgxLDdBODMsN0E4NCw3QTg2LDdBODgsN0E4RCw3QTkxLDdBOTIsN0E5NSw3QTk2LDdBOTcsN0E5OCw3QTlDLDdBOUQsN0E5Riw3QUEwLDdBQTUsN0FBNiw3QUE4LDdBQUMsN0FBRCw3QUIzLDdBQkYsN0FDQiw3QUQ2LDdBRDksN0FERSw3QURGLDdBRTAsN0FFMyw3QUU1LDdBRTYsN0FFRCw3QUVGLDdBRjksN0FGQSw3QUZELDdBRkYsN0IwMyw3QjA0LDdCMDYsN0IwOCw3QjBBLDdCMEIsN0IwRiw3QjExLDdCMTQsN0IxNSw3QjE5LDdCMUIsN0IxRSw3QjIwLDdCMjQsN0IyNSw3QjI2LDdCMjgsN0IyQSw3QjJCLDdCMkMsN0IyRSw3QjMxLDdCMzMsN0IzOCw3QjNBLDdCM0MsN0IzRSw3QjQ1LDdCNDcsN0I0OSw3QjRCLDdCNEMsN0I0Riw3QjUwLDdCNTEsN0I1Miw3QjU0LDdCNTYsN0I1OCw3QjVBLDdCNUIsN0I1RCw3QjYwLDdCNjIsN0I2RSw3QjcxLDdCNzIsN0I3NSw3Qjc3LDdCNzksN0I3Qiw3QjdFLDdCODAsN0I4NSw3QjhELDdCOTAsN0I5NCw3Qjk1LDdCOTcsN0I5Qyw3QjlELDdCQTEsN0JBMiw3QkE2LDdCQTcsN0JBOCw3QkE5LDdCQUEsN0JBQiw3QkFDLDdCQUQsN0JCMSw3QkI0LDdCQjgsN0JDMSw3QkM2LDdCQzcsN0JDQyw3QkQxLDdCRDMsN0JEOSw3QkRBLDdCREQsN0JFMSw3QkU1LDdCRTYsN0JFQSw3QkVFLDdCRjEsN0JGNyw3QkZDLDdCRkUsN0MwNyw3QzBCLDdDMEMsN0MwRiw3QzE2LDdDMUYsN0MyNiw3QzI3LDdDMkEsN0MzOCw3QzNGLDdDNDAsN0M0MSw3QzRELDdDNzMsN0M3NCw3QzdCLDdDN0MsN0M3RCw3Qzg5LDdDOTEsN0M5Miw3Qzk1LDdDOTcsN0M5OCw3QzlDLDdDOUQsN0M5RSw3QzlGLDdDQTIsN0NBNCw3Q0E1LDdDQUEsN0NBRSw3Q0IxLDdDQjIsN0NCMyw3Q0I5LDdDQkMsN0NCRCw3Q0JFLDdDQzEsN0NDNSw3Q0M3LDdDQzgsN0NDQSw3Q0NDLDdDQ0QsN0NENSw3Q0Q2LDdDRDcsN0NEOSw3Q0RDLDdDREYsN0NFMCw3Q0U4LDdDRUYsN0NGOCw3Q0ZCLDdEMEEsN0QyMCw3RDIyLDdEMjcsN0QyQiw3RDJGLDdENkUsN0Q3Nyw3REE2LDdEQUUsN0UzQiw3RTQxLDdFNDcsN0U4Miw3RTlCLDdFOUYsN0VBMCw3RUExLDdFQTIsN0VBMyw3RUE0LDdFQTUsN0VBNiw3RUE3LDdFQTgsN0VBOSw3RUFBLDdFQUIsN0VBQyw3RUFELDdFQUYsN0VCMCw3RUIxLDdFQjIsN0VCMyw3RUI1LDdFQjYsN0VCNyw3RUI4LDdFQjksN0VCQSw3RUJELDdFQkUsN0VCRiw3RUMwLDdFQzEsN0VDMiw3RUMzLDdFQzQsN0VDNSw3RUM2LDdFQzcsN0VDOCw3RUM5LDdFQ0EsN0VDQiw3RUNDLDdFQ0QsN0VDRSw3RUNGLDdFRDAsN0VEMSw3RUQyLDdFRDMsN0VENCw3RUQ1LDdFRDcsN0VEOCw3RUQ5LDdFREEsN0VEQiw3RURDLDdFREQsN0VERSw3RURGLDdFRTAsN0VFMSw3RUUyLDdFRTMsN0VFNSw3RUU2LDdFRTcsN0VFOCw3RUU5LDdFRUEsN0VFQiw3RUVELDdFRUUsN0VFRiw3RUYwLDdFRjEsN0VGMiw3RUYzLDdFRjQsN0VGNSw3RUY2LDdFRjcsN0VGOCw3RUZBLDdFRkIsN0VGQyw3RUZELDdFRkUsN0VGRiw3RjAwLDdGMDEsN0YwMiw3RjAzLDdGMDQsN0YwNSw3RjA2LDdGMDcsN0YwOCw3RjA5LDdGMEIsN0YwQyw3RjBELDdGMEUsN0YwRiw3RjExLDdGMTIsN0YxMyw3RjE0LDdGMTUsN0YxNiw3RjE3LDdGMTgsN0YxOSw3RjFBLDdGMUIsN0YxQyw3RjFELDdGMUYsN0YyMCw3RjIxLDdGMjIsN0YyMyw3RjI0LDdGMjUsN0YyNiw3RjI3LDdGMjgsN0YyOSw3RjJBLDdGMkIsN0YyQyw3RjJELDdGMkUsN0YyRiw3RjMwLDdGMzEsN0YzMiw3RjMzLDdGMzQsN0YzNSw3RjM2LDdGMzgsN0YzQSw3RjQyLDdGNDQsN0Y0NSw3RjUwLDdGNTEsN0Y1NCw3RjU1LDdGNTcsN0Y1OCw3RjVBLDdGNUYsN0Y2MSw3RjYyLDdGNjgsN0Y2OSw3RjZBLDdGNkUsN0Y3MSw3RjcyLDdGNzQsN0Y3OSw3RjdFLDdGODEsN0Y4QSw3RjhDLDdGOEUsN0Y5NCw3RjlBLDdGOUQsN0Y5RSw3RjlGLDdGQTEsN0ZBNCw3RkE3LDdGQUYsN0ZCMCw3RkIyLDdGQjgsN0ZCOSw3RkJDLDdGQkQsN0ZCRiw3RkMxLDdGQzUsN0ZDQSw3RkNDLDdGQ0UsN0ZENCw3RkQ1LDdGRDgsN0ZERiw3RkUwLDdGRTEsN0ZFNSw3RkU2LDdGRTksN0ZFRSw3RkYwLDdGRjEsN0ZGMyw3RkZCLDdGRkMsODAwMCw4MDAxLDgwMDMsODAwNCw4MDA1LDgwMDYsODAwQiw4MDBDLDgwMEQsODAxMCw4MDEyLDgwMTQsODAxNSw4MDE2LDgwMTcsODAxOCw4MDE5LDgwMUMsODAyMCw4MDIyLDgwMjUsODAyNiw4MDI3LDgwMjgsODAyOSw4MDJBLDgwMzEsODAzMyw4MDM1LDgwMzYsODAzNyw4MDM4LDgwM0IsODAzRCw4MDNGLDgwNDIsODA0Myw4MDQ2LDgwNEEsODA0Qiw4MDRDLDgwNEQsODA1Miw4MDU0LDgwNTgsODA1QSw4MDY5LDgwNkEsODA3MSw4MDdGLDgwODAsODA4Myw4MDg0LDgwODYsODA4Nyw4MDg5LDgwOEIsODA4Qyw4MDkzLDgwOTYsODA5OCw4MDlBLDgwOUIsODA5Qyw4MDlELDgwOUYsODBBMCw4MEExLDgwQTIsODBBNCw4MEE1LDgwQTksODBBQSw4MEFCLDgwQUQsODBBRSw4MEFGLDgwQjEsODBCMiw4MEI0LDgwQjcsODBCQSw4MEJDLDgwQkQsODBCRSw4MEJGLDgwQzAsODBDMSw4MEMyLDgwQzMsODBDNCw4MEM2LDgwQ0MsODBDRCw4MENFLDgwRDYsODBENyw4MEQ5LDgwREEsODBEQiw4MERDLDgwREQsODBERSw4MEUxLDgwRTQsODBFNSw4MEU3LDgwRTgsODBFOSw4MEVBLDgwRUIsODBFQyw4MEVELDgwRUYsODBGMCw4MEYxLDgwRjIsODBGMyw4MEY0LDgwRjYsODBGOCw4MEZBLDgwRkMsODBGRCw4MTAyLDgxMDYsODEwOSw4MTBBLDgxMEQsODEwRSw4MTBGLDgxMTAsODExMSw4MTEyLDgxMTMsODExNCw4MTE2LDgxMTgsODExQSw4MTFFLDgxMkMsODEyRiw4MTMxLDgxMzIsODEzNiw4MTM4LDgxM0UsODE0Niw4MTQ4LDgxNEEsODE0Qiw4MTRDLDgxNTAsODE1MSw4MTUzLDgxNTQsODE1NSw4MTU5LDgxNUEsODE2MCw4MTY1LDgxNjcsODE2OSw4MTZELDgxNkUsODE3MCw4MTcxLDgxNzQsODE3OSw4MTdBLDgxN0IsODE3Qyw4MTdELDgxN0UsODE3Riw4MTgwLDgxODIsODE4OCw4MThBLDgxOEYsODE5MSw4MTk4LDgxOUIsODE5Qyw4MTlELDgxQTMsODFBNiw4MUE4LDgxQUEsODFCMyw4MUJBLDgxQkIsODFDMCw4MUMxLDgxQzIsODFDMyw4MUM2LDgxQ0EsODFDQyw4MUUzLDgxRTcsODFFQSw4MUVDLDgxRUQsODFGMyw4MUY0LDgxRkIsODFGQyw4MUZFLDgyMDAsODIwMSw4MjAyLDgyMDQsODIwNSw4MjA2LDgyMEMsODIwRCw4MjEwLDgyMTIsODIxNCw4MjFCLDgyMUMsODIxRSw4MjFGLDgyMjEsODIyMiw4MjIzLDgyMjgsODIyQSw4MjJCLDgyMkMsODIyRCw4MjJGLDgyMzAsODIzMSw4MjMzLDgyMzQsODIzNSw4MjM2LDgyMzcsODIzOCw4MjM5LDgyM0IsODIzRSw4MjQ0LDgyNDcsODI0OSw4MjRCLDgyNEYsODI1OCw4MjVBLDgyNUYsODI2OCw4MjZFLDgyNkYsODI3MCw4MjcyLDgyNzMsODI3NCw4Mjc5LDgyN0EsODI3RCw4MjdFLDgyN0YsODI4Miw4Mjg0LDgyODgsODI4QSw4MjhCLDgyOEQsODI4RSw4MjhGLDgyOTEsODI5Miw4Mjk3LDgyOTgsODI5OSw4MjlDLDgyOUQsODI5Riw4MkExLDgyQTQsODJBNSw4MkE2LDgyQTgsODJBOSw4MkFBLDgyQUIsODJBQyw4MkFELDgyQUUsODJBRiw4MkIwLDgyQjEsODJCMyw4MkI0LDgyQjcsODJCOCw4MkI5LDgyQkQsODJCRSw4MkMxLDgyQzQsODJDNyw4MkM4LDgyQ0EsODJDQiw4MkNDLDgyQ0QsODJDRSw4MkNGLDgyRDEsODJEMiw4MkQzLDgyRDQsODJENSw4MkQ3LDgyRDgsODJEQiw4MkRDLDgyREUsODJERiw4MkUwLDgyRTEsODJFMyw4MkU0LDgyRTUsODJFNiw4MkVCLDgyRUYsODJGMSw4MkY0LDgyRjcsODJGOSw4MkZCLDgzMDEsODMwMiw4MzAzLDgzMDQsODMwNSw4MzA2LDgzMDcsODMwOCw4MzA5LDgzMEMsODMwRSw4MzBGLDgzMTEsODMxNCw4MzE1LDgzMTcsODMxQSw4MzFCLDgzMUMsODMyNyw4MzI4LDgzMkIsODMyQyw4MzJELDgzMkYsODMzMSw4MzMzLDgzMzQsODMzNSw4MzM2LDgzMzgsODMzOSw4MzNBLDgzM0MsODM0MCw4MzQzLDgzNDYsODM0Nyw4MzQ5LDgzNEYsODM1MCw4MzUxLDgzNTIsODM1NCw4MzVBLDgzNUIsODM1Qyw4MzVFLDgzNUYsODM2MCw4MzYxLDgzNjMsODM2NCw4MzY1LDgzNjYsODM2Nyw4MzY4LDgzNjksODM2QSw4MzZCLDgzNkMsODM2RCw4MzZFLDgzNkYsODM3Nyw4Mzc4LDgzN0IsODM3Qyw4MzdELDgzODUsODM4Niw4Mzg5LDgzOEUsODM5Miw4MzkzLDgzOTgsODM5Qiw4MzlDLDgzOUUsODNBMCw4M0E4LDgzQTksODNBQSw4M0FCLDgzQjAsODNCMSw4M0IyLDgzQjMsODNCNCw4M0I2LDgzQjcsODNCOCw4M0I5LDgzQkEsODNCQyw4M0JELDgzQzAsODNDMSw4M0M1LDgzQzcsODNDQSw4M0NDLDgzQ0YsODNENCw4M0Q2LDgzRDgsODNEQyw4M0RELDgzREYsODNFMCw4M0UxLDgzRTUsODNFOSw4M0VBLDgzRjAsODNGMSw4M0YyLDgzRjgsODNGOSw4M0ZELDg0MDEsODQwMyw4NDA0LDg0MDYsODQwQiw4NDBDLDg0MEQsODQwRSw4NDBGLDg0MTEsODQxOCw4NDFDLDg0MUQsODQyNCw4NDI1LDg0MjYsODQyNyw4NDI4LDg0MzEsODQzOCw4NDNDLDg0M0QsODQ0Niw4NDUxLDg0NTcsODQ1OSw4NDVBLDg0NUIsODQ1Qyw4NDYxLDg0NjMsODQ2OSw4NDZCLDg0NkMsODQ2RCw4NDcxLDg0NzMsODQ3NSw4NDc2LDg0NzgsODQ3QSw4NDgyLDg0ODcsODQ4OCw4NDg5LDg0OEIsODQ4Qyw4NDhFLDg0OTcsODQ5OSw4NDlDLDg0QTEsODRBRiw4NEIyLDg0QjQsODRCOCw4NEI5LDg0QkEsODRCRCw4NEJGLDg0QzEsODRDNCw4NEM5LDg0Q0EsODRDRCw4NEQwLDg0RDEsODREMyw4NEQ2LDg0REQsODRERiw4NEUwLDg0RTMsODRFNSw4NEU2LDg0RUMsODRGMCw4NEZDLDg0RkYsODUwQyw4NTExLDg1MTMsODUxNyw4NTFBLDg1MUYsODUyMSw4NTJCLDg1MkMsODUzNyw4NTM4LDg1MzksODUzQSw4NTNCLDg1M0MsODUzRCw4NTQzLDg1NDgsODU0OSw4NTRBLDg1NTYsODU1OSw4NTVFLDg1NjQsODU2OCw4NTcyLDg1NzQsODU3OSw4NTdBLDg1N0IsODU3RSw4NTg0LDg1ODUsODU4Nyw4NThGLDg1OUIsODU5Qyw4NUE0LDg1QTgsODVBQSw4NUFFLDg1QUYsODVCMCw4NUI3LDg1QjksODVDMSw4NUM5LDg1Q0YsODVEMCw4NUQzLDg1RDUsODVEQyw4NUU0LDg1RTksODVGQiw4NUZGLDg2MDUsODYxMSw4NjE2LDg2MjcsODYyOSw4NjM4LDg2M0MsODY0RCw4NjRFLDg2NEYsODY1MCw4NjUxLDg2NTQsODY1QSw4NjVFLDg2NjIsODY2Qiw4NjZDLDg2NkUsODY3MSw4Njc5LDg2N0EsODY3Qiw4NjdDLDg2N0QsODY3RSw4NjdGLDg2ODAsODY4MSw4NjgyLDg2OEEsODY4Qiw4NjhDLDg2OEQsODY5Myw4Njk1LDg2OUMsODY5RCw4NkEzLDg2QTQsODZBNyw4NkE4LDg2QTksODZBQSw4NkFDLDg2QUYsODZCMCw4NkIxLDg2QjQsODZCNSw4NkI2LDg2QkEsODZDMCw4NkM0LDg2QzYsODZDNyw4NkM5LDg2Q0EsODZDQiw4NkNFLDg2Q0YsODZEMCw4NkQxLDg2RDQsODZEOCw4NkQ5LDg2REIsODZERSw4NkRGLDg2RTQsODZFOSw4NkVELDg2RUUsODZGMCw4NkYxLDg2RjIsODZGMyw4NkY0LDg2RjgsODZGOSw4NkZFLDg3MDAsODcwMiw4NzAzLDg3MDcsODcwOCw4NzA5LDg3MEEsODcwRCw4NzEyLDg3MTMsODcxNSw4NzE3LDg3MTgsODcxQSw4NzFDLDg3MUUsODcyMSw4NzIyLDg3MjMsODcyNSw4NzI5LDg3MkUsODczMSw4NzM0LDg3MzcsODczQiw4NzNFLDg3M0YsODc0Nyw4NzQ4LDg3NDksODc0Qyw4NzRFLDg3NTMsODc1Nyw4NzU5LDg3NjAsODc2Myw4NzY0LDg3NjUsODc2RSw4NzcwLDg3NzQsODc3Niw4NzdCLDg3N0MsODc3RCw4NzdFLDg3ODIsODc4Myw4Nzg1LDg3ODgsODc4Qiw4NzhELDg3OTMsODc5Nyw4NzlGLDg3QTgsODdBQiw4N0FDLDg3QUQsODdBRiw4N0IzLDg3QjUsODdCQSw4N0JELDg3QzAsODdDNiw4N0NBLDg3Q0IsODdEMSw4N0QyLDg3RDMsODdEQiw4N0UwLDg3RTUsODdFQSw4N0VFLDg3RjksODdGRSw4ODAzLDg4MEEsODgxMyw4ODE1LDg4MTYsODgxQiw4ODIxLDg4MjIsODgzMiw4ODM5LDg4M0MsODg0MCw4ODQ0LDg4NDUsODg0Qyw4ODRELDg4NTQsODg1Nyw4ODU5LDg4NjEsODg2Miw4ODYzLDg4NjQsODg2NSw4ODY4LDg4NjksODg2Qiw4ODZDLDg4NkUsODg3MCw4ODcyLDg4NzcsODg3RCw4ODdFLDg4N0YsODg4MSw4ODgyLDg4ODQsODg4NSw4ODg4LDg4OEIsODg4RCw4ODkyLDg4OTYsODg5Qyw4OEEyLDg4QTQsODhBQiw4OEFELDg4QjEsODhCNyw4OEJDLDg4QzEsODhDMiw4OEM1LDg4QzYsODhDOSw4OENFLDg4RDIsODhENCw4OEQ1LDg4RDgsODhEOSw4OERGLDg4RTIsODhFMyw4OEU0LDg4RTUsODhFOCw4OEYwLDg4RjEsODhGMyw4OEY0LDg4RjgsODhGOSw4OEZDLDg4RkUsODkwMiw4OTBBLDg5MTAsODkxMiw4OTEzLDg5MTksODkxQSw4OTFCLDg5MjEsODkyNSw4OTJBLDg5MkIsODkzMCw4OTM0LDg5MzYsODk0MSw4OTQ0LDg5NUUsODk1Riw4OTY2LDg5N0IsODk3Riw4OTgxLDg5ODMsODk4Niw4OUMxLDg5QzIsODlDNCw4OUM1LDg5QzYsODlDNyw4OUM4LDg5QzksODlDQSw4OUNCLDg5Q0MsODlDRSw4OUNGLDg5RDAsODlEMSw4OUQyLDg5RDYsODlEQSw4OURDLDg5REUsODlFMyw4OUU1LDg5RTYsODlFQiw4OUVGLDg5RjMsOEEwMCw4QTA3LDhBM0UsOEE0OCw4QTc5LDhBODksOEE4QSw4QTkzLDhCMDcsOEIyNiw4QjY2LDhCNkMsOEJBMCw4QkExLDhCQTIsOEJBMyw4QkE0LDhCQTUsOEJBNiw4QkE3LDhCQTgsOEJBOSw4QkFBLDhCQUIsOEJBRCw4QkFFLDhCQUYsOEJCMCw4QkIyLDhCQjMsOEJCNCw4QkI1LDhCQjYsOEJCNyw4QkI4LDhCQjksOEJCQSw4QkJDLDhCQkQsOEJCRSw4QkJGLDhCQzAsOEJDMSw4QkMyLDhCQzMsOEJDNCw4QkM1LDhCQzYsOEJDOCw4QkM5LDhCQ0EsOEJDQiw4QkNDLDhCQ0QsOEJDRSw4QkNGLDhCRDEsOEJEMiw4QkQzLDhCRDQsOEJENSw4QkQ2LDhCRDcsOEJEOCw4QkQ5LDhCREEsOEJEQiw4QkRDLDhCREQsOEJERSw4QkRGLDhCRTAsOEJFMSw4QkUyLDhCRTMsOEJFNCw4QkU1LDhCRTYsOEJFNyw4QkU4LDhCRTksOEJFQiw4QkVDLDhCRUQsOEJFRSw4QkVGLDhCRjAsOEJGMSw4QkYyLDhCRjMsOEJGNCw4QkY1LDhCRjYsOEJGNyw4QkY4LDhCRjksOEJGQSw4QkZCLDhCRkMsOEJGRCw4QkZFLDhCRkYsOEMwMCw4QzAxLDhDMDIsOEMwMyw4QzA0LDhDMDUsOEMwNiw4QzA3LDhDMDgsOEMwQSw4QzBCLDhDMEMsOEMwRCw4QzBFLDhDMEYsOEMxMCw4QzExLDhDMTIsOEMxMyw4QzE0LDhDMTUsOEMxNiw4QzE3LDhDMTgsOEMxOSw4QzFBLDhDMUIsOEMxQyw4QzFELDhDMUYsOEMyMCw4QzIxLDhDMjIsOEMyMyw4QzI0LDhDMjUsOEMyNiw4QzI3LDhDMjgsOEMyOSw4QzJBLDhDMkIsOEMyQyw4QzJELDhDMkUsOEMyRiw4QzMwLDhDMzEsOEMzMiw4QzMzLDhDMzQsOEMzNSw4QzM2LDhDMzcsOEM0MSw4QzQ2LDhDNDcsOEM0OSw4QzRDLDhDNTUsOEM1QSw4QzYxLDhDNjIsOEM2QSw4QzZCLDhDNzMsOEM3OCw4Qzc5LDhDN0EsOEM4Miw4Qzg1LDhDODksOEM4QSw4QzhDLDhDOTQsOEM5OCw4RDFELDhEMUUsOEQxRiw4RDIxLDhEMjIsOEQyMyw4RDI0LDhEMjUsOEQyNiw4RDI3LDhEMjgsOEQyOSw4RDJBLDhEMkIsOEQyQyw4RDJELDhEMkUsOEQyRiw4RDMwLDhEMzEsOEQzMiw4RDMzLDhEMzQsOEQzNSw4RDM2LDhEMzcsOEQzOCw4RDM5LDhEM0EsOEQzQiw4RDNDLDhEM0QsOEQzRSw4RDNGLDhENDAsOEQ0MSw4RDQyLDhENDMsOEQ0NCw4RDQ1LDhENDYsOEQ0Nyw4RDQ4LDhENDksOEQ0QSw4RDRCLDhENEMsOEQ0RCw4RDRFLDhENEYsOEQ1MCw4RDUzLDhENTQsOEQ1NSw4RDU2LDhENTgsOEQ1OSw4RDVBLDhENUIsOEQ1Qyw4RDVELDhENUUsOEQ2MCw4RDYxLDhENjIsOEQ2Myw4RDY0LDhENjYsOEQ2Nyw4RDZCLDhENkQsOEQ3MCw4RDczLDhENzQsOEQ3NSw4RDc2LDhENzcsOEQ4MSw4RDg0LDhEODUsOEQ4QSw4RDhCLDhEOTEsOEQ5NCw4RDlGLDhEQTMsOERCMSw4REIzLDhEQjQsOERCNSw4REI4LDhEQkEsOERCQyw4REJFLDhEQkYsOERDMyw4REM0LDhEQzYsOERDQiw4RENDLDhEQ0UsOERDRiw4REQxLDhERDYsOERENyw4RERBLDhEREIsOERERCw4RERFLDhEREYsOERFMyw4REU0LDhERTgsOERFQSw4REVCLDhERUMsOERFRiw4REYzLDhERjUsOERGNyw4REY4LDhERjksOERGQSw4REZCLDhERkQsOEUwNSw4RTA5LDhFMEEsOEUwQyw4RTBGLDhFMTQsOEUxRCw4RTFFLDhFMUYsOEUyMiw4RTIzLDhFMjksOEUyQSw4RTJDLDhFMkUsOEUyRiw4RTMxLDhFMzUsOEUzOSw4RTNBLDhFM0QsOEU0MCw4RTQxLDhFNDIsOEU0NCw4RTQ3LDhFNDgsOEU0OSw4RTRBLDhFNEIsOEU1MSw4RTUyLDhFNTksOEU2Niw4RTY5LDhFNkMsOEU2RCw4RTZGLDhFNzAsOEU3Miw4RTc0LDhFNzYsOEU3Qyw4RTdGLDhFODEsOEU4NSw4RTg3LDhFOEYsOEU5MCw4RTk0LDhFOUMsOEU5RSw4RUFCLDhFQUMsOEVBRiw4RUIyLDhFQkEsOEVDRSw4RjY2LDhGNjcsOEY2OCw4RjY5LDhGNkIsOEY2Qyw4RjZELDhGNkUsOEY2Riw4RjcwLDhGNzEsOEY3Miw4RjczLDhGNzQsOEY3NSw4Rjc2LDhGNzcsOEY3OCw4Rjc5LDhGN0EsOEY3Qiw4RjdDLDhGN0QsOEY3RSw4RjdGLDhGODEsOEY4Miw4RjgzLDhGODQsOEY4NSw4Rjg2LDhGODcsOEY4OCw4Rjg5LDhGOEEsOEY4Qiw4RjhELDhGOEUsOEY4Riw4RjkwLDhGOTEsOEY5Myw4Rjk0LDhGOTUsOEY5Niw4Rjk3LDhGOTgsOEY5OSw4RjlBLDhGOUIsOEY5Qyw4RjlFLDhGOUYsOEZBMyw4RkE4LDhGQTksOEZBQiw4RkIwLDhGQjEsOEZCNiw4RkI5LDhGQkQsOEZCRSw4RkMxLDhGQzIsOEZDNCw4RkM1LDhGQzcsOEZDOCw4RkNFLDhGRDAsOEZEMSw4RkQzLDhGRDQsOEZENSw4RkQ4LDhGRDksOEZEQiw4RkRDLDhGREQsOEZERSw4RkRGLDhGRTIsOEZFNCw4RkU1LDhGRTYsOEZFOCw4RkU5LDhGRUEsOEZFQiw4RkVELDhGRUUsOEZGMCw4RkYzLDhGRjcsOEZGOCw4RkY5LDhGRkQsOTAwMCw5MDAxLDkwMDIsOTAwMyw5MDA0LDkwMDUsOTAwNiw5MDA5LDkwMEEsOTAwQiw5MDBELDkwMEYsOTAxMCw5MDExLDkwMTIsOTAxNCw5MDE2LDkwMTcsOTAxQSw5MDFCLDkwMUQsOTAxRSw5MDFGLDkwMjAsOTAyMSw5MDIyLDkwMjYsOTAyRCw5MDJFLDkwMkYsOTAzNSw5MDM2LDkwMzgsOTAzQiw5MDNDLDkwM0UsOTA0MSw5MDQyLDkwNDQsOTA0Nyw5MDRELDkwNEYsOTA1MCw5MDUxLDkwNTIsOTA1Myw5MDU3LDkwNTgsOTA1Qiw5MDYyLDkwNjMsOTA2NSw5MDY4LDkwNkQsOTA2RSw5MDc0LDkwNzUsOTA3RCw5MDdGLDkwODAsOTA4Miw5MDgzLDkwODgsOTA4Qiw5MDkxLDkwOTMsOTA5NSw5MDk3LDkwOTksOTA5Qiw5MDlELDkwQTEsOTBBMiw5MEEzLDkwQTYsOTBBQSw5MEFDLDkwQUUsOTBBRiw5MEIwLDkwQjEsOTBCMyw5MEI0LDkwQjUsOTBCNiw5MEI4LDkwQjksOTBCQSw5MEJCLDkwQkUsOTBDMSw5MEM0LDkwQzUsOTBDNyw5MENBLDkwQ0UsOTBDRiw5MEQwLDkwRDEsOTBEMyw5MEQ3LDkwREIsOTBEQyw5MERELDkwRTEsOTBFMiw5MEU2LDkwRTcsOTBFOCw5MEVCLDkwRUQsOTBFRiw5MEY0LDkwRjgsOTBGRCw5MEZFLDkxMDIsOTEwNCw5MTE5LDkxMUUsOTEyMiw5MTIzLDkxMkYsOTEzMSw5MTM5LDkxNDMsOTE0Niw5MTQ5LDkxNEEsOTE0Qiw5MTRDLDkxNEQsOTE0RSw5MTRGLDkxNTAsOTE1Miw5MTU3LDkxNUEsOTE1RCw5MTVFLDkxNjEsOTE2Miw5MTYzLDkxNjQsOTE2NSw5MTY5LDkxNkEsOTE2Qyw5MTZFLDkxNkYsOTE3MCw5MTcxLDkxNzIsOTE3NCw5MTc1LDkxNzYsOTE3Nyw5MTc4LDkxNzksOTE3RCw5MTdFLDkxN0YsOTE4NSw5MTg3LDkxODksOTE4Qiw5MThDLDkxOEQsOTE5MCw5MTkxLDkxOTIsOTE5QSw5MTlCLDkxQTIsOTFBMyw5MUFBLDkxQUQsOTFBRSw5MUFGLDkxQjQsOTFCNSw5MUJBLDkxQzcsOTFDOSw5MUNBLDkxQ0MsOTFDRCw5MUNFLDkxQ0YsOTFEMSw5MURDLDkyNzQsOTI4RSw5MkFFLDkyQzgsOTMzRSw5MzZBLDkzOEYsOTNDQSw5M0Q2LDk0M0UsOTQ2Qiw5NDg1LDk0ODYsOTQ4Nyw5NDg4LDk0ODksOTQ4QSw5NDhCLDk0OEMsOTQ4RCw5NDhFLDk0OEYsOTQ5MCw5NDkyLDk0OTMsOTQ5NCw5NDk1LDk0OTcsOTQ5OSw5NDlBLDk0OUIsOTQ5Qyw5NDlELDk0OUUsOTQ5Riw5NEEwLDk0QTEsOTRBMiw5NEEzLDk0QTQsOTRBNSw5NEE2LDk0QTcsOTRBOCw5NEE5LDk0QUEsOTRBQiw5NEFDLDk0QUQsOTRBRSw5NEFGLDk0QjAsOTRCMSw5NEIyLDk0QjMsOTRCNCw5NEI1LDk0QjYsOTRCNyw5NEI4LDk0QjksOTRCQSw5NEJCLDk0QkMsOTRCRCw5NEJFLDk0QkYsOTRDMCw5NEMxLDk0QzIsOTRDMyw5NEM0LDk0QzUsOTRDNiw5NEM4LDk0QzksOTRDQSw5NENCLDk0Q0MsOTRDRCw5NENFLDk0RDAsOTREMSw5NEQyLDk0RDUsOTRENiw5NEQ3LDk0RDgsOTREOSw5NERCLDk0REMsOTRERCw5NERFLDk0REYsOTRFMCw5NEUxLDk0RTIsOTRFMyw5NEU0LDk0RTUsOTRFNyw5NEU4LDk0RTksOTRFQSw5NEVCLDk0RUMsOTRFRCw5NEVFLDk0RUYsOTRGMCw5NEYxLDk0RjIsOTRGMyw5NEY0LDk0RjUsOTRGNiw5NEY3LDk0RjgsOTRGOSw5NEZBLDk0RkMsOTRGRCw5NEZFLDk0RkYsOTUwMCw5NTAxLDk1MDIsOTUwMyw5NTA0LDk1MDUsOTUwNiw5NTA3LDk1MDgsOTUwOSw5NTBBLDk1MEIsOTUwQyw5NTBELDk1MEUsOTUwRiw5NTEwLDk1MTEsOTUxMiw5NTEzLDk1MTQsOTUxNSw5NTE2LDk1MTcsOTUxOCw5NTE5LDk1MUEsOTUxQiw5NTFELDk1MUUsOTUxRiw5NTIxLDk1MjIsOTUyMyw5NTI0LDk1MjUsOTUyNiw5NTI4LDk1MjksOTUyQSw5NTJCLDk1MkMsOTUyRCw5NTJFLDk1MkYsOTUzMCw5NTMxLDk1MzIsOTUzNCw5NTM1LDk1MzYsOTUzNyw5NTM4LDk1MzksOTUzQSw5NTNCLDk1M0MsOTUzRSw5NTNGLDk1NDAsOTU0MSw5NTQyLDk1NDQsOTU0NSw5NTQ2LDk1NDcsOTU0OSw5NTRBLDk1NEMsOTU0RCw5NTRFLDk1NEYsOTU1MCw5NTUxLDk1NTIsOTU1Myw5NTU0LDk1NTYsOTU1Nyw5NTU4LDk1NTksOTU1Qiw5NTVDLDk1NUQsOTU1RSw5NTVGLDk1NjEsOTU2Miw5NTYzLDk1NjQsOTU2NSw5NTY2LDk1NjcsOTU2OCw5NTY5LDk1NkEsOTU2Qiw5NTZDLDk1NkQsOTU2Riw5NTcwLDk1NzEsOTU3Miw5NTczLDk1NzYsOTU3Riw5NUU4LDk1RTksOTVFQSw5NUVCLDk1RUQsOTVFRSw5NUVGLDk1RjAsOTVGMSw5NUYyLDk1RjMsOTVGNCw5NUY1LDk1RjYsOTVGNyw5NUY4LDk1RjksOTVGQSw5NUZCLDk1RkMsOTVGRCw5NUZFLDk2MDAsOTYwMSw5NjAyLDk2MDMsOTYwNCw5NjA1LDk2MDYsOTYwOCw5NjA5LDk2MEEsOTYwQiw5NjBDLDk2MEQsOTYwRSw5NjBGLDk2MTAsOTYxMSw5NjEyLDk2MTQsOTYxNSw5NjE2LDk2MTcsOTYxOSw5NjFBLDk2MUMsOTYxRCw5NjFGLDk2MjEsOTYyMiw5NjJBLDk2MkUsOTYzMSw5NjMyLDk2MzMsOTYzNCw5NjM1LDk2MzYsOTYzQiw5NjNDLDk2M0QsOTYzRiw5NjQwLDk2NDIsOTY0NCw5NjQ1LDk2NDYsOTY0Nyw5NjQ4LDk2NDksOTY0Qiw5NjRDLDk2NEQsOTY1MCw5NjU0LDk2NTUsOTY1Qiw5NjVGLDk2NjEsOTY2Miw5NjY0LDk2NjcsOTY2OCw5NjY5LDk2NkEsOTY2Qyw5NjcyLDk2NzQsOTY3NSw5Njc2LDk2NzcsOTY4NSw5Njg2LDk2ODgsOTY4Qiw5NjhELDk2OEYsOTY5MCw5Njk0LDk2OTcsOTY5OCw5Njk5LDk2OUMsOTZBNyw5NkIwLDk2QjMsOTZCNiw5NkI5LDk2QkMsOTZCRCw5NkJFLDk2QzAsOTZDMSw5NkM0LDk2QzUsOTZDNiw5NkM3LDk2QzksOTZDQyw5NkNELDk2Q0UsOTZDRiw5NkQyLDk2RDUsOTZFMCw5NkU4LDk2RTksOTZFQSw5NkVGLDk2RjMsOTZGNiw5NkY3LDk2RjksOTZGRSw5NzAwLDk3MDEsOTcwNCw5NzA2LDk3MDcsOTcwOCw5NzA5LDk3MEQsOTcwRSw5NzBGLDk3MTMsOTcxNiw5NzFDLDk3MUUsOTcyQSw5NzJELDk3MzAsOTczMiw5NzM4LDk3MzksOTczRSw5NzUyLDk3NTMsOTc1Niw5NzU5LDk3NUIsOTc1RSw5NzYwLDk3NjEsOTc2Miw5NzY1LDk3NjksOTc3Myw5Nzc0LDk3NzYsOTc3Qyw5Nzg1LDk3OEIsOTc4RCw5NzkxLDk3OTIsOTc5NCw5Nzk4LDk3QTAsOTdBMyw5N0FCLDk3QUQsOTdBRiw5N0IyLDk3QjQsOTdFNiw5N0U3LDk3RTksOTdFQSw5N0VCLDk3RUMsOTdFRCw5N0YzLDk3RjUsOTdGNiw5ODc1LDk4NzYsOTg3Nyw5ODc4LDk4NzksOTg3QSw5ODdCLDk4N0MsOTg3RCw5ODdFLDk4N0YsOTg4MCw5ODgxLDk4ODIsOTg4Myw5ODg0LDk4ODUsOTg4Niw5ODg3LDk4ODgsOTg4OSw5ODhBLDk4OEMsOTg4RCw5ODhGLDk4OTAsOTg5MSw5ODkzLDk4OTQsOTg5Niw5ODk3LDk4OTgsOTg5QSw5ODlCLDk4OUMsOTg5RCw5ODlFLDk4OUYsOThBMCw5OEExLDk4QTIsOThBNCw5OEE1LDk4QTYsOThBNyw5OENFLDk4RDEsOThEMiw5OEQzLDk4RDUsOThEOCw5OEQ5LDk4REEsOThERSw5OERGLDk4RTcsOThFOCw5OTBELDk5MTAsOTkyRSw5OTU0LDk5NTUsOTk2Myw5OTY1LDk5NjcsOTk2OCw5OTY5LDk5NkEsOTk2Qiw5OTZDLDk5NkQsOTk2RSw5OTZGLDk5NzAsOTk3MSw5OTcyLDk5NzQsOTk3NSw5OTc2LDk5NzcsOTk3QSw5OTdDLDk5N0QsOTk3Riw5OTgwLDk5ODEsOTk4NCw5OTg1LDk5ODYsOTk4Nyw5OTg4LDk5OEEsOTk4Qiw5OThELDk5OEYsOTk5MCw5OTkxLDk5OTIsOTk5Myw5OTk0LDk5OTUsOTk5Niw5OTk3LDk5OTgsOTk5OSw5OUE1LDk5QTgsOUE2Qyw5QTZELDlBNkUsOUE2Riw5QTcwLDlBNzEsOUE3Myw5QTc0LDlBNzUsOUE3Niw5QTc3LDlBNzgsOUE3OSw5QTdBLDlBN0IsOUE3Qyw5QTdELDlBN0UsOUE3Riw5QTgwLDlBODEsOUE4Miw5QTg0LDlBODUsOUE4Niw5QTg3LDlBODgsOUE4QSw5QThCLDlBOEMsOUE4Riw5QTkwLDlBOTEsOUE5Miw5QTkzLDlBOTYsOUE5Nyw5QTk4LDlBOUEsOUE5Qiw5QTlDLDlBOUQsOUE5RSw5QTlGLDlBQTAsOUFBMSw5QUEyLDlBQTMsOUFBNCw5QUE1LDlBQTcsOUFBOCw5QUIwLDlBQjEsOUFCNiw5QUI3LDlBQjgsOUFCQSw5QUJDLDlBQzAsOUFDMSw5QUMyLDlBQzUsOUFDQiw5QUNDLDlBRDEsOUFEMyw5QUQ4LDlBREYsOUFFMSw5QUU2LDlBRUIsOUFFRCw5QUVGLDlBRjksOUFGQiw5QjAzLDlCMDgsOUIwRiw5QjEzLDlCMUYsOUIyMyw5QjJGLDlCMzIsOUIzQiw5QjNDLDlCNDEsOUI0Miw5QjQzLDlCNDQsOUI0NSw5QjQ3LDlCNDgsOUI0OSw5QjRELDlCNEYsOUI1MSw5QjU0LDlDN0MsOUM3Riw5QzgxLDlDODIsOUM4NSw5Qzg2LDlDODcsOUM4OCw5QzhCLDlDOEQsOUM4RSw5QzkwLDlDOTEsOUM5Miw5Qzk0LDlDOTUsOUM5QSw5QzlCLDlDOUMsOUM5RSw5QzlGLDlDQTAsOUNBMSw5Q0EyLDlDQTMsOUNBNCw5Q0E1LDlDQTYsOUNBNyw5Q0E4LDlDQTksOUNBQiw5Q0FELDlDQUUsOUNCMCw5Q0IxLDlDQjIsOUNCMyw5Q0I0LDlDQjUsOUNCNiw5Q0I3LDlDQjgsOUNCQSw5Q0JCLDlDQkMsOUNCRCw5Q0MzLDlDQzQsOUNDNSw5Q0M2LDlDQzcsOUNDQSw5Q0NCLDlDQ0MsOUNDRCw5Q0NFLDlDQ0YsOUNEMCw5Q0QzLDlDRDQsOUNENSw5Q0Q2LDlDRDcsOUNEOCw5Q0Q5LDlDREMsOUNERCw5Q0RFLDlDREYsOUNFMiw5RTFGLDlFMjAsOUUyMSw5RTIyLDlFMjMsOUUyNSw5RTI2LDlFMjgsOUUyOSw5RTJBLDlFMkIsOUUyQyw5RTJELDlFMkYsOUUzMSw5RTMyLDlFMzMsOUUzNSw5RTM2LDlFMzcsOUUzOCw5RTM5LDlFM0EsOUUzRCw5RTNFLDlFM0YsOUU0MSw5RTQyLDlFNDMsOUU0NCw5RTQ1LDlFNDYsOUU0Nyw5RTQ4LDlFNDksOUU0QSw5RTRCLDlFNEMsOUU0RSw5RTRGLDlFNTEsOUU1NSw5RTU3LDlFNTgsOUU1QSw5RTVCLDlFNUMsOUU1RSw5RTYzLDlFNjQsOUU2Niw5RTY3LDlFNjgsOUU2OSw5RTZBLDlFNkIsOUU2Qyw5RTZELDlFNzAsOUU3MSw5RTczLDlFN0UsOUU3Riw5RTgyLDlFODcsOUU4OCw5RThCLDlFOTIsOUU5Myw5RTlELDlFOUYsOUVBNiw5RUI0LDlFQjgsOUVCQiw5RUJELDlFQkUsOUVDNCw5RUM5LDlFQ0QsOUVDRSw5RUNGLDlFRDEsOUVENCw5RUQ4LDlFREIsOUVEQyw5RURELDlFREYsOUVFMCw5RUUyLDlFRTUsOUVFNyw5RUU5LDlFRUEsOUVFRiw5RUY5LDlFRkIsOUVGQyw5RUZFLDlGMEIsOUYwRCw5RjBFLDlGMTAsOUYxMyw5RjE3LDlGMTksOUYyMCw5RjIyLDlGMkMsOUYyRiw5RjM3LDlGMzksOUYzQiw5RjNELDlGM0UsOUY0NCw5RjUwLDlGNTEsOUY3Riw5RjgwLDlGODMsOUY4NCw5Rjg1LDlGODYsOUY4Nyw5Rjg4LDlGODksOUY4QSw5RjhCLDlGOEMsOUY5OSw5RjlBLDlGOUIsOUY5Riw5RkEwLEZGMDEsRkYwMixGRjAzLEZGMDQsRkYwNSxGRjA2LEZGMDcsRkYwOCxGRjA5LEZGMEEsRkYwQixGRjBDLEZGMEQsRkYwRSxGRjBGLEZGMTAsRkYxMSxGRjEyLEZGMTMsRkYxNCxGRjE1LEZGMTYsRkYxNyxGRjE4LEZGMTksRkYxQSxGRjFCLEZGMUMsRkYxRCxGRjFFLEZGMUYsRkYyMCxGRjIxLEZGMjIsRkYyMyxGRjI0LEZGMjUsRkYyNixGRjI3LEZGMjgsRkYyOSxGRjJBLEZGMkIsRkYyQyxGRjJELEZGMkUsRkYyRixGRjMwLEZGMzEsRkYzMixGRjMzLEZGMzQsRkYzNSxGRjM2LEZGMzcsRkYzOCxGRjM5LEZGM0EsRkYzQixGRjNDLEZGM0QsRkYzRSxGRjNGLEZGNDAsRkY0MSxGRjQyLEZGNDMsRkY0NCxGRjQ1LEZGNDYsRkY0NyxGRjQ4LEZGNDksRkY0QSxGRjRCLEZGNEMsRkY0RCxGRjRFLEZGNEYsRkY1MCxGRjUxLEZGNTIsRkY1MyxGRjU0LEZGNTUsRkY1NixGRjU3LEZGNTgsRkY1OSxGRjVBLEZGNUIsRkY1QyxGRjVELEZGNUUsRkZFMCxGRkUxLEZGRTMsRkZFNSc7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBBbnNpVG9Vbmljb2RlKGNockNvZGUpIHsKICAgICAgICAgICAgdmFyIGNockhleCA9IGNockNvZGUudG9TdHJpbmcoMTYpOwogICAgICAgICAgICBjaHJIZXggPSAiMDAwIiArIGNockhleC50b1VwcGVyQ2FzZSgpOwogICAgICAgICAgICBjaHJIZXggPSBjaHJIZXguc3Vic3RyKGNockhleC5sZW5ndGggLSA0KTsKICAgICAgICAgICAgdmFyIGkgPSBBbnNpY29kZUNocigpLmluZGV4T2YoY2hySGV4KTsKICAgICAgICAgICAgaWYgKGkgIT0gLTEpIHsKICAgICAgICAgICAgICAgIGNockhleCA9IFVuaWNvZGVDaHIoKS5zdWJzdHIoaSwgNCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KGNockhleCwgMTYpCiAgICAgICAgfQoKCiAgICAgICAgZnVuY3Rpb24gc3RyQW5zaTJVbmljb2RlKGFzQ29udGVudHMpIHsKICAgICAgICAgICAgdmFyIGxlbjEgPSBhc0NvbnRlbnRzLmxlbmd0aDsKICAgICAgICAgICAgdmFyIHRlbXAgPSAiIjsKICAgICAgICAgICAgdmFyIGNocmNvZGU7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuMTsgaSsrKSB7CiAgICAgICAgICAgICAgICB2YXIgdmFyYXNjID0gYXNDb250ZW50cy5jaGFyQ29kZUF0KGkpOwogICAgICAgICAgICAgICAgaWYgKHZhcmFzYyA+IDEyNykgewogICAgICAgICAgICAgICAgICAgIGNocmNvZGUgPSBBbnNpVG9Vbmljb2RlKCh2YXJhc2MgPDwgOCkgKyBhc0NvbnRlbnRzLmNoYXJDb2RlQXQoKytpKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNocmNvZGUgPSB2YXJhc2M7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0ZW1wICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2hyY29kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRlbXA7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBpc0NsZWFuU3RyKHMpewogICAgICAgICAgICB2YXIgc3RyID0gZGVjb2RlVVJJKHMpOwogICAgICAgICAgICB2YXIgcGF0cm4gPSAvXihbXHU0RTAwLVx1OUZBNV18W1x1RkUzMC1cdUZGQTBdfFtBLVphLXowLTlcK1wvXD1cX1wtXC5c44CQXOOAkVxbXF1cOlx8XCFcflwjXCRcJVxeXCZcKlwoXClcK1w/XDxcPlzjgIpc44CLXEBcYF0pKyQvZ2k7CiAgICAgICAgICAgIHJldHVybihwYXRybi50ZXN0KHN0cikpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYmFzZTY0ZGVjb2RlKGEpIHsKICAgICAgICAgICAgdmFyIGIsIGMsIGQsIGUsIGYsIGcsIGg7CiAgICAgICAgICAgIGZvciAoZyA9IGEubGVuZ3RoLCBmID0gMCwgaCA9ICIiOyBnID4gZjspIHsKICAgICAgICAgICAgICAgIGRvIGIgPSBiYXNlNjREZWNvZGVDaGFyc1syNTUgJiBhLmNoYXJDb2RlQXQoZisrKV07IHdoaWxlIChnID4gZiAmJiAtMSA9PSBiKTsKICAgICAgICAgICAgICAgIGlmICgtMSA9PSBiKSBicmVhazsKICAgICAgICAgICAgICAgIGRvIGMgPSBiYXNlNjREZWNvZGVDaGFyc1syNTUgJiBhLmNoYXJDb2RlQXQoZisrKV07IHdoaWxlIChnID4gZiAmJiAtMSA9PSBjKTsKICAgICAgICAgICAgICAgIGlmICgtMSA9PSBjKSBicmVhazsKICAgICAgICAgICAgICAgIGggKz0gU3RyaW5nLmZyb21DaGFyQ29kZShiIDw8IDIgfCAoNDggJiBjKSA+PiA0KTsKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZCA9IDI1NSAmIGEuY2hhckNvZGVBdChmKyspLCA2MSA9PSBkKSByZXR1cm4gaDsKICAgICAgICAgICAgICAgICAgICBkID0gYmFzZTY0RGVjb2RlQ2hhcnNbZF0KICAgICAgICAgICAgICAgIH0gd2hpbGUgKGcgPiBmICYmIC0xID09IGQpOwogICAgICAgICAgICAgICAgaWYgKC0xID09IGQpIGJyZWFrOwogICAgICAgICAgICAgICAgaCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgxNSAmIGMpIDw8IDQgfCAoNjAgJiBkKSA+PiAyKTsKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZSA9IDI1NSAmIGEuY2hhckNvZGVBdChmKyspLCA2MSA9PSBlKSByZXR1cm4gaDsKICAgICAgICAgICAgICAgICAgICBlID0gYmFzZTY0RGVjb2RlQ2hhcnNbZV0KICAgICAgICAgICAgICAgIH0gd2hpbGUgKGcgPiBmICYmIC0xID09IGUpOwogICAgICAgICAgICAgICAgaWYgKC0xID09IGUpIGJyZWFrOwogICAgICAgICAgICAgICAgaCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgzICYgZCkgPDwgNiB8IGUpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGgKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHV0Zjh0bzE2KGEpIHsKICAgICAgICAgICAgdmFyIGIsIGMsIGQsIGUsIGYsIGc7CiAgICAgICAgICAgIGZvciAoYiA9ICIiLCBkID0gYS5sZW5ndGgsIGMgPSAwOyBkID4gYzspIHN3aXRjaCAoZSA9IGEuY2hhckNvZGVBdChjKyspLCBlID4+IDQpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICBiICs9IGEuY2hhckF0KGMgLSAxKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICAgIGYgPSBhLmNoYXJDb2RlQXQoYysrKSwgYiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgzMSAmIGUpIDw8IDYgfCA2MyAmIGYpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgICAgICBmID0gYS5jaGFyQ29kZUF0KGMrKyksIGcgPSBhLmNoYXJDb2RlQXQoYysrKSwgYiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgxNSAmIGUpIDw8IDEyIHwgKDYzICYgZikgPDwgNiB8ICg2MyAmIGcpIDw8IDApCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGIKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGRlY29kZTY0KGlucHV0KSB7CiAgICAgICAgICAgIHZhciBrZXlTdHIgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iOwogICAgICAgICAgICB2YXIgb3V0cHV0ID0gIiI7CiAgICAgICAgICAgIHZhciBjaHIxLCBjaHIyLCBjaHIzID0gIiI7CiAgICAgICAgICAgIHZhciBlbmMxLCBlbmMyLCBlbmMzLCBlbmM0ID0gIiI7CiAgICAgICAgICAgIHZhciBpID0gMDsKICAgICAgICAgICAgaWYgKGlucHV0Lmxlbmd0aCAlIDQgIT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBiYXNlNjR0ZXN0ID0gL1teQS1aYS16MC05XCtcL1w9XS9nOwogICAgICAgICAgICBpZiAoYmFzZTY0dGVzdC5leGVjKGlucHV0KSkgewogICAgICAgICAgICAgICAgcmV0dXJuICIiOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICBlbmMxID0ga2V5U3RyLmluZGV4T2YoaW5wdXQuY2hhckF0KGkrKykpOwogICAgICAgICAgICAgICAgZW5jMiA9IGtleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTsKICAgICAgICAgICAgICAgIGVuYzMgPSBrZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7CiAgICAgICAgICAgICAgICBlbmM0ID0ga2V5U3RyLmluZGV4T2YoaW5wdXQuY2hhckF0KGkrKykpOwoKICAgICAgICAgICAgICAgIGNocjEgPSAoZW5jMSA8PCAyKSB8IChlbmMyID4+IDQpOwogICAgICAgICAgICAgICAgY2hyMiA9ICgoZW5jMiAmIDE1KSA8PCA0KSB8IChlbmMzID4+IDIpOwogICAgICAgICAgICAgICAgY2hyMyA9ICgoZW5jMyAmIDMpIDw8IDYpIHwgZW5jNDsKICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dCArIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7CiAgICAgICAgICAgICAgICBpZiAoZW5jMyAhPSA2NCkgewogICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGVuYzQgIT0gNjQpIHsKICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShjaHIzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjaHIxID0gY2hyMiA9IGNocjMgPSAiIjsKICAgICAgICAgICAgICAgIGVuYzEgPSBlbmMyID0gZW5jMyA9IGVuYzQgPSAiIjsKCiAgICAgICAgICAgIH0gd2hpbGUgKGkgPCBpbnB1dC5sZW5ndGgpOwogICAgICAgICAgICByZXR1cm4gb3V0cHV0OwogICAgICAgIH0KICAgIH0KICAgIGlmICghd2luZG93LmNocm9tZSkgewogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgWXUsIGZhbHNlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgWXUoKTsKICAgIH0KfSkoKTsKCi8vQUREIEJvb2ttYXJrOmphdmFzY3JpcHQ6KGZ1bmN0aW9uKCl7IHZhciBsaW5rPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhJyk7Zm9yICh2YXIgaT0wLGs9bGluay5sZW5ndGg7IGk8azsgaSsrKXtpZigvXHcraHJlZj0vaS50ZXN0KGxpbmtbaV0ub3V0ZXJIVE1MKSl7bGlua1tpXS5ocmVmPWxpbmtbaV0uZ2V0QXR0cmlidXRlKGxpbmtbaV0ub3V0ZXJIVE1MLm1hdGNoKC9cdytocmVmPS9pKS50b1N0cmluZygpLnJlcGxhY2UoLz0vLCcnKSk7bGlua1tpXS5yZW1vdmVBdHRyaWJ1dGUoIm9uY2xpY2siKTt9ZWxzZSBpZigvXHcraHJlZi9pLnRlc3QobGlua1tpXS5vdXRlckhUTUwpKXtsaW5rW2ldLm9uY29udGV4dG1lbnUoKTtsaW5rW2ldLnJlbW92ZUF0dHJpYnV0ZSgib25jbGljayIpO319IHZvaWQoJ1l1bGVpJyk7fSkoKTsKCi8qIO+8iOaUr+aMge+8mk9wZXJhMTLvvJvlj4rmiYDmnInmtY/op4jlmajvvIzlpoJGaXJlZm9444CBQ2hyb21lc+OAgUlF44CBU2FmYXJp77yJCiAqICDop6PnoIHkuIvovb3lnLDlnYDvvIzlubbmmL7npLrnnJ/lrp7nmoTkuIvovb3lnLDlnYDvvIzlm57mmL7ljp8o5YidKeWni+mTvuaOpe+8jOWmgui/hembt+OAgeW/q+i9puOAgVFR5peL6aOO55qE5Yqg5a+G5LiL6L295Zyw5Z2ACiAqICDmnKzohJrmnKzlj6rkvZzlrabkuaDnoJTnqbblj4LogIPnlKjvvIzniYjmnYPmiYDmnIkg5LiN5b6X5rul55So44CB5ZWG55So44CB5a6D55So77yM5ZCO5p6c6Ieq6LSfCiAqLw=="},{"name":"Zhihu Link Redirect Fix","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":["*.zhihu.com/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1487594258428},"enabled":true,"position":11,"file_url":"https://greasyfork.org/scripts/20431-zhihu-link-redirect-fix/code/Zhihu%20Link%20Redirect%20Fix.user.js","uuid":"f49a21a4-130a-4d21-aa10-994aff4f7585","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgICAgWmhpaHUgTGluayBSZWRpcmVjdCBGaXgKLy8gQG5hbWU6emgtQ04gICAgICAgICAg55+l5LmO55yf5a6e6ZO+5o6l5Zyw5Z2A6YeN5a6a5ZCRCi8vIEBuYW1lOnpoLVRXICAgICAgICAgIOefpeS5juecn+WvpumPiOaOpeWcsOWdgOmHjeWumuWQkQovLyBAZGVzY3JpcHRpb24gICAgICAgICBBdm9pZCBsaW5rIHJlZGlyZWN0IGZvciB6aGlodS5jb20KLy8gQGRlc2NyaXB0aW9uOnpoLUNOICAg6K6p55+l5LmO572R6aG15Lit55qE56uZ5aSW6ZO+5o6l55u05o6l6Lez6L2s6Iez55uu5qCH572R5Z2A77yM6ICM5LiN57uP6L+H5LiA5Liq5LqM5qyh6Lez6L2s6aG16Z2i44CC6YeN5a6a5ZCR5aSE55CG5bCG5Lya5Zyo54K55Ye76ZO+5o6l556s6Ze06Ieq5Yqo6Kem5Y+RCi8vIEBkZXNjcmlwdGlvbjp6aC1UVyAgIOiuk+efpeS5jue2sumggeS4reeahOermeWklumPiOaOpeebtOaOpei3s+i9ieiHs+ebruaomee2suWdgO+8jOiAjOS4jee2k+mBjuWjueWAi+S6jOasoei3s+i9iemggemdouOAgumHjeWumuWQkeiZleeQhuWwh+acg+WcqOm7nuaTiumPiOaOpeeerOmWk+iHquWLleinuOeZvAoKLy8gQGF1dGhvciAgICAgICAgICAgICAgTW9zaGVsCi8vIEBuYW1lc3BhY2UgICAgICAgICAgIGh0dHBzOi8vaHp5LnB3Ci8vIEBob21lcGFnZVVSTCAgICAgICAgIGh0dHBzOi8vaHp5LnB3L3AvMjA1NgovLyBAc3VwcG9ydFVSTCAgICAgICAgICBodHRwczovL2dpdGh1Yi5jb20vaDJ5L2xpbmstZml4Ci8vIEBsaWNlbnNlICAgICAgICAgICAgIEdQTC0zLjAKLy8gQGljb24gICAgICAgICAgICAgICAgaHR0cHM6Ly9waWMxLnpoaW1nLmNvbS8yZTMzZjA2M2YxYmQ5MjIxZGY5NjcyMTkxNjdiNWRlMF9tLmpwZwoKLy8gQGdyYW50ICAgICAgICAgICAgICAgbm9uZQovLyBAcnVuLWF0ICAgICAgICAgICAgICBkb2N1bWVudC1zdGFydAovLyBAaW5jbHVkZSAgICAgICAgICAgICAqLnpoaWh1LmNvbS8qCgovLyBAZGF0ZSAgICAgICAgICAgICAgICAwNi8xMC8yMDE2Ci8vIEBtb2RpZmllZCAgICAgICAgICAgIDAyLzE1LzIwMTcKLy8gQHZlcnNpb24gICAgICAgICAgICAgMS4zLjEuNgovLyA9PS9Vc2VyU2NyaXB0PT0KCgppZihsb2NhdGlvbi5ob3N0PT09J2xpbmsuemhpaHUuY29tJykgewogICAgbGV0IHJlZ1JldCA9IGxvY2F0aW9uLnNlYXJjaC5tYXRjaCgvdGFyZ2V0PSguKz8pKCZ8JCkvKTsKICAgIGlmKHJlZ1JldCAmJiByZWdSZXQubGVuZ3RoPT0zKQogICAgICAgIGxvY2F0aW9uLmhyZWYgPSBkZWNvZGVVUklDb21wb25lbnQocmVnUmV0WzFdKTsKfQplbHNlCiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7CiAgICAgICAgbGV0IGRvbSA9IGUudGFyZ2V0LAogICAgICAgICAgICBtYXhfdGltZXMgPSAzOwogICAgICAgIHdoaWxlKGRvbSAmJiBtYXhfdGltZXMtLSkgewogICAgICAgICAgICBpZihkb20ubm9kZU5hbWUudG9VcHBlckNhc2UoKT09PSdBJykgewogICAgICAgICAgICAgICAgbGV0IHJlZ1JldCA9IGRvbS5zZWFyY2gubWF0Y2goL3RhcmdldD0oLis/KSgmfCQpLyk7CiAgICAgICAgICAgICAgICBpZihyZWdSZXQgJiYgcmVnUmV0Lmxlbmd0aD09MykKICAgICAgICAgICAgICAgICAgICBkb20uaHJlZiA9IGRlY29kZVVSSUNvbXBvbmVudChyZWdSZXRbMV0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGRvbSA9IGRvbS5wYXJlbnROb2RlOwogICAgICAgIH0KICAgIH0pOwo="},{"name":"anti-redirect (typescript)","options":{"awareOfChrome":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["*"],"orig_excludes":[],"orig_includes":["*www.baidu.com*","*tieba.baidu.com*","*v.baidu.com*","*www.google.*","*encrypted.google.com*","*www.so.com*","*www.zhihu.com*","*daily.zhihu.com*","*zhuanlan.zhihu.com*","*weibo.com*","*twitter.com*","*www.sogou.com*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1494260745834,"data":{}},"enabled":true,"position":12,"file_url":"https://greasyfork.org/scripts/11915-anti-redirect-typescript/code/anti-redirect%20(typescript).user.js","uuid":"940abf92-5596-46e1-a189-b613f3d47cee","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgIGFudGktcmVkaXJlY3QgKHR5cGVzY3JpcHQpCi8vIEBhdXRob3IgICAgICAgICAgICBBeGV0cm95Ci8vIEBjb2xsYWJvcmF0b3IgICAgICBBeGV0cm95Ci8vIEBkZXNjcmlwdGlvbiAgICAgICBHTeiEmuacrCwg5Y676Zmk5ZCE5pCc57Si5byV5pOOL+W4uOeUqOe9keermeeahOmHjeWumuWQkQovLyBAdmVyc2lvbiAgICAgICAgICAgMS4yLjIKLy8gQHVwZGF0ZSAgICAgICAgICAgIDIwMTctMDQtMDQgMTg6MzI6NTIKLy8gQGdyYW50ICAgICAgICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0Ci8vIEBpbmNsdWRlICAgICAgICAgICAqd3d3LmJhaWR1LmNvbSoKLy8gQGluY2x1ZGUgICAgICAgICAgICp0aWViYS5iYWlkdS5jb20qCi8vIEBpbmNsdWRlICAgICAgICAgICAqdi5iYWlkdS5jb20qCi8vIEBpbmNsdWRlICAgICAgICAgICAqd3d3Lmdvb2dsZS4qCi8vIEBpbmNsdWRlICAgICAgICAgICAqZW5jcnlwdGVkLmdvb2dsZS5jb20qCi8vIEBpbmNsdWRlICAgICAgICAgICAqd3d3LnNvLmNvbSoKLy8gQGluY2x1ZGUgICAgICAgICAgICp3d3cuemhpaHUuY29tKgovLyBAaW5jbHVkZSAgICAgICAgICAgKmRhaWx5LnpoaWh1LmNvbSoKLy8gQGluY2x1ZGUgICAgICAgICAgICp6aHVhbmxhbi56aGlodS5jb20qCi8vIEBpbmNsdWRlICAgICAgICAgICAqd2VpYm8uY29tKgovLyBAaW5jbHVkZSAgICAgICAgICAgKnR3aXR0ZXIuY29tKgovLyBAaW5jbHVkZSAgICAgICAgICAgKnd3dy5zb2dvdS5jb20qCi8vIEBjb25uZWN0ICAgICAgICAgICAqCi8vIEBjb21wYXRpYmxlICAgICAgICBjaHJvbWUgIOWujOe+jui/kOihjAovLyBAY29tcGF0aWJsZSAgICAgICAgZmlyZWZveCAg5a6M576O6L+Q6KGMCi8vIEBzdXBwb3J0VVJMICAgICAgICBodHRwOi8vd3d3LmJ1cm5pbmdhbGwuY29tCi8vIEBydW4tYXQgICAgICAgICAgICBkb2N1bWVudC1zdGFydAovLyBAY29udHJpYnV0aW9uVVJMICAgdHJveTQ1MDQwOTQwNUBnbWFpbC5jb218YWxpcGF5LmNvbQovLyBAbmFtZXNwYWNlICAgICAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi91c2Vycy8zNDAwLWF4ZXRyb3kKLy8gQGxpY2Vuc2UgICAgICAgICAgIFRoZSBNSVQgTGljZW5zZSAoTUlUKTsgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVAovLyA9PS9Vc2VyU2NyaXB0PT0KCi8vIEdpdGh1Yua6kOeggTpodHRwczovL2dpdGh1Yi5jb20vYXhldHJveS9hbnRpLXJlZGlyZWN0CgoKLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcAovKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJdmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCi8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7Ci8qKioqKiovCi8qKioqKiovIAkJLy8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlCi8qKioqKiovIAkJaWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pCi8qKioqKiovIAkJCXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOwovKioqKioqLwovKioqKioqLyAJCS8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpCi8qKioqKiovIAkJdmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0gewovKioqKioqLyAJCQlpOiBtb2R1bGVJZCwKLyoqKioqKi8gCQkJbDogZmFsc2UsCi8qKioqKiovIAkJCWV4cG9ydHM6IHt9Ci8qKioqKiovIAkJfTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb24KLyoqKioqKi8gCQltb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKLyoqKioqKi8KLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkCi8qKioqKiovIAkJbW9kdWxlLmwgPSB0cnVlOwovKioqKioqLwovKioqKioqLyAJCS8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCi8qKioqKiovIAkJcmV0dXJuIG1vZHVsZS5leHBvcnRzOwovKioqKioqLyAJfQovKioqKioqLwovKioqKioqLwovKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXykKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7Ci8qKioqKiovCi8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZQovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlczsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGlkZW50aXR5IGZ1bmN0aW9uIGZvciBjYWxsaW5nIGhhcm1vbnkgaW1wb3J0cyB3aXRoIHRoZSBjb3JyZWN0IGNvbnRleHQKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0cwovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7Ci8qKioqKiovIAkJaWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkgewovKioqKioqLyAJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgewovKioqKioqLyAJCQkJY29uZmlndXJhYmxlOiBmYWxzZSwKLyoqKioqKi8gCQkJCWVudW1lcmFibGU6IHRydWUsCi8qKioqKiovIAkJCQlnZXQ6IGdldHRlcgovKioqKioqLyAJCQl9KTsKLyoqKioqKi8gCQl9Ci8qKioqKiovIAl9OwovKioqKioqLwovKioqKioqLyAJLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXMKLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkgewovKioqKioqLyAJCXZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgPwovKioqKioqLyAJCQlmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOgovKioqKioqLyAJCQlmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9OwovKioqKioqLyAJCV9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTsKLyoqKioqKi8gCQlyZXR1cm4gZ2V0dGVyOwovKioqKioqLyAJfTsKLyoqKioqKi8KLyoqKioqKi8gCS8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbAovKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9OwovKioqKioqLwovKioqKioqLyAJLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KLyoqKioqKi8gCV9fd2VicGFja19yZXF1aXJlX18ucCA9ICIiOwovKioqKioqLwovKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzCi8qKioqKiovIAlyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA4NCk7Ci8qKioqKiovIH0pCi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi8qKioqKiovIChbCi8qIDAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHJvb3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CnZhciB0b1N1YnNjcmliZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oODMpOwp2YXIgb2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKLyoqCiAqIEEgcmVwcmVzZW50YXRpb24gb2YgYW55IHNldCBvZiB2YWx1ZXMgb3ZlciBhbnkgYW1vdW50IG9mIHRpbWUuIFRoaXMgdGhlIG1vc3QgYmFzaWMgYnVpbGRpbmcgYmxvY2sKICogb2YgUnhKUy4KICoKICogQGNsYXNzIE9ic2VydmFibGU8VD4KICovCnZhciBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uICgpIHsKICAgIC8qKgogICAgICogQGNvbnN0cnVjdG9yCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWJzY3JpYmUgdGhlIGZ1bmN0aW9uIHRoYXQgaXMgIGNhbGxlZCB3aGVuIHRoZSBPYnNlcnZhYmxlIGlzCiAgICAgKiBpbml0aWFsbHkgc3Vic2NyaWJlZCB0by4gVGhpcyBmdW5jdGlvbiBpcyBnaXZlbiBhIFN1YnNjcmliZXIsIHRvIHdoaWNoIG5ldyB2YWx1ZXMKICAgICAqIGNhbiBiZSBgbmV4dGBlZCwgb3IgYW4gYGVycm9yYCBtZXRob2QgY2FuIGJlIGNhbGxlZCB0byByYWlzZSBhbiBlcnJvciwgb3IKICAgICAqIGBjb21wbGV0ZWAgY2FuIGJlIGNhbGxlZCB0byBub3RpZnkgb2YgYSBzdWNjZXNzZnVsIGNvbXBsZXRpb24uCiAgICAgKi8KICAgIGZ1bmN0aW9uIE9ic2VydmFibGUoc3Vic2NyaWJlKSB7CiAgICAgICAgdGhpcy5faXNTY2FsYXIgPSBmYWxzZTsKICAgICAgICBpZiAoc3Vic2NyaWJlKSB7CiAgICAgICAgICAgIHRoaXMuX3N1YnNjcmliZSA9IHN1YnNjcmliZTsKICAgICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSwgd2l0aCB0aGlzIE9ic2VydmFibGUgYXMgdGhlIHNvdXJjZSwgYW5kIHRoZSBwYXNzZWQKICAgICAqIG9wZXJhdG9yIGRlZmluZWQgYXMgdGhlIG5ldyBvYnNlcnZhYmxlJ3Mgb3BlcmF0b3IuCiAgICAgKiBAbWV0aG9kIGxpZnQKICAgICAqIEBwYXJhbSB7T3BlcmF0b3J9IG9wZXJhdG9yIHRoZSBvcGVyYXRvciBkZWZpbmluZyB0aGUgb3BlcmF0aW9uIHRvIHRha2Ugb24gdGhlIG9ic2VydmFibGUKICAgICAqIEByZXR1cm4ge09ic2VydmFibGV9IGEgbmV3IG9ic2VydmFibGUgd2l0aCB0aGUgT3BlcmF0b3IgYXBwbGllZAogICAgICovCiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5saWZ0ID0gZnVuY3Rpb24gKG9wZXJhdG9yKSB7CiAgICAgICAgdmFyIG9ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZSgpOwogICAgICAgIG9ic2VydmFibGUuc291cmNlID0gdGhpczsKICAgICAgICBvYnNlcnZhYmxlLm9wZXJhdG9yID0gb3BlcmF0b3I7CiAgICAgICAgcmV0dXJuIG9ic2VydmFibGU7CiAgICB9OwogICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKG9ic2VydmVyT3JOZXh0LCBlcnJvciwgY29tcGxldGUpIHsKICAgICAgICB2YXIgb3BlcmF0b3IgPSB0aGlzLm9wZXJhdG9yOwogICAgICAgIHZhciBzaW5rID0gdG9TdWJzY3JpYmVyXzEudG9TdWJzY3JpYmVyKG9ic2VydmVyT3JOZXh0LCBlcnJvciwgY29tcGxldGUpOwogICAgICAgIGlmIChvcGVyYXRvcikgewogICAgICAgICAgICBvcGVyYXRvci5jYWxsKHNpbmssIHRoaXMuc291cmNlKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHNpbmsuYWRkKHRoaXMuX3RyeVN1YnNjcmliZShzaW5rKSk7CiAgICAgICAgfQogICAgICAgIGlmIChzaW5rLnN5bmNFcnJvclRocm93YWJsZSkgewogICAgICAgICAgICBzaW5rLnN5bmNFcnJvclRocm93YWJsZSA9IGZhbHNlOwogICAgICAgICAgICBpZiAoc2luay5zeW5jRXJyb3JUaHJvd24pIHsKICAgICAgICAgICAgICAgIHRocm93IHNpbmsuc3luY0Vycm9yVmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNpbms7CiAgICB9OwogICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3RyeVN1YnNjcmliZSA9IGZ1bmN0aW9uIChzaW5rKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShzaW5rKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycikgewogICAgICAgICAgICBzaW5rLnN5bmNFcnJvclRocm93biA9IHRydWU7CiAgICAgICAgICAgIHNpbmsuc3luY0Vycm9yVmFsdWUgPSBlcnI7CiAgICAgICAgICAgIHNpbmsuZXJyb3IoZXJyKTsKICAgICAgICB9CiAgICB9OwogICAgLyoqCiAgICAgKiBAbWV0aG9kIGZvckVhY2gKICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG5leHQgYSBoYW5kbGVyIGZvciBlYWNoIHZhbHVlIGVtaXR0ZWQgYnkgdGhlIG9ic2VydmFibGUKICAgICAqIEBwYXJhbSB7UHJvbWlzZUNvbnN0cnVjdG9yfSBbUHJvbWlzZUN0b3JdIGEgY29uc3RydWN0b3IgZnVuY3Rpb24gdXNlZCB0byBpbnN0YW50aWF0ZSB0aGUgUHJvbWlzZQogICAgICogQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHRoYXQgZWl0aGVyIHJlc29sdmVzIG9uIG9ic2VydmFibGUgY29tcGxldGlvbiBvcgogICAgICogIHJlamVjdHMgd2l0aCB0aGUgaGFuZGxlZCBlcnJvcgogICAgICovCiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKG5leHQsIFByb21pc2VDdG9yKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICBpZiAoIVByb21pc2VDdG9yKSB7CiAgICAgICAgICAgIGlmIChyb290XzEucm9vdC5SeCAmJiByb290XzEucm9vdC5SeC5jb25maWcgJiYgcm9vdF8xLnJvb3QuUnguY29uZmlnLlByb21pc2UpIHsKICAgICAgICAgICAgICAgIFByb21pc2VDdG9yID0gcm9vdF8xLnJvb3QuUnguY29uZmlnLlByb21pc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAocm9vdF8xLnJvb3QuUHJvbWlzZSkgewogICAgICAgICAgICAgICAgUHJvbWlzZUN0b3IgPSByb290XzEucm9vdC5Qcm9taXNlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghUHJvbWlzZUN0b3IpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdubyBQcm9taXNlIGltcGwgZm91bmQnKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlQ3RvcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgYSBzdWJzY3JpcHRpb24sIHRoZW4gd2UgY2FuIHN1cm1pc2UKICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbmV4dCBoYW5kbGluZyBpcyBhc3luY2hyb25vdXMuIEFueSBlcnJvcnMgdGhyb3duCiAgICAgICAgICAgICAgICAgICAgLy8gbmVlZCB0byBiZSByZWplY3RlZCBleHBsaWNpdGx5IGFuZCB1bnN1YnNjcmliZSBtdXN0IGJlCiAgICAgICAgICAgICAgICAgICAgLy8gY2FsbGVkIG1hbnVhbGx5CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCh2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIE5PIHN1YnNjcmlwdGlvbiwgdGhlbiB3ZSdyZSBnZXR0aW5nIGEgbmV4dGVkCiAgICAgICAgICAgICAgICAgICAgLy8gdmFsdWUgc3luY2hyb25vdXNseSBkdXJpbmcgc3Vic2NyaXB0aW9uLiBXZSBjYW4ganVzdCBjYWxsIGl0LgogICAgICAgICAgICAgICAgICAgIC8vIElmIGl0IGVycm9ycywgT2JzZXJ2YWJsZSdzIGBzdWJzY3JpYmVgIHdpbGwgZW5zdXJlIHRoZQogICAgICAgICAgICAgICAgICAgIC8vIHVuc3Vic2NyaXB0aW9uIGxvZ2ljIGlzIGNhbGxlZCwgdGhlbiBzeW5jaHJvbm91c2x5IHJldGhyb3cgdGhlIGVycm9yLgogICAgICAgICAgICAgICAgICAgIC8vIEFmdGVyIHRoYXQsIFByb21pc2Ugd2lsbCB0cmFwIHRoZSBlcnJvciBhbmQgc2VuZCBpdAogICAgICAgICAgICAgICAgICAgIC8vIGRvd24gdGhlIHJlamVjdGlvbiBwYXRoLgogICAgICAgICAgICAgICAgICAgIG5leHQodmFsdWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCByZWplY3QsIHJlc29sdmUpOwogICAgICAgIH0pOwogICAgfTsKICAgIE9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikgewogICAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUoc3Vic2NyaWJlcik7CiAgICB9OwogICAgLyoqCiAgICAgKiBBbiBpbnRlcm9wIHBvaW50IGRlZmluZWQgYnkgdGhlIGVzNy1vYnNlcnZhYmxlIHNwZWMgaHR0cHM6Ly9naXRodWIuY29tL3plbnBhcnNpbmcvZXMtb2JzZXJ2YWJsZQogICAgICogQG1ldGhvZCBTeW1ib2wub2JzZXJ2YWJsZQogICAgICogQHJldHVybiB7T2JzZXJ2YWJsZX0gdGhpcyBpbnN0YW5jZSBvZiB0aGUgb2JzZXJ2YWJsZQogICAgICovCiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZVtvYnNlcnZhYmxlXzEuJCRvYnNlcnZhYmxlXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH07CiAgICAvLyBIQUNLOiBTaW5jZSBUeXBlU2NyaXB0IGluaGVyaXRzIHN0YXRpYyBwcm9wZXJ0aWVzIHRvbywgd2UgaGF2ZSB0bwogICAgLy8gZmlnaHQgYWdhaW5zdCBUeXBlU2NyaXB0IGhlcmUgc28gU3ViamVjdCBjYW4gaGF2ZSBhIGRpZmZlcmVudCBzdGF0aWMgY3JlYXRlIHNpZ25hdHVyZQogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgbmV3IGNvbGQgT2JzZXJ2YWJsZSBieSBjYWxsaW5nIHRoZSBPYnNlcnZhYmxlIGNvbnN0cnVjdG9yCiAgICAgKiBAc3RhdGljIHRydWUKICAgICAqIEBvd25lciBPYnNlcnZhYmxlCiAgICAgKiBAbWV0aG9kIGNyZWF0ZQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gc3Vic2NyaWJlPyB0aGUgc3Vic2NyaWJlciBmdW5jdGlvbiB0byBiZSBwYXNzZWQgdG8gdGhlIE9ic2VydmFibGUgY29uc3RydWN0b3IKICAgICAqIEByZXR1cm4ge09ic2VydmFibGV9IGEgbmV3IGNvbGQgb2JzZXJ2YWJsZQogICAgICovCiAgICBPYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmUpIHsKICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoc3Vic2NyaWJlKTsKICAgIH07CiAgICByZXR1cm4gT2JzZXJ2YWJsZTsKfSgpKTsKZXhwb3J0cy5PYnNlcnZhYmxlID0gT2JzZXJ2YWJsZTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9T2JzZXJ2YWJsZS5qcy5tYXAKCi8qKiovIH0pLAovKiAxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciBpc0Z1bmN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTsKdmFyIFN1YnNjcmlwdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKdmFyIE9ic2VydmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KTsKdmFyIHJ4U3Vic2NyaWJlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCk7Ci8qKgogKiBJbXBsZW1lbnRzIHRoZSB7QGxpbmsgT2JzZXJ2ZXJ9IGludGVyZmFjZSBhbmQgZXh0ZW5kcyB0aGUKICoge0BsaW5rIFN1YnNjcmlwdGlvbn0gY2xhc3MuIFdoaWxlIHRoZSB7QGxpbmsgT2JzZXJ2ZXJ9IGlzIHRoZSBwdWJsaWMgQVBJIGZvcgogKiBjb25zdW1pbmcgdGhlIHZhbHVlcyBvZiBhbiB7QGxpbmsgT2JzZXJ2YWJsZX0sIGFsbCBPYnNlcnZlcnMgZ2V0IGNvbnZlcnRlZCB0bwogKiBhIFN1YnNjcmliZXIsIGluIG9yZGVyIHRvIHByb3ZpZGUgU3Vic2NyaXB0aW9uLWxpa2UgY2FwYWJpbGl0aWVzIHN1Y2ggYXMKICogYHVuc3Vic2NyaWJlYC4gU3Vic2NyaWJlciBpcyBhIGNvbW1vbiB0eXBlIGluIFJ4SlMsIGFuZCBjcnVjaWFsIGZvcgogKiBpbXBsZW1lbnRpbmcgb3BlcmF0b3JzLCBidXQgaXQgaXMgcmFyZWx5IHVzZWQgYXMgYSBwdWJsaWMgQVBJLgogKgogKiBAY2xhc3MgU3Vic2NyaWJlcjxUPgogKi8KdmFyIFN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFN1YnNjcmliZXIsIF9zdXBlcik7CiAgICAvKioKICAgICAqIEBwYXJhbSB7T2JzZXJ2ZXJ8ZnVuY3Rpb24odmFsdWU6IFQpOiB2b2lkfSBbZGVzdGluYXRpb25Pck5leHRdIEEgcGFydGlhbGx5CiAgICAgKiBkZWZpbmVkIE9ic2VydmVyIG9yIGEgYG5leHRgIGNhbGxiYWNrIGZ1bmN0aW9uLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihlOiA/YW55KTogdm9pZH0gW2Vycm9yXSBUaGUgYGVycm9yYCBjYWxsYmFjayBvZiBhbgogICAgICogT2JzZXJ2ZXIuCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk6IHZvaWR9IFtjb21wbGV0ZV0gVGhlIGBjb21wbGV0ZWAgY2FsbGJhY2sgb2YgYW4KICAgICAqIE9ic2VydmVyLgogICAgICovCiAgICBmdW5jdGlvbiBTdWJzY3JpYmVyKGRlc3RpbmF0aW9uT3JOZXh0LCBlcnJvciwgY29tcGxldGUpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTsKICAgICAgICB0aGlzLnN5bmNFcnJvclZhbHVlID0gbnVsbDsKICAgICAgICB0aGlzLnN5bmNFcnJvclRocm93biA9IGZhbHNlOwogICAgICAgIHRoaXMuc3luY0Vycm9yVGhyb3dhYmxlID0gZmFsc2U7CiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTsKICAgICAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbiA9IE9ic2VydmVyXzEuZW1wdHk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgaWYgKCFkZXN0aW5hdGlvbk9yTmV4dCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24gPSBPYnNlcnZlcl8xLmVtcHR5OwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkZXN0aW5hdGlvbk9yTmV4dCA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZGVzdGluYXRpb25Pck5leHQgaW5zdGFuY2VvZiBTdWJzY3JpYmVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24gPSBkZXN0aW5hdGlvbk9yTmV4dDsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5hZGQodGhpcyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN5bmNFcnJvclRocm93YWJsZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24gPSBuZXcgU2FmZVN1YnNjcmliZXIodGhpcywgZGVzdGluYXRpb25Pck5leHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRoaXMuc3luY0Vycm9yVGhyb3dhYmxlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24gPSBuZXcgU2FmZVN1YnNjcmliZXIodGhpcywgZGVzdGluYXRpb25Pck5leHQsIGVycm9yLCBjb21wbGV0ZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9CiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZVtyeFN1YnNjcmliZXJfMS4kJHJ4U3Vic2NyaWJlcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9OwogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBmYWN0b3J5IGZvciBhIFN1YnNjcmliZXIsIGdpdmVuIGEgKHBvdGVudGlhbGx5IHBhcnRpYWwpIGRlZmluaXRpb24KICAgICAqIG9mIGFuIE9ic2VydmVyLgogICAgICogQHBhcmFtIHtmdW5jdGlvbih4OiA/VCk6IHZvaWR9IFtuZXh0XSBUaGUgYG5leHRgIGNhbGxiYWNrIG9mIGFuIE9ic2VydmVyLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihlOiA/YW55KTogdm9pZH0gW2Vycm9yXSBUaGUgYGVycm9yYCBjYWxsYmFjayBvZiBhbgogICAgICogT2JzZXJ2ZXIuCiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uKCk6IHZvaWR9IFtjb21wbGV0ZV0gVGhlIGBjb21wbGV0ZWAgY2FsbGJhY2sgb2YgYW4KICAgICAqIE9ic2VydmVyLgogICAgICogQHJldHVybiB7U3Vic2NyaWJlcjxUPn0gQSBTdWJzY3JpYmVyIHdyYXBwaW5nIHRoZSAocGFydGlhbGx5IGRlZmluZWQpCiAgICAgKiBPYnNlcnZlciByZXByZXNlbnRlZCBieSB0aGUgZ2l2ZW4gYXJndW1lbnRzLgogICAgICovCiAgICBTdWJzY3JpYmVyLmNyZWF0ZSA9IGZ1bmN0aW9uIChuZXh0LCBlcnJvciwgY29tcGxldGUpIHsKICAgICAgICB2YXIgc3Vic2NyaWJlciA9IG5ldyBTdWJzY3JpYmVyKG5leHQsIGVycm9yLCBjb21wbGV0ZSk7CiAgICAgICAgc3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUgPSBmYWxzZTsKICAgICAgICByZXR1cm4gc3Vic2NyaWJlcjsKICAgIH07CiAgICAvKioKICAgICAqIFRoZSB7QGxpbmsgT2JzZXJ2ZXJ9IGNhbGxiYWNrIHRvIHJlY2VpdmUgbm90aWZpY2F0aW9ucyBvZiB0eXBlIGBuZXh0YCBmcm9tCiAgICAgKiB0aGUgT2JzZXJ2YWJsZSwgd2l0aCBhIHZhbHVlLiBUaGUgT2JzZXJ2YWJsZSBtYXkgY2FsbCB0aGlzIG1ldGhvZCAwIG9yIG1vcmUKICAgICAqIHRpbWVzLgogICAgICogQHBhcmFtIHtUfSBbdmFsdWVdIFRoZSBgbmV4dGAgdmFsdWUuCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkgewogICAgICAgICAgICB0aGlzLl9uZXh0KHZhbHVlKTsKICAgICAgICB9CiAgICB9OwogICAgLyoqCiAgICAgKiBUaGUge0BsaW5rIE9ic2VydmVyfSBjYWxsYmFjayB0byByZWNlaXZlIG5vdGlmaWNhdGlvbnMgb2YgdHlwZSBgZXJyb3JgIGZyb20KICAgICAqIHRoZSBPYnNlcnZhYmxlLCB3aXRoIGFuIGF0dGFjaGVkIHtAbGluayBFcnJvcn0uIE5vdGlmaWVzIHRoZSBPYnNlcnZlciB0aGF0CiAgICAgKiB0aGUgT2JzZXJ2YWJsZSBoYXMgZXhwZXJpZW5jZWQgYW4gZXJyb3IgY29uZGl0aW9uLgogICAgICogQHBhcmFtIHthbnl9IFtlcnJdIFRoZSBgZXJyb3JgIGV4Y2VwdGlvbi4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIFN1YnNjcmliZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikgewogICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHsKICAgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOwogICAgICAgICAgICB0aGlzLl9lcnJvcihlcnIpOwogICAgICAgIH0KICAgIH07CiAgICAvKioKICAgICAqIFRoZSB7QGxpbmsgT2JzZXJ2ZXJ9IGNhbGxiYWNrIHRvIHJlY2VpdmUgYSB2YWx1ZWxlc3Mgbm90aWZpY2F0aW9uIG9mIHR5cGUKICAgICAqIGBjb21wbGV0ZWAgZnJvbSB0aGUgT2JzZXJ2YWJsZS4gTm90aWZpZXMgdGhlIE9ic2VydmVyIHRoYXQgdGhlIE9ic2VydmFibGUKICAgICAqIGhhcyBmaW5pc2hlZCBzZW5kaW5nIHB1c2gtYmFzZWQgbm90aWZpY2F0aW9ucy4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIFN1YnNjcmliZXIucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHsKICAgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOwogICAgICAgICAgICB0aGlzLl9jb21wbGV0ZSgpOwogICAgICAgIH0KICAgIH07CiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5jbG9zZWQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7CiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS51bnN1YnNjcmliZS5jYWxsKHRoaXMpOwogICAgfTsKICAgIFN1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHZhbHVlKTsKICAgIH07CiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZS5fZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihlcnIpOwogICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgIH07CiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZS5fY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpOwogICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgIH07CiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZS5fdW5zdWJzY3JpYmVBbmRSZWN5Y2xlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfYSA9IHRoaXMsIF9wYXJlbnQgPSBfYS5fcGFyZW50LCBfcGFyZW50cyA9IF9hLl9wYXJlbnRzOwogICAgICAgIHRoaXMuX3BhcmVudCA9IG51bGw7CiAgICAgICAgdGhpcy5fcGFyZW50cyA9IG51bGw7CiAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpOwogICAgICAgIHRoaXMuY2xvc2VkID0gZmFsc2U7CiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTsKICAgICAgICB0aGlzLl9wYXJlbnQgPSBfcGFyZW50OwogICAgICAgIHRoaXMuX3BhcmVudHMgPSBfcGFyZW50czsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH07CiAgICByZXR1cm4gU3Vic2NyaWJlcjsKfShTdWJzY3JpcHRpb25fMS5TdWJzY3JpcHRpb24pKTsKZXhwb3J0cy5TdWJzY3JpYmVyID0gU3Vic2NyaWJlcjsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBpZ25vcmUKICogQGV4dGVuZHMge0lnbm9yZWR9CiAqLwp2YXIgU2FmZVN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFNhZmVTdWJzY3JpYmVyLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gU2FmZVN1YnNjcmliZXIoX3BhcmVudFN1YnNjcmliZXIsIG9ic2VydmVyT3JOZXh0LCBlcnJvciwgY29tcGxldGUpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTsKICAgICAgICB0aGlzLl9wYXJlbnRTdWJzY3JpYmVyID0gX3BhcmVudFN1YnNjcmliZXI7CiAgICAgICAgdmFyIG5leHQ7CiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzOwogICAgICAgIGlmIChpc0Z1bmN0aW9uXzEuaXNGdW5jdGlvbihvYnNlcnZlck9yTmV4dCkpIHsKICAgICAgICAgICAgbmV4dCA9IG9ic2VydmVyT3JOZXh0OwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChvYnNlcnZlck9yTmV4dCkgewogICAgICAgICAgICBjb250ZXh0ID0gb2JzZXJ2ZXJPck5leHQ7CiAgICAgICAgICAgIG5leHQgPSBvYnNlcnZlck9yTmV4dC5uZXh0OwogICAgICAgICAgICBlcnJvciA9IG9ic2VydmVyT3JOZXh0LmVycm9yOwogICAgICAgICAgICBjb21wbGV0ZSA9IG9ic2VydmVyT3JOZXh0LmNvbXBsZXRlOwogICAgICAgICAgICBpZiAoaXNGdW5jdGlvbl8xLmlzRnVuY3Rpb24oY29udGV4dC51bnN1YnNjcmliZSkpIHsKICAgICAgICAgICAgICAgIHRoaXMuYWRkKGNvbnRleHQudW5zdWJzY3JpYmUuYmluZChjb250ZXh0KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29udGV4dC51bnN1YnNjcmliZSA9IHRoaXMudW5zdWJzY3JpYmUuYmluZCh0aGlzKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5fY29udGV4dCA9IGNvbnRleHQ7CiAgICAgICAgdGhpcy5fbmV4dCA9IG5leHQ7CiAgICAgICAgdGhpcy5fZXJyb3IgPSBlcnJvcjsKICAgICAgICB0aGlzLl9jb21wbGV0ZSA9IGNvbXBsZXRlOwogICAgfQogICAgU2FmZVN1YnNjcmliZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkICYmIHRoaXMuX25leHQpIHsKICAgICAgICAgICAgdmFyIF9wYXJlbnRTdWJzY3JpYmVyID0gdGhpcy5fcGFyZW50U3Vic2NyaWJlcjsKICAgICAgICAgICAgaWYgKCFfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUpIHsKICAgICAgICAgICAgICAgIHRoaXMuX190cnlPclVuc3ViKHRoaXMuX25leHQsIHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmICh0aGlzLl9fdHJ5T3JTZXRFcnJvcihfcGFyZW50U3Vic2NyaWJlciwgdGhpcy5fbmV4dCwgdmFsdWUpKSB7CiAgICAgICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgU2FmZVN1YnNjcmliZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikgewogICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHsKICAgICAgICAgICAgdmFyIF9wYXJlbnRTdWJzY3JpYmVyID0gdGhpcy5fcGFyZW50U3Vic2NyaWJlcjsKICAgICAgICAgICAgaWYgKHRoaXMuX2Vycm9yKSB7CiAgICAgICAgICAgICAgICBpZiAoIV9wYXJlbnRTdWJzY3JpYmVyLnN5bmNFcnJvclRocm93YWJsZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuX190cnlPclVuc3ViKHRoaXMuX2Vycm9yLCBlcnIpOwogICAgICAgICAgICAgICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuX190cnlPclNldEVycm9yKF9wYXJlbnRTdWJzY3JpYmVyLCB0aGlzLl9lcnJvciwgZXJyKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoIV9wYXJlbnRTdWJzY3JpYmVyLnN5bmNFcnJvclRocm93YWJsZSkgewogICAgICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpOwogICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgX3BhcmVudFN1YnNjcmliZXIuc3luY0Vycm9yVmFsdWUgPSBlcnI7CiAgICAgICAgICAgICAgICBfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd24gPSB0cnVlOwogICAgICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKICAgIFNhZmVTdWJzY3JpYmVyLnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7CiAgICAgICAgICAgIHZhciBfcGFyZW50U3Vic2NyaWJlciA9IHRoaXMuX3BhcmVudFN1YnNjcmliZXI7CiAgICAgICAgICAgIGlmICh0aGlzLl9jb21wbGV0ZSkgewogICAgICAgICAgICAgICAgaWYgKCFfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9fdHJ5T3JVbnN1Yih0aGlzLl9jb21wbGV0ZSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3RyeU9yU2V0RXJyb3IoX3BhcmVudFN1YnNjcmliZXIsIHRoaXMuX2NvbXBsZXRlKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgU2FmZVN1YnNjcmliZXIucHJvdG90eXBlLl9fdHJ5T3JVbnN1YiA9IGZ1bmN0aW9uIChmbiwgdmFsdWUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBmbi5jYWxsKHRoaXMuX2NvbnRleHQsIHZhbHVlKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycikgewogICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICB9CiAgICB9OwogICAgU2FmZVN1YnNjcmliZXIucHJvdG90eXBlLl9fdHJ5T3JTZXRFcnJvciA9IGZ1bmN0aW9uIChwYXJlbnQsIGZuLCB2YWx1ZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZuLmNhbGwodGhpcy5fY29udGV4dCwgdmFsdWUpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIHBhcmVudC5zeW5jRXJyb3JWYWx1ZSA9IGVycjsKICAgICAgICAgICAgcGFyZW50LnN5bmNFcnJvclRocm93biA9IHRydWU7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwogICAgU2FmZVN1YnNjcmliZXIucHJvdG90eXBlLl91bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3BhcmVudFN1YnNjcmliZXIgPSB0aGlzLl9wYXJlbnRTdWJzY3JpYmVyOwogICAgICAgIHRoaXMuX2NvbnRleHQgPSBudWxsOwogICAgICAgIHRoaXMuX3BhcmVudFN1YnNjcmliZXIgPSBudWxsOwogICAgICAgIF9wYXJlbnRTdWJzY3JpYmVyLnVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIFNhZmVTdWJzY3JpYmVyOwp9KFN1YnNjcmliZXIpKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3Vic2NyaWJlci5qcy5tYXAKCi8qKiovIH0pLAovKiAyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgewovKioKICogd2luZG93OiBicm93c2VyIGluIERPTSBtYWluIHRocmVhZAogKiBzZWxmOiBicm93c2VyIGluIFdlYldvcmtlcgogKiBnbG9iYWw6IE5vZGUuanMvb3RoZXIKICovCmV4cG9ydHMucm9vdCA9ICh0eXBlb2Ygd2luZG93ID09ICdvYmplY3QnICYmIHdpbmRvdy53aW5kb3cgPT09IHdpbmRvdyAmJiB3aW5kb3cKICAgIHx8IHR5cGVvZiBzZWxmID09ICdvYmplY3QnICYmIHNlbGYuc2VsZiA9PT0gc2VsZiAmJiBzZWxmCiAgICB8fCB0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGdsb2JhbC5nbG9iYWwgPT09IGdsb2JhbCAmJiBnbG9iYWwpOwppZiAoIWV4cG9ydHMucm9vdCkgewogICAgdGhyb3cgbmV3IEVycm9yKCdSeEpTIGNvdWxkIG5vdCBmaW5kIGFueSBnbG9iYWwgY29udGV4dCAod2luZG93LCBzZWxmLCBnbG9iYWwpJyk7Cn0KLy8jIHNvdXJjZU1hcHBpbmdVUkw9cm9vdC5qcy5tYXAKLyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oODUpKSkKCi8qKiovIH0pLAovKiAzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgbG9nXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKdmFyIGNvbmZpZ18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNyk7CnZhciBERUJVRyA9IGNvbmZpZ18xLkNPTkZJRy5kZWJ1ZzsKdmFyIFJlZGlyZWN0T25VcmwgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gUmVkaXJlY3RPblVybChkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlciwgQVNlbGVjdG9yKSB7CiAgICAgICAgdGhpcy5kb21haW5UZXN0ZXIgPSBkb21haW5UZXN0ZXI7CiAgICAgICAgdGhpcy51cmxUZXN0ZXIgPSB1cmxUZXN0ZXI7CiAgICAgICAgdGhpcy5tYXRjaGVyID0gbWF0Y2hlcjsKICAgICAgICB0aGlzLkFTZWxlY3RvciA9IEFTZWxlY3RvcjsKICAgICAgICB0aGlzLm1hdGNoID0gZmFsc2U7CiAgICAgICAgdGhpcy5ERUJVRyA9IERFQlVHOwogICAgICAgIHRoaXMuQVNlbGVjdG9yID0gdGhpcy5BU2VsZWN0b3IgfHwgJ2EnOwogICAgICAgIHRoaXMubWF0Y2ggPSBkb21haW5UZXN0ZXIudGVzdChkb2N1bWVudC5kb21haW4pOwogICAgfQogICAgLyoqCiAgICAgKiDlt7Lnu4/ovazljJbmiJDlip/kuYvlkI7nmoTlhYPntKAKICAgICAqIEBwYXJhbSBhRWxlCiAgICAgKi8KICAgIFJlZGlyZWN0T25VcmwucHJvdG90eXBlLmhhbmRsZXJPbmVDYWxsQmFjayA9IGZ1bmN0aW9uIChhRWxlKSB7CiAgICB9OwogICAgLyoqCiAgICAgKiDpu5jorqTvvIzlpITnkIbkuIDkuKpB5YWD57SgCiAgICAgKiBAcGFyYW0gYUVsZQogICAgICovCiAgICBSZWRpcmVjdE9uVXJsLnByb3RvdHlwZS5oYW5kbGVyID0gZnVuY3Rpb24gKGFFbGUpIHsKICAgICAgICB2YXIgbWF0Y2hlciA9IHRoaXMubWF0Y2hlci5leGVjKGFFbGUuaHJlZik7CiAgICAgICAgaWYgKCFtYXRjaGVyIHx8ICFtYXRjaGVyLmxlbmd0aCB8fCAhbWF0Y2hlclsxXSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIHZhciB1cmwgPSAnJzsKICAgICAgICB0cnkgewogICAgICAgICAgICB1cmwgPSBkZWNvZGVVUklDb21wb25lbnQobWF0Y2hlclsxXSk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChlKSB7CiAgICAgICAgICAgIHVybCA9IC9odHRwcz86XC9cLy8udGVzdChtYXRjaGVyWzFdKSA/IG1hdGNoZXJbMV0gOiAnJzsKICAgICAgICB9CiAgICAgICAgaWYgKHVybCkgewogICAgICAgICAgICBhRWxlLnNldEF0dHJpYnV0ZSgnb3JpZ2luLWhyZWYnLCBhRWxlLmdldEF0dHJpYnV0ZSgnaHJlZicpKTsKICAgICAgICAgICAgYUVsZS5ocmVmID0gdXJsOwogICAgICAgICAgICBERUJVRyAmJiAoYUVsZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZ3JlZW4nKTsKICAgICAgICAgICAgdGhpcy5oYW5kbGVyT25lQ2FsbEJhY2soYUVsZSk7CiAgICAgICAgfQogICAgfTsKICAgIFJlZGlyZWN0T25VcmwucHJvdG90eXBlLmhhbmRsZXJPbmUgPSBmdW5jdGlvbiAoYUVsZSkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgcmV0dXJuIE9ic2VydmFibGVfMS5PYnNlcnZhYmxlLm9mKGFFbGUpCiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGVsZSkgeyByZXR1cm4gX3RoaXMudXJsVGVzdGVyLnRlc3QoZWxlLmhyZWYpOyB9KQogICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uIChhRWxlKSB7IHJldHVybiBfdGhpcy5oYW5kbGVyKGFFbGUpOyB9KTsKICAgIH07CiAgICBSZWRpcmVjdE9uVXJsLnByb3RvdHlwZS5oYW5kbGVyT25lQnlPbmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIE9ic2VydmFibGVfMS5PYnNlcnZhYmxlLmZyb20oW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuQVNlbGVjdG9yKSkpCiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHRhcmdldCkgeyByZXR1cm4gISEodGFyZ2V0Lm5vZGVOYW1lID09PSAnQScgJiYgdGFyZ2V0LmhyZWYpOyB9KTsKICAgIH07CiAgICBSZWRpcmVjdE9uVXJsLnByb3RvdHlwZS5zY3JvbGwgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuZnJvbUV2ZW50KGRvY3VtZW50LCAnc2Nyb2xsJykKICAgICAgICAgICAgLmRlYm91bmNlVGltZSgyMDApCiAgICAgICAgICAgIC5mbGF0TWFwKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmhhbmRsZXJPbmVCeU9uZSgpOyB9KQogICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uIChhRWxlKSB7IHJldHVybiBfdGhpcy5oYW5kbGVyT25lKGFFbGUpOyB9KTsKICAgIH07CiAgICBSZWRpcmVjdE9uVXJsLnByb3RvdHlwZS5tb3VzZW92ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIE9ic2VydmFibGVfMS5PYnNlcnZhYmxlLmZyb21FdmVudChkb2N1bWVudCwgJ21vdXNlbW92ZScpCiAgICAgICAgICAgIC50aHJvdHRsZVRpbWUoMTAwKQogICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OwogICAgICAgICAgICByZXR1cm4gdGFyZ2V0Lm5vZGVOYW1lID09PSAnQScgPyB0YXJnZXQgOiB0YXJnZXQucGFyZW50Tm9kZS5ub2RlTmFtZSA9PT0gJ0EnID8gdGFyZ2V0LnBhcmVudE5vZGUgOiB0YXJnZXQ7CiAgICAgICAgfSkKICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZWxlKSB7IHJldHVybiBlbGUubm9kZU5hbWUgPT09ICdBJzsgfSk7CiAgICB9OwogICAgUmVkaXJlY3RPblVybC5wcm90b3R5cGUub25Jbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBhZ20gPSBbXTsKICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgICAgICAgICBhZ21bX2ldID0gYXJndW1lbnRzW19pXTsKICAgICAgICB9CiAgICB9OwogICAgUmVkaXJlY3RPblVybC5wcm90b3R5cGUuYm9vdHN0cmFwID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgaWYgKCF0aGlzLm1hdGNoKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuZnJvbUV2ZW50KGRvY3VtZW50LCAnRE9NQ29udGVudExvYWRlZCcpCiAgICAgICAgICAgIC5kZWxheSgxMDAwKQogICAgICAgICAgICAuZmxhdE1hcChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVyT25lQnlPbmUoKS5maWx0ZXIoZnVuY3Rpb24gKGFFbGUpIHsgcmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMTQpLmlzKGFFbGUpOyB9KTsgfSkKICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAoYUVsZSkgewogICAgICAgICAgICBfdGhpcy5vbkluaXQoKTsKICAgICAgICAgICAgX3RoaXMuaGFuZGxlck9uZShhRWxlKTsKICAgICAgICAgICAgX3RoaXMuc2Nyb2xsKCk7CiAgICAgICAgICAgIF90aGlzLm1vdXNlb3ZlcigpLnN1YnNjcmliZShmdW5jdGlvbiAoYUVsZSkgeyByZXR1cm4gX3RoaXMuaGFuZGxlck9uZShhRWxlKTsgfSk7CiAgICAgICAgICAgIGxvZ18xLmxvZygpOwogICAgICAgIH0pOwogICAgfTsKICAgIHJldHVybiBSZWRpcmVjdE9uVXJsOwp9KCkpOwpleHBvcnRzLlJlZGlyZWN0T25VcmwgPSBSZWRpcmVjdE9uVXJsOwoKCi8qKiovIH0pLAovKiA0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBBc3luY0FjdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3OCk7CnZhciBBc3luY1NjaGVkdWxlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3OSk7Ci8qKgogKgogKiBBc3luYyBTY2hlZHVsZXIKICoKICogPHNwYW4gY2xhc3M9ImluZm9ybWFsIj5TY2hlZHVsZSB0YXNrIGFzIGlmIHlvdSB1c2VkIHNldFRpbWVvdXQodGFzaywgZHVyYXRpb24pPC9zcGFuPgogKgogKiBgYXN5bmNgIHNjaGVkdWxlciBzY2hlZHVsZXMgdGFza3MgYXN5bmNocm9ub3VzbHksIGJ5IHB1dHRpbmcgdGhlbSBvbiB0aGUgSmF2YVNjcmlwdAogKiBldmVudCBsb29wIHF1ZXVlLiBJdCBpcyBiZXN0IHVzZWQgdG8gZGVsYXkgdGFza3MgaW4gdGltZSBvciB0byBzY2hlZHVsZSB0YXNrcyByZXBlYXRpbmcKICogaW4gaW50ZXJ2YWxzLgogKgogKiBJZiB5b3UganVzdCB3YW50IHRvICJkZWZlciIgdGFzaywgdGhhdCBpcyB0byBwZXJmb3JtIGl0IHJpZ2h0IGFmdGVyIGN1cnJlbnRseQogKiBleGVjdXRpbmcgc3luY2hyb25vdXMgY29kZSBlbmRzIChjb21tb25seSBhY2hpZXZlZCBieSBgc2V0VGltZW91dChkZWZlcnJlZFRhc2ssIDApYCksCiAqIGJldHRlciBjaG9pY2Ugd2lsbCBiZSB0aGUge0BsaW5rIGFzYXB9IHNjaGVkdWxlci4KICoKICogQGV4YW1wbGUgPGNhcHRpb24+VXNlIGFzeW5jIHNjaGVkdWxlciB0byBkZWxheSB0YXNrPC9jYXB0aW9uPgogKiBjb25zdCB0YXNrID0gKCkgPT4gY29uc29sZS5sb2coJ2l0IHdvcmtzIScpOwogKgogKiBSeC5TY2hlZHVsZXIuYXN5bmMuc2NoZWR1bGUodGFzaywgMjAwMCk7CiAqCiAqIC8vIEFmdGVyIDIgc2Vjb25kcyBsb2dzOgogKiAvLyAiaXQgd29ya3MhIgogKgogKgogKiBAZXhhbXBsZSA8Y2FwdGlvbj5Vc2UgYXN5bmMgc2NoZWR1bGVyIHRvIHJlcGVhdCB0YXNrIGluIGludGVydmFsczwvY2FwdGlvbj4KICogZnVuY3Rpb24gdGFzayhzdGF0ZSkgewogKiAgIGNvbnNvbGUubG9nKHN0YXRlKTsKICogICB0aGlzLnNjaGVkdWxlKHN0YXRlICsgMSwgMTAwMCk7IC8vIGB0aGlzYCByZWZlcmVuY2VzIGN1cnJlbnRseSBleGVjdXRpbmcgQWN0aW9uLAogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2hpY2ggd2UgcmVzY2hlZHVsZSB3aXRoIG5ldyBzdGF0ZSBhbmQgZGVsYXkKICogfQogKgogKiBSeC5TY2hlZHVsZXIuYXN5bmMuc2NoZWR1bGUodGFzaywgMzAwMCwgMCk7CiAqCiAqIC8vIExvZ3M6CiAqIC8vIDAgYWZ0ZXIgM3MKICogLy8gMSBhZnRlciA0cwogKiAvLyAyIGFmdGVyIDVzCiAqIC8vIDMgYWZ0ZXIgNnMKICoKICogQHN0YXRpYyB0cnVlCiAqIEBuYW1lIGFzeW5jCiAqIEBvd25lciBTY2hlZHVsZXIKICovCmV4cG9ydHMuYXN5bmMgPSBuZXcgQXN5bmNTY2hlZHVsZXJfMS5Bc3luY1NjaGVkdWxlcihBc3luY0FjdGlvbl8xLkFzeW5jQWN0aW9uKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXN5bmMuanMubWFwCgovKioqLyB9KSwKLyogNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgaXNBcnJheV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7CnZhciBpc09iamVjdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMyk7CnZhciBpc0Z1bmN0aW9uXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTsKdmFyIHRyeUNhdGNoXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTsKdmFyIGVycm9yT2JqZWN0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpOwp2YXIgVW5zdWJzY3JpcHRpb25FcnJvcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4MSk7Ci8qKgogKiBSZXByZXNlbnRzIGEgZGlzcG9zYWJsZSByZXNvdXJjZSwgc3VjaCBhcyB0aGUgZXhlY3V0aW9uIG9mIGFuIE9ic2VydmFibGUuIEEKICogU3Vic2NyaXB0aW9uIGhhcyBvbmUgaW1wb3J0YW50IG1ldGhvZCwgYHVuc3Vic2NyaWJlYCwgdGhhdCB0YWtlcyBubyBhcmd1bWVudAogKiBhbmQganVzdCBkaXNwb3NlcyB0aGUgcmVzb3VyY2UgaGVsZCBieSB0aGUgc3Vic2NyaXB0aW9uLgogKgogKiBBZGRpdGlvbmFsbHksIHN1YnNjcmlwdGlvbnMgbWF5IGJlIGdyb3VwZWQgdG9nZXRoZXIgdGhyb3VnaCB0aGUgYGFkZCgpYAogKiBtZXRob2QsIHdoaWNoIHdpbGwgYXR0YWNoIGEgY2hpbGQgU3Vic2NyaXB0aW9uIHRvIHRoZSBjdXJyZW50IFN1YnNjcmlwdGlvbi4KICogV2hlbiBhIFN1YnNjcmlwdGlvbiBpcyB1bnN1YnNjcmliZWQsIGFsbCBpdHMgY2hpbGRyZW4gKGFuZCBpdHMgZ3JhbmRjaGlsZHJlbikKICogd2lsbCBiZSB1bnN1YnNjcmliZWQgYXMgd2VsbC4KICoKICogQGNsYXNzIFN1YnNjcmlwdGlvbgogKi8KdmFyIFN1YnNjcmlwdGlvbiA9IChmdW5jdGlvbiAoKSB7CiAgICAvKioKICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKTogdm9pZH0gW3Vuc3Vic2NyaWJlXSBBIGZ1bmN0aW9uIGRlc2NyaWJpbmcgaG93IHRvCiAgICAgKiBwZXJmb3JtIHRoZSBkaXNwb3NhbCBvZiByZXNvdXJjZXMgd2hlbiB0aGUgYHVuc3Vic2NyaWJlYCBtZXRob2QgaXMgY2FsbGVkLgogICAgICovCiAgICBmdW5jdGlvbiBTdWJzY3JpcHRpb24odW5zdWJzY3JpYmUpIHsKICAgICAgICAvKioKICAgICAgICAgKiBBIGZsYWcgdG8gaW5kaWNhdGUgd2hldGhlciB0aGlzIFN1YnNjcmlwdGlvbiBoYXMgYWxyZWFkeSBiZWVuIHVuc3Vic2NyaWJlZC4KICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAgICAgKi8KICAgICAgICB0aGlzLmNsb3NlZCA9IGZhbHNlOwogICAgICAgIHRoaXMuX3BhcmVudCA9IG51bGw7CiAgICAgICAgdGhpcy5fcGFyZW50cyA9IG51bGw7CiAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IG51bGw7CiAgICAgICAgaWYgKHVuc3Vic2NyaWJlKSB7CiAgICAgICAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlID0gdW5zdWJzY3JpYmU7CiAgICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNwb3NlcyB0aGUgcmVzb3VyY2VzIGhlbGQgYnkgdGhlIHN1YnNjcmlwdGlvbi4gTWF5LCBmb3IgaW5zdGFuY2UsIGNhbmNlbAogICAgICogYW4gb25nb2luZyBPYnNlcnZhYmxlIGV4ZWN1dGlvbiBvciBjYW5jZWwgYW55IG90aGVyIHR5cGUgb2Ygd29yayB0aGF0CiAgICAgKiBzdGFydGVkIHdoZW4gdGhlIFN1YnNjcmlwdGlvbiB3YXMgY3JlYXRlZC4KICAgICAqIEByZXR1cm4ge3ZvaWR9CiAgICAgKi8KICAgIFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGhhc0Vycm9ycyA9IGZhbHNlOwogICAgICAgIHZhciBlcnJvcnM7CiAgICAgICAgaWYgKHRoaXMuY2xvc2VkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdmFyIF9hID0gdGhpcywgX3BhcmVudCA9IF9hLl9wYXJlbnQsIF9wYXJlbnRzID0gX2EuX3BhcmVudHMsIF91bnN1YnNjcmliZSA9IF9hLl91bnN1YnNjcmliZSwgX3N1YnNjcmlwdGlvbnMgPSBfYS5fc3Vic2NyaXB0aW9uczsKICAgICAgICB0aGlzLmNsb3NlZCA9IHRydWU7CiAgICAgICAgdGhpcy5fcGFyZW50ID0gbnVsbDsKICAgICAgICB0aGlzLl9wYXJlbnRzID0gbnVsbDsKICAgICAgICAvLyBudWxsIG91dCBfc3Vic2NyaXB0aW9ucyBmaXJzdCBzbyBhbnkgY2hpbGQgc3Vic2NyaXB0aW9ucyB0aGF0IGF0dGVtcHQKICAgICAgICAvLyB0byByZW1vdmUgdGhlbXNlbHZlcyBmcm9tIHRoaXMgc3Vic2NyaXB0aW9uIHdpbGwgbm9vcAogICAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMgPSBudWxsOwogICAgICAgIHZhciBpbmRleCA9IC0xOwogICAgICAgIHZhciBsZW4gPSBfcGFyZW50cyA/IF9wYXJlbnRzLmxlbmd0aCA6IDA7CiAgICAgICAgLy8gaWYgdGhpcy5fcGFyZW50IGlzIG51bGwsIHRoZW4gc28gaXMgdGhpcy5fcGFyZW50cywgYW5kIHdlCiAgICAgICAgLy8gZG9uJ3QgaGF2ZSB0byByZW1vdmUgb3Vyc2VsdmVzIGZyb20gYW55IHBhcmVudCBzdWJzY3JpcHRpb25zLgogICAgICAgIHdoaWxlIChfcGFyZW50KSB7CiAgICAgICAgICAgIF9wYXJlbnQucmVtb3ZlKHRoaXMpOwogICAgICAgICAgICAvLyBpZiB0aGlzLl9wYXJlbnRzIGlzIG51bGwgb3IgaW5kZXggPj0gbGVuLAogICAgICAgICAgICAvLyB0aGVuIF9wYXJlbnQgaXMgc2V0IHRvIG51bGwsIGFuZCB0aGUgbG9vcCBleGl0cwogICAgICAgICAgICBfcGFyZW50ID0gKytpbmRleCA8IGxlbiAmJiBfcGFyZW50c1tpbmRleF0gfHwgbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKGlzRnVuY3Rpb25fMS5pc0Z1bmN0aW9uKF91bnN1YnNjcmliZSkpIHsKICAgICAgICAgICAgdmFyIHRyaWFsID0gdHJ5Q2F0Y2hfMS50cnlDYXRjaChfdW5zdWJzY3JpYmUpLmNhbGwodGhpcyk7CiAgICAgICAgICAgIGlmICh0cmlhbCA9PT0gZXJyb3JPYmplY3RfMS5lcnJvck9iamVjdCkgewogICAgICAgICAgICAgICAgaGFzRXJyb3JzID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGVycm9ycyA9IGVycm9ycyB8fCAoZXJyb3JPYmplY3RfMS5lcnJvck9iamVjdC5lIGluc3RhbmNlb2YgVW5zdWJzY3JpcHRpb25FcnJvcl8xLlVuc3Vic2NyaXB0aW9uRXJyb3IgPwogICAgICAgICAgICAgICAgICAgIGZsYXR0ZW5VbnN1YnNjcmlwdGlvbkVycm9ycyhlcnJvck9iamVjdF8xLmVycm9yT2JqZWN0LmUuZXJyb3JzKSA6IFtlcnJvck9iamVjdF8xLmVycm9yT2JqZWN0LmVdKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoaXNBcnJheV8xLmlzQXJyYXkoX3N1YnNjcmlwdGlvbnMpKSB7CiAgICAgICAgICAgIGluZGV4ID0gLTE7CiAgICAgICAgICAgIGxlbiA9IF9zdWJzY3JpcHRpb25zLmxlbmd0aDsKICAgICAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW4pIHsKICAgICAgICAgICAgICAgIHZhciBzdWIgPSBfc3Vic2NyaXB0aW9uc1tpbmRleF07CiAgICAgICAgICAgICAgICBpZiAoaXNPYmplY3RfMS5pc09iamVjdChzdWIpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRyaWFsID0gdHJ5Q2F0Y2hfMS50cnlDYXRjaChzdWIudW5zdWJzY3JpYmUpLmNhbGwoc3ViKTsKICAgICAgICAgICAgICAgICAgICBpZiAodHJpYWwgPT09IGVycm9yT2JqZWN0XzEuZXJyb3JPYmplY3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaGFzRXJyb3JzID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JzID0gZXJyb3JzIHx8IFtdOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyID0gZXJyb3JPYmplY3RfMS5lcnJvck9iamVjdC5lOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgVW5zdWJzY3JpcHRpb25FcnJvcl8xLlVuc3Vic2NyaXB0aW9uRXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoZmxhdHRlblVuc3Vic2NyaXB0aW9uRXJyb3JzKGVyci5lcnJvcnMpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKGVycik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGhhc0Vycm9ycykgewogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdWJzY3JpcHRpb25FcnJvcl8xLlVuc3Vic2NyaXB0aW9uRXJyb3IoZXJyb3JzKTsKICAgICAgICB9CiAgICB9OwogICAgLyoqCiAgICAgKiBBZGRzIGEgdGVhciBkb3duIHRvIGJlIGNhbGxlZCBkdXJpbmcgdGhlIHVuc3Vic2NyaWJlKCkgb2YgdGhpcwogICAgICogU3Vic2NyaXB0aW9uLgogICAgICoKICAgICAqIElmIHRoZSB0ZWFyIGRvd24gYmVpbmcgYWRkZWQgaXMgYSBzdWJzY3JpcHRpb24gdGhhdCBpcyBhbHJlYWR5CiAgICAgKiB1bnN1YnNjcmliZWQsIGlzIHRoZSBzYW1lIHJlZmVyZW5jZSBgYWRkYCBpcyBiZWluZyBjYWxsZWQgb24sIG9yIGlzCiAgICAgKiBgU3Vic2NyaXB0aW9uLkVNUFRZYCwgaXQgd2lsbCBub3QgYmUgYWRkZWQuCiAgICAgKgogICAgICogSWYgdGhpcyBzdWJzY3JpcHRpb24gaXMgYWxyZWFkeSBpbiBhbiBgY2xvc2VkYCBzdGF0ZSwgdGhlIHBhc3NlZAogICAgICogdGVhciBkb3duIGxvZ2ljIHdpbGwgYmUgZXhlY3V0ZWQgaW1tZWRpYXRlbHkuCiAgICAgKgogICAgICogQHBhcmFtIHtUZWFyZG93bkxvZ2ljfSB0ZWFyZG93biBUaGUgYWRkaXRpb25hbCBsb2dpYyB0byBleGVjdXRlIG9uCiAgICAgKiB0ZWFyZG93bi4KICAgICAqIEByZXR1cm4ge1N1YnNjcmlwdGlvbn0gUmV0dXJucyB0aGUgU3Vic2NyaXB0aW9uIHVzZWQgb3IgY3JlYXRlZCB0byBiZQogICAgICogYWRkZWQgdG8gdGhlIGlubmVyIHN1YnNjcmlwdGlvbnMgbGlzdC4gVGhpcyBTdWJzY3JpcHRpb24gY2FuIGJlIHVzZWQgd2l0aAogICAgICogYHJlbW92ZSgpYCB0byByZW1vdmUgdGhlIHBhc3NlZCB0ZWFyZG93biBsb2dpYyBmcm9tIHRoZSBpbm5lciBzdWJzY3JpcHRpb25zCiAgICAgKiBsaXN0LgogICAgICovCiAgICBTdWJzY3JpcHRpb24ucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0ZWFyZG93bikgewogICAgICAgIGlmICghdGVhcmRvd24gfHwgKHRlYXJkb3duID09PSBTdWJzY3JpcHRpb24uRU1QVFkpKSB7CiAgICAgICAgICAgIHJldHVybiBTdWJzY3JpcHRpb24uRU1QVFk7CiAgICAgICAgfQogICAgICAgIGlmICh0ZWFyZG93biA9PT0gdGhpcykgewogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHRlYXJkb3duOwogICAgICAgIHN3aXRjaCAodHlwZW9mIHRlYXJkb3duKSB7CiAgICAgICAgICAgIGNhc2UgJ2Z1bmN0aW9uJzoKICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IG5ldyBTdWJzY3JpcHRpb24odGVhcmRvd24pOwogICAgICAgICAgICBjYXNlICdvYmplY3QnOgogICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5jbG9zZWQgfHwgdHlwZW9mIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmNsb3NlZCkgewogICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygc3Vic2NyaXB0aW9uLl9hZGRQYXJlbnQgIT09ICdmdW5jdGlvbicgLyogcXVhY2sgcXVhY2sgKi8pIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gc3Vic2NyaXB0aW9uOwogICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IG5ldyBTdWJzY3JpcHRpb24oKTsKICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24uX3N1YnNjcmlwdGlvbnMgPSBbdG1wXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bnJlY29nbml6ZWQgdGVhcmRvd24gJyArIHRlYXJkb3duICsgJyBhZGRlZCB0byBTdWJzY3JpcHRpb24uJyk7CiAgICAgICAgfQogICAgICAgIHZhciBzdWJzY3JpcHRpb25zID0gdGhpcy5fc3Vic2NyaXB0aW9ucyB8fCAodGhpcy5fc3Vic2NyaXB0aW9ucyA9IFtdKTsKICAgICAgICBzdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTsKICAgICAgICBzdWJzY3JpcHRpb24uX2FkZFBhcmVudCh0aGlzKTsKICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uOwogICAgfTsKICAgIC8qKgogICAgICogUmVtb3ZlcyBhIFN1YnNjcmlwdGlvbiBmcm9tIHRoZSBpbnRlcm5hbCBsaXN0IG9mIHN1YnNjcmlwdGlvbnMgdGhhdCB3aWxsCiAgICAgKiB1bnN1YnNjcmliZSBkdXJpbmcgdGhlIHVuc3Vic2NyaWJlIHByb2Nlc3Mgb2YgdGhpcyBTdWJzY3JpcHRpb24uCiAgICAgKiBAcGFyYW0ge1N1YnNjcmlwdGlvbn0gc3Vic2NyaXB0aW9uIFRoZSBzdWJzY3JpcHRpb24gdG8gcmVtb3ZlLgogICAgICogQHJldHVybiB7dm9pZH0KICAgICAqLwogICAgU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7CiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSB0aGlzLl9zdWJzY3JpcHRpb25zOwogICAgICAgIGlmIChzdWJzY3JpcHRpb25zKSB7CiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb25JbmRleCA9IHN1YnNjcmlwdGlvbnMuaW5kZXhPZihzdWJzY3JpcHRpb24pOwogICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uSW5kZXggIT09IC0xKSB7CiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb25zLnNwbGljZShzdWJzY3JpcHRpb25JbmRleCwgMSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwogICAgU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5fYWRkUGFyZW50ID0gZnVuY3Rpb24gKHBhcmVudCkgewogICAgICAgIHZhciBfYSA9IHRoaXMsIF9wYXJlbnQgPSBfYS5fcGFyZW50LCBfcGFyZW50cyA9IF9hLl9wYXJlbnRzOwogICAgICAgIGlmICghX3BhcmVudCB8fCBfcGFyZW50ID09PSBwYXJlbnQpIHsKICAgICAgICAgICAgLy8gSWYgd2UgZG9uJ3QgaGF2ZSBhIHBhcmVudCwgb3IgdGhlIG5ldyBwYXJlbnQgaXMgdGhlIHNhbWUgYXMgdGhlCiAgICAgICAgICAgIC8vIGN1cnJlbnQgcGFyZW50LCB0aGVuIHNldCB0aGlzLl9wYXJlbnQgdG8gdGhlIG5ldyBwYXJlbnQuCiAgICAgICAgICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoIV9wYXJlbnRzKSB7CiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3MgYWxyZWFkeSBvbmUgcGFyZW50LCBidXQgbm90IG11bHRpcGxlLCBhbGxvY2F0ZSBhbiBBcnJheSB0bwogICAgICAgICAgICAvLyBzdG9yZSB0aGUgcmVzdCBvZiB0aGUgcGFyZW50IFN1YnNjcmlwdGlvbnMuCiAgICAgICAgICAgIHRoaXMuX3BhcmVudHMgPSBbcGFyZW50XTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoX3BhcmVudHMuaW5kZXhPZihwYXJlbnQpID09PSAtMSkgewogICAgICAgICAgICAvLyBPbmx5IGFkZCB0aGUgbmV3IHBhcmVudCB0byB0aGUgX3BhcmVudHMgbGlzdCBpZiBpdCdzIG5vdCBhbHJlYWR5IHRoZXJlLgogICAgICAgICAgICBfcGFyZW50cy5wdXNoKHBhcmVudCk7CiAgICAgICAgfQogICAgfTsKICAgIFN1YnNjcmlwdGlvbi5FTVBUWSA9IChmdW5jdGlvbiAoZW1wdHkpIHsKICAgICAgICBlbXB0eS5jbG9zZWQgPSB0cnVlOwogICAgICAgIHJldHVybiBlbXB0eTsKICAgIH0obmV3IFN1YnNjcmlwdGlvbigpKSk7CiAgICByZXR1cm4gU3Vic2NyaXB0aW9uOwp9KCkpOwpleHBvcnRzLlN1YnNjcmlwdGlvbiA9IFN1YnNjcmlwdGlvbjsKZnVuY3Rpb24gZmxhdHRlblVuc3Vic2NyaXB0aW9uRXJyb3JzKGVycm9ycykgewogICAgcmV0dXJuIGVycm9ycy5yZWR1Y2UoZnVuY3Rpb24gKGVycnMsIGVycikgeyByZXR1cm4gZXJycy5jb25jYXQoKGVyciBpbnN0YW5jZW9mIFVuc3Vic2NyaXB0aW9uRXJyb3JfMS5VbnN1YnNjcmlwdGlvbkVycm9yKSA/IGVyci5lcnJvcnMgOiBlcnIpOyB9LCBbXSk7Cn0KLy8jIHNvdXJjZU1hcHBpbmdVUkw9U3Vic2NyaXB0aW9uLmpzLm1hcAoKLyoqKi8gfSksCi8qIDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIE9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICogQGhpZGUgdHJ1ZQogKi8KdmFyIEVtcHR5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoRW1wdHlPYnNlcnZhYmxlLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gRW1wdHlPYnNlcnZhYmxlKHNjaGVkdWxlcikgewogICAgICAgIF9zdXBlci5jYWxsKHRoaXMpOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgfQogICAgLyoqCiAgICAgKiBDcmVhdGVzIGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBubyBpdGVtcyB0byB0aGUgT2JzZXJ2ZXIgYW5kIGltbWVkaWF0ZWx5CiAgICAgKiBlbWl0cyBhIGNvbXBsZXRlIG5vdGlmaWNhdGlvbi4KICAgICAqCiAgICAgKiA8c3BhbiBjbGFzcz0iaW5mb3JtYWwiPkp1c3QgZW1pdHMgJ2NvbXBsZXRlJywgYW5kIG5vdGhpbmcgZWxzZS4KICAgICAqIDwvc3Bhbj4KICAgICAqCiAgICAgKiA8aW1nIHNyYz0iLi9pbWcvZW1wdHkucG5nIiB3aWR0aD0iMTAwJSI+CiAgICAgKgogICAgICogVGhpcyBzdGF0aWMgb3BlcmF0b3IgaXMgdXNlZnVsIGZvciBjcmVhdGluZyBhIHNpbXBsZSBPYnNlcnZhYmxlIHRoYXQgb25seQogICAgICogZW1pdHMgdGhlIGNvbXBsZXRlIG5vdGlmaWNhdGlvbi4gSXQgY2FuIGJlIHVzZWQgZm9yIGNvbXBvc2luZyB3aXRoIG90aGVyCiAgICAgKiBPYnNlcnZhYmxlcywgc3VjaCBhcyBpbiBhIHtAbGluayBtZXJnZU1hcH0uCiAgICAgKgogICAgICogQGV4YW1wbGUgPGNhcHRpb24+RW1pdCB0aGUgbnVtYmVyIDcsIHRoZW4gY29tcGxldGUuPC9jYXB0aW9uPgogICAgICogdmFyIHJlc3VsdCA9IFJ4Lk9ic2VydmFibGUuZW1wdHkoKS5zdGFydFdpdGgoNyk7CiAgICAgKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpOwogICAgICoKICAgICAqIEBleGFtcGxlIDxjYXB0aW9uPk1hcCBhbmQgZmxhdHRlbiBvbmx5IG9kZCBudW1iZXJzIHRvIHRoZSBzZXF1ZW5jZSAnYScsICdiJywgJ2MnPC9jYXB0aW9uPgogICAgICogdmFyIGludGVydmFsID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDAwKTsKICAgICAqIHZhciByZXN1bHQgPSBpbnRlcnZhbC5tZXJnZU1hcCh4ID0+CiAgICAgKiAgIHggJSAyID09PSAxID8gUnguT2JzZXJ2YWJsZS5vZignYScsICdiJywgJ2MnKSA6IFJ4Lk9ic2VydmFibGUuZW1wdHkoKQogICAgICogKTsKICAgICAqIHJlc3VsdC5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSk7CiAgICAgKgogICAgICogLy8gUmVzdWx0cyBpbiB0aGUgZm9sbG93aW5nIHRvIHRoZSBjb25zb2xlOgogICAgICogLy8geCBpcyBlcXVhbCB0byB0aGUgY291bnQgb24gdGhlIGludGVydmFsIGVnKDAsMSwyLDMsLi4uKQogICAgICogLy8geCB3aWxsIG9jY3VyIGV2ZXJ5IDEwMDBtcwogICAgICogLy8gaWYgeCAlIDIgaXMgZXF1YWwgdG8gMSBwcmludCBhYmMKICAgICAqIC8vIGlmIHggJSAyIGlzIG5vdCBlcXVhbCB0byAxIG5vdGhpbmcgd2lsbCBiZSBvdXRwdXQKICAgICAqCiAgICAgKiBAc2VlIHtAbGluayBjcmVhdGV9CiAgICAgKiBAc2VlIHtAbGluayBuZXZlcn0KICAgICAqIEBzZWUge0BsaW5rIG9mfQogICAgICogQHNlZSB7QGxpbmsgdGhyb3d9CiAgICAgKgogICAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIEEge0BsaW5rIElTY2hlZHVsZXJ9IHRvIHVzZSBmb3Igc2NoZWR1bGluZwogICAgICogdGhlIGVtaXNzaW9uIG9mIHRoZSBjb21wbGV0ZSBub3RpZmljYXRpb24uCiAgICAgKiBAcmV0dXJuIHtPYnNlcnZhYmxlfSBBbiAiZW1wdHkiIE9ic2VydmFibGU6IGVtaXRzIG9ubHkgdGhlIGNvbXBsZXRlCiAgICAgKiBub3RpZmljYXRpb24uCiAgICAgKiBAc3RhdGljIHRydWUKICAgICAqIEBuYW1lIGVtcHR5CiAgICAgKiBAb3duZXIgT2JzZXJ2YWJsZQogICAgICovCiAgICBFbXB0eU9ic2VydmFibGUuY3JlYXRlID0gZnVuY3Rpb24gKHNjaGVkdWxlcikgewogICAgICAgIHJldHVybiBuZXcgRW1wdHlPYnNlcnZhYmxlKHNjaGVkdWxlcik7CiAgICB9OwogICAgRW1wdHlPYnNlcnZhYmxlLmRpc3BhdGNoID0gZnVuY3Rpb24gKGFyZykgewogICAgICAgIHZhciBzdWJzY3JpYmVyID0gYXJnLnN1YnNjcmliZXI7CiAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgfTsKICAgIEVtcHR5T2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7CiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyOwogICAgICAgIGlmIChzY2hlZHVsZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZShFbXB0eU9ic2VydmFibGUuZGlzcGF0Y2gsIDAsIHsgc3Vic2NyaWJlcjogc3Vic2NyaWJlciB9KTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICB9CiAgICB9OwogICAgcmV0dXJuIEVtcHR5T2JzZXJ2YWJsZTsKfShPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkpOwpleHBvcnRzLkVtcHR5T2JzZXJ2YWJsZSA9IEVtcHR5T2JzZXJ2YWJsZTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9RW1wdHlPYnNlcnZhYmxlLmpzLm1hcAoKLyoqKi8gfSksCi8qIDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHJvb3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CmZ1bmN0aW9uIHN5bWJvbEl0ZXJhdG9yUG9ueWZpbGwocm9vdCkgewogICAgdmFyIFN5bWJvbCA9IHJvb3QuU3ltYm9sOwogICAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBpZiAoIVN5bWJvbC5pdGVyYXRvcikgewogICAgICAgICAgICBTeW1ib2wuaXRlcmF0b3IgPSBTeW1ib2woJ2l0ZXJhdG9yIHBvbHlmaWxsJyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBTeW1ib2wuaXRlcmF0b3I7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICAvLyBbZm9yIE1vemlsbGEgR2Vja28gMjctMzU6XShodHRwczovL216bC5sYS8yZXdFMXpDKQogICAgICAgIHZhciBTZXRfMSA9IHJvb3QuU2V0OwogICAgICAgIGlmIChTZXRfMSAmJiB0eXBlb2YgbmV3IFNldF8xKClbJ0BAaXRlcmF0b3InXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICByZXR1cm4gJ0BAaXRlcmF0b3InOwogICAgICAgIH0KICAgICAgICB2YXIgTWFwXzEgPSByb290Lk1hcDsKICAgICAgICAvLyByZXF1aXJlZCBmb3IgY29tcGF0YWJpbGl0eSB3aXRoIGVzNi1zaGltCiAgICAgICAgaWYgKE1hcF8xKSB7CiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTWFwXzEucHJvdG90eXBlKTsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTsKICAgICAgICAgICAgICAgIC8vIGFjY29yZGluZyB0byBzcGVjLCBNYXAucHJvdG90eXBlW0BAaXRlcmF0b3JdIGFuZCBNYXAub3JvdG90eXBlLmVudHJpZXMgbXVzdCBiZSBlcXVhbC4KICAgICAgICAgICAgICAgIGlmIChrZXkgIT09ICdlbnRyaWVzJyAmJiBrZXkgIT09ICdzaXplJyAmJiBNYXBfMS5wcm90b3R5cGVba2V5XSA9PT0gTWFwXzEucHJvdG90eXBlWydlbnRyaWVzJ10pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAnQEBpdGVyYXRvcic7CiAgICB9Cn0KZXhwb3J0cy5zeW1ib2xJdGVyYXRvclBvbnlmaWxsID0gc3ltYm9sSXRlcmF0b3JQb255ZmlsbDsKZXhwb3J0cy4kJGl0ZXJhdG9yID0gc3ltYm9sSXRlcmF0b3JQb255ZmlsbChyb290XzEucm9vdCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWl0ZXJhdG9yLmpzLm1hcAoKLyoqKi8gfSksCi8qIDggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHJvb3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CmZ1bmN0aW9uIGdldFN5bWJvbE9ic2VydmFibGUoY29udGV4dCkgewogICAgdmFyICQkb2JzZXJ2YWJsZTsKICAgIHZhciBTeW1ib2wgPSBjb250ZXh0LlN5bWJvbDsKICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgaWYgKFN5bWJvbC5vYnNlcnZhYmxlKSB7CiAgICAgICAgICAgICQkb2JzZXJ2YWJsZSA9IFN5bWJvbC5vYnNlcnZhYmxlOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJCRvYnNlcnZhYmxlID0gU3ltYm9sKCdvYnNlcnZhYmxlJyk7CiAgICAgICAgICAgIFN5bWJvbC5vYnNlcnZhYmxlID0gJCRvYnNlcnZhYmxlOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgICQkb2JzZXJ2YWJsZSA9ICdAQG9ic2VydmFibGUnOwogICAgfQogICAgcmV0dXJuICQkb2JzZXJ2YWJsZTsKfQpleHBvcnRzLmdldFN5bWJvbE9ic2VydmFibGUgPSBnZXRTeW1ib2xPYnNlcnZhYmxlOwpleHBvcnRzLiQkb2JzZXJ2YWJsZSA9IGdldFN5bWJvbE9ic2VydmFibGUocm9vdF8xLnJvb3QpOwovLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZhYmxlLmpzLm1hcAoKLyoqKi8gfSksCi8qIDkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKLy8gdHlwZW9mIGFueSBzbyB0aGF0IGl0IHdlIGRvbid0IGhhdmUgdG8gY2FzdCB3aGVuIGNvbXBhcmluZyBhIHJlc3VsdCB0byB0aGUgZXJyb3Igb2JqZWN0CmV4cG9ydHMuZXJyb3JPYmplY3QgPSB7IGU6IHt9IH07Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWVycm9yT2JqZWN0LmpzLm1hcAoKLyoqKi8gfSksCi8qIDEwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCmV4cG9ydHMuaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4ICYmIHR5cGVvZiB4Lmxlbmd0aCA9PT0gJ251bWJlcic7IH0pOwovLyMgc291cmNlTWFwcGluZ1VSTD1pc0FycmF5LmpzLm1hcAoKLyoqKi8gfSksCi8qIDExICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCmZ1bmN0aW9uIGlzRnVuY3Rpb24oeCkgewogICAgcmV0dXJuIHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nOwp9CmV4cG9ydHMuaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzRnVuY3Rpb24uanMubWFwCgovKioqLyB9KSwKLyogMTIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKdmFyIF8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKTsKdmFyIE9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7CnZhciBIdHRwID0gKGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIEh0dHAob3B0aW9ucykgewogICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CiAgICB9CiAgICBIdHRwLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gKHJlcXVlc3RPcHRpb25zKSB7CiAgICAgICAgdmFyIG9wdGlvbnMgPSBfLmV4dGVuZCh7fSwgdGhpcy5vcHRpb25zLCByZXF1ZXN0T3B0aW9ucyk7CiAgICAgICAgdmFyIG9ucmVhZHlzdGF0ZWNoYW5nZSA9IG9wdGlvbnMub25yZWFkeXN0YXRlY2hhbmdlLCBvbmVycm9yID0gb3B0aW9ucy5vbmVycm9yLCBvbmFib3J0ID0gb3B0aW9ucy5vbmFib3J0LCBvbnRpbWVvdXQgPSBvcHRpb25zLm9udGltZW91dDsKICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuY3JlYXRlKGZ1bmN0aW9uIChvYnNlcnZlcikgewogICAgICAgICAgICAvLyBvcHRpb25zLnN5bmNocm9ub3VzID0gdHJ1ZTsgICAvLyBhc3luYwogICAgICAgICAgICBvcHRpb25zLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgXy5pc0Z1bmN0aW9uKG9ucmVhZHlzdGF0ZWNoYW5nZSkgJiYgb25yZWFkeXN0YXRlY2hhbmdlLmNhbGwodGhpcywgcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlYWR5U3RhdGUgIT09IDQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXMgPCA0MDAgJiYgcmVzcG9uc2UuZmluYWxVcmwgPyBvYnNlcnZlci5uZXh0KHJlc3BvbnNlKSA6IG9ic2VydmVyLmVycm9yKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIG9wdGlvbnMub25lcnJvciA9IGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgXy5pc0Z1bmN0aW9uKG9uZXJyb3IpICYmIG9uZXJyb3IuY2FsbCh0aGlzLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihyZXNwb25zZSk7CiAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpOwogICAgICAgICAgICB9OwogICAgICAgICAgICBvcHRpb25zLm9uYWJvcnQgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIF8uaXNGdW5jdGlvbihvbmFib3J0KSAmJiBvbmFib3J0LmNhbGwodGhpcywgcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgb3B0aW9ucy5vbnRpbWVvdXQgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIF8uaXNGdW5jdGlvbihvbnRpbWVvdXQpICYmIG9udGltZW91dC5jYWxsKHRoaXMsIHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0KF8uZXh0ZW5kKHt9LCBvcHRpb25zKSk7CiAgICAgICAgfSk7CiAgICB9OwogICAgSHR0cC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHVybCwgb3B0aW9ucykgewogICAgICAgIHZhciByZXF1ZXN0T3B0aW9ucyA9IF8uZXh0ZW5kKG9wdGlvbnMgfHwge30sIHsgdXJsOiB1cmwsIG1ldGhvZDogJ0dFVCcgfSk7CiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7CiAgICB9OwogICAgSHR0cC5wcm90b3R5cGUucG9zdCA9IGZ1bmN0aW9uICh1cmwsIGRhdGEsIG9wdGlvbnMpIHsKICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KF8uZXh0ZW5kKG9wdGlvbnMgfHwge30sIHsgdXJsOiB1cmwsIG1ldGhvZDogJ1BPU1QnLCBkYXRhOiBkYXRhIH0pKTsKICAgIH07CiAgICBIdHRwLnByb3RvdHlwZS5oZWFkID0gZnVuY3Rpb24gKHVybCwgb3B0aW9ucykgewogICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoXy5leHRlbmQob3B0aW9ucyB8fCB7fSwgeyB1cmw6IHVybCwgbWV0aG9kOiAnSEVBRCcgfSkpOwogICAgfTsKICAgIHJldHVybiBIdHRwOwp9KCkpOwp2YXIgdGltZW91dCA9IDUwMDA7CmV4cG9ydHMudGltZW91dCA9IHRpbWVvdXQ7CnZhciBodHRwID0gbmV3IEh0dHAoeyB0aW1lb3V0OiB0aW1lb3V0IH0pOwpleHBvcnRzLmh0dHAgPSBodHRwOwoKCi8qKiovIH0pLAovKiAxMyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGh0dHBfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpOwp2YXIgbG9nXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTsKdmFyIGNvbmZpZ18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNyk7CnZhciBERUJVRyA9IGNvbmZpZ18xLkNPTkZJRy5kZWJ1ZzsKdmFyIHN0YXR1cyA9IHsKICAgIGluZzogJ3JlZGlyZWN0LWluZycsCiAgICBkb25lOiAncmVkaXJlY3QtZG9uZScKfTsKdmFyIGludmlldzsKdmFyIFJlZGlyZWN0T25SZXF1ZXN0ID0gKGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFJlZGlyZWN0T25SZXF1ZXN0KGRvbWFpblRlc3RlciwgdXJsVGVzdGVyLCBtYXRjaGVyLCBBU2VsZWN0b3IpIHsKICAgICAgICB0aGlzLmRvbWFpblRlc3RlciA9IGRvbWFpblRlc3RlcjsKICAgICAgICB0aGlzLnVybFRlc3RlciA9IHVybFRlc3RlcjsKICAgICAgICB0aGlzLm1hdGNoZXIgPSBtYXRjaGVyOwogICAgICAgIHRoaXMuQVNlbGVjdG9yID0gQVNlbGVjdG9yOwogICAgICAgIHRoaXMuREVCVUcgPSBERUJVRzsKICAgICAgICB0aGlzLnN0YXR1cyA9IHN0YXR1czsKICAgICAgICB0aGlzLkFTZWxlY3RvciA9IHRoaXMuQVNlbGVjdG9yIHx8ICdhJzsKICAgICAgICB0aGlzLm1hdGNoID0gZG9tYWluVGVzdGVyLnRlc3QoZG9jdW1lbnQuZG9tYWluKTsKICAgIH0KICAgIFJlZGlyZWN0T25SZXF1ZXN0LnByb3RvdHlwZS5oYW5kbGVyT25lUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIHJlczsKICAgIH07CiAgICBSZWRpcmVjdE9uUmVxdWVzdC5wcm90b3R5cGUuaGFuZGxlck9uZSA9IGZ1bmN0aW9uIChhRWxlbWVudCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgaWYgKCF0aGlzLnVybFRlc3Rlci50ZXN0KGFFbGVtZW50LmhyZWYpIHx8IGFFbGVtZW50LmdldEF0dHJpYnV0ZShzdGF0dXMuaW5nKSB8fCBhRWxlbWVudC5nZXRBdHRyaWJ1dGUoc3RhdHVzLmRvbmUpKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgdmFyIHByb3RvY29sID0gbG9jYXRpb24ucHJvdG9jb2wucmVwbGFjZSgvOiQvLCAnJyk7IC8vIGluIGNocm9tZVs6aHR0cF0sIGJ1dCBpbiBmaXJlZm94IGlzOltodHRwOl0KICAgICAgICB2YXIgdXJsID0gYUVsZW1lbnQuaHJlZi5yZXBsYWNlKC9eaHR0cHM/LywgcHJvdG9jb2wpICsgKCImdGltZXN0YW1wPSIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKSk7CiAgICAgICAgYUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gJ3Byb2dyZXNzJzsKICAgICAgICBhRWxlbWVudC5zZXRBdHRyaWJ1dGUoc3RhdHVzLmluZywgJzEnKTsKICAgICAgICByZXR1cm4gaHR0cF8xLmh0dHAuZ2V0KHVybCkKICAgICAgICAgICAgLnJldHJ5KDIpCiAgICAgICAgICAgIC50aW1lb3V0KGh0dHBfMS50aW1lb3V0KQogICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChyZXMpIHsgcmV0dXJuIF90aGlzLmhhbmRsZXJPbmVSZXNwb25zZShyZXMpOyB9KQogICAgICAgICAgICAuZG8oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBpZiAoX3RoaXMudXJsVGVzdGVyLnRlc3QocmVzLmZpbmFsVXJsKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBmaW5hbCB1cmwnKTsKICAgICAgICB9KQogICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgX3RoaXMudXJsVGVzdGVyLnRlc3QoYUVsZW1lbnQuaHJlZikgJiYgYUVsZW1lbnQuc2V0QXR0cmlidXRlKCdvcmlnaW4taHJlZicsIGFFbGVtZW50LmhyZWYpOwogICAgICAgICAgICBhRWxlbWVudC5ocmVmID0gcmVzLmZpbmFsVXJsOwogICAgICAgICAgICBhRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoc3RhdHVzLmluZyk7CiAgICAgICAgICAgIGFFbGVtZW50LnNldEF0dHJpYnV0ZShzdGF0dXMuZG9uZSwgJzEnKTsKICAgICAgICAgICAgREVCVUcgJiYgKGFFbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmVlbicpOwogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gbnVsbDsKICAgICAgICAgICAgYUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHN0YXR1cy5pbmcpOwogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYUVsZW1lbnQuc3R5bGUuY3Vyc29yID0gbnVsbDsKICAgICAgICAgICAgYUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHN0YXR1cy5pbmcpOwogICAgICAgIH0pOwogICAgfTsKICAgIFJlZGlyZWN0T25SZXF1ZXN0LnByb3RvdHlwZS5oYW5kbGVyT25lQnlPbmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuZnJvbShbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5BU2VsZWN0b3IpKSkKICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAoYUVsZW1lbnQpIHsKICAgICAgICAgICAgaW52aWV3ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7CiAgICAgICAgICAgIGludmlldyAmJiBpbnZpZXcuaXMoYUVsZW1lbnQpICYmIF90aGlzLmhhbmRsZXJPbmUoYUVsZW1lbnQpOwogICAgICAgIH0pOwogICAgfTsKICAgIFJlZGlyZWN0T25SZXF1ZXN0LnByb3RvdHlwZS5vbkluaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGFnbSA9IFtdOwogICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICAgIGFnbVtfaV0gPSBhcmd1bWVudHNbX2ldOwogICAgICAgIH0KICAgIH07CiAgICBSZWRpcmVjdE9uUmVxdWVzdC5wcm90b3R5cGUuc2Nyb2xsID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgcmV0dXJuIE9ic2VydmFibGVfMS5PYnNlcnZhYmxlLmZyb21FdmVudCh3aW5kb3csICdzY3JvbGwnKQogICAgICAgICAgICAuZGVib3VuY2VUaW1lKDIwMCkKICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzLmhhbmRsZXJPbmVCeU9uZSgpOwogICAgICAgIH0pOwogICAgfTsKICAgIFJlZGlyZWN0T25SZXF1ZXN0LnByb3RvdHlwZS5tb3VzZW92ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuZnJvbUV2ZW50KGRvY3VtZW50LCAnbW91c2Vtb3ZlJykKICAgICAgICAgICAgLnRocm90dGxlVGltZSgxMDApCiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBldmVudC50b0VsZW1lbnQ7CiAgICAgICAgICAgIHJldHVybiB0YXJnZXQubm9kZU5hbWUgPT09ICdBJyA/IHRhcmdldCA6IHRhcmdldC5wYXJlbnROb2RlLm5vZGVOYW1lID09PSAnQScgPyB0YXJnZXQucGFyZW50Tm9kZSA6IHRhcmdldDsKICAgICAgICB9KQogICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChlbGUpIHsgcmV0dXJuIGVsZS5ub2RlTmFtZSA9PT0gJ0EnOyB9KQogICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uIChhRWxlKSB7CiAgICAgICAgICAgIF90aGlzLmhhbmRsZXJPbmUoYUVsZSk7CiAgICAgICAgfSk7CiAgICB9OwogICAgUmVkaXJlY3RPblJlcXVlc3QucHJvdG90eXBlLmJvb3RzdHJhcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgIGlmICghdGhpcy5tYXRjaCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIE9ic2VydmFibGVfMS5PYnNlcnZhYmxlLmZyb21FdmVudChkb2N1bWVudCwgJ0RPTUNvbnRlbnRMb2FkZWQnKQogICAgICAgICAgICAudGhyb3R0bGVUaW1lKDIwMCkKICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzLm9uSW5pdCgpOwogICAgICAgICAgICBfdGhpcy5zY3JvbGwoKTsKICAgICAgICAgICAgX3RoaXMubW91c2VvdmVyKCk7CiAgICAgICAgICAgIF90aGlzLmhhbmRsZXJPbmVCeU9uZSgpOwogICAgICAgICAgICBPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7CiAgICAgICAgICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAobXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG11dGF0aW9ucyA9PT0gdm9pZCAwKSB7IG11dGF0aW9ucyA9IFtdOyB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLm5leHQoKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBjaGlsZExpc3Q6IHRydWUgfSk7CiAgICAgICAgICAgIH0pLmRlYm91bmNlVGltZSgxMDApCiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIF90aGlzLm9uSW5pdCgpOwogICAgICAgICAgICAgICAgX3RoaXMuaGFuZGxlck9uZUJ5T25lKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsb2dfMS5sb2coKTsKICAgICAgICB9KTsKICAgIH07CiAgICByZXR1cm4gUmVkaXJlY3RPblJlcXVlc3Q7Cn0oKSk7CmV4cG9ydHMuUmVkaXJlY3RPblJlcXVlc3QgPSBSZWRpcmVjdE9uUmVxdWVzdDsKCgovKioqLyB9KSwKLyogMTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKLyohCiAqIGluLXZpZXcgMC42LjEgLSBHZXQgbm90aWZpZWQgd2hlbiBhIERPTSBlbGVtZW50IGVudGVycyBvciBleGl0cyB0aGUgdmlld3BvcnQuCiAqIENvcHlyaWdodCAoYykgMjAxNiBDYW0gV2llZ2VydCA8Y2FtQGNhbXdpZWdlcnQuY29tPiAtIGh0dHBzOi8vY2Ftd2llZ2VydC5naXRodWIuaW8vaW4tdmlldwogKiBMaWNlbnNlOiBNSVQKICovCiFmdW5jdGlvbih0LGUpeyB0cnVlP21vZHVsZS5leHBvcnRzPWUoKToiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXSxlKToib2JqZWN0Ij09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5pblZpZXc9ZSgpOnQuaW5WaWV3PWUoKX0odGhpcyxmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHIpe2lmKG5bcl0pcmV0dXJuIG5bcl0uZXhwb3J0czt2YXIgaT1uW3JdPXtleHBvcnRzOnt9LGlkOnIsbG9hZGVkOiExfTtyZXR1cm4gdFtyXS5jYWxsKGkuZXhwb3J0cyxpLGkuZXhwb3J0cyxlKSxpLmxvYWRlZD0hMCxpLmV4cG9ydHN9dmFyIG49e307cmV0dXJuIGUubT10LGUuYz1uLGUucD0iIixlKDApfShbZnVuY3Rpb24odCxlLG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ImRlZmF1bHQiOnR9fXZhciBpPW4oMiksbz1yKGkpO3QuZXhwb3J0cz1vWyJkZWZhdWx0Il19LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbih0KXt2YXIgZT10eXBlb2YgdDtyZXR1cm4gbnVsbCE9dCYmKCJvYmplY3QiPT1lfHwiZnVuY3Rpb24iPT1lKX10LmV4cG9ydHM9bn0sZnVuY3Rpb24odCxlLG4peyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKHQpe3JldHVybiB0JiZ0Ll9fZXNNb2R1bGU/dDp7ImRlZmF1bHQiOnR9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KTt2YXIgaT1uKDkpLG89cihpKSx1PW4oMyksZj1yKHUpLHM9big0KSxjPWZ1bmN0aW9uKCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cpe3ZhciB0PTEwMCxlPVsic2Nyb2xsIiwicmVzaXplIiwibG9hZCJdLG49e2hpc3Rvcnk6W119LHI9e29mZnNldDp7fSx0aHJlc2hvbGQ6MCx0ZXN0OnMuaW5WaWV3cG9ydH0saT0oMCxvWyJkZWZhdWx0Il0pKGZ1bmN0aW9uKCl7bi5oaXN0b3J5LmZvckVhY2goZnVuY3Rpb24odCl7blt0XS5jaGVjaygpfSl9LHQpO2UuZm9yRWFjaChmdW5jdGlvbih0KXtyZXR1cm4gYWRkRXZlbnRMaXN0ZW5lcih0LGkpfSksd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXImJmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLGZ1bmN0aW9uKCl7bmV3IE11dGF0aW9uT2JzZXJ2ZXIoaSkub2JzZXJ2ZShkb2N1bWVudC5ib2R5LHthdHRyaWJ1dGVzOiEwLGNoaWxkTGlzdDohMCxzdWJ0cmVlOiEwfSl9KTt2YXIgdT1mdW5jdGlvbih0KXtpZigic3RyaW5nIj09dHlwZW9mIHQpe3ZhciBlPVtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0KSk7cmV0dXJuIG4uaGlzdG9yeS5pbmRleE9mKHQpPi0xP25bdF0uZWxlbWVudHM9ZTooblt0XT0oMCxmWyJkZWZhdWx0Il0pKGUsciksbi5oaXN0b3J5LnB1c2godCkpLG5bdF19fTtyZXR1cm4gdS5vZmZzZXQ9ZnVuY3Rpb24odCl7aWYodm9pZCAwPT09dClyZXR1cm4gci5vZmZzZXQ7dmFyIGU9ZnVuY3Rpb24odCl7cmV0dXJuIm51bWJlciI9PXR5cGVvZiB0fTtyZXR1cm5bInRvcCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCJdLmZvckVhY2goZSh0KT9mdW5jdGlvbihlKXtyZXR1cm4gci5vZmZzZXRbZV09dH06ZnVuY3Rpb24obil7cmV0dXJuIGUodFtuXSk/ci5vZmZzZXRbbl09dFtuXTpudWxsfSksci5vZmZzZXR9LHUudGhyZXNob2xkPWZ1bmN0aW9uKHQpe3JldHVybiJudW1iZXIiPT10eXBlb2YgdCYmdD49MCYmdDw9MT9yLnRocmVzaG9sZD10OnIudGhyZXNob2xkfSx1LnRlc3Q9ZnVuY3Rpb24odCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHQ/ci50ZXN0PXQ6ci50ZXN0fSx1LmlzPWZ1bmN0aW9uKHQpe3JldHVybiByLnRlc3QodCxyKX0sdS5vZmZzZXQoMCksdX19O2VbImRlZmF1bHQiXT1jKCl9LGZ1bmN0aW9uKHQsZSl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4odCxlKXtpZighKHQgaW5zdGFuY2VvZiBlKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKX1PYmplY3QuZGVmaW5lUHJvcGVydHkoZSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSk7dmFyIHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspe3ZhciByPWVbbl07ci5lbnVtZXJhYmxlPXIuZW51bWVyYWJsZXx8ITEsci5jb25maWd1cmFibGU9ITAsInZhbHVlImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxyLmtleSxyKX19cmV0dXJuIGZ1bmN0aW9uKGUsbixyKXtyZXR1cm4gbiYmdChlLnByb3RvdHlwZSxuKSxyJiZ0KGUsciksZX19KCksaT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSxyKXtuKHRoaXMsdCksdGhpcy5vcHRpb25zPXIsdGhpcy5lbGVtZW50cz1lLHRoaXMuY3VycmVudD1bXSx0aGlzLmhhbmRsZXJzPXtlbnRlcjpbXSxleGl0OltdfSx0aGlzLnNpbmdsZXM9e2VudGVyOltdLGV4aXQ6W119fXJldHVybiByKHQsW3trZXk6ImNoZWNrIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgbj10Lm9wdGlvbnMudGVzdChlLHQub3B0aW9ucykscj10LmN1cnJlbnQuaW5kZXhPZihlKSxpPXI+LTEsbz1uJiYhaSx1PSFuJiZpO28mJih0LmN1cnJlbnQucHVzaChlKSx0LmVtaXQoImVudGVyIixlKSksdSYmKHQuY3VycmVudC5zcGxpY2UociwxKSx0LmVtaXQoImV4aXQiLGUpKX0pLHRoaXN9fSx7a2V5OiJvbiIsdmFsdWU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5oYW5kbGVyc1t0XS5wdXNoKGUpLHRoaXN9fSx7a2V5OiJvbmNlIix2YWx1ZTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNpbmdsZXNbdF0udW5zaGlmdChlKSx0aGlzfX0se2tleToiZW1pdCIsdmFsdWU6ZnVuY3Rpb24odCxlKXtmb3IoO3RoaXMuc2luZ2xlc1t0XS5sZW5ndGg7KXRoaXMuc2luZ2xlc1t0XS5wb3AoKShlKTtmb3IodmFyIG49dGhpcy5oYW5kbGVyc1t0XS5sZW5ndGg7LS1uPi0xOyl0aGlzLmhhbmRsZXJzW3RdW25dKGUpO3JldHVybiB0aGlzfX1dKSx0fSgpO2VbImRlZmF1bHQiXT1mdW5jdGlvbih0LGUpe3JldHVybiBuZXcgaSh0LGUpfX0sZnVuY3Rpb24odCxlKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbih0LGUpe3ZhciBuPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkscj1uLnRvcCxpPW4ucmlnaHQsbz1uLmJvdHRvbSx1PW4ubGVmdCxmPW4ud2lkdGgscz1uLmhlaWdodCxjPXt0Om8scjp3aW5kb3cuaW5uZXJXaWR0aC11LGI6d2luZG93LmlubmVySGVpZ2h0LXIsbDppfSxhPXt4OmUudGhyZXNob2xkKmYseTplLnRocmVzaG9sZCpzfTtyZXR1cm4gYy50PmUub2Zmc2V0LnRvcCthLnkmJmMucj5lLm9mZnNldC5yaWdodCthLngmJmMuYj5lLm9mZnNldC5ib3R0b20rYS55JiZjLmw+ZS5vZmZzZXQubGVmdCthLnh9T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLGUuaW5WaWV3cG9ydD1ufSxmdW5jdGlvbih0LGUpeyhmdW5jdGlvbihlKXt2YXIgbj0ib2JqZWN0Ij09dHlwZW9mIGUmJmUmJmUuT2JqZWN0PT09T2JqZWN0JiZlO3QuZXhwb3J0cz1ufSkuY2FsbChlLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KCkpfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big1KSxpPSJvYmplY3QiPT10eXBlb2Ygc2VsZiYmc2VsZiYmc2VsZi5PYmplY3Q9PT1PYmplY3QmJnNlbGYsbz1yfHxpfHxGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpO3QuZXhwb3J0cz1vfSxmdW5jdGlvbih0LGUsbil7ZnVuY3Rpb24gcih0LGUsbil7ZnVuY3Rpb24gcihlKXt2YXIgbj14LHI9bTtyZXR1cm4geD1tPXZvaWQgMCxFPWUsdz10LmFwcGx5KHIsbil9ZnVuY3Rpb24gYSh0KXtyZXR1cm4gRT10LGo9c2V0VGltZW91dChoLGUpLE0/cih0KTp3fWZ1bmN0aW9uIGwodCl7dmFyIG49dC1PLHI9dC1FLGk9ZS1uO3JldHVybiBfP2MoaSxnLXIpOml9ZnVuY3Rpb24gZCh0KXt2YXIgbj10LU8scj10LUU7cmV0dXJuIHZvaWQgMD09PU98fG4+PWV8fG48MHx8XyYmcj49Z31mdW5jdGlvbiBoKCl7dmFyIHQ9bygpO3JldHVybiBkKHQpP3AodCk6dm9pZChqPXNldFRpbWVvdXQoaCxsKHQpKSl9ZnVuY3Rpb24gcCh0KXtyZXR1cm4gaj12b2lkIDAsVCYmeD9yKHQpOih4PW09dm9pZCAwLHcpfWZ1bmN0aW9uIHYoKXt2b2lkIDAhPT1qJiZjbGVhclRpbWVvdXQoaiksRT0wLHg9Tz1tPWo9dm9pZCAwfWZ1bmN0aW9uIHkoKXtyZXR1cm4gdm9pZCAwPT09aj93OnAobygpKX1mdW5jdGlvbiBiKCl7dmFyIHQ9bygpLG49ZCh0KTtpZih4PWFyZ3VtZW50cyxtPXRoaXMsTz10LG4pe2lmKHZvaWQgMD09PWopcmV0dXJuIGEoTyk7aWYoXylyZXR1cm4gaj1zZXRUaW1lb3V0KGgsZSkscihPKX1yZXR1cm4gdm9pZCAwPT09aiYmKGo9c2V0VGltZW91dChoLGUpKSx3fXZhciB4LG0sZyx3LGosTyxFPTAsTT0hMSxfPSExLFQ9ITA7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQpdGhyb3cgbmV3IFR5cGVFcnJvcihmKTtyZXR1cm4gZT11KGUpfHwwLGkobikmJihNPSEhbi5sZWFkaW5nLF89Im1heFdhaXQiaW4gbixnPV8/cyh1KG4ubWF4V2FpdCl8fDAsZSk6ZyxUPSJ0cmFpbGluZyJpbiBuPyEhbi50cmFpbGluZzpUKSxiLmNhbmNlbD12LGIuZmx1c2g9eSxifXZhciBpPW4oMSksbz1uKDgpLHU9bigxMCksZj0iRXhwZWN0ZWQgYSBmdW5jdGlvbiIscz1NYXRoLm1heCxjPU1hdGgubWluO3QuZXhwb3J0cz1yfSxmdW5jdGlvbih0LGUsbil7dmFyIHI9big2KSxpPWZ1bmN0aW9uKCl7cmV0dXJuIHIuRGF0ZS5ub3coKX07dC5leHBvcnRzPWl9LGZ1bmN0aW9uKHQsZSxuKXtmdW5jdGlvbiByKHQsZSxuKXt2YXIgcj0hMCxmPSEwO2lmKCJmdW5jdGlvbiIhPXR5cGVvZiB0KXRocm93IG5ldyBUeXBlRXJyb3IodSk7cmV0dXJuIG8obikmJihyPSJsZWFkaW5nImluIG4/ISFuLmxlYWRpbmc6cixmPSJ0cmFpbGluZyJpbiBuPyEhbi50cmFpbGluZzpmKSxpKHQsZSx7bGVhZGluZzpyLG1heFdhaXQ6ZSx0cmFpbGluZzpmfSl9dmFyIGk9big3KSxvPW4oMSksdT0iRXhwZWN0ZWQgYSBmdW5jdGlvbiI7dC5leHBvcnRzPXJ9LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gbih0KXtyZXR1cm4gdH10LmV4cG9ydHM9bn1dKX0pOwoKLyoqKi8gfSksCi8qIDE1ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwovKioKICogUmVwcmVzZW50cyBhIHB1c2gtYmFzZWQgZXZlbnQgb3IgdmFsdWUgdGhhdCBhbiB7QGxpbmsgT2JzZXJ2YWJsZX0gY2FuIGVtaXQuCiAqIFRoaXMgY2xhc3MgaXMgcGFydGljdWxhcmx5IHVzZWZ1bCBmb3Igb3BlcmF0b3JzIHRoYXQgbWFuYWdlIG5vdGlmaWNhdGlvbnMsCiAqIGxpa2Uge0BsaW5rIG1hdGVyaWFsaXplfSwge0BsaW5rIGRlbWF0ZXJpYWxpemV9LCB7QGxpbmsgb2JzZXJ2ZU9ufSwgYW5kCiAqIG90aGVycy4gQmVzaWRlcyB3cmFwcGluZyB0aGUgYWN0dWFsIGRlbGl2ZXJlZCB2YWx1ZSwgaXQgYWxzbyBhbm5vdGF0ZXMgaXQKICogd2l0aCBtZXRhZGF0YSBvZiwgZm9yIGluc3RhbmNlLCB3aGF0IHR5cGUgb2YgcHVzaCBtZXNzYWdlIGl0IGlzIChgbmV4dGAsCiAqIGBlcnJvcmAsIG9yIGBjb21wbGV0ZWApLgogKgogKiBAc2VlIHtAbGluayBtYXRlcmlhbGl6ZX0KICogQHNlZSB7QGxpbmsgZGVtYXRlcmlhbGl6ZX0KICogQHNlZSB7QGxpbmsgb2JzZXJ2ZU9ufQogKgogKiBAY2xhc3MgTm90aWZpY2F0aW9uPFQ+CiAqLwp2YXIgTm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIE5vdGlmaWNhdGlvbihraW5kLCB2YWx1ZSwgZXJyb3IpIHsKICAgICAgICB0aGlzLmtpbmQgPSBraW5kOwogICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7CiAgICAgICAgdGhpcy5oYXNWYWx1ZSA9IGtpbmQgPT09ICdOJzsKICAgIH0KICAgIC8qKgogICAgICogRGVsaXZlcnMgdG8gdGhlIGdpdmVuIGBvYnNlcnZlcmAgdGhlIHZhbHVlIHdyYXBwZWQgYnkgdGhpcyBOb3RpZmljYXRpb24uCiAgICAgKiBAcGFyYW0ge09ic2VydmVyfSBvYnNlcnZlcgogICAgICogQHJldHVybgogICAgICovCiAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLm9ic2VydmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHsKICAgICAgICBzd2l0Y2ggKHRoaXMua2luZCkgewogICAgICAgICAgICBjYXNlICdOJzoKICAgICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5uZXh0ICYmIG9ic2VydmVyLm5leHQodGhpcy52YWx1ZSk7CiAgICAgICAgICAgIGNhc2UgJ0UnOgogICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLmVycm9yICYmIG9ic2VydmVyLmVycm9yKHRoaXMuZXJyb3IpOwogICAgICAgICAgICBjYXNlICdDJzoKICAgICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5jb21wbGV0ZSAmJiBvYnNlcnZlci5jb21wbGV0ZSgpOwogICAgICAgIH0KICAgIH07CiAgICAvKioKICAgICAqIEdpdmVuIHNvbWUge0BsaW5rIE9ic2VydmVyfSBjYWxsYmFja3MsIGRlbGl2ZXIgdGhlIHZhbHVlIHJlcHJlc2VudGVkIGJ5IHRoZQogICAgICogY3VycmVudCBOb3RpZmljYXRpb24gdG8gdGhlIGNvcnJlY3RseSBjb3JyZXNwb25kaW5nIGNhbGxiYWNrLgogICAgICogQHBhcmFtIHtmdW5jdGlvbih2YWx1ZTogVCk6IHZvaWR9IG5leHQgQW4gT2JzZXJ2ZXIgYG5leHRgIGNhbGxiYWNrLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihlcnI6IGFueSk6IHZvaWR9IFtlcnJvcl0gQW4gT2JzZXJ2ZXIgYGVycm9yYCBjYWxsYmFjay4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKTogdm9pZH0gW2NvbXBsZXRlXSBBbiBPYnNlcnZlciBgY29tcGxldGVgIGNhbGxiYWNrLgogICAgICogQHJldHVybiB7YW55fQogICAgICovCiAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLmRvID0gZnVuY3Rpb24gKG5leHQsIGVycm9yLCBjb21wbGV0ZSkgewogICAgICAgIHZhciBraW5kID0gdGhpcy5raW5kOwogICAgICAgIHN3aXRjaCAoa2luZCkgewogICAgICAgICAgICBjYXNlICdOJzoKICAgICAgICAgICAgICAgIHJldHVybiBuZXh0ICYmIG5leHQodGhpcy52YWx1ZSk7CiAgICAgICAgICAgIGNhc2UgJ0UnOgogICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yICYmIGVycm9yKHRoaXMuZXJyb3IpOwogICAgICAgICAgICBjYXNlICdDJzoKICAgICAgICAgICAgICAgIHJldHVybiBjb21wbGV0ZSAmJiBjb21wbGV0ZSgpOwogICAgICAgIH0KICAgIH07CiAgICAvKioKICAgICAqIFRha2VzIGFuIE9ic2VydmVyIG9yIGl0cyBpbmRpdmlkdWFsIGNhbGxiYWNrIGZ1bmN0aW9ucywgYW5kIGNhbGxzIGBvYnNlcnZlYAogICAgICogb3IgYGRvYCBtZXRob2RzIGFjY29yZGluZ2x5LgogICAgICogQHBhcmFtIHtPYnNlcnZlcnxmdW5jdGlvbih2YWx1ZTogVCk6IHZvaWR9IG5leHRPck9ic2VydmVyIEFuIE9ic2VydmVyIG9yCiAgICAgKiB0aGUgYG5leHRgIGNhbGxiYWNrLgogICAgICogQHBhcmFtIHtmdW5jdGlvbihlcnI6IGFueSk6IHZvaWR9IFtlcnJvcl0gQW4gT2JzZXJ2ZXIgYGVycm9yYCBjYWxsYmFjay4KICAgICAqIEBwYXJhbSB7ZnVuY3Rpb24oKTogdm9pZH0gW2NvbXBsZXRlXSBBbiBPYnNlcnZlciBgY29tcGxldGVgIGNhbGxiYWNrLgogICAgICogQHJldHVybiB7YW55fQogICAgICovCiAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIChuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKSB7CiAgICAgICAgaWYgKG5leHRPck9ic2VydmVyICYmIHR5cGVvZiBuZXh0T3JPYnNlcnZlci5uZXh0ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLm9ic2VydmUobmV4dE9yT2JzZXJ2ZXIpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG8obmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSk7CiAgICAgICAgfQogICAgfTsKICAgIC8qKgogICAgICogUmV0dXJucyBhIHNpbXBsZSBPYnNlcnZhYmxlIHRoYXQganVzdCBkZWxpdmVycyB0aGUgbm90aWZpY2F0aW9uIHJlcHJlc2VudGVkCiAgICAgKiBieSB0aGlzIE5vdGlmaWNhdGlvbiBpbnN0YW5jZS4KICAgICAqIEByZXR1cm4ge2FueX0KICAgICAqLwogICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS50b09ic2VydmFibGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGtpbmQgPSB0aGlzLmtpbmQ7CiAgICAgICAgc3dpdGNoIChraW5kKSB7CiAgICAgICAgICAgIGNhc2UgJ04nOgogICAgICAgICAgICAgICAgcmV0dXJuIE9ic2VydmFibGVfMS5PYnNlcnZhYmxlLm9mKHRoaXMudmFsdWUpOwogICAgICAgICAgICBjYXNlICdFJzoKICAgICAgICAgICAgICAgIHJldHVybiBPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS50aHJvdyh0aGlzLmVycm9yKTsKICAgICAgICAgICAgY2FzZSAnQyc6CiAgICAgICAgICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuZW1wdHkoKTsKICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bmV4cGVjdGVkIG5vdGlmaWNhdGlvbiBraW5kIHZhbHVlJyk7CiAgICB9OwogICAgLyoqCiAgICAgKiBBIHNob3J0Y3V0IHRvIGNyZWF0ZSBhIE5vdGlmaWNhdGlvbiBpbnN0YW5jZSBvZiB0aGUgdHlwZSBgbmV4dGAgZnJvbSBhCiAgICAgKiBnaXZlbiB2YWx1ZS4KICAgICAqIEBwYXJhbSB7VH0gdmFsdWUgVGhlIGBuZXh0YCB2YWx1ZS4KICAgICAqIEByZXR1cm4ge05vdGlmaWNhdGlvbjxUPn0gVGhlICJuZXh0IiBOb3RpZmljYXRpb24gcmVwcmVzZW50aW5nIHRoZQogICAgICogYXJndW1lbnQuCiAgICAgKi8KICAgIE5vdGlmaWNhdGlvbi5jcmVhdGVOZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBOb3RpZmljYXRpb24oJ04nLCB2YWx1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLnVuZGVmaW5lZFZhbHVlTm90aWZpY2F0aW9uOwogICAgfTsKICAgIC8qKgogICAgICogQSBzaG9ydGN1dCB0byBjcmVhdGUgYSBOb3RpZmljYXRpb24gaW5zdGFuY2Ugb2YgdGhlIHR5cGUgYGVycm9yYCBmcm9tIGEKICAgICAqIGdpdmVuIGVycm9yLgogICAgICogQHBhcmFtIHthbnl9IFtlcnJdIFRoZSBgZXJyb3JgIGVycm9yLgogICAgICogQHJldHVybiB7Tm90aWZpY2F0aW9uPFQ+fSBUaGUgImVycm9yIiBOb3RpZmljYXRpb24gcmVwcmVzZW50aW5nIHRoZQogICAgICogYXJndW1lbnQuCiAgICAgKi8KICAgIE5vdGlmaWNhdGlvbi5jcmVhdGVFcnJvciA9IGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICByZXR1cm4gbmV3IE5vdGlmaWNhdGlvbignRScsIHVuZGVmaW5lZCwgZXJyKTsKICAgIH07CiAgICAvKioKICAgICAqIEEgc2hvcnRjdXQgdG8gY3JlYXRlIGEgTm90aWZpY2F0aW9uIGluc3RhbmNlIG9mIHRoZSB0eXBlIGBjb21wbGV0ZWAuCiAgICAgKiBAcmV0dXJuIHtOb3RpZmljYXRpb248YW55Pn0gVGhlIHZhbHVlbGVzcyAiY29tcGxldGUiIE5vdGlmaWNhdGlvbi4KICAgICAqLwogICAgTm90aWZpY2F0aW9uLmNyZWF0ZUNvbXBsZXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLmNvbXBsZXRlTm90aWZpY2F0aW9uOwogICAgfTsKICAgIE5vdGlmaWNhdGlvbi5jb21wbGV0ZU5vdGlmaWNhdGlvbiA9IG5ldyBOb3RpZmljYXRpb24oJ0MnKTsKICAgIE5vdGlmaWNhdGlvbi51bmRlZmluZWRWYWx1ZU5vdGlmaWNhdGlvbiA9IG5ldyBOb3RpZmljYXRpb24oJ04nLCB1bmRlZmluZWQpOwogICAgcmV0dXJuIE5vdGlmaWNhdGlvbjsKfSgpKTsKZXhwb3J0cy5Ob3RpZmljYXRpb24gPSBOb3RpZmljYXRpb247Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPU5vdGlmaWNhdGlvbi5qcy5tYXAKCi8qKiovIH0pLAovKiAxNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgpleHBvcnRzLmVtcHR5ID0gewogICAgY2xvc2VkOiB0cnVlLAogICAgbmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7IH0sCiAgICBlcnJvcjogZnVuY3Rpb24gKGVycikgeyB0aHJvdyBlcnI7IH0sCiAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkgeyB9Cn07Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPU9ic2VydmVyLmpzLm1hcAoKLyoqKi8gfSksCi8qIDE3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciBTdWJzY3JpYmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpOwovKioKICogV2UgbmVlZCB0aGlzIEpTRG9jIGNvbW1lbnQgZm9yIGFmZmVjdGluZyBFU0RvYy4KICogQGlnbm9yZQogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICovCnZhciBPdXRlclN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKE91dGVyU3Vic2NyaWJlciwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIE91dGVyU3Vic2NyaWJlcigpIHsKICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KICAgIE91dGVyU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5TmV4dCA9IGZ1bmN0aW9uIChvdXRlclZhbHVlLCBpbm5lclZhbHVlLCBvdXRlckluZGV4LCBpbm5lckluZGV4LCBpbm5lclN1YikgewogICAgICAgIHRoaXMuZGVzdGluYXRpb24ubmV4dChpbm5lclZhbHVlKTsKICAgIH07CiAgICBPdXRlclN1YnNjcmliZXIucHJvdG90eXBlLm5vdGlmeUVycm9yID0gZnVuY3Rpb24gKGVycm9yLCBpbm5lclN1YikgewogICAgICAgIHRoaXMuZGVzdGluYXRpb24uZXJyb3IoZXJyb3IpOwogICAgfTsKICAgIE91dGVyU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5Q29tcGxldGUgPSBmdW5jdGlvbiAoaW5uZXJTdWIpIHsKICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7CiAgICB9OwogICAgcmV0dXJuIE91dGVyU3Vic2NyaWJlcjsKfShTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcikpOwpleHBvcnRzLk91dGVyU3Vic2NyaWJlciA9IE91dGVyU3Vic2NyaWJlcjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9T3V0ZXJTdWJzY3JpYmVyLmpzLm1hcAoKLyoqKi8gfSksCi8qIDE4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgU2NhbGFyT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSk7CnZhciBFbXB0eU9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNik7CnZhciBpc1NjaGVkdWxlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4Mik7Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICogQGhpZGUgdHJ1ZQogKi8KdmFyIEFycmF5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoQXJyYXlPYnNlcnZhYmxlLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTsKICAgICAgICB0aGlzLmFycmF5ID0gYXJyYXk7CiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICAgICAgaWYgKCFzY2hlZHVsZXIgJiYgYXJyYXkubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICAgIHRoaXMuX2lzU2NhbGFyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFycmF5WzBdOwogICAgICAgIH0KICAgIH0KICAgIEFycmF5T2JzZXJ2YWJsZS5jcmVhdGUgPSBmdW5jdGlvbiAoYXJyYXksIHNjaGVkdWxlcikgewogICAgICAgIHJldHVybiBuZXcgQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpOwogICAgfTsKICAgIC8qKgogICAgICogQ3JlYXRlcyBhbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgc29tZSB2YWx1ZXMgeW91IHNwZWNpZnkgYXMgYXJndW1lbnRzLAogICAgICogaW1tZWRpYXRlbHkgb25lIGFmdGVyIHRoZSBvdGhlciwgYW5kIHRoZW4gZW1pdHMgYSBjb21wbGV0ZSBub3RpZmljYXRpb24uCiAgICAgKgogICAgICogPHNwYW4gY2xhc3M9ImluZm9ybWFsIj5FbWl0cyB0aGUgYXJndW1lbnRzIHlvdSBwcm92aWRlLCB0aGVuIGNvbXBsZXRlcy4KICAgICAqIDwvc3Bhbj4KICAgICAqCiAgICAgKiA8aW1nIHNyYz0iLi9pbWcvb2YucG5nIiB3aWR0aD0iMTAwJSI+CiAgICAgKgogICAgICogVGhpcyBzdGF0aWMgb3BlcmF0b3IgaXMgdXNlZnVsIGZvciBjcmVhdGluZyBhIHNpbXBsZSBPYnNlcnZhYmxlIHRoYXQgb25seQogICAgICogZW1pdHMgdGhlIGFyZ3VtZW50cyBnaXZlbiwgYW5kIHRoZSBjb21wbGV0ZSBub3RpZmljYXRpb24gdGhlcmVhZnRlci4gSXQgY2FuCiAgICAgKiBiZSB1c2VkIGZvciBjb21wb3Npbmcgd2l0aCBvdGhlciBPYnNlcnZhYmxlcywgc3VjaCBhcyB3aXRoIHtAbGluayBjb25jYXR9LgogICAgICogQnkgZGVmYXVsdCwgaXQgdXNlcyBhIGBudWxsYCBJU2NoZWR1bGVyLCB3aGljaCBtZWFucyB0aGUgYG5leHRgCiAgICAgKiBub3RpZmljYXRpb25zIGFyZSBzZW50IHN5bmNocm9ub3VzbHksIGFsdGhvdWdoIHdpdGggYSBkaWZmZXJlbnQgSVNjaGVkdWxlcgogICAgICogaXQgaXMgcG9zc2libGUgdG8gZGV0ZXJtaW5lIHdoZW4gdGhvc2Ugbm90aWZpY2F0aW9ucyB3aWxsIGJlIGRlbGl2ZXJlZC4KICAgICAqCiAgICAgKiBAZXhhbXBsZSA8Y2FwdGlvbj5FbWl0IDEwLCAyMCwgMzAsIHRoZW4gJ2EnLCAnYicsICdjJywgdGhlbiBzdGFydCB0aWNraW5nIGV2ZXJ5IHNlY29uZC48L2NhcHRpb24+CiAgICAgKiB2YXIgbnVtYmVycyA9IFJ4Lk9ic2VydmFibGUub2YoMTAsIDIwLCAzMCk7CiAgICAgKiB2YXIgbGV0dGVycyA9IFJ4Lk9ic2VydmFibGUub2YoJ2EnLCAnYicsICdjJyk7CiAgICAgKiB2YXIgaW50ZXJ2YWwgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMDApOwogICAgICogdmFyIHJlc3VsdCA9IG51bWJlcnMuY29uY2F0KGxldHRlcnMpLmNvbmNhdChpbnRlcnZhbCk7CiAgICAgKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpOwogICAgICoKICAgICAqIEBzZWUge0BsaW5rIGNyZWF0ZX0KICAgICAqIEBzZWUge0BsaW5rIGVtcHR5fQogICAgICogQHNlZSB7QGxpbmsgbmV2ZXJ9CiAgICAgKiBAc2VlIHtAbGluayB0aHJvd30KICAgICAqCiAgICAgKiBAcGFyYW0gey4uLlR9IHZhbHVlcyBBcmd1bWVudHMgdGhhdCByZXByZXNlbnQgYG5leHRgIHZhbHVlcyB0byBiZSBlbWl0dGVkLgogICAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIEEge0BsaW5rIElTY2hlZHVsZXJ9IHRvIHVzZSBmb3Igc2NoZWR1bGluZwogICAgICogdGhlIGVtaXNzaW9ucyBvZiB0aGUgYG5leHRgIG5vdGlmaWNhdGlvbnMuCiAgICAgKiBAcmV0dXJuIHtPYnNlcnZhYmxlPFQ+fSBBbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgZWFjaCBnaXZlbiBpbnB1dCB2YWx1ZS4KICAgICAqIEBzdGF0aWMgdHJ1ZQogICAgICogQG5hbWUgb2YKICAgICAqIEBvd25lciBPYnNlcnZhYmxlCiAgICAgKi8KICAgIEFycmF5T2JzZXJ2YWJsZS5vZiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgYXJyYXkgPSBbXTsKICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgICAgICAgICBhcnJheVtfaSAtIDBdID0gYXJndW1lbnRzW19pXTsKICAgICAgICB9CiAgICAgICAgdmFyIHNjaGVkdWxlciA9IGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdOwogICAgICAgIGlmIChpc1NjaGVkdWxlcl8xLmlzU2NoZWR1bGVyKHNjaGVkdWxlcikpIHsKICAgICAgICAgICAgYXJyYXkucG9wKCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBzY2hlZHVsZXIgPSBudWxsOwogICAgICAgIH0KICAgICAgICB2YXIgbGVuID0gYXJyYXkubGVuZ3RoOwogICAgICAgIGlmIChsZW4gPiAxKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gPT09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTY2FsYXJPYnNlcnZhYmxlXzEuU2NhbGFyT2JzZXJ2YWJsZShhcnJheVswXSwgc2NoZWR1bGVyKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgRW1wdHlPYnNlcnZhYmxlXzEuRW1wdHlPYnNlcnZhYmxlKHNjaGVkdWxlcik7CiAgICAgICAgfQogICAgfTsKICAgIEFycmF5T2JzZXJ2YWJsZS5kaXNwYXRjaCA9IGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHZhciBhcnJheSA9IHN0YXRlLmFycmF5LCBpbmRleCA9IHN0YXRlLmluZGV4LCBjb3VudCA9IHN0YXRlLmNvdW50LCBzdWJzY3JpYmVyID0gc3RhdGUuc3Vic2NyaWJlcjsKICAgICAgICBpZiAoaW5kZXggPj0gY291bnQpIHsKICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHN1YnNjcmliZXIubmV4dChhcnJheVtpbmRleF0pOwogICAgICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHN0YXRlLmluZGV4ID0gaW5kZXggKyAxOwogICAgICAgIHRoaXMuc2NoZWR1bGUoc3RhdGUpOwogICAgfTsKICAgIEFycmF5T2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7CiAgICAgICAgdmFyIGluZGV4ID0gMDsKICAgICAgICB2YXIgYXJyYXkgPSB0aGlzLmFycmF5OwogICAgICAgIHZhciBjb3VudCA9IGFycmF5Lmxlbmd0aDsKICAgICAgICB2YXIgc2NoZWR1bGVyID0gdGhpcy5zY2hlZHVsZXI7CiAgICAgICAgaWYgKHNjaGVkdWxlcikgewogICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKEFycmF5T2JzZXJ2YWJsZS5kaXNwYXRjaCwgMCwgewogICAgICAgICAgICAgICAgYXJyYXk6IGFycmF5LCBpbmRleDogaW5kZXgsIGNvdW50OiBjb3VudCwgc3Vic2NyaWJlcjogc3Vic2NyaWJlcgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQgJiYgIXN1YnNjcmliZXIuY2xvc2VkOyBpKyspIHsKICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChhcnJheVtpXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICAgIH0KICAgIH07CiAgICByZXR1cm4gQXJyYXlPYnNlcnZhYmxlOwp9KE9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSk7CmV4cG9ydHMuQXJyYXlPYnNlcnZhYmxlID0gQXJyYXlPYnNlcnZhYmxlOwovLyMgc291cmNlTWFwcGluZ1VSTD1BcnJheU9ic2VydmFibGUuanMubWFwCgovKioqLyB9KSwKLyogMTkgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIE9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICogQGhpZGUgdHJ1ZQogKi8KdmFyIFNjYWxhck9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFNjYWxhck9ic2VydmFibGUsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBTY2FsYXJPYnNlcnZhYmxlKHZhbHVlLCBzY2hlZHVsZXIpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTsKICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICAgICAgdGhpcy5faXNTY2FsYXIgPSB0cnVlOwogICAgICAgIGlmIChzY2hlZHVsZXIpIHsKICAgICAgICAgICAgdGhpcy5faXNTY2FsYXIgPSBmYWxzZTsKICAgICAgICB9CiAgICB9CiAgICBTY2FsYXJPYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgc2NoZWR1bGVyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTY2FsYXJPYnNlcnZhYmxlKHZhbHVlLCBzY2hlZHVsZXIpOwogICAgfTsKICAgIFNjYWxhck9ic2VydmFibGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgICB2YXIgZG9uZSA9IHN0YXRlLmRvbmUsIHZhbHVlID0gc3RhdGUudmFsdWUsIHN1YnNjcmliZXIgPSBzdGF0ZS5zdWJzY3JpYmVyOwogICAgICAgIGlmIChkb25lKSB7CiAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpOwogICAgICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHN0YXRlLmRvbmUgPSB0cnVlOwogICAgICAgIHRoaXMuc2NoZWR1bGUoc3RhdGUpOwogICAgfTsKICAgIFNjYWxhck9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikgewogICAgICAgIHZhciB2YWx1ZSA9IHRoaXMudmFsdWU7CiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyOwogICAgICAgIGlmIChzY2hlZHVsZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZShTY2FsYXJPYnNlcnZhYmxlLmRpc3BhdGNoLCAwLCB7CiAgICAgICAgICAgICAgICBkb25lOiBmYWxzZSwgdmFsdWU6IHZhbHVlLCBzdWJzY3JpYmVyOiBzdWJzY3JpYmVyCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsKICAgICAgICAgICAgaWYgKCFzdWJzY3JpYmVyLmNsb3NlZCkgewogICAgICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKICAgIHJldHVybiBTY2FsYXJPYnNlcnZhYmxlOwp9KE9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSk7CmV4cG9ydHMuU2NhbGFyT2JzZXJ2YWJsZSA9IFNjYWxhck9ic2VydmFibGU7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPVNjYWxhck9ic2VydmFibGUuanMubWFwCgovKioqLyB9KSwKLyogMjAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHJvb3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CnZhciBTeW1ib2wgPSByb290XzEucm9vdC5TeW1ib2w7CmV4cG9ydHMuJCRyeFN1YnNjcmliZXIgPSAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgU3ltYm9sLmZvciA9PT0gJ2Z1bmN0aW9uJykgPwogICAgU3ltYm9sLmZvcigncnhTdWJzY3JpYmVyJykgOiAnQEByeFN1YnNjcmliZXInOwovLyMgc291cmNlTWFwcGluZ1VSTD1yeFN1YnNjcmliZXIuanMubWFwCgovKioqLyB9KSwKLyogMjEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKZXhwb3J0cy5pc0FycmF5TGlrZSA9IChmdW5jdGlvbiAoeCkgeyByZXR1cm4geCAmJiB0eXBlb2YgeC5sZW5ndGggPT09ICdudW1iZXInOyB9KTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNBcnJheUxpa2UuanMubWFwCgovKioqLyB9KSwKLyogMjIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gaXNEYXRlKHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTigrdmFsdWUpOwp9CmV4cG9ydHMuaXNEYXRlID0gaXNEYXRlOwovLyMgc291cmNlTWFwcGluZ1VSTD1pc0RhdGUuanMubWFwCgovKioqLyB9KSwKLyogMjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKZnVuY3Rpb24gaXNPYmplY3QoeCkgewogICAgcmV0dXJuIHggIT0gbnVsbCAmJiB0eXBlb2YgeCA9PT0gJ29iamVjdCc7Cn0KZXhwb3J0cy5pc09iamVjdCA9IGlzT2JqZWN0OwovLyMgc291cmNlTWFwcGluZ1VSTD1pc09iamVjdC5qcy5tYXAKCi8qKiovIH0pLAovKiAyNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7CgpmdW5jdGlvbiBpc1Byb21pc2UodmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nOwp9CmV4cG9ydHMuaXNQcm9taXNlID0gaXNQcm9taXNlOwovLyMgc291cmNlTWFwcGluZ1VSTD1pc1Byb21pc2UuanMubWFwCgovKioqLyB9KSwKLyogMjUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIHJvb3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CnZhciBpc0FycmF5TGlrZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7CnZhciBpc1Byb21pc2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwp2YXIgaXNPYmplY3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpOwp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGl0ZXJhdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwp2YXIgSW5uZXJTdWJzY3JpYmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU1KTsKdmFyIG9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CmZ1bmN0aW9uIHN1YnNjcmliZVRvUmVzdWx0KG91dGVyU3Vic2NyaWJlciwgcmVzdWx0LCBvdXRlclZhbHVlLCBvdXRlckluZGV4KSB7CiAgICB2YXIgZGVzdGluYXRpb24gPSBuZXcgSW5uZXJTdWJzY3JpYmVyXzEuSW5uZXJTdWJzY3JpYmVyKG91dGVyU3Vic2NyaWJlciwgb3V0ZXJWYWx1ZSwgb3V0ZXJJbmRleCk7CiAgICBpZiAoZGVzdGluYXRpb24uY2xvc2VkKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHsKICAgICAgICBpZiAocmVzdWx0Ll9pc1NjYWxhcikgewogICAgICAgICAgICBkZXN0aW5hdGlvbi5uZXh0KHJlc3VsdC52YWx1ZSk7CiAgICAgICAgICAgIGRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5zdWJzY3JpYmUoZGVzdGluYXRpb24pOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UgaWYgKGlzQXJyYXlMaWtlXzEuaXNBcnJheUxpa2UocmVzdWx0KSkgewogICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByZXN1bHQubGVuZ3RoOyBpIDwgbGVuICYmICFkZXN0aW5hdGlvbi5jbG9zZWQ7IGkrKykgewogICAgICAgICAgICBkZXN0aW5hdGlvbi5uZXh0KHJlc3VsdFtpXSk7CiAgICAgICAgfQogICAgICAgIGlmICghZGVzdGluYXRpb24uY2xvc2VkKSB7CiAgICAgICAgICAgIGRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7CiAgICAgICAgfQogICAgfQogICAgZWxzZSBpZiAoaXNQcm9taXNlXzEuaXNQcm9taXNlKHJlc3VsdCkpIHsKICAgICAgICByZXN1bHQudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgaWYgKCFkZXN0aW5hdGlvbi5jbG9zZWQpIHsKICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uLm5leHQodmFsdWUpOwogICAgICAgICAgICAgICAgZGVzdGluYXRpb24uY29tcGxldGUoKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIGRlc3RpbmF0aW9uLmVycm9yKGVycik7IH0pCiAgICAgICAgICAgIC50aGVuKG51bGwsIGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgLy8gRXNjYXBpbmcgdGhlIFByb21pc2UgdHJhcDogZ2xvYmFsbHkgdGhyb3cgdW5oYW5kbGVkIGVycm9ycwogICAgICAgICAgICByb290XzEucm9vdC5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgdGhyb3cgZXJyOyB9KTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZGVzdGluYXRpb247CiAgICB9CiAgICBlbHNlIGlmIChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdFtpdGVyYXRvcl8xLiQkaXRlcmF0b3JdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdmFyIGl0ZXJhdG9yID0gcmVzdWx0W2l0ZXJhdG9yXzEuJCRpdGVyYXRvcl0oKTsKICAgICAgICBkbyB7CiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlcmF0b3IubmV4dCgpOwogICAgICAgICAgICBpZiAoaXRlbS5kb25lKSB7CiAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbi5jb21wbGV0ZSgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGVzdGluYXRpb24ubmV4dChpdGVtLnZhbHVlKTsKICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uLmNsb3NlZCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9IHdoaWxlICh0cnVlKTsKICAgIH0KICAgIGVsc2UgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0W29ic2VydmFibGVfMS4kJG9ic2VydmFibGVdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdmFyIG9icyA9IHJlc3VsdFtvYnNlcnZhYmxlXzEuJCRvYnNlcnZhYmxlXSgpOwogICAgICAgIGlmICh0eXBlb2Ygb2JzLnN1YnNjcmliZSAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICBkZXN0aW5hdGlvbi5lcnJvcihuZXcgVHlwZUVycm9yKCdQcm92aWRlZCBvYmplY3QgZG9lcyBub3QgY29ycmVjdGx5IGltcGxlbWVudCBTeW1ib2wub2JzZXJ2YWJsZScpKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBvYnMuc3Vic2NyaWJlKG5ldyBJbm5lclN1YnNjcmliZXJfMS5Jbm5lclN1YnNjcmliZXIob3V0ZXJTdWJzY3JpYmVyLCBvdXRlclZhbHVlLCBvdXRlckluZGV4KSk7CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgdmFyIHZhbHVlID0gaXNPYmplY3RfMS5pc09iamVjdChyZXN1bHQpID8gJ2FuIGludmFsaWQgb2JqZWN0JyA6ICInIiArIHJlc3VsdCArICInIjsKICAgICAgICB2YXIgbXNnID0gKCJZb3UgcHJvdmlkZWQgIiArIHZhbHVlICsgIiB3aGVyZSBhIHN0cmVhbSB3YXMgZXhwZWN0ZWQuIikKICAgICAgICAgICAgKyAnIFlvdSBjYW4gcHJvdmlkZSBhbiBPYnNlcnZhYmxlLCBQcm9taXNlLCBBcnJheSwgb3IgSXRlcmFibGUuJzsKICAgICAgICBkZXN0aW5hdGlvbi5lcnJvcihuZXcgVHlwZUVycm9yKG1zZykpOwogICAgfQogICAgcmV0dXJuIG51bGw7Cn0KZXhwb3J0cy5zdWJzY3JpYmVUb1Jlc3VsdCA9IHN1YnNjcmliZVRvUmVzdWx0OwovLyMgc291cmNlTWFwcGluZ1VSTD1zdWJzY3JpYmVUb1Jlc3VsdC5qcy5tYXAKCi8qKiovIH0pLAovKiAyNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgZXJyb3JPYmplY3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7CnZhciB0cnlDYXRjaFRhcmdldDsKZnVuY3Rpb24gdHJ5Q2F0Y2hlcigpIHsKICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIHRyeUNhdGNoVGFyZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CiAgICBjYXRjaCAoZSkgewogICAgICAgIGVycm9yT2JqZWN0XzEuZXJyb3JPYmplY3QuZSA9IGU7CiAgICAgICAgcmV0dXJuIGVycm9yT2JqZWN0XzEuZXJyb3JPYmplY3Q7CiAgICB9Cn0KZnVuY3Rpb24gdHJ5Q2F0Y2goZm4pIHsKICAgIHRyeUNhdGNoVGFyZ2V0ID0gZm47CiAgICByZXR1cm4gdHJ5Q2F0Y2hlcjsKfQpleHBvcnRzLnRyeUNhdGNoID0gdHJ5Q2F0Y2g7CjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJ5Q2F0Y2guanMubWFwCgovKioqLyB9KSwKLyogMjcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKLyoqCiAqIENyZWF0ZWQgYnkgYXhldHJveSBvbiAxNi0xMS0xMi4KICovCnZhciBDT05GSUcgPSB7CiAgICBkZWJ1ZzogZmFsc2UKfTsKZXhwb3J0cy5DT05GSUcgPSBDT05GSUc7CgoKLyoqKi8gfSksCi8qIDI4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIENyZWF0ZWQgYnkgYXhldHJveSBvbiAxNi0xMS0xOC4KICovCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwp2YXIgXyA9IF9fd2VicGFja19yZXF1aXJlX18oMzApOwp2YXIgbG9nID0gXy5vbmNlKGZ1bmN0aW9uIChwcm9qZWN0KSB7CiAgICBjb25zb2xlLmxvZygiJWMgQW50aS1SZWRpcmVjdCAlYyBDb3B5cmlnaHQgXHhhOSAyMDE1LSVzICVzIiwgJ2ZvbnQtZmFtaWx5OiAiSGVsdmV0aWNhIE5ldWUiLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmO2ZvbnQtc2l6ZTo2NHB4O2NvbG9yOiMwMGJiZWU7LXdlYmtpdC10ZXh0LWZpbGwtY29sb3I6IzAwYmJlZTstd2Via2l0LXRleHQtc3Ryb2tlOiAxcHggIzAwYmJlZTsnLCAiZm9udC1zaXplOjEycHg7Y29sb3I6Izk5OTk5OTsiLCAobmV3IERhdGUpLmdldEZ1bGxZZWFyKCksICdcbicgKyAocHJvamVjdCB8fCAnJykpOwp9KTsKZXhwb3J0cy5sb2cgPSBsb2c7CgoKLyoqKi8gfSksCi8qIDI5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKLyoqCiAqIENyZWF0ZWQgYnkgYXhldHJveSBvbiAxNi0xMS0xOC4KICovCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwp2YXIgUXVlcnkgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gUXVlcnkocXVlcnlTdHIpIHsKICAgICAgICBpZiAocXVlcnlTdHIgPT09IHZvaWQgMCkgeyBxdWVyeVN0ciA9ICcnOyB9CiAgICAgICAgdGhpcy5xdWVyeVN0ciA9IHF1ZXJ5U3RyOwogICAgICAgIHRoaXMub2JqZWN0ID0ge307CiAgICAgICAgdGhpcy5vYmplY3QgPSB0aGlzLnRvT2JqZWN0KHF1ZXJ5U3RyLnJlcGxhY2UoL15cPysvLCAnJykpOwogICAgfQogICAgUXVlcnkucHJvdG90eXBlLnRvT2JqZWN0ID0gZnVuY3Rpb24gKHF1ZXJ5U3RyKSB7CiAgICAgICAgdmFyIG9iaiA9IHt9OwogICAgICAgIHF1ZXJ5U3RyLnNwbGl0KCcmJykuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICB2YXIgYXJyID0gaXRlbS5zcGxpdCgnPScpIHx8IFtdOwogICAgICAgICAgICB2YXIga2V5ID0gYXJyWzBdIHx8ICcnOwogICAgICAgICAgICB2YXIgdmFsdWUgPSBhcnJbMV0gfHwgJyc7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBrZXkgPSBkZWNvZGVVUklDb21wb25lbnQoYXJyWzBdIHx8ICcnKTsKICAgICAgICAgICAgICAgIHZhbHVlID0gZGVjb2RlVVJJQ29tcG9uZW50KGFyclsxXSB8fCAnJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGVycikgewogICAgICAgICAgICB9CiAgICAgICAgICAgIGtleSAmJiAob2JqW2tleV0gPSB2YWx1ZSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIG9iajsKICAgIH07CiAgICBRdWVyeS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGFyciA9IFtdOwogICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLm9iamVjdCkgewogICAgICAgICAgICBpZiAodGhpcy5vYmplY3QuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5vYmplY3Rba2V5XTsKICAgICAgICAgICAgICAgIGFyci5wdXNoKGtleSArICc9JyArIHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gYXJyLmxlbmd0aCA/ICc/JyArIGFyci5qb2luKCcmJykgOiAnJzsKICAgIH07CiAgICByZXR1cm4gUXVlcnk7Cn0oKSk7CmV4cG9ydHMuZGVmYXVsdCA9IFF1ZXJ5OwoKCi8qKiovIH0pLAovKiAzMCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cgp2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187Ly8gICAgIFVuZGVyc2NvcmUuanMgMS44LjMKLy8gICAgIGh0dHA6Ly91bmRlcnNjb3JlanMub3JnCi8vICAgICAoYykgMjAwOS0yMDE1IEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBhbmQgSW52ZXN0aWdhdGl2ZSBSZXBvcnRlcnMgJiBFZGl0b3JzCi8vICAgICBVbmRlcnNjb3JlIG1heSBiZSBmcmVlbHkgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLgoKKGZ1bmN0aW9uKCkgewoKICAvLyBCYXNlbGluZSBzZXR1cAogIC8vIC0tLS0tLS0tLS0tLS0tCgogIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZXhwb3J0c2Agb24gdGhlIHNlcnZlci4KICB2YXIgcm9vdCA9IHRoaXM7CgogIC8vIFNhdmUgdGhlIHByZXZpb3VzIHZhbHVlIG9mIHRoZSBgX2AgdmFyaWFibGUuCiAgdmFyIHByZXZpb3VzVW5kZXJzY29yZSA9IHJvb3QuXzsKCiAgLy8gU2F2ZSBieXRlcyBpbiB0aGUgbWluaWZpZWQgKGJ1dCBub3QgZ3ppcHBlZCkgdmVyc2lvbjoKICB2YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZSwgT2JqUHJvdG8gPSBPYmplY3QucHJvdG90eXBlLCBGdW5jUHJvdG8gPSBGdW5jdGlvbi5wcm90b3R5cGU7CgogIC8vIENyZWF0ZSBxdWljayByZWZlcmVuY2UgdmFyaWFibGVzIGZvciBzcGVlZCBhY2Nlc3MgdG8gY29yZSBwcm90b3R5cGVzLgogIHZhcgogICAgcHVzaCAgICAgICAgICAgICA9IEFycmF5UHJvdG8ucHVzaCwKICAgIHNsaWNlICAgICAgICAgICAgPSBBcnJheVByb3RvLnNsaWNlLAogICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLAogICAgaGFzT3duUHJvcGVydHkgICA9IE9ialByb3RvLmhhc093blByb3BlcnR5OwoKICAvLyBBbGwgKipFQ01BU2NyaXB0IDUqKiBuYXRpdmUgZnVuY3Rpb24gaW1wbGVtZW50YXRpb25zIHRoYXQgd2UgaG9wZSB0byB1c2UKICAvLyBhcmUgZGVjbGFyZWQgaGVyZS4KICB2YXIKICAgIG5hdGl2ZUlzQXJyYXkgICAgICA9IEFycmF5LmlzQXJyYXksCiAgICBuYXRpdmVLZXlzICAgICAgICAgPSBPYmplY3Qua2V5cywKICAgIG5hdGl2ZUJpbmQgICAgICAgICA9IEZ1bmNQcm90by5iaW5kLAogICAgbmF0aXZlQ3JlYXRlICAgICAgID0gT2JqZWN0LmNyZWF0ZTsKCiAgLy8gTmFrZWQgZnVuY3Rpb24gcmVmZXJlbmNlIGZvciBzdXJyb2dhdGUtcHJvdG90eXBlLXN3YXBwaW5nLgogIHZhciBDdG9yID0gZnVuY3Rpb24oKXt9OwoKICAvLyBDcmVhdGUgYSBzYWZlIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QgZm9yIHVzZSBiZWxvdy4KICB2YXIgXyA9IGZ1bmN0aW9uKG9iaikgewogICAgaWYgKG9iaiBpbnN0YW5jZW9mIF8pIHJldHVybiBvYmo7CiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgXykpIHJldHVybiBuZXcgXyhvYmopOwogICAgdGhpcy5fd3JhcHBlZCA9IG9iajsKICB9OwoKICAvLyBFeHBvcnQgdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciAqKk5vZGUuanMqKiwgd2l0aAogIC8vIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IGZvciB0aGUgb2xkIGByZXF1aXJlKClgIEFQSS4gSWYgd2UncmUgaW4KICAvLyB0aGUgYnJvd3NlciwgYWRkIGBfYCBhcyBhIGdsb2JhbCBvYmplY3QuCiAgaWYgKHRydWUpIHsKICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykgewogICAgICBleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBfOwogICAgfQogICAgZXhwb3J0cy5fID0gXzsKICB9IGVsc2UgewogICAgcm9vdC5fID0gXzsKICB9CgogIC8vIEN1cnJlbnQgdmVyc2lvbi4KICBfLlZFUlNJT04gPSAnMS44LjMnOwoKICAvLyBJbnRlcm5hbCBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gZWZmaWNpZW50IChmb3IgY3VycmVudCBlbmdpbmVzKSB2ZXJzaW9uCiAgLy8gb2YgdGhlIHBhc3NlZC1pbiBjYWxsYmFjaywgdG8gYmUgcmVwZWF0ZWRseSBhcHBsaWVkIGluIG90aGVyIFVuZGVyc2NvcmUKICAvLyBmdW5jdGlvbnMuCiAgdmFyIG9wdGltaXplQ2IgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0LCBhcmdDb3VudCkgewogICAgaWYgKGNvbnRleHQgPT09IHZvaWQgMCkgcmV0dXJuIGZ1bmM7CiAgICBzd2l0Y2ggKGFyZ0NvdW50ID09IG51bGwgPyAzIDogYXJnQ291bnQpIHsKICAgICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIHZhbHVlKTsKICAgICAgfTsKICAgICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24odmFsdWUsIG90aGVyKSB7CiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbChjb250ZXh0LCB2YWx1ZSwgb3RoZXIpOwogICAgICB9OwogICAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHsKICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7CiAgICAgIH07CiAgICAgIGNhc2UgNDogcmV0dXJuIGZ1bmN0aW9uKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHsKICAgICAgICByZXR1cm4gZnVuYy5jYWxsKGNvbnRleHQsIGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pOwogICAgICB9OwogICAgfQogICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gZnVuYy5hcHBseShjb250ZXh0LCBhcmd1bWVudHMpOwogICAgfTsKICB9OwoKICAvLyBBIG1vc3RseS1pbnRlcm5hbCBmdW5jdGlvbiB0byBnZW5lcmF0ZSBjYWxsYmFja3MgdGhhdCBjYW4gYmUgYXBwbGllZAogIC8vIHRvIGVhY2ggZWxlbWVudCBpbiBhIGNvbGxlY3Rpb24sIHJldHVybmluZyB0aGUgZGVzaXJlZCByZXN1bHQg4oCUIGVpdGhlcgogIC8vIGlkZW50aXR5LCBhbiBhcmJpdHJhcnkgY2FsbGJhY2ssIGEgcHJvcGVydHkgbWF0Y2hlciwgb3IgYSBwcm9wZXJ0eSBhY2Nlc3Nvci4KICB2YXIgY2IgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCwgYXJnQ291bnQpIHsKICAgIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gXy5pZGVudGl0eTsKICAgIGlmIChfLmlzRnVuY3Rpb24odmFsdWUpKSByZXR1cm4gb3B0aW1pemVDYih2YWx1ZSwgY29udGV4dCwgYXJnQ291bnQpOwogICAgaWYgKF8uaXNPYmplY3QodmFsdWUpKSByZXR1cm4gXy5tYXRjaGVyKHZhbHVlKTsKICAgIHJldHVybiBfLnByb3BlcnR5KHZhbHVlKTsKICB9OwogIF8uaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwgY29udGV4dCkgewogICAgcmV0dXJuIGNiKHZhbHVlLCBjb250ZXh0LCBJbmZpbml0eSk7CiAgfTsKCiAgLy8gQW4gaW50ZXJuYWwgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIGFzc2lnbmVyIGZ1bmN0aW9ucy4KICB2YXIgY3JlYXRlQXNzaWduZXIgPSBmdW5jdGlvbihrZXlzRnVuYywgdW5kZWZpbmVkT25seSkgewogICAgcmV0dXJuIGZ1bmN0aW9uKG9iaikgewogICAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsKICAgICAgaWYgKGxlbmd0aCA8IDIgfHwgb2JqID09IG51bGwpIHJldHVybiBvYmo7CiAgICAgIGZvciAodmFyIGluZGV4ID0gMTsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2luZGV4XSwKICAgICAgICAgICAga2V5cyA9IGtleXNGdW5jKHNvdXJjZSksCiAgICAgICAgICAgIGwgPSBrZXlzLmxlbmd0aDsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkrKykgewogICAgICAgICAgdmFyIGtleSA9IGtleXNbaV07CiAgICAgICAgICBpZiAoIXVuZGVmaW5lZE9ubHkgfHwgb2JqW2tleV0gPT09IHZvaWQgMCkgb2JqW2tleV0gPSBzb3VyY2Vba2V5XTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG9iajsKICAgIH07CiAgfTsKCiAgLy8gQW4gaW50ZXJuYWwgZnVuY3Rpb24gZm9yIGNyZWF0aW5nIGEgbmV3IG9iamVjdCB0aGF0IGluaGVyaXRzIGZyb20gYW5vdGhlci4KICB2YXIgYmFzZUNyZWF0ZSA9IGZ1bmN0aW9uKHByb3RvdHlwZSkgewogICAgaWYgKCFfLmlzT2JqZWN0KHByb3RvdHlwZSkpIHJldHVybiB7fTsKICAgIGlmIChuYXRpdmVDcmVhdGUpIHJldHVybiBuYXRpdmVDcmVhdGUocHJvdG90eXBlKTsKICAgIEN0b3IucHJvdG90eXBlID0gcHJvdG90eXBlOwogICAgdmFyIHJlc3VsdCA9IG5ldyBDdG9yOwogICAgQ3Rvci5wcm90b3R5cGUgPSBudWxsOwogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICB2YXIgcHJvcGVydHkgPSBmdW5jdGlvbihrZXkpIHsKICAgIHJldHVybiBmdW5jdGlvbihvYmopIHsKICAgICAgcmV0dXJuIG9iaiA9PSBudWxsID8gdm9pZCAwIDogb2JqW2tleV07CiAgICB9OwogIH07CgogIC8vIEhlbHBlciBmb3IgY29sbGVjdGlvbiBtZXRob2RzIHRvIGRldGVybWluZSB3aGV0aGVyIGEgY29sbGVjdGlvbgogIC8vIHNob3VsZCBiZSBpdGVyYXRlZCBhcyBhbiBhcnJheSBvciBhcyBhbiBvYmplY3QKICAvLyBSZWxhdGVkOiBodHRwOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy10b2xlbmd0aAogIC8vIEF2b2lkcyBhIHZlcnkgbmFzdHkgaU9TIDggSklUIGJ1ZyBvbiBBUk0tNjQuICMyMDk0CiAgdmFyIE1BWF9BUlJBWV9JTkRFWCA9IE1hdGgucG93KDIsIDUzKSAtIDE7CiAgdmFyIGdldExlbmd0aCA9IHByb3BlcnR5KCdsZW5ndGgnKTsKICB2YXIgaXNBcnJheUxpa2UgPSBmdW5jdGlvbihjb2xsZWN0aW9uKSB7CiAgICB2YXIgbGVuZ3RoID0gZ2V0TGVuZ3RoKGNvbGxlY3Rpb24pOwogICAgcmV0dXJuIHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicgJiYgbGVuZ3RoID49IDAgJiYgbGVuZ3RoIDw9IE1BWF9BUlJBWV9JTkRFWDsKICB9OwoKICAvLyBDb2xsZWN0aW9uIEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIFRoZSBjb3JuZXJzdG9uZSwgYW4gYGVhY2hgIGltcGxlbWVudGF0aW9uLCBha2EgYGZvckVhY2hgLgogIC8vIEhhbmRsZXMgcmF3IG9iamVjdHMgaW4gYWRkaXRpb24gdG8gYXJyYXktbGlrZXMuIFRyZWF0cyBhbGwKICAvLyBzcGFyc2UgYXJyYXktbGlrZXMgYXMgaWYgdGhleSB3ZXJlIGRlbnNlLgogIF8uZWFjaCA9IF8uZm9yRWFjaCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKICAgIGl0ZXJhdGVlID0gb3B0aW1pemVDYihpdGVyYXRlZSwgY29udGV4dCk7CiAgICB2YXIgaSwgbGVuZ3RoOwogICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHsKICAgICAgZm9yIChpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgaXRlcmF0ZWUob2JqW2ldLCBpLCBvYmopOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopOwogICAgICBmb3IgKGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgaXRlcmF0ZWUob2JqW2tleXNbaV1dLCBrZXlzW2ldLCBvYmopOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gb2JqOwogIH07CgogIC8vIFJldHVybiB0aGUgcmVzdWx0cyBvZiBhcHBseWluZyB0aGUgaXRlcmF0ZWUgdG8gZWFjaCBlbGVtZW50LgogIF8ubWFwID0gXy5jb2xsZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkgewogICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CiAgICB2YXIga2V5cyA9ICFpc0FycmF5TGlrZShvYmopICYmIF8ua2V5cyhvYmopLAogICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLAogICAgICAgIHJlc3VsdHMgPSBBcnJheShsZW5ndGgpOwogICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewogICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4OwogICAgICByZXN1bHRzW2luZGV4XSA9IGl0ZXJhdGVlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKTsKICAgIH0KICAgIHJldHVybiByZXN1bHRzOwogIH07CgogIC8vIENyZWF0ZSBhIHJlZHVjaW5nIGZ1bmN0aW9uIGl0ZXJhdGluZyBsZWZ0IG9yIHJpZ2h0LgogIGZ1bmN0aW9uIGNyZWF0ZVJlZHVjZShkaXIpIHsKICAgIC8vIE9wdGltaXplZCBpdGVyYXRvciBmdW5jdGlvbiBhcyB1c2luZyBhcmd1bWVudHMubGVuZ3RoCiAgICAvLyBpbiB0aGUgbWFpbiBmdW5jdGlvbiB3aWxsIGRlb3B0aW1pemUgdGhlLCBzZWUgIzE5OTEuCiAgICBmdW5jdGlvbiBpdGVyYXRvcihvYmosIGl0ZXJhdGVlLCBtZW1vLCBrZXlzLCBpbmRleCwgbGVuZ3RoKSB7CiAgICAgIGZvciAoOyBpbmRleCA+PSAwICYmIGluZGV4IDwgbGVuZ3RoOyBpbmRleCArPSBkaXIpIHsKICAgICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4OwogICAgICAgIG1lbW8gPSBpdGVyYXRlZShtZW1vLCBvYmpbY3VycmVudEtleV0sIGN1cnJlbnRLZXksIG9iaik7CiAgICAgIH0KICAgICAgcmV0dXJuIG1lbW87CiAgICB9CgogICAgcmV0dXJuIGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGNvbnRleHQpIHsKICAgICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKGl0ZXJhdGVlLCBjb250ZXh0LCA0KTsKICAgICAgdmFyIGtleXMgPSAhaXNBcnJheUxpa2Uob2JqKSAmJiBfLmtleXMob2JqKSwKICAgICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoLAogICAgICAgICAgaW5kZXggPSBkaXIgPiAwID8gMCA6IGxlbmd0aCAtIDE7CiAgICAgIC8vIERldGVybWluZSB0aGUgaW5pdGlhbCB2YWx1ZSBpZiBub25lIGlzIHByb3ZpZGVkLgogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHsKICAgICAgICBtZW1vID0gb2JqW2tleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4XTsKICAgICAgICBpbmRleCArPSBkaXI7CiAgICAgIH0KICAgICAgcmV0dXJuIGl0ZXJhdG9yKG9iaiwgaXRlcmF0ZWUsIG1lbW8sIGtleXMsIGluZGV4LCBsZW5ndGgpOwogICAgfTsKICB9CgogIC8vICoqUmVkdWNlKiogYnVpbGRzIHVwIGEgc2luZ2xlIHJlc3VsdCBmcm9tIGEgbGlzdCBvZiB2YWx1ZXMsIGFrYSBgaW5qZWN0YCwKICAvLyBvciBgZm9sZGxgLgogIF8ucmVkdWNlID0gXy5mb2xkbCA9IF8uaW5qZWN0ID0gY3JlYXRlUmVkdWNlKDEpOwoKICAvLyBUaGUgcmlnaHQtYXNzb2NpYXRpdmUgdmVyc2lvbiBvZiByZWR1Y2UsIGFsc28ga25vd24gYXMgYGZvbGRyYC4KICBfLnJlZHVjZVJpZ2h0ID0gXy5mb2xkciA9IGNyZWF0ZVJlZHVjZSgtMSk7CgogIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC4KICBfLmZpbmQgPSBfLmRldGVjdCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7CiAgICB2YXIga2V5OwogICAgaWYgKGlzQXJyYXlMaWtlKG9iaikpIHsKICAgICAga2V5ID0gXy5maW5kSW5kZXgob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpOwogICAgfSBlbHNlIHsKICAgICAga2V5ID0gXy5maW5kS2V5KG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KTsKICAgIH0KICAgIGlmIChrZXkgIT09IHZvaWQgMCAmJiBrZXkgIT09IC0xKSByZXR1cm4gb2JqW2tleV07CiAgfTsKCiAgLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgdGhhdCBwYXNzIGEgdHJ1dGggdGVzdC4KICAvLyBBbGlhc2VkIGFzIGBzZWxlY3RgLgogIF8uZmlsdGVyID0gXy5zZWxlY3QgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkgewogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CiAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHsKICAgICAgaWYgKHByZWRpY2F0ZSh2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzLnB1c2godmFsdWUpOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBmb3Igd2hpY2ggYSB0cnV0aCB0ZXN0IGZhaWxzLgogIF8ucmVqZWN0ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKICAgIHJldHVybiBfLmZpbHRlcihvYmosIF8ubmVnYXRlKGNiKHByZWRpY2F0ZSkpLCBjb250ZXh0KTsKICB9OwoKICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNoIGEgdHJ1dGggdGVzdC4KICAvLyBBbGlhc2VkIGFzIGBhbGxgLgogIF8uZXZlcnkgPSBfLmFsbCA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7CiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpOwogICAgdmFyIGtleXMgPSAhaXNBcnJheUxpa2Uob2JqKSAmJiBfLmtleXMob2JqKSwKICAgICAgICBsZW5ndGggPSAoa2V5cyB8fCBvYmopLmxlbmd0aDsKICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKICAgICAgdmFyIGN1cnJlbnRLZXkgPSBrZXlzID8ga2V5c1tpbmRleF0gOiBpbmRleDsKICAgICAgaWYgKCFwcmVkaWNhdGUob2JqW2N1cnJlbnRLZXldLCBjdXJyZW50S2V5LCBvYmopKSByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9OwoKICAvLyBEZXRlcm1pbmUgaWYgYXQgbGVhc3Qgb25lIGVsZW1lbnQgaW4gdGhlIG9iamVjdCBtYXRjaGVzIGEgdHJ1dGggdGVzdC4KICAvLyBBbGlhc2VkIGFzIGBhbnlgLgogIF8uc29tZSA9IF8uYW55ID0gZnVuY3Rpb24ob2JqLCBwcmVkaWNhdGUsIGNvbnRleHQpIHsKICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CiAgICB2YXIga2V5cyA9ICFpc0FycmF5TGlrZShvYmopICYmIF8ua2V5cyhvYmopLAogICAgICAgIGxlbmd0aCA9IChrZXlzIHx8IG9iaikubGVuZ3RoOwogICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewogICAgICB2YXIgY3VycmVudEtleSA9IGtleXMgPyBrZXlzW2luZGV4XSA6IGluZGV4OwogICAgICBpZiAocHJlZGljYXRlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKSkgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7CiAgfTsKCiAgLy8gRGV0ZXJtaW5lIGlmIHRoZSBhcnJheSBvciBvYmplY3QgY29udGFpbnMgYSBnaXZlbiBpdGVtICh1c2luZyBgPT09YCkuCiAgLy8gQWxpYXNlZCBhcyBgaW5jbHVkZXNgIGFuZCBgaW5jbHVkZWAuCiAgXy5jb250YWlucyA9IF8uaW5jbHVkZXMgPSBfLmluY2x1ZGUgPSBmdW5jdGlvbihvYmosIGl0ZW0sIGZyb21JbmRleCwgZ3VhcmQpIHsKICAgIGlmICghaXNBcnJheUxpa2Uob2JqKSkgb2JqID0gXy52YWx1ZXMob2JqKTsKICAgIGlmICh0eXBlb2YgZnJvbUluZGV4ICE9ICdudW1iZXInIHx8IGd1YXJkKSBmcm9tSW5kZXggPSAwOwogICAgcmV0dXJuIF8uaW5kZXhPZihvYmosIGl0ZW0sIGZyb21JbmRleCkgPj0gMDsKICB9OwoKICAvLyBJbnZva2UgYSBtZXRob2QgKHdpdGggYXJndW1lbnRzKSBvbiBldmVyeSBpdGVtIGluIGEgY29sbGVjdGlvbi4KICBfLmludm9rZSA9IGZ1bmN0aW9uKG9iaiwgbWV0aG9kKSB7CiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgIHZhciBpc0Z1bmMgPSBfLmlzRnVuY3Rpb24obWV0aG9kKTsKICAgIHJldHVybiBfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIHZhciBmdW5jID0gaXNGdW5jID8gbWV0aG9kIDogdmFsdWVbbWV0aG9kXTsKICAgICAgcmV0dXJuIGZ1bmMgPT0gbnVsbCA/IGZ1bmMgOiBmdW5jLmFwcGx5KHZhbHVlLCBhcmdzKTsKICAgIH0pOwogIH07CgogIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYG1hcGA6IGZldGNoaW5nIGEgcHJvcGVydHkuCiAgXy5wbHVjayA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7CiAgICByZXR1cm4gXy5tYXAob2JqLCBfLnByb3BlcnR5KGtleSkpOwogIH07CgogIC8vIENvbnZlbmllbmNlIHZlcnNpb24gb2YgYSBjb21tb24gdXNlIGNhc2Ugb2YgYGZpbHRlcmA6IHNlbGVjdGluZyBvbmx5IG9iamVjdHMKICAvLyBjb250YWluaW5nIHNwZWNpZmljIGBrZXk6dmFsdWVgIHBhaXJzLgogIF8ud2hlcmUgPSBmdW5jdGlvbihvYmosIGF0dHJzKSB7CiAgICByZXR1cm4gXy5maWx0ZXIob2JqLCBfLm1hdGNoZXIoYXR0cnMpKTsKICB9OwoKICAvLyBDb252ZW5pZW5jZSB2ZXJzaW9uIG9mIGEgY29tbW9uIHVzZSBjYXNlIG9mIGBmaW5kYDogZ2V0dGluZyB0aGUgZmlyc3Qgb2JqZWN0CiAgLy8gY29udGFpbmluZyBzcGVjaWZpYyBga2V5OnZhbHVlYCBwYWlycy4KICBfLmZpbmRXaGVyZSA9IGZ1bmN0aW9uKG9iaiwgYXR0cnMpIHsKICAgIHJldHVybiBfLmZpbmQob2JqLCBfLm1hdGNoZXIoYXR0cnMpKTsKICB9OwoKICAvLyBSZXR1cm4gdGhlIG1heGltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuCiAgXy5tYXggPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CiAgICB2YXIgcmVzdWx0ID0gLUluZmluaXR5LCBsYXN0Q29tcHV0ZWQgPSAtSW5maW5pdHksCiAgICAgICAgdmFsdWUsIGNvbXB1dGVkOwogICAgaWYgKGl0ZXJhdGVlID09IG51bGwgJiYgb2JqICE9IG51bGwpIHsKICAgICAgb2JqID0gaXNBcnJheUxpa2Uob2JqKSA/IG9iaiA6IF8udmFsdWVzKG9iaik7CiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBvYmoubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICB2YWx1ZSA9IG9ialtpXTsKICAgICAgICBpZiAodmFsdWUgPiByZXN1bHQpIHsKICAgICAgICAgIHJlc3VsdCA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CiAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUodmFsdWUsIGluZGV4LCBsaXN0KTsKICAgICAgICBpZiAoY29tcHV0ZWQgPiBsYXN0Q29tcHV0ZWQgfHwgY29tcHV0ZWQgPT09IC1JbmZpbml0eSAmJiByZXN1bHQgPT09IC1JbmZpbml0eSkgewogICAgICAgICAgcmVzdWx0ID0gdmFsdWU7CiAgICAgICAgICBsYXN0Q29tcHV0ZWQgPSBjb21wdXRlZDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICAvLyBSZXR1cm4gdGhlIG1pbmltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuCiAgXy5taW4gPSBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CiAgICB2YXIgcmVzdWx0ID0gSW5maW5pdHksIGxhc3RDb21wdXRlZCA9IEluZmluaXR5LAogICAgICAgIHZhbHVlLCBjb21wdXRlZDsKICAgIGlmIChpdGVyYXRlZSA9PSBudWxsICYmIG9iaiAhPSBudWxsKSB7CiAgICAgIG9iaiA9IGlzQXJyYXlMaWtlKG9iaikgPyBvYmogOiBfLnZhbHVlcyhvYmopOwogICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gb2JqLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFsdWUgPSBvYmpbaV07CiAgICAgICAgaWYgKHZhbHVlIDwgcmVzdWx0KSB7CiAgICAgICAgICByZXN1bHQgPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpOwogICAgICBfLmVhY2gob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHsKICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCk7CiAgICAgICAgaWYgKGNvbXB1dGVkIDwgbGFzdENvbXB1dGVkIHx8IGNvbXB1dGVkID09PSBJbmZpbml0eSAmJiByZXN1bHQgPT09IEluZmluaXR5KSB7CiAgICAgICAgICByZXN1bHQgPSB2YWx1ZTsKICAgICAgICAgIGxhc3RDb21wdXRlZCA9IGNvbXB1dGVkOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogIC8vIFNodWZmbGUgYSBjb2xsZWN0aW9uLCB1c2luZyB0aGUgbW9kZXJuIHZlcnNpb24gb2YgdGhlCiAgLy8gW0Zpc2hlci1ZYXRlcyBzaHVmZmxlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Zpc2hlcuKAk1lhdGVzX3NodWZmbGUpLgogIF8uc2h1ZmZsZSA9IGZ1bmN0aW9uKG9iaikgewogICAgdmFyIHNldCA9IGlzQXJyYXlMaWtlKG9iaikgPyBvYmogOiBfLnZhbHVlcyhvYmopOwogICAgdmFyIGxlbmd0aCA9IHNldC5sZW5ndGg7CiAgICB2YXIgc2h1ZmZsZWQgPSBBcnJheShsZW5ndGgpOwogICAgZm9yICh2YXIgaW5kZXggPSAwLCByYW5kOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewogICAgICByYW5kID0gXy5yYW5kb20oMCwgaW5kZXgpOwogICAgICBpZiAocmFuZCAhPT0gaW5kZXgpIHNodWZmbGVkW2luZGV4XSA9IHNodWZmbGVkW3JhbmRdOwogICAgICBzaHVmZmxlZFtyYW5kXSA9IHNldFtpbmRleF07CiAgICB9CiAgICByZXR1cm4gc2h1ZmZsZWQ7CiAgfTsKCiAgLy8gU2FtcGxlICoqbioqIHJhbmRvbSB2YWx1ZXMgZnJvbSBhIGNvbGxlY3Rpb24uCiAgLy8gSWYgKipuKiogaXMgbm90IHNwZWNpZmllZCwgcmV0dXJucyBhIHNpbmdsZSByYW5kb20gZWxlbWVudC4KICAvLyBUaGUgaW50ZXJuYWwgYGd1YXJkYCBhcmd1bWVudCBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBtYXBgLgogIF8uc2FtcGxlID0gZnVuY3Rpb24ob2JqLCBuLCBndWFyZCkgewogICAgaWYgKG4gPT0gbnVsbCB8fCBndWFyZCkgewogICAgICBpZiAoIWlzQXJyYXlMaWtlKG9iaikpIG9iaiA9IF8udmFsdWVzKG9iaik7CiAgICAgIHJldHVybiBvYmpbXy5yYW5kb20ob2JqLmxlbmd0aCAtIDEpXTsKICAgIH0KICAgIHJldHVybiBfLnNodWZmbGUob2JqKS5zbGljZSgwLCBNYXRoLm1heCgwLCBuKSk7CiAgfTsKCiAgLy8gU29ydCB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uIHByb2R1Y2VkIGJ5IGFuIGl0ZXJhdGVlLgogIF8uc29ydEJ5ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRlZSwgY29udGV4dCkgewogICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CiAgICByZXR1cm4gXy5wbHVjayhfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICByZXR1cm4gewogICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgY3JpdGVyaWE6IGl0ZXJhdGVlKHZhbHVlLCBpbmRleCwgbGlzdCkKICAgICAgfTsKICAgIH0pLnNvcnQoZnVuY3Rpb24obGVmdCwgcmlnaHQpIHsKICAgICAgdmFyIGEgPSBsZWZ0LmNyaXRlcmlhOwogICAgICB2YXIgYiA9IHJpZ2h0LmNyaXRlcmlhOwogICAgICBpZiAoYSAhPT0gYikgewogICAgICAgIGlmIChhID4gYiB8fCBhID09PSB2b2lkIDApIHJldHVybiAxOwogICAgICAgIGlmIChhIDwgYiB8fCBiID09PSB2b2lkIDApIHJldHVybiAtMTsKICAgICAgfQogICAgICByZXR1cm4gbGVmdC5pbmRleCAtIHJpZ2h0LmluZGV4OwogICAgfSksICd2YWx1ZScpOwogIH07CgogIC8vIEFuIGludGVybmFsIGZ1bmN0aW9uIHVzZWQgZm9yIGFnZ3JlZ2F0ZSAiZ3JvdXAgYnkiIG9wZXJhdGlvbnMuCiAgdmFyIGdyb3VwID0gZnVuY3Rpb24oYmVoYXZpb3IpIHsKICAgIHJldHVybiBmdW5jdGlvbihvYmosIGl0ZXJhdGVlLCBjb250ZXh0KSB7CiAgICAgIHZhciByZXN1bHQgPSB7fTsKICAgICAgaXRlcmF0ZWUgPSBjYihpdGVyYXRlZSwgY29udGV4dCk7CiAgICAgIF8uZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkgewogICAgICAgIHZhciBrZXkgPSBpdGVyYXRlZSh2YWx1ZSwgaW5kZXgsIG9iaik7CiAgICAgICAgYmVoYXZpb3IocmVzdWx0LCB2YWx1ZSwga2V5KTsKICAgICAgfSk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwogIH07CgogIC8vIEdyb3VwcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLiBQYXNzIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGUKICAvLyB0byBncm91cCBieSwgb3IgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGNyaXRlcmlvbi4KICBfLmdyb3VwQnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHsKICAgIGlmIChfLmhhcyhyZXN1bHQsIGtleSkpIHJlc3VsdFtrZXldLnB1c2godmFsdWUpOyBlbHNlIHJlc3VsdFtrZXldID0gW3ZhbHVlXTsKICB9KTsKCiAgLy8gSW5kZXhlcyB0aGUgb2JqZWN0J3MgdmFsdWVzIGJ5IGEgY3JpdGVyaW9uLCBzaW1pbGFyIHRvIGBncm91cEJ5YCwgYnV0IGZvcgogIC8vIHdoZW4geW91IGtub3cgdGhhdCB5b3VyIGluZGV4IHZhbHVlcyB3aWxsIGJlIHVuaXF1ZS4KICBfLmluZGV4QnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHsKICAgIHJlc3VsdFtrZXldID0gdmFsdWU7CiAgfSk7CgogIC8vIENvdW50cyBpbnN0YW5jZXMgb2YgYW4gb2JqZWN0IHRoYXQgZ3JvdXAgYnkgYSBjZXJ0YWluIGNyaXRlcmlvbi4gUGFzcwogIC8vIGVpdGhlciBhIHN0cmluZyBhdHRyaWJ1dGUgdG8gY291bnQgYnksIG9yIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZQogIC8vIGNyaXRlcmlvbi4KICBfLmNvdW50QnkgPSBncm91cChmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHsKICAgIGlmIChfLmhhcyhyZXN1bHQsIGtleSkpIHJlc3VsdFtrZXldKys7IGVsc2UgcmVzdWx0W2tleV0gPSAxOwogIH0pOwoKICAvLyBTYWZlbHkgY3JlYXRlIGEgcmVhbCwgbGl2ZSBhcnJheSBmcm9tIGFueXRoaW5nIGl0ZXJhYmxlLgogIF8udG9BcnJheSA9IGZ1bmN0aW9uKG9iaikgewogICAgaWYgKCFvYmopIHJldHVybiBbXTsKICAgIGlmIChfLmlzQXJyYXkob2JqKSkgcmV0dXJuIHNsaWNlLmNhbGwob2JqKTsKICAgIGlmIChpc0FycmF5TGlrZShvYmopKSByZXR1cm4gXy5tYXAob2JqLCBfLmlkZW50aXR5KTsKICAgIHJldHVybiBfLnZhbHVlcyhvYmopOwogIH07CgogIC8vIFJldHVybiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9iamVjdC4KICBfLnNpemUgPSBmdW5jdGlvbihvYmopIHsKICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIDA7CiAgICByZXR1cm4gaXNBcnJheUxpa2Uob2JqKSA/IG9iai5sZW5ndGggOiBfLmtleXMob2JqKS5sZW5ndGg7CiAgfTsKCiAgLy8gU3BsaXQgYSBjb2xsZWN0aW9uIGludG8gdHdvIGFycmF5czogb25lIHdob3NlIGVsZW1lbnRzIGFsbCBzYXRpc2Z5IHRoZSBnaXZlbgogIC8vIHByZWRpY2F0ZSwgYW5kIG9uZSB3aG9zZSBlbGVtZW50cyBhbGwgZG8gbm90IHNhdGlzZnkgdGhlIHByZWRpY2F0ZS4KICBfLnBhcnRpdGlvbiA9IGZ1bmN0aW9uKG9iaiwgcHJlZGljYXRlLCBjb250ZXh0KSB7CiAgICBwcmVkaWNhdGUgPSBjYihwcmVkaWNhdGUsIGNvbnRleHQpOwogICAgdmFyIHBhc3MgPSBbXSwgZmFpbCA9IFtdOwogICAgXy5lYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGtleSwgb2JqKSB7CiAgICAgIChwcmVkaWNhdGUodmFsdWUsIGtleSwgb2JqKSA/IHBhc3MgOiBmYWlsKS5wdXNoKHZhbHVlKTsKICAgIH0pOwogICAgcmV0dXJuIFtwYXNzLCBmYWlsXTsKICB9OwoKICAvLyBBcnJheSBGdW5jdGlvbnMKICAvLyAtLS0tLS0tLS0tLS0tLS0KCiAgLy8gR2V0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIHRoZSBmaXJzdCBOCiAgLy8gdmFsdWVzIGluIHRoZSBhcnJheS4gQWxpYXNlZCBhcyBgaGVhZGAgYW5kIGB0YWtlYC4gVGhlICoqZ3VhcmQqKiBjaGVjawogIC8vIGFsbG93cyBpdCB0byB3b3JrIHdpdGggYF8ubWFwYC4KICBfLmZpcnN0ID0gXy5oZWFkID0gXy50YWtlID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIHZvaWQgMDsKICAgIGlmIChuID09IG51bGwgfHwgZ3VhcmQpIHJldHVybiBhcnJheVswXTsKICAgIHJldHVybiBfLmluaXRpYWwoYXJyYXksIGFycmF5Lmxlbmd0aCAtIG4pOwogIH07CgogIC8vIFJldHVybnMgZXZlcnl0aGluZyBidXQgdGhlIGxhc3QgZW50cnkgb2YgdGhlIGFycmF5LiBFc3BlY2lhbGx5IHVzZWZ1bCBvbgogIC8vIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nICoqbioqIHdpbGwgcmV0dXJuIGFsbCB0aGUgdmFsdWVzIGluCiAgLy8gdGhlIGFycmF5LCBleGNsdWRpbmcgdGhlIGxhc3QgTi4KICBfLmluaXRpYWwgPSBmdW5jdGlvbihhcnJheSwgbiwgZ3VhcmQpIHsKICAgIHJldHVybiBzbGljZS5jYWxsKGFycmF5LCAwLCBNYXRoLm1heCgwLCBhcnJheS5sZW5ndGggLSAobiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pKSk7CiAgfTsKCiAgLy8gR2V0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGxhc3QgTgogIC8vIHZhbHVlcyBpbiB0aGUgYXJyYXkuCiAgXy5sYXN0ID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIHZvaWQgMDsKICAgIGlmIChuID09IG51bGwgfHwgZ3VhcmQpIHJldHVybiBhcnJheVthcnJheS5sZW5ndGggLSAxXTsKICAgIHJldHVybiBfLnJlc3QoYXJyYXksIE1hdGgubWF4KDAsIGFycmF5Lmxlbmd0aCAtIG4pKTsKICB9OwoKICAvLyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBmaXJzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEFsaWFzZWQgYXMgYHRhaWxgIGFuZCBgZHJvcGAuCiAgLy8gRXNwZWNpYWxseSB1c2VmdWwgb24gdGhlIGFyZ3VtZW50cyBvYmplY3QuIFBhc3NpbmcgYW4gKipuKiogd2lsbCByZXR1cm4KICAvLyB0aGUgcmVzdCBOIHZhbHVlcyBpbiB0aGUgYXJyYXkuCiAgXy5yZXN0ID0gXy50YWlsID0gXy5kcm9wID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CiAgICByZXR1cm4gc2xpY2UuY2FsbChhcnJheSwgbiA9PSBudWxsIHx8IGd1YXJkID8gMSA6IG4pOwogIH07CgogIC8vIFRyaW0gb3V0IGFsbCBmYWxzeSB2YWx1ZXMgZnJvbSBhbiBhcnJheS4KICBfLmNvbXBhY3QgPSBmdW5jdGlvbihhcnJheSkgewogICAgcmV0dXJuIF8uZmlsdGVyKGFycmF5LCBfLmlkZW50aXR5KTsKICB9OwoKICAvLyBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBvZiBhIHJlY3Vyc2l2ZSBgZmxhdHRlbmAgZnVuY3Rpb24uCiAgdmFyIGZsYXR0ZW4gPSBmdW5jdGlvbihpbnB1dCwgc2hhbGxvdywgc3RyaWN0LCBzdGFydEluZGV4KSB7CiAgICB2YXIgb3V0cHV0ID0gW10sIGlkeCA9IDA7CiAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleCB8fCAwLCBsZW5ndGggPSBnZXRMZW5ndGgoaW5wdXQpOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIHZhbHVlID0gaW5wdXRbaV07CiAgICAgIGlmIChpc0FycmF5TGlrZSh2YWx1ZSkgJiYgKF8uaXNBcnJheSh2YWx1ZSkgfHwgXy5pc0FyZ3VtZW50cyh2YWx1ZSkpKSB7CiAgICAgICAgLy9mbGF0dGVuIGN1cnJlbnQgbGV2ZWwgb2YgYXJyYXkgb3IgYXJndW1lbnRzIG9iamVjdAogICAgICAgIGlmICghc2hhbGxvdykgdmFsdWUgPSBmbGF0dGVuKHZhbHVlLCBzaGFsbG93LCBzdHJpY3QpOwogICAgICAgIHZhciBqID0gMCwgbGVuID0gdmFsdWUubGVuZ3RoOwogICAgICAgIG91dHB1dC5sZW5ndGggKz0gbGVuOwogICAgICAgIHdoaWxlIChqIDwgbGVuKSB7CiAgICAgICAgICBvdXRwdXRbaWR4KytdID0gdmFsdWVbaisrXTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIXN0cmljdCkgewogICAgICAgIG91dHB1dFtpZHgrK10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIG91dHB1dDsKICB9OwoKICAvLyBGbGF0dGVuIG91dCBhbiBhcnJheSwgZWl0aGVyIHJlY3Vyc2l2ZWx5IChieSBkZWZhdWx0KSwgb3IganVzdCBvbmUgbGV2ZWwuCiAgXy5mbGF0dGVuID0gZnVuY3Rpb24oYXJyYXksIHNoYWxsb3cpIHsKICAgIHJldHVybiBmbGF0dGVuKGFycmF5LCBzaGFsbG93LCBmYWxzZSk7CiAgfTsKCiAgLy8gUmV0dXJuIGEgdmVyc2lvbiBvZiB0aGUgYXJyYXkgdGhhdCBkb2VzIG5vdCBjb250YWluIHRoZSBzcGVjaWZpZWQgdmFsdWUocykuCiAgXy53aXRob3V0ID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgIHJldHVybiBfLmRpZmZlcmVuY2UoYXJyYXksIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7CiAgfTsKCiAgLy8gUHJvZHVjZSBhIGR1cGxpY2F0ZS1mcmVlIHZlcnNpb24gb2YgdGhlIGFycmF5LiBJZiB0aGUgYXJyYXkgaGFzIGFscmVhZHkKICAvLyBiZWVuIHNvcnRlZCwgeW91IGhhdmUgdGhlIG9wdGlvbiBvZiB1c2luZyBhIGZhc3RlciBhbGdvcml0aG0uCiAgLy8gQWxpYXNlZCBhcyBgdW5pcXVlYC4KICBfLnVuaXEgPSBfLnVuaXF1ZSA9IGZ1bmN0aW9uKGFycmF5LCBpc1NvcnRlZCwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKICAgIGlmICghXy5pc0Jvb2xlYW4oaXNTb3J0ZWQpKSB7CiAgICAgIGNvbnRleHQgPSBpdGVyYXRlZTsKICAgICAgaXRlcmF0ZWUgPSBpc1NvcnRlZDsKICAgICAgaXNTb3J0ZWQgPSBmYWxzZTsKICAgIH0KICAgIGlmIChpdGVyYXRlZSAhPSBudWxsKSBpdGVyYXRlZSA9IGNiKGl0ZXJhdGVlLCBjb250ZXh0KTsKICAgIHZhciByZXN1bHQgPSBbXTsKICAgIHZhciBzZWVuID0gW107CiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGFycmF5KTsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2ldLAogICAgICAgICAgY29tcHV0ZWQgPSBpdGVyYXRlZSA/IGl0ZXJhdGVlKHZhbHVlLCBpLCBhcnJheSkgOiB2YWx1ZTsKICAgICAgaWYgKGlzU29ydGVkKSB7CiAgICAgICAgaWYgKCFpIHx8IHNlZW4gIT09IGNvbXB1dGVkKSByZXN1bHQucHVzaCh2YWx1ZSk7CiAgICAgICAgc2VlbiA9IGNvbXB1dGVkOwogICAgICB9IGVsc2UgaWYgKGl0ZXJhdGVlKSB7CiAgICAgICAgaWYgKCFfLmNvbnRhaW5zKHNlZW4sIGNvbXB1dGVkKSkgewogICAgICAgICAgc2Vlbi5wdXNoKGNvbXB1dGVkKTsKICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIV8uY29udGFpbnMocmVzdWx0LCB2YWx1ZSkpIHsKICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSB1bmlvbjogZWFjaCBkaXN0aW5jdCBlbGVtZW50IGZyb20gYWxsIG9mCiAgLy8gdGhlIHBhc3NlZC1pbiBhcnJheXMuCiAgXy51bmlvbiA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIF8udW5pcShmbGF0dGVuKGFyZ3VtZW50cywgdHJ1ZSwgdHJ1ZSkpOwogIH07CgogIC8vIFByb2R1Y2UgYW4gYXJyYXkgdGhhdCBjb250YWlucyBldmVyeSBpdGVtIHNoYXJlZCBiZXR3ZWVuIGFsbCB0aGUKICAvLyBwYXNzZWQtaW4gYXJyYXlzLgogIF8uaW50ZXJzZWN0aW9uID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgIHZhciByZXN1bHQgPSBbXTsKICAgIHZhciBhcmdzTGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsKICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZXRMZW5ndGgoYXJyYXkpOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGl0ZW0gPSBhcnJheVtpXTsKICAgICAgaWYgKF8uY29udGFpbnMocmVzdWx0LCBpdGVtKSkgY29udGludWU7CiAgICAgIGZvciAodmFyIGogPSAxOyBqIDwgYXJnc0xlbmd0aDsgaisrKSB7CiAgICAgICAgaWYgKCFfLmNvbnRhaW5zKGFyZ3VtZW50c1tqXSwgaXRlbSkpIGJyZWFrOwogICAgICB9CiAgICAgIGlmIChqID09PSBhcmdzTGVuZ3RoKSByZXN1bHQucHVzaChpdGVtKTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLy8gVGFrZSB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIG9uZSBhcnJheSBhbmQgYSBudW1iZXIgb2Ygb3RoZXIgYXJyYXlzLgogIC8vIE9ubHkgdGhlIGVsZW1lbnRzIHByZXNlbnQgaW4ganVzdCB0aGUgZmlyc3QgYXJyYXkgd2lsbCByZW1haW4uCiAgXy5kaWZmZXJlbmNlID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgIHZhciByZXN0ID0gZmxhdHRlbihhcmd1bWVudHMsIHRydWUsIHRydWUsIDEpOwogICAgcmV0dXJuIF8uZmlsdGVyKGFycmF5LCBmdW5jdGlvbih2YWx1ZSl7CiAgICAgIHJldHVybiAhXy5jb250YWlucyhyZXN0LCB2YWx1ZSk7CiAgICB9KTsKICB9OwoKICAvLyBaaXAgdG9nZXRoZXIgbXVsdGlwbGUgbGlzdHMgaW50byBhIHNpbmdsZSBhcnJheSAtLSBlbGVtZW50cyB0aGF0IHNoYXJlCiAgLy8gYW4gaW5kZXggZ28gdG9nZXRoZXIuCiAgXy56aXAgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBfLnVuemlwKGFyZ3VtZW50cyk7CiAgfTsKCiAgLy8gQ29tcGxlbWVudCBvZiBfLnppcC4gVW56aXAgYWNjZXB0cyBhbiBhcnJheSBvZiBhcnJheXMgYW5kIGdyb3VwcwogIC8vIGVhY2ggYXJyYXkncyBlbGVtZW50cyBvbiBzaGFyZWQgaW5kaWNlcwogIF8udW56aXAgPSBmdW5jdGlvbihhcnJheSkgewogICAgdmFyIGxlbmd0aCA9IGFycmF5ICYmIF8ubWF4KGFycmF5LCBnZXRMZW5ndGgpLmxlbmd0aCB8fCAwOwogICAgdmFyIHJlc3VsdCA9IEFycmF5KGxlbmd0aCk7CgogICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKykgewogICAgICByZXN1bHRbaW5kZXhdID0gXy5wbHVjayhhcnJheSwgaW5kZXgpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICAvLyBDb252ZXJ0cyBsaXN0cyBpbnRvIG9iamVjdHMuIFBhc3MgZWl0aGVyIGEgc2luZ2xlIGFycmF5IG9mIGBba2V5LCB2YWx1ZV1gCiAgLy8gcGFpcnMsIG9yIHR3byBwYXJhbGxlbCBhcnJheXMgb2YgdGhlIHNhbWUgbGVuZ3RoIC0tIG9uZSBvZiBrZXlzLCBhbmQgb25lIG9mCiAgLy8gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWVzLgogIF8ub2JqZWN0ID0gZnVuY3Rpb24obGlzdCwgdmFsdWVzKSB7CiAgICB2YXIgcmVzdWx0ID0ge307CiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gZ2V0TGVuZ3RoKGxpc3QpOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKHZhbHVlcykgewogICAgICAgIHJlc3VsdFtsaXN0W2ldXSA9IHZhbHVlc1tpXTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN1bHRbbGlzdFtpXVswXV0gPSBsaXN0W2ldWzFdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogIC8vIEdlbmVyYXRvciBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIGZpbmRJbmRleCBhbmQgZmluZExhc3RJbmRleCBmdW5jdGlvbnMKICBmdW5jdGlvbiBjcmVhdGVQcmVkaWNhdGVJbmRleEZpbmRlcihkaXIpIHsKICAgIHJldHVybiBmdW5jdGlvbihhcnJheSwgcHJlZGljYXRlLCBjb250ZXh0KSB7CiAgICAgIHByZWRpY2F0ZSA9IGNiKHByZWRpY2F0ZSwgY29udGV4dCk7CiAgICAgIHZhciBsZW5ndGggPSBnZXRMZW5ndGgoYXJyYXkpOwogICAgICB2YXIgaW5kZXggPSBkaXIgPiAwID8gMCA6IGxlbmd0aCAtIDE7CiAgICAgIGZvciAoOyBpbmRleCA+PSAwICYmIGluZGV4IDwgbGVuZ3RoOyBpbmRleCArPSBkaXIpIHsKICAgICAgICBpZiAocHJlZGljYXRlKGFycmF5W2luZGV4XSwgaW5kZXgsIGFycmF5KSkgcmV0dXJuIGluZGV4OwogICAgICB9CiAgICAgIHJldHVybiAtMTsKICAgIH07CiAgfQoKICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBpbmRleCBvbiBhbiBhcnJheS1saWtlIHRoYXQgcGFzc2VzIGEgcHJlZGljYXRlIHRlc3QKICBfLmZpbmRJbmRleCA9IGNyZWF0ZVByZWRpY2F0ZUluZGV4RmluZGVyKDEpOwogIF8uZmluZExhc3RJbmRleCA9IGNyZWF0ZVByZWRpY2F0ZUluZGV4RmluZGVyKC0xKTsKCiAgLy8gVXNlIGEgY29tcGFyYXRvciBmdW5jdGlvbiB0byBmaWd1cmUgb3V0IHRoZSBzbWFsbGVzdCBpbmRleCBhdCB3aGljaAogIC8vIGFuIG9iamVjdCBzaG91bGQgYmUgaW5zZXJ0ZWQgc28gYXMgdG8gbWFpbnRhaW4gb3JkZXIuIFVzZXMgYmluYXJ5IHNlYXJjaC4KICBfLnNvcnRlZEluZGV4ID0gZnVuY3Rpb24oYXJyYXksIG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQsIDEpOwogICAgdmFyIHZhbHVlID0gaXRlcmF0ZWUob2JqKTsKICAgIHZhciBsb3cgPSAwLCBoaWdoID0gZ2V0TGVuZ3RoKGFycmF5KTsKICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7CiAgICAgIHZhciBtaWQgPSBNYXRoLmZsb29yKChsb3cgKyBoaWdoKSAvIDIpOwogICAgICBpZiAoaXRlcmF0ZWUoYXJyYXlbbWlkXSkgPCB2YWx1ZSkgbG93ID0gbWlkICsgMTsgZWxzZSBoaWdoID0gbWlkOwogICAgfQogICAgcmV0dXJuIGxvdzsKICB9OwoKICAvLyBHZW5lcmF0b3IgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBpbmRleE9mIGFuZCBsYXN0SW5kZXhPZiBmdW5jdGlvbnMKICBmdW5jdGlvbiBjcmVhdGVJbmRleEZpbmRlcihkaXIsIHByZWRpY2F0ZUZpbmQsIHNvcnRlZEluZGV4KSB7CiAgICByZXR1cm4gZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGlkeCkgewogICAgICB2YXIgaSA9IDAsIGxlbmd0aCA9IGdldExlbmd0aChhcnJheSk7CiAgICAgIGlmICh0eXBlb2YgaWR4ID09ICdudW1iZXInKSB7CiAgICAgICAgaWYgKGRpciA+IDApIHsKICAgICAgICAgICAgaSA9IGlkeCA+PSAwID8gaWR4IDogTWF0aC5tYXgoaWR4ICsgbGVuZ3RoLCBpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsZW5ndGggPSBpZHggPj0gMCA/IE1hdGgubWluKGlkeCArIDEsIGxlbmd0aCkgOiBpZHggKyBsZW5ndGggKyAxOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzb3J0ZWRJbmRleCAmJiBpZHggJiYgbGVuZ3RoKSB7CiAgICAgICAgaWR4ID0gc29ydGVkSW5kZXgoYXJyYXksIGl0ZW0pOwogICAgICAgIHJldHVybiBhcnJheVtpZHhdID09PSBpdGVtID8gaWR4IDogLTE7CiAgICAgIH0KICAgICAgaWYgKGl0ZW0gIT09IGl0ZW0pIHsKICAgICAgICBpZHggPSBwcmVkaWNhdGVGaW5kKHNsaWNlLmNhbGwoYXJyYXksIGksIGxlbmd0aCksIF8uaXNOYU4pOwogICAgICAgIHJldHVybiBpZHggPj0gMCA/IGlkeCArIGkgOiAtMTsKICAgICAgfQogICAgICBmb3IgKGlkeCA9IGRpciA+IDAgPyBpIDogbGVuZ3RoIC0gMTsgaWR4ID49IDAgJiYgaWR4IDwgbGVuZ3RoOyBpZHggKz0gZGlyKSB7CiAgICAgICAgaWYgKGFycmF5W2lkeF0gPT09IGl0ZW0pIHJldHVybiBpZHg7CiAgICAgIH0KICAgICAgcmV0dXJuIC0xOwogICAgfTsKICB9CgogIC8vIFJldHVybiB0aGUgcG9zaXRpb24gb2YgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gaXRlbSBpbiBhbiBhcnJheSwKICAvLyBvciAtMSBpZiB0aGUgaXRlbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGFycmF5LgogIC8vIElmIHRoZSBhcnJheSBpcyBsYXJnZSBhbmQgYWxyZWFkeSBpbiBzb3J0IG9yZGVyLCBwYXNzIGB0cnVlYAogIC8vIGZvciAqKmlzU29ydGVkKiogdG8gdXNlIGJpbmFyeSBzZWFyY2guCiAgXy5pbmRleE9mID0gY3JlYXRlSW5kZXhGaW5kZXIoMSwgXy5maW5kSW5kZXgsIF8uc29ydGVkSW5kZXgpOwogIF8ubGFzdEluZGV4T2YgPSBjcmVhdGVJbmRleEZpbmRlcigtMSwgXy5maW5kTGFzdEluZGV4KTsKCiAgLy8gR2VuZXJhdGUgYW4gaW50ZWdlciBBcnJheSBjb250YWluaW5nIGFuIGFyaXRobWV0aWMgcHJvZ3Jlc3Npb24uIEEgcG9ydCBvZgogIC8vIHRoZSBuYXRpdmUgUHl0aG9uIGByYW5nZSgpYCBmdW5jdGlvbi4gU2VlCiAgLy8gW3RoZSBQeXRob24gZG9jdW1lbnRhdGlvbl0oaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L2Z1bmN0aW9ucy5odG1sI3JhbmdlKS4KICBfLnJhbmdlID0gZnVuY3Rpb24oc3RhcnQsIHN0b3AsIHN0ZXApIHsKICAgIGlmIChzdG9wID09IG51bGwpIHsKICAgICAgc3RvcCA9IHN0YXJ0IHx8IDA7CiAgICAgIHN0YXJ0ID0gMDsKICAgIH0KICAgIHN0ZXAgPSBzdGVwIHx8IDE7CgogICAgdmFyIGxlbmd0aCA9IE1hdGgubWF4KE1hdGguY2VpbCgoc3RvcCAtIHN0YXJ0KSAvIHN0ZXApLCAwKTsKICAgIHZhciByYW5nZSA9IEFycmF5KGxlbmd0aCk7CgogICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuZ3RoOyBpZHgrKywgc3RhcnQgKz0gc3RlcCkgewogICAgICByYW5nZVtpZHhdID0gc3RhcnQ7CiAgICB9CgogICAgcmV0dXJuIHJhbmdlOwogIH07CgogIC8vIEZ1bmN0aW9uIChhaGVtKSBGdW5jdGlvbnMKICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0KCiAgLy8gRGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGV4ZWN1dGUgYSBmdW5jdGlvbiBhcyBhIGNvbnN0cnVjdG9yCiAgLy8gb3IgYSBub3JtYWwgZnVuY3Rpb24gd2l0aCB0aGUgcHJvdmlkZWQgYXJndW1lbnRzCiAgdmFyIGV4ZWN1dGVCb3VuZCA9IGZ1bmN0aW9uKHNvdXJjZUZ1bmMsIGJvdW5kRnVuYywgY29udGV4dCwgY2FsbGluZ0NvbnRleHQsIGFyZ3MpIHsKICAgIGlmICghKGNhbGxpbmdDb250ZXh0IGluc3RhbmNlb2YgYm91bmRGdW5jKSkgcmV0dXJuIHNvdXJjZUZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CiAgICB2YXIgc2VsZiA9IGJhc2VDcmVhdGUoc291cmNlRnVuYy5wcm90b3R5cGUpOwogICAgdmFyIHJlc3VsdCA9IHNvdXJjZUZ1bmMuYXBwbHkoc2VsZiwgYXJncyk7CiAgICBpZiAoXy5pc09iamVjdChyZXN1bHQpKSByZXR1cm4gcmVzdWx0OwogICAgcmV0dXJuIHNlbGY7CiAgfTsKCiAgLy8gQ3JlYXRlIGEgZnVuY3Rpb24gYm91bmQgdG8gYSBnaXZlbiBvYmplY3QgKGFzc2lnbmluZyBgdGhpc2AsIGFuZCBhcmd1bWVudHMsCiAgLy8gb3B0aW9uYWxseSkuIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBGdW5jdGlvbi5iaW5kYCBpZgogIC8vIGF2YWlsYWJsZS4KICBfLmJpbmQgPSBmdW5jdGlvbihmdW5jLCBjb250ZXh0KSB7CiAgICBpZiAobmF0aXZlQmluZCAmJiBmdW5jLmJpbmQgPT09IG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7CiAgICBpZiAoIV8uaXNGdW5jdGlvbihmdW5jKSkgdGhyb3cgbmV3IFR5cGVFcnJvcignQmluZCBtdXN0IGJlIGNhbGxlZCBvbiBhIGZ1bmN0aW9uJyk7CiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgIHZhciBib3VuZCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gZXhlY3V0ZUJvdW5kKGZ1bmMsIGJvdW5kLCBjb250ZXh0LCB0aGlzLCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTsKICAgIH07CiAgICByZXR1cm4gYm91bmQ7CiAgfTsKCiAgLy8gUGFydGlhbGx5IGFwcGx5IGEgZnVuY3Rpb24gYnkgY3JlYXRpbmcgYSB2ZXJzaW9uIHRoYXQgaGFzIGhhZCBzb21lIG9mIGl0cwogIC8vIGFyZ3VtZW50cyBwcmUtZmlsbGVkLCB3aXRob3V0IGNoYW5naW5nIGl0cyBkeW5hbWljIGB0aGlzYCBjb250ZXh0LiBfIGFjdHMKICAvLyBhcyBhIHBsYWNlaG9sZGVyLCBhbGxvd2luZyBhbnkgY29tYmluYXRpb24gb2YgYXJndW1lbnRzIHRvIGJlIHByZS1maWxsZWQuCiAgXy5wYXJ0aWFsID0gZnVuY3Rpb24oZnVuYykgewogICAgdmFyIGJvdW5kQXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgIHZhciBib3VuZCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcG9zaXRpb24gPSAwLCBsZW5ndGggPSBib3VuZEFyZ3MubGVuZ3RoOwogICAgICB2YXIgYXJncyA9IEFycmF5KGxlbmd0aCk7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBhcmdzW2ldID0gYm91bmRBcmdzW2ldID09PSBfID8gYXJndW1lbnRzW3Bvc2l0aW9uKytdIDogYm91bmRBcmdzW2ldOwogICAgICB9CiAgICAgIHdoaWxlIChwb3NpdGlvbiA8IGFyZ3VtZW50cy5sZW5ndGgpIGFyZ3MucHVzaChhcmd1bWVudHNbcG9zaXRpb24rK10pOwogICAgICByZXR1cm4gZXhlY3V0ZUJvdW5kKGZ1bmMsIGJvdW5kLCB0aGlzLCB0aGlzLCBhcmdzKTsKICAgIH07CiAgICByZXR1cm4gYm91bmQ7CiAgfTsKCiAgLy8gQmluZCBhIG51bWJlciBvZiBhbiBvYmplY3QncyBtZXRob2RzIHRvIHRoYXQgb2JqZWN0LiBSZW1haW5pbmcgYXJndW1lbnRzCiAgLy8gYXJlIHRoZSBtZXRob2QgbmFtZXMgdG8gYmUgYm91bmQuIFVzZWZ1bCBmb3IgZW5zdXJpbmcgdGhhdCBhbGwgY2FsbGJhY2tzCiAgLy8gZGVmaW5lZCBvbiBhbiBvYmplY3QgYmVsb25nIHRvIGl0LgogIF8uYmluZEFsbCA9IGZ1bmN0aW9uKG9iaikgewogICAgdmFyIGksIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsIGtleTsKICAgIGlmIChsZW5ndGggPD0gMSkgdGhyb3cgbmV3IEVycm9yKCdiaW5kQWxsIG11c3QgYmUgcGFzc2VkIGZ1bmN0aW9uIG5hbWVzJyk7CiAgICBmb3IgKGkgPSAxOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAga2V5ID0gYXJndW1lbnRzW2ldOwogICAgICBvYmpba2V5XSA9IF8uYmluZChvYmpba2V5XSwgb2JqKTsKICAgIH0KICAgIHJldHVybiBvYmo7CiAgfTsKCiAgLy8gTWVtb2l6ZSBhbiBleHBlbnNpdmUgZnVuY3Rpb24gYnkgc3RvcmluZyBpdHMgcmVzdWx0cy4KICBfLm1lbW9pemUgPSBmdW5jdGlvbihmdW5jLCBoYXNoZXIpIHsKICAgIHZhciBtZW1vaXplID0gZnVuY3Rpb24oa2V5KSB7CiAgICAgIHZhciBjYWNoZSA9IG1lbW9pemUuY2FjaGU7CiAgICAgIHZhciBhZGRyZXNzID0gJycgKyAoaGFzaGVyID8gaGFzaGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiBrZXkpOwogICAgICBpZiAoIV8uaGFzKGNhY2hlLCBhZGRyZXNzKSkgY2FjaGVbYWRkcmVzc10gPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIHJldHVybiBjYWNoZVthZGRyZXNzXTsKICAgIH07CiAgICBtZW1vaXplLmNhY2hlID0ge307CiAgICByZXR1cm4gbWVtb2l6ZTsKICB9OwoKICAvLyBEZWxheXMgYSBmdW5jdGlvbiBmb3IgdGhlIGdpdmVuIG51bWJlciBvZiBtaWxsaXNlY29uZHMsIGFuZCB0aGVuIGNhbGxzCiAgLy8gaXQgd2l0aCB0aGUgYXJndW1lbnRzIHN1cHBsaWVkLgogIF8uZGVsYXkgPSBmdW5jdGlvbihmdW5jLCB3YWl0KSB7CiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgIHJldHVybiBmdW5jLmFwcGx5KG51bGwsIGFyZ3MpOwogICAgfSwgd2FpdCk7CiAgfTsKCiAgLy8gRGVmZXJzIGEgZnVuY3Rpb24sIHNjaGVkdWxpbmcgaXQgdG8gcnVuIGFmdGVyIHRoZSBjdXJyZW50IGNhbGwgc3RhY2sgaGFzCiAgLy8gY2xlYXJlZC4KICBfLmRlZmVyID0gXy5wYXJ0aWFsKF8uZGVsYXksIF8sIDEpOwoKICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIHdoZW4gaW52b2tlZCwgd2lsbCBvbmx5IGJlIHRyaWdnZXJlZCBhdCBtb3N0IG9uY2UKICAvLyBkdXJpbmcgYSBnaXZlbiB3aW5kb3cgb2YgdGltZS4gTm9ybWFsbHksIHRoZSB0aHJvdHRsZWQgZnVuY3Rpb24gd2lsbCBydW4KICAvLyBhcyBtdWNoIGFzIGl0IGNhbiwgd2l0aG91dCBldmVyIGdvaW5nIG1vcmUgdGhhbiBvbmNlIHBlciBgd2FpdGAgZHVyYXRpb247CiAgLy8gYnV0IGlmIHlvdSdkIGxpa2UgdG8gZGlzYWJsZSB0aGUgZXhlY3V0aW9uIG9uIHRoZSBsZWFkaW5nIGVkZ2UsIHBhc3MKICAvLyBge2xlYWRpbmc6IGZhbHNlfWAuIFRvIGRpc2FibGUgZXhlY3V0aW9uIG9uIHRoZSB0cmFpbGluZyBlZGdlLCBkaXR0by4KICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgb3B0aW9ucykgewogICAgdmFyIGNvbnRleHQsIGFyZ3MsIHJlc3VsdDsKICAgIHZhciB0aW1lb3V0ID0gbnVsbDsKICAgIHZhciBwcmV2aW91cyA9IDA7CiAgICBpZiAoIW9wdGlvbnMpIG9wdGlvbnMgPSB7fTsKICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkgewogICAgICBwcmV2aW91cyA9IG9wdGlvbnMubGVhZGluZyA9PT0gZmFsc2UgPyAwIDogXy5ub3coKTsKICAgICAgdGltZW91dCA9IG51bGw7CiAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CiAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsOwogICAgfTsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgdmFyIG5vdyA9IF8ubm93KCk7CiAgICAgIGlmICghcHJldmlvdXMgJiYgb3B0aW9ucy5sZWFkaW5nID09PSBmYWxzZSkgcHJldmlvdXMgPSBub3c7CiAgICAgIHZhciByZW1haW5pbmcgPSB3YWl0IC0gKG5vdyAtIHByZXZpb3VzKTsKICAgICAgY29udGV4dCA9IHRoaXM7CiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7CiAgICAgIGlmIChyZW1haW5pbmcgPD0gMCB8fCByZW1haW5pbmcgPiB3YWl0KSB7CiAgICAgICAgaWYgKHRpbWVvdXQpIHsKICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAgICAgICAgIHRpbWVvdXQgPSBudWxsOwogICAgICAgIH0KICAgICAgICBwcmV2aW91cyA9IG5vdzsKICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpOwogICAgICAgIGlmICghdGltZW91dCkgY29udGV4dCA9IGFyZ3MgPSBudWxsOwogICAgICB9IGVsc2UgaWYgKCF0aW1lb3V0ICYmIG9wdGlvbnMudHJhaWxpbmcgIT09IGZhbHNlKSB7CiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHJlbWFpbmluZyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uLCB0aGF0LCBhcyBsb25nIGFzIGl0IGNvbnRpbnVlcyB0byBiZSBpbnZva2VkLCB3aWxsIG5vdAogIC8vIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3IKICAvLyBOIG1pbGxpc2Vjb25kcy4gSWYgYGltbWVkaWF0ZWAgaXMgcGFzc2VkLCB0cmlnZ2VyIHRoZSBmdW5jdGlvbiBvbiB0aGUKICAvLyBsZWFkaW5nIGVkZ2UsIGluc3RlYWQgb2YgdGhlIHRyYWlsaW5nLgogIF8uZGVib3VuY2UgPSBmdW5jdGlvbihmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHsKICAgIHZhciB0aW1lb3V0LCBhcmdzLCBjb250ZXh0LCB0aW1lc3RhbXAsIHJlc3VsdDsKCiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGxhc3QgPSBfLm5vdygpIC0gdGltZXN0YW1wOwoKICAgICAgaWYgKGxhc3QgPCB3YWl0ICYmIGxhc3QgPj0gMCkgewogICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0IC0gbGFzdCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGltZW91dCA9IG51bGw7CiAgICAgICAgaWYgKCFpbW1lZGlhdGUpIHsKICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CiAgICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICBjb250ZXh0ID0gdGhpczsKICAgICAgYXJncyA9IGFyZ3VtZW50czsKICAgICAgdGltZXN0YW1wID0gXy5ub3coKTsKICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7CiAgICAgIGlmICghdGltZW91dCkgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpOwogICAgICBpZiAoY2FsbE5vdykgewogICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7CiAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKICB9OwoKICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBmdW5jdGlvbiBwYXNzZWQgYXMgYW4gYXJndW1lbnQgdG8gdGhlIHNlY29uZCwKICAvLyBhbGxvd2luZyB5b3UgdG8gYWRqdXN0IGFyZ3VtZW50cywgcnVuIGNvZGUgYmVmb3JlIGFuZCBhZnRlciwgYW5kCiAgLy8gY29uZGl0aW9uYWxseSBleGVjdXRlIHRoZSBvcmlnaW5hbCBmdW5jdGlvbi4KICBfLndyYXAgPSBmdW5jdGlvbihmdW5jLCB3cmFwcGVyKSB7CiAgICByZXR1cm4gXy5wYXJ0aWFsKHdyYXBwZXIsIGZ1bmMpOwogIH07CgogIC8vIFJldHVybnMgYSBuZWdhdGVkIHZlcnNpb24gb2YgdGhlIHBhc3NlZC1pbiBwcmVkaWNhdGUuCiAgXy5uZWdhdGUgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuICFwcmVkaWNhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgaXMgdGhlIGNvbXBvc2l0aW9uIG9mIGEgbGlzdCBvZiBmdW5jdGlvbnMsIGVhY2gKICAvLyBjb25zdW1pbmcgdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgZnVuY3Rpb24gdGhhdCBmb2xsb3dzLgogIF8uY29tcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7CiAgICB2YXIgc3RhcnQgPSBhcmdzLmxlbmd0aCAtIDE7CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpID0gc3RhcnQ7CiAgICAgIHZhciByZXN1bHQgPSBhcmdzW3N0YXJ0XS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB3aGlsZSAoaS0tKSByZXN1bHQgPSBhcmdzW2ldLmNhbGwodGhpcywgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBvbmx5IGJlIGV4ZWN1dGVkIG9uIGFuZCBhZnRlciB0aGUgTnRoIGNhbGwuCiAgXy5hZnRlciA9IGZ1bmN0aW9uKHRpbWVzLCBmdW5jKSB7CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIGlmICgtLXRpbWVzIDwgMSkgewogICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgIH07CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBvbmx5IGJlIGV4ZWN1dGVkIHVwIHRvIChidXQgbm90IGluY2x1ZGluZykgdGhlIE50aCBjYWxsLgogIF8uYmVmb3JlID0gZnVuY3Rpb24odGltZXMsIGZ1bmMpIHsKICAgIHZhciBtZW1vOwogICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICBpZiAoLS10aW1lcyA+IDApIHsKICAgICAgICBtZW1vID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICAgIGlmICh0aW1lcyA8PSAxKSBmdW5jID0gbnVsbDsKICAgICAgcmV0dXJuIG1lbW87CiAgICB9OwogIH07CgogIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgZXhlY3V0ZWQgYXQgbW9zdCBvbmUgdGltZSwgbm8gbWF0dGVyIGhvdwogIC8vIG9mdGVuIHlvdSBjYWxsIGl0LiBVc2VmdWwgZm9yIGxhenkgaW5pdGlhbGl6YXRpb24uCiAgXy5vbmNlID0gXy5wYXJ0aWFsKF8uYmVmb3JlLCAyKTsKCiAgLy8gT2JqZWN0IEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0KCiAgLy8gS2V5cyBpbiBJRSA8IDkgdGhhdCB3b24ndCBiZSBpdGVyYXRlZCBieSBgZm9yIGtleSBpbiAuLi5gIGFuZCB0aHVzIG1pc3NlZC4KICB2YXIgaGFzRW51bUJ1ZyA9ICF7dG9TdHJpbmc6IG51bGx9LnByb3BlcnR5SXNFbnVtZXJhYmxlKCd0b1N0cmluZycpOwogIHZhciBub25FbnVtZXJhYmxlUHJvcHMgPSBbJ3ZhbHVlT2YnLCAnaXNQcm90b3R5cGVPZicsICd0b1N0cmluZycsCiAgICAgICAgICAgICAgICAgICAgICAncHJvcGVydHlJc0VudW1lcmFibGUnLCAnaGFzT3duUHJvcGVydHknLCAndG9Mb2NhbGVTdHJpbmcnXTsKCiAgZnVuY3Rpb24gY29sbGVjdE5vbkVudW1Qcm9wcyhvYmosIGtleXMpIHsKICAgIHZhciBub25FbnVtSWR4ID0gbm9uRW51bWVyYWJsZVByb3BzLmxlbmd0aDsKICAgIHZhciBjb25zdHJ1Y3RvciA9IG9iai5jb25zdHJ1Y3RvcjsKICAgIHZhciBwcm90byA9IChfLmlzRnVuY3Rpb24oY29uc3RydWN0b3IpICYmIGNvbnN0cnVjdG9yLnByb3RvdHlwZSkgfHwgT2JqUHJvdG87CgogICAgLy8gQ29uc3RydWN0b3IgaXMgYSBzcGVjaWFsIGNhc2UuCiAgICB2YXIgcHJvcCA9ICdjb25zdHJ1Y3Rvcic7CiAgICBpZiAoXy5oYXMob2JqLCBwcm9wKSAmJiAhXy5jb250YWlucyhrZXlzLCBwcm9wKSkga2V5cy5wdXNoKHByb3ApOwoKICAgIHdoaWxlIChub25FbnVtSWR4LS0pIHsKICAgICAgcHJvcCA9IG5vbkVudW1lcmFibGVQcm9wc1tub25FbnVtSWR4XTsKICAgICAgaWYgKHByb3AgaW4gb2JqICYmIG9ialtwcm9wXSAhPT0gcHJvdG9bcHJvcF0gJiYgIV8uY29udGFpbnMoa2V5cywgcHJvcCkpIHsKICAgICAgICBrZXlzLnB1c2gocHJvcCk7CiAgICAgIH0KICAgIH0KICB9CgogIC8vIFJldHJpZXZlIHRoZSBuYW1lcyBvZiBhbiBvYmplY3QncyBvd24gcHJvcGVydGllcy4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgT2JqZWN0LmtleXNgCiAgXy5rZXlzID0gZnVuY3Rpb24ob2JqKSB7CiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdOwogICAgaWYgKG5hdGl2ZUtleXMpIHJldHVybiBuYXRpdmVLZXlzKG9iaik7CiAgICB2YXIga2V5cyA9IFtdOwogICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKF8uaGFzKG9iaiwga2V5KSkga2V5cy5wdXNoKGtleSk7CiAgICAvLyBBaGVtLCBJRSA8IDkuCiAgICBpZiAoaGFzRW51bUJ1ZykgY29sbGVjdE5vbkVudW1Qcm9wcyhvYmosIGtleXMpOwogICAgcmV0dXJuIGtleXM7CiAgfTsKCiAgLy8gUmV0cmlldmUgYWxsIHRoZSBwcm9wZXJ0eSBuYW1lcyBvZiBhbiBvYmplY3QuCiAgXy5hbGxLZXlzID0gZnVuY3Rpb24ob2JqKSB7CiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIFtdOwogICAgdmFyIGtleXMgPSBbXTsKICAgIGZvciAodmFyIGtleSBpbiBvYmopIGtleXMucHVzaChrZXkpOwogICAgLy8gQWhlbSwgSUUgPCA5LgogICAgaWYgKGhhc0VudW1CdWcpIGNvbGxlY3ROb25FbnVtUHJvcHMob2JqLCBrZXlzKTsKICAgIHJldHVybiBrZXlzOwogIH07CgogIC8vIFJldHJpZXZlIHRoZSB2YWx1ZXMgb2YgYW4gb2JqZWN0J3MgcHJvcGVydGllcy4KICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9iaikgewogICAgdmFyIGtleXMgPSBfLmtleXMob2JqKTsKICAgIHZhciBsZW5ndGggPSBrZXlzLmxlbmd0aDsKICAgIHZhciB2YWx1ZXMgPSBBcnJheShsZW5ndGgpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICB2YWx1ZXNbaV0gPSBvYmpba2V5c1tpXV07CiAgICB9CiAgICByZXR1cm4gdmFsdWVzOwogIH07CgogIC8vIFJldHVybnMgdGhlIHJlc3VsdHMgb2YgYXBwbHlpbmcgdGhlIGl0ZXJhdGVlIHRvIGVhY2ggZWxlbWVudCBvZiB0aGUgb2JqZWN0CiAgLy8gSW4gY29udHJhc3QgdG8gXy5tYXAgaXQgcmV0dXJucyBhbiBvYmplY3QKICBfLm1hcE9iamVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKICAgIGl0ZXJhdGVlID0gY2IoaXRlcmF0ZWUsIGNvbnRleHQpOwogICAgdmFyIGtleXMgPSAgXy5rZXlzKG9iaiksCiAgICAgICAgICBsZW5ndGggPSBrZXlzLmxlbmd0aCwKICAgICAgICAgIHJlc3VsdHMgPSB7fSwKICAgICAgICAgIGN1cnJlbnRLZXk7CiAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHsKICAgICAgICBjdXJyZW50S2V5ID0ga2V5c1tpbmRleF07CiAgICAgICAgcmVzdWx0c1tjdXJyZW50S2V5XSA9IGl0ZXJhdGVlKG9ialtjdXJyZW50S2V5XSwgY3VycmVudEtleSwgb2JqKTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyBDb252ZXJ0IGFuIG9iamVjdCBpbnRvIGEgbGlzdCBvZiBgW2tleSwgdmFsdWVdYCBwYWlycy4KICBfLnBhaXJzID0gZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIga2V5cyA9IF8ua2V5cyhvYmopOwogICAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoOwogICAgdmFyIHBhaXJzID0gQXJyYXkobGVuZ3RoKTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgcGFpcnNbaV0gPSBba2V5c1tpXSwgb2JqW2tleXNbaV1dXTsKICAgIH0KICAgIHJldHVybiBwYWlyczsKICB9OwoKICAvLyBJbnZlcnQgdGhlIGtleXMgYW5kIHZhbHVlcyBvZiBhbiBvYmplY3QuIFRoZSB2YWx1ZXMgbXVzdCBiZSBzZXJpYWxpemFibGUuCiAgXy5pbnZlcnQgPSBmdW5jdGlvbihvYmopIHsKICAgIHZhciByZXN1bHQgPSB7fTsKICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaik7CiAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICByZXN1bHRbb2JqW2tleXNbaV1dXSA9IGtleXNbaV07CiAgICB9CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogIC8vIFJldHVybiBhIHNvcnRlZCBsaXN0IG9mIHRoZSBmdW5jdGlvbiBuYW1lcyBhdmFpbGFibGUgb24gdGhlIG9iamVjdC4KICAvLyBBbGlhc2VkIGFzIGBtZXRob2RzYAogIF8uZnVuY3Rpb25zID0gXy5tZXRob2RzID0gZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIgbmFtZXMgPSBbXTsKICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgaWYgKF8uaXNGdW5jdGlvbihvYmpba2V5XSkpIG5hbWVzLnB1c2goa2V5KTsKICAgIH0KICAgIHJldHVybiBuYW1lcy5zb3J0KCk7CiAgfTsKCiAgLy8gRXh0ZW5kIGEgZ2l2ZW4gb2JqZWN0IHdpdGggYWxsIHRoZSBwcm9wZXJ0aWVzIGluIHBhc3NlZC1pbiBvYmplY3QocykuCiAgXy5leHRlbmQgPSBjcmVhdGVBc3NpZ25lcihfLmFsbEtleXMpOwoKICAvLyBBc3NpZ25zIGEgZ2l2ZW4gb2JqZWN0IHdpdGggYWxsIHRoZSBvd24gcHJvcGVydGllcyBpbiB0aGUgcGFzc2VkLWluIG9iamVjdChzKQogIC8vIChodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvYXNzaWduKQogIF8uZXh0ZW5kT3duID0gXy5hc3NpZ24gPSBjcmVhdGVBc3NpZ25lcihfLmtleXMpOwoKICAvLyBSZXR1cm5zIHRoZSBmaXJzdCBrZXkgb24gYW4gb2JqZWN0IHRoYXQgcGFzc2VzIGEgcHJlZGljYXRlIHRlc3QKICBfLmZpbmRLZXkgPSBmdW5jdGlvbihvYmosIHByZWRpY2F0ZSwgY29udGV4dCkgewogICAgcHJlZGljYXRlID0gY2IocHJlZGljYXRlLCBjb250ZXh0KTsKICAgIHZhciBrZXlzID0gXy5rZXlzKG9iaiksIGtleTsKICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBrZXlzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGtleSA9IGtleXNbaV07CiAgICAgIGlmIChwcmVkaWNhdGUob2JqW2tleV0sIGtleSwgb2JqKSkgcmV0dXJuIGtleTsKICAgIH0KICB9OwoKICAvLyBSZXR1cm4gYSBjb3B5IG9mIHRoZSBvYmplY3Qgb25seSBjb250YWluaW5nIHRoZSB3aGl0ZWxpc3RlZCBwcm9wZXJ0aWVzLgogIF8ucGljayA9IGZ1bmN0aW9uKG9iamVjdCwgb2l0ZXJhdGVlLCBjb250ZXh0KSB7CiAgICB2YXIgcmVzdWx0ID0ge30sIG9iaiA9IG9iamVjdCwgaXRlcmF0ZWUsIGtleXM7CiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiByZXN1bHQ7CiAgICBpZiAoXy5pc0Z1bmN0aW9uKG9pdGVyYXRlZSkpIHsKICAgICAga2V5cyA9IF8uYWxsS2V5cyhvYmopOwogICAgICBpdGVyYXRlZSA9IG9wdGltaXplQ2Iob2l0ZXJhdGVlLCBjb250ZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIGtleXMgPSBmbGF0dGVuKGFyZ3VtZW50cywgZmFsc2UsIGZhbHNlLCAxKTsKICAgICAgaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmopIHsgcmV0dXJuIGtleSBpbiBvYmo7IH07CiAgICAgIG9iaiA9IE9iamVjdChvYmopOwogICAgfQogICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGtleXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGtleSA9IGtleXNbaV07CiAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldOwogICAgICBpZiAoaXRlcmF0ZWUodmFsdWUsIGtleSwgb2JqKSkgcmVzdWx0W2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgIC8vIFJldHVybiBhIGNvcHkgb2YgdGhlIG9iamVjdCB3aXRob3V0IHRoZSBibGFja2xpc3RlZCBwcm9wZXJ0aWVzLgogIF8ub21pdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpIHsKICAgIGlmIChfLmlzRnVuY3Rpb24oaXRlcmF0ZWUpKSB7CiAgICAgIGl0ZXJhdGVlID0gXy5uZWdhdGUoaXRlcmF0ZWUpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGtleXMgPSBfLm1hcChmbGF0dGVuKGFyZ3VtZW50cywgZmFsc2UsIGZhbHNlLCAxKSwgU3RyaW5nKTsKICAgICAgaXRlcmF0ZWUgPSBmdW5jdGlvbih2YWx1ZSwga2V5KSB7CiAgICAgICAgcmV0dXJuICFfLmNvbnRhaW5zKGtleXMsIGtleSk7CiAgICAgIH07CiAgICB9CiAgICByZXR1cm4gXy5waWNrKG9iaiwgaXRlcmF0ZWUsIGNvbnRleHQpOwogIH07CgogIC8vIEZpbGwgaW4gYSBnaXZlbiBvYmplY3Qgd2l0aCBkZWZhdWx0IHByb3BlcnRpZXMuCiAgXy5kZWZhdWx0cyA9IGNyZWF0ZUFzc2lnbmVyKF8uYWxsS2V5cywgdHJ1ZSk7CgogIC8vIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgaW5oZXJpdHMgZnJvbSB0aGUgZ2l2ZW4gcHJvdG90eXBlIG9iamVjdC4KICAvLyBJZiBhZGRpdGlvbmFsIHByb3BlcnRpZXMgYXJlIHByb3ZpZGVkIHRoZW4gdGhleSB3aWxsIGJlIGFkZGVkIHRvIHRoZQogIC8vIGNyZWF0ZWQgb2JqZWN0LgogIF8uY3JlYXRlID0gZnVuY3Rpb24ocHJvdG90eXBlLCBwcm9wcykgewogICAgdmFyIHJlc3VsdCA9IGJhc2VDcmVhdGUocHJvdG90eXBlKTsKICAgIGlmIChwcm9wcykgXy5leHRlbmRPd24ocmVzdWx0LCBwcm9wcyk7CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogIC8vIENyZWF0ZSBhIChzaGFsbG93LWNsb25lZCkgZHVwbGljYXRlIG9mIGFuIG9iamVjdC4KICBfLmNsb25lID0gZnVuY3Rpb24ob2JqKSB7CiAgICBpZiAoIV8uaXNPYmplY3Qob2JqKSkgcmV0dXJuIG9iajsKICAgIHJldHVybiBfLmlzQXJyYXkob2JqKSA/IG9iai5zbGljZSgpIDogXy5leHRlbmQoe30sIG9iaik7CiAgfTsKCiAgLy8gSW52b2tlcyBpbnRlcmNlcHRvciB3aXRoIHRoZSBvYmosIGFuZCB0aGVuIHJldHVybnMgb2JqLgogIC8vIFRoZSBwcmltYXJ5IHB1cnBvc2Ugb2YgdGhpcyBtZXRob2QgaXMgdG8gInRhcCBpbnRvIiBhIG1ldGhvZCBjaGFpbiwgaW4KICAvLyBvcmRlciB0byBwZXJmb3JtIG9wZXJhdGlvbnMgb24gaW50ZXJtZWRpYXRlIHJlc3VsdHMgd2l0aGluIHRoZSBjaGFpbi4KICBfLnRhcCA9IGZ1bmN0aW9uKG9iaiwgaW50ZXJjZXB0b3IpIHsKICAgIGludGVyY2VwdG9yKG9iaik7CiAgICByZXR1cm4gb2JqOwogIH07CgogIC8vIFJldHVybnMgd2hldGhlciBhbiBvYmplY3QgaGFzIGEgZ2l2ZW4gc2V0IG9mIGBrZXk6dmFsdWVgIHBhaXJzLgogIF8uaXNNYXRjaCA9IGZ1bmN0aW9uKG9iamVjdCwgYXR0cnMpIHsKICAgIHZhciBrZXlzID0gXy5rZXlzKGF0dHJzKSwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CiAgICBpZiAob2JqZWN0ID09IG51bGwpIHJldHVybiAhbGVuZ3RoOwogICAgdmFyIG9iaiA9IE9iamVjdChvYmplY3QpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICB2YXIga2V5ID0ga2V5c1tpXTsKICAgICAgaWYgKGF0dHJzW2tleV0gIT09IG9ialtrZXldIHx8ICEoa2V5IGluIG9iaikpIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH07CgoKICAvLyBJbnRlcm5hbCByZWN1cnNpdmUgY29tcGFyaXNvbiBmdW5jdGlvbiBmb3IgYGlzRXF1YWxgLgogIHZhciBlcSA9IGZ1bmN0aW9uKGEsIGIsIGFTdGFjaywgYlN0YWNrKSB7CiAgICAvLyBJZGVudGljYWwgb2JqZWN0cyBhcmUgZXF1YWwuIGAwID09PSAtMGAsIGJ1dCB0aGV5IGFyZW4ndCBpZGVudGljYWwuCiAgICAvLyBTZWUgdGhlIFtIYXJtb255IGBlZ2FsYCBwcm9wb3NhbF0oaHR0cDovL3dpa2kuZWNtYXNjcmlwdC5vcmcvZG9rdS5waHA/aWQ9aGFybW9ueTplZ2FsKS4KICAgIGlmIChhID09PSBiKSByZXR1cm4gYSAhPT0gMCB8fCAxIC8gYSA9PT0gMSAvIGI7CiAgICAvLyBBIHN0cmljdCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIGBudWxsID09IHVuZGVmaW5lZGAuCiAgICBpZiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCkgcmV0dXJuIGEgPT09IGI7CiAgICAvLyBVbndyYXAgYW55IHdyYXBwZWQgb2JqZWN0cy4KICAgIGlmIChhIGluc3RhbmNlb2YgXykgYSA9IGEuX3dyYXBwZWQ7CiAgICBpZiAoYiBpbnN0YW5jZW9mIF8pIGIgPSBiLl93cmFwcGVkOwogICAgLy8gQ29tcGFyZSBgW1tDbGFzc11dYCBuYW1lcy4KICAgIHZhciBjbGFzc05hbWUgPSB0b1N0cmluZy5jYWxsKGEpOwogICAgaWYgKGNsYXNzTmFtZSAhPT0gdG9TdHJpbmcuY2FsbChiKSkgcmV0dXJuIGZhbHNlOwogICAgc3dpdGNoIChjbGFzc05hbWUpIHsKICAgICAgLy8gU3RyaW5ncywgbnVtYmVycywgcmVndWxhciBleHByZXNzaW9ucywgZGF0ZXMsIGFuZCBib29sZWFucyBhcmUgY29tcGFyZWQgYnkgdmFsdWUuCiAgICAgIGNhc2UgJ1tvYmplY3QgUmVnRXhwXSc6CiAgICAgIC8vIFJlZ0V4cHMgYXJlIGNvZXJjZWQgdG8gc3RyaW5ncyBmb3IgY29tcGFyaXNvbiAoTm90ZTogJycgKyAvYS9pID09PSAnL2EvaScpCiAgICAgIGNhc2UgJ1tvYmplY3QgU3RyaW5nXSc6CiAgICAgICAgLy8gUHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3Qgd3JhcHBlcnMgYXJlIGVxdWl2YWxlbnQ7IHRodXMsIGAiNSJgIGlzCiAgICAgICAgLy8gZXF1aXZhbGVudCB0byBgbmV3IFN0cmluZygiNSIpYC4KICAgICAgICByZXR1cm4gJycgKyBhID09PSAnJyArIGI7CiAgICAgIGNhc2UgJ1tvYmplY3QgTnVtYmVyXSc6CiAgICAgICAgLy8gYE5hTmBzIGFyZSBlcXVpdmFsZW50LCBidXQgbm9uLXJlZmxleGl2ZS4KICAgICAgICAvLyBPYmplY3QoTmFOKSBpcyBlcXVpdmFsZW50IHRvIE5hTgogICAgICAgIGlmICgrYSAhPT0gK2EpIHJldHVybiArYiAhPT0gK2I7CiAgICAgICAgLy8gQW4gYGVnYWxgIGNvbXBhcmlzb24gaXMgcGVyZm9ybWVkIGZvciBvdGhlciBudW1lcmljIHZhbHVlcy4KICAgICAgICByZXR1cm4gK2EgPT09IDAgPyAxIC8gK2EgPT09IDEgLyBiIDogK2EgPT09ICtiOwogICAgICBjYXNlICdbb2JqZWN0IERhdGVdJzoKICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6CiAgICAgICAgLy8gQ29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1lcmljIHByaW1pdGl2ZSB2YWx1ZXMuIERhdGVzIGFyZSBjb21wYXJlZCBieSB0aGVpcgogICAgICAgIC8vIG1pbGxpc2Vjb25kIHJlcHJlc2VudGF0aW9ucy4gTm90ZSB0aGF0IGludmFsaWQgZGF0ZXMgd2l0aCBtaWxsaXNlY29uZCByZXByZXNlbnRhdGlvbnMKICAgICAgICAvLyBvZiBgTmFOYCBhcmUgbm90IGVxdWl2YWxlbnQuCiAgICAgICAgcmV0dXJuICthID09PSArYjsKICAgIH0KCiAgICB2YXIgYXJlQXJyYXlzID0gY2xhc3NOYW1lID09PSAnW29iamVjdCBBcnJheV0nOwogICAgaWYgKCFhcmVBcnJheXMpIHsKICAgICAgaWYgKHR5cGVvZiBhICE9ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7CgogICAgICAvLyBPYmplY3RzIHdpdGggZGlmZmVyZW50IGNvbnN0cnVjdG9ycyBhcmUgbm90IGVxdWl2YWxlbnQsIGJ1dCBgT2JqZWN0YHMgb3IgYEFycmF5YHMKICAgICAgLy8gZnJvbSBkaWZmZXJlbnQgZnJhbWVzIGFyZS4KICAgICAgdmFyIGFDdG9yID0gYS5jb25zdHJ1Y3RvciwgYkN0b3IgPSBiLmNvbnN0cnVjdG9yOwogICAgICBpZiAoYUN0b3IgIT09IGJDdG9yICYmICEoXy5pc0Z1bmN0aW9uKGFDdG9yKSAmJiBhQ3RvciBpbnN0YW5jZW9mIGFDdG9yICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfLmlzRnVuY3Rpb24oYkN0b3IpICYmIGJDdG9yIGluc3RhbmNlb2YgYkN0b3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgICAvLyBBc3N1bWUgZXF1YWxpdHkgZm9yIGN5Y2xpYyBzdHJ1Y3R1cmVzLiBUaGUgYWxnb3JpdGhtIGZvciBkZXRlY3RpbmcgY3ljbGljCiAgICAvLyBzdHJ1Y3R1cmVzIGlzIGFkYXB0ZWQgZnJvbSBFUyA1LjEgc2VjdGlvbiAxNS4xMi4zLCBhYnN0cmFjdCBvcGVyYXRpb24gYEpPYC4KCiAgICAvLyBJbml0aWFsaXppbmcgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuCiAgICAvLyBJdCdzIGRvbmUgaGVyZSBzaW5jZSB3ZSBvbmx5IG5lZWQgdGhlbSBmb3Igb2JqZWN0cyBhbmQgYXJyYXlzIGNvbXBhcmlzb24uCiAgICBhU3RhY2sgPSBhU3RhY2sgfHwgW107CiAgICBiU3RhY2sgPSBiU3RhY2sgfHwgW107CiAgICB2YXIgbGVuZ3RoID0gYVN0YWNrLmxlbmd0aDsKICAgIHdoaWxlIChsZW5ndGgtLSkgewogICAgICAvLyBMaW5lYXIgc2VhcmNoLiBQZXJmb3JtYW5jZSBpcyBpbnZlcnNlbHkgcHJvcG9ydGlvbmFsIHRvIHRoZSBudW1iZXIgb2YKICAgICAgLy8gdW5pcXVlIG5lc3RlZCBzdHJ1Y3R1cmVzLgogICAgICBpZiAoYVN0YWNrW2xlbmd0aF0gPT09IGEpIHJldHVybiBiU3RhY2tbbGVuZ3RoXSA9PT0gYjsKICAgIH0KCiAgICAvLyBBZGQgdGhlIGZpcnN0IG9iamVjdCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHMuCiAgICBhU3RhY2sucHVzaChhKTsKICAgIGJTdGFjay5wdXNoKGIpOwoKICAgIC8vIFJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzLgogICAgaWYgKGFyZUFycmF5cykgewogICAgICAvLyBDb21wYXJlIGFycmF5IGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeS4KICAgICAgbGVuZ3RoID0gYS5sZW5ndGg7CiAgICAgIGlmIChsZW5ndGggIT09IGIubGVuZ3RoKSByZXR1cm4gZmFsc2U7CiAgICAgIC8vIERlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXMuCiAgICAgIHdoaWxlIChsZW5ndGgtLSkgewogICAgICAgIGlmICghZXEoYVtsZW5ndGhdLCBiW2xlbmd0aF0sIGFTdGFjaywgYlN0YWNrKSkgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBEZWVwIGNvbXBhcmUgb2JqZWN0cy4KICAgICAgdmFyIGtleXMgPSBfLmtleXMoYSksIGtleTsKICAgICAgbGVuZ3RoID0ga2V5cy5sZW5ndGg7CiAgICAgIC8vIEVuc3VyZSB0aGF0IGJvdGggb2JqZWN0cyBjb250YWluIHRoZSBzYW1lIG51bWJlciBvZiBwcm9wZXJ0aWVzIGJlZm9yZSBjb21wYXJpbmcgZGVlcCBlcXVhbGl0eS4KICAgICAgaWYgKF8ua2V5cyhiKS5sZW5ndGggIT09IGxlbmd0aCkgcmV0dXJuIGZhbHNlOwogICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKICAgICAgICAvLyBEZWVwIGNvbXBhcmUgZWFjaCBtZW1iZXIKICAgICAgICBrZXkgPSBrZXlzW2xlbmd0aF07CiAgICAgICAgaWYgKCEoXy5oYXMoYiwga2V5KSAmJiBlcShhW2tleV0sIGJba2V5XSwgYVN0YWNrLCBiU3RhY2spKSkgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgICAvLyBSZW1vdmUgdGhlIGZpcnN0IG9iamVjdCBmcm9tIHRoZSBzdGFjayBvZiB0cmF2ZXJzZWQgb2JqZWN0cy4KICAgIGFTdGFjay5wb3AoKTsKICAgIGJTdGFjay5wb3AoKTsKICAgIHJldHVybiB0cnVlOwogIH07CgogIC8vIFBlcmZvcm0gYSBkZWVwIGNvbXBhcmlzb24gdG8gY2hlY2sgaWYgdHdvIG9iamVjdHMgYXJlIGVxdWFsLgogIF8uaXNFcXVhbCA9IGZ1bmN0aW9uKGEsIGIpIHsKICAgIHJldHVybiBlcShhLCBiKTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIGFycmF5LCBzdHJpbmcsIG9yIG9iamVjdCBlbXB0eT8KICAvLyBBbiAiZW1wdHkiIG9iamVjdCBoYXMgbm8gZW51bWVyYWJsZSBvd24tcHJvcGVydGllcy4KICBfLmlzRW1wdHkgPSBmdW5jdGlvbihvYmopIHsKICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHRydWU7CiAgICBpZiAoaXNBcnJheUxpa2Uob2JqKSAmJiAoXy5pc0FycmF5KG9iaikgfHwgXy5pc1N0cmluZyhvYmopIHx8IF8uaXNBcmd1bWVudHMob2JqKSkpIHJldHVybiBvYmoubGVuZ3RoID09PSAwOwogICAgcmV0dXJuIF8ua2V5cyhvYmopLmxlbmd0aCA9PT0gMDsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgRE9NIGVsZW1lbnQ/CiAgXy5pc0VsZW1lbnQgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiAhIShvYmogJiYgb2JqLm5vZGVUeXBlID09PSAxKTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGFuIGFycmF5PwogIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5hdGl2ZSBBcnJheS5pc0FycmF5CiAgXy5pc0FycmF5ID0gbmF0aXZlSXNBcnJheSB8fCBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSc7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSBhbiBvYmplY3Q/CiAgXy5pc09iamVjdCA9IGZ1bmN0aW9uKG9iaikgewogICAgdmFyIHR5cGUgPSB0eXBlb2Ygb2JqOwogICAgcmV0dXJuIHR5cGUgPT09ICdmdW5jdGlvbicgfHwgdHlwZSA9PT0gJ29iamVjdCcgJiYgISFvYmo7CiAgfTsKCiAgLy8gQWRkIHNvbWUgaXNUeXBlIG1ldGhvZHM6IGlzQXJndW1lbnRzLCBpc0Z1bmN0aW9uLCBpc1N0cmluZywgaXNOdW1iZXIsIGlzRGF0ZSwgaXNSZWdFeHAsIGlzRXJyb3IuCiAgXy5lYWNoKFsnQXJndW1lbnRzJywgJ0Z1bmN0aW9uJywgJ1N0cmluZycsICdOdW1iZXInLCAnRGF0ZScsICdSZWdFeHAnLCAnRXJyb3InXSwgZnVuY3Rpb24obmFtZSkgewogICAgX1snaXMnICsgbmFtZV0gPSBmdW5jdGlvbihvYmopIHsKICAgICAgcmV0dXJuIHRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgJyArIG5hbWUgKyAnXSc7CiAgICB9OwogIH0pOwoKICAvLyBEZWZpbmUgYSBmYWxsYmFjayB2ZXJzaW9uIG9mIHRoZSBtZXRob2QgaW4gYnJvd3NlcnMgKGFoZW0sIElFIDwgOSksIHdoZXJlCiAgLy8gdGhlcmUgaXNuJ3QgYW55IGluc3BlY3RhYmxlICJBcmd1bWVudHMiIHR5cGUuCiAgaWYgKCFfLmlzQXJndW1lbnRzKGFyZ3VtZW50cykpIHsKICAgIF8uaXNBcmd1bWVudHMgPSBmdW5jdGlvbihvYmopIHsKICAgICAgcmV0dXJuIF8uaGFzKG9iaiwgJ2NhbGxlZScpOwogICAgfTsKICB9CgogIC8vIE9wdGltaXplIGBpc0Z1bmN0aW9uYCBpZiBhcHByb3ByaWF0ZS4gV29yayBhcm91bmQgc29tZSB0eXBlb2YgYnVncyBpbiBvbGQgdjgsCiAgLy8gSUUgMTEgKCMxNjIxKSwgYW5kIGluIFNhZmFyaSA4ICgjMTkyOSkuCiAgaWYgKHR5cGVvZiAvLi8gIT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgSW50OEFycmF5ICE9ICdvYmplY3QnKSB7CiAgICBfLmlzRnVuY3Rpb24gPSBmdW5jdGlvbihvYmopIHsKICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTsKICAgIH07CiAgfQoKICAvLyBJcyBhIGdpdmVuIG9iamVjdCBhIGZpbml0ZSBudW1iZXI/CiAgXy5pc0Zpbml0ZSA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuIGlzRmluaXRlKG9iaikgJiYgIWlzTmFOKHBhcnNlRmxvYXQob2JqKSk7CiAgfTsKCiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyAoTmFOIGlzIHRoZSBvbmx5IG51bWJlciB3aGljaCBkb2VzIG5vdCBlcXVhbCBpdHNlbGYpLgogIF8uaXNOYU4gPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBfLmlzTnVtYmVyKG9iaikgJiYgb2JqICE9PSArb2JqOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYSBib29sZWFuPwogIF8uaXNCb29sZWFuID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gb2JqID09PSB0cnVlIHx8IG9iaiA9PT0gZmFsc2UgfHwgdG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBCb29sZWFuXSc7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBlcXVhbCB0byBudWxsPwogIF8uaXNOdWxsID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gb2JqID09PSBudWxsOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgdW5kZWZpbmVkPwogIF8uaXNVbmRlZmluZWQgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBvYmogPT09IHZvaWQgMDsKICB9OwoKICAvLyBTaG9ydGN1dCBmdW5jdGlvbiBmb3IgY2hlY2tpbmcgaWYgYW4gb2JqZWN0IGhhcyBhIGdpdmVuIHByb3BlcnR5IGRpcmVjdGx5CiAgLy8gb24gaXRzZWxmIChpbiBvdGhlciB3b3Jkcywgbm90IG9uIGEgcHJvdG90eXBlKS4KICBfLmhhcyA9IGZ1bmN0aW9uKG9iaiwga2V5KSB7CiAgICByZXR1cm4gb2JqICE9IG51bGwgJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7CiAgfTsKCiAgLy8gVXRpbGl0eSBGdW5jdGlvbnMKICAvLyAtLS0tLS0tLS0tLS0tLS0tLQoKICAvLyBSdW4gVW5kZXJzY29yZS5qcyBpbiAqbm9Db25mbGljdCogbW9kZSwgcmV0dXJuaW5nIHRoZSBgX2AgdmFyaWFibGUgdG8gaXRzCiAgLy8gcHJldmlvdXMgb3duZXIuIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIFVuZGVyc2NvcmUgb2JqZWN0LgogIF8ubm9Db25mbGljdCA9IGZ1bmN0aW9uKCkgewogICAgcm9vdC5fID0gcHJldmlvdXNVbmRlcnNjb3JlOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgLy8gS2VlcCB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gYXJvdW5kIGZvciBkZWZhdWx0IGl0ZXJhdGVlcy4KICBfLmlkZW50aXR5ID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZTsKICB9OwoKICAvLyBQcmVkaWNhdGUtZ2VuZXJhdGluZyBmdW5jdGlvbnMuIE9mdGVuIHVzZWZ1bCBvdXRzaWRlIG9mIFVuZGVyc2NvcmUuCiAgXy5jb25zdGFudCA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH07CiAgfTsKCiAgXy5ub29wID0gZnVuY3Rpb24oKXt9OwoKICBfLnByb3BlcnR5ID0gcHJvcGVydHk7CgogIC8vIEdlbmVyYXRlcyBhIGZ1bmN0aW9uIGZvciBhIGdpdmVuIG9iamVjdCB0aGF0IHJldHVybnMgYSBnaXZlbiBwcm9wZXJ0eS4KICBfLnByb3BlcnR5T2YgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBvYmogPT0gbnVsbCA/IGZ1bmN0aW9uKCl7fSA6IGZ1bmN0aW9uKGtleSkgewogICAgICByZXR1cm4gb2JqW2tleV07CiAgICB9OwogIH07CgogIC8vIFJldHVybnMgYSBwcmVkaWNhdGUgZm9yIGNoZWNraW5nIHdoZXRoZXIgYW4gb2JqZWN0IGhhcyBhIGdpdmVuIHNldCBvZgogIC8vIGBrZXk6dmFsdWVgIHBhaXJzLgogIF8ubWF0Y2hlciA9IF8ubWF0Y2hlcyA9IGZ1bmN0aW9uKGF0dHJzKSB7CiAgICBhdHRycyA9IF8uZXh0ZW5kT3duKHt9LCBhdHRycyk7CiAgICByZXR1cm4gZnVuY3Rpb24ob2JqKSB7CiAgICAgIHJldHVybiBfLmlzTWF0Y2gob2JqLCBhdHRycyk7CiAgICB9OwogIH07CgogIC8vIFJ1biBhIGZ1bmN0aW9uICoqbioqIHRpbWVzLgogIF8udGltZXMgPSBmdW5jdGlvbihuLCBpdGVyYXRlZSwgY29udGV4dCkgewogICAgdmFyIGFjY3VtID0gQXJyYXkoTWF0aC5tYXgoMCwgbikpOwogICAgaXRlcmF0ZWUgPSBvcHRpbWl6ZUNiKGl0ZXJhdGVlLCBjb250ZXh0LCAxKTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSBhY2N1bVtpXSA9IGl0ZXJhdGVlKGkpOwogICAgcmV0dXJuIGFjY3VtOwogIH07CgogIC8vIFJldHVybiBhIHJhbmRvbSBpbnRlZ2VyIGJldHdlZW4gbWluIGFuZCBtYXggKGluY2x1c2l2ZSkuCiAgXy5yYW5kb20gPSBmdW5jdGlvbihtaW4sIG1heCkgewogICAgaWYgKG1heCA9PSBudWxsKSB7CiAgICAgIG1heCA9IG1pbjsKICAgICAgbWluID0gMDsKICAgIH0KICAgIHJldHVybiBtaW4gKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpOwogIH07CgogIC8vIEEgKHBvc3NpYmx5IGZhc3Rlcikgd2F5IHRvIGdldCB0aGUgY3VycmVudCB0aW1lc3RhbXAgYXMgYW4gaW50ZWdlci4KICBfLm5vdyA9IERhdGUubm93IHx8IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogIH07CgogICAvLyBMaXN0IG9mIEhUTUwgZW50aXRpZXMgZm9yIGVzY2FwaW5nLgogIHZhciBlc2NhcGVNYXAgPSB7CiAgICAnJic6ICcmYW1wOycsCiAgICAnPCc6ICcmbHQ7JywKICAgICc+JzogJyZndDsnLAogICAgJyInOiAnJnF1b3Q7JywKICAgICInIjogJyYjeDI3OycsCiAgICAnYCc6ICcmI3g2MDsnCiAgfTsKICB2YXIgdW5lc2NhcGVNYXAgPSBfLmludmVydChlc2NhcGVNYXApOwoKICAvLyBGdW5jdGlvbnMgZm9yIGVzY2FwaW5nIGFuZCB1bmVzY2FwaW5nIHN0cmluZ3MgdG8vZnJvbSBIVE1MIGludGVycG9sYXRpb24uCiAgdmFyIGNyZWF0ZUVzY2FwZXIgPSBmdW5jdGlvbihtYXApIHsKICAgIHZhciBlc2NhcGVyID0gZnVuY3Rpb24obWF0Y2gpIHsKICAgICAgcmV0dXJuIG1hcFttYXRjaF07CiAgICB9OwogICAgLy8gUmVnZXhlcyBmb3IgaWRlbnRpZnlpbmcgYSBrZXkgdGhhdCBuZWVkcyB0byBiZSBlc2NhcGVkCiAgICB2YXIgc291cmNlID0gJyg/OicgKyBfLmtleXMobWFwKS5qb2luKCd8JykgKyAnKSc7CiAgICB2YXIgdGVzdFJlZ2V4cCA9IFJlZ0V4cChzb3VyY2UpOwogICAgdmFyIHJlcGxhY2VSZWdleHAgPSBSZWdFeHAoc291cmNlLCAnZycpOwogICAgcmV0dXJuIGZ1bmN0aW9uKHN0cmluZykgewogICAgICBzdHJpbmcgPSBzdHJpbmcgPT0gbnVsbCA/ICcnIDogJycgKyBzdHJpbmc7CiAgICAgIHJldHVybiB0ZXN0UmVnZXhwLnRlc3Qoc3RyaW5nKSA/IHN0cmluZy5yZXBsYWNlKHJlcGxhY2VSZWdleHAsIGVzY2FwZXIpIDogc3RyaW5nOwogICAgfTsKICB9OwogIF8uZXNjYXBlID0gY3JlYXRlRXNjYXBlcihlc2NhcGVNYXApOwogIF8udW5lc2NhcGUgPSBjcmVhdGVFc2NhcGVyKHVuZXNjYXBlTWFwKTsKCiAgLy8gSWYgdGhlIHZhbHVlIG9mIHRoZSBuYW1lZCBgcHJvcGVydHlgIGlzIGEgZnVuY3Rpb24gdGhlbiBpbnZva2UgaXQgd2l0aCB0aGUKICAvLyBgb2JqZWN0YCBhcyBjb250ZXh0OyBvdGhlcndpc2UsIHJldHVybiBpdC4KICBfLnJlc3VsdCA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHksIGZhbGxiYWNrKSB7CiAgICB2YXIgdmFsdWUgPSBvYmplY3QgPT0gbnVsbCA/IHZvaWQgMCA6IG9iamVjdFtwcm9wZXJ0eV07CiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgewogICAgICB2YWx1ZSA9IGZhbGxiYWNrOwogICAgfQogICAgcmV0dXJuIF8uaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZS5jYWxsKG9iamVjdCkgOiB2YWx1ZTsKICB9OwoKICAvLyBHZW5lcmF0ZSBhIHVuaXF1ZSBpbnRlZ2VyIGlkICh1bmlxdWUgd2l0aGluIHRoZSBlbnRpcmUgY2xpZW50IHNlc3Npb24pLgogIC8vIFVzZWZ1bCBmb3IgdGVtcG9yYXJ5IERPTSBpZHMuCiAgdmFyIGlkQ291bnRlciA9IDA7CiAgXy51bmlxdWVJZCA9IGZ1bmN0aW9uKHByZWZpeCkgewogICAgdmFyIGlkID0gKytpZENvdW50ZXIgKyAnJzsKICAgIHJldHVybiBwcmVmaXggPyBwcmVmaXggKyBpZCA6IGlkOwogIH07CgogIC8vIEJ5IGRlZmF1bHQsIFVuZGVyc2NvcmUgdXNlcyBFUkItc3R5bGUgdGVtcGxhdGUgZGVsaW1pdGVycywgY2hhbmdlIHRoZQogIC8vIGZvbGxvd2luZyB0ZW1wbGF0ZSBzZXR0aW5ncyB0byB1c2UgYWx0ZXJuYXRpdmUgZGVsaW1pdGVycy4KICBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7CiAgICBldmFsdWF0ZSAgICA6IC88JShbXHNcU10rPyklPi9nLAogICAgaW50ZXJwb2xhdGUgOiAvPCU9KFtcc1xTXSs/KSU+L2csCiAgICBlc2NhcGUgICAgICA6IC88JS0oW1xzXFNdKz8pJT4vZwogIH07CgogIC8vIFdoZW4gY3VzdG9taXppbmcgYHRlbXBsYXRlU2V0dGluZ3NgLCBpZiB5b3UgZG9uJ3Qgd2FudCB0byBkZWZpbmUgYW4KICAvLyBpbnRlcnBvbGF0aW9uLCBldmFsdWF0aW9uIG9yIGVzY2FwaW5nIHJlZ2V4LCB3ZSBuZWVkIG9uZSB0aGF0IGlzCiAgLy8gZ3VhcmFudGVlZCBub3QgdG8gbWF0Y2guCiAgdmFyIG5vTWF0Y2ggPSAvKC4pXi87CgogIC8vIENlcnRhaW4gY2hhcmFjdGVycyBuZWVkIHRvIGJlIGVzY2FwZWQgc28gdGhhdCB0aGV5IGNhbiBiZSBwdXQgaW50byBhCiAgLy8gc3RyaW5nIGxpdGVyYWwuCiAgdmFyIGVzY2FwZXMgPSB7CiAgICAiJyI6ICAgICAgIiciLAogICAgJ1xcJzogICAgICdcXCcsCiAgICAnXHInOiAgICAgJ3InLAogICAgJ1xuJzogICAgICduJywKICAgICdcdTIwMjgnOiAndTIwMjgnLAogICAgJ1x1MjAyOSc6ICd1MjAyOScKICB9OwoKICB2YXIgZXNjYXBlciA9IC9cXHwnfFxyfFxufFx1MjAyOHxcdTIwMjkvZzsKCiAgdmFyIGVzY2FwZUNoYXIgPSBmdW5jdGlvbihtYXRjaCkgewogICAgcmV0dXJuICdcXCcgKyBlc2NhcGVzW21hdGNoXTsKICB9OwoKICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRlbXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9uLgogIC8vIFVuZGVyc2NvcmUgdGVtcGxhdGluZyBoYW5kbGVzIGFyYml0cmFyeSBkZWxpbWl0ZXJzLCBwcmVzZXJ2ZXMgd2hpdGVzcGFjZSwKICAvLyBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS4KICAvLyBOQjogYG9sZFNldHRpbmdzYCBvbmx5IGV4aXN0cyBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuCiAgXy50ZW1wbGF0ZSA9IGZ1bmN0aW9uKHRleHQsIHNldHRpbmdzLCBvbGRTZXR0aW5ncykgewogICAgaWYgKCFzZXR0aW5ncyAmJiBvbGRTZXR0aW5ncykgc2V0dGluZ3MgPSBvbGRTZXR0aW5nczsKICAgIHNldHRpbmdzID0gXy5kZWZhdWx0cyh7fSwgc2V0dGluZ3MsIF8udGVtcGxhdGVTZXR0aW5ncyk7CgogICAgLy8gQ29tYmluZSBkZWxpbWl0ZXJzIGludG8gb25lIHJlZ3VsYXIgZXhwcmVzc2lvbiB2aWEgYWx0ZXJuYXRpb24uCiAgICB2YXIgbWF0Y2hlciA9IFJlZ0V4cChbCiAgICAgIChzZXR0aW5ncy5lc2NhcGUgfHwgbm9NYXRjaCkuc291cmNlLAogICAgICAoc2V0dGluZ3MuaW50ZXJwb2xhdGUgfHwgbm9NYXRjaCkuc291cmNlLAogICAgICAoc2V0dGluZ3MuZXZhbHVhdGUgfHwgbm9NYXRjaCkuc291cmNlCiAgICBdLmpvaW4oJ3wnKSArICd8JCcsICdnJyk7CgogICAgLy8gQ29tcGlsZSB0aGUgdGVtcGxhdGUgc291cmNlLCBlc2NhcGluZyBzdHJpbmcgbGl0ZXJhbHMgYXBwcm9wcmlhdGVseS4KICAgIHZhciBpbmRleCA9IDA7CiAgICB2YXIgc291cmNlID0gIl9fcCs9JyI7CiAgICB0ZXh0LnJlcGxhY2UobWF0Y2hlciwgZnVuY3Rpb24obWF0Y2gsIGVzY2FwZSwgaW50ZXJwb2xhdGUsIGV2YWx1YXRlLCBvZmZzZXQpIHsKICAgICAgc291cmNlICs9IHRleHQuc2xpY2UoaW5kZXgsIG9mZnNldCkucmVwbGFjZShlc2NhcGVyLCBlc2NhcGVDaGFyKTsKICAgICAgaW5kZXggPSBvZmZzZXQgKyBtYXRjaC5sZW5ndGg7CgogICAgICBpZiAoZXNjYXBlKSB7CiAgICAgICAgc291cmNlICs9ICInK1xuKChfX3Q9KCIgKyBlc2NhcGUgKyAiKSk9PW51bGw/Jyc6Xy5lc2NhcGUoX190KSkrXG4nIjsKICAgICAgfSBlbHNlIGlmIChpbnRlcnBvbGF0ZSkgewogICAgICAgIHNvdXJjZSArPSAiJytcbigoX190PSgiICsgaW50ZXJwb2xhdGUgKyAiKSk9PW51bGw/Jyc6X190KStcbiciOwogICAgICB9IGVsc2UgaWYgKGV2YWx1YXRlKSB7CiAgICAgICAgc291cmNlICs9ICInO1xuIiArIGV2YWx1YXRlICsgIlxuX19wKz0nIjsKICAgICAgfQoKICAgICAgLy8gQWRvYmUgVk1zIG5lZWQgdGhlIG1hdGNoIHJldHVybmVkIHRvIHByb2R1Y2UgdGhlIGNvcnJlY3Qgb2ZmZXN0LgogICAgICByZXR1cm4gbWF0Y2g7CiAgICB9KTsKICAgIHNvdXJjZSArPSAiJztcbiI7CgogICAgLy8gSWYgYSB2YXJpYWJsZSBpcyBub3Qgc3BlY2lmaWVkLCBwbGFjZSBkYXRhIHZhbHVlcyBpbiBsb2NhbCBzY29wZS4KICAgIGlmICghc2V0dGluZ3MudmFyaWFibGUpIHNvdXJjZSA9ICd3aXRoKG9ianx8e30pe1xuJyArIHNvdXJjZSArICd9XG4nOwoKICAgIHNvdXJjZSA9ICJ2YXIgX190LF9fcD0nJyxfX2o9QXJyYXkucHJvdG90eXBlLmpvaW4sIiArCiAgICAgICJwcmludD1mdW5jdGlvbigpe19fcCs9X19qLmNhbGwoYXJndW1lbnRzLCcnKTt9O1xuIiArCiAgICAgIHNvdXJjZSArICdyZXR1cm4gX19wO1xuJzsKCiAgICB0cnkgewogICAgICB2YXIgcmVuZGVyID0gbmV3IEZ1bmN0aW9uKHNldHRpbmdzLnZhcmlhYmxlIHx8ICdvYmonLCAnXycsIHNvdXJjZSk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGUuc291cmNlID0gc291cmNlOwogICAgICB0aHJvdyBlOwogICAgfQoKICAgIHZhciB0ZW1wbGF0ZSA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgcmV0dXJuIHJlbmRlci5jYWxsKHRoaXMsIGRhdGEsIF8pOwogICAgfTsKCiAgICAvLyBQcm92aWRlIHRoZSBjb21waWxlZCBzb3VyY2UgYXMgYSBjb252ZW5pZW5jZSBmb3IgcHJlY29tcGlsYXRpb24uCiAgICB2YXIgYXJndW1lbnQgPSBzZXR0aW5ncy52YXJpYWJsZSB8fCAnb2JqJzsKICAgIHRlbXBsYXRlLnNvdXJjZSA9ICdmdW5jdGlvbignICsgYXJndW1lbnQgKyAnKXtcbicgKyBzb3VyY2UgKyAnfSc7CgogICAgcmV0dXJuIHRlbXBsYXRlOwogIH07CgogIC8vIEFkZCBhICJjaGFpbiIgZnVuY3Rpb24uIFN0YXJ0IGNoYWluaW5nIGEgd3JhcHBlZCBVbmRlcnNjb3JlIG9iamVjdC4KICBfLmNoYWluID0gZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIgaW5zdGFuY2UgPSBfKG9iaik7CiAgICBpbnN0YW5jZS5fY2hhaW4gPSB0cnVlOwogICAgcmV0dXJuIGluc3RhbmNlOwogIH07CgogIC8vIE9PUAogIC8vIC0tLS0tLS0tLS0tLS0tLQogIC8vIElmIFVuZGVyc2NvcmUgaXMgY2FsbGVkIGFzIGEgZnVuY3Rpb24sIGl0IHJldHVybnMgYSB3cmFwcGVkIG9iamVjdCB0aGF0CiAgLy8gY2FuIGJlIHVzZWQgT08tc3R5bGUuIFRoaXMgd3JhcHBlciBob2xkcyBhbHRlcmVkIHZlcnNpb25zIG9mIGFsbCB0aGUKICAvLyB1bmRlcnNjb3JlIGZ1bmN0aW9ucy4gV3JhcHBlZCBvYmplY3RzIG1heSBiZSBjaGFpbmVkLgoKICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY29udGludWUgY2hhaW5pbmcgaW50ZXJtZWRpYXRlIHJlc3VsdHMuCiAgdmFyIHJlc3VsdCA9IGZ1bmN0aW9uKGluc3RhbmNlLCBvYmopIHsKICAgIHJldHVybiBpbnN0YW5jZS5fY2hhaW4gPyBfKG9iaikuY2hhaW4oKSA6IG9iajsKICB9OwoKICAvLyBBZGQgeW91ciBvd24gY3VzdG9tIGZ1bmN0aW9ucyB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuCiAgXy5taXhpbiA9IGZ1bmN0aW9uKG9iaikgewogICAgXy5lYWNoKF8uZnVuY3Rpb25zKG9iaiksIGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgdmFyIGZ1bmMgPSBfW25hbWVdID0gb2JqW25hbWVdOwogICAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBhcmdzID0gW3RoaXMuX3dyYXBwZWRdOwogICAgICAgIHB1c2guYXBwbHkoYXJncywgYXJndW1lbnRzKTsKICAgICAgICByZXR1cm4gcmVzdWx0KHRoaXMsIGZ1bmMuYXBwbHkoXywgYXJncykpOwogICAgICB9OwogICAgfSk7CiAgfTsKCiAgLy8gQWRkIGFsbCBvZiB0aGUgVW5kZXJzY29yZSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIgb2JqZWN0LgogIF8ubWl4aW4oXyk7CgogIC8vIEFkZCBhbGwgbXV0YXRvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuCiAgXy5lYWNoKFsncG9wJywgJ3B1c2gnLCAncmV2ZXJzZScsICdzaGlmdCcsICdzb3J0JywgJ3NwbGljZScsICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdOwogICAgXy5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG9iaiA9IHRoaXMuX3dyYXBwZWQ7CiAgICAgIG1ldGhvZC5hcHBseShvYmosIGFyZ3VtZW50cyk7CiAgICAgIGlmICgobmFtZSA9PT0gJ3NoaWZ0JyB8fCBuYW1lID09PSAnc3BsaWNlJykgJiYgb2JqLmxlbmd0aCA9PT0gMCkgZGVsZXRlIG9ialswXTsKICAgICAgcmV0dXJuIHJlc3VsdCh0aGlzLCBvYmopOwogICAgfTsKICB9KTsKCiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuCiAgXy5lYWNoKFsnY29uY2F0JywgJ2pvaW4nLCAnc2xpY2UnXSwgZnVuY3Rpb24obmFtZSkgewogICAgdmFyIG1ldGhvZCA9IEFycmF5UHJvdG9bbmFtZV07CiAgICBfLnByb3RvdHlwZVtuYW1lXSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gcmVzdWx0KHRoaXMsIG1ldGhvZC5hcHBseSh0aGlzLl93cmFwcGVkLCBhcmd1bWVudHMpKTsKICAgIH07CiAgfSk7CgogIC8vIEV4dHJhY3RzIHRoZSByZXN1bHQgZnJvbSBhIHdyYXBwZWQgYW5kIGNoYWluZWQgb2JqZWN0LgogIF8ucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5fd3JhcHBlZDsKICB9OwoKICAvLyBQcm92aWRlIHVud3JhcHBpbmcgcHJveHkgZm9yIHNvbWUgbWV0aG9kcyB1c2VkIGluIGVuZ2luZSBvcGVyYXRpb25zCiAgLy8gc3VjaCBhcyBhcml0aG1ldGljIGFuZCBKU09OIHN0cmluZ2lmaWNhdGlvbi4KICBfLnByb3RvdHlwZS52YWx1ZU9mID0gXy5wcm90b3R5cGUudG9KU09OID0gXy5wcm90b3R5cGUudmFsdWU7CgogIF8ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gJycgKyB0aGlzLl93cmFwcGVkOwogIH07CgogIC8vIEFNRCByZWdpc3RyYXRpb24gaGFwcGVucyBhdCB0aGUgZW5kIGZvciBjb21wYXRpYmlsaXR5IHdpdGggQU1EIGxvYWRlcnMKICAvLyB0aGF0IG1heSBub3QgZW5mb3JjZSBuZXh0LXR1cm4gc2VtYW50aWNzIG9uIG1vZHVsZXMuIEV2ZW4gdGhvdWdoIGdlbmVyYWwKICAvLyBwcmFjdGljZSBmb3IgQU1EIHJlZ2lzdHJhdGlvbiBpcyB0byBiZSBhbm9ueW1vdXMsIHVuZGVyc2NvcmUgcmVnaXN0ZXJzCiAgLy8gYXMgYSBuYW1lZCBtb2R1bGUgYmVjYXVzZSwgbGlrZSBqUXVlcnksIGl0IGlzIGEgYmFzZSBsaWJyYXJ5IHRoYXQgaXMKICAvLyBwb3B1bGFyIGVub3VnaCB0byBiZSBidW5kbGVkIGluIGEgdGhpcmQgcGFydHkgbGliLCBidXQgbm90IGJlIHBhcnQgb2YKICAvLyBhbiBBTUQgbG9hZCByZXF1ZXN0LiBUaG9zZSBjYXNlcyBjb3VsZCBnZW5lcmF0ZSBhbiBlcnJvciB3aGVuIGFuCiAgLy8gYW5vbnltb3VzIGRlZmluZSgpIGlzIGNhbGxlZCBvdXRzaWRlIG9mIGEgbG9hZGVyIHJlcXVlc3QuCiAgaWYgKHRydWUpIHsKICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gXzsKICAgIH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksCgkJCQlfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7CiAgfQp9LmNhbGwodGhpcykpOwoKCi8qKiovIH0pLAovKiAzMSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGZvcmtKb2luXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYzKTsKT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuZm9ya0pvaW4gPSBmb3JrSm9pbl8xLmZvcmtKb2luOwovLyMgc291cmNlTWFwcGluZ1VSTD1mb3JrSm9pbi5qcy5tYXAKCi8qKiovIH0pLAovKiAzMiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGZyb21fMSA9IF9fd2VicGFja19yZXF1aXJlX18oNjQpOwpPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5mcm9tID0gZnJvbV8xLmZyb207Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyb20uanMubWFwCgovKioqLyB9KSwKLyogMzMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIE9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7CnZhciBmcm9tRXZlbnRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNjUpOwpPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5mcm9tRXZlbnQgPSBmcm9tRXZlbnRfMS5mcm9tRXZlbnQ7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyb21FdmVudC5qcy5tYXAKCi8qKiovIH0pLAovKiAzNCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIG9mXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY2KTsKT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUub2YgPSBvZl8xLm9mOwovLyMgc291cmNlTWFwcGluZ1VSTD1vZi5qcy5tYXAKCi8qKiovIH0pLAovKiAzNSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGRlYm91bmNlVGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2Nyk7Ck9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3RvdHlwZS5kZWJvdW5jZVRpbWUgPSBkZWJvdW5jZVRpbWVfMS5kZWJvdW5jZVRpbWU7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlYm91bmNlVGltZS5qcy5tYXAKCi8qKiovIH0pLAovKiAzNiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGRlbGF5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDY4KTsKT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvdG90eXBlLmRlbGF5ID0gZGVsYXlfMS5kZWxheTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsYXkuanMubWFwCgovKioqLyB9KSwKLyogMzcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIE9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7CnZhciBkb18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2OSk7Ck9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3RvdHlwZS5kbyA9IGRvXzEuX2RvOwpPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm90b3R5cGUuX2RvID0gZG9fMS5fZG87Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvLmpzLm1hcAoKLyoqKi8gfSksCi8qIDM4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgZmlsdGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcwKTsKT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvdG90eXBlLmZpbHRlciA9IGZpbHRlcl8xLmZpbHRlcjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmlsdGVyLmpzLm1hcAoKLyoqKi8gfSksCi8qIDM5ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgbWFwXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcxKTsKT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvdG90eXBlLm1hcCA9IG1hcF8xLm1hcDsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWFwLmpzLm1hcAoKLyoqKi8gfSksCi8qIDQwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgbWVyZ2VNYXBfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNzIpOwpPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm90b3R5cGUubWVyZ2VNYXAgPSBtZXJnZU1hcF8xLm1lcmdlTWFwOwpPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcCA9IG1lcmdlTWFwXzEubWVyZ2VNYXA7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW1lcmdlTWFwLmpzLm1hcAoKLyoqKi8gfSksCi8qIDQxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgcmV0cnlfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNzQpOwpPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm90b3R5cGUucmV0cnkgPSByZXRyeV8xLnJldHJ5OwovLyMgc291cmNlTWFwcGluZ1VSTD1yZXRyeS5qcy5tYXAKCi8qKiovIH0pLAovKiA0MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIHRocm90dGxlVGltZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3NSk7Ck9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3RvdHlwZS50aHJvdHRsZVRpbWUgPSB0aHJvdHRsZVRpbWVfMS50aHJvdHRsZVRpbWU7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXRocm90dGxlVGltZS5qcy5tYXAKCi8qKiovIH0pLAovKiA0MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIHRpbWVvdXRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNzYpOwpPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm90b3R5cGUudGltZW91dCA9IHRpbWVvdXRfMS50aW1lb3V0OwovLyMgc291cmNlTWFwcGluZ1VSTD10aW1lb3V0LmpzLm1hcAoKLyoqKi8gfSksCi8qIDQ0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwogICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CiAgICB9Owp9KSgpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwp2YXIgcmVkaXJlY3Rfb25fcmVxdWVzdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7CnZhciBCYWlkdVZpZGVvUmVkaXJlY3QgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEJhaWR1VmlkZW9SZWRpcmVjdCwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEJhaWR1VmlkZW9SZWRpcmVjdChkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlciwgQVNlbGVjdG9yKSB7CiAgICAgICAgaWYgKEFTZWxlY3RvciA9PT0gdm9pZCAwKSB7IEFTZWxlY3RvciA9ICdhJzsgfQogICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlciwgQVNlbGVjdG9yKSB8fCB0aGlzOwogICAgfQogICAgQmFpZHVWaWRlb1JlZGlyZWN0LnByb3RvdHlwZS5oYW5kbGVyT25lUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgdmFyIHVybCA9IHJlcy5yZXNwb25zZS5tYXRjaCgvVVJMPScoLiopJy8pOwogICAgICAgIGlmICh1cmwubGVuZ3RoICYmIHVybFsxXSkgewogICAgICAgICAgICByZXMuZmluYWxVcmwgPSB1cmxbMV07CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXM7CiAgICB9OwogICAgcmV0dXJuIEJhaWR1VmlkZW9SZWRpcmVjdDsKfShyZWRpcmVjdF9vbl9yZXF1ZXN0XzEuUmVkaXJlY3RPblJlcXVlc3QpKTsKZXhwb3J0cy5kZWZhdWx0ID0gbmV3IEJhaWR1VmlkZW9SZWRpcmVjdCgvdi5iYWlkdVwuY29tLywgL3ZcLmJhaWR1XC5jb21cL2xpbmtcP3VybD0vLCBudWxsKTsKCgovKioqLyB9KSwKLyogNDUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgaHR0cF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMik7CnZhciBxdWVyeV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7CnZhciByZWRpcmVjdF9vbl9yZXF1ZXN0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTsKZnVuY3Rpb24gZ2V0VGV4dChodG1sRWxlbWVudCkgewogICAgcmV0dXJuIChodG1sRWxlbWVudC5pbm5lclRleHQgfHwgaHRtbEVsZW1lbnQudGV4dENvbnRlbnQpLnRyaW0oKTsKfQp2YXIgQmFpZHVSZWRpcmVjdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoQmFpZHVSZWRpcmVjdCwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEJhaWR1UmVkaXJlY3QoZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIsIEFTZWxlY3RvcikgewogICAgICAgIGlmIChBU2VsZWN0b3IgPT09IHZvaWQgMCkgeyBBU2VsZWN0b3IgPSAnYSc7IH0KICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIsIEFTZWxlY3RvcikgfHwgdGhpczsKICAgIH0KICAgIEJhaWR1UmVkaXJlY3QucHJvdG90eXBlLmhhbmRsZXJPbmVSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAodGhpcy51cmxUZXN0ZXIudGVzdChyZXMuZmluYWxVcmwpKSB7CiAgICAgICAgICAgIGlmICghcmVzLnJlc3BvbnNlIHx8IC88XC9ub3NjcmlwdD4kLy50ZXN0KHJlcy5yZXNwb25zZS50cmltKCkpKQogICAgICAgICAgICAgICAgdGhyb3cgcmVzOwogICAgICAgICAgICB2YXIgdXJsID0gcmVzLnJlc3BvbnNlLm1hdGNoKC9VUkw9XCc/aHR0cHM/OlwvXC9bXiciXSsvKS5qb2luKCcnKS5tYXRjaCgvaHR0cHM/OlwvXC9bXiciXSsvKVswXTsKICAgICAgICAgICAgaWYgKCF1cmwgfHwgIS9eaHR0cHM/Ly50ZXN0KHVybCkgfHwgdGhpcy51cmxUZXN0ZXIudGVzdCh1cmwpKQogICAgICAgICAgICAgICAgdGhyb3cgcmVzOwogICAgICAgICAgICByZXMuZmluYWxVcmwgPSB1cmw7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXM7CiAgICB9OwogICAgQmFpZHVSZWRpcmVjdC5wcm90b3R5cGUub25Jbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgaWYgKCEvd3d3XC5iYWlkdVwuY29tXC9zLy50ZXN0KHdpbmRvdy50b3AubG9jYXRpb24uaHJlZikpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB2YXIgcXVlcnkgPSBuZXcgcXVlcnlfMS5kZWZhdWx0KHdpbmRvdy50b3AubG9jYXRpb24uc2VhcmNoKTsKICAgICAgICB2YXIgc2tpcCA9IHF1ZXJ5Lm9iamVjdC5wbiB8fCAwOwogICAgICAgIHF1ZXJ5Lm9iamVjdC50biA9ICdiYWlkdWxvY2FsJzsKICAgICAgICBxdWVyeS5vYmplY3QudGltZXN0YW1wID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgICAgcXVlcnkub2JqZWN0LnJuID0gNTA7CiAgICAgICAgdmFyIHVybCA9IGxvY2F0aW9uLnByb3RvY29sLnJlcGxhY2UoLzokLywgJycpICsgIjovLyIgKyAobG9jYXRpb24uaG9zdCArIGxvY2F0aW9uLnBhdGhuYW1lICsgcXVlcnkpOwogICAgICAgIHJldHVybiBPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5mb3JrSm9pbihodHRwXzEuaHR0cC5nZXQodXJsKSwgaHR0cF8xLmh0dHAuZ2V0KHVybC5yZXBsYWNlKC9wbj0oXGQrKS8sICJwbj0iICsgKHNraXAgKyAxMCkpKSkucmV0cnkoMikKICAgICAgICAgICAgLnRpbWVvdXQoaHR0cF8xLnRpbWVvdXQpCiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHJlc0xpc3QpIHsKICAgICAgICAgICAgaWYgKCFyZXNMaXN0IHx8ICFyZXNMaXN0Lmxlbmd0aCkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgcmVzTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5oYW5kbGVyT25lUmVxdWVzdFBhZ2UocmVzKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9OwogICAgQmFpZHVSZWRpcmVjdC5wcm90b3R5cGUuaGFuZGxlck9uZVJlcXVlc3RQYWdlID0gZnVuY3Rpb24gKHJlcykgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgdmFyIHJlc3BvbnNlVGV4dCA9IHJlcy5yZXNwb25zZVRleHQucmVwbGFjZSgvKHNyYz1bXj5dKnxsaW5rPVtePl0pL2csICcnKTsKICAgICAgICB2YXIgaHRtbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2h0bWwnKTsKICAgICAgICBodG1sLmlubmVySFRNTCA9IHJlc3BvbnNlVGV4dDsKICAgICAgICBPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5vZihodG1sLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mPmEnKSkKICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAobm9kZUxpc3QpIHsgcmV0dXJuIFtdLnNsaWNlLmNhbGwobm9kZUxpc3QpLm1hcChmdW5jdGlvbiAoZWxlKSB7CiAgICAgICAgICAgIHZhciBsb2NhbCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnQ+YScpKS5maW5kKGZ1bmN0aW9uIChyZW1vdGVFbGUpIHsgcmV0dXJuIGdldFRleHQocmVtb3RlRWxlKSA9PT0gZ2V0VGV4dChlbGUpOyB9KTsKICAgICAgICAgICAgcmV0dXJuIGxvY2FsID8geyBsb2NhbDogbG9jYWwsIHJlbW90ZTogZWxlIH0gOiB2b2lkIDA7CiAgICAgICAgfSkKICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAodikgeyByZXR1cm4gISF2OyB9KTsgfSkKICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMpIHsKICAgICAgICAgICAgaXRlbXMKICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuICFfdGhpcy51cmxUZXN0ZXIudGVzdChpdGVtLnJlbW90ZS5ocmVmKTsgfSkKICAgICAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICBfdGhpcy51cmxUZXN0ZXIudGVzdChpdGVtLmxvY2FsLmhyZWYpICYmIGl0ZW0ubG9jYWwuc2V0QXR0cmlidXRlKCdvcmlnaW4taHJlZicsIGl0ZW0ubG9jYWwuaHJlZik7CiAgICAgICAgICAgICAgICBpdGVtLmxvY2FsLmhyZWYgPSBpdGVtLnJlbW90ZS5ocmVmOwogICAgICAgICAgICAgICAgaXRlbS5sb2NhbC5zZXRBdHRyaWJ1dGUoX3RoaXMuc3RhdHVzLmRvbmUsICcxJyk7CiAgICAgICAgICAgICAgICBfdGhpcy5ERUJVRyAmJiAoaXRlbS5sb2NhbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmVkJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfTsKICAgIHJldHVybiBCYWlkdVJlZGlyZWN0Owp9KHJlZGlyZWN0X29uX3JlcXVlc3RfMS5SZWRpcmVjdE9uUmVxdWVzdCkpOwpleHBvcnRzLmRlZmF1bHQgPSBuZXcgQmFpZHVSZWRpcmVjdCgvd3d3XC5iYWlkdVwuY29tLywgL3d3d1wuYmFpZHVcLmNvbVwvbGlua1w/dXJsPS8sIG51bGwsICcjY29udGVudF9sZWZ0IGEnKTsKCgovKioqLyB9KSwKLyogNDYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgcmVkaXJlY3Rfb25fdXJsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwp2YXIgR29vZ2xlUmVkaXJlY3QgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEdvb2dsZVJlZGlyZWN0LCBfc3VwZXIpOwogICAgZnVuY3Rpb24gR29vZ2xlUmVkaXJlY3QoZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIpIHsKICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIpIHx8IHRoaXM7CiAgICB9CiAgICBHb29nbGVSZWRpcmVjdC5wcm90b3R5cGUuaGFuZGxlck9uZSA9IGZ1bmN0aW9uIChhRWxlKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUub2YoYUVsZSkKICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAoYUVsZSkgewogICAgICAgICAgICBpZiAoYUVsZS5nZXRBdHRyaWJ1dGUoJ29ubW91c2Vkb3duJykpIHsKICAgICAgICAgICAgICAgIGFFbGUucmVtb3ZlQXR0cmlidXRlKCdvbm1vdXNlZG93bicpOwogICAgICAgICAgICAgICAgX3RoaXMuREVCVUcgJiYgKGFFbGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZWVuJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGFFbGUuZ2V0QXR0cmlidXRlKCdkYXRhLWhyZWYnKSkgewogICAgICAgICAgICAgICAgYUVsZS5ocmVmID0gYUVsZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtaHJlZicpOwogICAgICAgICAgICAgICAgX3RoaXMuREVCVUcgJiYgKGFFbGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZWVuJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CiAgICByZXR1cm4gR29vZ2xlUmVkaXJlY3Q7Cn0ocmVkaXJlY3Rfb25fdXJsXzEuUmVkaXJlY3RPblVybCkpOwpleHBvcnRzLmRlZmF1bHQgPSBuZXcgR29vZ2xlUmVkaXJlY3QoL3d3d1wuZ29vZ2xlXC4vLCBudWxsLCBudWxsKTsKCgovKioqLyB9KSwKLyogNDcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CnZhciByZWRpcmVjdF9vbl91cmxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CnZhciBTb1JlZGlyZWN0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTb1JlZGlyZWN0LCBfc3VwZXIpOwogICAgZnVuY3Rpb24gU29SZWRpcmVjdChkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlcikgewogICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlcikgfHwgdGhpczsKICAgIH0KICAgIFNvUmVkaXJlY3QucHJvdG90eXBlLmhhbmRsZXJPbmVDYWxsQmFjayA9IGZ1bmN0aW9uIChhRWxlKSB7CiAgICAgICAgYUVsZS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtcmVzJyk7IC8vIOWOu+mZpOeCueWHu+i/vei4qgogICAgICAgIGFFbGUuaHJlZiA9IGFFbGUuaHJlZi5yZXBsYWNlKC9cJihxfHR8dHN8c3JjKT1bXlwmXSovZywgJycpOwogICAgfTsKICAgIHJldHVybiBTb1JlZGlyZWN0Owp9KHJlZGlyZWN0X29uX3VybF8xLlJlZGlyZWN0T25VcmwpKTsKZXhwb3J0cy5kZWZhdWx0ID0gbmV3IFNvUmVkaXJlY3QoL3d3d1wuc29cLmNvbS8sIC9zb1wuY29tXC9saW5rXD91cmw9LywgL3NvXC5jb21cL2xpbmtcP3VybD0oLiopLyk7CgoKLyoqKi8gfSksCi8qIDQ4ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwogICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CiAgICB9Owp9KSgpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGh0dHBfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpOwp2YXIgcXVlcnlfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpOwp2YXIgcmVkaXJlY3Rfb25fcmVxdWVzdF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7CmZ1bmN0aW9uIGdldFRleHQoaHRtbEVsZW1lbnQpIHsKICAgIHJldHVybiAoaHRtbEVsZW1lbnQuaW5uZXJUZXh0IHx8IGh0bWxFbGVtZW50LnRleHRDb250ZW50KS50cmltKCk7Cn0KdmFyIFNvZ291UmVkaXJlY3QgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFNvZ291UmVkaXJlY3QsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBTb2dvdVJlZGlyZWN0KGRvbWFpblRlc3RlciwgdXJsVGVzdGVyLCBtYXRjaGVyLCBBU2VsZWN0b3IpIHsKICAgICAgICBpZiAoQVNlbGVjdG9yID09PSB2b2lkIDApIHsgQVNlbGVjdG9yID0gJ2EnOyB9CiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGRvbWFpblRlc3RlciwgdXJsVGVzdGVyLCBtYXRjaGVyLCBBU2VsZWN0b3IpIHx8IHRoaXM7CiAgICB9CiAgICBTb2dvdVJlZGlyZWN0LnByb3RvdHlwZS5oYW5kbGVyT25lUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHRoaXMudXJsVGVzdGVyLnRlc3QocmVzLmZpbmFsVXJsKSkgewogICAgICAgICAgICB2YXIgdXJsID0gcmVzLnJlc3BvbnNlLm1hdGNoKC9VUkw9XCc/aHR0cHM/OlwvXC9bXiciXSsvKS5qb2luKCcnKS5tYXRjaCgvaHR0cHM/OlwvXC9bXiciXSsvKVswXTsKICAgICAgICAgICAgaWYgKCF1cmwgfHwgIS9eaHR0cHM/Ly50ZXN0KHVybCkgfHwgdGhpcy51cmxUZXN0ZXIudGVzdCh1cmwpKQogICAgICAgICAgICAgICAgdGhyb3cgcmVzOwogICAgICAgICAgICByZXMuZmluYWxVcmwgPSB1cmw7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXM7CiAgICB9OwogICAgU29nb3VSZWRpcmVjdC5wcm90b3R5cGUub25Jbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgaWYgKCEvd3d3XC5zb2dvdVwuY29tXC93ZWIvLnRlc3Qod2luZG93LnRvcC5sb2NhdGlvbi5ocmVmKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIHZhciBxdWVyeSA9IG5ldyBxdWVyeV8xLmRlZmF1bHQod2luZG93LnRvcC5sb2NhdGlvbi5zZWFyY2gpOwogICAgICAgIC8vIOaQnOe0ouS9v+eUqGh0dHDmkJzntKLvvIzlvpfliLDnmoTmmK/nm7TmjqXpk77mjqUKICAgICAgICB2YXIgdXJsID0gbG9jYXRpb24ucHJvdG9jb2wucmVwbGFjZSgvOiQvLCAnJykucmVwbGFjZSgncycsICcnKSArICI6Ly8iICsgKGxvY2F0aW9uLmhvc3QgKyBsb2NhdGlvbi5wYXRobmFtZSArIHF1ZXJ5KTsKICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUuZm9ya0pvaW4oaHR0cF8xLmh0dHAuZ2V0KHVybCkpLnJldHJ5KDIpCiAgICAgICAgICAgIC50aW1lb3V0KGh0dHBfMS50aW1lb3V0KQogICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uIChyZXNMaXN0KSB7CiAgICAgICAgICAgIGlmICghcmVzTGlzdCB8fCAhcmVzTGlzdC5sZW5ndGgpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIHJlc0xpc3QuZm9yRWFjaChmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuaGFuZGxlck9uZVJlcXVlc3RQYWdlKHJlcyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfTsKICAgIFNvZ291UmVkaXJlY3QucHJvdG90eXBlLmhhbmRsZXJPbmVSZXF1ZXN0UGFnZSA9IGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgIHZhciByZXNwb25zZVRleHQgPSByZXMucmVzcG9uc2VUZXh0LnJlcGxhY2UoLyhzcmM9W14+XSp8bGluaz1bXj5dKS9nLCAnJyk7CiAgICAgICAgdmFyIGh0bWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdodG1sJyk7CiAgICAgICAgaHRtbC5pbm5lckhUTUwgPSByZXNwb25zZVRleHQ7CiAgICAgICAgLy8gbGV0IHNlbGVjdG9yID0gJyNtYWluIC5yZXN1bHRzIGRpdi52cndyYXA+aDMnOwogICAgICAgIC8vIGxldCBzZWxlY3RvciA9ICcjbWFpbiAucmVzdWx0cyBoMz5hJzsKICAgICAgICB2YXIgc2VsZWN0b3IgPSAnI21haW4gLnJlc3VsdHMgYVtocmVmKj0id3d3LnNvZ291LmNvbS9saW5rP3VybD0iXSc7CiAgICAgICAgdmFyIHJlbW90ZXMgPSBbXS5zbGljZS5jYWxsKGh0bWwucXVlcnlTZWxlY3RvckFsbCgnI21haW4gLnJlc3VsdHMgYVtocmVmXScpKTsKICAgICAgICB2YXIgbG9jYWxzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7CiAgICAgICAgbG9jYWxzLmZvckVhY2goZnVuY3Rpb24gKGxvY2FsRWxlKSB7CiAgICAgICAgICAgIHJlbW90ZXMuZm9yRWFjaChmdW5jdGlvbiAocmVtb3RlRWxlKSB7CiAgICAgICAgICAgICAgICB2YXIgbG9jYWxUZXh0ID0gZ2V0VGV4dChsb2NhbEVsZSk7CiAgICAgICAgICAgICAgICB2YXIgcmVtb3RlVGV4dCA9IGdldFRleHQocmVtb3RlRWxlKTsKICAgICAgICAgICAgICAgIC8vIOmAmueUqOaMiemSru+8jOS+i+WmguOAkOeCueWHu+S4i+i9veOAkQogICAgICAgICAgICAgICAgaWYgKGxvY2FsRWxlLmNsYXNzTGlzdC5jb250YWlucygnc3RyLXB1YmxpYy1idG4nKSkgewogICAgICAgICAgICAgICAgICAgIGxvY2FsVGV4dCA9IGdldFRleHQobG9jYWxFbGUucGFyZW50Tm9kZSk7CiAgICAgICAgICAgICAgICAgICAgcmVtb3RlVGV4dCA9IGdldFRleHQocmVtb3RlRWxlLnBhcmVudE5vZGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAobG9jYWxFbGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdzdHJfaW1nJykpIHsKICAgICAgICAgICAgICAgICAgICBsb2NhbFRleHQgPSBnZXRUZXh0KGxvY2FsRWxlLnBhcmVudE5vZGUucGFyZW50Tm9kZSk7CiAgICAgICAgICAgICAgICAgICAgcmVtb3RlVGV4dCA9IGdldFRleHQocmVtb3RlRWxlLnBhcmVudE5vZGUucGFyZW50Tm9kZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIWxvY2FsVGV4dCB8fCBsb2NhbFRleHQgIT09IHJlbW90ZVRleHQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgX3RoaXMudXJsVGVzdGVyLnRlc3QobG9jYWxFbGUuaHJlZikgJiYgbG9jYWxFbGUuc2V0QXR0cmlidXRlKCdvcmlnaW4taHJlZicsIGxvY2FsRWxlLmhyZWYpOwogICAgICAgICAgICAgICAgbG9jYWxFbGUuaHJlZiA9IHJlbW90ZUVsZS5ocmVmOwogICAgICAgICAgICAgICAgX3RoaXMuREVCVUcgJiYgKGxvY2FsRWxlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZWQnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9OwogICAgcmV0dXJuIFNvZ291UmVkaXJlY3Q7Cn0ocmVkaXJlY3Rfb25fcmVxdWVzdF8xLlJlZGlyZWN0T25SZXF1ZXN0KSk7CmV4cG9ydHMuZGVmYXVsdCA9IG5ldyBTb2dvdVJlZGlyZWN0KC93d3dcLnNvZ291XC5jb20vLCAvd3d3XC5zb2dvdVwuY29tXC9saW5rXD91cmw9LywgbnVsbCwgJyNjb250ZW50X2xlZnQgYScpOwoKCi8qKiovIH0pLAovKiA0OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAogICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwogICAgfTsKfSkoKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKdmFyIE9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7CnZhciByZWRpcmVjdF9vbl91cmxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CnZhciBCYWlkdVRpZWJhUmVkaXJlY3QgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEJhaWR1VGllYmFSZWRpcmVjdCwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEJhaWR1VGllYmFSZWRpcmVjdChkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlcikgewogICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlcikgfHwgdGhpczsKICAgIH0KICAgIEJhaWR1VGllYmFSZWRpcmVjdC5wcm90b3R5cGUuaGFuZGxlck9uZSA9IGZ1bmN0aW9uIChhRWxlKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUub2YoYUVsZSkKICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZWxlKSB7IHJldHVybiBfdGhpcy51cmxUZXN0ZXIudGVzdChlbGUuaHJlZik7IH0pCiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKGFFbGUpIHsKICAgICAgICAgICAgdmFyIHVybCA9ICcnOwogICAgICAgICAgICB2YXIgdGV4dCA9IGFFbGUuaW5uZXJUZXh0IHx8IGFFbGUudGV4dENvbnRlbnQgfHwgJyc7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB1cmwgPSBkZWNvZGVVUklDb21wb25lbnQodGV4dCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHVybCA9IC9odHRwcz86XC9cLy8udGVzdCh0ZXh0KSA/IHRleHQgOiAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodXJsKSB7CiAgICAgICAgICAgICAgICBhRWxlLmhyZWYgPSB1cmw7CiAgICAgICAgICAgICAgICBfdGhpcy5ERUJVRyAmJiAoYUVsZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZ3JlZW4nKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfTsKICAgIHJldHVybiBCYWlkdVRpZWJhUmVkaXJlY3Q7Cn0ocmVkaXJlY3Rfb25fdXJsXzEuUmVkaXJlY3RPblVybCkpOwpleHBvcnRzLmRlZmF1bHQgPSBuZXcgQmFpZHVUaWViYVJlZGlyZWN0KC90aWViYVwuYmFpZHVcLmNvbS8sIC9qdW1wXGQqXC5iZGltZ1wuY29tLywgbnVsbCk7CgoKLyoqKi8gfSksCi8qIDUwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwogICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CiAgICB9Owp9KSgpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIHJlZGlyZWN0X29uX3VybF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKdmFyIFR3aXR0ZXJSZWRpcmVjdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoVHdpdHRlclJlZGlyZWN0LCBfc3VwZXIpOwogICAgZnVuY3Rpb24gVHdpdHRlclJlZGlyZWN0KGRvbWFpblRlc3RlciwgdXJsVGVzdGVyLCBtYXRjaGVyKSB7CiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGRvbWFpblRlc3RlciwgdXJsVGVzdGVyLCBtYXRjaGVyKSB8fCB0aGlzOwogICAgfQogICAgVHdpdHRlclJlZGlyZWN0LnByb3RvdHlwZS5oYW5kbGVyT25lID0gZnVuY3Rpb24gKGFFbGUpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgIHJldHVybiBPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5vZihhRWxlKQogICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChlbGUpIHsgcmV0dXJuIF90aGlzLnVybFRlc3Rlci50ZXN0KGVsZS5ocmVmKSAmJiAvXmh0dHBzPzpcL1wvLy50ZXN0KGVsZS50aXRsZSk7IH0pCiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKGFFbGUpIHsKICAgICAgICAgICAgdmFyIHVybCA9IGRlY29kZVVSSUNvbXBvbmVudChhRWxlLnRpdGxlKTsKICAgICAgICAgICAgaWYgKHVybCkgewogICAgICAgICAgICAgICAgYUVsZS5ocmVmID0gdXJsOwogICAgICAgICAgICAgICAgX3RoaXMuREVCVUcgJiYgKGFFbGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZWVuJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CiAgICByZXR1cm4gVHdpdHRlclJlZGlyZWN0Owp9KHJlZGlyZWN0X29uX3VybF8xLlJlZGlyZWN0T25VcmwpKTsKZXhwb3J0cy5kZWZhdWx0ID0gbmV3IFR3aXR0ZXJSZWRpcmVjdCgvdHdpdHRlclwuY29tLywgL3RcLmNvXC9cdysvLCBudWxsKTsKCgovKioqLyB9KSwKLyogNTEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CnZhciBPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwp2YXIgcmVkaXJlY3Rfb25fdXJsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwp2YXIgV2VpYm9SZWRpcmVjdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2VpYm9SZWRpcmVjdCwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIFdlaWJvUmVkaXJlY3QoZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIpIHsKICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIpIHx8IHRoaXM7CiAgICB9CiAgICBXZWlib1JlZGlyZWN0LnByb3RvdHlwZS5oYW5kbGVyT25lID0gZnVuY3Rpb24gKGFFbGUpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgIHJldHVybiBPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5vZihhRWxlKQogICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChlbGUpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVybFRlc3Rlci50ZXN0KGVsZS5ocmVmKSAmJiAvXmh0dHBzPzpcL1wvLy50ZXN0KGVsZS50aXRsZSk7CiAgICAgICAgfSkKICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAoYUVsZSkgewogICAgICAgICAgICB2YXIgdXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KGFFbGUudGl0bGUpOwogICAgICAgICAgICBpZiAodXJsKSB7CiAgICAgICAgICAgICAgICBhRWxlLmhyZWYgPSB1cmw7CiAgICAgICAgICAgICAgICBfdGhpcy5ERUJVRyAmJiAoYUVsZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZ3JlZW4nKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfTsKICAgIHJldHVybiBXZWlib1JlZGlyZWN0Owp9KHJlZGlyZWN0X29uX3VybF8xLlJlZGlyZWN0T25VcmwpKTsKZXhwb3J0cy5kZWZhdWx0ID0gbmV3IFdlaWJvUmVkaXJlY3QoL3dlaWJvXC5jb20vLCAvdFwuY25cL1x3Ky8sIG51bGwpOwoKCi8qKiovIH0pLAovKiA1MiAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAogICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewogICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwogICAgfTsKfSkoKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKdmFyIHJlZGlyZWN0X29uX3VybF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsKdmFyIFpoaWh1RGFpbHlSZWRpcmVjdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoWmhpaHVEYWlseVJlZGlyZWN0LCBfc3VwZXIpOwogICAgZnVuY3Rpb24gWmhpaHVEYWlseVJlZGlyZWN0KGRvbWFpblRlc3RlciwgdXJsVGVzdGVyLCBtYXRjaGVyKSB7CiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGRvbWFpblRlc3RlciwgdXJsVGVzdGVyLCBtYXRjaGVyKSB8fCB0aGlzOwogICAgfQogICAgcmV0dXJuIFpoaWh1RGFpbHlSZWRpcmVjdDsKfShyZWRpcmVjdF9vbl91cmxfMS5SZWRpcmVjdE9uVXJsKSk7CmV4cG9ydHMuZGVmYXVsdCA9IG5ldyBaaGlodURhaWx5UmVkaXJlY3QoL2RhaWx5XC56aGlodVwuY29tLywgL3poaWh1XC5jb21cL1w/dGFyZ2V0PS8sIC96aGlodVwuY29tXC9cP3RhcmdldD0oLiopLyk7CgoKLyoqKi8gfSksCi8qIDUzICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAogICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwogICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CiAgICB9Owp9KSgpOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwp2YXIgcmVkaXJlY3Rfb25fdXJsXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpOwp2YXIgWmhpaHVaaHVhbmxhblJlZGlyZWN0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhaaGlodVpodWFubGFuUmVkaXJlY3QsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBaaGlodVpodWFubGFuUmVkaXJlY3QoZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIpIHsKICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgZG9tYWluVGVzdGVyLCB1cmxUZXN0ZXIsIG1hdGNoZXIpIHx8IHRoaXM7CiAgICB9CiAgICByZXR1cm4gWmhpaHVaaHVhbmxhblJlZGlyZWN0Owp9KHJlZGlyZWN0X29uX3VybF8xLlJlZGlyZWN0T25VcmwpKTsKZXhwb3J0cy5kZWZhdWx0ID0gbmV3IFpoaWh1Wmh1YW5sYW5SZWRpcmVjdCgvemh1YW5sYW5cLnpoaWh1XC5jb20vLCAvbGlua1wuemhpaHVcLmNvbVwvXD90YXJnZXQ9LywgL2xpbmtcLnpoaWh1XC5jb21cL1w/dGFyZ2V0PSguKikvKTsKCgovKioqLyB9KSwKLyogNTQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewogICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwogICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKICAgIH07Cn0pKCk7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CnZhciByZWRpcmVjdF9vbl91cmxfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7CnZhciBaaGlodVJlZGlyZWN0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhaaGlodVJlZGlyZWN0LCBfc3VwZXIpOwogICAgZnVuY3Rpb24gWmhpaHVSZWRpcmVjdChkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlcikgewogICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBkb21haW5UZXN0ZXIsIHVybFRlc3RlciwgbWF0Y2hlcikgfHwgdGhpczsKICAgIH0KICAgIHJldHVybiBaaGlodVJlZGlyZWN0Owp9KHJlZGlyZWN0X29uX3VybF8xLlJlZGlyZWN0T25VcmwpKTsKZXhwb3J0cy5kZWZhdWx0ID0gbmV3IFpoaWh1UmVkaXJlY3QoL3d3d1wuemhpaHVcLmNvbS8sIC96aGlodVwuY29tXC9cP3RhcmdldD0vLCAvemhpaHVcLmNvbVwvXD90YXJnZXQ9KC4qKS8pOwoKCi8qKiovIH0pLAovKiA1NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgU3Vic2NyaWJlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBpZ25vcmUKICogQGV4dGVuZHMge0lnbm9yZWR9CiAqLwp2YXIgSW5uZXJTdWJzY3JpYmVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhJbm5lclN1YnNjcmliZXIsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBJbm5lclN1YnNjcmliZXIocGFyZW50LCBvdXRlclZhbHVlLCBvdXRlckluZGV4KSB7CiAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7CiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7CiAgICAgICAgdGhpcy5vdXRlclZhbHVlID0gb3V0ZXJWYWx1ZTsKICAgICAgICB0aGlzLm91dGVySW5kZXggPSBvdXRlckluZGV4OwogICAgICAgIHRoaXMuaW5kZXggPSAwOwogICAgfQogICAgSW5uZXJTdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHRoaXMucGFyZW50Lm5vdGlmeU5leHQodGhpcy5vdXRlclZhbHVlLCB2YWx1ZSwgdGhpcy5vdXRlckluZGV4LCB0aGlzLmluZGV4KyssIHRoaXMpOwogICAgfTsKICAgIElubmVyU3Vic2NyaWJlci5wcm90b3R5cGUuX2Vycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5RXJyb3IoZXJyb3IsIHRoaXMpOwogICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTsKICAgIH07CiAgICBJbm5lclN1YnNjcmliZXIucHJvdG90eXBlLl9jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnlDb21wbGV0ZSh0aGlzKTsKICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgcmV0dXJuIElubmVyU3Vic2NyaWJlcjsKfShTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcikpOwpleHBvcnRzLklubmVyU3Vic2NyaWJlciA9IElubmVyU3Vic2NyaWJlcjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW5uZXJTdWJzY3JpYmVyLmpzLm1hcAoKLyoqKi8gfSksCi8qIDU2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCi8qKgogKiBBbiBleGVjdXRpb24gY29udGV4dCBhbmQgYSBkYXRhIHN0cnVjdHVyZSB0byBvcmRlciB0YXNrcyBhbmQgc2NoZWR1bGUgdGhlaXIKICogZXhlY3V0aW9uLiBQcm92aWRlcyBhIG5vdGlvbiBvZiAocG90ZW50aWFsbHkgdmlydHVhbCkgdGltZSwgdGhyb3VnaCB0aGUKICogYG5vdygpYCBnZXR0ZXIgbWV0aG9kLgogKgogKiBFYWNoIHVuaXQgb2Ygd29yayBpbiBhIFNjaGVkdWxlciBpcyBjYWxsZWQgYW4ge0BsaW5rIEFjdGlvbn0uCiAqCiAqIGBgYHRzCiAqIGNsYXNzIFNjaGVkdWxlciB7CiAqICAgbm93KCk6IG51bWJlcjsKICogICBzY2hlZHVsZSh3b3JrLCBkZWxheT8sIHN0YXRlPyk6IFN1YnNjcmlwdGlvbjsKICogfQogKiBgYGAKICoKICogQGNsYXNzIFNjaGVkdWxlcgogKi8KdmFyIFNjaGVkdWxlciA9IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBTY2hlZHVsZXIoU2NoZWR1bGVyQWN0aW9uLCBub3cpIHsKICAgICAgICBpZiAobm93ID09PSB2b2lkIDApIHsgbm93ID0gU2NoZWR1bGVyLm5vdzsgfQogICAgICAgIHRoaXMuU2NoZWR1bGVyQWN0aW9uID0gU2NoZWR1bGVyQWN0aW9uOwogICAgICAgIHRoaXMubm93ID0gbm93OwogICAgfQogICAgLyoqCiAgICAgKiBTY2hlZHVsZXMgYSBmdW5jdGlvbiwgYHdvcmtgLCBmb3IgZXhlY3V0aW9uLiBNYXkgaGFwcGVuIGF0IHNvbWUgcG9pbnQgaW4KICAgICAqIHRoZSBmdXR1cmUsIGFjY29yZGluZyB0byB0aGUgYGRlbGF5YCBwYXJhbWV0ZXIsIGlmIHNwZWNpZmllZC4gTWF5IGJlIHBhc3NlZAogICAgICogc29tZSBjb250ZXh0IG9iamVjdCwgYHN0YXRlYCwgd2hpY2ggd2lsbCBiZSBwYXNzZWQgdG8gdGhlIGB3b3JrYCBmdW5jdGlvbi4KICAgICAqCiAgICAgKiBUaGUgZ2l2ZW4gYXJndW1lbnRzIHdpbGwgYmUgcHJvY2Vzc2VkIGFuIHN0b3JlZCBhcyBhbiBBY3Rpb24gb2JqZWN0IGluIGEKICAgICAqIHF1ZXVlIG9mIGFjdGlvbnMuCiAgICAgKgogICAgICogQHBhcmFtIHtmdW5jdGlvbihzdGF0ZTogP1QpOiA/U3Vic2NyaXB0aW9ufSB3b3JrIEEgZnVuY3Rpb24gcmVwcmVzZW50aW5nIGEKICAgICAqIHRhc2ssIG9yIHNvbWUgdW5pdCBvZiB3b3JrIHRvIGJlIGV4ZWN1dGVkIGJ5IHRoZSBTY2hlZHVsZXIuCiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2RlbGF5XSBUaW1lIHRvIHdhaXQgYmVmb3JlIGV4ZWN1dGluZyB0aGUgd29yaywgd2hlcmUgdGhlCiAgICAgKiB0aW1lIHVuaXQgaXMgaW1wbGljaXQgYW5kIGRlZmluZWQgYnkgdGhlIFNjaGVkdWxlciBpdHNlbGYuCiAgICAgKiBAcGFyYW0ge1R9IFtzdGF0ZV0gU29tZSBjb250ZXh0dWFsIGRhdGEgdGhhdCB0aGUgYHdvcmtgIGZ1bmN0aW9uIHVzZXMgd2hlbgogICAgICogY2FsbGVkIGJ5IHRoZSBTY2hlZHVsZXIuCiAgICAgKiBAcmV0dXJuIHtTdWJzY3JpcHRpb259IEEgc3Vic2NyaXB0aW9uIGluIG9yZGVyIHRvIGJlIGFibGUgdG8gdW5zdWJzY3JpYmUKICAgICAqIHRoZSBzY2hlZHVsZWQgd29yay4KICAgICAqLwogICAgU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uICh3b3JrLCBkZWxheSwgc3RhdGUpIHsKICAgICAgICBpZiAoZGVsYXkgPT09IHZvaWQgMCkgeyBkZWxheSA9IDA7IH0KICAgICAgICByZXR1cm4gbmV3IHRoaXMuU2NoZWR1bGVyQWN0aW9uKHRoaXMsIHdvcmspLnNjaGVkdWxlKHN0YXRlLCBkZWxheSk7CiAgICB9OwogICAgU2NoZWR1bGVyLm5vdyA9IERhdGUubm93ID8gRGF0ZS5ub3cgOiBmdW5jdGlvbiAoKSB7IHJldHVybiArbmV3IERhdGUoKTsgfTsKICAgIHJldHVybiBTY2hlZHVsZXI7Cn0oKSk7CmV4cG9ydHMuU2NoZWR1bGVyID0gU2NoZWR1bGVyOwovLyMgc291cmNlTWFwcGluZ1VSTD1TY2hlZHVsZXIuanMubWFwCgovKioqLyB9KSwKLyogNTcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIE9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7CnZhciBTY2FsYXJPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KTsKdmFyIEVtcHR5T2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBleHRlbmRzIHtJZ25vcmVkfQogKiBAaGlkZSB0cnVlCiAqLwp2YXIgQXJyYXlMaWtlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoQXJyYXlMaWtlT2JzZXJ2YWJsZSwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEFycmF5TGlrZU9ic2VydmFibGUoYXJyYXlMaWtlLCBzY2hlZHVsZXIpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTsKICAgICAgICB0aGlzLmFycmF5TGlrZSA9IGFycmF5TGlrZTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgICAgICBpZiAoIXNjaGVkdWxlciAmJiBhcnJheUxpa2UubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICAgIHRoaXMuX2lzU2NhbGFyID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGFycmF5TGlrZVswXTsKICAgICAgICB9CiAgICB9CiAgICBBcnJheUxpa2VPYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChhcnJheUxpa2UsIHNjaGVkdWxlcikgewogICAgICAgIHZhciBsZW5ndGggPSBhcnJheUxpa2UubGVuZ3RoOwogICAgICAgIGlmIChsZW5ndGggPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBFbXB0eU9ic2VydmFibGVfMS5FbXB0eU9ic2VydmFibGUoKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobGVuZ3RoID09PSAxKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgU2NhbGFyT2JzZXJ2YWJsZV8xLlNjYWxhck9ic2VydmFibGUoYXJyYXlMaWtlWzBdLCBzY2hlZHVsZXIpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheUxpa2VPYnNlcnZhYmxlKGFycmF5TGlrZSwgc2NoZWR1bGVyKTsKICAgICAgICB9CiAgICB9OwogICAgQXJyYXlMaWtlT2JzZXJ2YWJsZS5kaXNwYXRjaCA9IGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHZhciBhcnJheUxpa2UgPSBzdGF0ZS5hcnJheUxpa2UsIGluZGV4ID0gc3RhdGUuaW5kZXgsIGxlbmd0aCA9IHN0YXRlLmxlbmd0aCwgc3Vic2NyaWJlciA9IHN0YXRlLnN1YnNjcmliZXI7CiAgICAgICAgaWYgKHN1YnNjcmliZXIuY2xvc2VkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGluZGV4ID49IGxlbmd0aCkgewogICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgc3Vic2NyaWJlci5uZXh0KGFycmF5TGlrZVtpbmRleF0pOwogICAgICAgIHN0YXRlLmluZGV4ID0gaW5kZXggKyAxOwogICAgICAgIHRoaXMuc2NoZWR1bGUoc3RhdGUpOwogICAgfTsKICAgIEFycmF5TGlrZU9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikgewogICAgICAgIHZhciBpbmRleCA9IDA7CiAgICAgICAgdmFyIF9hID0gdGhpcywgYXJyYXlMaWtlID0gX2EuYXJyYXlMaWtlLCBzY2hlZHVsZXIgPSBfYS5zY2hlZHVsZXI7CiAgICAgICAgdmFyIGxlbmd0aCA9IGFycmF5TGlrZS5sZW5ndGg7CiAgICAgICAgaWYgKHNjaGVkdWxlcikgewogICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKEFycmF5TGlrZU9ic2VydmFibGUuZGlzcGF0Y2gsIDAsIHsKICAgICAgICAgICAgICAgIGFycmF5TGlrZTogYXJyYXlMaWtlLCBpbmRleDogaW5kZXgsIGxlbmd0aDogbGVuZ3RoLCBzdWJzY3JpYmVyOiBzdWJzY3JpYmVyCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgIXN1YnNjcmliZXIuY2xvc2VkOyBpKyspIHsKICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChhcnJheUxpa2VbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICB9CiAgICB9OwogICAgcmV0dXJuIEFycmF5TGlrZU9ic2VydmFibGU7Cn0oT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpKTsKZXhwb3J0cy5BcnJheUxpa2VPYnNlcnZhYmxlID0gQXJyYXlMaWtlT2JzZXJ2YWJsZTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXJyYXlMaWtlT2JzZXJ2YWJsZS5qcy5tYXAKCi8qKiovIH0pLAovKiA1OCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIEVtcHR5T2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTsKdmFyIGlzQXJyYXlfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTApOwp2YXIgc3Vic2NyaWJlVG9SZXN1bHRfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpOwp2YXIgT3V0ZXJTdWJzY3JpYmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBleHRlbmRzIHtJZ25vcmVkfQogKiBAaGlkZSB0cnVlCiAqLwp2YXIgRm9ya0pvaW5PYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhGb3JrSm9pbk9ic2VydmFibGUsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBGb3JrSm9pbk9ic2VydmFibGUoc291cmNlcywgcmVzdWx0U2VsZWN0b3IpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTsKICAgICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzOwogICAgICAgIHRoaXMucmVzdWx0U2VsZWN0b3IgPSByZXN1bHRTZWxlY3RvcjsKICAgIH0KICAgIC8qIHRzbGludDplbmFibGU6bWF4LWxpbmUtbGVuZ3RoICovCiAgICAvKioKICAgICAqIEBwYXJhbSBzb3VyY2VzCiAgICAgKiBAcmV0dXJuIHthbnl9CiAgICAgKiBAc3RhdGljIHRydWUKICAgICAqIEBuYW1lIGZvcmtKb2luCiAgICAgKiBAb3duZXIgT2JzZXJ2YWJsZQogICAgICovCiAgICBGb3JrSm9pbk9ic2VydmFibGUuY3JlYXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzb3VyY2VzID0gW107CiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgICAgICAgICAgc291cmNlc1tfaSAtIDBdID0gYXJndW1lbnRzW19pXTsKICAgICAgICB9CiAgICAgICAgaWYgKHNvdXJjZXMgPT09IG51bGwgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEVtcHR5T2JzZXJ2YWJsZV8xLkVtcHR5T2JzZXJ2YWJsZSgpOwogICAgICAgIH0KICAgICAgICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBudWxsOwogICAgICAgIGlmICh0eXBlb2Ygc291cmNlc1tzb3VyY2VzLmxlbmd0aCAtIDFdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIHJlc3VsdFNlbGVjdG9yID0gc291cmNlcy5wb3AoKTsKICAgICAgICB9CiAgICAgICAgLy8gaWYgdGhlIGZpcnN0IGFuZCBvbmx5IG90aGVyIGFyZ3VtZW50IGJlc2lkZXMgdGhlIHJlc3VsdFNlbGVjdG9yIGlzIGFuIGFycmF5CiAgICAgICAgLy8gYXNzdW1lIGl0J3MgYmVlbiBjYWxsZWQgd2l0aCBgZm9ya0pvaW4oW29iczEsIG9iczIsIG9iczNdLCByZXN1bHRTZWxlY3RvcilgCiAgICAgICAgaWYgKHNvdXJjZXMubGVuZ3RoID09PSAxICYmIGlzQXJyYXlfMS5pc0FycmF5KHNvdXJjZXNbMF0pKSB7CiAgICAgICAgICAgIHNvdXJjZXMgPSBzb3VyY2VzWzBdOwogICAgICAgIH0KICAgICAgICBpZiAoc291cmNlcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBFbXB0eU9ic2VydmFibGVfMS5FbXB0eU9ic2VydmFibGUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBGb3JrSm9pbk9ic2VydmFibGUoc291cmNlcywgcmVzdWx0U2VsZWN0b3IpOwogICAgfTsKICAgIEZvcmtKb2luT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBGb3JrSm9pblN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5zb3VyY2VzLCB0aGlzLnJlc3VsdFNlbGVjdG9yKTsKICAgIH07CiAgICByZXR1cm4gRm9ya0pvaW5PYnNlcnZhYmxlOwp9KE9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSk7CmV4cG9ydHMuRm9ya0pvaW5PYnNlcnZhYmxlID0gRm9ya0pvaW5PYnNlcnZhYmxlOwovKioKICogV2UgbmVlZCB0aGlzIEpTRG9jIGNvbW1lbnQgZm9yIGFmZmVjdGluZyBFU0RvYy4KICogQGlnbm9yZQogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICovCnZhciBGb3JrSm9pblN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEZvcmtKb2luU3Vic2NyaWJlciwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEZvcmtKb2luU3Vic2NyaWJlcihkZXN0aW5hdGlvbiwgc291cmNlcywgcmVzdWx0U2VsZWN0b3IpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbik7CiAgICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlczsKICAgICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gcmVzdWx0U2VsZWN0b3I7CiAgICAgICAgdGhpcy5jb21wbGV0ZWQgPSAwOwogICAgICAgIHRoaXMuaGF2ZVZhbHVlcyA9IDA7CiAgICAgICAgdmFyIGxlbiA9IHNvdXJjZXMubGVuZ3RoOwogICAgICAgIHRoaXMudG90YWwgPSBsZW47CiAgICAgICAgdGhpcy52YWx1ZXMgPSBuZXcgQXJyYXkobGVuKTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBzb3VyY2VzW2ldOwogICAgICAgICAgICB2YXIgaW5uZXJTdWJzY3JpcHRpb24gPSBzdWJzY3JpYmVUb1Jlc3VsdF8xLnN1YnNjcmliZVRvUmVzdWx0KHRoaXMsIHNvdXJjZSwgbnVsbCwgaSk7CiAgICAgICAgICAgIGlmIChpbm5lclN1YnNjcmlwdGlvbikgewogICAgICAgICAgICAgICAgaW5uZXJTdWJzY3JpcHRpb24ub3V0ZXJJbmRleCA9IGk7CiAgICAgICAgICAgICAgICB0aGlzLmFkZChpbm5lclN1YnNjcmlwdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBGb3JrSm9pblN1YnNjcmliZXIucHJvdG90eXBlLm5vdGlmeU5leHQgPSBmdW5jdGlvbiAob3V0ZXJWYWx1ZSwgaW5uZXJWYWx1ZSwgb3V0ZXJJbmRleCwgaW5uZXJJbmRleCwgaW5uZXJTdWIpIHsKICAgICAgICB0aGlzLnZhbHVlc1tvdXRlckluZGV4XSA9IGlubmVyVmFsdWU7CiAgICAgICAgaWYgKCFpbm5lclN1Yi5faGFzVmFsdWUpIHsKICAgICAgICAgICAgaW5uZXJTdWIuX2hhc1ZhbHVlID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5oYXZlVmFsdWVzKys7CiAgICAgICAgfQogICAgfTsKICAgIEZvcmtKb2luU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5Q29tcGxldGUgPSBmdW5jdGlvbiAoaW5uZXJTdWIpIHsKICAgICAgICB2YXIgZGVzdGluYXRpb24gPSB0aGlzLmRlc3RpbmF0aW9uOwogICAgICAgIHZhciBfYSA9IHRoaXMsIGhhdmVWYWx1ZXMgPSBfYS5oYXZlVmFsdWVzLCByZXN1bHRTZWxlY3RvciA9IF9hLnJlc3VsdFNlbGVjdG9yLCB2YWx1ZXMgPSBfYS52YWx1ZXM7CiAgICAgICAgdmFyIGxlbiA9IHZhbHVlcy5sZW5ndGg7CiAgICAgICAgaWYgKCFpbm5lclN1Yi5faGFzVmFsdWUpIHsKICAgICAgICAgICAgZGVzdGluYXRpb24uY29tcGxldGUoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmNvbXBsZXRlZCsrOwogICAgICAgIGlmICh0aGlzLmNvbXBsZXRlZCAhPT0gbGVuKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGhhdmVWYWx1ZXMgPT09IGxlbikgewogICAgICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHRTZWxlY3RvciA/IHJlc3VsdFNlbGVjdG9yLmFwcGx5KHRoaXMsIHZhbHVlcykgOiB2YWx1ZXM7CiAgICAgICAgICAgIGRlc3RpbmF0aW9uLm5leHQodmFsdWUpOwogICAgICAgIH0KICAgICAgICBkZXN0aW5hdGlvbi5jb21wbGV0ZSgpOwogICAgfTsKICAgIHJldHVybiBGb3JrSm9pblN1YnNjcmliZXI7Cn0oT3V0ZXJTdWJzY3JpYmVyXzEuT3V0ZXJTdWJzY3JpYmVyKSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPUZvcmtKb2luT2JzZXJ2YWJsZS5qcy5tYXAKCi8qKiovIH0pLAovKiA1OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIHRyeUNhdGNoXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTsKdmFyIGlzRnVuY3Rpb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpOwp2YXIgZXJyb3JPYmplY3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7CnZhciBTdWJzY3JpcHRpb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7CnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CmZ1bmN0aW9uIGlzTm9kZVN0eWxlRXZlbnRFbWl0dGVyKHNvdXJjZU9iaikgewogICAgcmV0dXJuICEhc291cmNlT2JqICYmIHR5cGVvZiBzb3VyY2VPYmouYWRkTGlzdGVuZXIgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIHNvdXJjZU9iai5yZW1vdmVMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJzsKfQpmdW5jdGlvbiBpc0pRdWVyeVN0eWxlRXZlbnRFbWl0dGVyKHNvdXJjZU9iaikgewogICAgcmV0dXJuICEhc291cmNlT2JqICYmIHR5cGVvZiBzb3VyY2VPYmoub24gPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIHNvdXJjZU9iai5vZmYgPT09ICdmdW5jdGlvbic7Cn0KZnVuY3Rpb24gaXNOb2RlTGlzdChzb3VyY2VPYmopIHsKICAgIHJldHVybiAhIXNvdXJjZU9iaiAmJiB0b1N0cmluZy5jYWxsKHNvdXJjZU9iaikgPT09ICdbb2JqZWN0IE5vZGVMaXN0XSc7Cn0KZnVuY3Rpb24gaXNIVE1MQ29sbGVjdGlvbihzb3VyY2VPYmopIHsKICAgIHJldHVybiAhIXNvdXJjZU9iaiAmJiB0b1N0cmluZy5jYWxsKHNvdXJjZU9iaikgPT09ICdbb2JqZWN0IEhUTUxDb2xsZWN0aW9uXSc7Cn0KZnVuY3Rpb24gaXNFdmVudFRhcmdldChzb3VyY2VPYmopIHsKICAgIHJldHVybiAhIXNvdXJjZU9iaiAmJiB0eXBlb2Ygc291cmNlT2JqLmFkZEV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIHNvdXJjZU9iai5yZW1vdmVFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nOwp9Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICogQGhpZGUgdHJ1ZQogKi8KdmFyIEZyb21FdmVudE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEZyb21FdmVudE9ic2VydmFibGUsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBGcm9tRXZlbnRPYnNlcnZhYmxlKHNvdXJjZU9iaiwgZXZlbnROYW1lLCBzZWxlY3Rvciwgb3B0aW9ucykgewogICAgICAgIF9zdXBlci5jYWxsKHRoaXMpOwogICAgICAgIHRoaXMuc291cmNlT2JqID0gc291cmNlT2JqOwogICAgICAgIHRoaXMuZXZlbnROYW1lID0gZXZlbnROYW1lOwogICAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjsKICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwogICAgfQogICAgLyogdHNsaW50OmVuYWJsZTptYXgtbGluZS1sZW5ndGggKi8KICAgIC8qKgogICAgICogQ3JlYXRlcyBhbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgZXZlbnRzIG9mIGEgc3BlY2lmaWMgdHlwZSBjb21pbmcgZnJvbSB0aGUKICAgICAqIGdpdmVuIGV2ZW50IHRhcmdldC4KICAgICAqCiAgICAgKiA8c3BhbiBjbGFzcz0iaW5mb3JtYWwiPkNyZWF0ZXMgYW4gT2JzZXJ2YWJsZSBmcm9tIERPTSBldmVudHMsIG9yIE5vZGUKICAgICAqIEV2ZW50RW1pdHRlciBldmVudHMgb3Igb3RoZXJzLjwvc3Bhbj4KICAgICAqCiAgICAgKiA8aW1nIHNyYz0iLi9pbWcvZnJvbUV2ZW50LnBuZyIgd2lkdGg9IjEwMCUiPgogICAgICoKICAgICAqIENyZWF0ZXMgYW4gT2JzZXJ2YWJsZSBieSBhdHRhY2hpbmcgYW4gZXZlbnQgbGlzdGVuZXIgdG8gYW4gImV2ZW50IHRhcmdldCIsCiAgICAgKiB3aGljaCBtYXkgYmUgYW4gb2JqZWN0IHdpdGggYGFkZEV2ZW50TGlzdGVuZXJgIGFuZCBgcmVtb3ZlRXZlbnRMaXN0ZW5lcmAsCiAgICAgKiBhIE5vZGUuanMgRXZlbnRFbWl0dGVyLCBhIGpRdWVyeSBzdHlsZSBFdmVudEVtaXR0ZXIsIGEgTm9kZUxpc3QgZnJvbSB0aGUKICAgICAqIERPTSwgb3IgYW4gSFRNTENvbGxlY3Rpb24gZnJvbSB0aGUgRE9NLiBUaGUgZXZlbnQgaGFuZGxlciBpcyBhdHRhY2hlZCB3aGVuCiAgICAgKiB0aGUgb3V0cHV0IE9ic2VydmFibGUgaXMgc3Vic2NyaWJlZCwgYW5kIHJlbW92ZWQgd2hlbiB0aGUgU3Vic2NyaXB0aW9uIGlzCiAgICAgKiB1bnN1YnNjcmliZWQuCiAgICAgKgogICAgICogQGV4YW1wbGUgPGNhcHRpb24+RW1pdHMgY2xpY2tzIGhhcHBlbmluZyBvbiB0aGUgRE9NIGRvY3VtZW50PC9jYXB0aW9uPgogICAgICogdmFyIGNsaWNrcyA9IFJ4Lk9ic2VydmFibGUuZnJvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snKTsKICAgICAqIGNsaWNrcy5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSk7CiAgICAgKgogICAgICogLy8gUmVzdWx0cyBpbjoKICAgICAqIC8vIE1vdXNlRXZlbnQgb2JqZWN0IGxvZ2dlZCB0byBjb25zb2xlIGV2ZXJ5dGltZSBhIGNsaWNrCiAgICAgKiAvLyBvY2N1cnMgb24gdGhlIGRvY3VtZW50LgogICAgICoKICAgICAqIEBzZWUge0BsaW5rIGZyb219CiAgICAgKiBAc2VlIHtAbGluayBmcm9tRXZlbnRQYXR0ZXJufQogICAgICoKICAgICAqIEBwYXJhbSB7RXZlbnRUYXJnZXRMaWtlfSB0YXJnZXQgVGhlIERPTUVsZW1lbnQsIGV2ZW50IHRhcmdldCwgTm9kZS5qcwogICAgICogRXZlbnRFbWl0dGVyLCBOb2RlTGlzdCBvciBIVE1MQ29sbGVjdGlvbiB0byBhdHRhY2ggdGhlIGV2ZW50IGhhbmRsZXIgdG8uCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lIFRoZSBldmVudCBuYW1lIG9mIGludGVyZXN0LCBiZWluZyBlbWl0dGVkIGJ5IHRoZQogICAgICogYHRhcmdldGAuCiAgICAgKiBAcGFyYW0ge0V2ZW50TGlzdGVuZXJPcHRpb25zfSBbb3B0aW9uc10gT3B0aW9ucyB0byBwYXNzIHRocm91Z2ggdG8gYWRkRXZlbnRMaXN0ZW5lcgogICAgICogQHBhcmFtIHtTZWxlY3Rvck1ldGhvZFNpZ25hdHVyZTxUPn0gW3NlbGVjdG9yXSBBbiBvcHRpb25hbCBmdW5jdGlvbiB0bwogICAgICogcG9zdC1wcm9jZXNzIHJlc3VsdHMuIEl0IHRha2VzIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgZXZlbnQgaGFuZGxlciBhbmQKICAgICAqIHNob3VsZCByZXR1cm4gYSBzaW5nbGUgdmFsdWUuCiAgICAgKiBAcmV0dXJuIHtPYnNlcnZhYmxlPFQ+fQogICAgICogQHN0YXRpYyB0cnVlCiAgICAgKiBAbmFtZSBmcm9tRXZlbnQKICAgICAqIEBvd25lciBPYnNlcnZhYmxlCiAgICAgKi8KICAgIEZyb21FdmVudE9ic2VydmFibGUuY3JlYXRlID0gZnVuY3Rpb24gKHRhcmdldCwgZXZlbnROYW1lLCBvcHRpb25zLCBzZWxlY3RvcikgewogICAgICAgIGlmIChpc0Z1bmN0aW9uXzEuaXNGdW5jdGlvbihvcHRpb25zKSkgewogICAgICAgICAgICBzZWxlY3RvciA9IG9wdGlvbnM7CiAgICAgICAgICAgIG9wdGlvbnMgPSB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgRnJvbUV2ZW50T2JzZXJ2YWJsZSh0YXJnZXQsIGV2ZW50TmFtZSwgc2VsZWN0b3IsIG9wdGlvbnMpOwogICAgfTsKICAgIEZyb21FdmVudE9ic2VydmFibGUuc2V0dXBTdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAoc291cmNlT2JqLCBldmVudE5hbWUsIGhhbmRsZXIsIHN1YnNjcmliZXIsIG9wdGlvbnMpIHsKICAgICAgICB2YXIgdW5zdWJzY3JpYmU7CiAgICAgICAgaWYgKGlzTm9kZUxpc3Qoc291cmNlT2JqKSB8fCBpc0hUTUxDb2xsZWN0aW9uKHNvdXJjZU9iaikpIHsKICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHNvdXJjZU9iai5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgRnJvbUV2ZW50T2JzZXJ2YWJsZS5zZXR1cFN1YnNjcmlwdGlvbihzb3VyY2VPYmpbaV0sIGV2ZW50TmFtZSwgaGFuZGxlciwgc3Vic2NyaWJlciwgb3B0aW9ucyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAoaXNFdmVudFRhcmdldChzb3VyY2VPYmopKSB7CiAgICAgICAgICAgIHZhciBzb3VyY2VfMSA9IHNvdXJjZU9iajsKICAgICAgICAgICAgc291cmNlT2JqLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyLCBvcHRpb25zKTsKICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBzb3VyY2VfMS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlcik7IH07CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKGlzSlF1ZXJ5U3R5bGVFdmVudEVtaXR0ZXIoc291cmNlT2JqKSkgewogICAgICAgICAgICB2YXIgc291cmNlXzIgPSBzb3VyY2VPYmo7CiAgICAgICAgICAgIHNvdXJjZU9iai5vbihldmVudE5hbWUsIGhhbmRsZXIpOwogICAgICAgICAgICB1bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNvdXJjZV8yLm9mZihldmVudE5hbWUsIGhhbmRsZXIpOyB9OwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChpc05vZGVTdHlsZUV2ZW50RW1pdHRlcihzb3VyY2VPYmopKSB7CiAgICAgICAgICAgIHZhciBzb3VyY2VfMyA9IHNvdXJjZU9iajsKICAgICAgICAgICAgc291cmNlT2JqLmFkZExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlcik7CiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gc291cmNlXzMucmVtb3ZlTGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyKTsgfTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgZXZlbnQgdGFyZ2V0Jyk7CiAgICAgICAgfQogICAgICAgIHN1YnNjcmliZXIuYWRkKG5ldyBTdWJzY3JpcHRpb25fMS5TdWJzY3JpcHRpb24odW5zdWJzY3JpYmUpKTsKICAgIH07CiAgICBGcm9tRXZlbnRPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmliZXIpIHsKICAgICAgICB2YXIgc291cmNlT2JqID0gdGhpcy5zb3VyY2VPYmo7CiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHRoaXMuZXZlbnROYW1lOwogICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zOwogICAgICAgIHZhciBzZWxlY3RvciA9IHRoaXMuc2VsZWN0b3I7CiAgICAgICAgdmFyIGhhbmRsZXIgPSBzZWxlY3RvciA/IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTsKICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAwXSA9IGFyZ3VtZW50c1tfaV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoXzEudHJ5Q2F0Y2goc2VsZWN0b3IpLmFwcGx5KHZvaWQgMCwgYXJncyk7CiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqZWN0XzEuZXJyb3JPYmplY3QpIHsKICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyb3JPYmplY3RfMS5lcnJvck9iamVjdC5lKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChyZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgfSA6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBzdWJzY3JpYmVyLm5leHQoZSk7IH07CiAgICAgICAgRnJvbUV2ZW50T2JzZXJ2YWJsZS5zZXR1cFN1YnNjcmlwdGlvbihzb3VyY2VPYmosIGV2ZW50TmFtZSwgaGFuZGxlciwgc3Vic2NyaWJlciwgb3B0aW9ucyk7CiAgICB9OwogICAgcmV0dXJuIEZyb21FdmVudE9ic2VydmFibGU7Cn0oT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpKTsKZXhwb3J0cy5Gcm9tRXZlbnRPYnNlcnZhYmxlID0gRnJvbUV2ZW50T2JzZXJ2YWJsZTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9RnJvbUV2ZW50T2JzZXJ2YWJsZS5qcy5tYXAKCi8qKiovIH0pLAovKiA2MCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgaXNBcnJheV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7CnZhciBpc0FycmF5TGlrZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7CnZhciBpc1Byb21pc2VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpOwp2YXIgUHJvbWlzZU9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNjIpOwp2YXIgSXRlcmF0b3JPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYxKTsKdmFyIEFycmF5T2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7CnZhciBBcnJheUxpa2VPYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU3KTsKdmFyIGl0ZXJhdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIG9ic2VydmVPbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3Myk7CnZhciBvYnNlcnZhYmxlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpOwovKioKICogV2UgbmVlZCB0aGlzIEpTRG9jIGNvbW1lbnQgZm9yIGFmZmVjdGluZyBFU0RvYy4KICogQGV4dGVuZHMge0lnbm9yZWR9CiAqIEBoaWRlIHRydWUKICovCnZhciBGcm9tT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoRnJvbU9ic2VydmFibGUsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBGcm9tT2JzZXJ2YWJsZShpc2gsIHNjaGVkdWxlcikgewogICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIG51bGwpOwogICAgICAgIHRoaXMuaXNoID0gaXNoOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgfQogICAgLyoqCiAgICAgKiBDcmVhdGVzIGFuIE9ic2VydmFibGUgZnJvbSBhbiBBcnJheSwgYW4gYXJyYXktbGlrZSBvYmplY3QsIGEgUHJvbWlzZSwgYW4KICAgICAqIGl0ZXJhYmxlIG9iamVjdCwgb3IgYW4gT2JzZXJ2YWJsZS1saWtlIG9iamVjdC4KICAgICAqCiAgICAgKiA8c3BhbiBjbGFzcz0iaW5mb3JtYWwiPkNvbnZlcnRzIGFsbW9zdCBhbnl0aGluZyB0byBhbiBPYnNlcnZhYmxlLjwvc3Bhbj4KICAgICAqCiAgICAgKiA8aW1nIHNyYz0iLi9pbWcvZnJvbS5wbmciIHdpZHRoPSIxMDAlIj4KICAgICAqCiAgICAgKiBDb252ZXJ0IHZhcmlvdXMgb3RoZXIgb2JqZWN0cyBhbmQgZGF0YSB0eXBlcyBpbnRvIE9ic2VydmFibGVzLiBgZnJvbWAKICAgICAqIGNvbnZlcnRzIGEgUHJvbWlzZSBvciBhbiBhcnJheS1saWtlIG9yIGFuCiAgICAgKiBbaXRlcmFibGVdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0l0ZXJhdGlvbl9wcm90b2NvbHMjaXRlcmFibGUpCiAgICAgKiBvYmplY3QgaW50byBhbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgdGhlIGl0ZW1zIGluIHRoYXQgcHJvbWlzZSBvciBhcnJheSBvcgogICAgICogaXRlcmFibGUuIEEgU3RyaW5nLCBpbiB0aGlzIGNvbnRleHQsIGlzIHRyZWF0ZWQgYXMgYW4gYXJyYXkgb2YgY2hhcmFjdGVycy4KICAgICAqIE9ic2VydmFibGUtbGlrZSBvYmplY3RzIChjb250YWlucyBhIGZ1bmN0aW9uIG5hbWVkIHdpdGggdGhlIEVTMjAxNSBTeW1ib2wKICAgICAqIGZvciBPYnNlcnZhYmxlKSBjYW4gYWxzbyBiZSBjb252ZXJ0ZWQgdGhyb3VnaCB0aGlzIG9wZXJhdG9yLgogICAgICoKICAgICAqIEBleGFtcGxlIDxjYXB0aW9uPkNvbnZlcnRzIGFuIGFycmF5IHRvIGFuIE9ic2VydmFibGU8L2NhcHRpb24+CiAgICAgKiB2YXIgYXJyYXkgPSBbMTAsIDIwLCAzMF07CiAgICAgKiB2YXIgcmVzdWx0ID0gUnguT2JzZXJ2YWJsZS5mcm9tKGFycmF5KTsKICAgICAqIHJlc3VsdC5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSk7CiAgICAgKgogICAgICogLy8gUmVzdWx0cyBpbiB0aGUgZm9sbG93aW5nOgogICAgICogLy8gMTAgMjAgMzAKICAgICAqCiAgICAgKiBAZXhhbXBsZSA8Y2FwdGlvbj5Db252ZXJ0IGFuIGluZmluaXRlIGl0ZXJhYmxlIChmcm9tIGEgZ2VuZXJhdG9yKSB0byBhbiBPYnNlcnZhYmxlPC9jYXB0aW9uPgogICAgICogZnVuY3Rpb24qIGdlbmVyYXRlRG91YmxlcyhzZWVkKSB7CiAgICAgKiAgIHZhciBpID0gc2VlZDsKICAgICAqICAgd2hpbGUgKHRydWUpIHsKICAgICAqICAgICB5aWVsZCBpOwogICAgICogICAgIGkgPSAyICogaTsgLy8gZG91YmxlIGl0CiAgICAgKiAgIH0KICAgICAqIH0KICAgICAqCiAgICAgKiB2YXIgaXRlcmF0b3IgPSBnZW5lcmF0ZURvdWJsZXMoMyk7CiAgICAgKiB2YXIgcmVzdWx0ID0gUnguT2JzZXJ2YWJsZS5mcm9tKGl0ZXJhdG9yKS50YWtlKDEwKTsKICAgICAqIHJlc3VsdC5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSk7CiAgICAgKgogICAgICogLy8gUmVzdWx0cyBpbiB0aGUgZm9sbG93aW5nOgogICAgICogLy8gMyA2IDEyIDI0IDQ4IDk2IDE5MiAzODQgNzY4IDE1MzYKICAgICAqCiAgICAgKiBAc2VlIHtAbGluayBjcmVhdGV9CiAgICAgKiBAc2VlIHtAbGluayBmcm9tRXZlbnR9CiAgICAgKiBAc2VlIHtAbGluayBmcm9tRXZlbnRQYXR0ZXJufQogICAgICogQHNlZSB7QGxpbmsgZnJvbVByb21pc2V9CiAgICAgKgogICAgICogQHBhcmFtIHtPYnNlcnZhYmxlSW5wdXQ8VD59IGlzaCBBIHN1YnNjcmliYWJsZSBvYmplY3QsIGEgUHJvbWlzZSwgYW4KICAgICAqIE9ic2VydmFibGUtbGlrZSwgYW4gQXJyYXksIGFuIGl0ZXJhYmxlIG9yIGFuIGFycmF5LWxpa2Ugb2JqZWN0IHRvIGJlCiAgICAgKiBjb252ZXJ0ZWQuCiAgICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gVGhlIHNjaGVkdWxlciBvbiB3aGljaCB0byBzY2hlZHVsZSB0aGUKICAgICAqIGVtaXNzaW9ucyBvZiB2YWx1ZXMuCiAgICAgKiBAcmV0dXJuIHtPYnNlcnZhYmxlPFQ+fSBUaGUgT2JzZXJ2YWJsZSB3aG9zZSB2YWx1ZXMgYXJlIG9yaWdpbmFsbHkgZnJvbSB0aGUKICAgICAqIGlucHV0IG9iamVjdCB0aGF0IHdhcyBjb252ZXJ0ZWQuCiAgICAgKiBAc3RhdGljIHRydWUKICAgICAqIEBuYW1lIGZyb20KICAgICAqIEBvd25lciBPYnNlcnZhYmxlCiAgICAgKi8KICAgIEZyb21PYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChpc2gsIHNjaGVkdWxlcikgewogICAgICAgIGlmIChpc2ggIT0gbnVsbCkgewogICAgICAgICAgICBpZiAodHlwZW9mIGlzaFtvYnNlcnZhYmxlXzEuJCRvYnNlcnZhYmxlXSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgaWYgKGlzaCBpbnN0YW5jZW9mIE9ic2VydmFibGVfMS5PYnNlcnZhYmxlICYmICFzY2hlZHVsZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNoOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGcm9tT2JzZXJ2YWJsZShpc2gsIHNjaGVkdWxlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoaXNBcnJheV8xLmlzQXJyYXkoaXNoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheU9ic2VydmFibGVfMS5BcnJheU9ic2VydmFibGUoaXNoLCBzY2hlZHVsZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGlzUHJvbWlzZV8xLmlzUHJvbWlzZShpc2gpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2VPYnNlcnZhYmxlXzEuUHJvbWlzZU9ic2VydmFibGUoaXNoLCBzY2hlZHVsZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpc2hbaXRlcmF0b3JfMS4kJGl0ZXJhdG9yXSA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgaXNoID09PSAnc3RyaW5nJykgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBJdGVyYXRvck9ic2VydmFibGVfMS5JdGVyYXRvck9ic2VydmFibGUoaXNoLCBzY2hlZHVsZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGlzQXJyYXlMaWtlXzEuaXNBcnJheUxpa2UoaXNoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheUxpa2VPYnNlcnZhYmxlXzEuQXJyYXlMaWtlT2JzZXJ2YWJsZShpc2gsIHNjaGVkdWxlcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigoaXNoICE9PSBudWxsICYmIHR5cGVvZiBpc2ggfHwgaXNoKSArICcgaXMgbm90IG9ic2VydmFibGUnKTsKICAgIH07CiAgICBGcm9tT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7CiAgICAgICAgdmFyIGlzaCA9IHRoaXMuaXNoOwogICAgICAgIHZhciBzY2hlZHVsZXIgPSB0aGlzLnNjaGVkdWxlcjsKICAgICAgICBpZiAoc2NoZWR1bGVyID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIGlzaFtvYnNlcnZhYmxlXzEuJCRvYnNlcnZhYmxlXSgpLnN1YnNjcmliZShzdWJzY3JpYmVyKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBpc2hbb2JzZXJ2YWJsZV8xLiQkb2JzZXJ2YWJsZV0oKS5zdWJzY3JpYmUobmV3IG9ic2VydmVPbl8xLk9ic2VydmVPblN1YnNjcmliZXIoc3Vic2NyaWJlciwgc2NoZWR1bGVyLCAwKSk7CiAgICAgICAgfQogICAgfTsKICAgIHJldHVybiBGcm9tT2JzZXJ2YWJsZTsKfShPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkpOwpleHBvcnRzLkZyb21PYnNlcnZhYmxlID0gRnJvbU9ic2VydmFibGU7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPUZyb21PYnNlcnZhYmxlLmpzLm1hcAoKLyoqKi8gfSksCi8qIDYxICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciByb290XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOwp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKdmFyIGl0ZXJhdG9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpOwovKioKICogV2UgbmVlZCB0aGlzIEpTRG9jIGNvbW1lbnQgZm9yIGFmZmVjdGluZyBFU0RvYy4KICogQGV4dGVuZHMge0lnbm9yZWR9CiAqIEBoaWRlIHRydWUKICovCnZhciBJdGVyYXRvck9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEl0ZXJhdG9yT2JzZXJ2YWJsZSwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEl0ZXJhdG9yT2JzZXJ2YWJsZShpdGVyYXRvciwgc2NoZWR1bGVyKSB7CiAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7CiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICAgICAgaWYgKGl0ZXJhdG9yID09IG51bGwpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpdGVyYXRvciBjYW5ub3QgYmUgbnVsbC4nKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5pdGVyYXRvciA9IGdldEl0ZXJhdG9yKGl0ZXJhdG9yKTsKICAgIH0KICAgIEl0ZXJhdG9yT2JzZXJ2YWJsZS5jcmVhdGUgPSBmdW5jdGlvbiAoaXRlcmF0b3IsIHNjaGVkdWxlcikgewogICAgICAgIHJldHVybiBuZXcgSXRlcmF0b3JPYnNlcnZhYmxlKGl0ZXJhdG9yLCBzY2hlZHVsZXIpOwogICAgfTsKICAgIEl0ZXJhdG9yT2JzZXJ2YWJsZS5kaXNwYXRjaCA9IGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHZhciBpbmRleCA9IHN0YXRlLmluZGV4LCBoYXNFcnJvciA9IHN0YXRlLmhhc0Vycm9yLCBpdGVyYXRvciA9IHN0YXRlLml0ZXJhdG9yLCBzdWJzY3JpYmVyID0gc3RhdGUuc3Vic2NyaWJlcjsKICAgICAgICBpZiAoaGFzRXJyb3IpIHsKICAgICAgICAgICAgc3Vic2NyaWJlci5lcnJvcihzdGF0ZS5lcnJvcik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdmFyIHJlc3VsdCA9IGl0ZXJhdG9yLm5leHQoKTsKICAgICAgICBpZiAocmVzdWx0LmRvbmUpIHsKICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHN1YnNjcmliZXIubmV4dChyZXN1bHQudmFsdWUpOwogICAgICAgIHN0YXRlLmluZGV4ID0gaW5kZXggKyAxOwogICAgICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkgewogICAgICAgICAgICBpZiAodHlwZW9mIGl0ZXJhdG9yLnJldHVybiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgaXRlcmF0b3IucmV0dXJuKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLnNjaGVkdWxlKHN0YXRlKTsKICAgIH07CiAgICBJdGVyYXRvck9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikgewogICAgICAgIHZhciBpbmRleCA9IDA7CiAgICAgICAgdmFyIF9hID0gdGhpcywgaXRlcmF0b3IgPSBfYS5pdGVyYXRvciwgc2NoZWR1bGVyID0gX2Euc2NoZWR1bGVyOwogICAgICAgIGlmIChzY2hlZHVsZXIpIHsKICAgICAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZShJdGVyYXRvck9ic2VydmFibGUuZGlzcGF0Y2gsIDAsIHsKICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleCwgaXRlcmF0b3I6IGl0ZXJhdG9yLCBzdWJzY3JpYmVyOiBzdWJzY3JpYmVyCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGl0ZXJhdG9yLm5leHQoKTsKICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZG9uZSkgewogICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChyZXN1bHQudmFsdWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHN1YnNjcmliZXIuY2xvc2VkKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVyYXRvci5yZXR1cm4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlcmF0b3IucmV0dXJuKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IHdoaWxlICh0cnVlKTsKICAgICAgICB9CiAgICB9OwogICAgcmV0dXJuIEl0ZXJhdG9yT2JzZXJ2YWJsZTsKfShPYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkpOwpleHBvcnRzLkl0ZXJhdG9yT2JzZXJ2YWJsZSA9IEl0ZXJhdG9yT2JzZXJ2YWJsZTsKdmFyIFN0cmluZ0l0ZXJhdG9yID0gKGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhdG9yKHN0ciwgaWR4LCBsZW4pIHsKICAgICAgICBpZiAoaWR4ID09PSB2b2lkIDApIHsgaWR4ID0gMDsgfQogICAgICAgIGlmIChsZW4gPT09IHZvaWQgMCkgeyBsZW4gPSBzdHIubGVuZ3RoOyB9CiAgICAgICAgdGhpcy5zdHIgPSBzdHI7CiAgICAgICAgdGhpcy5pZHggPSBpZHg7CiAgICAgICAgdGhpcy5sZW4gPSBsZW47CiAgICB9CiAgICBTdHJpbmdJdGVyYXRvci5wcm90b3R5cGVbaXRlcmF0b3JfMS4kJGl0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzKTsgfTsKICAgIFN0cmluZ0l0ZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLmlkeCA8IHRoaXMubGVuID8gewogICAgICAgICAgICBkb25lOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWU6IHRoaXMuc3RyLmNoYXJBdCh0aGlzLmlkeCsrKQogICAgICAgIH0gOiB7CiAgICAgICAgICAgIGRvbmU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWQKICAgICAgICB9OwogICAgfTsKICAgIHJldHVybiBTdHJpbmdJdGVyYXRvcjsKfSgpKTsKdmFyIEFycmF5SXRlcmF0b3IgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gQXJyYXlJdGVyYXRvcihhcnIsIGlkeCwgbGVuKSB7CiAgICAgICAgaWYgKGlkeCA9PT0gdm9pZCAwKSB7IGlkeCA9IDA7IH0KICAgICAgICBpZiAobGVuID09PSB2b2lkIDApIHsgbGVuID0gdG9MZW5ndGgoYXJyKTsgfQogICAgICAgIHRoaXMuYXJyID0gYXJyOwogICAgICAgIHRoaXMuaWR4ID0gaWR4OwogICAgICAgIHRoaXMubGVuID0gbGVuOwogICAgfQogICAgQXJyYXlJdGVyYXRvci5wcm90b3R5cGVbaXRlcmF0b3JfMS4kJGl0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH07CiAgICBBcnJheUl0ZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLmlkeCA8IHRoaXMubGVuID8gewogICAgICAgICAgICBkb25lOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWU6IHRoaXMuYXJyW3RoaXMuaWR4KytdCiAgICAgICAgfSA6IHsKICAgICAgICAgICAgZG9uZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZAogICAgICAgIH07CiAgICB9OwogICAgcmV0dXJuIEFycmF5SXRlcmF0b3I7Cn0oKSk7CmZ1bmN0aW9uIGdldEl0ZXJhdG9yKG9iaikgewogICAgdmFyIGkgPSBvYmpbaXRlcmF0b3JfMS4kJGl0ZXJhdG9yXTsKICAgIGlmICghaSAmJiB0eXBlb2Ygb2JqID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBuZXcgU3RyaW5nSXRlcmF0b3Iob2JqKTsKICAgIH0KICAgIGlmICghaSAmJiBvYmoubGVuZ3RoICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gbmV3IEFycmF5SXRlcmF0b3Iob2JqKTsKICAgIH0KICAgIGlmICghaSkgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ29iamVjdCBpcyBub3QgaXRlcmFibGUnKTsKICAgIH0KICAgIHJldHVybiBvYmpbaXRlcmF0b3JfMS4kJGl0ZXJhdG9yXSgpOwp9CnZhciBtYXhTYWZlSW50ZWdlciA9IE1hdGgucG93KDIsIDUzKSAtIDE7CmZ1bmN0aW9uIHRvTGVuZ3RoKG8pIHsKICAgIHZhciBsZW4gPSArby5sZW5ndGg7CiAgICBpZiAoaXNOYU4obGVuKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgaWYgKGxlbiA9PT0gMCB8fCAhbnVtYmVySXNGaW5pdGUobGVuKSkgewogICAgICAgIHJldHVybiBsZW47CiAgICB9CiAgICBsZW4gPSBzaWduKGxlbikgKiBNYXRoLmZsb29yKE1hdGguYWJzKGxlbikpOwogICAgaWYgKGxlbiA8PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICBpZiAobGVuID4gbWF4U2FmZUludGVnZXIpIHsKICAgICAgICByZXR1cm4gbWF4U2FmZUludGVnZXI7CiAgICB9CiAgICByZXR1cm4gbGVuOwp9CmZ1bmN0aW9uIG51bWJlcklzRmluaXRlKHZhbHVlKSB7CiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiByb290XzEucm9vdC5pc0Zpbml0ZSh2YWx1ZSk7Cn0KZnVuY3Rpb24gc2lnbih2YWx1ZSkgewogICAgdmFyIHZhbHVlQXNOdW1iZXIgPSArdmFsdWU7CiAgICBpZiAodmFsdWVBc051bWJlciA9PT0gMCkgewogICAgICAgIHJldHVybiB2YWx1ZUFzTnVtYmVyOwogICAgfQogICAgaWYgKGlzTmFOKHZhbHVlQXNOdW1iZXIpKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlQXNOdW1iZXI7CiAgICB9CiAgICByZXR1cm4gdmFsdWVBc051bWJlciA8IDAgPyAtMSA6IDE7Cn0KLy8jIHNvdXJjZU1hcHBpbmdVUkw9SXRlcmF0b3JPYnNlcnZhYmxlLmpzLm1hcAoKLyoqKi8gfSksCi8qIDYyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciByb290XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOwp2YXIgT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBleHRlbmRzIHtJZ25vcmVkfQogKiBAaGlkZSB0cnVlCiAqLwp2YXIgUHJvbWlzZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFByb21pc2VPYnNlcnZhYmxlLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gUHJvbWlzZU9ic2VydmFibGUocHJvbWlzZSwgc2NoZWR1bGVyKSB7CiAgICAgICAgX3N1cGVyLmNhbGwodGhpcyk7CiAgICAgICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydHMgYSBQcm9taXNlIHRvIGFuIE9ic2VydmFibGUuCiAgICAgKgogICAgICogPHNwYW4gY2xhc3M9ImluZm9ybWFsIj5SZXR1cm5zIGFuIE9ic2VydmFibGUgdGhhdCBqdXN0IGVtaXRzIHRoZSBQcm9taXNlJ3MKICAgICAqIHJlc29sdmVkIHZhbHVlLCB0aGVuIGNvbXBsZXRlcy48L3NwYW4+CiAgICAgKgogICAgICogQ29udmVydHMgYW4gRVMyMDE1IFByb21pc2Ugb3IgYSBQcm9taXNlcy9BKyBzcGVjIGNvbXBsaWFudCBQcm9taXNlIHRvIGFuCiAgICAgKiBPYnNlcnZhYmxlLiBJZiB0aGUgUHJvbWlzZSByZXNvbHZlcyB3aXRoIGEgdmFsdWUsIHRoZSBvdXRwdXQgT2JzZXJ2YWJsZQogICAgICogZW1pdHMgdGhhdCByZXNvbHZlZCB2YWx1ZSBhcyBhIGBuZXh0YCwgYW5kIHRoZW4gY29tcGxldGVzLiBJZiB0aGUgUHJvbWlzZQogICAgICogaXMgcmVqZWN0ZWQsIHRoZW4gdGhlIG91dHB1dCBPYnNlcnZhYmxlIGVtaXRzIHRoZSBjb3JyZXNwb25kaW5nIEVycm9yLgogICAgICoKICAgICAqIEBleGFtcGxlIDxjYXB0aW9uPkNvbnZlcnQgdGhlIFByb21pc2UgcmV0dXJuZWQgYnkgRmV0Y2ggdG8gYW4gT2JzZXJ2YWJsZTwvY2FwdGlvbj4KICAgICAqIHZhciByZXN1bHQgPSBSeC5PYnNlcnZhYmxlLmZyb21Qcm9taXNlKGZldGNoKCdodHRwOi8vbXlzZXJ2ZXIuY29tLycpKTsKICAgICAqIHJlc3VsdC5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSwgZSA9PiBjb25zb2xlLmVycm9yKGUpKTsKICAgICAqCiAgICAgKiBAc2VlIHtAbGluayBiaW5kQ2FsbGJhY2t9CiAgICAgKiBAc2VlIHtAbGluayBmcm9tfQogICAgICoKICAgICAqIEBwYXJhbSB7UHJvbWlzZTxUPn0gcHJvbWlzZSBUaGUgcHJvbWlzZSB0byBiZSBjb252ZXJ0ZWQuCiAgICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gQW4gb3B0aW9uYWwgSVNjaGVkdWxlciB0byB1c2UgZm9yIHNjaGVkdWxpbmcKICAgICAqIHRoZSBkZWxpdmVyeSBvZiB0aGUgcmVzb2x2ZWQgdmFsdWUgKG9yIHRoZSByZWplY3Rpb24pLgogICAgICogQHJldHVybiB7T2JzZXJ2YWJsZTxUPn0gQW4gT2JzZXJ2YWJsZSB3aGljaCB3cmFwcyB0aGUgUHJvbWlzZS4KICAgICAqIEBzdGF0aWMgdHJ1ZQogICAgICogQG5hbWUgZnJvbVByb21pc2UKICAgICAqIEBvd25lciBPYnNlcnZhYmxlCiAgICAgKi8KICAgIFByb21pc2VPYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChwcm9taXNlLCBzY2hlZHVsZXIpIHsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2VPYnNlcnZhYmxlKHByb21pc2UsIHNjaGVkdWxlcik7CiAgICB9OwogICAgUHJvbWlzZU9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7CiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyOwogICAgICAgIGlmIChzY2hlZHVsZXIgPT0gbnVsbCkgewogICAgICAgICAgICBpZiAodGhpcy5faXNTY2FsYXIpIHsKICAgICAgICAgICAgICAgIGlmICghc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQodGhpcy52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzLnZhbHVlID0gdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2lzU2NhbGFyID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBpZiAoIXN1YnNjcmliZXIuY2xvc2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dCh2YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdWJzY3JpYmVyLmNsb3NlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGVycik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAudGhlbihudWxsLCBmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gZXNjYXBlIHRoZSBwcm9taXNlIHRyYXAsIHRocm93IHVuaGFuZGxlZCBlcnJvcnMKICAgICAgICAgICAgICAgICAgICByb290XzEucm9vdC5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgdGhyb3cgZXJyOyB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZiAodGhpcy5faXNTY2FsYXIpIHsKICAgICAgICAgICAgICAgIGlmICghc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoTmV4dCwgMCwgeyB2YWx1ZTogdGhpcy52YWx1ZSwgc3Vic2NyaWJlcjogc3Vic2NyaWJlciB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgICAgICAgICAgICAgICAgIF90aGlzLl9pc1NjYWxhciA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdWJzY3JpYmVyLmNsb3NlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoZGlzcGF0Y2hOZXh0LCAwLCB7IHZhbHVlOiB2YWx1ZSwgc3Vic2NyaWJlcjogc3Vic2NyaWJlciB9KSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgICAgICAgIGlmICghc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoRXJyb3IsIDAsIHsgZXJyOiBlcnIsIHN1YnNjcmliZXI6IHN1YnNjcmliZXIgfSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLnRoZW4obnVsbCwgZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgICAgICAgIC8vIGVzY2FwZSB0aGUgcHJvbWlzZSB0cmFwLCB0aHJvdyB1bmhhbmRsZWQgZXJyb3JzCiAgICAgICAgICAgICAgICAgICAgcm9vdF8xLnJvb3Quc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHRocm93IGVycjsgfSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CiAgICByZXR1cm4gUHJvbWlzZU9ic2VydmFibGU7Cn0oT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpKTsKZXhwb3J0cy5Qcm9taXNlT2JzZXJ2YWJsZSA9IFByb21pc2VPYnNlcnZhYmxlOwpmdW5jdGlvbiBkaXNwYXRjaE5leHQoYXJnKSB7CiAgICB2YXIgdmFsdWUgPSBhcmcudmFsdWUsIHN1YnNjcmliZXIgPSBhcmcuc3Vic2NyaWJlcjsKICAgIGlmICghc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpOwogICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgIH0KfQpmdW5jdGlvbiBkaXNwYXRjaEVycm9yKGFyZykgewogICAgdmFyIGVyciA9IGFyZy5lcnIsIHN1YnNjcmliZXIgPSBhcmcuc3Vic2NyaWJlcjsKICAgIGlmICghc3Vic2NyaWJlci5jbG9zZWQpIHsKICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGVycik7CiAgICB9Cn0KLy8jIHNvdXJjZU1hcHBpbmdVUkw9UHJvbWlzZU9ic2VydmFibGUuanMubWFwCgovKioqLyB9KSwKLyogNjMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIEZvcmtKb2luT2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OCk7CmV4cG9ydHMuZm9ya0pvaW4gPSBGb3JrSm9pbk9ic2VydmFibGVfMS5Gb3JrSm9pbk9ic2VydmFibGUuY3JlYXRlOwovLyMgc291cmNlTWFwcGluZ1VSTD1mb3JrSm9pbi5qcy5tYXAKCi8qKiovIH0pLAovKiA2NCAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgRnJvbU9ic2VydmFibGVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNjApOwpleHBvcnRzLmZyb20gPSBGcm9tT2JzZXJ2YWJsZV8xLkZyb21PYnNlcnZhYmxlLmNyZWF0ZTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJvbS5qcy5tYXAKCi8qKiovIH0pLAovKiA2NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgRnJvbUV2ZW50T2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1OSk7CmV4cG9ydHMuZnJvbUV2ZW50ID0gRnJvbUV2ZW50T2JzZXJ2YWJsZV8xLkZyb21FdmVudE9ic2VydmFibGUuY3JlYXRlOwovLyMgc291cmNlTWFwcGluZ1VSTD1mcm9tRXZlbnQuanMubWFwCgovKioqLyB9KSwKLyogNjYgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIEFycmF5T2JzZXJ2YWJsZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7CmV4cG9ydHMub2YgPSBBcnJheU9ic2VydmFibGVfMS5BcnJheU9ic2VydmFibGUub2Y7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPW9mLmpzLm1hcAoKLyoqKi8gfSksCi8qIDY3ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciBTdWJzY3JpYmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpOwp2YXIgYXN5bmNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7Ci8qKgogKiBFbWl0cyBhIHZhbHVlIGZyb20gdGhlIHNvdXJjZSBPYnNlcnZhYmxlIG9ubHkgYWZ0ZXIgYSBwYXJ0aWN1bGFyIHRpbWUgc3BhbgogKiBoYXMgcGFzc2VkIHdpdGhvdXQgYW5vdGhlciBzb3VyY2UgZW1pc3Npb24uCiAqCiAqIDxzcGFuIGNsYXNzPSJpbmZvcm1hbCI+SXQncyBsaWtlIHtAbGluayBkZWxheX0sIGJ1dCBwYXNzZXMgb25seSB0aGUgbW9zdAogKiByZWNlbnQgdmFsdWUgZnJvbSBlYWNoIGJ1cnN0IG9mIGVtaXNzaW9ucy48L3NwYW4+CiAqCiAqIDxpbWcgc3JjPSIuL2ltZy9kZWJvdW5jZVRpbWUucG5nIiB3aWR0aD0iMTAwJSI+CiAqCiAqIGBkZWJvdW5jZVRpbWVgIGRlbGF5cyB2YWx1ZXMgZW1pdHRlZCBieSB0aGUgc291cmNlIE9ic2VydmFibGUsIGJ1dCBkcm9wcwogKiBwcmV2aW91cyBwZW5kaW5nIGRlbGF5ZWQgZW1pc3Npb25zIGlmIGEgbmV3IHZhbHVlIGFycml2ZXMgb24gdGhlIHNvdXJjZQogKiBPYnNlcnZhYmxlLiBUaGlzIG9wZXJhdG9yIGtlZXBzIHRyYWNrIG9mIHRoZSBtb3N0IHJlY2VudCB2YWx1ZSBmcm9tIHRoZQogKiBzb3VyY2UgT2JzZXJ2YWJsZSwgYW5kIGVtaXRzIHRoYXQgb25seSB3aGVuIGBkdWVUaW1lYCBlbm91Z2ggdGltZSBoYXMgcGFzc2VkCiAqIHdpdGhvdXQgYW55IG90aGVyIHZhbHVlIGFwcGVhcmluZyBvbiB0aGUgc291cmNlIE9ic2VydmFibGUuIElmIGEgbmV3IHZhbHVlCiAqIGFwcGVhcnMgYmVmb3JlIGBkdWVUaW1lYCBzaWxlbmNlIG9jY3VycywgdGhlIHByZXZpb3VzIHZhbHVlIHdpbGwgYmUgZHJvcHBlZAogKiBhbmQgd2lsbCBub3QgYmUgZW1pdHRlZCBvbiB0aGUgb3V0cHV0IE9ic2VydmFibGUuCiAqCiAqIFRoaXMgaXMgYSByYXRlLWxpbWl0aW5nIG9wZXJhdG9yLCBiZWNhdXNlIGl0IGlzIGltcG9zc2libGUgZm9yIG1vcmUgdGhhbiBvbmUKICogdmFsdWUgdG8gYmUgZW1pdHRlZCBpbiBhbnkgdGltZSB3aW5kb3cgb2YgZHVyYXRpb24gYGR1ZVRpbWVgLCBidXQgaXQgaXMgYWxzbwogKiBhIGRlbGF5LWxpa2Ugb3BlcmF0b3Igc2luY2Ugb3V0cHV0IGVtaXNzaW9ucyBkbyBub3Qgb2NjdXIgYXQgdGhlIHNhbWUgdGltZSBhcwogKiB0aGV5IGRpZCBvbiB0aGUgc291cmNlIE9ic2VydmFibGUuIE9wdGlvbmFsbHkgdGFrZXMgYSB7QGxpbmsgSVNjaGVkdWxlcn0gZm9yCiAqIG1hbmFnaW5nIHRpbWVycy4KICoKICogQGV4YW1wbGUgPGNhcHRpb24+RW1pdCB0aGUgbW9zdCByZWNlbnQgY2xpY2sgYWZ0ZXIgYSBidXJzdCBvZiBjbGlja3M8L2NhcHRpb24+CiAqIHZhciBjbGlja3MgPSBSeC5PYnNlcnZhYmxlLmZyb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJyk7CiAqIHZhciByZXN1bHQgPSBjbGlja3MuZGVib3VuY2VUaW1lKDEwMDApOwogKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpOwogKgogKiBAc2VlIHtAbGluayBhdWRpdFRpbWV9CiAqIEBzZWUge0BsaW5rIGRlYm91bmNlfQogKiBAc2VlIHtAbGluayBkZWxheX0KICogQHNlZSB7QGxpbmsgc2FtcGxlVGltZX0KICogQHNlZSB7QGxpbmsgdGhyb3R0bGVUaW1lfQogKgogKiBAcGFyYW0ge251bWJlcn0gZHVlVGltZSBUaGUgdGltZW91dCBkdXJhdGlvbiBpbiBtaWxsaXNlY29uZHMgKG9yIHRoZSB0aW1lCiAqIHVuaXQgZGV0ZXJtaW5lZCBpbnRlcm5hbGx5IGJ5IHRoZSBvcHRpb25hbCBgc2NoZWR1bGVyYCkgZm9yIHRoZSB3aW5kb3cgb2YKICogdGltZSByZXF1aXJlZCB0byB3YWl0IGZvciBlbWlzc2lvbiBzaWxlbmNlIGJlZm9yZSBlbWl0dGluZyB0aGUgbW9zdCByZWNlbnQKICogc291cmNlIHZhbHVlLgogKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcj1hc3luY10gVGhlIHtAbGluayBJU2NoZWR1bGVyfSB0byB1c2UgZm9yCiAqIG1hbmFnaW5nIHRoZSB0aW1lcnMgdGhhdCBoYW5kbGUgdGhlIHRpbWVvdXQgZm9yIGVhY2ggdmFsdWUuCiAqIEByZXR1cm4ge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgdGhhdCBkZWxheXMgdGhlIGVtaXNzaW9ucyBvZiB0aGUgc291cmNlCiAqIE9ic2VydmFibGUgYnkgdGhlIHNwZWNpZmllZCBgZHVlVGltZWAsIGFuZCBtYXkgZHJvcCBzb21lIHZhbHVlcyBpZiB0aGV5IG9jY3VyCiAqIHRvbyBmcmVxdWVudGx5LgogKiBAbWV0aG9kIGRlYm91bmNlVGltZQogKiBAb3duZXIgT2JzZXJ2YWJsZQogKi8KZnVuY3Rpb24gZGVib3VuY2VUaW1lKGR1ZVRpbWUsIHNjaGVkdWxlcikgewogICAgaWYgKHNjaGVkdWxlciA9PT0gdm9pZCAwKSB7IHNjaGVkdWxlciA9IGFzeW5jXzEuYXN5bmM7IH0KICAgIHJldHVybiB0aGlzLmxpZnQobmV3IERlYm91bmNlVGltZU9wZXJhdG9yKGR1ZVRpbWUsIHNjaGVkdWxlcikpOwp9CmV4cG9ydHMuZGVib3VuY2VUaW1lID0gZGVib3VuY2VUaW1lOwp2YXIgRGVib3VuY2VUaW1lT3BlcmF0b3IgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gRGVib3VuY2VUaW1lT3BlcmF0b3IoZHVlVGltZSwgc2NoZWR1bGVyKSB7CiAgICAgICAgdGhpcy5kdWVUaW1lID0gZHVlVGltZTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgIH0KICAgIERlYm91bmNlVGltZU9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkgewogICAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBEZWJvdW5jZVRpbWVTdWJzY3JpYmVyKHN1YnNjcmliZXIsIHRoaXMuZHVlVGltZSwgdGhpcy5zY2hlZHVsZXIpKTsKICAgIH07CiAgICByZXR1cm4gRGVib3VuY2VUaW1lT3BlcmF0b3I7Cn0oKSk7Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAaWdub3JlCiAqIEBleHRlbmRzIHtJZ25vcmVkfQogKi8KdmFyIERlYm91bmNlVGltZVN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKERlYm91bmNlVGltZVN1YnNjcmliZXIsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBEZWJvdW5jZVRpbWVTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBkdWVUaW1lLCBzY2hlZHVsZXIpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbik7CiAgICAgICAgdGhpcy5kdWVUaW1lID0gZHVlVGltZTsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgICAgICB0aGlzLmRlYm91bmNlZFN1YnNjcmlwdGlvbiA9IG51bGw7CiAgICAgICAgdGhpcy5sYXN0VmFsdWUgPSBudWxsOwogICAgICAgIHRoaXMuaGFzVmFsdWUgPSBmYWxzZTsKICAgIH0KICAgIERlYm91bmNlVGltZVN1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdGhpcy5jbGVhckRlYm91bmNlKCk7CiAgICAgICAgdGhpcy5sYXN0VmFsdWUgPSB2YWx1ZTsKICAgICAgICB0aGlzLmhhc1ZhbHVlID0gdHJ1ZTsKICAgICAgICB0aGlzLmFkZCh0aGlzLmRlYm91bmNlZFN1YnNjcmlwdGlvbiA9IHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoTmV4dCwgdGhpcy5kdWVUaW1lLCB0aGlzKSk7CiAgICB9OwogICAgRGVib3VuY2VUaW1lU3Vic2NyaWJlci5wcm90b3R5cGUuX2NvbXBsZXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMuZGVib3VuY2VkTmV4dCgpOwogICAgICAgIHRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKTsKICAgIH07CiAgICBEZWJvdW5jZVRpbWVTdWJzY3JpYmVyLnByb3RvdHlwZS5kZWJvdW5jZWROZXh0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMuY2xlYXJEZWJvdW5jZSgpOwogICAgICAgIGlmICh0aGlzLmhhc1ZhbHVlKSB7CiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24ubmV4dCh0aGlzLmxhc3RWYWx1ZSk7CiAgICAgICAgICAgIHRoaXMubGFzdFZhbHVlID0gbnVsbDsKICAgICAgICAgICAgdGhpcy5oYXNWYWx1ZSA9IGZhbHNlOwogICAgICAgIH0KICAgIH07CiAgICBEZWJvdW5jZVRpbWVTdWJzY3JpYmVyLnByb3RvdHlwZS5jbGVhckRlYm91bmNlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBkZWJvdW5jZWRTdWJzY3JpcHRpb24gPSB0aGlzLmRlYm91bmNlZFN1YnNjcmlwdGlvbjsKICAgICAgICBpZiAoZGVib3VuY2VkU3Vic2NyaXB0aW9uICE9PSBudWxsKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGRlYm91bmNlZFN1YnNjcmlwdGlvbik7CiAgICAgICAgICAgIGRlYm91bmNlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpOwogICAgICAgICAgICB0aGlzLmRlYm91bmNlZFN1YnNjcmlwdGlvbiA9IG51bGw7CiAgICAgICAgfQogICAgfTsKICAgIHJldHVybiBEZWJvdW5jZVRpbWVTdWJzY3JpYmVyOwp9KFN1YnNjcmliZXJfMS5TdWJzY3JpYmVyKSk7CmZ1bmN0aW9uIGRpc3BhdGNoTmV4dChzdWJzY3JpYmVyKSB7CiAgICBzdWJzY3JpYmVyLmRlYm91bmNlZE5leHQoKTsKfQovLyMgc291cmNlTWFwcGluZ1VSTD1kZWJvdW5jZVRpbWUuanMubWFwCgovKioqLyB9KSwKLyogNjggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIGFzeW5jXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpOwp2YXIgaXNEYXRlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKTsKdmFyIFN1YnNjcmliZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7CnZhciBOb3RpZmljYXRpb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpOwovKioKICogRGVsYXlzIHRoZSBlbWlzc2lvbiBvZiBpdGVtcyBmcm9tIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSBieSBhIGdpdmVuIHRpbWVvdXQgb3IKICogdW50aWwgYSBnaXZlbiBEYXRlLgogKgogKiA8c3BhbiBjbGFzcz0iaW5mb3JtYWwiPlRpbWUgc2hpZnRzIGVhY2ggaXRlbSBieSBzb21lIHNwZWNpZmllZCBhbW91bnQgb2YKICogbWlsbGlzZWNvbmRzLjwvc3Bhbj4KICoKICogPGltZyBzcmM9Ii4vaW1nL2RlbGF5LnBuZyIgd2lkdGg9IjEwMCUiPgogKgogKiBJZiB0aGUgZGVsYXkgYXJndW1lbnQgaXMgYSBOdW1iZXIsIHRoaXMgb3BlcmF0b3IgdGltZSBzaGlmdHMgdGhlIHNvdXJjZQogKiBPYnNlcnZhYmxlIGJ5IHRoYXQgYW1vdW50IG9mIHRpbWUgZXhwcmVzc2VkIGluIG1pbGxpc2Vjb25kcy4gVGhlIHJlbGF0aXZlCiAqIHRpbWUgaW50ZXJ2YWxzIGJldHdlZW4gdGhlIHZhbHVlcyBhcmUgcHJlc2VydmVkLgogKgogKiBJZiB0aGUgZGVsYXkgYXJndW1lbnQgaXMgYSBEYXRlLCB0aGlzIG9wZXJhdG9yIHRpbWUgc2hpZnRzIHRoZSBzdGFydCBvZiB0aGUKICogT2JzZXJ2YWJsZSBleGVjdXRpb24gdW50aWwgdGhlIGdpdmVuIGRhdGUgb2NjdXJzLgogKgogKiBAZXhhbXBsZSA8Y2FwdGlvbj5EZWxheSBlYWNoIGNsaWNrIGJ5IG9uZSBzZWNvbmQ8L2NhcHRpb24+CiAqIHZhciBjbGlja3MgPSBSeC5PYnNlcnZhYmxlLmZyb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJyk7CiAqIHZhciBkZWxheWVkQ2xpY2tzID0gY2xpY2tzLmRlbGF5KDEwMDApOyAvLyBlYWNoIGNsaWNrIGVtaXR0ZWQgYWZ0ZXIgMSBzZWNvbmQKICogZGVsYXllZENsaWNrcy5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSk7CiAqCiAqIEBleGFtcGxlIDxjYXB0aW9uPkRlbGF5IGFsbCBjbGlja3MgdW50aWwgYSBmdXR1cmUgZGF0ZSBoYXBwZW5zPC9jYXB0aW9uPgogKiB2YXIgY2xpY2tzID0gUnguT2JzZXJ2YWJsZS5mcm9tRXZlbnQoZG9jdW1lbnQsICdjbGljaycpOwogKiB2YXIgZGF0ZSA9IG5ldyBEYXRlKCdNYXJjaCAxNSwgMjA1MCAxMjowMDowMCcpOyAvLyBpbiB0aGUgZnV0dXJlCiAqIHZhciBkZWxheWVkQ2xpY2tzID0gY2xpY2tzLmRlbGF5KGRhdGUpOyAvLyBjbGljayBlbWl0dGVkIG9ubHkgYWZ0ZXIgdGhhdCBkYXRlCiAqIGRlbGF5ZWRDbGlja3Muc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpOwogKgogKiBAc2VlIHtAbGluayBkZWJvdW5jZVRpbWV9CiAqIEBzZWUge0BsaW5rIGRlbGF5V2hlbn0KICoKICogQHBhcmFtIHtudW1iZXJ8RGF0ZX0gZGVsYXkgVGhlIGRlbGF5IGR1cmF0aW9uIGluIG1pbGxpc2Vjb25kcyAoYSBgbnVtYmVyYCkgb3IKICogYSBgRGF0ZWAgdW50aWwgd2hpY2ggdGhlIGVtaXNzaW9uIG9mIHRoZSBzb3VyY2UgaXRlbXMgaXMgZGVsYXllZC4KICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXI9YXN5bmNdIFRoZSBJU2NoZWR1bGVyIHRvIHVzZSBmb3IKICogbWFuYWdpbmcgdGhlIHRpbWVycyB0aGF0IGhhbmRsZSB0aGUgdGltZS1zaGlmdCBmb3IgZWFjaCBpdGVtLgogKiBAcmV0dXJuIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHRoYXQgZGVsYXlzIHRoZSBlbWlzc2lvbnMgb2YgdGhlIHNvdXJjZQogKiBPYnNlcnZhYmxlIGJ5IHRoZSBzcGVjaWZpZWQgdGltZW91dCBvciBEYXRlLgogKiBAbWV0aG9kIGRlbGF5CiAqIEBvd25lciBPYnNlcnZhYmxlCiAqLwpmdW5jdGlvbiBkZWxheShkZWxheSwgc2NoZWR1bGVyKSB7CiAgICBpZiAoc2NoZWR1bGVyID09PSB2b2lkIDApIHsgc2NoZWR1bGVyID0gYXN5bmNfMS5hc3luYzsgfQogICAgdmFyIGFic29sdXRlRGVsYXkgPSBpc0RhdGVfMS5pc0RhdGUoZGVsYXkpOwogICAgdmFyIGRlbGF5Rm9yID0gYWJzb2x1dGVEZWxheSA/ICgrZGVsYXkgLSBzY2hlZHVsZXIubm93KCkpIDogTWF0aC5hYnMoZGVsYXkpOwogICAgcmV0dXJuIHRoaXMubGlmdChuZXcgRGVsYXlPcGVyYXRvcihkZWxheUZvciwgc2NoZWR1bGVyKSk7Cn0KZXhwb3J0cy5kZWxheSA9IGRlbGF5Owp2YXIgRGVsYXlPcGVyYXRvciA9IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBEZWxheU9wZXJhdG9yKGRlbGF5LCBzY2hlZHVsZXIpIHsKICAgICAgICB0aGlzLmRlbGF5ID0gZGVsYXk7CiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICB9CiAgICBEZWxheU9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkgewogICAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBEZWxheVN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5kZWxheSwgdGhpcy5zY2hlZHVsZXIpKTsKICAgIH07CiAgICByZXR1cm4gRGVsYXlPcGVyYXRvcjsKfSgpKTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBpZ25vcmUKICogQGV4dGVuZHMge0lnbm9yZWR9CiAqLwp2YXIgRGVsYXlTdWJzY3JpYmVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhEZWxheVN1YnNjcmliZXIsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBEZWxheVN1YnNjcmliZXIoZGVzdGluYXRpb24sIGRlbGF5LCBzY2hlZHVsZXIpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbik7CiAgICAgICAgdGhpcy5kZWxheSA9IGRlbGF5OwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgICAgIHRoaXMucXVldWUgPSBbXTsKICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMuZXJyb3JlZCA9IGZhbHNlOwogICAgfQogICAgRGVsYXlTdWJzY3JpYmVyLmRpc3BhdGNoID0gZnVuY3Rpb24gKHN0YXRlKSB7CiAgICAgICAgdmFyIHNvdXJjZSA9IHN0YXRlLnNvdXJjZTsKICAgICAgICB2YXIgcXVldWUgPSBzb3VyY2UucXVldWU7CiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHN0YXRlLnNjaGVkdWxlcjsKICAgICAgICB2YXIgZGVzdGluYXRpb24gPSBzdGF0ZS5kZXN0aW5hdGlvbjsKICAgICAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCAmJiAocXVldWVbMF0udGltZSAtIHNjaGVkdWxlci5ub3coKSkgPD0gMCkgewogICAgICAgICAgICBxdWV1ZS5zaGlmdCgpLm5vdGlmaWNhdGlvbi5vYnNlcnZlKGRlc3RpbmF0aW9uKTsKICAgICAgICB9CiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdmFyIGRlbGF5XzEgPSBNYXRoLm1heCgwLCBxdWV1ZVswXS50aW1lIC0gc2NoZWR1bGVyLm5vdygpKTsKICAgICAgICAgICAgdGhpcy5zY2hlZHVsZShzdGF0ZSwgZGVsYXlfMSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBzb3VyY2UuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgfQogICAgfTsKICAgIERlbGF5U3Vic2NyaWJlci5wcm90b3R5cGUuX3NjaGVkdWxlID0gZnVuY3Rpb24gKHNjaGVkdWxlcikgewogICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTsKICAgICAgICB0aGlzLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoRGVsYXlTdWJzY3JpYmVyLmRpc3BhdGNoLCB0aGlzLmRlbGF5LCB7CiAgICAgICAgICAgIHNvdXJjZTogdGhpcywgZGVzdGluYXRpb246IHRoaXMuZGVzdGluYXRpb24sIHNjaGVkdWxlcjogc2NoZWR1bGVyCiAgICAgICAgfSkpOwogICAgfTsKICAgIERlbGF5U3Vic2NyaWJlci5wcm90b3R5cGUuc2NoZWR1bGVOb3RpZmljYXRpb24gPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7CiAgICAgICAgaWYgKHRoaXMuZXJyb3JlZCA9PT0gdHJ1ZSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciBzY2hlZHVsZXIgPSB0aGlzLnNjaGVkdWxlcjsKICAgICAgICB2YXIgbWVzc2FnZSA9IG5ldyBEZWxheU1lc3NhZ2Uoc2NoZWR1bGVyLm5vdygpICsgdGhpcy5kZWxheSwgbm90aWZpY2F0aW9uKTsKICAgICAgICB0aGlzLnF1ZXVlLnB1c2gobWVzc2FnZSk7CiAgICAgICAgaWYgKHRoaXMuYWN0aXZlID09PSBmYWxzZSkgewogICAgICAgICAgICB0aGlzLl9zY2hlZHVsZShzY2hlZHVsZXIpOwogICAgICAgIH0KICAgIH07CiAgICBEZWxheVN1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdGhpcy5zY2hlZHVsZU5vdGlmaWNhdGlvbihOb3RpZmljYXRpb25fMS5Ob3RpZmljYXRpb24uY3JlYXRlTmV4dCh2YWx1ZSkpOwogICAgfTsKICAgIERlbGF5U3Vic2NyaWJlci5wcm90b3R5cGUuX2Vycm9yID0gZnVuY3Rpb24gKGVycikgewogICAgICAgIHRoaXMuZXJyb3JlZCA9IHRydWU7CiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdOwogICAgICAgIHRoaXMuZGVzdGluYXRpb24uZXJyb3IoZXJyKTsKICAgIH07CiAgICBEZWxheVN1YnNjcmliZXIucHJvdG90eXBlLl9jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLnNjaGVkdWxlTm90aWZpY2F0aW9uKE5vdGlmaWNhdGlvbl8xLk5vdGlmaWNhdGlvbi5jcmVhdGVDb21wbGV0ZSgpKTsKICAgIH07CiAgICByZXR1cm4gRGVsYXlTdWJzY3JpYmVyOwp9KFN1YnNjcmliZXJfMS5TdWJzY3JpYmVyKSk7CnZhciBEZWxheU1lc3NhZ2UgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gRGVsYXlNZXNzYWdlKHRpbWUsIG5vdGlmaWNhdGlvbikgewogICAgICAgIHRoaXMudGltZSA9IHRpbWU7CiAgICAgICAgdGhpcy5ub3RpZmljYXRpb24gPSBub3RpZmljYXRpb247CiAgICB9CiAgICByZXR1cm4gRGVsYXlNZXNzYWdlOwp9KCkpOwovLyMgc291cmNlTWFwcGluZ1VSTD1kZWxheS5qcy5tYXAKCi8qKiovIH0pLAovKiA2OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgU3Vic2NyaWJlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKLyogdHNsaW50OmVuYWJsZTptYXgtbGluZS1sZW5ndGggKi8KLyoqCiAqIFBlcmZvcm0gYSBzaWRlIGVmZmVjdCBmb3IgZXZlcnkgZW1pc3Npb24gb24gdGhlIHNvdXJjZSBPYnNlcnZhYmxlLCBidXQgcmV0dXJuCiAqIGFuIE9ic2VydmFibGUgdGhhdCBpcyBpZGVudGljYWwgdG8gdGhlIHNvdXJjZS4KICoKICogPHNwYW4gY2xhc3M9ImluZm9ybWFsIj5JbnRlcmNlcHRzIGVhY2ggZW1pc3Npb24gb24gdGhlIHNvdXJjZSBhbmQgcnVucyBhCiAqIGZ1bmN0aW9uLCBidXQgcmV0dXJucyBhbiBvdXRwdXQgd2hpY2ggaXMgaWRlbnRpY2FsIHRvIHRoZSBzb3VyY2UuPC9zcGFuPgogKgogKiA8aW1nIHNyYz0iLi9pbWcvZG8ucG5nIiB3aWR0aD0iMTAwJSI+CiAqCiAqIFJldHVybnMgYSBtaXJyb3JlZCBPYnNlcnZhYmxlIG9mIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSwgYnV0IG1vZGlmaWVkIHNvIHRoYXQKICogdGhlIHByb3ZpZGVkIE9ic2VydmVyIGlzIGNhbGxlZCB0byBwZXJmb3JtIGEgc2lkZSBlZmZlY3QgZm9yIGV2ZXJ5IHZhbHVlLAogKiBlcnJvciwgYW5kIGNvbXBsZXRpb24gZW1pdHRlZCBieSB0aGUgc291cmNlLiBBbnkgZXJyb3JzIHRoYXQgYXJlIHRocm93biBpbgogKiB0aGUgYWZvcmVtZW50aW9uZWQgT2JzZXJ2ZXIgb3IgaGFuZGxlcnMgYXJlIHNhZmVseSBzZW50IGRvd24gdGhlIGVycm9yIHBhdGgKICogb2YgdGhlIG91dHB1dCBPYnNlcnZhYmxlLgogKgogKiBUaGlzIG9wZXJhdG9yIGlzIHVzZWZ1bCBmb3IgZGVidWdnaW5nIHlvdXIgT2JzZXJ2YWJsZXMgZm9yIHRoZSBjb3JyZWN0IHZhbHVlcwogKiBvciBwZXJmb3JtaW5nIG90aGVyIHNpZGUgZWZmZWN0cy4KICoKICogTm90ZTogdGhpcyBpcyBkaWZmZXJlbnQgdG8gYSBgc3Vic2NyaWJlYCBvbiB0aGUgT2JzZXJ2YWJsZS4gSWYgdGhlIE9ic2VydmFibGUKICogcmV0dXJuZWQgYnkgYGRvYCBpcyBub3Qgc3Vic2NyaWJlZCwgdGhlIHNpZGUgZWZmZWN0cyBzcGVjaWZpZWQgYnkgdGhlCiAqIE9ic2VydmVyIHdpbGwgbmV2ZXIgaGFwcGVuLiBgZG9gIHRoZXJlZm9yZSBzaW1wbHkgc3BpZXMgb24gZXhpc3RpbmcKICogZXhlY3V0aW9uLCBpdCBkb2VzIG5vdCB0cmlnZ2VyIGFuIGV4ZWN1dGlvbiB0byBoYXBwZW4gbGlrZSBgc3Vic2NyaWJlYCBkb2VzLgogKgogKiBAZXhhbXBsZSA8Y2FwdGlvbj5NYXAgZXZlcnkgZXZlcnkgY2xpY2sgdG8gdGhlIGNsaWVudFggcG9zaXRpb24gb2YgdGhhdCBjbGljaywgd2hpbGUgYWxzbyBsb2dnaW5nIHRoZSBjbGljayBldmVudDwvY2FwdGlvbj4KICogdmFyIGNsaWNrcyA9IFJ4Lk9ic2VydmFibGUuZnJvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snKTsKICogdmFyIHBvc2l0aW9ucyA9IGNsaWNrcwogKiAgIC5kbyhldiA9PiBjb25zb2xlLmxvZyhldikpCiAqICAgLm1hcChldiA9PiBldi5jbGllbnRYKTsKICogcG9zaXRpb25zLnN1YnNjcmliZSh4ID0+IGNvbnNvbGUubG9nKHgpKTsKICoKICogQHNlZSB7QGxpbmsgbWFwfQogKiBAc2VlIHtAbGluayBzdWJzY3JpYmV9CiAqCiAqIEBwYXJhbSB7T2JzZXJ2ZXJ8ZnVuY3Rpb259IFtuZXh0T3JPYnNlcnZlcl0gQSBub3JtYWwgT2JzZXJ2ZXIgb2JqZWN0IG9yIGEKICogY2FsbGJhY2sgZm9yIGBuZXh0YC4KICogQHBhcmFtIHtmdW5jdGlvbn0gW2Vycm9yXSBDYWxsYmFjayBmb3IgZXJyb3JzIGluIHRoZSBzb3VyY2UuCiAqIEBwYXJhbSB7ZnVuY3Rpb259IFtjb21wbGV0ZV0gQ2FsbGJhY2sgZm9yIHRoZSBjb21wbGV0aW9uIG9mIHRoZSBzb3VyY2UuCiAqIEByZXR1cm4ge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgaWRlbnRpY2FsIHRvIHRoZSBzb3VyY2UsIGJ1dCBydW5zIHRoZQogKiBzcGVjaWZpZWQgT2JzZXJ2ZXIgb3IgY2FsbGJhY2socykgZm9yIGVhY2ggaXRlbS4KICogQG1ldGhvZCBkbwogKiBAbmFtZSBkbwogKiBAb3duZXIgT2JzZXJ2YWJsZQogKi8KZnVuY3Rpb24gX2RvKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGUpIHsKICAgIHJldHVybiB0aGlzLmxpZnQobmV3IERvT3BlcmF0b3IobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSkpOwp9CmV4cG9ydHMuX2RvID0gX2RvOwp2YXIgRG9PcGVyYXRvciA9IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBEb09wZXJhdG9yKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGUpIHsKICAgICAgICB0aGlzLm5leHRPck9ic2VydmVyID0gbmV4dE9yT2JzZXJ2ZXI7CiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yOwogICAgICAgIHRoaXMuY29tcGxldGUgPSBjb21wbGV0ZTsKICAgIH0KICAgIERvT3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoc3Vic2NyaWJlciwgc291cmNlKSB7CiAgICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IERvU3Vic2NyaWJlcihzdWJzY3JpYmVyLCB0aGlzLm5leHRPck9ic2VydmVyLCB0aGlzLmVycm9yLCB0aGlzLmNvbXBsZXRlKSk7CiAgICB9OwogICAgcmV0dXJuIERvT3BlcmF0b3I7Cn0oKSk7Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAaWdub3JlCiAqIEBleHRlbmRzIHtJZ25vcmVkfQogKi8KdmFyIERvU3Vic2NyaWJlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoRG9TdWJzY3JpYmVyLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gRG9TdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKSB7CiAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgZGVzdGluYXRpb24pOwogICAgICAgIHZhciBzYWZlU3Vic2NyaWJlciA9IG5ldyBTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcihuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKTsKICAgICAgICBzYWZlU3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUgPSB0cnVlOwogICAgICAgIHRoaXMuYWRkKHNhZmVTdWJzY3JpYmVyKTsKICAgICAgICB0aGlzLnNhZmVTdWJzY3JpYmVyID0gc2FmZVN1YnNjcmliZXI7CiAgICB9CiAgICBEb1N1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFyIHNhZmVTdWJzY3JpYmVyID0gdGhpcy5zYWZlU3Vic2NyaWJlcjsKICAgICAgICBzYWZlU3Vic2NyaWJlci5uZXh0KHZhbHVlKTsKICAgICAgICBpZiAoc2FmZVN1YnNjcmliZXIuc3luY0Vycm9yVGhyb3duKSB7CiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24uZXJyb3Ioc2FmZVN1YnNjcmliZXIuc3luY0Vycm9yVmFsdWUpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHZhbHVlKTsKICAgICAgICB9CiAgICB9OwogICAgRG9TdWJzY3JpYmVyLnByb3RvdHlwZS5fZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgdmFyIHNhZmVTdWJzY3JpYmVyID0gdGhpcy5zYWZlU3Vic2NyaWJlcjsKICAgICAgICBzYWZlU3Vic2NyaWJlci5lcnJvcihlcnIpOwogICAgICAgIGlmIChzYWZlU3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd24pIHsKICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihzYWZlU3Vic2NyaWJlci5zeW5jRXJyb3JWYWx1ZSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKGVycik7CiAgICAgICAgfQogICAgfTsKICAgIERvU3Vic2NyaWJlci5wcm90b3R5cGUuX2NvbXBsZXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzYWZlU3Vic2NyaWJlciA9IHRoaXMuc2FmZVN1YnNjcmliZXI7CiAgICAgICAgc2FmZVN1YnNjcmliZXIuY29tcGxldGUoKTsKICAgICAgICBpZiAoc2FmZVN1YnNjcmliZXIuc3luY0Vycm9yVGhyb3duKSB7CiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24uZXJyb3Ioc2FmZVN1YnNjcmliZXIuc3luY0Vycm9yVmFsdWUpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpOwogICAgICAgIH0KICAgIH07CiAgICByZXR1cm4gRG9TdWJzY3JpYmVyOwp9KFN1YnNjcmliZXJfMS5TdWJzY3JpYmVyKSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvLmpzLm1hcAoKLyoqKi8gfSksCi8qIDcwICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciBTdWJzY3JpYmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpOwovKiB0c2xpbnQ6ZW5hYmxlOm1heC1saW5lLWxlbmd0aCAqLwovKioKICogRmlsdGVyIGl0ZW1zIGVtaXR0ZWQgYnkgdGhlIHNvdXJjZSBPYnNlcnZhYmxlIGJ5IG9ubHkgZW1pdHRpbmcgdGhvc2UgdGhhdAogKiBzYXRpc2Z5IGEgc3BlY2lmaWVkIHByZWRpY2F0ZS4KICoKICogPHNwYW4gY2xhc3M9ImluZm9ybWFsIj5MaWtlCiAqIFtBcnJheS5wcm90b3R5cGUuZmlsdGVyKCldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L2ZpbHRlciksCiAqIGl0IG9ubHkgZW1pdHMgYSB2YWx1ZSBmcm9tIHRoZSBzb3VyY2UgaWYgaXQgcGFzc2VzIGEgY3JpdGVyaW9uIGZ1bmN0aW9uLjwvc3Bhbj4KICoKICogPGltZyBzcmM9Ii4vaW1nL2ZpbHRlci5wbmciIHdpZHRoPSIxMDAlIj4KICoKICogU2ltaWxhciB0byB0aGUgd2VsbC1rbm93biBgQXJyYXkucHJvdG90eXBlLmZpbHRlcmAgbWV0aG9kLCB0aGlzIG9wZXJhdG9yCiAqIHRha2VzIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSwgcGFzc2VzIHRoZW0gdGhyb3VnaCBhIGBwcmVkaWNhdGVgCiAqIGZ1bmN0aW9uIGFuZCBvbmx5IGVtaXRzIHRob3NlIHZhbHVlcyB0aGF0IHlpZWxkZWQgYHRydWVgLgogKgogKiBAZXhhbXBsZSA8Y2FwdGlvbj5FbWl0IG9ubHkgY2xpY2sgZXZlbnRzIHdob3NlIHRhcmdldCB3YXMgYSBESVYgZWxlbWVudDwvY2FwdGlvbj4KICogdmFyIGNsaWNrcyA9IFJ4Lk9ic2VydmFibGUuZnJvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snKTsKICogdmFyIGNsaWNrc09uRGl2cyA9IGNsaWNrcy5maWx0ZXIoZXYgPT4gZXYudGFyZ2V0LnRhZ05hbWUgPT09ICdESVYnKTsKICogY2xpY2tzT25EaXZzLnN1YnNjcmliZSh4ID0+IGNvbnNvbGUubG9nKHgpKTsKICoKICogQHNlZSB7QGxpbmsgZGlzdGluY3R9CiAqIEBzZWUge0BsaW5rIGRpc3RpbmN0VW50aWxDaGFuZ2VkfQogKiBAc2VlIHtAbGluayBkaXN0aW5jdFVudGlsS2V5Q2hhbmdlZH0KICogQHNlZSB7QGxpbmsgaWdub3JlRWxlbWVudHN9CiAqIEBzZWUge0BsaW5rIHBhcnRpdGlvbn0KICogQHNlZSB7QGxpbmsgc2tpcH0KICoKICogQHBhcmFtIHtmdW5jdGlvbih2YWx1ZTogVCwgaW5kZXg6IG51bWJlcik6IGJvb2xlYW59IHByZWRpY2F0ZSBBIGZ1bmN0aW9uIHRoYXQKICogZXZhbHVhdGVzIGVhY2ggdmFsdWUgZW1pdHRlZCBieSB0aGUgc291cmNlIE9ic2VydmFibGUuIElmIGl0IHJldHVybnMgYHRydWVgLAogKiB0aGUgdmFsdWUgaXMgZW1pdHRlZCwgaWYgYGZhbHNlYCB0aGUgdmFsdWUgaXMgbm90IHBhc3NlZCB0byB0aGUgb3V0cHV0CiAqIE9ic2VydmFibGUuIFRoZSBgaW5kZXhgIHBhcmFtZXRlciBpcyB0aGUgbnVtYmVyIGBpYCBmb3IgdGhlIGktdGggc291cmNlCiAqIGVtaXNzaW9uIHRoYXQgaGFzIGhhcHBlbmVkIHNpbmNlIHRoZSBzdWJzY3JpcHRpb24sIHN0YXJ0aW5nIGZyb20gdGhlIG51bWJlcgogKiBgMGAuCiAqIEBwYXJhbSB7YW55fSBbdGhpc0FyZ10gQW4gb3B0aW9uYWwgYXJndW1lbnQgdG8gZGV0ZXJtaW5lIHRoZSB2YWx1ZSBvZiBgdGhpc2AKICogaW4gdGhlIGBwcmVkaWNhdGVgIGZ1bmN0aW9uLgogKiBAcmV0dXJuIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIG9mIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2UgdGhhdCB3ZXJlCiAqIGFsbG93ZWQgYnkgdGhlIGBwcmVkaWNhdGVgIGZ1bmN0aW9uLgogKiBAbWV0aG9kIGZpbHRlcgogKiBAb3duZXIgT2JzZXJ2YWJsZQogKi8KZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSwgdGhpc0FyZykgewogICAgcmV0dXJuIHRoaXMubGlmdChuZXcgRmlsdGVyT3BlcmF0b3IocHJlZGljYXRlLCB0aGlzQXJnKSk7Cn0KZXhwb3J0cy5maWx0ZXIgPSBmaWx0ZXI7CnZhciBGaWx0ZXJPcGVyYXRvciA9IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBGaWx0ZXJPcGVyYXRvcihwcmVkaWNhdGUsIHRoaXNBcmcpIHsKICAgICAgICB0aGlzLnByZWRpY2F0ZSA9IHByZWRpY2F0ZTsKICAgICAgICB0aGlzLnRoaXNBcmcgPSB0aGlzQXJnOwogICAgfQogICAgRmlsdGVyT3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoc3Vic2NyaWJlciwgc291cmNlKSB7CiAgICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IEZpbHRlclN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5wcmVkaWNhdGUsIHRoaXMudGhpc0FyZykpOwogICAgfTsKICAgIHJldHVybiBGaWx0ZXJPcGVyYXRvcjsKfSgpKTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBpZ25vcmUKICogQGV4dGVuZHMge0lnbm9yZWR9CiAqLwp2YXIgRmlsdGVyU3Vic2NyaWJlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoRmlsdGVyU3Vic2NyaWJlciwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEZpbHRlclN1YnNjcmliZXIoZGVzdGluYXRpb24sIHByZWRpY2F0ZSwgdGhpc0FyZykgewogICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIGRlc3RpbmF0aW9uKTsKICAgICAgICB0aGlzLnByZWRpY2F0ZSA9IHByZWRpY2F0ZTsKICAgICAgICB0aGlzLnRoaXNBcmcgPSB0aGlzQXJnOwogICAgICAgIHRoaXMuY291bnQgPSAwOwogICAgICAgIHRoaXMucHJlZGljYXRlID0gcHJlZGljYXRlOwogICAgfQogICAgLy8gdGhlIHRyeSBjYXRjaCBibG9jayBiZWxvdyBpcyBsZWZ0IHNwZWNpZmljYWxseSBmb3IKICAgIC8vIG9wdGltaXphdGlvbiBhbmQgcGVyZiByZWFzb25zLiBhIHRyeUNhdGNoZXIgaXMgbm90IG5lY2Vzc2FyeSBoZXJlLgogICAgRmlsdGVyU3Vic2NyaWJlci5wcm90b3R5cGUuX25leHQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMucHJlZGljYXRlLmNhbGwodGhpcy50aGlzQXJnLCB2YWx1ZSwgdGhpcy5jb3VudCsrKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGVycikgewogICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKGVycik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQodmFsdWUpOwogICAgICAgIH0KICAgIH07CiAgICByZXR1cm4gRmlsdGVyU3Vic2NyaWJlcjsKfShTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcikpOwovLyMgc291cmNlTWFwcGluZ1VSTD1maWx0ZXIuanMubWFwCgovKioqLyB9KSwKLyogNzEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIFN1YnNjcmliZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7Ci8qKgogKiBBcHBsaWVzIGEgZ2l2ZW4gYHByb2plY3RgIGZ1bmN0aW9uIHRvIGVhY2ggdmFsdWUgZW1pdHRlZCBieSB0aGUgc291cmNlCiAqIE9ic2VydmFibGUsIGFuZCBlbWl0cyB0aGUgcmVzdWx0aW5nIHZhbHVlcyBhcyBhbiBPYnNlcnZhYmxlLgogKgogKiA8c3BhbiBjbGFzcz0iaW5mb3JtYWwiPkxpa2UgW0FycmF5LnByb3RvdHlwZS5tYXAoKV0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvbWFwKSwKICogaXQgcGFzc2VzIGVhY2ggc291cmNlIHZhbHVlIHRocm91Z2ggYSB0cmFuc2Zvcm1hdGlvbiBmdW5jdGlvbiB0byBnZXQKICogY29ycmVzcG9uZGluZyBvdXRwdXQgdmFsdWVzLjwvc3Bhbj4KICoKICogPGltZyBzcmM9Ii4vaW1nL21hcC5wbmciIHdpZHRoPSIxMDAlIj4KICoKICogU2ltaWxhciB0byB0aGUgd2VsbCBrbm93biBgQXJyYXkucHJvdG90eXBlLm1hcGAgZnVuY3Rpb24sIHRoaXMgb3BlcmF0b3IKICogYXBwbGllcyBhIHByb2plY3Rpb24gdG8gZWFjaCB2YWx1ZSBhbmQgZW1pdHMgdGhhdCBwcm9qZWN0aW9uIGluIHRoZSBvdXRwdXQKICogT2JzZXJ2YWJsZS4KICoKICogQGV4YW1wbGUgPGNhcHRpb24+TWFwIGV2ZXJ5IGV2ZXJ5IGNsaWNrIHRvIHRoZSBjbGllbnRYIHBvc2l0aW9uIG9mIHRoYXQgY2xpY2s8L2NhcHRpb24+CiAqIHZhciBjbGlja3MgPSBSeC5PYnNlcnZhYmxlLmZyb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJyk7CiAqIHZhciBwb3NpdGlvbnMgPSBjbGlja3MubWFwKGV2ID0+IGV2LmNsaWVudFgpOwogKiBwb3NpdGlvbnMuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpOwogKgogKiBAc2VlIHtAbGluayBtYXBUb30KICogQHNlZSB7QGxpbmsgcGx1Y2t9CiAqCiAqIEBwYXJhbSB7ZnVuY3Rpb24odmFsdWU6IFQsIGluZGV4OiBudW1iZXIpOiBSfSBwcm9qZWN0IFRoZSBmdW5jdGlvbiB0byBhcHBseQogKiB0byBlYWNoIGB2YWx1ZWAgZW1pdHRlZCBieSB0aGUgc291cmNlIE9ic2VydmFibGUuIFRoZSBgaW5kZXhgIHBhcmFtZXRlciBpcwogKiB0aGUgbnVtYmVyIGBpYCBmb3IgdGhlIGktdGggZW1pc3Npb24gdGhhdCBoYXMgaGFwcGVuZWQgc2luY2UgdGhlCiAqIHN1YnNjcmlwdGlvbiwgc3RhcnRpbmcgZnJvbSB0aGUgbnVtYmVyIGAwYC4KICogQHBhcmFtIHthbnl9IFt0aGlzQXJnXSBBbiBvcHRpb25hbCBhcmd1bWVudCB0byBkZWZpbmUgd2hhdCBgdGhpc2AgaXMgaW4gdGhlCiAqIGBwcm9qZWN0YCBmdW5jdGlvbi4KICogQHJldHVybiB7T2JzZXJ2YWJsZTxSPn0gQW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIHRoZSB2YWx1ZXMgZnJvbSB0aGUgc291cmNlCiAqIE9ic2VydmFibGUgdHJhbnNmb3JtZWQgYnkgdGhlIGdpdmVuIGBwcm9qZWN0YCBmdW5jdGlvbi4KICogQG1ldGhvZCBtYXAKICogQG93bmVyIE9ic2VydmFibGUKICovCmZ1bmN0aW9uIG1hcChwcm9qZWN0LCB0aGlzQXJnKSB7CiAgICBpZiAodHlwZW9mIHByb2plY3QgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdhcmd1bWVudCBpcyBub3QgYSBmdW5jdGlvbi4gQXJlIHlvdSBsb29raW5nIGZvciBgbWFwVG8oKWA/Jyk7CiAgICB9CiAgICByZXR1cm4gdGhpcy5saWZ0KG5ldyBNYXBPcGVyYXRvcihwcm9qZWN0LCB0aGlzQXJnKSk7Cn0KZXhwb3J0cy5tYXAgPSBtYXA7CnZhciBNYXBPcGVyYXRvciA9IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBNYXBPcGVyYXRvcihwcm9qZWN0LCB0aGlzQXJnKSB7CiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDsKICAgICAgICB0aGlzLnRoaXNBcmcgPSB0aGlzQXJnOwogICAgfQogICAgTWFwT3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoc3Vic2NyaWJlciwgc291cmNlKSB7CiAgICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IE1hcFN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5wcm9qZWN0LCB0aGlzLnRoaXNBcmcpKTsKICAgIH07CiAgICByZXR1cm4gTWFwT3BlcmF0b3I7Cn0oKSk7CmV4cG9ydHMuTWFwT3BlcmF0b3IgPSBNYXBPcGVyYXRvcjsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBpZ25vcmUKICogQGV4dGVuZHMge0lnbm9yZWR9CiAqLwp2YXIgTWFwU3Vic2NyaWJlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoTWFwU3Vic2NyaWJlciwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIE1hcFN1YnNjcmliZXIoZGVzdGluYXRpb24sIHByb2plY3QsIHRoaXNBcmcpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbik7CiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDsKICAgICAgICB0aGlzLmNvdW50ID0gMDsKICAgICAgICB0aGlzLnRoaXNBcmcgPSB0aGlzQXJnIHx8IHRoaXM7CiAgICB9CiAgICAvLyBOT1RFOiBUaGlzIGxvb2tzIHVub3B0aW1pemVkLCBidXQgaXQncyBhY3R1YWxseSBwdXJwb3NlZnVsbHkgTk9UCiAgICAvLyB1c2luZyB0cnkvY2F0Y2ggb3B0aW1pemF0aW9ucy4KICAgIE1hcFN1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXN1bHQgPSB0aGlzLnByb2plY3QuY2FsbCh0aGlzLnRoaXNBcmcsIHZhbHVlLCB0aGlzLmNvdW50KyspOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24uZXJyb3IoZXJyKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQocmVzdWx0KTsKICAgIH07CiAgICByZXR1cm4gTWFwU3Vic2NyaWJlcjsKfShTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcikpOwovLyMgc291cmNlTWFwcGluZ1VSTD1tYXAuanMubWFwCgovKioqLyB9KSwKLyogNzIgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIHN1YnNjcmliZVRvUmVzdWx0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTsKdmFyIE91dGVyU3Vic2NyaWJlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7Ci8qIHRzbGludDplbmFibGU6bWF4LWxpbmUtbGVuZ3RoICovCi8qKgogKiBQcm9qZWN0cyBlYWNoIHNvdXJjZSB2YWx1ZSB0byBhbiBPYnNlcnZhYmxlIHdoaWNoIGlzIG1lcmdlZCBpbiB0aGUgb3V0cHV0CiAqIE9ic2VydmFibGUuCiAqCiAqIDxzcGFuIGNsYXNzPSJpbmZvcm1hbCI+TWFwcyBlYWNoIHZhbHVlIHRvIGFuIE9ic2VydmFibGUsIHRoZW4gZmxhdHRlbnMgYWxsIG9mCiAqIHRoZXNlIGlubmVyIE9ic2VydmFibGVzIHVzaW5nIHtAbGluayBtZXJnZUFsbH0uPC9zcGFuPgogKgogKiA8aW1nIHNyYz0iLi9pbWcvbWVyZ2VNYXAucG5nIiB3aWR0aD0iMTAwJSI+CiAqCiAqIFJldHVybnMgYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIGl0ZW1zIGJhc2VkIG9uIGFwcGx5aW5nIGEgZnVuY3Rpb24gdGhhdCB5b3UKICogc3VwcGx5IHRvIGVhY2ggaXRlbSBlbWl0dGVkIGJ5IHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSwgd2hlcmUgdGhhdCBmdW5jdGlvbgogKiByZXR1cm5zIGFuIE9ic2VydmFibGUsIGFuZCB0aGVuIG1lcmdpbmcgdGhvc2UgcmVzdWx0aW5nIE9ic2VydmFibGVzIGFuZAogKiBlbWl0dGluZyB0aGUgcmVzdWx0cyBvZiB0aGlzIG1lcmdlci4KICoKICogQGV4YW1wbGUgPGNhcHRpb24+TWFwIGFuZCBmbGF0dGVuIGVhY2ggbGV0dGVyIHRvIGFuIE9ic2VydmFibGUgdGlja2luZyBldmVyeSAxIHNlY29uZDwvY2FwdGlvbj4KICogdmFyIGxldHRlcnMgPSBSeC5PYnNlcnZhYmxlLm9mKCdhJywgJ2InLCAnYycpOwogKiB2YXIgcmVzdWx0ID0gbGV0dGVycy5tZXJnZU1hcCh4ID0+CiAqICAgUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDAwKS5tYXAoaSA9PiB4K2kpCiAqICk7CiAqIHJlc3VsdC5zdWJzY3JpYmUoeCA9PiBjb25zb2xlLmxvZyh4KSk7CiAqCiAqIC8vIFJlc3VsdHMgaW4gdGhlIGZvbGxvd2luZzoKICogLy8gYTAKICogLy8gYjAKICogLy8gYzAKICogLy8gYTEKICogLy8gYjEKICogLy8gYzEKICogLy8gY29udGludWVzIHRvIGxpc3QgYSxiLGMgd2l0aCByZXNwZWN0aXZlIGFzY2VuZGluZyBpbnRlZ2VycwogKgogKiBAc2VlIHtAbGluayBjb25jYXRNYXB9CiAqIEBzZWUge0BsaW5rIGV4aGF1c3RNYXB9CiAqIEBzZWUge0BsaW5rIG1lcmdlfQogKiBAc2VlIHtAbGluayBtZXJnZUFsbH0KICogQHNlZSB7QGxpbmsgbWVyZ2VNYXBUb30KICogQHNlZSB7QGxpbmsgbWVyZ2VTY2FufQogKiBAc2VlIHtAbGluayBzd2l0Y2hNYXB9CiAqCiAqIEBwYXJhbSB7ZnVuY3Rpb24odmFsdWU6IFQsID9pbmRleDogbnVtYmVyKTogT2JzZXJ2YWJsZUlucHV0fSBwcm9qZWN0IEEgZnVuY3Rpb24KICogdGhhdCwgd2hlbiBhcHBsaWVkIHRvIGFuIGl0ZW0gZW1pdHRlZCBieSB0aGUgc291cmNlIE9ic2VydmFibGUsIHJldHVybnMgYW4KICogT2JzZXJ2YWJsZS4KICogQHBhcmFtIHtmdW5jdGlvbihvdXRlclZhbHVlOiBULCBpbm5lclZhbHVlOiBJLCBvdXRlckluZGV4OiBudW1iZXIsIGlubmVySW5kZXg6IG51bWJlcik6IGFueX0gW3Jlc3VsdFNlbGVjdG9yXQogKiBBIGZ1bmN0aW9uIHRvIHByb2R1Y2UgdGhlIHZhbHVlIG9uIHRoZSBvdXRwdXQgT2JzZXJ2YWJsZSBiYXNlZCBvbiB0aGUgdmFsdWVzCiAqIGFuZCB0aGUgaW5kaWNlcyBvZiB0aGUgc291cmNlIChvdXRlcikgZW1pc3Npb24gYW5kIHRoZSBpbm5lciBPYnNlcnZhYmxlCiAqIGVtaXNzaW9uLiBUaGUgYXJndW1lbnRzIHBhc3NlZCB0byB0aGlzIGZ1bmN0aW9uIGFyZToKICogLSBgb3V0ZXJWYWx1ZWA6IHRoZSB2YWx1ZSB0aGF0IGNhbWUgZnJvbSB0aGUgc291cmNlCiAqIC0gYGlubmVyVmFsdWVgOiB0aGUgdmFsdWUgdGhhdCBjYW1lIGZyb20gdGhlIHByb2plY3RlZCBPYnNlcnZhYmxlCiAqIC0gYG91dGVySW5kZXhgOiB0aGUgImluZGV4IiBvZiB0aGUgdmFsdWUgdGhhdCBjYW1lIGZyb20gdGhlIHNvdXJjZQogKiAtIGBpbm5lckluZGV4YDogdGhlICJpbmRleCIgb2YgdGhlIHZhbHVlIGZyb20gdGhlIHByb2plY3RlZCBPYnNlcnZhYmxlCiAqIEBwYXJhbSB7bnVtYmVyfSBbY29uY3VycmVudD1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFldIE1heGltdW0gbnVtYmVyIG9mIGlucHV0CiAqIE9ic2VydmFibGVzIGJlaW5nIHN1YnNjcmliZWQgdG8gY29uY3VycmVudGx5LgogKiBAcmV0dXJuIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgdGhlIHJlc3VsdCBvZiBhcHBseWluZyB0aGUKICogcHJvamVjdGlvbiBmdW5jdGlvbiAoYW5kIHRoZSBvcHRpb25hbCBgcmVzdWx0U2VsZWN0b3JgKSB0byBlYWNoIGl0ZW0gZW1pdHRlZAogKiBieSB0aGUgc291cmNlIE9ic2VydmFibGUgYW5kIG1lcmdpbmcgdGhlIHJlc3VsdHMgb2YgdGhlIE9ic2VydmFibGVzIG9idGFpbmVkCiAqIGZyb20gdGhpcyB0cmFuc2Zvcm1hdGlvbi4KICogQG1ldGhvZCBtZXJnZU1hcAogKiBAb3duZXIgT2JzZXJ2YWJsZQogKi8KZnVuY3Rpb24gbWVyZ2VNYXAocHJvamVjdCwgcmVzdWx0U2VsZWN0b3IsIGNvbmN1cnJlbnQpIHsKICAgIGlmIChjb25jdXJyZW50ID09PSB2b2lkIDApIHsgY29uY3VycmVudCA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTsgfQogICAgaWYgKHR5cGVvZiByZXN1bHRTZWxlY3RvciA9PT0gJ251bWJlcicpIHsKICAgICAgICBjb25jdXJyZW50ID0gcmVzdWx0U2VsZWN0b3I7CiAgICAgICAgcmVzdWx0U2VsZWN0b3IgPSBudWxsOwogICAgfQogICAgcmV0dXJuIHRoaXMubGlmdChuZXcgTWVyZ2VNYXBPcGVyYXRvcihwcm9qZWN0LCByZXN1bHRTZWxlY3RvciwgY29uY3VycmVudCkpOwp9CmV4cG9ydHMubWVyZ2VNYXAgPSBtZXJnZU1hcDsKdmFyIE1lcmdlTWFwT3BlcmF0b3IgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gTWVyZ2VNYXBPcGVyYXRvcihwcm9qZWN0LCByZXN1bHRTZWxlY3RvciwgY29uY3VycmVudCkgewogICAgICAgIGlmIChjb25jdXJyZW50ID09PSB2b2lkIDApIHsgY29uY3VycmVudCA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTsgfQogICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7CiAgICAgICAgdGhpcy5yZXN1bHRTZWxlY3RvciA9IHJlc3VsdFNlbGVjdG9yOwogICAgICAgIHRoaXMuY29uY3VycmVudCA9IGNvbmN1cnJlbnQ7CiAgICB9CiAgICBNZXJnZU1hcE9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKG9ic2VydmVyLCBzb3VyY2UpIHsKICAgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VNYXBTdWJzY3JpYmVyKG9ic2VydmVyLCB0aGlzLnByb2plY3QsIHRoaXMucmVzdWx0U2VsZWN0b3IsIHRoaXMuY29uY3VycmVudCkpOwogICAgfTsKICAgIHJldHVybiBNZXJnZU1hcE9wZXJhdG9yOwp9KCkpOwpleHBvcnRzLk1lcmdlTWFwT3BlcmF0b3IgPSBNZXJnZU1hcE9wZXJhdG9yOwovKioKICogV2UgbmVlZCB0aGlzIEpTRG9jIGNvbW1lbnQgZm9yIGFmZmVjdGluZyBFU0RvYy4KICogQGlnbm9yZQogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICovCnZhciBNZXJnZU1hcFN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKE1lcmdlTWFwU3Vic2NyaWJlciwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIE1lcmdlTWFwU3Vic2NyaWJlcihkZXN0aW5hdGlvbiwgcHJvamVjdCwgcmVzdWx0U2VsZWN0b3IsIGNvbmN1cnJlbnQpIHsKICAgICAgICBpZiAoY29uY3VycmVudCA9PT0gdm9pZCAwKSB7IGNvbmN1cnJlbnQgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7IH0KICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbik7CiAgICAgICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDsKICAgICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gcmVzdWx0U2VsZWN0b3I7CiAgICAgICAgdGhpcy5jb25jdXJyZW50ID0gY29uY3VycmVudDsKICAgICAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IGZhbHNlOwogICAgICAgIHRoaXMuYnVmZmVyID0gW107CiAgICAgICAgdGhpcy5hY3RpdmUgPSAwOwogICAgICAgIHRoaXMuaW5kZXggPSAwOwogICAgfQogICAgTWVyZ2VNYXBTdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIGlmICh0aGlzLmFjdGl2ZSA8IHRoaXMuY29uY3VycmVudCkgewogICAgICAgICAgICB0aGlzLl90cnlOZXh0KHZhbHVlKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHRoaXMuYnVmZmVyLnB1c2godmFsdWUpOwogICAgICAgIH0KICAgIH07CiAgICBNZXJnZU1hcFN1YnNjcmliZXIucHJvdG90eXBlLl90cnlOZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICB2YXIgaW5kZXggPSB0aGlzLmluZGV4Kys7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5wcm9qZWN0KHZhbHVlLCBpbmRleCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihlcnIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuYWN0aXZlKys7CiAgICAgICAgdGhpcy5faW5uZXJTdWIocmVzdWx0LCB2YWx1ZSwgaW5kZXgpOwogICAgfTsKICAgIE1lcmdlTWFwU3Vic2NyaWJlci5wcm90b3R5cGUuX2lubmVyU3ViID0gZnVuY3Rpb24gKGlzaCwgdmFsdWUsIGluZGV4KSB7CiAgICAgICAgdGhpcy5hZGQoc3Vic2NyaWJlVG9SZXN1bHRfMS5zdWJzY3JpYmVUb1Jlc3VsdCh0aGlzLCBpc2gsIHZhbHVlLCBpbmRleCkpOwogICAgfTsKICAgIE1lcmdlTWFwU3Vic2NyaWJlci5wcm90b3R5cGUuX2NvbXBsZXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMuaGFzQ29tcGxldGVkID0gdHJ1ZTsKICAgICAgICBpZiAodGhpcy5hY3RpdmUgPT09IDAgJiYgdGhpcy5idWZmZXIubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKTsKICAgICAgICB9CiAgICB9OwogICAgTWVyZ2VNYXBTdWJzY3JpYmVyLnByb3RvdHlwZS5ub3RpZnlOZXh0ID0gZnVuY3Rpb24gKG91dGVyVmFsdWUsIGlubmVyVmFsdWUsIG91dGVySW5kZXgsIGlubmVySW5kZXgsIGlubmVyU3ViKSB7CiAgICAgICAgaWYgKHRoaXMucmVzdWx0U2VsZWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5fbm90aWZ5UmVzdWx0U2VsZWN0b3Iob3V0ZXJWYWx1ZSwgaW5uZXJWYWx1ZSwgb3V0ZXJJbmRleCwgaW5uZXJJbmRleCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQoaW5uZXJWYWx1ZSk7CiAgICAgICAgfQogICAgfTsKICAgIE1lcmdlTWFwU3Vic2NyaWJlci5wcm90b3R5cGUuX25vdGlmeVJlc3VsdFNlbGVjdG9yID0gZnVuY3Rpb24gKG91dGVyVmFsdWUsIGlubmVyVmFsdWUsIG91dGVySW5kZXgsIGlubmVySW5kZXgpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMucmVzdWx0U2VsZWN0b3Iob3V0ZXJWYWx1ZSwgaW5uZXJWYWx1ZSwgb3V0ZXJJbmRleCwgaW5uZXJJbmRleCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihlcnIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuZGVzdGluYXRpb24ubmV4dChyZXN1bHQpOwogICAgfTsKICAgIE1lcmdlTWFwU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5Q29tcGxldGUgPSBmdW5jdGlvbiAoaW5uZXJTdWIpIHsKICAgICAgICB2YXIgYnVmZmVyID0gdGhpcy5idWZmZXI7CiAgICAgICAgdGhpcy5yZW1vdmUoaW5uZXJTdWIpOwogICAgICAgIHRoaXMuYWN0aXZlLS07CiAgICAgICAgaWYgKGJ1ZmZlci5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHRoaXMuX25leHQoYnVmZmVyLnNoaWZ0KCkpOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0aGlzLmFjdGl2ZSA9PT0gMCAmJiB0aGlzLmhhc0NvbXBsZXRlZCkgewogICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7CiAgICAgICAgfQogICAgfTsKICAgIHJldHVybiBNZXJnZU1hcFN1YnNjcmliZXI7Cn0oT3V0ZXJTdWJzY3JpYmVyXzEuT3V0ZXJTdWJzY3JpYmVyKSk7CmV4cG9ydHMuTWVyZ2VNYXBTdWJzY3JpYmVyID0gTWVyZ2VNYXBTdWJzY3JpYmVyOwovLyMgc291cmNlTWFwcGluZ1VSTD1tZXJnZU1hcC5qcy5tYXAKCi8qKiovIH0pLAovKiA3MyAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgU3Vic2NyaWJlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKdmFyIE5vdGlmaWNhdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7Ci8qKgogKiBAc2VlIHtAbGluayBOb3RpZmljYXRpb259CiAqCiAqIEBwYXJhbSBzY2hlZHVsZXIKICogQHBhcmFtIGRlbGF5CiAqIEByZXR1cm4ge09ic2VydmFibGU8Uj58V2ViU29ja2V0U3ViamVjdDxUPnxPYnNlcnZhYmxlPFQ+fQogKiBAbWV0aG9kIG9ic2VydmVPbgogKiBAb3duZXIgT2JzZXJ2YWJsZQogKi8KZnVuY3Rpb24gb2JzZXJ2ZU9uKHNjaGVkdWxlciwgZGVsYXkpIHsKICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7IGRlbGF5ID0gMDsgfQogICAgcmV0dXJuIHRoaXMubGlmdChuZXcgT2JzZXJ2ZU9uT3BlcmF0b3Ioc2NoZWR1bGVyLCBkZWxheSkpOwp9CmV4cG9ydHMub2JzZXJ2ZU9uID0gb2JzZXJ2ZU9uOwp2YXIgT2JzZXJ2ZU9uT3BlcmF0b3IgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gT2JzZXJ2ZU9uT3BlcmF0b3Ioc2NoZWR1bGVyLCBkZWxheSkgewogICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7IGRlbGF5ID0gMDsgfQogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgICAgIHRoaXMuZGVsYXkgPSBkZWxheTsKICAgIH0KICAgIE9ic2VydmVPbk9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkgewogICAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBPYnNlcnZlT25TdWJzY3JpYmVyKHN1YnNjcmliZXIsIHRoaXMuc2NoZWR1bGVyLCB0aGlzLmRlbGF5KSk7CiAgICB9OwogICAgcmV0dXJuIE9ic2VydmVPbk9wZXJhdG9yOwp9KCkpOwpleHBvcnRzLk9ic2VydmVPbk9wZXJhdG9yID0gT2JzZXJ2ZU9uT3BlcmF0b3I7Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAaWdub3JlCiAqIEBleHRlbmRzIHtJZ25vcmVkfQogKi8KdmFyIE9ic2VydmVPblN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKE9ic2VydmVPblN1YnNjcmliZXIsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBPYnNlcnZlT25TdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBzY2hlZHVsZXIsIGRlbGF5KSB7CiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHsgZGVsYXkgPSAwOyB9CiAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgZGVzdGluYXRpb24pOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgICAgIHRoaXMuZGVsYXkgPSBkZWxheTsKICAgIH0KICAgIE9ic2VydmVPblN1YnNjcmliZXIuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoYXJnKSB7CiAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IGFyZy5ub3RpZmljYXRpb24sIGRlc3RpbmF0aW9uID0gYXJnLmRlc3RpbmF0aW9uOwogICAgICAgIG5vdGlmaWNhdGlvbi5vYnNlcnZlKGRlc3RpbmF0aW9uKTsKICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CiAgICB9OwogICAgT2JzZXJ2ZU9uU3Vic2NyaWJlci5wcm90b3R5cGUuc2NoZWR1bGVNZXNzYWdlID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikgewogICAgICAgIHRoaXMuYWRkKHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKE9ic2VydmVPblN1YnNjcmliZXIuZGlzcGF0Y2gsIHRoaXMuZGVsYXksIG5ldyBPYnNlcnZlT25NZXNzYWdlKG5vdGlmaWNhdGlvbiwgdGhpcy5kZXN0aW5hdGlvbikpKTsKICAgIH07CiAgICBPYnNlcnZlT25TdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIHRoaXMuc2NoZWR1bGVNZXNzYWdlKE5vdGlmaWNhdGlvbl8xLk5vdGlmaWNhdGlvbi5jcmVhdGVOZXh0KHZhbHVlKSk7CiAgICB9OwogICAgT2JzZXJ2ZU9uU3Vic2NyaWJlci5wcm90b3R5cGUuX2Vycm9yID0gZnVuY3Rpb24gKGVycikgewogICAgICAgIHRoaXMuc2NoZWR1bGVNZXNzYWdlKE5vdGlmaWNhdGlvbl8xLk5vdGlmaWNhdGlvbi5jcmVhdGVFcnJvcihlcnIpKTsKICAgIH07CiAgICBPYnNlcnZlT25TdWJzY3JpYmVyLnByb3RvdHlwZS5fY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5zY2hlZHVsZU1lc3NhZ2UoTm90aWZpY2F0aW9uXzEuTm90aWZpY2F0aW9uLmNyZWF0ZUNvbXBsZXRlKCkpOwogICAgfTsKICAgIHJldHVybiBPYnNlcnZlT25TdWJzY3JpYmVyOwp9KFN1YnNjcmliZXJfMS5TdWJzY3JpYmVyKSk7CmV4cG9ydHMuT2JzZXJ2ZU9uU3Vic2NyaWJlciA9IE9ic2VydmVPblN1YnNjcmliZXI7CnZhciBPYnNlcnZlT25NZXNzYWdlID0gKGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIE9ic2VydmVPbk1lc3NhZ2Uobm90aWZpY2F0aW9uLCBkZXN0aW5hdGlvbikgewogICAgICAgIHRoaXMubm90aWZpY2F0aW9uID0gbm90aWZpY2F0aW9uOwogICAgICAgIHRoaXMuZGVzdGluYXRpb24gPSBkZXN0aW5hdGlvbjsKICAgIH0KICAgIHJldHVybiBPYnNlcnZlT25NZXNzYWdlOwp9KCkpOwpleHBvcnRzLk9ic2VydmVPbk1lc3NhZ2UgPSBPYnNlcnZlT25NZXNzYWdlOwovLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZlT24uanMubWFwCgovKioqLyB9KSwKLyogNzQgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIFN1YnNjcmliZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7Ci8qKgogKiBSZXR1cm5zIGFuIE9ic2VydmFibGUgdGhhdCBtaXJyb3JzIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSB3aXRoIHRoZSBleGNlcHRpb24gb2YgYW4gYGVycm9yYC4gSWYgdGhlIHNvdXJjZSBPYnNlcnZhYmxlCiAqIGNhbGxzIGBlcnJvcmAsIHRoaXMgbWV0aG9kIHdpbGwgcmVzdWJzY3JpYmUgdG8gdGhlIHNvdXJjZSBPYnNlcnZhYmxlIGZvciBhIG1heGltdW0gb2YgYGNvdW50YCByZXN1YnNjcmlwdGlvbnMgKGdpdmVuCiAqIGFzIGEgbnVtYmVyIHBhcmFtZXRlcikgcmF0aGVyIHRoYW4gcHJvcGFnYXRpbmcgdGhlIGBlcnJvcmAgY2FsbC4KICoKICogPGltZyBzcmM9Ii4vaW1nL3JldHJ5LnBuZyIgd2lkdGg9IjEwMCUiPgogKgogKiBBbnkgYW5kIGFsbCBpdGVtcyBlbWl0dGVkIGJ5IHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSB3aWxsIGJlIGVtaXR0ZWQgYnkgdGhlIHJlc3VsdGluZyBPYnNlcnZhYmxlLCBldmVuIHRob3NlIGVtaXR0ZWQKICogZHVyaW5nIGZhaWxlZCBzdWJzY3JpcHRpb25zLiBGb3IgZXhhbXBsZSwgaWYgYW4gT2JzZXJ2YWJsZSBmYWlscyBhdCBmaXJzdCBidXQgZW1pdHMgWzEsIDJdIHRoZW4gc3VjY2VlZHMgdGhlIHNlY29uZAogKiB0aW1lIGFuZCBlbWl0czogWzEsIDIsIDMsIDQsIDVdIHRoZW4gdGhlIGNvbXBsZXRlIHN0cmVhbSBvZiBlbWlzc2lvbnMgYW5kIG5vdGlmaWNhdGlvbnMKICogd291bGQgYmU6IFsxLCAyLCAxLCAyLCAzLCA0LCA1LCBgY29tcGxldGVgXS4KICogQHBhcmFtIHtudW1iZXJ9IGNvdW50IC0gTnVtYmVyIG9mIHJldHJ5IGF0dGVtcHRzIGJlZm9yZSBmYWlsaW5nLgogKiBAcmV0dXJuIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIE9ic2VydmFibGUgbW9kaWZpZWQgd2l0aCB0aGUgcmV0cnkgbG9naWMuCiAqIEBtZXRob2QgcmV0cnkKICogQG93bmVyIE9ic2VydmFibGUKICovCmZ1bmN0aW9uIHJldHJ5KGNvdW50KSB7CiAgICBpZiAoY291bnQgPT09IHZvaWQgMCkgeyBjb3VudCA9IC0xOyB9CiAgICByZXR1cm4gdGhpcy5saWZ0KG5ldyBSZXRyeU9wZXJhdG9yKGNvdW50LCB0aGlzKSk7Cn0KZXhwb3J0cy5yZXRyeSA9IHJldHJ5Owp2YXIgUmV0cnlPcGVyYXRvciA9IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBSZXRyeU9wZXJhdG9yKGNvdW50LCBzb3VyY2UpIHsKICAgICAgICB0aGlzLmNvdW50ID0gY291bnQ7CiAgICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7CiAgICB9CiAgICBSZXRyeU9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkgewogICAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBSZXRyeVN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5jb3VudCwgdGhpcy5zb3VyY2UpKTsKICAgIH07CiAgICByZXR1cm4gUmV0cnlPcGVyYXRvcjsKfSgpKTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBpZ25vcmUKICogQGV4dGVuZHMge0lnbm9yZWR9CiAqLwp2YXIgUmV0cnlTdWJzY3JpYmVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhSZXRyeVN1YnNjcmliZXIsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBSZXRyeVN1YnNjcmliZXIoZGVzdGluYXRpb24sIGNvdW50LCBzb3VyY2UpIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbik7CiAgICAgICAgdGhpcy5jb3VudCA9IGNvdW50OwogICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwogICAgfQogICAgUmV0cnlTdWJzY3JpYmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7CiAgICAgICAgICAgIHZhciBfYSA9IHRoaXMsIHNvdXJjZSA9IF9hLnNvdXJjZSwgY291bnQgPSBfYS5jb3VudDsKICAgICAgICAgICAgaWYgKGNvdW50ID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5lcnJvci5jYWxsKHRoaXMsIGVycik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoY291bnQgPiAtMSkgewogICAgICAgICAgICAgICAgdGhpcy5jb3VudCA9IGNvdW50IC0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzb3VyY2Uuc3Vic2NyaWJlKHRoaXMuX3Vuc3Vic2NyaWJlQW5kUmVjeWNsZSgpKTsKICAgICAgICB9CiAgICB9OwogICAgcmV0dXJuIFJldHJ5U3Vic2NyaWJlcjsKfShTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcikpOwovLyMgc291cmNlTWFwcGluZ1VSTD1yZXRyeS5qcy5tYXAKCi8qKiovIH0pLAovKiA3NSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgU3Vic2NyaWJlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTsKdmFyIGFzeW5jXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpOwovKioKICogRW1pdHMgYSB2YWx1ZSBmcm9tIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSwgdGhlbiBpZ25vcmVzIHN1YnNlcXVlbnQgc291cmNlCiAqIHZhbHVlcyBmb3IgYGR1cmF0aW9uYCBtaWxsaXNlY29uZHMsIHRoZW4gcmVwZWF0cyB0aGlzIHByb2Nlc3MuCiAqCiAqIDxzcGFuIGNsYXNzPSJpbmZvcm1hbCI+TGV0cyBhIHZhbHVlIHBhc3MsIHRoZW4gaWdub3JlcyBzb3VyY2UgdmFsdWVzIGZvciB0aGUKICogbmV4dCBgZHVyYXRpb25gIG1pbGxpc2Vjb25kcy48L3NwYW4+CiAqCiAqIDxpbWcgc3JjPSIuL2ltZy90aHJvdHRsZVRpbWUucG5nIiB3aWR0aD0iMTAwJSI+CiAqCiAqIGB0aHJvdHRsZVRpbWVgIGVtaXRzIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSB2YWx1ZXMgb24gdGhlIG91dHB1dCBPYnNlcnZhYmxlCiAqIHdoZW4gaXRzIGludGVybmFsIHRpbWVyIGlzIGRpc2FibGVkLCBhbmQgaWdub3JlcyBzb3VyY2UgdmFsdWVzIHdoZW4gdGhlIHRpbWVyCiAqIGlzIGVuYWJsZWQuIEluaXRpYWxseSwgdGhlIHRpbWVyIGlzIGRpc2FibGVkLiBBcyBzb29uIGFzIHRoZSBmaXJzdCBzb3VyY2UKICogdmFsdWUgYXJyaXZlcywgaXQgaXMgZm9yd2FyZGVkIHRvIHRoZSBvdXRwdXQgT2JzZXJ2YWJsZSwgYW5kIHRoZW4gdGhlIHRpbWVyCiAqIGlzIGVuYWJsZWQuIEFmdGVyIGBkdXJhdGlvbmAgbWlsbGlzZWNvbmRzIChvciB0aGUgdGltZSB1bml0IGRldGVybWluZWQKICogaW50ZXJuYWxseSBieSB0aGUgb3B0aW9uYWwgYHNjaGVkdWxlcmApIGhhcyBwYXNzZWQsIHRoZSB0aW1lciBpcyBkaXNhYmxlZCwKICogYW5kIHRoaXMgcHJvY2VzcyByZXBlYXRzIGZvciB0aGUgbmV4dCBzb3VyY2UgdmFsdWUuIE9wdGlvbmFsbHkgdGFrZXMgYQogKiB7QGxpbmsgSVNjaGVkdWxlcn0gZm9yIG1hbmFnaW5nIHRpbWVycy4KICoKICogQGV4YW1wbGUgPGNhcHRpb24+RW1pdCBjbGlja3MgYXQgYSByYXRlIG9mIGF0IG1vc3Qgb25lIGNsaWNrIHBlciBzZWNvbmQ8L2NhcHRpb24+CiAqIHZhciBjbGlja3MgPSBSeC5PYnNlcnZhYmxlLmZyb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJyk7CiAqIHZhciByZXN1bHQgPSBjbGlja3MudGhyb3R0bGVUaW1lKDEwMDApOwogKiByZXN1bHQuc3Vic2NyaWJlKHggPT4gY29uc29sZS5sb2coeCkpOwogKgogKiBAc2VlIHtAbGluayBhdWRpdFRpbWV9CiAqIEBzZWUge0BsaW5rIGRlYm91bmNlVGltZX0KICogQHNlZSB7QGxpbmsgZGVsYXl9CiAqIEBzZWUge0BsaW5rIHNhbXBsZVRpbWV9CiAqIEBzZWUge0BsaW5rIHRocm90dGxlfQogKgogKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb24gVGltZSB0byB3YWl0IGJlZm9yZSBlbWl0dGluZyBhbm90aGVyIHZhbHVlIGFmdGVyCiAqIGVtaXR0aW5nIHRoZSBsYXN0IHZhbHVlLCBtZWFzdXJlZCBpbiBtaWxsaXNlY29uZHMgb3IgdGhlIHRpbWUgdW5pdCBkZXRlcm1pbmVkCiAqIGludGVybmFsbHkgYnkgdGhlIG9wdGlvbmFsIGBzY2hlZHVsZXJgLgogKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcj1hc3luY10gVGhlIHtAbGluayBJU2NoZWR1bGVyfSB0byB1c2UgZm9yCiAqIG1hbmFnaW5nIHRoZSB0aW1lcnMgdGhhdCBoYW5kbGUgdGhlIHNhbXBsaW5nLgogKiBAcmV0dXJuIHtPYnNlcnZhYmxlPFQ+fSBBbiBPYnNlcnZhYmxlIHRoYXQgcGVyZm9ybXMgdGhlIHRocm90dGxlIG9wZXJhdGlvbiB0bwogKiBsaW1pdCB0aGUgcmF0ZSBvZiBlbWlzc2lvbnMgZnJvbSB0aGUgc291cmNlLgogKiBAbWV0aG9kIHRocm90dGxlVGltZQogKiBAb3duZXIgT2JzZXJ2YWJsZQogKi8KZnVuY3Rpb24gdGhyb3R0bGVUaW1lKGR1cmF0aW9uLCBzY2hlZHVsZXIpIHsKICAgIGlmIChzY2hlZHVsZXIgPT09IHZvaWQgMCkgeyBzY2hlZHVsZXIgPSBhc3luY18xLmFzeW5jOyB9CiAgICByZXR1cm4gdGhpcy5saWZ0KG5ldyBUaHJvdHRsZVRpbWVPcGVyYXRvcihkdXJhdGlvbiwgc2NoZWR1bGVyKSk7Cn0KZXhwb3J0cy50aHJvdHRsZVRpbWUgPSB0aHJvdHRsZVRpbWU7CnZhciBUaHJvdHRsZVRpbWVPcGVyYXRvciA9IChmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBUaHJvdHRsZVRpbWVPcGVyYXRvcihkdXJhdGlvbiwgc2NoZWR1bGVyKSB7CiAgICAgICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgfQogICAgVGhyb3R0bGVUaW1lT3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoc3Vic2NyaWJlciwgc291cmNlKSB7CiAgICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IFRocm90dGxlVGltZVN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5kdXJhdGlvbiwgdGhpcy5zY2hlZHVsZXIpKTsKICAgIH07CiAgICByZXR1cm4gVGhyb3R0bGVUaW1lT3BlcmF0b3I7Cn0oKSk7Ci8qKgogKiBXZSBuZWVkIHRoaXMgSlNEb2MgY29tbWVudCBmb3IgYWZmZWN0aW5nIEVTRG9jLgogKiBAaWdub3JlCiAqIEBleHRlbmRzIHtJZ25vcmVkfQogKi8KdmFyIFRocm90dGxlVGltZVN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFRocm90dGxlVGltZVN1YnNjcmliZXIsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBUaHJvdHRsZVRpbWVTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBkdXJhdGlvbiwgc2NoZWR1bGVyKSB7CiAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgZGVzdGluYXRpb24pOwogICAgICAgIHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvbjsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgIH0KICAgIFRocm90dGxlVGltZVN1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgaWYgKCF0aGlzLnRocm90dGxlZCkgewogICAgICAgICAgICB0aGlzLmFkZCh0aGlzLnRocm90dGxlZCA9IHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoTmV4dCwgdGhpcy5kdXJhdGlvbiwgeyBzdWJzY3JpYmVyOiB0aGlzIH0pKTsKICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHZhbHVlKTsKICAgICAgICB9CiAgICB9OwogICAgVGhyb3R0bGVUaW1lU3Vic2NyaWJlci5wcm90b3R5cGUuY2xlYXJUaHJvdHRsZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgdGhyb3R0bGVkID0gdGhpcy50aHJvdHRsZWQ7CiAgICAgICAgaWYgKHRocm90dGxlZCkgewogICAgICAgICAgICB0aHJvdHRsZWQudW5zdWJzY3JpYmUoKTsKICAgICAgICAgICAgdGhpcy5yZW1vdmUodGhyb3R0bGVkKTsKICAgICAgICAgICAgdGhpcy50aHJvdHRsZWQgPSBudWxsOwogICAgICAgIH0KICAgIH07CiAgICByZXR1cm4gVGhyb3R0bGVUaW1lU3Vic2NyaWJlcjsKfShTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcikpOwpmdW5jdGlvbiBkaXNwYXRjaE5leHQoYXJnKSB7CiAgICB2YXIgc3Vic2NyaWJlciA9IGFyZy5zdWJzY3JpYmVyOwogICAgc3Vic2NyaWJlci5jbGVhclRocm90dGxlKCk7Cn0KLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGhyb3R0bGVUaW1lLmpzLm1hcAoKLyoqKi8gfSksCi8qIDc2ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHsKICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOwogICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7Cn07CnZhciBhc3luY18xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKdmFyIGlzRGF0ZV8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7CnZhciBTdWJzY3JpYmVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpOwp2YXIgVGltZW91dEVycm9yXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgwKTsKLyoqCiAqIEBwYXJhbSB7bnVtYmVyfSBkdWUKICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdCiAqIEByZXR1cm4ge09ic2VydmFibGU8Uj58V2ViU29ja2V0U3ViamVjdDxUPnxPYnNlcnZhYmxlPFQ+fQogKiBAbWV0aG9kIHRpbWVvdXQKICogQG93bmVyIE9ic2VydmFibGUKICovCmZ1bmN0aW9uIHRpbWVvdXQoZHVlLCBzY2hlZHVsZXIpIHsKICAgIGlmIChzY2hlZHVsZXIgPT09IHZvaWQgMCkgeyBzY2hlZHVsZXIgPSBhc3luY18xLmFzeW5jOyB9CiAgICB2YXIgYWJzb2x1dGVUaW1lb3V0ID0gaXNEYXRlXzEuaXNEYXRlKGR1ZSk7CiAgICB2YXIgd2FpdEZvciA9IGFic29sdXRlVGltZW91dCA/ICgrZHVlIC0gc2NoZWR1bGVyLm5vdygpKSA6IE1hdGguYWJzKGR1ZSk7CiAgICByZXR1cm4gdGhpcy5saWZ0KG5ldyBUaW1lb3V0T3BlcmF0b3Iod2FpdEZvciwgYWJzb2x1dGVUaW1lb3V0LCBzY2hlZHVsZXIsIG5ldyBUaW1lb3V0RXJyb3JfMS5UaW1lb3V0RXJyb3IoKSkpOwp9CmV4cG9ydHMudGltZW91dCA9IHRpbWVvdXQ7CnZhciBUaW1lb3V0T3BlcmF0b3IgPSAoZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gVGltZW91dE9wZXJhdG9yKHdhaXRGb3IsIGFic29sdXRlVGltZW91dCwgc2NoZWR1bGVyLCBlcnJvckluc3RhbmNlKSB7CiAgICAgICAgdGhpcy53YWl0Rm9yID0gd2FpdEZvcjsKICAgICAgICB0aGlzLmFic29sdXRlVGltZW91dCA9IGFic29sdXRlVGltZW91dDsKICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjsKICAgICAgICB0aGlzLmVycm9ySW5zdGFuY2UgPSBlcnJvckluc3RhbmNlOwogICAgfQogICAgVGltZW91dE9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkgewogICAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBUaW1lb3V0U3Vic2NyaWJlcihzdWJzY3JpYmVyLCB0aGlzLmFic29sdXRlVGltZW91dCwgdGhpcy53YWl0Rm9yLCB0aGlzLnNjaGVkdWxlciwgdGhpcy5lcnJvckluc3RhbmNlKSk7CiAgICB9OwogICAgcmV0dXJuIFRpbWVvdXRPcGVyYXRvcjsKfSgpKTsKLyoqCiAqIFdlIG5lZWQgdGhpcyBKU0RvYyBjb21tZW50IGZvciBhZmZlY3RpbmcgRVNEb2MuCiAqIEBpZ25vcmUKICogQGV4dGVuZHMge0lnbm9yZWR9CiAqLwp2YXIgVGltZW91dFN1YnNjcmliZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFRpbWVvdXRTdWJzY3JpYmVyLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gVGltZW91dFN1YnNjcmliZXIoZGVzdGluYXRpb24sIGFic29sdXRlVGltZW91dCwgd2FpdEZvciwgc2NoZWR1bGVyLCBlcnJvckluc3RhbmNlKSB7CiAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgZGVzdGluYXRpb24pOwogICAgICAgIHRoaXMuYWJzb2x1dGVUaW1lb3V0ID0gYWJzb2x1dGVUaW1lb3V0OwogICAgICAgIHRoaXMud2FpdEZvciA9IHdhaXRGb3I7CiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7CiAgICAgICAgdGhpcy5lcnJvckluc3RhbmNlID0gZXJyb3JJbnN0YW5jZTsKICAgICAgICB0aGlzLmluZGV4ID0gMDsKICAgICAgICB0aGlzLl9wcmV2aW91c0luZGV4ID0gMDsKICAgICAgICB0aGlzLl9oYXNDb21wbGV0ZWQgPSBmYWxzZTsKICAgICAgICB0aGlzLnNjaGVkdWxlVGltZW91dCgpOwogICAgfQogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpbWVvdXRTdWJzY3JpYmVyLnByb3RvdHlwZSwgInByZXZpb3VzSW5kZXgiLCB7CiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcmV2aW91c0luZGV4OwogICAgICAgIH0sCiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICBjb25maWd1cmFibGU6IHRydWUKICAgIH0pOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpbWVvdXRTdWJzY3JpYmVyLnByb3RvdHlwZSwgImhhc0NvbXBsZXRlZCIsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hhc0NvbXBsZXRlZDsKICAgICAgICB9LAogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlCiAgICB9KTsKICAgIFRpbWVvdXRTdWJzY3JpYmVyLmRpc3BhdGNoVGltZW91dCA9IGZ1bmN0aW9uIChzdGF0ZSkgewogICAgICAgIHZhciBzb3VyY2UgPSBzdGF0ZS5zdWJzY3JpYmVyOwogICAgICAgIHZhciBjdXJyZW50SW5kZXggPSBzdGF0ZS5pbmRleDsKICAgICAgICBpZiAoIXNvdXJjZS5oYXNDb21wbGV0ZWQgJiYgc291cmNlLnByZXZpb3VzSW5kZXggPT09IGN1cnJlbnRJbmRleCkgewogICAgICAgICAgICBzb3VyY2Uubm90aWZ5VGltZW91dCgpOwogICAgICAgIH0KICAgIH07CiAgICBUaW1lb3V0U3Vic2NyaWJlci5wcm90b3R5cGUuc2NoZWR1bGVUaW1lb3V0ID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBjdXJyZW50SW5kZXggPSB0aGlzLmluZGV4OwogICAgICAgIHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKFRpbWVvdXRTdWJzY3JpYmVyLmRpc3BhdGNoVGltZW91dCwgdGhpcy53YWl0Rm9yLCB7IHN1YnNjcmliZXI6IHRoaXMsIGluZGV4OiBjdXJyZW50SW5kZXggfSk7CiAgICAgICAgdGhpcy5pbmRleCsrOwogICAgICAgIHRoaXMuX3ByZXZpb3VzSW5kZXggPSBjdXJyZW50SW5kZXg7CiAgICB9OwogICAgVGltZW91dFN1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHZhbHVlKTsKICAgICAgICBpZiAoIXRoaXMuYWJzb2x1dGVUaW1lb3V0KSB7CiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVUaW1lb3V0KCk7CiAgICAgICAgfQogICAgfTsKICAgIFRpbWVvdXRTdWJzY3JpYmVyLnByb3RvdHlwZS5fZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihlcnIpOwogICAgICAgIHRoaXMuX2hhc0NvbXBsZXRlZCA9IHRydWU7CiAgICB9OwogICAgVGltZW91dFN1YnNjcmliZXIucHJvdG90eXBlLl9jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7CiAgICAgICAgdGhpcy5faGFzQ29tcGxldGVkID0gdHJ1ZTsKICAgIH07CiAgICBUaW1lb3V0U3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5VGltZW91dCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzLmVycm9yKHRoaXMuZXJyb3JJbnN0YW5jZSk7CiAgICB9OwogICAgcmV0dXJuIFRpbWVvdXRTdWJzY3JpYmVyOwp9KFN1YnNjcmliZXJfMS5TdWJzY3JpYmVyKSk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXRpbWVvdXQuanMubWFwCgovKioqLyB9KSwKLyogNzcgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIFN1YnNjcmlwdGlvbl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTsKLyoqCiAqIEEgdW5pdCBvZiB3b3JrIHRvIGJlIGV4ZWN1dGVkIGluIGEge0BsaW5rIFNjaGVkdWxlcn0uIEFuIGFjdGlvbiBpcyB0eXBpY2FsbHkKICogY3JlYXRlZCBmcm9tIHdpdGhpbiBhIFNjaGVkdWxlciBhbmQgYW4gUnhKUyB1c2VyIGRvZXMgbm90IG5lZWQgdG8gY29uY2VybgogKiB0aGVtc2VsdmVzIGFib3V0IGNyZWF0aW5nIGFuZCBtYW5pcHVsYXRpbmcgYW4gQWN0aW9uLgogKgogKiBgYGB0cwogKiBjbGFzcyBBY3Rpb248VD4gZXh0ZW5kcyBTdWJzY3JpcHRpb24gewogKiAgIG5ldyAoc2NoZWR1bGVyOiBTY2hlZHVsZXIsIHdvcms6IChzdGF0ZT86IFQpID0+IHZvaWQpOwogKiAgIHNjaGVkdWxlKHN0YXRlPzogVCwgZGVsYXk6IG51bWJlciA9IDApOiBTdWJzY3JpcHRpb247CiAqIH0KICogYGBgCiAqCiAqIEBjbGFzcyBBY3Rpb248VD4KICovCnZhciBBY3Rpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKEFjdGlvbiwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEFjdGlvbihzY2hlZHVsZXIsIHdvcmspIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogU2NoZWR1bGVzIHRoaXMgYWN0aW9uIG9uIGl0cyBwYXJlbnQgU2NoZWR1bGVyIGZvciBleGVjdXRpb24uIE1heSBiZSBwYXNzZWQKICAgICAqIHNvbWUgY29udGV4dCBvYmplY3QsIGBzdGF0ZWAuIE1heSBoYXBwZW4gYXQgc29tZSBwb2ludCBpbiB0aGUgZnV0dXJlLAogICAgICogYWNjb3JkaW5nIHRvIHRoZSBgZGVsYXlgIHBhcmFtZXRlciwgaWYgc3BlY2lmaWVkLgogICAgICogQHBhcmFtIHtUfSBbc3RhdGVdIFNvbWUgY29udGV4dHVhbCBkYXRhIHRoYXQgdGhlIGB3b3JrYCBmdW5jdGlvbiB1c2VzIHdoZW4KICAgICAqIGNhbGxlZCBieSB0aGUgU2NoZWR1bGVyLgogICAgICogQHBhcmFtIHtudW1iZXJ9IFtkZWxheV0gVGltZSB0byB3YWl0IGJlZm9yZSBleGVjdXRpbmcgdGhlIHdvcmssIHdoZXJlIHRoZQogICAgICogdGltZSB1bml0IGlzIGltcGxpY2l0IGFuZCBkZWZpbmVkIGJ5IHRoZSBTY2hlZHVsZXIuCiAgICAgKiBAcmV0dXJuIHt2b2lkfQogICAgICovCiAgICBBY3Rpb24ucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHN0YXRlLCBkZWxheSkgewogICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7IGRlbGF5ID0gMDsgfQogICAgICAgIHJldHVybiB0aGlzOwogICAgfTsKICAgIHJldHVybiBBY3Rpb247Cn0oU3Vic2NyaXB0aW9uXzEuU3Vic2NyaXB0aW9uKSk7CmV4cG9ydHMuQWN0aW9uID0gQWN0aW9uOwovLyMgc291cmNlTWFwcGluZ1VSTD1BY3Rpb24uanMubWFwCgovKioqLyB9KSwKLyogNzggKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKdmFyIHJvb3RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7CnZhciBBY3Rpb25fMSA9IF9fd2VicGFja19yZXF1aXJlX18oNzcpOwovKioKICogV2UgbmVlZCB0aGlzIEpTRG9jIGNvbW1lbnQgZm9yIGFmZmVjdGluZyBFU0RvYy4KICogQGlnbm9yZQogKiBAZXh0ZW5kcyB7SWdub3JlZH0KICovCnZhciBBc3luY0FjdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoQXN5bmNBY3Rpb24sIF9zdXBlcik7CiAgICBmdW5jdGlvbiBBc3luY0FjdGlvbihzY2hlZHVsZXIsIHdvcmspIHsKICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBzY2hlZHVsZXIsIHdvcmspOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyOwogICAgICAgIHRoaXMud29yayA9IHdvcms7CiAgICAgICAgdGhpcy5wZW5kaW5nID0gZmFsc2U7CiAgICB9CiAgICBBc3luY0FjdGlvbi5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGRlbGF5KSB7CiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHsgZGVsYXkgPSAwOyB9CiAgICAgICAgaWYgKHRoaXMuY2xvc2VkKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KICAgICAgICAvLyBBbHdheXMgcmVwbGFjZSB0aGUgY3VycmVudCBzdGF0ZSB3aXRoIHRoZSBuZXcgc3RhdGUuCiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgICAgIC8vIFNldCB0aGUgcGVuZGluZyBmbGFnIGluZGljYXRpbmcgdGhhdCB0aGlzIGFjdGlvbiBoYXMgYmVlbiBzY2hlZHVsZWQsIG9yCiAgICAgICAgLy8gaGFzIHJlY3Vyc2l2ZWx5IHJlc2NoZWR1bGVkIGl0c2VsZi4KICAgICAgICB0aGlzLnBlbmRpbmcgPSB0cnVlOwogICAgICAgIHZhciBpZCA9IHRoaXMuaWQ7CiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyOwogICAgICAgIC8vCiAgICAgICAgLy8gSW1wb3J0YW50IGltcGxlbWVudGF0aW9uIG5vdGU6CiAgICAgICAgLy8KICAgICAgICAvLyBBY3Rpb25zIG9ubHkgZXhlY3V0ZSBvbmNlIGJ5IGRlZmF1bHQsIHVubGVzcyByZXNjaGVkdWxlZCBmcm9tIHdpdGhpbiB0aGUKICAgICAgICAvLyBzY2hlZHVsZWQgY2FsbGJhY2suIFRoaXMgYWxsb3dzIHVzIHRvIGltcGxlbWVudCBzaW5nbGUgYW5kIHJlcGVhdAogICAgICAgIC8vIGFjdGlvbnMgdmlhIHRoZSBzYW1lIGNvZGUgcGF0aCwgd2l0aG91dCBhZGRpbmcgQVBJIHN1cmZhY2UgYXJlYSwgYXMgd2VsbAogICAgICAgIC8vIGFzIG1pbWljIHRyYWRpdGlvbmFsIHJlY3Vyc2lvbiBidXQgYWNyb3NzIGFzeW5jaHJvbm91cyBib3VuZGFyaWVzLgogICAgICAgIC8vCiAgICAgICAgLy8gSG93ZXZlciwgSlMgcnVudGltZXMgYW5kIHRpbWVycyBkaXN0aW5ndWlzaCBiZXR3ZWVuIGludGVydmFscyBhY2hpZXZlZCBieQogICAgICAgIC8vIHNlcmlhbCBgc2V0VGltZW91dGAgY2FsbHMgdnMuIGEgc2luZ2xlIGBzZXRJbnRlcnZhbGAgY2FsbC4gQW4gaW50ZXJ2YWwgb2YKICAgICAgICAvLyBzZXJpYWwgYHNldFRpbWVvdXRgIGNhbGxzIGNhbiBiZSBpbmRpdmlkdWFsbHkgZGVsYXllZCwgd2hpY2ggZGVsYXlzCiAgICAgICAgLy8gc2NoZWR1bGluZyB0aGUgbmV4dCBgc2V0VGltZW91dGAsIGFuZCBzbyBvbi4gYHNldEludGVydmFsYCBhdHRlbXB0cyB0bwogICAgICAgIC8vIGd1YXJhbnRlZSB0aGUgaW50ZXJ2YWwgY2FsbGJhY2sgd2lsbCBiZSBpbnZva2VkIG1vcmUgcHJlY2lzZWx5IHRvIHRoZQogICAgICAgIC8vIGludGVydmFsIHBlcmlvZCwgcmVnYXJkbGVzcyBvZiBsb2FkLgogICAgICAgIC8vCiAgICAgICAgLy8gVGhlcmVmb3JlLCB3ZSB1c2UgYHNldEludGVydmFsYCB0byBzY2hlZHVsZSBzaW5nbGUgYW5kIHJlcGVhdCBhY3Rpb25zLgogICAgICAgIC8vIElmIHRoZSBhY3Rpb24gcmVzY2hlZHVsZXMgaXRzZWxmIHdpdGggdGhlIHNhbWUgZGVsYXksIHRoZSBpbnRlcnZhbCBpcyBub3QKICAgICAgICAvLyBjYW5jZWxlZC4gSWYgdGhlIGFjdGlvbiBkb2Vzbid0IHJlc2NoZWR1bGUsIG9yIHJlc2NoZWR1bGVzIHdpdGggYQogICAgICAgIC8vIGRpZmZlcmVudCBkZWxheSwgdGhlIGludGVydmFsIHdpbGwgYmUgY2FuY2VsZWQgYWZ0ZXIgc2NoZWR1bGVkIGNhbGxiYWNrCiAgICAgICAgLy8gZXhlY3V0aW9uLgogICAgICAgIC8vCiAgICAgICAgaWYgKGlkICE9IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5pZCA9IHRoaXMucmVjeWNsZUFzeW5jSWQoc2NoZWR1bGVyLCBpZCwgZGVsYXkpOwogICAgICAgIH0KICAgICAgICB0aGlzLmRlbGF5ID0gZGVsYXk7CiAgICAgICAgLy8gSWYgdGhpcyBhY3Rpb24gaGFzIGFscmVhZHkgYW4gYXN5bmMgSWQsIGRvbid0IHJlcXVlc3QgYSBuZXcgb25lLgogICAgICAgIHRoaXMuaWQgPSB0aGlzLmlkIHx8IHRoaXMucmVxdWVzdEFzeW5jSWQoc2NoZWR1bGVyLCB0aGlzLmlkLCBkZWxheSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9OwogICAgQXN5bmNBY3Rpb24ucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkID0gZnVuY3Rpb24gKHNjaGVkdWxlciwgaWQsIGRlbGF5KSB7CiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHsgZGVsYXkgPSAwOyB9CiAgICAgICAgcmV0dXJuIHJvb3RfMS5yb290LnNldEludGVydmFsKHNjaGVkdWxlci5mbHVzaC5iaW5kKHNjaGVkdWxlciwgdGhpcyksIGRlbGF5KTsKICAgIH07CiAgICBBc3luY0FjdGlvbi5wcm90b3R5cGUucmVjeWNsZUFzeW5jSWQgPSBmdW5jdGlvbiAoc2NoZWR1bGVyLCBpZCwgZGVsYXkpIHsKICAgICAgICBpZiAoZGVsYXkgPT09IHZvaWQgMCkgeyBkZWxheSA9IDA7IH0KICAgICAgICAvLyBJZiB0aGlzIGFjdGlvbiBpcyByZXNjaGVkdWxlZCB3aXRoIHRoZSBzYW1lIGRlbGF5IHRpbWUsIGRvbid0IGNsZWFyIHRoZSBpbnRlcnZhbCBpZC4KICAgICAgICBpZiAoZGVsYXkgIT09IG51bGwgJiYgdGhpcy5kZWxheSA9PT0gZGVsYXkpIHsKICAgICAgICAgICAgcmV0dXJuIGlkOwogICAgICAgIH0KICAgICAgICAvLyBPdGhlcndpc2UsIGlmIHRoZSBhY3Rpb24ncyBkZWxheSB0aW1lIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBjdXJyZW50IGRlbGF5LAogICAgICAgIC8vIGNsZWFyIHRoZSBpbnRlcnZhbCBpZAogICAgICAgIHJldHVybiByb290XzEucm9vdC5jbGVhckludGVydmFsKGlkKSAmJiB1bmRlZmluZWQgfHwgdW5kZWZpbmVkOwogICAgfTsKICAgIC8qKgogICAgICogSW1tZWRpYXRlbHkgZXhlY3V0ZXMgdGhpcyBhY3Rpb24gYW5kIHRoZSBgd29ya2AgaXQgY29udGFpbnMuCiAgICAgKiBAcmV0dXJuIHthbnl9CiAgICAgKi8KICAgIEFzeW5jQWN0aW9uLnByb3RvdHlwZS5leGVjdXRlID0gZnVuY3Rpb24gKHN0YXRlLCBkZWxheSkgewogICAgICAgIGlmICh0aGlzLmNsb3NlZCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdleGVjdXRpbmcgYSBjYW5jZWxsZWQgYWN0aW9uJyk7CiAgICAgICAgfQogICAgICAgIHRoaXMucGVuZGluZyA9IGZhbHNlOwogICAgICAgIHZhciBlcnJvciA9IHRoaXMuX2V4ZWN1dGUoc3RhdGUsIGRlbGF5KTsKICAgICAgICBpZiAoZXJyb3IpIHsKICAgICAgICAgICAgcmV0dXJuIGVycm9yOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmICh0aGlzLnBlbmRpbmcgPT09IGZhbHNlICYmIHRoaXMuaWQgIT0gbnVsbCkgewogICAgICAgICAgICAvLyBEZXF1ZXVlIGlmIHRoZSBhY3Rpb24gZGlkbid0IHJlc2NoZWR1bGUgaXRzZWxmLiBEb24ndCBjYWxsCiAgICAgICAgICAgIC8vIHVuc3Vic2NyaWJlKCksIGJlY2F1c2UgdGhlIGFjdGlvbiBjb3VsZCByZXNjaGVkdWxlIGxhdGVyLgogICAgICAgICAgICAvLyBGb3IgZXhhbXBsZToKICAgICAgICAgICAgLy8gYGBgCiAgICAgICAgICAgIC8vIHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbiBkb1dvcmsoY291bnRlcikgewogICAgICAgICAgICAvLyAgIC8qIC4uLiBJJ20gYSBidXN5IHdvcmtlciBiZWUgLi4uICovCiAgICAgICAgICAgIC8vICAgdmFyIG9yaWdpbmFsQWN0aW9uID0gdGhpczsKICAgICAgICAgICAgLy8gICAvKiB3YWl0IDEwMG1zIGJlZm9yZSByZXNjaGVkdWxpbmcgdGhlIGFjdGlvbiAqLwogICAgICAgICAgICAvLyAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyAgICAgb3JpZ2luYWxBY3Rpb24uc2NoZWR1bGUoY291bnRlciArIDEpOwogICAgICAgICAgICAvLyAgIH0sIDEwMCk7CiAgICAgICAgICAgIC8vIH0sIDEwMDApOwogICAgICAgICAgICAvLyBgYGAKICAgICAgICAgICAgdGhpcy5pZCA9IHRoaXMucmVjeWNsZUFzeW5jSWQodGhpcy5zY2hlZHVsZXIsIHRoaXMuaWQsIG51bGwpOwogICAgICAgIH0KICAgIH07CiAgICBBc3luY0FjdGlvbi5wcm90b3R5cGUuX2V4ZWN1dGUgPSBmdW5jdGlvbiAoc3RhdGUsIGRlbGF5KSB7CiAgICAgICAgdmFyIGVycm9yZWQgPSBmYWxzZTsKICAgICAgICB2YXIgZXJyb3JWYWx1ZSA9IHVuZGVmaW5lZDsKICAgICAgICB0cnkgewogICAgICAgICAgICB0aGlzLndvcmsoc3RhdGUpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBlcnJvcmVkID0gdHJ1ZTsKICAgICAgICAgICAgZXJyb3JWYWx1ZSA9ICEhZSAmJiBlIHx8IG5ldyBFcnJvcihlKTsKICAgICAgICB9CiAgICAgICAgaWYgKGVycm9yZWQpIHsKICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpOwogICAgICAgICAgICByZXR1cm4gZXJyb3JWYWx1ZTsKICAgICAgICB9CiAgICB9OwogICAgQXN5bmNBY3Rpb24ucHJvdG90eXBlLl91bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgaWQgPSB0aGlzLmlkOwogICAgICAgIHZhciBzY2hlZHVsZXIgPSB0aGlzLnNjaGVkdWxlcjsKICAgICAgICB2YXIgYWN0aW9ucyA9IHNjaGVkdWxlci5hY3Rpb25zOwogICAgICAgIHZhciBpbmRleCA9IGFjdGlvbnMuaW5kZXhPZih0aGlzKTsKICAgICAgICB0aGlzLndvcmsgPSBudWxsOwogICAgICAgIHRoaXMuZGVsYXkgPSBudWxsOwogICAgICAgIHRoaXMuc3RhdGUgPSBudWxsOwogICAgICAgIHRoaXMucGVuZGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuc2NoZWR1bGVyID0gbnVsbDsKICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgICAgIGFjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB9CiAgICAgICAgaWYgKGlkICE9IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5pZCA9IHRoaXMucmVjeWNsZUFzeW5jSWQoc2NoZWR1bGVyLCBpZCwgbnVsbCk7CiAgICAgICAgfQogICAgfTsKICAgIHJldHVybiBBc3luY0FjdGlvbjsKfShBY3Rpb25fMS5BY3Rpb24pKTsKZXhwb3J0cy5Bc3luY0FjdGlvbiA9IEFzeW5jQWN0aW9uOwovLyMgc291cmNlTWFwcGluZ1VSTD1Bc3luY0FjdGlvbi5qcy5tYXAKCi8qKiovIH0pLAovKiA3OSAqLwovKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CgoidXNlIHN0cmljdCI7Cgp2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7CiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQogICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwp9Owp2YXIgU2NoZWR1bGVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDU2KTsKdmFyIEFzeW5jU2NoZWR1bGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhBc3luY1NjaGVkdWxlciwgX3N1cGVyKTsKICAgIGZ1bmN0aW9uIEFzeW5jU2NoZWR1bGVyKCkgewogICAgICAgIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIHRoaXMuYWN0aW9ucyA9IFtdOwogICAgICAgIC8qKgogICAgICAgICAqIEEgZmxhZyB0byBpbmRpY2F0ZSB3aGV0aGVyIHRoZSBTY2hlZHVsZXIgaXMgY3VycmVudGx5IGV4ZWN1dGluZyBhIGJhdGNoIG9mCiAgICAgICAgICogcXVldWVkIGFjdGlvbnMuCiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgICAgICovCiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICAvKioKICAgICAgICAgKiBBbiBpbnRlcm5hbCBJRCB1c2VkIHRvIHRyYWNrIHRoZSBsYXRlc3QgYXN5bmNocm9ub3VzIHRhc2sgc3VjaCBhcyB0aG9zZQogICAgICAgICAqIGNvbWluZyBmcm9tIGBzZXRUaW1lb3V0YCwgYHNldEludGVydmFsYCwgYHJlcXVlc3RBbmltYXRpb25GcmFtZWAsIGFuZAogICAgICAgICAqIG90aGVycy4KICAgICAgICAgKiBAdHlwZSB7YW55fQogICAgICAgICAqLwogICAgICAgIHRoaXMuc2NoZWR1bGVkID0gdW5kZWZpbmVkOwogICAgfQogICAgQXN5bmNTY2hlZHVsZXIucHJvdG90eXBlLmZsdXNoID0gZnVuY3Rpb24gKGFjdGlvbikgewogICAgICAgIHZhciBhY3Rpb25zID0gdGhpcy5hY3Rpb25zOwogICAgICAgIGlmICh0aGlzLmFjdGl2ZSkgewogICAgICAgICAgICBhY3Rpb25zLnB1c2goYWN0aW9uKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB2YXIgZXJyb3I7CiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlOwogICAgICAgIGRvIHsKICAgICAgICAgICAgaWYgKGVycm9yID0gYWN0aW9uLmV4ZWN1dGUoYWN0aW9uLnN0YXRlLCBhY3Rpb24uZGVsYXkpKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0gd2hpbGUgKGFjdGlvbiA9IGFjdGlvbnMuc2hpZnQoKSk7IC8vIGV4aGF1c3QgdGhlIHNjaGVkdWxlciBxdWV1ZQogICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICAgIHdoaWxlIChhY3Rpb24gPSBhY3Rpb25zLnNoaWZ0KCkpIHsKICAgICAgICAgICAgICAgIGFjdGlvbi51bnN1YnNjcmliZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgIH07CiAgICByZXR1cm4gQXN5bmNTY2hlZHVsZXI7Cn0oU2NoZWR1bGVyXzEuU2NoZWR1bGVyKSk7CmV4cG9ydHMuQXN5bmNTY2hlZHVsZXIgPSBBc3luY1NjaGVkdWxlcjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXN5bmNTY2hlZHVsZXIuanMubWFwCgovKioqLyB9KSwKLyogODAgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKLyoqCiAqIEFuIGVycm9yIHRocm93biB3aGVuIGR1ZXRpbWUgZWxhcHNlcy4KICoKICogQHNlZSB7QGxpbmsgdGltZW91dH0KICoKICogQGNsYXNzIFRpbWVvdXRFcnJvcgogKi8KdmFyIFRpbWVvdXRFcnJvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoVGltZW91dEVycm9yLCBfc3VwZXIpOwogICAgZnVuY3Rpb24gVGltZW91dEVycm9yKCkgewogICAgICAgIHZhciBlcnIgPSBfc3VwZXIuY2FsbCh0aGlzLCAnVGltZW91dCBoYXMgb2NjdXJyZWQnKTsKICAgICAgICB0aGlzLm5hbWUgPSBlcnIubmFtZSA9ICdUaW1lb3V0RXJyb3InOwogICAgICAgIHRoaXMuc3RhY2sgPSBlcnIuc3RhY2s7CiAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7CiAgICB9CiAgICByZXR1cm4gVGltZW91dEVycm9yOwp9KEVycm9yKSk7CmV4cG9ydHMuVGltZW91dEVycm9yID0gVGltZW91dEVycm9yOwovLyMgc291cmNlTWFwcGluZ1VSTD1UaW1lb3V0RXJyb3IuanMubWFwCgovKioqLyB9KSwKLyogODEgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07CiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKfTsKLyoqCiAqIEFuIGVycm9yIHRocm93biB3aGVuIG9uZSBvciBtb3JlIGVycm9ycyBoYXZlIG9jY3VycmVkIGR1cmluZyB0aGUKICogYHVuc3Vic2NyaWJlYCBvZiBhIHtAbGluayBTdWJzY3JpcHRpb259LgogKi8KdmFyIFVuc3Vic2NyaXB0aW9uRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikgewogICAgX19leHRlbmRzKFVuc3Vic2NyaXB0aW9uRXJyb3IsIF9zdXBlcik7CiAgICBmdW5jdGlvbiBVbnN1YnNjcmlwdGlvbkVycm9yKGVycm9ycykgewogICAgICAgIF9zdXBlci5jYWxsKHRoaXMpOwogICAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzOwogICAgICAgIHZhciBlcnIgPSBFcnJvci5jYWxsKHRoaXMsIGVycm9ycyA/CiAgICAgICAgICAgIGVycm9ycy5sZW5ndGggKyAiIGVycm9ycyBvY2N1cnJlZCBkdXJpbmcgdW5zdWJzY3JpcHRpb246XG4gICIgKyBlcnJvcnMubWFwKGZ1bmN0aW9uIChlcnIsIGkpIHsgcmV0dXJuICgoaSArIDEpICsgIikgIiArIGVyci50b1N0cmluZygpKTsgfSkuam9pbignXG4gICcpIDogJycpOwogICAgICAgIHRoaXMubmFtZSA9IGVyci5uYW1lID0gJ1Vuc3Vic2NyaXB0aW9uRXJyb3InOwogICAgICAgIHRoaXMuc3RhY2sgPSBlcnIuc3RhY2s7CiAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7CiAgICB9CiAgICByZXR1cm4gVW5zdWJzY3JpcHRpb25FcnJvcjsKfShFcnJvcikpOwpleHBvcnRzLlVuc3Vic2NyaXB0aW9uRXJyb3IgPSBVbnN1YnNjcmlwdGlvbkVycm9yOwovLyMgc291cmNlTWFwcGluZ1VSTD1VbnN1YnNjcmlwdGlvbkVycm9yLmpzLm1hcAoKLyoqKi8gfSksCi8qIDgyICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCmZ1bmN0aW9uIGlzU2NoZWR1bGVyKHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlLnNjaGVkdWxlID09PSAnZnVuY3Rpb24nOwp9CmV4cG9ydHMuaXNTY2hlZHVsZXIgPSBpc1NjaGVkdWxlcjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNTY2hlZHVsZXIuanMubWFwCgovKioqLyB9KSwKLyogODMgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgewoKInVzZSBzdHJpY3QiOwoKdmFyIFN1YnNjcmliZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7CnZhciByeFN1YnNjcmliZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMjApOwp2YXIgT2JzZXJ2ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpOwpmdW5jdGlvbiB0b1N1YnNjcmliZXIobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSkgewogICAgaWYgKG5leHRPck9ic2VydmVyKSB7CiAgICAgICAgaWYgKG5leHRPck9ic2VydmVyIGluc3RhbmNlb2YgU3Vic2NyaWJlcl8xLlN1YnNjcmliZXIpIHsKICAgICAgICAgICAgcmV0dXJuIG5leHRPck9ic2VydmVyOwogICAgICAgIH0KICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXJbcnhTdWJzY3JpYmVyXzEuJCRyeFN1YnNjcmliZXJdKSB7CiAgICAgICAgICAgIHJldHVybiBuZXh0T3JPYnNlcnZlcltyeFN1YnNjcmliZXJfMS4kJHJ4U3Vic2NyaWJlcl0oKTsKICAgICAgICB9CiAgICB9CiAgICBpZiAoIW5leHRPck9ic2VydmVyICYmICFlcnJvciAmJiAhY29tcGxldGUpIHsKICAgICAgICByZXR1cm4gbmV3IFN1YnNjcmliZXJfMS5TdWJzY3JpYmVyKE9ic2VydmVyXzEuZW1wdHkpOwogICAgfQogICAgcmV0dXJuIG5ldyBTdWJzY3JpYmVyXzEuU3Vic2NyaWJlcihuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKTsKfQpleHBvcnRzLnRvU3Vic2NyaWJlciA9IHRvU3Vic2NyaWJlcjsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9dG9TdWJzY3JpYmVyLmpzLm1hcAoKLyoqKi8gfSksCi8qIDg0ICovCi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKCiJ1c2Ugc3RyaWN0IjsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cl9fd2VicGFja19yZXF1aXJlX18oMzIpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDM0KTsKX193ZWJwYWNrX3JlcXVpcmVfXygzMyk7Cl9fd2VicGFja19yZXF1aXJlX18oMzEpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTsKX193ZWJwYWNrX3JlcXVpcmVfXygzOCk7Cl9fd2VicGFja19yZXF1aXJlX18oMzcpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTsKX193ZWJwYWNrX3JlcXVpcmVfXyg0MSk7Cl9fd2VicGFja19yZXF1aXJlX18oNDMpOwpfX3dlYnBhY2tfcmVxdWlyZV9fKDM2KTsKX193ZWJwYWNrX3JlcXVpcmVfXyg0Mik7Cl9fd2VicGFja19yZXF1aXJlX18oMzUpOwp2YXIgYmFpZHVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDUpOwp2YXIgdGllYmFfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDkpOwp2YXIgYmFpZHVfdmlkZW9fMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDQpOwp2YXIgZ29vZ2xlXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQ2KTsKdmFyIHdlaWJvXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUxKTsKdmFyIHR3aXR0ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTApOwp2YXIgc29fMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDcpOwp2YXIgemhpaHVfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTQpOwp2YXIgemhpaHVfZGFpbHlfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTIpOwp2YXIgemhpaHVfemh1YW5sYW5fMSA9IF9fd2VicGFja19yZXF1aXJlX18oNTMpOwp2YXIgc29nb3VfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNDgpOwpiYWlkdV8xLmRlZmF1bHQuYm9vdHN0cmFwKCk7CnRpZWJhXzEuZGVmYXVsdC5ib290c3RyYXAoKTsKYmFpZHVfdmlkZW9fMS5kZWZhdWx0LmJvb3RzdHJhcCgpOwpnb29nbGVfMS5kZWZhdWx0LmJvb3RzdHJhcCgpOwp3ZWlib18xLmRlZmF1bHQuYm9vdHN0cmFwKCk7CnR3aXR0ZXJfMS5kZWZhdWx0LmJvb3RzdHJhcCgpOwpzb18xLmRlZmF1bHQuYm9vdHN0cmFwKCk7CnpoaWh1XzEuZGVmYXVsdC5ib290c3RyYXAoKTsKemhpaHVfZGFpbHlfMS5kZWZhdWx0LmJvb3RzdHJhcCgpOwp6aGlodV96aHVhbmxhbl8xLmRlZmF1bHQuYm9vdHN0cmFwKCk7CnNvZ291XzEuZGVmYXVsdC5ib290c3RyYXAoKTsKCgovKioqLyB9KSwKLyogODUgKi8KLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgewoKdmFyIGc7CgovLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZQpnID0gKGZ1bmN0aW9uKCkgewoJcmV0dXJuIHRoaXM7Cn0pKCk7Cgp0cnkgewoJLy8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApCglnID0gZyB8fCBGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpIHx8ICgxLGV2YWwpKCJ0aGlzIik7Cn0gY2F0Y2goZSkgewoJLy8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGUKCWlmKHR5cGVvZiB3aW5kb3cgPT09ICJvYmplY3QiKQoJCWcgPSB3aW5kb3c7Cn0KCi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi4KLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3MKLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufQoKbW9kdWxlLmV4cG9ydHMgPSBnOwoKCi8qKiovIH0pCi8qKioqKiovIF0pOw=="}],"settings":{"configMode":100,"editor_autoLint":true,"editor_autoLintMaxLen":"50000","editor_autoSave":false,"editor_easySave":true,"editor_electricChars":true,"editor_enabled":true,"editor_fontSize":"150","editor_highlightTrailingWhitespace":true,"editor_indentUnit":"4","editor_indentWithTabs":"spaces","editor_keyMap":"vim","editor_lineWrapping":false,"editor_tabMode":"smart","editor_theme":"monokai","enabled":true,"i18n":"zh_CN","script_blacklist_server":[{"rules":["/https?:\\/\\/userscripts\\.org\\/scripts\\/(source|version)/(102614).*\\.user\\.js/"],"severity":"2"},{"name":"SaveFrom.net helper","reason":"Shows advertisements","rules":["/https?:\\/\\/sf-addon\\.com\\/.*\\/.*\\.user\\.js/","/https?:\\/\\/.*\\.sf-helper\\.com\\/.*\\.user\\.js/"],"severity":"3"}]}}